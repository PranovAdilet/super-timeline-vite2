(function(A,v){typeof exports=="object"&&typeof module<"u"?v(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],v):(A=typeof globalThis<"u"?globalThis:A||self,v(A["super-timeline"]={},A.React,A.ReactDOM))})(this,function(A,v,wu){"use strict";function y2(r){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(r){for(const t in r)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return e.default=r,Object.freeze(e)}const W=y2(v);var fo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function b2(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var xu={exports:{}},go={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function w2(){if(Xg)return go;Xg=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var c in i)c!=="key"&&(s[c]=i[c])}else s=i;return i=s.ref,{$$typeof:r,type:n,key:a,ref:i!==void 0?i:null,props:s}}return go.Fragment=e,go.jsx=t,go.jsxs=t,go}var po={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function x2(){return Gg||(Gg=1,process.env.NODE_ENV!=="production"&&function(){function r(P){if(P==null)return null;if(typeof P=="function")return P.$$typeof===oe?null:P.displayName||P.name||null;if(typeof P=="string")return P;switch(P){case N:return"Fragment";case L:return"Portal";case R:return"Profiler";case H:return"StrictMode";case $:return"Suspense";case G:return"SuspenseList"}if(typeof P=="object")switch(typeof P.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),P.$$typeof){case U:return(P.displayName||"Context")+".Provider";case X:return(P._context.displayName||"Context")+".Consumer";case K:var le=P.render;return P=P.displayName,P||(P=le.displayName||le.name||"",P=P!==""?"ForwardRef("+P+")":"ForwardRef"),P;case re:return le=P.displayName||null,le!==null?le:r(P.type)||"Memo";case fe:le=P._payload,P=P._init;try{return r(P(le))}catch{}}return null}function e(P){return""+P}function t(P){try{e(P);var le=!1}catch{le=!0}if(le){le=console;var ce=le.error,Oe=typeof Symbol=="function"&&Symbol.toStringTag&&P[Symbol.toStringTag]||P.constructor.name||"Object";return ce.call(le,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",Oe),e(P)}}function n(){}function i(){if(Re===0){_e=console.log,ke=console.info,ht=console.warn,ar=console.error,Vt=console.group,Ot=console.groupCollapsed,cr=console.groupEnd;var P={configurable:!0,enumerable:!0,value:n,writable:!0};Object.defineProperties(console,{info:P,log:P,warn:P,error:P,group:P,groupCollapsed:P,groupEnd:P})}Re++}function s(){if(Re--,Re===0){var P={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:ne({},P,{value:_e}),info:ne({},P,{value:ke}),warn:ne({},P,{value:ht}),error:ne({},P,{value:ar}),group:ne({},P,{value:Vt}),groupCollapsed:ne({},P,{value:Ot}),groupEnd:ne({},P,{value:cr})})}0>Re&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function a(P){if(pe===void 0)try{throw Error()}catch(ce){var le=ce.stack.trim().match(/\n( *(at )?)/);pe=le&&le[1]||"",xr=-1<ce.stack.indexOf(`
    at`)?" (<anonymous>)":-1<ce.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pe+P+xr}function c(P,le){if(!P||rt)return"";var ce=Lt.get(P);if(ce!==void 0)return ce;rt=!0,ce=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var Oe=null;Oe=se.H,se.H=null,i();try{var Ke={DetermineComponentFrameRoot:function(){try{if(le){var ur=function(){throw Error()};if(Object.defineProperty(ur.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ur,[])}catch(er){var yn=er}Reflect.construct(P,[],ur)}else{try{ur.call()}catch(er){yn=er}P.call(ur.prototype)}}else{try{throw Error()}catch(er){yn=er}(ur=P())&&typeof ur.catch=="function"&&ur.catch(function(){})}}catch(er){if(er&&yn&&typeof er.stack=="string")return[er.stack,yn.stack]}return[null,null]}};Ke.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var $e=Object.getOwnPropertyDescriptor(Ke.DetermineComponentFrameRoot,"name");$e&&$e.configurable&&Object.defineProperty(Ke.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var be=Ke.DetermineComponentFrameRoot(),nt=be[0],lr=be[1];if(nt&&lr){var xt=nt.split(`
`),Sr=lr.split(`
`);for(be=$e=0;$e<xt.length&&!xt[$e].includes("DetermineComponentFrameRoot");)$e++;for(;be<Sr.length&&!Sr[be].includes("DetermineComponentFrameRoot");)be++;if($e===xt.length||be===Sr.length)for($e=xt.length-1,be=Sr.length-1;1<=$e&&0<=be&&xt[$e]!==Sr[be];)be--;for(;1<=$e&&0<=be;$e--,be--)if(xt[$e]!==Sr[be]){if($e!==1||be!==1)do if($e--,be--,0>be||xt[$e]!==Sr[be]){var rn=`
`+xt[$e].replace(" at new "," at ");return P.displayName&&rn.includes("<anonymous>")&&(rn=rn.replace("<anonymous>",P.displayName)),typeof P=="function"&&Lt.set(P,rn),rn}while(1<=$e&&0<=be);break}}}finally{rt=!1,se.H=Oe,s(),Error.prepareStackTrace=ce}return xt=(xt=P?P.displayName||P.name:"")?a(xt):"",typeof P=="function"&&Lt.set(P,xt),xt}function u(P){if(P==null)return"";if(typeof P=="function"){var le=P.prototype;return c(P,!(!le||!le.isReactComponent))}if(typeof P=="string")return a(P);switch(P){case $:return a("Suspense");case G:return a("SuspenseList")}if(typeof P=="object")switch(P.$$typeof){case K:return P=c(P.render,!1),P;case re:return u(P.type);case fe:le=P._payload,P=P._init;try{return u(P(le))}catch{}}return""}function h(){var P=se.A;return P===null?null:P.getOwner()}function d(P){if(de.call(P,"key")){var le=Object.getOwnPropertyDescriptor(P,"key").get;if(le&&le.isReactWarning)return!1}return P.key!==void 0}function g(P,le){function ce(){Qe||(Qe=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",le))}ce.isReactWarning=!0,Object.defineProperty(P,"key",{get:ce,configurable:!0})}function p(){var P=r(this.type);return Pt[P]||(Pt[P]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),P=this.props.ref,P!==void 0?P:null}function y(P,le,ce,Oe,Ke,$e){return ce=$e.ref,P={$$typeof:M,type:P,key:le,props:$e,_owner:Ke},(ce!==void 0?ce:null)!==null?Object.defineProperty(P,"ref",{enumerable:!1,get:p}):Object.defineProperty(P,"ref",{enumerable:!1,value:null}),P._store={},Object.defineProperty(P._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(P,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.freeze&&(Object.freeze(P.props),Object.freeze(P)),P}function w(P,le,ce,Oe,Ke,$e){if(typeof P=="string"||typeof P=="function"||P===N||P===R||P===H||P===$||P===G||P===Q||typeof P=="object"&&P!==null&&(P.$$typeof===fe||P.$$typeof===re||P.$$typeof===U||P.$$typeof===X||P.$$typeof===K||P.$$typeof===Fe||P.getModuleId!==void 0)){var be=le.children;if(be!==void 0)if(Oe)if(Ge(be)){for(Oe=0;Oe<be.length;Oe++)_(be[Oe],P);Object.freeze&&Object.freeze(be)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else _(be,P)}else be="",(P===void 0||typeof P=="object"&&P!==null&&Object.keys(P).length===0)&&(be+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),P===null?Oe="null":Ge(P)?Oe="array":P!==void 0&&P.$$typeof===M?(Oe="<"+(r(P.type)||"Unknown")+" />",be=" Did you accidentally export a JSX literal instead of a component?"):Oe=typeof P,console.error("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Oe,be);if(de.call(le,"key")){be=r(P);var nt=Object.keys(le).filter(function(xt){return xt!=="key"});Oe=0<nt.length?"{key: someKey, "+nt.join(": ..., ")+": ...}":"{key: someKey}",Vn[be+Oe]||(nt=0<nt.length?"{"+nt.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Oe,be,nt,be),Vn[be+Oe]=!0)}if(be=null,ce!==void 0&&(t(ce),be=""+ce),d(le)&&(t(le.key),be=""+le.key),"key"in le){ce={};for(var lr in le)lr!=="key"&&(ce[lr]=le[lr])}else ce=le;return be&&g(ce,typeof P=="function"?P.displayName||P.name||"Unknown":P),y(P,be,$e,Ke,h(),ce)}function _(P,le){if(typeof P=="object"&&P&&P.$$typeof!==gi){if(Ge(P))for(var ce=0;ce<P.length;ce++){var Oe=P[ce];S(Oe)&&T(Oe,le)}else if(S(P))P._store&&(P._store.validated=1);else if(P===null||typeof P!="object"?ce=null:(ce=ue&&P[ue]||P["@@iterator"],ce=typeof ce=="function"?ce:null),typeof ce=="function"&&ce!==P.entries&&(ce=ce.call(P),ce!==P))for(;!(P=ce.next()).done;)S(P.value)&&T(P.value,le)}}function S(P){return typeof P=="object"&&P!==null&&P.$$typeof===M}function T(P,le){if(P._store&&!P._store.validated&&P.key==null&&(P._store.validated=1,le=k(le),!_r[le])){_r[le]=!0;var ce="";P&&P._owner!=null&&P._owner!==h()&&(ce=null,typeof P._owner.tag=="number"?ce=r(P._owner.type):typeof P._owner.name=="string"&&(ce=P._owner.name),ce=" It was passed a child from "+ce+".");var Oe=se.getCurrentStack;se.getCurrentStack=function(){var Ke=u(P.type);return Oe&&(Ke+=Oe()||""),Ke},console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',le,ce),se.getCurrentStack=Oe}}function k(P){var le="",ce=h();return ce&&(ce=r(ce.type))&&(le=`

Check the render method of \``+ce+"`."),le||(P=r(P))&&(le=`

Check the top-level render call using <`+P+">."),le}var I=v,M=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),U=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),Q=Symbol.for("react.offscreen"),ue=Symbol.iterator,oe=Symbol.for("react.client.reference"),se=I.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=Object.prototype.hasOwnProperty,ne=Object.assign,Fe=Symbol.for("react.client.reference"),Ge=Array.isArray,Re=0,_e,ke,ht,ar,Vt,Ot,cr;n.__reactDisabledLog=!0;var pe,xr,rt=!1,Lt=new(typeof WeakMap=="function"?WeakMap:Map),gi=Symbol.for("react.client.reference"),Qe,Pt={},Vn={},_r={};po.Fragment=N,po.jsx=function(P,le,ce,Oe,Ke){return w(P,le,ce,!1,Oe,Ke)},po.jsxs=function(P,le,ce,Oe,Ke){return w(P,le,ce,!0,Oe,Ke)}}()),po}process.env.NODE_ENV==="production"?xu.exports=w2():xu.exports=x2();var b=xu.exports;function qg(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function Kg(...r){return e=>{let t=!1;const n=r.map(i=>{const s=qg(i,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let i=0;i<n.length;i++){const s=n[i];typeof s=="function"?s():qg(r[i],null)}}}}function Gt(...r){return W.useCallback(Kg(...r),r)}var ds=W.forwardRef((r,e)=>{const{children:t,...n}=r,i=W.Children.toArray(t),s=i.find(S2);if(s){const a=s.props.children,c=i.map(u=>u===s?W.Children.count(a)>1?W.Children.only(null):W.isValidElement(a)?a.props.children:null:u);return b.jsx(_u,{...n,ref:e,children:W.isValidElement(a)?W.cloneElement(a,void 0,c):null})}return b.jsx(_u,{...n,ref:e,children:t})});ds.displayName="Slot";var _u=W.forwardRef((r,e)=>{const{children:t,...n}=r;if(W.isValidElement(t)){const i=T2(t),s=C2(n,t.props);return t.type!==W.Fragment&&(s.ref=e?Kg(e,i):i),W.cloneElement(t,s)}return W.Children.count(t)>1?W.Children.only(null):null});_u.displayName="SlotClone";var _2=({children:r})=>b.jsx(b.Fragment,{children:r});function S2(r){return W.isValidElement(r)&&r.type===_2}function C2(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...c)=>{s(...c),i(...c)}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function T2(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var E2=ds;function Zg(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=Zg(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Jg(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=Zg(r))&&(n&&(n+=" "),n+=e);return n}const Qg=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,ep=Jg,k2=(r,e)=>t=>{var n;if(e?.variants==null)return ep(r,t?.class,t?.className);const{variants:i,defaultVariants:s}=e,a=Object.keys(i).map(h=>{const d=t?.[h],g=s?.[h];if(d===null)return null;const p=Qg(d)||Qg(g);return i[h][p]}),c=t&&Object.entries(t).reduce((h,d)=>{let[g,p]=d;return p===void 0||(h[g]=p),h},{}),u=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((h,d)=>{let{class:g,className:p,...y}=d;return Object.entries(y).every(w=>{let[_,S]=w;return Array.isArray(S)?S.includes({...s,...c}[_]):{...s,...c}[_]===S})?[...h,g,p]:h},[]);return ep(r,a,u,t?.class,t?.className)},Su="-",I2=r=>{const e=M2(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:a=>{const c=a.split(Su);return c[0]===""&&c.length!==1&&c.shift(),tp(c,e)||A2(a)},getConflictingClassGroupIds:(a,c)=>{const u=t[a]||[];return c&&n[a]?[...u,...n[a]]:u}}},tp=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),i=n?tp(r.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const s=r.join(Su);return e.validators.find(({validator:a})=>a(s))?.classGroupId},rp=/^\[(.+)\]$/,A2=r=>{if(rp.test(r)){const e=rp.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},M2=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return P2(Object.entries(r.classGroups),t).forEach(([s,a])=>{Cu(a,n,s,e)}),n},Cu=(r,e,t,n)=>{r.forEach(i=>{if(typeof i=="string"){const s=i===""?e:np(e,i);s.classGroupId=t;return}if(typeof i=="function"){if(O2(i)){Cu(i(n),e,t,n);return}e.validators.push({validator:i,classGroupId:t});return}Object.entries(i).forEach(([s,a])=>{Cu(a,np(e,s),t,n)})})},np=(r,e)=>{let t=r;return e.split(Su).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},O2=r=>r.isThemeGetter,P2=(r,e)=>e?r.map(([t,n])=>{const i=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,c])=>[e+a,c])):s);return[t,i]}):r,D2=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const i=(s,a)=>{t.set(s,a),e++,e>r&&(e=0,n=t,t=new Map)};return{get(s){let a=t.get(s);if(a!==void 0)return a;if((a=n.get(s))!==void 0)return i(s,a),a},set(s,a){t.has(s)?t.set(s,a):i(s,a)}}},ip="!",j2=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,i=e[0],s=e.length,a=c=>{const u=[];let h=0,d=0,g;for(let S=0;S<c.length;S++){let T=c[S];if(h===0){if(T===i&&(n||c.slice(S,S+s)===e)){u.push(c.slice(d,S)),d=S+s;continue}if(T==="/"){g=S;continue}}T==="["?h++:T==="]"&&h--}const p=u.length===0?c:c.substring(d),y=p.startsWith(ip),w=y?p.substring(1):p,_=g&&g>d?g-d:void 0;return{modifiers:u,hasImportantModifier:y,baseClassName:w,maybePostfixModifierPosition:_}};return t?c=>t({className:c,parseClassName:a}):a},L2=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},F2=r=>({cache:D2(r.cacheSize),parseClassName:j2(r),...I2(r)}),N2=/\s+/,R2=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:i}=e,s=[],a=r.trim().split(N2);let c="";for(let u=a.length-1;u>=0;u-=1){const h=a[u],{modifiers:d,hasImportantModifier:g,baseClassName:p,maybePostfixModifierPosition:y}=t(h);let w=!!y,_=n(w?p.substring(0,y):p);if(!_){if(!w){c=h+(c.length>0?" "+c:c);continue}if(_=n(p),!_){c=h+(c.length>0?" "+c:c);continue}w=!1}const S=L2(d).join(":"),T=g?S+ip:S,k=T+_;if(s.includes(k))continue;s.push(k);const I=i(_,w);for(let M=0;M<I.length;++M){const L=I[M];s.push(T+L)}c=h+(c.length>0?" "+c:c)}return c};function V2(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=sp(e))&&(n&&(n+=" "),n+=t);return n}const sp=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=sp(r[n]))&&(t&&(t+=" "),t+=e);return t};function B2(r,...e){let t,n,i,s=a;function a(u){const h=e.reduce((d,g)=>g(d),r());return t=F2(h),n=t.cache.get,i=t.cache.set,s=c,c(u)}function c(u){const h=n(u);if(h)return h;const d=R2(u,t);return i(u,d),d}return function(){return s(V2.apply(null,arguments))}}const tt=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},op=/^\[(?:([a-z-]+):)?(.+)\]$/i,z2=/^\d+\/\d+$/,H2=new Set(["px","full","screen"]),W2=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,U2=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$2=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Y2=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,X2=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Sn=r=>fs(r)||H2.has(r)||z2.test(r),qn=r=>gs(r,"length",tS),fs=r=>!!r&&!Number.isNaN(Number(r)),Tu=r=>gs(r,"number",fs),mo=r=>!!r&&Number.isInteger(Number(r)),G2=r=>r.endsWith("%")&&fs(r.slice(0,-1)),Te=r=>op.test(r),Kn=r=>W2.test(r),q2=new Set(["length","size","percentage"]),K2=r=>gs(r,q2,ap),Z2=r=>gs(r,"position",ap),J2=new Set(["image","url"]),Q2=r=>gs(r,J2,nS),eS=r=>gs(r,"",rS),vo=()=>!0,gs=(r,e,t)=>{const n=op.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},tS=r=>U2.test(r)&&!$2.test(r),ap=()=>!1,rS=r=>Y2.test(r),nS=r=>X2.test(r),iS=B2(()=>{const r=tt("colors"),e=tt("spacing"),t=tt("blur"),n=tt("brightness"),i=tt("borderColor"),s=tt("borderRadius"),a=tt("borderSpacing"),c=tt("borderWidth"),u=tt("contrast"),h=tt("grayscale"),d=tt("hueRotate"),g=tt("invert"),p=tt("gap"),y=tt("gradientColorStops"),w=tt("gradientColorStopPositions"),_=tt("inset"),S=tt("margin"),T=tt("opacity"),k=tt("padding"),I=tt("saturate"),M=tt("scale"),L=tt("sepia"),N=tt("skew"),H=tt("space"),R=tt("translate"),X=()=>["auto","contain","none"],U=()=>["auto","hidden","clip","visible","scroll"],K=()=>["auto",Te,e],$=()=>[Te,e],G=()=>["",Sn,qn],re=()=>["auto",fs,Te],fe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Q=()=>["solid","dashed","dotted","double","none"],ue=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],oe=()=>["start","end","center","between","around","evenly","stretch"],se=()=>["","0",Te],de=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ne=()=>[fs,Te];return{cacheSize:500,separator:":",theme:{colors:[vo],spacing:[Sn,qn],blur:["none","",Kn,Te],brightness:ne(),borderColor:[r],borderRadius:["none","","full",Kn,Te],borderSpacing:$(),borderWidth:G(),contrast:ne(),grayscale:se(),hueRotate:ne(),invert:se(),gap:$(),gradientColorStops:[r],gradientColorStopPositions:[G2,qn],inset:K(),margin:K(),opacity:ne(),padding:$(),saturate:ne(),scale:ne(),sepia:se(),skew:ne(),space:$(),translate:$()},classGroups:{aspect:[{aspect:["auto","square","video",Te]}],container:["container"],columns:[{columns:[Kn]}],"break-after":[{"break-after":de()}],"break-before":[{"break-before":de()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...fe(),Te]}],overflow:[{overflow:U()}],"overflow-x":[{"overflow-x":U()}],"overflow-y":[{"overflow-y":U()}],overscroll:[{overscroll:X()}],"overscroll-x":[{"overscroll-x":X()}],"overscroll-y":[{"overscroll-y":X()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",mo,Te]}],basis:[{basis:K()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Te]}],grow:[{grow:se()}],shrink:[{shrink:se()}],order:[{order:["first","last","none",mo,Te]}],"grid-cols":[{"grid-cols":[vo]}],"col-start-end":[{col:["auto",{span:["full",mo,Te]},Te]}],"col-start":[{"col-start":re()}],"col-end":[{"col-end":re()}],"grid-rows":[{"grid-rows":[vo]}],"row-start-end":[{row:["auto",{span:[mo,Te]},Te]}],"row-start":[{"row-start":re()}],"row-end":[{"row-end":re()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Te]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Te]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...oe()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...oe(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...oe(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[H]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[H]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Te,e]}],"min-w":[{"min-w":[Te,e,"min","max","fit"]}],"max-w":[{"max-w":[Te,e,"none","full","min","max","fit","prose",{screen:[Kn]},Kn]}],h:[{h:[Te,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Te,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Te,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Te,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Kn,qn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Tu]}],"font-family":[{font:[vo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Te]}],"line-clamp":[{"line-clamp":["none",fs,Tu]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Sn,Te]}],"list-image":[{"list-image":["none",Te]}],"list-style-type":[{list:["none","disc","decimal",Te]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Sn,qn]}],"underline-offset":[{"underline-offset":["auto",Sn,Te]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Te]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Te]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...fe(),Z2]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",K2]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Q2]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...Q(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:Q()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Q()]}],"outline-offset":[{"outline-offset":[Sn,Te]}],"outline-w":[{outline:[Sn,qn]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[Sn,qn]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Kn,eS]}],"shadow-color":[{shadow:[vo]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...ue(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ue()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Kn,Te]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[g]}],saturate:[{saturate:[I]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[g]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Te]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",Te]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",Te]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[mo,Te]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Te]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Te]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$()}],"scroll-mx":[{"scroll-mx":$()}],"scroll-my":[{"scroll-my":$()}],"scroll-ms":[{"scroll-ms":$()}],"scroll-me":[{"scroll-me":$()}],"scroll-mt":[{"scroll-mt":$()}],"scroll-mr":[{"scroll-mr":$()}],"scroll-mb":[{"scroll-mb":$()}],"scroll-ml":[{"scroll-ml":$()}],"scroll-p":[{"scroll-p":$()}],"scroll-px":[{"scroll-px":$()}],"scroll-py":[{"scroll-py":$()}],"scroll-ps":[{"scroll-ps":$()}],"scroll-pe":[{"scroll-pe":$()}],"scroll-pt":[{"scroll-pt":$()}],"scroll-pr":[{"scroll-pr":$()}],"scroll-pb":[{"scroll-pb":$()}],"scroll-pl":[{"scroll-pl":$()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Te]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Sn,qn,Tu]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function Ht(...r){return iS(Jg(r))}function sS(r,e={}){const{decimals:t=0,sizeType:n="normal"}=e,i=["Bytes","KB","MB","GB","TB"],s=["Bytes","KiB","MiB","GiB","TiB"];if(r===0)return"0 Byte";const a=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,a)).toFixed(t)} ${n==="accurate"?s[a]??"Bytest":i[a]??"Bytes"}`}const cp=k2("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),st=W.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...i},s)=>{const a=n?ds:"button";return b.jsx(a,{className:Ht(cp({variant:e,size:t,className:r})),ref:s,...i})});st.displayName="Button";function Eu(r,[e,t]){return Math.min(t,Math.max(e,r))}function ft(r,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(r?.(i),t===!1||!i.defaultPrevented)return e?.(i)}}function yo(r,e=[]){let t=[];function n(s,a){const c=W.createContext(a),u=t.length;t=[...t,a];const h=g=>{const{scope:p,children:y,...w}=g,_=p?.[r]?.[u]||c,S=W.useMemo(()=>w,Object.values(w));return b.jsx(_.Provider,{value:S,children:y})};h.displayName=s+"Provider";function d(g,p){const y=p?.[r]?.[u]||c,w=W.useContext(y);if(w)return w;if(a!==void 0)return a;throw new Error(`\`${g}\` must be used within \`${s}\``)}return[h,d]}const i=()=>{const s=t.map(a=>W.createContext(a));return function(c){const u=c?.[r]||s;return W.useMemo(()=>({[`__scope${r}`]:{...c,[r]:u}}),[c,u])}};return i.scopeName=r,[n,oS(i,...e)]}function oS(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=n.reduce((c,{useScope:u,scopeName:h})=>{const g=u(s)[`__scope${h}`];return{...c,...g}},{});return W.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function cn(r){const e=W.useRef(r);return W.useEffect(()=>{e.current=r}),W.useMemo(()=>(...t)=>e.current?.(...t),[])}function ku({prop:r,defaultProp:e,onChange:t=()=>{}}){const[n,i]=aS({defaultProp:e,onChange:t}),s=r!==void 0,a=s?r:n,c=cn(t),u=W.useCallback(h=>{if(s){const g=typeof h=="function"?h(r):h;g!==r&&c(g)}else i(h)},[s,r,i,c]);return[a,u]}function aS({defaultProp:r,onChange:e}){const t=W.useState(r),[n]=t,i=W.useRef(n),s=cn(e);return W.useEffect(()=>{i.current!==n&&(s(n),i.current=n)},[n,i,s]),t}var cS=W.createContext(void 0);function Oa(r){const e=W.useContext(cS);return r||e||"ltr"}function lS(r){const e=W.useRef({value:r,previous:r});return W.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var bo=globalThis?.document?W.useLayoutEffect:()=>{};function uS(r){const[e,t]=W.useState(void 0);return bo(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let a,c;if("borderBoxSize"in s){const u=s.borderBoxSize,h=Array.isArray(u)?u[0]:u;a=h.inlineSize,c=h.blockSize}else a=r.offsetWidth,c=r.offsetHeight;t({width:a,height:c})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var hS=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],qt=hS.reduce((r,e)=>{const t=W.forwardRef((n,i)=>{const{asChild:s,...a}=n,c=s?ds:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),b.jsx(c,{...a,ref:i})});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{});function lp(r){const e=r+"CollectionProvider",[t,n]=yo(e),[i,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),a=y=>{const{scope:w,children:_}=y,S=v.useRef(null),T=v.useRef(new Map).current;return b.jsx(i,{scope:w,itemMap:T,collectionRef:S,children:_})};a.displayName=e;const c=r+"CollectionSlot",u=v.forwardRef((y,w)=>{const{scope:_,children:S}=y,T=s(c,_),k=Gt(w,T.collectionRef);return b.jsx(ds,{ref:k,children:S})});u.displayName=c;const h=r+"CollectionItemSlot",d="data-radix-collection-item",g=v.forwardRef((y,w)=>{const{scope:_,children:S,...T}=y,k=v.useRef(null),I=Gt(w,k),M=s(h,_);return v.useEffect(()=>(M.itemMap.set(k,{ref:k,...T}),()=>void M.itemMap.delete(k))),b.jsx(ds,{[d]:"",ref:I,children:S})});g.displayName=h;function p(y){const w=s(r+"CollectionConsumer",y);return v.useCallback(()=>{const S=w.collectionRef.current;if(!S)return[];const T=Array.from(S.querySelectorAll(`[${d}]`));return Array.from(w.itemMap.values()).sort((M,L)=>T.indexOf(M.ref.current)-T.indexOf(L.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:a,Slot:u,ItemSlot:g},p,n]}var up=["PageUp","PageDown"],hp=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],dp={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ps="Slider",[Iu,dS,fS]=lp(ps),[fp,YF]=yo(ps,[fS]),[gS,Pa]=fp(ps),gp=W.forwardRef((r,e)=>{const{name:t,min:n=0,max:i=100,step:s=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:u=0,defaultValue:h=[n],value:d,onValueChange:g=()=>{},onValueCommit:p=()=>{},inverted:y=!1,form:w,..._}=r,S=W.useRef(new Set),T=W.useRef(0),I=a==="horizontal"?pS:mS,[M=[],L]=ku({prop:d,defaultProp:h,onChange:K=>{[...S.current][T.current]?.focus(),g(K)}}),N=W.useRef(M);function H(K){const $=xS(M,K);U(K,$)}function R(K){U(K,T.current)}function X(){const K=N.current[T.current];M[T.current]!==K&&p(M)}function U(K,$,{commit:G}={commit:!1}){const re=TS(s),fe=ES(Math.round((K-n)/s)*s+n,re),Q=Eu(fe,[n,i]);L((ue=[])=>{const oe=bS(ue,Q,$);if(CS(oe,u*s)){T.current=oe.indexOf(Q);const se=String(oe)!==String(ue);return se&&G&&p(oe),se?oe:ue}else return ue})}return b.jsx(gS,{scope:r.__scopeSlider,name:t,disabled:c,min:n,max:i,valueIndexToChangeRef:T,thumbs:S.current,values:M,orientation:a,form:w,children:b.jsx(Iu.Provider,{scope:r.__scopeSlider,children:b.jsx(Iu.Slot,{scope:r.__scopeSlider,children:b.jsx(I,{"aria-disabled":c,"data-disabled":c?"":void 0,..._,ref:e,onPointerDown:ft(_.onPointerDown,()=>{c||(N.current=M)}),min:n,max:i,inverted:y,onSlideStart:c?void 0:H,onSlideMove:c?void 0:R,onSlideEnd:c?void 0:X,onHomeKeyDown:()=>!c&&U(n,0,{commit:!0}),onEndKeyDown:()=>!c&&U(i,M.length-1,{commit:!0}),onStepKeyDown:({event:K,direction:$})=>{if(!c){const fe=up.includes(K.key)||K.shiftKey&&hp.includes(K.key)?10:1,Q=T.current,ue=M[Q],oe=s*fe*$;U(ue+oe,Q,{commit:!0})}}})})})})});gp.displayName=ps;var[pp,mp]=fp(ps,{startEdge:"left",endEdge:"right",size:"width",direction:1}),pS=W.forwardRef((r,e)=>{const{min:t,max:n,dir:i,inverted:s,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onStepKeyDown:h,...d}=r,[g,p]=W.useState(null),y=Gt(e,I=>p(I)),w=W.useRef(void 0),_=Oa(i),S=_==="ltr",T=S&&!s||!S&&s;function k(I){const M=w.current||g.getBoundingClientRect(),L=[0,M.width],H=Ou(L,T?[t,n]:[n,t]);return w.current=M,H(I-M.left)}return b.jsx(pp,{scope:r.__scopeSlider,startEdge:T?"left":"right",endEdge:T?"right":"left",direction:T?1:-1,size:"width",children:b.jsx(vp,{dir:_,"data-orientation":"horizontal",...d,ref:y,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const M=k(I.clientX);a?.(M)},onSlideMove:I=>{const M=k(I.clientX);c?.(M)},onSlideEnd:()=>{w.current=void 0,u?.()},onStepKeyDown:I=>{const L=dp[T?"from-left":"from-right"].includes(I.key);h?.({event:I,direction:L?-1:1})}})})}),mS=W.forwardRef((r,e)=>{const{min:t,max:n,inverted:i,onSlideStart:s,onSlideMove:a,onSlideEnd:c,onStepKeyDown:u,...h}=r,d=W.useRef(null),g=Gt(e,d),p=W.useRef(void 0),y=!i;function w(_){const S=p.current||d.current.getBoundingClientRect(),T=[0,S.height],I=Ou(T,y?[n,t]:[t,n]);return p.current=S,I(_-S.top)}return b.jsx(pp,{scope:r.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:b.jsx(vp,{"data-orientation":"vertical",...h,ref:g,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:_=>{const S=w(_.clientY);s?.(S)},onSlideMove:_=>{const S=w(_.clientY);a?.(S)},onSlideEnd:()=>{p.current=void 0,c?.()},onStepKeyDown:_=>{const T=dp[y?"from-bottom":"from-top"].includes(_.key);u?.({event:_,direction:T?-1:1})}})})}),vp=W.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:u,...h}=r,d=Pa(ps,t);return b.jsx(qt.span,{...h,ref:e,onKeyDown:ft(r.onKeyDown,g=>{g.key==="Home"?(a(g),g.preventDefault()):g.key==="End"?(c(g),g.preventDefault()):up.concat(hp).includes(g.key)&&(u(g),g.preventDefault())}),onPointerDown:ft(r.onPointerDown,g=>{const p=g.target;p.setPointerCapture(g.pointerId),g.preventDefault(),d.thumbs.has(p)?p.focus():n(g)}),onPointerMove:ft(r.onPointerMove,g=>{g.target.hasPointerCapture(g.pointerId)&&i(g)}),onPointerUp:ft(r.onPointerUp,g=>{const p=g.target;p.hasPointerCapture(g.pointerId)&&(p.releasePointerCapture(g.pointerId),s(g))})})}),yp="SliderTrack",bp=W.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,i=Pa(yp,t);return b.jsx(qt.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...n,ref:e})});bp.displayName=yp;var Au="SliderRange",wp=W.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,i=Pa(Au,t),s=mp(Au,t),a=W.useRef(null),c=Gt(e,a),u=i.values.length,h=i.values.map(p=>_p(p,i.min,i.max)),d=u>1?Math.min(...h):0,g=100-Math.max(...h);return b.jsx(qt.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:c,style:{...r.style,[s.startEdge]:d+"%",[s.endEdge]:g+"%"}})});wp.displayName=Au;var Mu="SliderThumb",xp=W.forwardRef((r,e)=>{const t=dS(r.__scopeSlider),[n,i]=W.useState(null),s=Gt(e,c=>i(c)),a=W.useMemo(()=>n?t().findIndex(c=>c.ref.current===n):-1,[t,n]);return b.jsx(vS,{...r,ref:s,index:a})}),vS=W.forwardRef((r,e)=>{const{__scopeSlider:t,index:n,name:i,...s}=r,a=Pa(Mu,t),c=mp(Mu,t),[u,h]=W.useState(null),d=Gt(e,k=>h(k)),g=u?a.form||!!u.closest("form"):!0,p=uS(u),y=a.values[n],w=y===void 0?0:_p(y,a.min,a.max),_=wS(n,a.values.length),S=p?.[c.size],T=S?_S(S,w,c.direction):0;return W.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),b.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${w}% + ${T}px)`},children:[b.jsx(Iu.ItemSlot,{scope:r.__scopeSlider,children:b.jsx(qt.span,{role:"slider","aria-label":r["aria-label"]||_,"aria-valuemin":a.min,"aria-valuenow":y,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...s,ref:d,style:y===void 0?{display:"none"}:r.style,onFocus:ft(r.onFocus,()=>{a.valueIndexToChangeRef.current=n})})}),g&&b.jsx(yS,{name:i??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:y},n)]})});xp.displayName=Mu;var yS=r=>{const{value:e,...t}=r,n=W.useRef(null),i=lS(e);return W.useEffect(()=>{const s=n.current,a=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(i!==e&&u){const h=new Event("input",{bubbles:!0});u.call(s,e),s.dispatchEvent(h)}},[i,e]),b.jsx("input",{style:{display:"none"},...t,ref:n,defaultValue:e})};function bS(r=[],e,t){const n=[...r];return n[t]=e,n.sort((i,s)=>i-s)}function _p(r,e,t){const s=100/(t-e)*(r-e);return Eu(s,[0,100])}function wS(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function xS(r,e){if(r.length===1)return 0;const t=r.map(i=>Math.abs(i-e)),n=Math.min(...t);return t.indexOf(n)}function _S(r,e,t){const n=r/2,s=Ou([0,50],[0,n]);return(n-s(e)*t)*t}function SS(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function CS(r,e){if(e>0){const t=SS(r);return Math.min(...t)>=e}return!0}function Ou(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function TS(r){return(String(r).split(".")[1]||"").length}function ES(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var Sp=gp,kS=bp,IS=wp,AS=xp;const Cp=W.forwardRef(({className:r,...e},t)=>b.jsxs(Sp,{ref:t,className:Ht("relative flex w-full touch-none select-none items-center",r),...e,children:[b.jsx(kS,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:b.jsx(IS,{className:"absolute h-full bg-primary"})}),b.jsx(AS,{className:"block h-4 w-4 cursor-pointer rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));Cp.displayName=Sp.displayName;function MS(r,e){return W.useReducer((t,n)=>e[t][n]??t,r)}var ms=r=>{const{present:e,children:t}=r,n=OS(e),i=typeof t=="function"?t({present:n.isPresent}):W.Children.only(t),s=Gt(n.ref,PS(i));return typeof t=="function"||n.isPresent?W.cloneElement(i,{ref:s}):null};ms.displayName="Presence";function OS(r){const[e,t]=W.useState(),n=W.useRef({}),i=W.useRef(r),s=W.useRef("none"),a=r?"mounted":"unmounted",[c,u]=MS(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const h=Da(n.current);s.current=c==="mounted"?h:"none"},[c]),bo(()=>{const h=n.current,d=i.current;if(d!==r){const p=s.current,y=Da(h);r?u("MOUNT"):y==="none"||h?.display==="none"?u("UNMOUNT"):u(d&&p!==y?"ANIMATION_OUT":"UNMOUNT"),i.current=r}},[r,u]),bo(()=>{if(e){let h;const d=e.ownerDocument.defaultView??window,g=y=>{const _=Da(n.current).includes(y.animationName);if(y.target===e&&_&&(u("ANIMATION_END"),!i.current)){const S=e.style.animationFillMode;e.style.animationFillMode="forwards",h=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=S)})}},p=y=>{y.target===e&&(s.current=Da(n.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{d.clearTimeout(h),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:W.useCallback(h=>{h&&(n.current=getComputedStyle(h)),t(h)},[])}}function Da(r){return r?.animationName||"none"}function PS(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function DS(r,e){return W.useReducer((t,n)=>e[t][n]??t,r)}var Pu="ScrollArea",[Tp,XF]=yo(Pu),[jS,Or]=Tp(Pu),Ep=W.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:i,scrollHideDelay:s=600,...a}=r,[c,u]=W.useState(null),[h,d]=W.useState(null),[g,p]=W.useState(null),[y,w]=W.useState(null),[_,S]=W.useState(null),[T,k]=W.useState(0),[I,M]=W.useState(0),[L,N]=W.useState(!1),[H,R]=W.useState(!1),X=Gt(e,K=>u(K)),U=Oa(i);return b.jsx(jS,{scope:t,type:n,dir:U,scrollHideDelay:s,scrollArea:c,viewport:h,onViewportChange:d,content:g,onContentChange:p,scrollbarX:y,onScrollbarXChange:w,scrollbarXEnabled:L,onScrollbarXEnabledChange:N,scrollbarY:_,onScrollbarYChange:S,scrollbarYEnabled:H,onScrollbarYEnabledChange:R,onCornerWidthChange:k,onCornerHeightChange:M,children:b.jsx(qt.div,{dir:U,...a,ref:X,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":I+"px",...r.style}})})});Ep.displayName=Pu;var kp="ScrollAreaViewport",Ip=W.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,nonce:i,...s}=r,a=Or(kp,t),c=W.useRef(null),u=Gt(e,c,a.onViewportChange);return b.jsxs(b.Fragment,{children:[b.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),b.jsx(qt.div,{"data-radix-scroll-area-viewport":"",...s,ref:u,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...r.style},children:b.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Ip.displayName=kp;var ln="ScrollAreaScrollbar",ja=W.forwardRef((r,e)=>{const{forceMount:t,...n}=r,i=Or(ln,r.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:a}=i,c=r.orientation==="horizontal";return W.useEffect(()=>(c?s(!0):a(!0),()=>{c?s(!1):a(!1)}),[c,s,a]),i.type==="hover"?b.jsx(LS,{...n,ref:e,forceMount:t}):i.type==="scroll"?b.jsx(FS,{...n,ref:e,forceMount:t}):i.type==="auto"?b.jsx(Ap,{...n,ref:e,forceMount:t}):i.type==="always"?b.jsx(Du,{...n,ref:e}):null});ja.displayName=ln;var LS=W.forwardRef((r,e)=>{const{forceMount:t,...n}=r,i=Or(ln,r.__scopeScrollArea),[s,a]=W.useState(!1);return W.useEffect(()=>{const c=i.scrollArea;let u=0;if(c){const h=()=>{window.clearTimeout(u),a(!0)},d=()=>{u=window.setTimeout(()=>a(!1),i.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",d),()=>{window.clearTimeout(u),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",d)}}},[i.scrollArea,i.scrollHideDelay]),b.jsx(ms,{present:t||s,children:b.jsx(Ap,{"data-state":s?"visible":"hidden",...n,ref:e})})}),FS=W.forwardRef((r,e)=>{const{forceMount:t,...n}=r,i=Or(ln,r.__scopeScrollArea),s=r.orientation==="horizontal",a=Ra(()=>u("SCROLL_END"),100),[c,u]=DS("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return W.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>u("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,i.scrollHideDelay,u]),W.useEffect(()=>{const h=i.viewport,d=s?"scrollLeft":"scrollTop";if(h){let g=h[d];const p=()=>{const y=h[d];g!==y&&(u("SCROLL"),a()),g=y};return h.addEventListener("scroll",p),()=>h.removeEventListener("scroll",p)}},[i.viewport,s,u,a]),b.jsx(ms,{present:t||c!=="hidden",children:b.jsx(Du,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:ft(r.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:ft(r.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),Ap=W.forwardRef((r,e)=>{const t=Or(ln,r.__scopeScrollArea),{forceMount:n,...i}=r,[s,a]=W.useState(!1),c=r.orientation==="horizontal",u=Ra(()=>{if(t.viewport){const h=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;a(c?h:d)}},10);return vs(t.viewport,u),vs(t.content,u),b.jsx(ms,{present:n||s,children:b.jsx(Du,{"data-state":s?"visible":"hidden",...i,ref:e})})}),Du=W.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,i=Or(ln,r.__scopeScrollArea),s=W.useRef(null),a=W.useRef(0),[c,u]=W.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Dp(c.viewport,c.content),d={...n,sizes:c,onSizesChange:u,hasThumb:h>0&&h<1,onThumbChange:p=>s.current=p,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:p=>a.current=p};function g(p,y){return HS(p,a.current,c,y)}return t==="horizontal"?b.jsx(NS,{...d,ref:e,onThumbPositionChange:()=>{if(i.viewport&&s.current){const p=i.viewport.scrollLeft,y=jp(p,c,i.dir);s.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollLeft=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollLeft=g(p,i.dir))}}):t==="vertical"?b.jsx(RS,{...d,ref:e,onThumbPositionChange:()=>{if(i.viewport&&s.current){const p=i.viewport.scrollTop,y=jp(p,c);s.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:p=>{i.viewport&&(i.viewport.scrollTop=p)},onDragScroll:p=>{i.viewport&&(i.viewport.scrollTop=g(p))}}):null}),NS=W.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...i}=r,s=Or(ln,r.__scopeScrollArea),[a,c]=W.useState(),u=W.useRef(null),h=Gt(e,u,s.onScrollbarXChange);return W.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),b.jsx(Op,{"data-orientation":"horizontal",...i,ref:h,sizes:t,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Na(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.x),onDragScroll:d=>r.onDragScroll(d.x),onWheelScroll:(d,g)=>{if(s.viewport){const p=s.viewport.scrollLeft+d.deltaX;r.onWheelScroll(p),Fp(p,g)&&d.preventDefault()}},onResize:()=>{u.current&&s.viewport&&a&&n({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:Fa(a.paddingLeft),paddingEnd:Fa(a.paddingRight)}})}})}),RS=W.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...i}=r,s=Or(ln,r.__scopeScrollArea),[a,c]=W.useState(),u=W.useRef(null),h=Gt(e,u,s.onScrollbarYChange);return W.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),b.jsx(Op,{"data-orientation":"vertical",...i,ref:h,sizes:t,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Na(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.y),onDragScroll:d=>r.onDragScroll(d.y),onWheelScroll:(d,g)=>{if(s.viewport){const p=s.viewport.scrollTop+d.deltaY;r.onWheelScroll(p),Fp(p,g)&&d.preventDefault()}},onResize:()=>{u.current&&s.viewport&&a&&n({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:Fa(a.paddingTop),paddingEnd:Fa(a.paddingBottom)}})}})}),[VS,Mp]=Tp(ln),Op=W.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:i,onThumbChange:s,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:h,onWheelScroll:d,onResize:g,...p}=r,y=Or(ln,t),[w,_]=W.useState(null),S=Gt(e,X=>_(X)),T=W.useRef(null),k=W.useRef(""),I=y.viewport,M=n.content-n.viewport,L=cn(d),N=cn(u),H=Ra(g,10);function R(X){if(T.current){const U=X.clientX-T.current.left,K=X.clientY-T.current.top;h({x:U,y:K})}}return W.useEffect(()=>{const X=U=>{const K=U.target;w?.contains(K)&&L(U,M)};return document.addEventListener("wheel",X,{passive:!1}),()=>document.removeEventListener("wheel",X,{passive:!1})},[I,w,M,L]),W.useEffect(N,[n,N]),vs(w,H),vs(y.content,H),b.jsx(VS,{scope:t,scrollbar:w,hasThumb:i,onThumbChange:cn(s),onThumbPointerUp:cn(a),onThumbPositionChange:N,onThumbPointerDown:cn(c),children:b.jsx(qt.div,{...p,ref:S,style:{position:"absolute",...p.style},onPointerDown:ft(r.onPointerDown,X=>{X.button===0&&(X.target.setPointerCapture(X.pointerId),T.current=w.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),R(X))}),onPointerMove:ft(r.onPointerMove,R),onPointerUp:ft(r.onPointerUp,X=>{const U=X.target;U.hasPointerCapture(X.pointerId)&&U.releasePointerCapture(X.pointerId),document.body.style.webkitUserSelect=k.current,y.viewport&&(y.viewport.style.scrollBehavior=""),T.current=null})})})}),La="ScrollAreaThumb",ju=W.forwardRef((r,e)=>{const{forceMount:t,...n}=r,i=Mp(La,r.__scopeScrollArea);return b.jsx(ms,{present:t||i.hasThumb,children:b.jsx(BS,{ref:e,...n})})}),BS=W.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...i}=r,s=Or(La,t),a=Mp(La,t),{onThumbPositionChange:c}=a,u=Gt(e,g=>a.onThumbChange(g)),h=W.useRef(void 0),d=Ra(()=>{h.current&&(h.current(),h.current=void 0)},100);return W.useEffect(()=>{const g=s.viewport;if(g){const p=()=>{if(d(),!h.current){const y=WS(g,c);h.current=y,c()}};return c(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[s.viewport,d,c]),b.jsx(qt.div,{"data-state":a.hasThumb?"visible":"hidden",...i,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ft(r.onPointerDownCapture,g=>{const y=g.target.getBoundingClientRect(),w=g.clientX-y.left,_=g.clientY-y.top;a.onThumbPointerDown({x:w,y:_})}),onPointerUp:ft(r.onPointerUp,a.onThumbPointerUp)})});ju.displayName=La;var Lu="ScrollAreaCorner",Pp=W.forwardRef((r,e)=>{const t=Or(Lu,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?b.jsx(zS,{...r,ref:e}):null});Pp.displayName=Lu;var zS=W.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,i=Or(Lu,t),[s,a]=W.useState(0),[c,u]=W.useState(0),h=!!(s&&c);return vs(i.scrollbarX,()=>{const d=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(d),u(d)}),vs(i.scrollbarY,()=>{const d=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(d),a(d)}),h?b.jsx(qt.div,{...n,ref:e,style:{width:s,height:c,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function Fa(r){return r?parseInt(r,10):0}function Dp(r,e){const t=r/e;return isNaN(t)?0:t}function Na(r){const e=Dp(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function HS(r,e,t,n="ltr"){const i=Na(t),s=i/2,a=e||s,c=i-a,u=t.scrollbar.paddingStart+a,h=t.scrollbar.size-t.scrollbar.paddingEnd-c,d=t.content-t.viewport,g=n==="ltr"?[0,d]:[d*-1,0];return Lp([u,h],g)(r)}function jp(r,e,t="ltr"){const n=Na(e),i=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=e.scrollbar.size-i,a=e.content-e.viewport,c=s-n,u=t==="ltr"?[0,a]:[a*-1,0],h=Eu(r,u);return Lp([0,a],[0,c])(h)}function Lp(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function Fp(r,e){return r>0&&r<e}var WS=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function i(){const s={left:r.scrollLeft,top:r.scrollTop},a=t.left!==s.left,c=t.top!==s.top;(a||c)&&e(),t=s,n=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(n)};function Ra(r,e){const t=cn(r),n=W.useRef(0);return W.useEffect(()=>()=>window.clearTimeout(n.current),[]),W.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function vs(r,e){const t=cn(e);bo(()=>{let n=0;if(r){const i=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return i.observe(r),()=>{window.cancelAnimationFrame(n),i.unobserve(r)}}},[r,t])}var Va=Ep,Fu=Ip,Np=ja,Rp=ju,US=Pp;const Ci=W.forwardRef(({className:r,children:e,...t},n)=>b.jsxs(Va,{ref:n,className:Ht("relative overflow-hidden",r),...t,children:[b.jsx(Fu,{className:"h-full w-full rounded-[inherit]",children:e}),b.jsx(Nu,{}),b.jsx(US,{})]}));Ci.displayName=Va.displayName;const Nu=W.forwardRef(({className:r,orientation:e="vertical",...t},n)=>b.jsx(ja,{ref:n,orientation:e,className:Ht("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:b.jsx(ju,{className:"relative flex-1 rounded-full bg-border"})}));Nu.displayName=ja.displayName;const wo=({children:r,renderCustomPreview:e,data:t={},shouldDisplayPreview:n=!0})=>{const[i,s]=v.useState(!1),[a,c]=v.useState({x:0,y:0}),u=v.useRef(null),h=y=>{s(!0),y.dataTransfer.setDragImage(new Image,0,0),y.dataTransfer.setData(JSON.stringify(t),JSON.stringify(t)),c({x:y.clientX,y:y.clientY})},d=()=>{s(!1)},g=y=>{i&&c({x:y.clientX,y:y.clientY})},p=v.cloneElement(r,{draggable:!0,onDragStart:h,onDragEnd:d,onDrag:g,style:{...r.props.style}});return b.jsxs(b.Fragment,{children:[p,i&&n&&e?wu.createPortal(b.jsx("div",{ref:u,style:{position:"fixed",left:a.x,top:a.y,pointerEvents:"none",zIndex:9999,transform:"translate(-50%, -50%)"},children:e}),document.body):null]})};var $S=W.useId||(()=>{}),YS=0;function Vp(r){const[e,t]=W.useState($S());return bo(()=>{t(n=>n??String(YS++))},[r]),e?`radix-${e}`:""}var Ru="rovingFocusGroup.onEntryFocus",XS={bubbles:!1,cancelable:!0},Ba="RovingFocusGroup",[Vu,Bp,GS]=lp(Ba),[qS,zp]=yo(Ba,[GS]),[KS,ZS]=qS(Ba),Hp=W.forwardRef((r,e)=>b.jsx(Vu.Provider,{scope:r.__scopeRovingFocusGroup,children:b.jsx(Vu.Slot,{scope:r.__scopeRovingFocusGroup,children:b.jsx(JS,{...r,ref:e})})}));Hp.displayName=Ba;var JS=W.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:i=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:h,preventScrollOnEntryFocus:d=!1,...g}=r,p=W.useRef(null),y=Gt(e,p),w=Oa(s),[_=null,S]=ku({prop:a,defaultProp:c,onChange:u}),[T,k]=W.useState(!1),I=cn(h),M=Bp(t),L=W.useRef(!1),[N,H]=W.useState(0);return W.useEffect(()=>{const R=p.current;if(R)return R.addEventListener(Ru,I),()=>R.removeEventListener(Ru,I)},[I]),b.jsx(KS,{scope:t,orientation:n,dir:w,loop:i,currentTabStopId:_,onItemFocus:W.useCallback(R=>S(R),[S]),onItemShiftTab:W.useCallback(()=>k(!0),[]),onFocusableItemAdd:W.useCallback(()=>H(R=>R+1),[]),onFocusableItemRemove:W.useCallback(()=>H(R=>R-1),[]),children:b.jsx(qt.div,{tabIndex:T||N===0?-1:0,"data-orientation":n,...g,ref:y,style:{outline:"none",...r.style},onMouseDown:ft(r.onMouseDown,()=>{L.current=!0}),onFocus:ft(r.onFocus,R=>{const X=!L.current;if(R.target===R.currentTarget&&X&&!T){const U=new CustomEvent(Ru,XS);if(R.currentTarget.dispatchEvent(U),!U.defaultPrevented){const K=M().filter(Q=>Q.focusable),$=K.find(Q=>Q.active),G=K.find(Q=>Q.id===_),fe=[$,G,...K].filter(Boolean).map(Q=>Q.ref.current);$p(fe,d)}}L.current=!1}),onBlur:ft(r.onBlur,()=>k(!1))})})}),Wp="RovingFocusGroupItem",Up=W.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:i=!1,tabStopId:s,...a}=r,c=Vp(),u=s||c,h=ZS(Wp,t),d=h.currentTabStopId===u,g=Bp(t),{onFocusableItemAdd:p,onFocusableItemRemove:y}=h;return W.useEffect(()=>{if(n)return p(),()=>y()},[n,p,y]),b.jsx(Vu.ItemSlot,{scope:t,id:u,focusable:n,active:i,children:b.jsx(qt.span,{tabIndex:d?0:-1,"data-orientation":h.orientation,...a,ref:e,onMouseDown:ft(r.onMouseDown,w=>{n?h.onItemFocus(u):w.preventDefault()}),onFocus:ft(r.onFocus,()=>h.onItemFocus(u)),onKeyDown:ft(r.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){h.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const _=tC(w,h.orientation,h.dir);if(_!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let T=g().filter(k=>k.focusable).map(k=>k.ref.current);if(_==="last")T.reverse();else if(_==="prev"||_==="next"){_==="prev"&&T.reverse();const k=T.indexOf(w.currentTarget);T=h.loop?rC(T,k+1):T.slice(k+1)}setTimeout(()=>$p(T))}})})})});Up.displayName=Wp;var QS={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function eC(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function tC(r,e,t){const n=eC(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return QS[n]}function $p(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function rC(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var nC=Hp,iC=Up,Bu="Tabs",[sC,GF]=yo(Bu,[zp]),Yp=zp(),[oC,zu]=sC(Bu),Xp=W.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:i,defaultValue:s,orientation:a="horizontal",dir:c,activationMode:u="automatic",...h}=r,d=Oa(c),[g,p]=ku({prop:n,onChange:i,defaultProp:s});return b.jsx(oC,{scope:t,baseId:Vp(),value:g,onValueChange:p,orientation:a,dir:d,activationMode:u,children:b.jsx(qt.div,{dir:d,"data-orientation":a,...h,ref:e})})});Xp.displayName=Bu;var Gp="TabsList",qp=W.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...i}=r,s=zu(Gp,t),a=Yp(t);return b.jsx(nC,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:n,children:b.jsx(qt.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:e})})});qp.displayName=Gp;var Kp="TabsTrigger",Zp=W.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:i=!1,...s}=r,a=zu(Kp,t),c=Yp(t),u=em(a.baseId,n),h=tm(a.baseId,n),d=n===a.value;return b.jsx(iC,{asChild:!0,...c,focusable:!i,active:d,children:b.jsx(qt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":h,"data-state":d?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...s,ref:e,onMouseDown:ft(r.onMouseDown,g=>{!i&&g.button===0&&g.ctrlKey===!1?a.onValueChange(n):g.preventDefault()}),onKeyDown:ft(r.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&a.onValueChange(n)}),onFocus:ft(r.onFocus,()=>{const g=a.activationMode!=="manual";!d&&!i&&g&&a.onValueChange(n)})})})});Zp.displayName=Kp;var Jp="TabsContent",Qp=W.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:i,children:s,...a}=r,c=zu(Jp,t),u=em(c.baseId,n),h=tm(c.baseId,n),d=n===c.value,g=W.useRef(d);return W.useEffect(()=>{const p=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(p)},[]),b.jsx(ms,{present:i||d,children:({present:p})=>b.jsx(qt.div,{"data-state":d?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!p,id:h,tabIndex:0,...a,ref:e,style:{...r.style,animationDuration:g.current?"0s":void 0},children:p&&s})})});Qp.displayName=Jp;function em(r,e){return`${r}-trigger-${e}`}function tm(r,e){return`${r}-content-${e}`}var aC=Xp,rm=qp,nm=Zp,im=Qp;const sm=aC,Hu=W.forwardRef(({className:r,...e},t)=>b.jsx(rm,{ref:t,className:Ht("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));Hu.displayName=rm.displayName;const za=W.forwardRef(({className:r,...e},t)=>b.jsx(nm,{ref:t,className:Ht("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...e}));za.displayName=nm.displayName;const Ha=W.forwardRef(({className:r,...e},t)=>b.jsx(im,{ref:t,className:Ht("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));Ha.displayName=im.displayName;const cC="add",lC="track",uC="trackItems",hC="track:changed",dC="trackItems:changed",fC="state",gC="state:changed",om="add",Wu="add:text",ys="add:video",bs="add:audio",pC="add:placeholder",ws="add:image",mC="add:mask",vC="add:transition",yC="add:animation",bC="edit",wC="edit:object",xC="edit:text",_C="edit:shape",SC="enterEditMode",am="player",Uu="player:play",$u="player:pause",cm="player:seek",CC="player:seekTo",lm="player:seekBy",um="player:togglePlay",hm="active",TC="active:set",Yu="active:delete",EC="active:paste",Xu="active:clone",Gu="active:split",dm="layer",kC="layer:locked",IC="layer:hidden",AC="layer:move",MC="layer:select",qu="layer:selection",OC="layer:sendTo",PC="layer:rename",DC="layer:editingName",jC="layer:copy",LC="layer:paste",FC="layer:clone",NC="layer:split",RC="layer:cut",VC="layer:delete",fm="history",Ku="history:undo",Zu="history:redo",BC="history:reset",gm="scale",Ju="scale:changed",pm="drag",Qu="drag:start",xo="drag:end",mm="timeline",eh="timeline:boundingChanged";var th=function(r,e){return th=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},th(r,e)};function xs(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");th(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function rh(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nh(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function ih(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;function un(r){return typeof r=="function"}function vm(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var sh=vm(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function oh(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var Wa=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,i,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=rh(a),u=c.next();!u.done;u=c.next()){var h=u.value;h.remove(this)}}catch(_){e={error:_}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(un(d))try{d()}catch(_){s=_ instanceof sh?_.errors:[_]}var g=this._finalizers;if(g){this._finalizers=null;try{for(var p=rh(g),y=p.next();!y.done;y=p.next()){var w=y.value;try{wm(w)}catch(_){s=s??[],_ instanceof sh?s=ih(ih([],nh(s)),nh(_.errors)):s.push(_)}}}catch(_){n={error:_}}finally{try{y&&!y.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}}if(s)throw new sh(s)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)wm(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&oh(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&oh(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),ym=Wa.EMPTY;function bm(r){return r instanceof Wa||r&&"closed"in r&&un(r.remove)&&un(r.add)&&un(r.unsubscribe)}function wm(r){un(r)?r():r.unsubscribe()}var zC={Promise:void 0},HC={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,ih([r,e],nh(t)))},clearTimeout:function(r){return clearTimeout(r)},delegate:void 0};function WC(r){HC.setTimeout(function(){throw r})}function xm(){}function Ua(r){r()}var ah=function(r){xs(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,bm(t)&&t.add(n)):n.destination=YC,n}return e.create=function(t,n,i){return new ch(t,n,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Wa),UC=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){$a(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){$a(n)}else $a(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){$a(t)}},r}(),ch=function(r){xs(e,r);function e(t,n,i){var s=r.call(this)||this,a;return un(t)||!t?a={next:t??void 0,error:n??void 0,complete:i??void 0}:a=t,s.destination=new UC(a),s}return e}(ah);function $a(r){WC(r)}function $C(r){throw r}var YC={closed:!0,next:xm,error:$C,complete:xm},XC=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function GC(r){return r}function qC(r){return r.length===0?GC:r.length===1?r[0]:function(t){return r.reduce(function(n,i){return i(n)},t)}}var _m=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var i=this,s=ZC(e)?e:new ch(e,t,n);return Ua(function(){var a=i,c=a.operator,u=a.source;s.add(c?c.call(s,u):u?i._subscribe(s):i._trySubscribe(s))}),s},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=Sm(t),new t(function(i,s){var a=new ch({next:function(c){try{e(c)}catch(u){s(u),a.unsubscribe()}},error:s,complete:i});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[XC]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qC(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=Sm(e),new e(function(n,i){var s;t.subscribe(function(a){return s=a},function(a){return i(a)},function(){return n(s)})})},r.create=function(e){return new r(e)},r}();function Sm(r){var e;return(e=r??zC.Promise)!==null&&e!==void 0?e:Promise}function KC(r){return r&&un(r.next)&&un(r.error)&&un(r.complete)}function ZC(r){return r&&r instanceof ah||KC(r)&&bm(r)}function JC(r){return un(r?.lift)}function QC(r){return function(e){if(JC(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function eT(r,e,t,n,i){return new tT(r,e,t,n,i)}var tT=function(r){xs(e,r);function e(t,n,i,s,a,c){var u=r.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=c,u._next=n?function(h){try{n(h)}catch(d){t.error(d)}}:r.prototype._next,u._error=s?function(h){try{s(h)}catch(d){t.error(d)}finally{this.unsubscribe()}}:r.prototype._error,u._complete=i?function(){try{i()}catch(h){t.error(h)}finally{this.unsubscribe()}}:r.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(ah),rT=vm(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),lh=function(r){xs(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new Cm(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new rT},e.prototype.next=function(t){var n=this;Ua(function(){var i,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=rh(n.currentObservers),c=a.next();!c.done;c=a.next()){var u=c.value;u.next(t)}}catch(h){i={error:h}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var n=this;Ua(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var i=n.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;Ua(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,i=this,s=i.hasError,a=i.isStopped,c=i.observers;return s||a?ym:(this.currentObservers=null,c.push(t),new Wa(function(){n.currentObservers=null,oh(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,i=n.hasError,s=n.thrownError,a=n.isStopped;i?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new _m;return t.source=this,t},e.create=function(t,n){return new Cm(t,n)},e}(_m),Cm=function(r){xs(e,r);function e(t,n){var i=r.call(this)||this;return i.destination=t,i.source=n,i}return e.prototype.next=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,t)},e.prototype.error=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&i!==void 0?i:ym},e}(lh),Tm=function(r){xs(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,i=t.thrownError,s=t._value;if(n)throw i;return this._throwIfClosed(),s},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e}(lh);function Cn(r,e){return QC(function(t,n){var i=0;t.subscribe(eT(n,function(s){return r.call(e,s,i++)&&n.next(s)}))})}const Em=new lh,je={subject:Em,dispatch:(r,e)=>{Em.next({key:r,value:e})}},Nt=[];for(let r=0;r<256;++r)Nt.push((r+256).toString(16).slice(1));function nT(r,e=0){return(Nt[r[e+0]]+Nt[r[e+1]]+Nt[r[e+2]]+Nt[r[e+3]]+"-"+Nt[r[e+4]]+Nt[r[e+5]]+"-"+Nt[r[e+6]]+Nt[r[e+7]]+"-"+Nt[r[e+8]]+Nt[r[e+9]]+"-"+Nt[r[e+10]]+Nt[r[e+11]]+Nt[r[e+12]]+Nt[r[e+13]]+Nt[r[e+14]]+Nt[r[e+15]]).toLowerCase()}let uh;const iT=new Uint8Array(16);function sT(){if(!uh){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");uh=crypto.getRandomValues.bind(crypto)}return uh(iT)}const km={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function kt(r,e,t){if(km.randomUUID&&!r)return km.randomUUID();r=r||{};const n=r.random??r.rng?.()??sT();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,nT(n)}var Im=(r=>(r.IMAGE="image",r.VIDEO="video",r.AUDIO="audio",r))(Im||{});const oT=r=>{const[e,t]=v.useState(!1),[n,i]=v.useState(!1),s=v.useCallback(d=>{const g={...d,id:kt()};switch(d.type){case"image":je.dispatch(ws,{payload:g});break;case"video":je.dispatch(ys,{payload:g});break;case"audio":je.dispatch(bs,{payload:g});break}},[]),a=v.useCallback(d=>{d.preventDefault();try{const g=d.dataTransfer?.types[0],p=JSON.parse(g);if(!Object.values(Im).includes(p.type))return;i(!0),t(!0),r?.(!0)}catch(g){console.error("Error parsing dragged data:",g)}},[r]),c=v.useCallback(d=>{d.preventDefault(),e&&(i(!0),r?.(!0))},[e,r]),u=v.useCallback(d=>{if(n){d.preventDefault(),i(!1),r?.(!1);try{const g=d.dataTransfer?.types[0],p=JSON.parse(d.dataTransfer.getData(g));s(p)}catch(g){console.error("Error parsing dropped data:",g)}}},[n,r,s]),h=v.useCallback(d=>{d.preventDefault(),d.currentTarget.contains(d.relatedTarget)||(i(!1),t(!1),r?.(!1))},[r]);return{onDragEnter:a,onDragOver:c,onDrop:u,onDragLeave:h,isDraggingOver:n}},Am=({children:r,className:e,style:t,onDragStateChange:n,id:i})=>{const{onDragEnter:s,onDragOver:a,onDrop:c,onDragLeave:u}=oT(n);return b.jsx("div",{id:i,onDragEnter:s,onDrop:c,onDragOver:a,onDragLeave:u,className:e,style:t,role:"region","aria-label":"Droppable area for images, videos, and audio",children:r})},aT=({size:r,children:e})=>{const[t,n]=v.useState(!1);return b.jsxs(Am,{id:"artboard",onDragStateChange:n,style:{width:r.width,height:r.height},className:"designcombo_scene pointer-events-auto mt-3.5 bg-black",children:[b.jsx("div",{style:{width:r.width,height:r.height},className:`pointer-events-none absolute z-50 mt-3.5 transition-colors duration-200 ease-in-out ${t?"border-4 border-dashed border-white bg-white/[0.075]":"bg-transparent"} shadow-[0_0_0_5000px_#1D1D1F]`}),e]})},cT=100,lT=30,uT=18,hT=14,dT=30,fT=24,gT=16,Mm=12,pT="Regular",Om="sans-serif",_o=188,Ya=40,mT=4e3,Pm=1920,Dm=1080,jm=60,Lm=1e3/jm,vT=2e6,yT=1e7,bT=48e3,wT=192e3,hh=2.3,xT=Pm/hh,_T=Dm/hh,ST=184,CT=348,TT=512,ET=300,kT=0,IT=5e3,AT=1,MT=0,OT=0,PT=0,DT=359,jT=1,LT=0,FT=!1,NT=!1,RT=0,VT=2,BT=.01,zT=1,HT=0,WT=3,UT=.01,$T=1,YT=0,XT=1,GT=.01,qT=.5,KT=-1e3,ZT=1e3,JT=1,QT=1,eE=0,tE=1,rE=.01,nE=1,iE=0,sE=1,oE=.01,aE=0,cE=.5,lE=10,uE=.01,hE=1,dE=0,fE=1,gE=.01,pE=1,Xa=16,dh=80;function Fm(r){if(!r)return"0";const e=r/_o,t=Math.trunc(e)%60,n=Math.trunc(e/60)%60,i=Math.trunc(e/3600)%60,a=[Math.trunc(e/216e3).toString(),i.toString(),n.toString(),t.toString()];return e<60?`${a[3].padStart(2,"0")}f`:e<3600?`${a[2].padStart(1,"0")}s`:e<216e3?`${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`:`${a[0].padStart(2,"0")}:${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`}function mE(r,e=!1){if(!r)return"00:00";const n=1e3/60;if(r<1e3)return e?`${Math.floor(r/n)}f`:`${(r/1e3).toFixed(1)}s`;const i=Math.floor(r/1e3);if(i<60)return`${i}s`;const s=Math.floor(i/60);if(s<60){const h=i%60;return`${s.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}const a=Math.floor(s/60),c=s%60,u=i%60;return`${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}function So(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}const Nm=({frame:r},{fps:e})=>{const t=r/e,n=Math.floor(t/3600),i=t%3600,s=Math.floor(i/60),a=Math.floor(i%60),c=Math.floor((i-Math.floor(i))*100);return n>0?`${n}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},Rm=({time:r})=>{const e=r/1e3,t=Math.floor(e/3600),n=e%3600,i=Math.floor(n/60),s=Math.floor(n%60),a=Math.floor((n-Math.floor(n))*100);return t>0?`${t}:${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},Vm=()=>{const r=document.getElementById("video-current-time");return(r?parseFloat(r.getAttribute("data-current-time")??""):0)*1e3},Yr=[{index:0,unit:18e3,zoom:1/18e3,segments:5},{index:1,unit:10800,zoom:1/10800,segments:3},{index:2,unit:7200,zoom:1/7200,segments:2},{index:3,unit:3600,zoom:1/3600,segments:1},{index:4,unit:1800,zoom:1/1800,segments:2},{index:5,unit:900,zoom:1/900,segments:3},{index:6,unit:600,zoom:1/600,segments:2},{index:7,unit:300,zoom:1/300,segments:5},{index:8,unit:180,zoom:1/180,segments:3},{index:9,unit:120,zoom:1/120,segments:10},{index:10,unit:60,zoom:1/60,segments:5},{index:11,unit:60,zoom:1/60,segments:5},{index:12,unit:30,zoom:1/30,segments:2},{index:13,unit:15,zoom:1/15,segments:3},{index:14,unit:10,zoom:1/10,segments:2},{index:15,unit:5,zoom:1/5,segments:5},{index:16,unit:3,zoom:1/3,segments:3},{index:17,unit:2,zoom:1/2,segments:5},{index:18,unit:1,zoom:1,segments:5},{index:19,unit:1,zoom:2,segments:5},{index:20,unit:1,zoom:4,segments:10}];function fh(r,e){let t=-1,n=r.length-1;for(;1+t<n;){const i=t+(n-t>>1);e(r[i],i,r)?n=i:t=i}return n}function vE(r,e=1){const t=()=>{const u=Math.max(0,Ya),d=document.getElementById("designcombo-timeline-canvas")?.offsetWidth??document.body.offsetWidth;return Math.max(1,d-u)},n=()=>typeof r=="number"?bt(r,e):$m(r,e),i=t()/n(),s=e*i;return{segments:5,index:fh(Yr,c=>c.zoom>s),zoom:s,unit:1/s}}function yE(r){return Yr[r]}function Bm(r){return zm(r)||Yr[0]}const zm=r=>{const e=Yr.filter(n=>n.zoom<r.zoom);return e.length===0?null:e.reduce((n,i)=>i.zoom>n.zoom?i:n)},Hm=r=>{const e=Yr.filter(n=>n.zoom>r.zoom);return e.length===0?null:e.reduce((n,i)=>i.zoom<n.zoom?i:n)};function Wm(r){return Hm(r)||Yr[Yr.length-1]}function bE(r){const e=Yr.at(-1),t=r===e,i=Um(r)-(t?1:2);return Math.max(0,i)}function Um(r){const e=fh(Yr,t=>t.zoom>r.zoom);return Math.min(Yr.length-1,e)}function bt(r,e=1,t=1){const n=_o*e;return r*(60/1e3)*n/t}function Zn(r,e=1){const t=_o*e;return r/t*Lm}function $m(r,e=1){return bt(r,e)}const wE=Math.floor(Math.random()*1e3)+1;function gh(r,e=1){const t=[],n=Math.floor(e),i=(s,a)=>{for(const c of s)Array.isArray(c)&&a<n?i(c,a+1):t.push(c)};return i(r,0),t}function ph(r,e){const t=e.sort((i,s)=>i.tempIndex-s.tempIndex),n=[];for(const i of t)i.tempIndex<0&&n.push(i);n.push(r);for(const i of t)i.tempIndex>=0&&n.push(i);return n}const mh={id:"font_UwdNKSyVq2iiMiuHSRRsUIOu",family:"Roboto",fullName:"Roboto Bold",postScriptName:"Roboto-Bold",preview:"https://ik.imagekit.io/lh/fonts/v2/5zQgS86djScKA0ri67BBCqW7.png",style:"Roboto-Bold",url:"https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmWUlvAx05IsDqlA.ttf",category:"sans-serif",createdAt:"2023-06-20T04:42:55.909Z",updatedAt:"2023-06-20T04:42:55.909Z",userId:null},Ym=r=>{const e=r.map(t=>new FontFace(t.fontFamily,`url(${t.fontUrl})`).load());return e.length===0?Promise.resolve(!0):new Promise((t,n)=>{Promise.all(e).then(i=>{i.forEach(s=>{s instanceof FontFace&&s.family&&(document.fonts.add(s),t(!0))})}).catch(i=>{n(i)})})},Xm=r=>{let e;const t=new Set,n=(h,d)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const p=e;e=d??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(y=>y(e,p))}},i=()=>e,c={setState:n,getState:i,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h))},u=e=r(n,i,c);return c},xE=r=>r?Xm(r):Xm,_E=r=>r;function SE(r,e=_E){const t=v.useSyncExternalStore(r.subscribe,()=>e(r.getState()),()=>e(r.getInitialState()));return v.useDebugValue(t),t}const Gm=r=>{const e=xE(r),t=n=>SE(e,n);return Object.assign(t,e),t},qm=r=>r?Gm(r):Gm,hn=qm(r=>({timeline:null,size:{width:1080,height:1920},duration:5e3,fps:30,scale:{index:7,unit:300,zoom:1/300,segments:5},scroll:{left:0,top:0},playerRef:null,activeIds:[],targetIds:[],tracks:[],trackItemIds:[],transitionIds:[],transitionsMap:{},trackItemDetailsMap:{},trackItemsMap:{},setTimeline:e=>{r(()=>({timeline:e}))},setScale:e=>{r(()=>({scale:e}))},setScroll:e=>{r(()=>({scroll:e}))},setState:async e=>{r({...e})},setPlayerRef:e=>{r({playerRef:e})}}));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Km=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=v.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...c},u)=>v.createElement("svg",{ref:u,...TE,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Km("lucide",i),...c},[...a.map(([h,d])=>v.createElement(h,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=(r,e)=>{const t=v.forwardRef(({className:n,...i},s)=>v.createElement(EE,{ref:s,iconNode:e,className:Km(`lucide-${CE(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=we("Captions",[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("FolderClosed",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M2 10h20",key:"1ir3d8"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=we("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("LayoutPanelLeft",[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=we("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=we("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=we("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Puzzle",[["path",{d:"M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98 0 0 1-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501 0 1 0-3.214 3.214c.446.166.855.497.925.968a.979.979 0 0 1-.276.837l-1.61 1.61a2.404 2.404 0 0 1-1.705.707 2.402 2.402 0 0 1-1.704-.706l-1.568-1.568a1.026 1.026 0 0 0-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5 0 1 1-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026 0 0 0-.289-.877l-1.568-1.568A2.402 2.402 0 0 1 1.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5 0 1 0 3.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402 0 0 1 12 1.998c.617 0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5 0 1 1 3.237 3.237c-.464.18-.894.527-.967 1.02Z",key:"i0oyt7"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("RectangleHorizontal",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("RectangleVertical",[["rect",{width:"12",height:"20",x:"6",y:"2",rx:"2",key:"1oxtiu"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=we("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=we("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=we("SquareSplitHorizontal",[["path",{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3",key:"lubmu8"}],["path",{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3",key:"1ag34g"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("SunMedium",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 3v1",key:"1asbbs"}],["path",{d:"M12 20v1",key:"1wcdkc"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M20 12h1",key:"1vloll"}],["path",{d:"m18.364 5.636-.707.707",key:"1hakh0"}],["path",{d:"m6.343 17.657-.707.707",key:"18m9nf"}],["path",{d:"m5.636 5.636.707.707",key:"1xv1c5"}],["path",{d:"m17.657 17.657.707.707",key:"vl76zb"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=we("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=we("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=we("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=we("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=we("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */we("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=we("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=we("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Ga=r=>{const e=v.useCallback(n=>{if(!r?.current)return()=>{};const i=()=>{n()};return r.current.addEventListener("frameupdate",i),()=>{r.current&&r.current.removeEventListener("frameupdate",i)}},[r]);return v.useSyncExternalStore(e,()=>r?.current?.getCurrentFrame()??0,()=>0)},Co=()=>{const[r,e]=v.useState(!1);return v.useEffect(()=>{const n=je.subject.pipe(Cn(({key:i})=>i.startsWith(pm))).subscribe(i=>{i.key===Qu?e(!0):i.key===xo&&e(!1)});return()=>n.unsubscribe()},[]),r},e0=()=>{const[r,e]=v.useState(!1),{duration:t,fps:n,scale:i,playerRef:s,activeIds:a}=hn(),c=Ga(s),u=()=>{je.dispatch(Yu)},h=()=>{je.dispatch(Gu,{payload:{},options:{time:Vm()}})},d=y=>{je.dispatch(Ju,{payload:{scale:y}})},g=()=>{je.dispatch(Uu)},p=()=>{je.dispatch($u)};return v.useEffect(()=>(s?.current?.addEventListener("play",()=>{e(!0)}),s?.current?.addEventListener("pause",()=>{e(!1)}),()=>{s?.current?.removeEventListener("play",()=>{e(!0)}),s?.current?.removeEventListener("pause",()=>{e(!1)})}),[s]),b.jsx("div",{style:{position:"relative",height:"50px",boxShadow:"inset 0 1px 0 0 #27272a",flex:"none"},className:"bg-background",children:b.jsx("div",{style:{position:"absolute",height:50,width:"100%",display:"flex",alignItems:"center"},children:b.jsxs("div",{style:{height:36,width:"100%",display:"grid",gridTemplateColumns:"1fr 260px 1fr",alignItems:"center"},children:[b.jsxs("div",{className:"flex px-2",children:[b.jsxs(st,{disabled:!a.length,onClick:u,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[b.jsx(DE,{size:14})," Delete"]}),b.jsxs(st,{disabled:!a.length,onClick:h,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[b.jsx(Jm,{size:15})," Split"]}),b.jsxs(st,{disabled:!a.length,onClick:()=>{je.dispatch(Xu)},variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[b.jsx(Jm,{size:15})," Clone"]})]}),b.jsxs("div",{className:"flex items-center justify-center",children:[b.jsxs("div",{children:[b.jsx(st,{onClick:u,variant:"ghost",size:"icon",children:b.jsx(OE,{size:14})}),b.jsx(st,{onClick:()=>{if(r)return p();g()},variant:"ghost",size:"icon",children:r?b.jsx(AE,{size:14}):b.jsx(ME,{size:14})}),b.jsx(st,{onClick:h,variant:"ghost",size:"icon",children:b.jsx(PE,{size:14})})]}),b.jsxs("div",{className:"text-xs font-light",style:{display:"grid",alignItems:"center",gridTemplateColumns:"54px 4px 54px",paddingTop:"2px",justifyContent:"center"},children:[b.jsx("div",{className:"font-medium text-zinc-200",style:{display:"flex",justifyContent:"center"},"data-current-time":c/n,id:"video-current-time",children:Nm({frame:c},{fps:n})}),b.jsx("span",{children:"/"}),b.jsx("div",{className:"text-muted-foreground",style:{display:"flex",justifyContent:"center"},children:Rm({time:t})})]})]}),b.jsx(VE,{scale:i,onChangeTimelineScale:d,duration:t})]})})})},VE=({scale:r,onChangeTimelineScale:e,duration:t})=>{const n=()=>{const s=Bm(r);e(s)},i=()=>{const s=Wm(r);e(s)};return b.jsx("div",{className:"flex items-center justify-end",children:b.jsxs("div",{className:"flex border-l border-border pl-4 pr-2",children:[b.jsx(st,{size:"icon",variant:"ghost",onClick:n,disabled:r.index===0,children:b.jsx(RE,{size:16})}),b.jsx(st,{size:"icon",variant:"ghost",onClick:i,disabled:r.index===20,children:b.jsx(NE,{size:16})})]})})},t0=[{id:"1",details:{src:"https://cdn.designcombo.dev/audio/Dawn%20of%20change.mp3",text:"Voiceover"},name:"Dawn of change",type:"audio",metadata:{author:"Roman Senyk"},display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/audio/Hope.mp3"},name:"Hope",type:"audio",metadata:{author:"Hugo Dujardin"}},{id:"3",details:{src:"https://cdn.designcombo.dev/audio/Tenderness.mp3"},name:"Tenderness",type:"audio",metadata:{author:"Benjamin Tissot"}},{id:"4",details:{src:"https://cdn.designcombo.dev/audio/Piano%20Moment.mp3"},name:"Piano moment",type:"audio",metadata:{author:"Benjamin Tissot"}}],r0=[{id:"1",details:{src:"https://ik.imagekit.io/wombo/images/img1.jpg"},preview:"https://ik.imagekit.io/wombo/images/img1.jpg?tr=w-190",type:"image"},{id:"2",details:{src:"https://ik.imagekit.io/wombo/images/img2.jpg"},preview:"https://ik.imagekit.io/wombo/images/img2.jpg?tr=w-190",type:"image"},{id:"3",details:{src:"https://ik.imagekit.io/wombo/images/img3.jpg"},preview:"https://ik.imagekit.io/wombo/images/img3.jpg?tr=w-190",type:"image"},{id:"4",details:{src:"https://ik.imagekit.io/wombo/images/img4.jpg"},preview:"https://ik.imagekit.io/wombo/images/img4.jpg?tr=w-190",type:"image"},{id:"5",details:{src:"https://ik.imagekit.io/wombo/images/img5.jpg"},preview:"https://ik.imagekit.io/wombo/images/img5.jpg?tr=w-190",type:"image"},,{id:"6",details:{src:"https://ik.imagekit.io/wombo/images/img6.jpg"},preview:"https://ik.imagekit.io/wombo/images/img6.jpg?tr=w-190",type:"image"},{id:"7",details:{src:"https://ik.imagekit.io/wombo/images/img7.jpg"},preview:"https://ik.imagekit.io/wombo/images/img7.jpg?tr=w-190",type:"image"}],n0=[{id:"1",details:{src:"https://cdn.designcombo.dev/videos/demo-video-1.mp4",text:"Scene"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-1.png",duration:17e3,display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/videos/demo-video-2.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-2.png"},{id:"3",details:{src:"https://cdn.designcombo.dev/videos/demo-video-3.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-3.png",duration:2e4},{id:"4",details:{src:"https://cdn.designcombo.dev/videos/demo-video-4.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-4.png",duration:2e4},{id:"5",details:{src:"https://cdn.designcombo.dev/videos/demo-video-5.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-5.png",duration:23e3},{id:"6",details:{src:"https://cdn.designcombo.dev/videos/demo-video-6.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-6.png",duration:1e4},{id:"7",details:{src:"https://cdn.designcombo.dev/videos/demo-video-7.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-7.png",duration:12e3},{id:"8",details:{src:"https://cdn.designcombo.dev/videos/demo-video-8.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-8.png",duration:15e3},{id:"9",details:{src:"https://cdn.designcombo.dev/videos/demo-video-9.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-9.png",duration:15e3},{id:"10",details:{src:"https://cdn.designcombo.dev/videos/demo-video-10.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-10.png",duration:5e3},{id:"11",details:{src:"https://cdn.designcombo.dev/videos/demo-video-11.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-11.png",duration:5e3}],i0=[{id:"1",kind:"none",duration:0,preview:"https://ik.imagekit.io/wombo/transitions-v2/transition-none.png",type:"transition"},{id:"2",kind:"fade",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/fade.webp",type:"transition"},{id:"3",kind:"slide",name:"slide up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-up.webp",type:"transition",direction:"from-bottom"},{id:"4",kind:"slide",name:"slide down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-down.webp",type:"transition",direction:"from-top"},{id:"5",kind:"slide",name:"slide left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-left.webp",type:"transition",direction:"from-right"},{id:"6",kind:"slide",name:"slide right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-right.webp",type:"transition",direction:"from-left"},{id:"7",kind:"wipe",name:"wipe up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-up.webp",type:"transition",direction:"from-bottom"},{id:"8",kind:"wipe",name:"wipe down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-down.webp",type:"transition",direction:"from-top"},{id:"9",kind:"wipe",name:"wipe left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-left.webp",type:"transition",direction:"from-right"},{id:"10",kind:"wipe",name:"wipe right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-right.webp",type:"transition",direction:"from-left"},{id:"11",kind:"flip",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/flip.webp",type:"transition"},{id:"12",kind:"clockWipe",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/clock-wipe.webp",type:"transition"},{id:"13",kind:"star",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/star.webp",type:"transition"},{id:"14",kind:"circle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/circle.webp",type:"transition"},{id:"15",kind:"rectangle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/rectangle.webp",type:"transition"}],BE=[{id:"1",src:"https://ik.imagekit.io/snapmotion/upload-video-1.mp4",type:"video"},{id:"2",src:"https://ik.imagekit.io/snapmotion/upload-video-2.mp4",type:"video"},{id:"3",src:"https://ik.imagekit.io/snapmotion/upload-video-3.mp4",type:"video"}],zE=()=>{const r=Co();return b.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Transitions"}),b.jsx(Ci,{children:b.jsx("div",{className:"grid grid-cols-3 gap-2 px-4",children:i0.map((e,t)=>b.jsx(HE,{transition:e,shouldDisplayPreview:!r},t))})})]})},HE=({transition:r,shouldDisplayPreview:e})=>{const t=v.useMemo(()=>({backgroundImage:`url(${r.preview})`,backgroundSize:"cover",width:"70px",height:"70px"}),[r.preview]);return b.jsx(wo,{data:r,renderCustomPreview:b.jsx("div",{style:t}),shouldDisplayPreview:e,children:b.jsxs("div",{children:[b.jsx("div",{children:b.jsx("div",{style:t,draggable:!1})}),b.jsx("div",{className:"flex h-6 items-center overflow-ellipsis text-nowrap text-[12px] capitalize text-muted-foreground",children:r.name||r.type})]})})},WE=()=>{const r=()=>{je.dispatch(Wu,{payload:{id:kt(),display:{from:0,to:5e3},details:{text:"Heading and some body",fontSize:120,width:600,fontUrl:mh.url,fontFamily:mh.postScriptName,color:"#ffffff",wordWrap:"break-word",textAlign:"center",borderWidth:0,borderColor:"#000000",boxShadow:{color:"#ffffff",x:0,y:0,blur:0}}},options:{}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Text"}),b.jsx("div",{className:"flex flex-col gap-2 px-4",children:b.jsx(st,{draggable:!1,onClick:r,variant:"secondary",className:"w-full",children:"Add text"})})]})},UE=()=>{const r=v.useRef(null),e=n=>{t(n)},t=async n=>{const i=n[0].type;i.includes("audio")&&je.dispatch(bs,{payload:{id:kt(),details:{src:URL.createObjectURL(n[0]),volume:50}}}),i.includes("video")&&je.dispatch(ys,{payload:{id:kt(),display:{from:2e3,to:7e3},details:{src:URL.createObjectURL(n[0]),name:n[0].name}}}),i.includes("image")&&je.dispatch(ws,{payload:{id:kt(),details:{src:URL.createObjectURL(n[0])}}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Your media"}),b.jsx("input",{ref:r,id:"file-upload-handle",type:"file",accept:"audio/*,video/*,image/*",onChange:n=>e(Array.from(n.target.files||[])),className:"hidden"}),b.jsx("div",{className:"px-4 py-2",children:b.jsx("div",{children:b.jsxs(sm,{defaultValue:"projects",className:"w-full",children:[b.jsxs(Hu,{className:"grid w-full grid-cols-2",children:[b.jsx(za,{value:"projects",children:"Project"}),b.jsx(za,{value:"workspace",children:"Workspace"})]}),b.jsxs(Ha,{value:"projects",children:[b.jsxs(st,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[b.jsx(Qm,{size:16})," Upload"]}),b.jsx("div",{})]}),b.jsx(Ha,{value:"workspace",children:b.jsxs(st,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[b.jsx(Qm,{size:16})," Upload"]})})]})})}),b.jsx(Ci,{children:b.jsx("div",{className:"masonry-sm px-4"})})]})},$E=()=>{const r=Co(),e=t=>{je.dispatch(bs,{payload:t,options:{}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Audios"}),b.jsx(Ci,{children:b.jsx("div",{className:"flex flex-col px-2",children:t0.map((t,n)=>b.jsx(YE,{shouldDisplayPreview:!r,handleAddAudio:e,audio:t},n))})})]})},YE=({handleAddAudio:r,audio:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:"url(https://cdn.designcombo.dev/thumbnails/music-preview.png)",backgroundSize:"cover",width:"70px",height:"70px"}),[]);return b.jsx(wo,{data:e,renderCustomPreview:b.jsx("div",{style:n}),shouldDisplayPreview:t,children:b.jsxs("div",{draggable:!1,onClick:()=>r(e),style:{display:"grid",gridTemplateColumns:"48px 1fr"},className:"flex cursor-pointer gap-4 px-2 py-1 text-sm hover:bg-zinc-800/70",children:[b.jsx("div",{className:"flex h-12 items-center justify-center bg-zinc-800",children:b.jsx(Zm,{width:16})}),b.jsxs("div",{className:"flex flex-col justify-center",children:[b.jsx("div",{children:e.name}),b.jsx("div",{className:"text-zinc-400",children:e.metadata?.author})]})]})})},XE=()=>{const r=Co(),e=t=>{je.dispatch(ws,{payload:t,options:{trackId:"main"}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Photos"}),b.jsx(Ci,{children:b.jsx("div",{className:"masonry-sm px-4",children:r0.map((t,n)=>b.jsx(GE,{image:t,shouldDisplayPreview:!r,handleAddImage:e},n))})})]})},GE=({handleAddImage:r,image:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return b.jsx(wo,{data:e,renderCustomPreview:b.jsx("div",{style:n}),shouldDisplayPreview:t,children:b.jsx("div",{onClick:()=>r({id:kt(),details:{src:e.details.src}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:b.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},qE=()=>{const r=Co(),e=t=>{je.dispatch(ys,{payload:t,options:{resourceId:"main"}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Videos"}),b.jsx(Ci,{children:b.jsx("div",{className:"masonry-sm px-4",children:n0.map((t,n)=>b.jsx(KE,{video:t,shouldDisplayPreview:!r,handleAddVideo:e},n))})})]})},KE=({handleAddVideo:r,video:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return b.jsx(wo,{data:e,renderCustomPreview:b.jsx("div",{style:n,className:"draggable"}),shouldDisplayPreview:t,children:b.jsx("div",{onClick:()=>r({...e,id:kt(),details:{src:e.details.src,...e.details}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:b.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},qa=qm(r=>({activeMenuItem:null,showMenuItem:!1,cropTarget:null,showControlItem:!1,showToolboxItem:!1,activeToolboxItem:null,setCropTarget:e=>r({cropTarget:e}),setActiveMenuItem:e=>r({activeMenuItem:e}),setShowMenuItem:e=>r({showMenuItem:e}),setShowControlItem:e=>r({showControlItem:e}),setShowToolboxItem:e=>r({showToolboxItem:e}),setActiveToolboxItem:e=>r({activeToolboxItem:e})})),ZE=({children:r})=>{const{showMenuItem:e,setShowMenuItem:t}=qa(),n=()=>{t(!1)};return b.jsxs("div",{style:{left:e?"0":"-100%",transition:"left 0.25s ease-in-out",zIndex:200},className:"absolute top-1/2 mt-6 flex h-[calc(100%-32px-64px)] w-[340px] -translate-y-1/2 rounded-lg shadow-lg",children:[b.jsx("div",{className:"w-[74px]"}),b.jsxs("div",{className:"relative flex flex-1 bg-background/80 backdrop-blur-lg backdrop-filter",children:[b.jsx(st,{variant:"ghost",className:"absolute right-2 top-2 h-8 w-8 text-muted-foreground",size:"icon",children:b.jsx(FE,{width:16,onClick:n})}),r]})]})},JE=()=>{const{activeMenuItem:r}=qa();return r==="transitions"?b.jsx(zE,{}):r==="texts"?b.jsx(WE,{}):r==="videos"?b.jsx(qE,{}):r==="audios"?b.jsx($E,{}):r==="images"?b.jsx(XE,{}):r==="uploads"?b.jsx(UE,{}):null},s0=()=>b.jsx(ZE,{children:b.jsx(JE,{})}),Tn={audio:Zm,captions:kE,image:IE,redo:({...r})=>b.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2957 4.15721C13.9052 3.76669 13.9052 3.13352 14.2957 2.743C14.6862 2.35247 15.3194 2.35247 15.7099 2.743L20.953 7.98603C21.1387 8.16758 21.2539 8.42087 21.2539 8.70108C21.2539 8.70111 21.2539 8.70114 21.2539 8.70117C21.2539 8.70431 21.2539 8.70744 21.2539 8.71057C21.2518 8.93273 21.1773 9.13757 21.0528 9.30262C21.0249 9.33973 20.9942 9.37505 20.961 9.40828L15.7099 14.6593C15.3194 15.0499 14.6862 15.0499 14.2957 14.6593C13.9052 14.2688 13.9052 13.6357 14.2957 13.2451L17.8398 9.70108H9.22665C8.59943 9.70108 7.97836 9.82462 7.39888 10.0646C6.81941 10.3047 6.29289 10.6565 5.84938 11.1C5.40587 11.5435 5.05406 12.07 4.81403 12.6495C4.57401 13.229 4.45047 13.85 4.45047 14.4773C4.45047 15.1045 4.57401 15.7256 4.81403 16.305C5.05406 16.8845 5.40587 17.411 5.84938 17.8545C6.29289 18.298 6.81941 18.6498 7.39888 18.8899C7.97836 19.1299 8.59943 19.2534 9.22665 19.2534H12.9024C13.4547 19.2534 13.9024 19.7012 13.9024 20.2534C13.9024 20.8057 13.4547 21.2534 12.9024 21.2534H9.22665C8.33679 21.2534 7.45564 21.0782 6.63352 20.7376C5.81139 20.3971 5.06439 19.898 4.43517 19.2687C3.80594 18.6395 3.30681 17.8925 2.96627 17.0704C2.62574 16.2483 2.45047 15.3671 2.45047 14.4773C2.45047 13.5874 2.62574 12.7063 2.96627 11.8841C3.30681 11.062 3.80594 10.315 4.43517 9.68578C5.06439 9.05655 5.81139 8.55742 6.63352 8.21689C7.45564 7.87635 8.33679 7.70108 9.22665 7.70108H17.8396L14.2957 4.15721Z",fill:"currentColor"})}),shapes:({...r})=>b.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:[b.jsx("g",{clipPath:"url(#clip0_2077_2705)",children:b.jsx("path",{d:"M3.75 12H2.25V20.25C2.25 20.6478 2.40804 21.0294 2.68934 21.3107C2.97064 21.592 3.35218 21.75 3.75 21.75H9.75V20.25H3.75V12ZM21 21.75H12.75C12.6197 21.75 12.4916 21.716 12.3784 21.6514C12.2652 21.5868 12.1708 21.4938 12.1045 21.3816C12.0382 21.2694 12.0022 21.1419 12.0002 21.0116C11.9982 20.8813 12.0302 20.7527 12.093 20.6385L16.218 13.1385C16.2821 13.0203 16.377 12.9218 16.4928 12.8534C16.6085 12.7849 16.7406 12.7492 16.875 12.75C17.1322 12.75 17.3895 12.879 17.532 13.1385L21.657 20.6385C21.7198 20.7527 21.7518 20.8813 21.7498 21.0116C21.7478 21.1419 21.7118 21.2694 21.6455 21.3816C21.5792 21.4938 21.4848 21.5868 21.3716 21.6514C21.2584 21.716 21.1303 21.75 21 21.75ZM14.0182 20.25H19.7318L16.875 15.0563L14.0182 20.25ZM20.25 2.25H12V3.75H20.25V14.244H21.75V3.75C21.75 3.35218 21.592 2.97064 21.3107 2.68934C21.0294 2.40804 20.6478 2.25 20.25 2.25ZM8.25 2.25H3.75C3.35218 2.25 2.97064 2.40804 2.68934 2.68934C2.40804 2.97064 2.25 3.35218 2.25 3.75V8.25C2.25 8.64782 2.40804 9.02936 2.68934 9.31066C2.97064 9.59196 3.35218 9.75 3.75 9.75H8.25C8.64782 9.75 9.02936 9.59196 9.31066 9.31066C9.59196 9.02936 9.75 8.64782 9.75 8.25V3.75C9.75 3.35218 9.59196 2.97064 9.31066 2.68934C9.02936 2.40804 8.64782 2.25 8.25 2.25ZM8.25 8.25H3.75V3.75H8.25V8.25Z",fill:"currentColor"})}),b.jsx("defs",{children:b.jsx("clipPath",{id:"clip0_2077_2705",children:b.jsx("rect",{width:"24",height:"24",fill:"white"})})})]}),type:jE,undo:({...r})=>b.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.60387 4.30711C9.99439 3.91659 9.99439 3.28342 9.60387 2.8929C9.21334 2.50238 8.58018 2.50237 8.18965 2.8929L2.8925 8.19004C2.70497 8.37758 2.59961 8.63193 2.59961 8.89715C2.59961 9.16237 2.70497 9.41672 2.8925 9.60426L8.18965 14.9014C8.58018 15.2919 9.21334 15.2919 9.60387 14.9014C9.99439 14.5109 9.99439 13.8777 9.60387 13.4872L5.86478 9.7481H15.1044C15.7383 9.7481 16.366 9.87295 16.9516 10.1155C17.5372 10.3581 18.0693 10.7136 18.5176 11.1619C18.9658 11.6101 19.3213 12.1422 19.5639 12.7278C19.8065 13.3134 19.9313 13.9411 19.9313 14.575C19.9313 15.2088 19.8065 15.8365 19.5639 16.4221C19.3213 17.0077 18.9658 17.5398 18.5176 17.9881C18.0693 18.4363 17.5372 18.7918 16.9516 19.0344C16.366 19.277 15.7383 19.4018 15.1044 19.4018H11.3964C10.8442 19.4018 10.3964 19.8495 10.3964 20.4018C10.3964 20.9541 10.8442 21.4018 11.3964 21.4018H15.1044C16.001 21.4018 16.8887 21.2252 17.717 20.8822C18.5452 20.5391 19.2978 20.0362 19.9318 19.4023C20.5657 18.7683 21.0686 18.0158 21.4116 17.1875C21.7547 16.3592 21.9313 15.4715 21.9313 14.575C21.9313 13.6784 21.7547 12.7907 21.4116 11.9624C21.0686 11.1342 20.5657 10.3816 19.9318 9.74764C19.2978 9.11371 18.5452 8.61085 17.717 8.26777C16.8887 7.92469 16.001 7.7481 15.1044 7.7481H6.16287L9.60387 4.30711Z",fill:"currentColor"})}),upload:({...r})=>b.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:[b.jsxs("g",{clipPath:"url(#clip0_2077_2699)",children:[b.jsx("path",{d:"M8.25 13.5L9.3075 14.5575L11.25 12.6225V21.75H12.75V12.6225L14.6925 14.5575L15.75 13.5L12 9.75L8.25 13.5Z",fill:"currentColor"}),b.jsx("path",{d:"M17.6249 16.5004H17.2499V15.0004H17.6249C18.52 15.0362 19.3927 14.715 20.0509 14.1074C20.7092 13.4997 21.0991 12.6555 21.1349 11.7604C21.1707 10.8653 20.8495 9.99264 20.2418 9.33438C19.6342 8.67613 18.79 8.28621 17.8949 8.25041H17.2499L17.1749 7.63541C17.0085 6.37275 16.3888 5.21362 15.4312 4.37395C14.4736 3.53428 13.2435 3.07132 11.9699 3.07132C10.6963 3.07132 9.46616 3.53428 8.50857 4.37395C7.55099 5.21362 6.93129 6.37275 6.76489 7.63541L6.74989 8.25041H6.10489C5.20979 8.28621 4.36557 8.67613 3.75795 9.33438C3.15033 9.99264 2.82909 10.8653 2.86489 11.7604C2.9007 12.6555 3.29062 13.4997 3.94887 14.1074C4.60712 14.715 5.47979 15.0362 6.37489 15.0004H6.74989V16.5004H6.37489C5.1722 16.4928 4.01477 16.0409 3.12513 15.2315C2.2355 14.4221 1.67646 13.3124 1.55549 12.1158C1.43453 10.9192 1.76018 9.72009 2.46983 8.74905C3.17949 7.77801 4.22305 7.10357 5.39989 6.85541C5.72367 5.3453 6.55552 3.99189 7.75663 3.02101C8.95774 2.05013 10.4555 1.52051 11.9999 1.52051C13.5443 1.52051 15.042 2.05013 16.2432 3.02101C17.4443 3.99189 18.2761 5.3453 18.5999 6.85541C19.7767 7.10357 20.8203 7.77801 21.53 8.74905C22.2396 9.72009 22.5653 10.9192 22.4443 12.1158C22.3233 13.3124 21.7643 14.4221 20.8747 15.2315C19.985 16.0409 18.8276 16.4928 17.6249 16.5004Z",fill:"currentColor"})]}),b.jsx("defs",{children:b.jsx("clipPath",{id:"clip0_2077_2699",children:b.jsx("rect",{width:"24",height:"24",fill:"white"})})})]}),video:LE};function QE(){const{setActiveMenuItem:r,setShowMenuItem:e,activeMenuItem:t,showMenuItem:n}=qa();return b.jsxs("div",{style:{zIndex:201},className:"absolute left-2.5 top-1/2 mt-6 flex w-14 -translate-y-1/2 flex-col items-center rounded-lg bg-background/80 py-2 shadow-lg backdrop-blur-lg backdrop-filter",children:[b.jsx(st,{onClick:()=>{r("uploads"),e(!0)},className:Ht(n&&t==="uploads"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.upload,{width:20})}),b.jsx(st,{onClick:()=>{r("texts"),e(!0)},className:Ht(n&&t==="texts"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.type,{width:20})}),b.jsx(st,{onClick:()=>{r("videos"),e(!0)},className:Ht(n&&t==="videos"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.video,{width:20})}),b.jsx(st,{onClick:()=>{r("captions"),e(!0)},className:Ht(n&&t==="captions"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.captions,{width:20})}),b.jsx(st,{onClick:()=>{r("images"),e(!0)},className:Ht(n&&t==="images"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.image,{width:20})}),b.jsx(st,{onClick:()=>{r("shapes"),e(!0)},className:Ht(n&&t==="shapes"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.shapes,{width:20})}),b.jsx(st,{onClick:()=>{r("audios"),e(!0)},className:Ht(n&&t==="audios"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Tn.audio,{width:20})}),b.jsx(st,{onClick:()=>{r("transitions"),e(!0)},className:Ht(n&&t==="transitions"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx("svg",{width:20,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("path",{d:"M3 5.30359C3 3.93159 4.659 3.24359 5.629 4.21359L11.997 10.5826L10.583 11.9966L5 6.41359V17.5856L10.586 11.9996L10.583 11.9966L11.997 10.5826L12 10.5856L18.371 4.21459C19.341 3.24459 21 3.93159 21 5.30359V18.6956C21 20.0676 19.341 20.7556 18.371 19.7856L12 13.5L13.414 11.9996L19 17.5866V6.41359L13.414 11.9996L13.421 12.0056L12.006 13.4206L12 13.4136L5.629 19.7846C4.659 20.7546 3 20.0676 3 18.6956V5.30359Z",fill:"currentColor"})})})]})}function o0(){const r=()=>{je.dispatch(Ku)},e=()=>{je.dispatch(Zu)};return b.jsx("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr 320px"},className:"pointer-events-none absolute left-0 right-0 top-0 z-[205] flex h-[72px] items-center px-2",children:b.jsxs("div",{className:"pointer-events-auto flex h-14 items-center gap-2",children:[b.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-md bg-background"}),b.jsxs("div",{className:"flex h-12 items-center bg-background px-1.5",children:[b.jsx(st,{onClick:r,className:"text-muted-foreground",variant:"ghost",size:"icon",children:b.jsx(Tn.undo,{width:20})}),b.jsx(st,{onClick:e,className:"text-muted-foreground",variant:"ghost",size:"icon",children:b.jsx(Tn.redo,{width:20})})]})]})})}var ek=Object.defineProperty,a0=(r,e)=>{for(var t in e)ek(r,t,{get:e[t],enumerable:!0,configurable:!0,set:n=>e[t]=()=>n})};if(typeof v.createContext!="function"){const r=['Remotion requires React.createContext, but it is "undefined".','If you are in a React Server Component, turn it into a client component by adding "use client" at the top of the file.',"","Before:",'  import {useCurrentFrame} from "remotion";',"","After:",'  "use client";','  import {useCurrentFrame} from "remotion";'];throw new Error(r.join(`
`))}function c0(){return["NOD","E_EN","V"].join("")}var l0=()=>["e","nv"].join(""),Ct=()=>{const r=typeof window<"u"&&window.remotion_isPlayer,e=typeof window<"u"&&typeof window.process<"u"&&typeof window.process.env<"u"&&(window.process[l0()][c0()]==="test"||window.process[l0()][c0()]==="production"&&typeof window<"u"&&typeof window.remotion_puppeteerTimeout<"u");return{isStudio:typeof window<"u"&&window.remotion_isStudio,isRendering:e,isPlayer:r}},tk=v.createElement,u0=[],h0=()=>{if(!Ct().isStudio)return;const r=new Proxy(tk,{apply(e,t,n){if(u0.includes(n[0])){const[i,s,...a]=n,c={...s??{},stack:new Error().stack};return Reflect.apply(e,t,[i,c,...a])}return Reflect.apply(e,t,n)}});v.createElement=r},To=r=>{u0.push(r),h0()},d0=v.createContext(!1),rk=({children:r})=>b.jsx(d0.Provider,{value:!0,children:r}),vh=()=>v.useContext(d0);function Ka(r){return!!r}var Za="4.0.229",nk=()=>{if(typeof globalThis>"u")return;const r=globalThis.remotion_imported||typeof window<"u"&&window.remotion_imported;if(r){if(r===Za)return;throw new TypeError(` Multiple versions of Remotion detected: ${[Za,typeof r=="string"?r:"an older version"].filter(Ka).join(" and ")}. This will cause things to break in an unexpected way.
Check that all your Remotion packages are on the same version. If your dependencies depend on Remotion, make them peer dependencies. You can also run \`npx remotion versions\` from your terminal to see which versions are mismatching.`)}globalThis.remotion_imported=Za,typeof window<"u"&&(window.remotion_imported=Za)},ik=(r,e)=>{const{style:t,...n}=r,i=v.useMemo(()=>({position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",...t}),[t]);return b.jsx("div",{ref:e,style:i,...n})},Eo=v.forwardRef(ik),Wt=v.createContext(null),_s=v.createContext({registerSequence:()=>{throw new Error("SequenceManagerContext not initialized")},unregisterSequence:()=>{throw new Error("SequenceManagerContext not initialized")},sequences:[]}),ko=v.createContext({hidden:{},setHidden:()=>{throw new Error("SequenceVisibilityToggle not initialized")}}),sk=({children:r})=>{const[e,t]=v.useState([]),[n,i]=v.useState({}),s=v.useCallback(h=>{t(d=>[...d,h])},[]),a=v.useCallback(h=>{t(d=>d.filter(g=>g.id!==h))},[]),c=v.useMemo(()=>({registerSequence:s,sequences:e,unregisterSequence:a}),[s,e,a]),u=v.useMemo(()=>({hidden:n,setHidden:i}),[n]);return b.jsx(_s.Provider,{value:c,children:b.jsx(ko.Provider,{value:u,children:r})})},Ss=v.createContext({getNonce:()=>0,fastRefreshes:0}),yh=()=>{const r=v.useContext(Ss),[e,t]=v.useState(()=>r.getNonce()),n=v.useRef(r);return v.useEffect(()=>{n.current!==r&&(n.current=r,t(r.getNonce))},[r]),e},f0={};a0(f0,{useTimelineSetFrame:()=>M0,useTimelinePosition:()=>Ei,usePlayingState:()=>Th,persistCurrentFrame:()=>k0,getInitialFrameState:()=>I0,getFrameForComposition:()=>A0,TimelineContext:()=>Xr,SetTimelineContext:()=>Cs});var Jn=v.createContext({compositions:[],registerComposition:()=>{},unregisterComposition:()=>{},registerFolder:()=>{},unregisterFolder:()=>{},setCurrentCompositionMetadata:()=>{},updateCompositionDefaultProps:()=>{},folders:[],currentCompositionMetadata:null,canvasContent:null,setCanvasContent:()=>{}}),Ja=v.createContext({props:{},updateProps:()=>{throw new Error("Not implemented")},resetUnsaved:()=>{throw new Error("Not implemented")}}),g0=v.createRef(),p0=({children:r})=>{const[e,t]=v.useState({}),n=v.useCallback(({defaultProps:a,id:c,newProps:u})=>{t(h=>({...h,[c]:typeof u=="function"?u(h[c]??a):u}))},[]),i=v.useCallback(()=>{t({})},[]);v.useImperativeHandle(g0,()=>({getProps:()=>e,setProps:t}),[e]);const s=v.useMemo(()=>({props:e,updateProps:n,resetUnsaved:i}),[e,i,n]);return b.jsx(Ja.Provider,{value:s,children:r})},ok={"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";"},m0={},ak=r=>{m0[r]||(console.warn(r),m0[r]=!0)},ck=r=>{for(const e of Object.keys(ok))if(r.includes(e))return{containsHex:!0,hexCode:e};return{containsHex:!1}},bh=r=>r.startsWith("/")?bh(r.substring(1)):r,lk=r=>{if(typeof window<"u"&&window.remotion_staticBase){if(r.startsWith(window.remotion_staticBase))throw new Error(`The value "${r}" is already prefixed with the static base ${window.remotion_staticBase}. You don't need to call staticFile() on it.`);return`${window.remotion_staticBase}/${bh(r)}`}return`/${bh(r)}`},uk=r=>r.split("/").map(i=>encodeURIComponent(i)).join("/"),hk=r=>{if(r===null)throw new TypeError("null was passed to staticFile()");if(typeof r>"u")throw new TypeError("undefined was passed to staticFile()");if(r.startsWith("http://")||r.startsWith("https://"))throw new TypeError(`staticFile() does not support remote URLs - got "${r}". Instead, pass the URL without wrapping it in staticFile(). See: https://remotion.dev/docs/staticfile-remote-urls`);if(r.startsWith("..")||r.startsWith("./"))throw new TypeError(`staticFile() does not support relative paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("/Users")||r.startsWith("/home")||r.startsWith("/tmp")||r.startsWith("/etc")||r.startsWith("/opt")||r.startsWith("/var")||r.startsWith("C:")||r.startsWith("D:")||r.startsWith("E:"))throw new TypeError(`staticFile() does not support absolute paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("public/"))throw new TypeError(`Do not include the public/ prefix when using staticFile() - got "${r}". See: https://remotion.dev/docs/staticfile-relative-paths`);const e=ck(r);e.containsHex&&ak(`WARNING: You seem to pass an already encoded path (path contains ${e.hexCode}). Since Remotion 4.0, the encoding is done by staticFile() itself. You may want to remove a encodeURIComponent() wrapping.`);const t=uk(r),n=lk(t);return n.startsWith("/")?n:`/${n}`},wh="remotion-date:",xh="remotion-file:",dk=({data:r,indent:e,staticBase:t})=>{let n=!1,i=!1,s=!1,a=!1;try{return{serializedString:JSON.stringify(r,function(u,h){const d=this[u];return d instanceof Date?(n=!0,`${wh}${d.toISOString()}`):d instanceof Map?(s=!0,h):d instanceof Set?(a=!0,h):typeof d=="string"&&t!==null&&d.startsWith(t)?(i=!0,`${xh}${d.replace(t+"/","")}`):h},e),customDateUsed:n,customFileUsed:i,mapUsed:s,setUsed:a}}catch(c){throw new Error("Could not serialize the passed input props to JSON: "+c.message)}},v0=r=>JSON.parse(r,(e,t)=>typeof t=="string"&&t.startsWith(wh)?new Date(t.replace(wh,"")):typeof t=="string"&&t.startsWith(xh)?hk(t.replace(xh,"")):t),Ti=r=>Ct().isStudio?v0(dk({data:r,indent:2,staticBase:window.remotion_staticBase}).serializedString):r,y0=!1,fk=()=>{y0||(y0=!0,console.warn("Called `getInputProps()` on the server. This function is not available server-side and has returned an empty object."),console.warn("To hide this warning, don't call this function on the server:"),console.warn("  typeof window === 'undefined' ? {} : getInputProps()"))},b0=()=>{if(typeof window>"u")return fk(),{};if(Ct().isPlayer)throw new Error("You cannot call `getInputProps()` from a <Player>. Instead, the props are available as React props from component that you passed as `component` prop.");const r=window.remotion_inputProps;return r?v0(r):{}},w0=["h264","h265","vp8","vp9","mp3","aac","wav","prores","h264-mkv","h264-ts","gif"];function gk(r,e){if(!(typeof r>"u")){if(typeof r!="string")throw new TypeError(`The "defaultCodec" prop ${e} must be a string, but you passed a value of type ${typeof r}.`);if(!w0.includes(r))throw new Error(`The "defaultCodec" prop ${e} must be one of ${w0.join(", ")}, but you passed ${r}.`)}}function Qa(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function _h(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function x0(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`)}var _0=({calculated:r,compositionId:e,compositionFps:t,compositionHeight:n,compositionWidth:i,compositionDurationInFrames:s})=>{const a=`calculated by calculateMetadata() for the composition "${e}"`,c=`of the "<Composition />" component with the id "${e}"`,u=r?.width??i??void 0;Qa(u,"width",r?.width?a:c);const h=r?.height??n??void 0;Qa(h,"height",r?.height?a:c);const d=r?.fps??t??null;x0(d,r?.fps?a:c);const g=r?.durationInFrames??s??null;_h(g,{allowFloats:!1,component:`of the "<Composition />" component with the id "${e}"`});const p=r?.defaultCodec;return gk(p,a),{width:u,height:h,fps:d,durationInFrames:g,defaultCodec:p}},S0=({calculateMetadata:r,signal:e,defaultProps:t,originalProps:n,compositionId:i,compositionDurationInFrames:s,compositionFps:a,compositionHeight:c,compositionWidth:u})=>{const h=r?r({defaultProps:t,props:n,abortSignal:e,compositionId:i}):null;if(h!==null&&typeof h=="object"&&"then"in h)return h.then(g=>{const{height:p,width:y,durationInFrames:w,fps:_,defaultCodec:S}=_0({calculated:g,compositionDurationInFrames:s,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:i});return{width:y,height:p,fps:_,durationInFrames:w,id:i,defaultProps:Ti(t),props:Ti(g.props??n),defaultCodec:S??null}});const d=_0({calculated:h,compositionDurationInFrames:s,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:i});return h===null?{...d,id:i,defaultProps:Ti(t??{}),props:Ti(n),defaultCodec:null}:{...d,id:i,defaultProps:Ti(t??{}),props:Ti(h.props??n),defaultCodec:h.defaultCodec??null}},pk=r=>{try{return{type:"success",result:S0(r)}}catch(e){return{type:"error",error:e}}},ec=v.createContext(null),C0=v.createRef(),T0=r=>!!r.calculateMetadata,mk="remotion.propsUpdatedExternally",E0=({children:r})=>{const[e,t]=v.useState(null),{compositions:n,canvasContent:i,currentCompositionMetadata:s}=v.useContext(Jn),{fastRefreshes:a}=v.useContext(Ss),c=v.useMemo(()=>n.find(R=>i&&i.type==="composition"&&i.compositionId===R.id),[i,n]),u=n.find(R=>R.id===e),{props:h}=v.useContext(Ja),d=v.useMemo(()=>typeof window>"u"||Ct().isPlayer?{}:b0()??{},[]),[g,p]=v.useState({}),y=v.useMemo(()=>c?h[c.id]??{}:{},[h,c]),w=v.useMemo(()=>u?h[u.id]??{}:{},[h,u]),_=!!s,S=v.useCallback(({calculateMetadata:R,combinedProps:X,compositionDurationInFrames:U,compositionFps:K,compositionHeight:$,compositionId:G,compositionWidth:re,defaultProps:fe})=>{const Q=new AbortController;if(_)return Q;const{signal:ue}=Q,oe=pk({compositionId:G,calculateMetadata:R,originalProps:X,signal:ue,defaultProps:fe,compositionDurationInFrames:U,compositionFps:K,compositionHeight:$,compositionWidth:re});if(oe.type==="error")return p(de=>({...de,[G]:{type:"error",error:oe.error}})),Q;const se=oe.result;return typeof se=="object"&&"then"in se?(p(de=>{const ne=de[G];return ne?.type==="success"||ne?.type==="success-and-refreshing"?{...de,[G]:{type:"success-and-refreshing",result:ne.result}}:{...de,[G]:{type:"loading"}}}),se.then(de=>{Q.signal.aborted||p(ne=>({...ne,[G]:{type:"success",result:de}}))}).catch(de=>{Q.signal.aborted||p(ne=>({...ne,[G]:{type:"error",error:de}}))})):p(de=>({...de,[G]:{type:"success",result:se}})),Q},[_]),T=i?.type==="composition"?i.compositionId:null;v.useImperativeHandle(C0,()=>({setCurrentRenderModalComposition:R=>{t(R)},reloadCurrentlySelectedComposition:()=>{if(!T)return;const R=n.find($=>$.id===T);if(!R)throw new Error(`Could not find composition with id ${T}`);const X=h[T]??{},U={...R.defaultProps??{},...X??{}},K={...U,...d??{}};S({defaultProps:U,calculateMetadata:R.calculateMetadata,combinedProps:K,compositionDurationInFrames:R.durationInFrames??null,compositionFps:R.fps??null,compositionHeight:R.height??null,compositionWidth:R.width??null,compositionId:R.id})}}),[h,n,T,S,d]);const k=c?.id===u?.id,I=v.useMemo(()=>({...c?.defaultProps??{},...y??{}}),[c?.defaultProps,y]),M=v.useMemo(()=>({...I,...d??{}}),[I,d]),L=c&&T0(c),N=typeof window<"u"&&window.remotion_ignoreFastRefreshUpdate&&a<=window.remotion_ignoreFastRefreshUpdate;v.useEffect(()=>{if(!N&&L){const R=S({calculateMetadata:c.calculateMetadata,combinedProps:M,compositionDurationInFrames:c.durationInFrames??null,compositionFps:c.fps??null,compositionHeight:c.height??null,compositionWidth:c.width??null,defaultProps:I,compositionId:c.id});return()=>{R.abort()}}},[L,I,S,M,c?.calculateMetadata,c?.durationInFrames,c?.fps,c?.height,c?.id,c?.width,N]),v.useEffect(()=>{N||window.dispatchEvent(new CustomEvent("remotion.propsUpdatedExternally"))},[a]),v.useEffect(()=>{if(u&&!k){const R={...u.defaultProps??{},...w??{},...d??{}},X=S({calculateMetadata:u.calculateMetadata,compositionDurationInFrames:u.durationInFrames??null,compositionFps:u.fps??null,compositionHeight:u.height??null,compositionId:u.id,compositionWidth:u.width??null,defaultProps:I,combinedProps:R});return()=>{X.abort()}}},[I,S,d,k,u,w]);const H=v.useMemo(()=>{const R=n.filter(X=>X.calculateMetadata===null);return{...g,...R.reduce((X,U)=>({...X,[U.id]:{type:"success",result:{...U,defaultProps:U.defaultProps??{}}}}),{})}},[n,g]);return b.jsx(ec.Provider,{value:H,children:r})},Sh=r=>{const e=v.useContext(ec),{props:t}=v.useContext(Ja),{compositions:n,canvasContent:i,currentCompositionMetadata:s}=v.useContext(Jn),a=i?.type==="composition"?i.compositionId:null,c=r??a,u=n.find(d=>d.id===c),h=v.useMemo(()=>u?t[u.id]??{}:{},[t,u]);return v.useMemo(()=>u?s?{type:"success",result:{...s,id:u.id,props:s.props,defaultProps:u.defaultProps??{},defaultCodec:s.defaultCodec}}:T0(u)?e[u.id]?e[u.id]:null:(_h(u.durationInFrames,{allowFloats:!1,component:`in <Composition id="${u.id}">`}),x0(u.fps,`in <Composition id="${u.id}">`),Qa(u.width,"width",`in <Composition id="${u.id}">`),Qa(u.height,"height",`in <Composition id="${u.id}">`),{type:"success",result:{width:u.width,height:u.height,fps:u.fps,id:u.id,durationInFrames:u.durationInFrames,defaultProps:u.defaultProps??{},props:{...u.defaultProps??{},...h??{},...typeof window>"u"||Ct().isPlayer?{}:b0()??{}},defaultCodec:null}}):null,[u,e,s,h])},tc=()=>{const{canvasContent:r,compositions:e,currentCompositionMetadata:t}=v.useContext(Jn),n=e.find(s=>r?.type==="composition"&&s.id===r.compositionId),i=Sh(n?.id??null);return v.useMemo(()=>!i||i.type==="error"||i.type==="loading"||!n?null:{...i.result,defaultProps:n.defaultProps??{},id:n.id,...t??{},component:n.component},[t,i,n])},Xr=v.createContext({frame:{},playing:!1,playbackRate:1,rootId:"",imperativePlaying:{current:!1},setPlaybackRate:()=>{throw new Error("default")},audioAndVideoTags:{current:[]}}),Cs=v.createContext({setFrame:()=>{throw new Error("default")},setPlaying:()=>{throw new Error("default")}}),Ch=()=>"remotion.time-all",k0=r=>{localStorage.setItem(Ch(),JSON.stringify(r))},I0=()=>{const r=localStorage.getItem(Ch())??"{}";return JSON.parse(r)},A0=r=>{const e=localStorage.getItem(Ch())??"{}",t=JSON.parse(e);return t[r]!==void 0?Number(t[r]):typeof window>"u"?0:window.remotion_initialFrame??0},Ei=()=>{const r=tc(),e=v.useContext(Xr);if(!r)return typeof window>"u"?0:window.remotion_initialFrame??0;const t=e.frame[r.id]??(Ct().isPlayer?0:A0(r.id));return Math.min(r.durationInFrames-1,t)},M0=()=>{const{setFrame:r}=v.useContext(Cs);return r},Th=()=>{const{playing:r,imperativePlaying:e}=v.useContext(Xr),{setPlaying:t}=v.useContext(Cs);return v.useMemo(()=>[r,t,e],[e,r,t])},ki=v.createContext(!1),Eh=({children:r})=>b.jsx(ki.Provider,{value:!0,children:r}),rc=()=>{const r=v.useContext(Wt),e=r?.width??null,t=r?.height??null,n=r?.durationInFrames??null,i=tc();return v.useMemo(()=>{if(!i)return null;const{id:s,durationInFrames:a,fps:c,height:u,width:h,defaultProps:d,props:g,defaultCodec:p}=i;return{id:s,width:e??h,height:t??u,fps:c,durationInFrames:n??a,defaultProps:d,props:g,defaultCodec:p}},[n,t,e,i])},Qn=()=>{const r=rc(),e=v.useContext(ki),t=vh();if(!r)throw typeof window<"u"&&window.remotion_isPlayer||t?new Error(["No video config found. Likely reasons:","- You are probably calling useVideoConfig() from outside the component passed to <Player />. See https://www.remotion.dev/docs/player/examples for how to set up the Player correctly.","- You have multiple versions of Remotion installed which causes the React context to get lost."].join("-")):new Error("No video config found. You are probably calling useVideoConfig() from a component which has not been registered as a <Composition />. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions for more information.");if(!e)throw new Error("Called useVideoConfig() outside a Remotion composition.");return r},ei=()=>{if(!v.useContext(ki))throw Ct().isPlayer?new Error("useCurrentFrame can only be called inside a component that was passed to <Player>. See: https://www.remotion.dev/docs/player/examples"):new Error("useCurrentFrame() can only be called inside a component that was registered as a composition. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions");const e=Ei(),t=v.useContext(Wt),n=t?t.cumulatedFrom+t.relativeFrom:0;return e-n},vk=({frame:r,children:e,active:t=!0})=>{const n=ei(),i=Qn();if(typeof r>"u")throw new Error("The <Freeze /> component requires a 'frame' prop, but none was passed.");if(typeof r!="number")throw new Error(`The 'frame' prop of <Freeze /> must be a number, but is of type ${typeof r}`);if(Number.isNaN(r))throw new Error("The 'frame' prop of <Freeze /> must be a real number, but it is NaN.");if(!Number.isFinite(r))throw new Error(`The 'frame' prop of <Freeze /> must be a finite number, but it is ${r}.`);const s=v.useMemo(()=>{if(typeof t=="boolean")return t;if(typeof t=="function")return t(n)},[t,n]),a=v.useContext(Xr),u=v.useContext(Wt)?.relativeFrom??0,h=v.useMemo(()=>s?{...a,playing:!1,imperativePlaying:{current:!1},frame:{[i.id]:r+u}}:a,[s,a,i.id,r,u]);return b.jsx(Xr.Provider,{value:h,children:e})},yk=({from:r=0,durationInFrames:e=1/0,children:t,name:n,height:i,width:s,showInTimeline:a=!0,_remotionInternalLoopDisplay:c,_remotionInternalStack:u,_remotionInternalPremountDisplay:h,...d},g)=>{const{layout:p="absolute-fill"}=d,[y]=v.useState(()=>String(Math.random())),w=v.useContext(Wt),{rootId:_}=v.useContext(Xr),S=w?w.cumulatedFrom+w.relativeFrom:0,T=yh();if(p!=="absolute-fill"&&p!=="none")throw new TypeError(`The layout prop of <Sequence /> expects either "absolute-fill" or "none", but you passed: ${p}`);if(p==="none"&&typeof d.style<"u")throw new TypeError('If layout="none", you may not pass a style.');if(typeof e!="number")throw new TypeError(`You passed to durationInFrames an argument of type ${typeof e}, but it must be a number.`);if(e<=0)throw new TypeError(`durationInFrames must be positive, but got ${e}`);if(typeof r!="number")throw new TypeError(`You passed to the "from" props of your <Sequence> an argument of type ${typeof r}, but it must be a number.`);if(!Number.isFinite(r))throw new TypeError(`The "from" prop of a sequence must be finite, but got ${r}.`);const k=Ei(),I=Qn(),M=w?Math.min(w.durationInFrames-r,e):e,L=Math.max(0,Math.min(I.durationInFrames-r,M)),{registerSequence:N,unregisterSequence:H}=v.useContext(_s),{hidden:R}=v.useContext(ko),X=v.useMemo(()=>w?.premounting??!!d._remotionInternalIsPremounting,[d._remotionInternalIsPremounting,w?.premounting]),U=v.useMemo(()=>({cumulatedFrom:S,relativeFrom:r,durationInFrames:L,parentFrom:w?.relativeFrom??0,id:y,height:i??w?.height??null,width:s??w?.width??null,premounting:X}),[S,r,L,w,y,i,s,X]),K=v.useMemo(()=>n??"",[n]);v.useEffect(()=>{if(Ct().isStudio)return N({from:r,duration:L,id:y,displayName:K,parent:w?.id??null,type:"sequence",rootId:_,showInTimeline:a,nonce:T,loopDisplay:c,stack:u??null,premountDisplay:h??null}),()=>{H(y)}},[e,y,n,N,K,H,w?.id,L,_,r,a,T,c,u,h]);const $=Math.ceil(S+r+e-1),G=k<S+r||k>$?null:t,re=d.layout==="none"?void 0:d.style,fe=v.useMemo(()=>({flexDirection:void 0,...s?{width:s}:{},...i?{height:i}:{},...re??{}}),[i,re,s]);if(g!==null&&p==="none")throw new TypeError('It is not supported to pass both a `ref` and `layout="none"` to <Sequence />.');return R[y]??!1?null:b.jsx(Wt.Provider,{value:U,children:G===null?null:d.layout==="none"?G:b.jsx(Eo,{ref:g,style:fe,className:d.className,children:G})})},bk=v.forwardRef(yk),wk=(r,e)=>{const t=ei();if(r.layout==="none")throw new Error('`<Sequence>` with `premountFor` prop does not support layout="none"');const{style:n,from:i=0,premountFor:s=0,...a}=r,c=t<i&&t>=i-s,u=v.useMemo(()=>({...n,opacity:c?0:1,pointerEvents:c?"none":n?.pointerEvents??void 0}),[c,n]);return b.jsx(vk,{frame:i,active:c,children:b.jsx(dn,{ref:e,from:i,style:u,_remotionInternalPremountDisplay:s,_remotionInternalIsPremounting:c,...a})})},xk=v.forwardRef(wk),_k=(r,e)=>r.layout!=="none"&&r.premountFor&&!Ct().isRendering?b.jsx(xk,{...r,ref:e}):b.jsx(bk,{...r,ref:e}),dn=v.forwardRef(_k),Sk=r=>{if(typeof r!="string")throw new TypeError(`The "filename" must be a string, but you passed a value of type ${typeof r}`);if(r.trim()==="")throw new Error("The `filename` must not be empty");if(!r.match(/^([0-9a-zA-Z-!_.*'()/:&$@=;+,?]+)/g))throw new Error('The `filename` must match "/^([0-9a-zA-Z-!_.*\'()/:&$@=;+,?]+)/g". Use forward slashes only, even on Windows.')},Ck=r=>{if(typeof r!="string"&&!(r instanceof Uint8Array))throw new TypeError(`The "content" must be a string or Uint8Array, but you passed a value of type ${typeof r}`);if(typeof r=="string"&&r.trim()==="")throw new Error("The `content` must not be empty")},O0=r=>{r.type==="artifact"&&(Sk(r.filename),Ck(r.content))},Ii=v.createContext({registerRenderAsset:()=>{},unregisterRenderAsset:()=>{},renderAssets:[]}),Tk=({children:r})=>{const[e,t]=v.useState([]),n=v.useCallback(a=>{O0(a),t(c=>[...c,a])},[]),i=v.useCallback(a=>{t(c=>c.filter(u=>u.id!==a))},[]);v.useLayoutEffect(()=>{typeof window<"u"&&(window.remotion_collectAssets=()=>(t([]),e))},[e]);const s=v.useMemo(()=>({registerRenderAsset:n,unregisterRenderAsset:i,renderAssets:e}),[e,n,i]);return b.jsx(Ii.Provider,{value:s,children:r})},En=r=>typeof window>"u"?r:new URL(r,window.origin).href,P0=({endAt:r,mediaDuration:e,playbackRate:t,startFrom:n})=>{let i=e;typeof r<"u"&&(i=r),typeof n<"u"&&(i-=n);const s=i/t;return Math.floor(s)};function Io(r){let e;throw Ek(r)?(e=r,e.stack||(e.stack=new Error(e.message).stack)):typeof r=="string"?e=Error(r):e=Error("Rendering was cancelled"),window.remotion_cancelledError=e.stack,e}var Ek=r=>r instanceof Error?!0:!(r===null||typeof r!="object"||!("stack"in r)||typeof r.stack!="string"||!("message"in r)||typeof r.message!="string"),D0=v.createContext(null),kk=()=>v.useContext(D0),nc=({durationInFrames:r,times:e=1/0,children:t,name:n,...i})=>{const s=ei(),{durationInFrames:a}=Qn();if(_h(r,{component:"of the <Loop /> component",allowFloats:!0}),typeof e!="number")throw new TypeError(`You passed to "times" an argument of type ${typeof e}, but it must be a number.`);if(e!==1/0&&e%1!==0)throw new TypeError(`The "times" prop of a loop must be an integer, but got ${e}.`);if(e<0)throw new TypeError(`The "times" prop of a loop must be at least 0, but got ${e}`);const c=Math.ceil(a/r),u=Math.min(c,e),h=i.layout==="none"?void 0:i.style,d=r*(u-1),p=Math.floor(s/r)*r,y=Math.min(p,d),w=v.useMemo(()=>({numberOfTimes:u,startOffset:-y,durationInFrames:r}),[u,r,y]),_=v.useMemo(()=>({iteration:Math.floor(s/r),durationInFrames:r}),[s,r]);return b.jsx(D0.Provider,{value:_,children:b.jsx(dn,{durationInFrames:r,from:y,name:n??"<Loop>",_remotionInternalLoopDisplay:w,layout:i.layout,style:h,children:t})})};nc.useLoop=kk;var ic=v.createContext({}),j0={},kh=[],L0=({children:r})=>{const[e,t]=v.useState(()=>j0);return v.useEffect(()=>{const n=()=>{t(j0)};return kh.push(n),()=>{kh=kh.filter(i=>i!==n)}},[]),b.jsx(ic.Provider,{value:e,children:r})},Ts=r=>v.useContext(ic)[r]??r,Ih=(r,e)=>{if(typeof r.volume!="number"&&typeof r.volume!="function"&&typeof r.volume<"u")throw new TypeError(`You have passed a volume of type ${typeof r.volume} to your <${e} /> component. Volume must be a number or a function with the signature '(frame: number) => number' undefined.`);if(typeof r.volume=="number"&&r.volume<0)throw new TypeError(`You have passed a volume below 0 to your <${e} /> component. Volume must be between 0 and 1`);if(typeof r.playbackRate!="number"&&typeof r.playbackRate<"u")throw new TypeError(`You have passed a playbackRate of type ${typeof r.playbackRate} to your <${e} /> component. Playback rate must a real number or undefined.`);if(typeof r.playbackRate=="number"&&(isNaN(r.playbackRate)||!Number.isFinite(r.playbackRate)||r.playbackRate<=0))throw new TypeError(`You have passed a playbackRate of ${r.playbackRate} to your <${e} /> component. Playback rate must be a real number above 0.`)},Ah=(r,e)=>{if(typeof r<"u"){if(typeof r!="number")throw new TypeError(`type of startFrom prop must be a number, instead got type ${typeof r}.`);if(isNaN(r)||r===1/0)throw new TypeError("startFrom prop can not be NaN or Infinity.");if(r<0)throw new TypeError(`startFrom must be greater than equal to 0 instead got ${r}.`)}if(typeof e<"u"){if(typeof e!="number")throw new TypeError(`type of endAt prop must be a number, instead got type ${typeof e}.`);if(isNaN(e))throw new TypeError("endAt prop can not be NaN.");if(e<=0)throw new TypeError(`endAt must be a positive number, instead got ${e}.`)}if(e<r)throw new TypeError("endAt prop must be greater than startFrom prop.")},Ik=(r,e)=>{switch(e.type){case"got-duration":{const t=En(e.src);return r[t]===e.durationInSeconds?r:{...r,[t]:e.durationInSeconds}}default:return r}},Mh=v.createContext({durations:{},setDurations:()=>{throw new Error("context missing")}}),F0=({children:r})=>{const[e,t]=v.useReducer(Ik,{}),n=v.useMemo(()=>({durations:e,setDurations:t}),[e]);return b.jsx(Mh.Provider,{value:n,children:r})};function N0(r){let e=r+1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Ak(r){let e=0,t=0,n=0;for(e=0;e<r.length;e++)t=r.charCodeAt(e),n=(n<<5)-n+t,n|=0;return n}var Ai=(r,e)=>{if(r===null)return Math.random();if(typeof r=="string")return N0(Ak(r));if(typeof r=="number")return N0(r*1e10);throw new Error("random() argument must be a number or a string")},Es=()=>{const r=v.useContext(Wt);return Math.min(0,r?.relativeFrom??0)},Ao=r=>{const e=nc.useLoop(),t=ei(),n=Es();return r==="repeat"||e===null?t+n:t+n+e.durationInFrames*e.iteration},Mk=r=>{if(/data:|blob:/.test(r.substring(0,5)))return"Data URL";const e=r.split("/").map(t=>t.split("\\")).flat(1);return e[e.length-1]},sc=(r,e,t)=>{const{current:n}=r;if(!n)return;const i=n.play();i.catch&&i.catch(s=>{if(n&&!s.message.includes("request was interrupted by a call to pause")&&!s.message.includes("The operation was aborted.")&&!s.message.includes("The fetching process for the media resource was aborted by the user agent")&&!s.message.includes("request was interrupted by a new load request")&&!s.message.includes("because the media was removed from the document")&&!(s.message.includes("user didn't interact with the document")&&n.muted)&&(console.log(`Could not play ${e} due to following error: `,s),!n.muted)){if(t){t();return}console.log("The video will be muted and we'll retry playing it."),e==="video"&&Ct().isPlayer&&console.log("Use onAutoPlayError() to handle this error yourself."),n.muted=!0,n.play()}})},ks=({frame:r,volume:e,mediaVolume:t=1,allowAmplificationDuringRender:n})=>{const i=n?1/0:1;if(typeof e=="number")return Math.min(i,e*t);if(typeof e>"u")return Number(t);const s=e(r)*t;if(typeof s!="number")throw new TypeError(`You passed in a a function to the volume prop but it did not return a number but a value of type ${typeof s} for frame ${r}`);if(Number.isNaN(s))throw new TypeError(`You passed in a function to the volume prop but it returned NaN for frame ${r}.`);if(!Number.isFinite(s))throw new TypeError(`You passed in a function to the volume prop but it returned a non-finite number for frame ${r}.`);return Math.max(0,Math.min(i,s))},R0={},Ok=r=>{R0[r]||(console.warn(r),R0[r]=!0)},V0=({volume:r,mediaVolume:e,mediaRef:t,src:n,mediaType:i,playbackRate:s,displayName:a,id:c,stack:u,showInTimeline:h,premountDisplay:d,onAutoPlayError:g})=>{const p=Qn(),{rootId:y,audioAndVideoTags:w}=v.useContext(Xr),_=v.useContext(Wt),S=_?_.relativeFrom+_.cumulatedFrom:0,[T]=Th(),k=Es(),{registerSequence:I,unregisterSequence:M}=v.useContext(_s),[L]=v.useState(()=>r),N=yh(),H=_?Math.min(_.durationInFrames,p.durationInFrames):p.durationInFrames,R=typeof r=="function",X=v.useMemo(()=>typeof r=="number"?r:new Array(Math.floor(Math.max(0,H+k))).fill(!0).map((U,K)=>ks({frame:K+k,volume:r,mediaVolume:e,allowAmplificationDuringRender:!1})).join(","),[H,k,r,e]);v.useEffect(()=>{typeof r=="number"&&r!==L&&Ok(`Remotion: The ${i} with src ${n} has changed it's volume. Prefer the callback syntax for setting volume to get better timeline display: https://www.remotion.dev/docs/using-audio/#controlling-volume`)},[L,i,n,r]),v.useEffect(()=>{if(t.current){if(!n)throw new Error("No src passed");if(!(!Ct().isStudio&&window.process?.env?.NODE_ENV!=="test")&&h)return I({type:i,src:n,id:c,duration:H,from:0,parent:_?.id??null,displayName:a??Mk(n),rootId:y,volume:X,showInTimeline:!0,nonce:N,startMediaFrom:0-k,doesVolumeChange:R,loopDisplay:void 0,playbackRate:s,stack:u,premountDisplay:d}),()=>{M(c)}}},[S,H,c,_,n,I,y,M,p,X,R,N,t,i,k,s,a,u,h,d]),v.useEffect(()=>{const U={id:c,play:()=>{if(T)return sc(t,i,g)}};return w.current.push(U),()=>{w.current=w.current.filter(K=>K.id!==c)}},[w,c,t,i,g,T])},Pk=()=>{const[r,e]=v.useState([]),[t,n]=v.useState([]),[i,s]=v.useState([]),a=v.useRef(!1),c=v.useCallback(d=>(e(g=>[...g,d]),{unblock:()=>{e(g=>{const p=g.filter(y=>y!==d);return p.length===g.length?g:p})}}),[]),u=v.useCallback(d=>(n(g=>[...g,d]),{remove:()=>{n(g=>g.filter(p=>p!==d))}}),[]),h=v.useCallback(d=>(s(g=>[...g,d]),{remove:()=>{s(g=>g.filter(p=>p!==d))}}),[]);return v.useEffect(()=>{r.length>0&&t.forEach(d=>d())},[r]),v.useEffect(()=>{r.length===0&&i.forEach(d=>d())},[r]),v.useMemo(()=>({addBlock:c,listenForBuffering:u,listenForResume:h,buffering:a}),[c,a,u,h])},Is=v.createContext(null),B0=({children:r})=>{const e=Pk();return b.jsx(Is.Provider,{value:e,children:r})},Dk=r=>{const[e,t]=v.useState(r.buffering.current);return v.useEffect(()=>{const n=()=>{t(!0)},i=()=>{t(!1)};return r.listenForBuffering(n),r.listenForResume(i),()=>{r.listenForBuffering(()=>{}),r.listenForResume(()=>{})}},[r]),e},Oh=()=>{const r=v.useContext(Is),e=r?r.addBlock:null;return v.useMemo(()=>({delayPlayback:()=>{if(!e)throw new Error("Tried to enable the buffering state, but a Remotion context was not found. This API can only be called in a component that was passed to the Remotion Player or a <Composition>. Or you might have experienced a version mismatch - run `npx remotion versions` and ensure all packages have the same version. This error is thrown by the buffer state https://remotion.dev/docs/player/buffer-state");const{unblock:t}=e({id:String(Math.random())});return{unblock:t}}}),[e])},jk=({mediaRef:r,mediaType:e,onVariableFpsVideoDetected:t,pauseWhenBuffering:n})=>{const i=v.useRef(!1),{delayPlayback:s}=Oh(),a=v.useCallback(c=>{if(e!=="video"||!n)return;const u=r.current;if(!u||!u.requestVideoFrameCallback)return;i.current=!0;const h=s(),d=()=>{h.unblock(),u.removeEventListener("ended",d,{once:!0}),u.removeEventListener("pause",d,{once:!0}),i.current=!1},g=()=>{d()};u.requestVideoFrameCallback((p,y)=>{Math.abs(y.mediaTime-c)>.5&&t(),d()}),u.addEventListener("ended",g,{once:!0}),u.addEventListener("pause",g,{once:!0}),u.addEventListener("canplay",g,{once:!0})},[s,r,e,t,n]);return v.useMemo(()=>({isBuffering:()=>i.current,bufferUntilFirstFrame:a}),[a])},Lk=({element:r,shouldBuffer:e,isPremounting:t})=>{const n=Oh(),[i,s]=v.useState(!1);return v.useEffect(()=>{let a=[];const{current:c}=r;if(!c||!e||t)return;const u=()=>{a.forEach(g=>g()),a=[],s(!1)},h=()=>{s(!0);const{unblock:g}=n.delayPlayback(),p=()=>{u(),d()},y=()=>{u(),d()};c.addEventListener("canplay",p,{once:!0}),a.push(()=>{c.removeEventListener("canplay",p)}),c.addEventListener("error",y,{once:!0}),a.push(()=>{c.removeEventListener("error",y)}),a.push(()=>{g()})},d=()=>{c.readyState<c.HAVE_FUTURE_DATA?(h(),navigator.userAgent.includes("Firefox/")||c.load()):(c.addEventListener("waiting",h),a.push(()=>{c.removeEventListener("waiting",h)}))};return d(),()=>{u()}},[n,r,t,e]),i},Fk=({mediaRef:r,mediaType:e,lastSeek:t,onVariableFpsVideoDetected:n})=>{const i=v.useRef(null);return v.useEffect(()=>{const{current:s}=r;if(s)i.current=s.currentTime;else{i.current=null;return}if(e!=="video"){i.current=null;return}const a=s;if(!a.requestVideoFrameCallback)return;let c=()=>{};const u=()=>{if(!a)return;const h=a.requestVideoFrameCallback((d,g)=>{if(i.current!==null){const p=Math.abs(i.current-g.mediaTime),y=Math.abs(t.current===null?1/0:g.mediaTime-t.current);p>.5&&y>.5&&g.mediaTime>i.current&&n()}i.current=g.mediaTime,u()});c=()=>{a.cancelVideoFrameCallback(h),c=()=>{}}};return u(),()=>{c()}},[t,r,e,n]),i};function Nk(r,e,t,n){const{extrapolateLeft:i,extrapolateRight:s,easing:a}=n;let c=r;const[u,h]=e,[d,g]=t;if(c<u){if(i==="identity")return c;if(i==="clamp")c=u;else if(i==="wrap"){const p=h-u;c=((c-u)%p+p)%p+u}}if(c>h){if(s==="identity")return c;if(s==="clamp")c=h;else if(s==="wrap"){const p=h-u;c=((c-u)%p+p)%p+u}}return d===g?d:(c=(c-u)/(h-u),c=a(c),c=c*(g-d)+d,c)}function Rk(r,e){let t;for(t=1;t<e.length-1&&!(e[t]>=r);++t);return t-1}function Vk(r){for(let e=1;e<r.length;++e)if(!(r[e]>r[e-1]))throw new Error(`inputRange must be strictly monotonically increasing but got [${r.join(",")}]`)}function z0(r,e){if(e.length<2)throw new Error(r+" must have at least 2 elements");for(const t of e){if(typeof t!="number")throw new Error(`${r} must contain only numbers`);if(!Number.isFinite(t))throw new Error(`${r} must contain only finite numbers, but got [${e.join(",")}]`)}}function H0(r,e,t,n){if(typeof r>"u")throw new Error("input can not be undefined");if(typeof e>"u")throw new Error("inputRange can not be undefined");if(typeof t>"u")throw new Error("outputRange can not be undefined");if(e.length!==t.length)throw new Error("inputRange ("+e.length+") and outputRange ("+t.length+") must have the same length");z0("inputRange",e),z0("outputRange",t),Vk(e);const i=n?.easing??(u=>u);let s="extend";n?.extrapolateLeft!==void 0&&(s=n.extrapolateLeft);let a="extend";if(n?.extrapolateRight!==void 0&&(a=n.extrapolateRight),typeof r!="number")throw new TypeError("Cannot interpolate an input which is not a number");const c=Rk(r,e);return Nk(r,[e[c],e[c+1]],[t[c],t[c+1]],{easing:i,extrapolateLeft:s,extrapolateRight:a})}var W0=({frame:r,playbackRate:e,startFrom:t})=>H0(r,[-1,t,t+1],[-1,t,t+e]),U0=({fps:r,frame:e,playbackRate:t,startFrom:n})=>{const i=W0({frame:e,playbackRate:t,startFrom:n}),s=1e3/r;return i*s/1e3},$0=(r,e)=>Math.round(r/e*100)/100,oc=()=>{if(typeof window>"u")return!1;const r=/iP(ad|od|hone)/i.test(window.navigator.userAgent),e=/AppleWebKit/.test(window.navigator.userAgent);return r&&e},Bk=r=>oc()&&r.startsWith("blob:"),Ph=({actualFrom:r,fps:e})=>$0(Math.max(0,-r),e),Dh=({duration:r,fps:e})=>$0(r,e),zk=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{if(Bk(r)||r.startsWith("data:")||!!new URL(r,(typeof window>"u"?null:window.location.href)??"http://localhost:3000").hash||!Number.isFinite(e))return r;const s=`${r}#t=${Ph({actualFrom:e,fps:n})}`;return Number.isFinite(t)?`${s},${Dh({duration:t,fps:n})}`:s},Hk=({prevStartFrom:r,newStartFrom:e,prevDuration:t,newDuration:n,fps:i})=>{const s=Ph({actualFrom:r,fps:i}),a=Ph({actualFrom:e,fps:i}),c=Dh({duration:t,fps:i}),u=Dh({duration:n,fps:i});return!(a<s||u>c)},Wk=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{const i=v.useRef(e),s=v.useRef(t),a=v.useRef(r);return(!Hk({prevStartFrom:i.current,newStartFrom:e,prevDuration:s.current,newDuration:t,fps:n})||r!==a.current)&&(i.current=e,s.current=t,a.current=r),zk({actualSrc:a.current,actualFrom:i.current,duration:s.current,fps:n})},Y0={},Uk=(r,e)=>{if(r===null||r.seekable.length===0||r.seekable.length>1||Y0[r.src])return;const t={start:r.seekable.start(0),end:r.seekable.end(0)};if(t.start===0&&t.end===0){const n=[`The media ${r.src} cannot be seeked. This could be one of few reasons:`,"1) The media resource was replaced while the video is playing but it was not loaded yet.","2) The media does not support seeking.","3) The media was loaded with security headers prventing it from being included.","Please see https://remotion.dev/docs/non-seekable-media for assistance."].join(`
`);if(e==="console-error")console.error(n);else if(e==="console-warning")console.warn(`The media ${r.src} does not support seeking. The video will render fine, but may not play correctly in the Remotion Studio and in the <Player>. See https://remotion.dev/docs/non-seekable-media for an explanation.`);else throw new Error(n);Y0[r.src]=!0}},jh=.45,Lh=(r,e)=>{if(!r.current)return;const t=oc()?Number(e.toFixed(1)):e;r.current.currentTime=t},X0=({mediaRef:r,src:e,mediaType:t,playbackRate:n,onlyWarnForMediaSeekingError:i,acceptableTimeshift:s,pauseWhenBuffering:a,isPremounting:c,debugSeeking:u,onAutoPlayError:h})=>{const{playbackRate:d}=v.useContext(Xr),g=ei(),p=Ei(),[y]=Th(),w=v.useContext(Is),{fps:_}=Qn(),S=Es(),T=v.useRef(null),k=v.useRef(null);if(!w)throw new Error("useMediaPlayback must be used inside a <BufferingContext>");const I=v.useRef({}),M=v.useCallback(()=>{e&&(u&&console.log(`Detected ${e} as a variable FPS video. Disabling buffering while seeking.`),I.current[e]=!0)},[u,e]),L=Fk({mediaRef:r,mediaType:t,lastSeek:k,onVariableFpsVideoDetected:M}),N=U0({frame:g,playbackRate:n,startFrom:-S,fps:_}),H=Lk({element:r,shouldBuffer:a,isPremounting:c}),{bufferUntilFirstFrame:R,isBuffering:X}=jk({mediaRef:r,mediaType:t,onVariableFpsVideoDetected:M,pauseWhenBuffering:a}),U=n*d,K=r.current?.duration?Math.min(r.current.duration,s??jh):s,$=Dk(w);v.useEffect(()=>{if(!y){r.current?.pause();return}const G=H||X();$&&!G&&r.current?.pause()},[X,H,$,r,y]),v.useEffect(()=>{const G=t==="audio"?"<Audio>":"<Video>";if(!r.current)throw new Error(`No ${t} ref found`);if(!e)throw new Error(`No 'src' attribute was passed to the ${G} element.`);const re=Math.max(0,U);r.current.playbackRate!==re&&(r.current.playbackRate=re);const{duration:fe}=r.current,Q=!Number.isNaN(fe)&&Number.isFinite(fe)?Math.min(fe,N):N,ue=r.current.currentTime,oe=L.current??null,se=I.current[e],de=Math.abs(Q-ue),ne=oe?Math.abs(Q-oe):null,Fe=ne&&!se?ne:de;if(u&&console.log({mediaTagTime:ue,rvcTime:oe,shouldBeTime:Q,state:r.current.readyState,playing:!r.current.paused,isVariableFpsVideo:se}),Fe>K&&T.current!==Q){u&&console.log("Seeking",{shouldBeTime:Q,isTime:ue,rvcTime:oe,timeShift:Fe,isVariableFpsVideo:se}),Lh(r,Q),k.current=Q,T.current=Q,y&&!se&&(U>0&&R(Q),r.current.paused&&sc(r,t,h)),i||Uk(r.current,i?"console-warning":"console-error");return}const Ge=y?.15:1e-5,Re=Math.abs(r.current.currentTime-Q)>Ge,_e=H||X(),ke=w.buffering.current&&!_e;if(!y||ke){Re&&(Lh(r,Q),k.current=Q);return}(r.current.paused&&!r.current.ended||p===0)&&(Re&&(Lh(r,Q),k.current=Q),sc(r,t,h),se||U>0&&R(Q))},[p,K,R,w.buffering,L,u,N,X,H,r,t,i,U,y,e,h])},G0=r=>{const[e,t]=v.useState(1);return v.useEffect(()=>{const n=r.current;if(!n)return;const i=()=>{t(n.volume)};return n.addEventListener("volumechange",i),()=>n.removeEventListener("volumechange",i)},[r]),v.useEffect(()=>{const n=r.current;n&&n.volume!==e&&t(n.volume)},[e,r]),e},$k=1e-5,Fh=(r,e)=>Math.abs(r-e)<$k,q0=({volumePropFrame:r,actualVolume:e,volume:t,mediaVolume:n,mediaRef:i})=>{v.useEffect(()=>{const s=ks({frame:r,volume:t,mediaVolume:n,allowAmplificationDuringRender:!1});!Fh(s,e)&&i.current&&(i.current.volume=s)},[e,r,i,t,n])},Nh=v.createContext({mediaMuted:!1,mediaVolume:1}),Rh=v.createContext({setMediaMuted:()=>{throw new Error("default")},setMediaVolume:()=>{throw new Error("default")}}),Vh=()=>{const{mediaVolume:r}=v.useContext(Nh),{setMediaVolume:e}=v.useContext(Rh);return v.useMemo(()=>[r,e],[r,e])},Bh=()=>{const{mediaMuted:r}=v.useContext(Nh),{setMediaMuted:e}=v.useContext(Rh);return v.useMemo(()=>[r,e],[r,e])},K0="data:audio/mp3;base64,/+MYxAAJcAV8AAgAABn//////+/gQ5BAMA+D4Pg+BAQBAEAwD4Pg+D4EBAEAQDAPg++hYBH///hUFQVBUFREDQNHmf///////+MYxBUGkAGIMAAAAP/29Xt6lUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDUAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",Yk=(r,e)=>{const t=Object.keys(r).sort(),n=Object.keys(e).sort();if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==n[i]||r[t[i]]!==e[n[i]])return!1;return!0},Xk=(r,e,t)=>r==="src"&&!t.startsWith("data:")&&!e.startsWith("data:")?new URL(t,window.origin).toString()!==new URL(e,window.origin).toString():t!==e,ac=v.createContext(null),Z0=({children:r,numberOfAudioTags:e,component:t})=>{const n=v.useRef([]),[i]=v.useState(e);if(e!==i)throw new Error("The number of shared audio tags has changed dynamically. Once you have set this property, you cannot change it afterwards.");const s=v.useMemo(()=>new Array(e).fill(!0).map(()=>({id:Math.random(),ref:v.createRef()})),[e]),a=v.useRef(new Array(e).fill(!1)),c=v.useCallback(()=>{s.forEach(({ref:w,id:_})=>{const S=n.current?.find(k=>k.id===_),{current:T}=w;if(T){if(S===void 0){T.src=K0;return}if(!S)throw new TypeError("Expected audio data to be there");Object.keys(S.props).forEach(k=>{Xk(k,S.props[k],T[k])&&(T[k]=S.props[k])})}})},[s]),u=v.useCallback((w,_)=>{const S=n.current?.find(N=>N.audioId===_);if(S)return S;const T=a.current.findIndex(N=>N===!1);if(T===-1)throw new Error(`Tried to simultaneously mount ${e+1} <Audio /> tags at the same time. With the current settings, the maximum amount of <Audio /> tags is limited to ${e} at the same time. Remotion pre-mounts silent audio tags to help avoid browser autoplay restrictions. See https://remotion.dev/docs/player/autoplay#use-the-numberofsharedaudiotags-property for more information on how to increase this limit.`);const{id:k,ref:I}=s[T],M=[...a.current];M[T]=k,a.current=M;const L={props:w,id:k,el:I,audioId:_};return n.current?.push(L),c(),L},[e,s,c]),h=v.useCallback(w=>{const _=[...a.current],S=s.findIndex(T=>T.id===w);if(S===-1)throw new TypeError("Error occured in ");_[S]=!1,a.current=_,n.current=n.current?.filter(T=>T.id!==w),c()},[s,c]),d=v.useCallback(({aud:w,audioId:_,id:S})=>{let T=!1;n.current=n.current?.map(k=>k.id===S?Yk(w,k.props)?k:(T=!0,{...k,props:w,audioId:_}):k),T&&c()},[c]),g=v.useCallback(()=>{s.forEach(w=>{sc(w.ref,"audio",null)})},[s]),p=v.useMemo(()=>({registerAudio:u,unregisterAudio:h,updateAudio:d,playAllAudios:g,numberOfAudioTags:e}),[e,g,u,h,d]),y=v.useCallback(()=>{a.current=new Array(e).fill(!1),n.current=[],c()},[e,c]);return v.useEffect(()=>()=>{y()},[t,y]),b.jsxs(ac.Provider,{value:p,children:[s.map(({id:w,ref:_})=>b.jsx("audio",{ref:_,preload:"metadata",src:K0},w)),r]})},Gk=(r,e)=>{const t=v.useContext(ac),[n]=v.useState(()=>t&&t.numberOfAudioTags>0?t.registerAudio(r,e):{el:v.createRef(),id:Math.random(),props:r,audioId:e}),i=v.useInsertionEffect??v.useLayoutEffect;return typeof document<"u"&&(i(()=>{t&&t.numberOfAudioTags>0&&t.updateAudio({id:n.id,aud:r,audioId:e})},[r,t,n.id,e]),i(()=>()=>{t&&t.numberOfAudioTags>0&&t.unregisterAudio(n.id)},[t,n.id])),n},qk=(r,e)=>{const[t]=v.useState(r.shouldPreMountAudioTags);if(r.shouldPreMountAudioTags!==t)throw new Error("Cannot change the behavior for pre-mounting audio tags dynamically.");const{volume:n,muted:i,playbackRate:s,shouldPreMountAudioTags:a,src:c,onDuration:u,acceptableTimeShiftInSeconds:h,_remotionInternalNeedsDurationCalculation:d,_remotionInternalNativeLoopPassed:g,_remotionInternalStack:p,_remotionDebugSeeking:y,allowAmplificationDuringRender:w,name:_,pauseWhenBuffering:S,showInTimeline:T,loopVolumeCurveBehavior:k,stack:I,...M}=r,[L]=Vh(),[N]=Bh(),H=Ao(k??"repeat"),{hidden:R}=v.useContext(ko);if(!c)throw new TypeError("No 'src' was passed to <Audio>.");const X=Ts(c),U=v.useContext(Wt),[K]=v.useState(()=>String(Math.random())),$=R[K]??!1,G=ks({frame:H,volume:n,mediaVolume:L,allowAmplificationDuringRender:!1}),re=v.useMemo(()=>({muted:i||N||$||G<=0,src:X,loop:g,...M}),[g,$,N,i,M,X,G]),fe=v.useMemo(()=>`audio-${Ai(c??"")}-${U?.relativeFrom}-${U?.cumulatedFrom}-${U?.durationInFrames}-muted:${r.muted}-loop:${r.loop}`,[c,U?.relativeFrom,U?.cumulatedFrom,U?.durationInFrames,r.muted,r.loop]),Q=Gk(re,fe).el,ue=G0(Q);q0({volumePropFrame:H,actualVolume:ue,volume:n,mediaVolume:L,mediaRef:Q}),V0({volume:n,mediaVolume:L,mediaRef:Q,src:c,mediaType:"audio",playbackRate:s??1,displayName:_??null,id:K,stack:p,showInTimeline:T,premountDisplay:null,onAutoPlayError:null}),X0({mediaRef:Q,src:c,mediaType:"audio",playbackRate:s??1,onlyWarnForMediaSeekingError:!1,acceptableTimeshift:h??jh,isPremounting:!!U?.premounting,pauseWhenBuffering:S,debugSeeking:y,onAutoPlayError:null}),v.useImperativeHandle(e,()=>Q.current,[Q]);const oe=v.useRef();return oe.current=u,v.useEffect(()=>{const{current:se}=Q;if(!se)return;if(se.duration){oe.current?.(se.src,se.duration);return}const de=()=>{oe.current?.(se.src,se.duration)};return se.addEventListener("loadedmetadata",de),()=>{se.removeEventListener("loadedmetadata",de)}},[Q,c]),t?null:b.jsx("audio",{ref:Q,preload:"metadata",...re})},Kk=v.forwardRef(qk);typeof window<"u"&&(window.remotion_renderReady=!1);var cc=[];typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var Zk="The delayRender was called:",Jk="Retries left: ",Qk="- Rendering the frame will be retried.",J0=3e4,ti=(r,e)=>{if(typeof r!="string"&&typeof r<"u")throw new Error("The label parameter of delayRender() must be a string or undefined, got: "+JSON.stringify(r));const t=Math.random();cc.push(t);const n=Error().stack?.replace(/^Error/g,"")??"";if(Ct().isRendering){const i=(e?.timeoutInMilliseconds??(typeof window>"u"?J0:window.remotion_puppeteerTimeout??J0))-2e3;if(typeof window<"u"){const s=(e?.retries??0)-(window.remotion_attempt-1);window.remotion_delayRenderTimeouts[t]={label:r??null,timeout:setTimeout(()=>{const a=["A delayRender()",r?`"${r}"`:null,`was called but not cleared after ${i}ms. See https://remotion.dev/docs/timeout for help.`,s>0?Jk+s:null,s>0?Qk:null,Zk,n].filter(Ka).join(" ");Io(Error(a))},i)}}}return typeof window<"u"&&(window.remotion_renderReady=!1),t},gt=r=>{if(typeof r>"u")throw new TypeError("The continueRender() method must be called with a parameter that is the return value of delayRender(). No value was passed.");if(typeof r!="number")throw new TypeError("The parameter passed into continueRender() must be the return value of delayRender() which is a number. Got: "+JSON.stringify(r));cc=cc.filter(e=>e===r?(Ct().isRendering&&(clearTimeout(window.remotion_delayRenderTimeouts[r].timeout),delete window.remotion_delayRenderTimeouts[r]),!1):!0),cc.length===0&&typeof window<"u"&&(window.remotion_renderReady=!0)},e5=(r,e)=>{const t=v.useRef(null),{volume:n,playbackRate:i,allowAmplificationDuringRender:s,onDuration:a,toneFrequency:c,_remotionInternalNeedsDurationCalculation:u,_remotionInternalNativeLoopPassed:h,acceptableTimeShiftInSeconds:d,name:g,onError:p,delayRenderRetries:y,delayRenderTimeoutInMilliseconds:w,loopVolumeCurveBehavior:_,pauseWhenBuffering:S,...T}=r,k=Ei(),I=Ao(_??"repeat"),M=ei(),L=v.useContext(Wt),{registerRenderAsset:N,unregisterRenderAsset:H}=v.useContext(Ii),R=v.useMemo(()=>`audio-${Ai(r.src??"")}-${L?.relativeFrom}-${L?.cumulatedFrom}-${L?.durationInFrames}`,[r.src,L?.relativeFrom,L?.cumulatedFrom,L?.durationInFrames]),X=ks({volume:n,frame:I,mediaVolume:1,allowAmplificationDuringRender:s??!1});v.useImperativeHandle(e,()=>t.current,[]),v.useEffect(()=>{if(!r.src)throw new Error("No src passed");if(window.remotion_audioEnabled&&!r.muted&&!(X<=0))return N({type:"audio",src:En(r.src),id:R,frame:k,volume:X,mediaFrame:M,playbackRate:r.playbackRate??1,allowAmplificationDuringRender:s??!1,toneFrequency:c??null,audioStartFrame:Math.max(0,-(L?.relativeFrom??0))}),()=>H(R)},[r.muted,r.src,N,k,R,H,X,I,M,i,r.playbackRate,s,c,L?.relativeFrom]);const{src:U}=r,K=e||u;return v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"||!K)return;const $=ti("Loading <Audio> duration with src="+U,{retries:y??void 0,timeoutInMilliseconds:w??void 0}),{current:G}=t,re=()=>{G?.duration&&a(G.src,G.duration),gt($)};return G?.duration?(a(G.src,G.duration),gt($)):G?.addEventListener("loadedmetadata",re,{once:!0}),()=>{G?.removeEventListener("loadedmetadata",re),gt($)}},[U,a,K,y,w]),K?b.jsx("audio",{ref:t,...T}):null},t5=v.forwardRef(e5),r5=(r,e)=>{const t=v.useContext(ac),{startFrom:n,endAt:i,name:s,stack:a,pauseWhenBuffering:c,showInTimeline:u,_remotionDebugSeeking:h,...d}=r,{loop:g,...p}=r,{fps:y}=Qn(),w=Ct(),{durations:_,setDurations:S}=v.useContext(Mh);if(typeof r.src!="string")throw new TypeError(`The \`<Audio>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const T=Ts(r.src),k=v.useCallback(L=>{console.log(L.currentTarget.error);const N=`Could not play audio with src ${T}: ${L.currentTarget.error}. See https://remotion.dev/docs/media-playback-error for help.`;g?Io(new Error(N)):console.warn(N)},[g,T]),I=v.useCallback((L,N)=>{S({type:"got-duration",durationInSeconds:N,src:L})},[S]),M=_[En(T)]??_[En(r.src)];if(g&&M!==void 0){if(!Number.isFinite(M))return b.jsx(Mo,{...p,ref:e,_remotionInternalNativeLoopPassed:!0});const L=M*y;return b.jsx(nc,{layout:"none",durationInFrames:P0({endAt:i,mediaDuration:L,playbackRate:r.playbackRate??1,startFrom:n}),children:b.jsx(Mo,{...p,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof n<"u"||typeof i<"u"){Ah(n,i);const L=n??0,N=i??1/0;return b.jsx(dn,{layout:"none",from:0-L,showInTimeline:!1,durationInFrames:N,name:s,children:b.jsx(Mo,{_remotionInternalNeedsDurationCalculation:!!g,pauseWhenBuffering:c??!1,...d,ref:e})})}return Ih(r,"Audio"),w.isRendering?b.jsx(t5,{onDuration:I,...r,ref:e,onError:k,_remotionInternalNeedsDurationCalculation:!!g}):b.jsx(Kk,{_remotionInternalNativeLoopPassed:r._remotionInternalNativeLoopPassed??!1,_remotionDebugSeeking:h??!1,_remotionInternalStack:a??null,shouldPreMountAudioTags:t!==null&&t.numberOfAudioTags>0,...r,ref:e,onError:k,onDuration:I,pauseWhenBuffering:c??!1,_remotionInternalNeedsDurationCalculation:!!g,showInTimeline:u??!0})},Mo=v.forwardRef(r5);To(Mo);var n5=v.createContext({folderName:null,parentName:null}),i5={transform:"rotate(90deg)"},Q0=40,s5={color:"white",fontSize:14,fontFamily:"sans-serif"},o5={justifyContent:"center",alignItems:"center"},a5=()=>b.jsxs(Eo,{style:o5,id:"remotion-comp-loading",children:[b.jsx("style",{type:"text/css",children:`
				@keyframes anim {
					from {
						opacity: 0
					}
					to {
						opacity: 1
					}
				}
				#remotion-comp-loading {
					animation: anim 2s;
					animation-fill-mode: forwards;
				}
			`}),b.jsx("svg",{width:Q0,height:Q0,viewBox:"-100 -100 400 400",style:i5,children:b.jsx("path",{fill:"#555",stroke:"#555",strokeWidth:"100",strokeLinejoin:"round",d:"M 2 172 a 196 100 0 0 0 195 5 A 196 240 0 0 0 100 2.259 A 196 240 0 0 0 2 172 z"})}),b.jsxs("p",{style:s5,children:["Resolving ","<Suspense>","..."]})]}),pr=null,zh=()=>{if(!pr){if(typeof document>"u")throw new Error("Tried to call an API that only works in the browser from outside the browser");pr=document.createElement("div"),pr.style.position="absolute",pr.style.top="0px",pr.style.left="0px",pr.style.right="0px",pr.style.bottom="0px",pr.style.width="100%",pr.style.height="100%",pr.style.display="flex",pr.style.flexDirection="column";const r=document.createElement("div");r.style.position="fixed",r.style.top="-999999px",r.appendChild(pr),document.body.appendChild(r)}return pr},ev=r=>v.useMemo(()=>{if("lazyComponent"in r&&typeof r.lazyComponent<"u")return v.lazy(r.lazyComponent);if("component"in r)return typeof document>"u"?r.component:v.lazy(()=>Promise.resolve({default:r.component}));throw new Error("You must pass either 'component' or 'lazyComponent'")},[r.component,r.lazyComponent]),tv=()=>/^([a-zA-Z0-9-\u4E00-\u9FFF])+$/g,rv=r=>r.match(tv()),c5=r=>{if(!rv(r))throw new Error(`Composition id can only contain a-z, A-Z, 0-9, CJK characters and -. You passed ${r}`)},l5=`Composition ID must match ${String(tv())}`,u5=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}},h5=()=>(v.useEffect(()=>{const r=ti("Waiting for Root component to unsuspend");return()=>gt(r)},[]),null),nv=({width:r,height:e,fps:t,durationInFrames:n,id:i,defaultProps:s,schema:a,...c})=>{const{registerComposition:u,unregisterComposition:h}=v.useContext(Jn),d=tc(),g=ev(c),p=yh(),y=vh(),w=Ct();if(v.useContext(ki))throw y?new Error("<Composition> was mounted inside the `component` that was passed to the <Player>. See https://remotion.dev/docs/wrong-composition-mount for help."):new Error("<Composition> mounted inside another composition. See https://remotion.dev/docs/wrong-composition-mount for help.");const{folderName:S,parentName:T}=v.useContext(n5);v.useEffect(()=>{if(!i)throw new Error("No id for composition passed.");return c5(i),u5(s,"defaultProps",i),u({durationInFrames:n??void 0,fps:t??void 0,height:e??void 0,width:r??void 0,id:i,folderName:S,component:g,defaultProps:Ti(s??{}),nonce:p,parentFolderName:T,schema:a??null,calculateMetadata:c.calculateMetadata??null}),()=>{h(i)}},[n,t,e,g,i,S,s,u,h,r,p,T,a,c.calculateMetadata]);const k=Sh(i);if(w.isStudio&&d&&d.component===g){const I=g;return k===null||k.type!=="success"?null:wu.createPortal(b.jsx(Eh,{children:b.jsx(v.Suspense,{fallback:b.jsx(a5,{}),children:b.jsx(I,{...k.result.props??{}})})}),zh())}if(w.isRendering&&d&&d.component===g){const I=g;return k===null||k.type!=="success"?null:wu.createPortal(b.jsx(Eh,{children:b.jsx(v.Suspense,{fallback:b.jsx(h5,{}),children:b.jsx(I,{...k.result.props??{}})})}),zh())}return null},iv=v.createRef(),d5=({children:r,numberOfAudioTags:e})=>{const[t,n]=v.useState([]),i=v.useRef(t),[s,a]=v.useState([]),[c,u]=v.useState(null),[h,d]=v.useState(null),g=v.useCallback(I=>{n(M=>{const L=I(M);return i.current=L,L})},[]),p=v.useCallback(I=>{g(M=>{if(M.find(N=>N.id===I.id))throw new Error(`Multiple composition with id ${I.id} are registered.`);return[...M,I].slice().sort((N,H)=>N.nonce-H.nonce)})},[g]),y=v.useCallback(I=>{n(M=>M.filter(L=>L.id!==I))},[]),w=v.useCallback((I,M)=>{a(L=>[...L,{name:I,parent:M}])},[]),_=v.useCallback((I,M)=>{a(L=>L.filter(N=>!(N.name===I&&N.parent===M)))},[]);v.useImperativeHandle(iv,()=>({getCompositions:()=>i.current}),[]);const S=t.find(I=>c?.type==="composition"?I.id===c.compositionId:null),T=v.useCallback((I,M)=>{n(L=>L.map(H=>H.id===I?{...H,defaultProps:M}:H))},[]),k=v.useMemo(()=>({compositions:t,registerComposition:p,unregisterComposition:y,folders:s,registerFolder:w,unregisterFolder:_,currentCompositionMetadata:h,setCurrentCompositionMetadata:d,canvasContent:c,setCanvasContent:u,updateCompositionDefaultProps:T}),[t,p,y,s,w,_,h,c,T]);return b.jsx(Jn.Provider,{value:k,children:b.jsx(sk,{children:b.jsx(Tk,{children:b.jsx(E0,{children:b.jsx(Z0,{numberOfAudioTags:e,component:S?.component??null,children:r})})})})})},f5=({onLoad:r,onError:e,delayRenderRetries:t,delayRenderTimeoutInMilliseconds:n,...i},s)=>{const[a]=v.useState(()=>ti(`Loading <IFrame> with source ${i.src}`,{retries:t??void 0,timeoutInMilliseconds:n??void 0})),c=v.useCallback(h=>{gt(a),r?.(h)},[a,r]),u=v.useCallback(h=>{gt(a),e?e(h):console.error("Error loading iframe:",h,"Handle the event using the onError() prop to make this message disappear.")},[a,e]);return b.jsx("iframe",{...i,ref:s,onError:u,onLoad:c})};v.forwardRef(f5);function g5(r){return 1e3*2**(r-1)}var p5=({onError:r,maxRetries:e=2,src:t,pauseWhenLoading:n,delayRenderRetries:i,delayRenderTimeoutInMilliseconds:s,onImageFrame:a,...c},u)=>{const h=v.useRef(null),d=v.useRef({}),{delayPlayback:g}=Oh(),p=v.useContext(Wt);if(!t)throw new Error('No "src" prop was passed to <Img>.');v.useImperativeHandle(u,()=>h.current,[]);const y=Ts(t),w=v.useCallback(S=>{if(!h.current)return;const T=h.current.src;setTimeout(()=>{if(!h.current)return;const k=h.current?.src;k===T&&(h.current.removeAttribute("src"),h.current.setAttribute("src",k))},S)},[]),_=v.useCallback(S=>{if(d.current){if(d.current[h.current?.src]=(d.current[h.current?.src]??0)+1,r&&(d.current[h.current?.src]??0)>e){r(S);return}if((d.current[h.current?.src]??0)<=e){const T=g5(d.current[h.current?.src]??0);console.warn(`Could not load image with source ${h.current?.src}, retrying again in ${T}ms`),w(T);return}Io("Error loading image with src: "+h.current?.src)}},[e,r,w]);if(typeof window<"u"){const S=!!p?.premounting;v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"){h.current&&(h.current.src=y);return}const T=ti("Loading <Img> with src="+y,{retries:i??void 0,timeoutInMilliseconds:s??void 0}),k=n&&!S?g().unblock:()=>{},{current:I}=h;let M=!1;const L=()=>{M||((d.current[h.current?.src]??0)>0&&(delete d.current[h.current?.src],console.info(`Retry successful - ${h.current?.src} is now loaded`)),I&&(I.src=y,a?.(I)),k(),gt(T))},N=new Image;return N.src=y,N.decode().then(L).catch(H=>{console.warn(H),N.complete?L():N.addEventListener("load",L)}),()=>{M=!0,N.removeEventListener("load",L),k(),gt(T)}},[y,g,i,s,n,S,a])}return b.jsx("img",{...c,ref:h,onError:_})},sv=v.forwardRef(p5),ov={};a0(ov,{makeDefaultPreviewCSS:()=>v5,injectCSS:()=>m5,OFFTHREAD_VIDEO_CLASS_NAME:()=>lc});var av={},m5=r=>{if(typeof document>"u"||av[r])return;const e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode(r)),e.prepend(t),av[r]=!0},lc="__remotion_offthreadvideo",v5=(r,e)=>r?`
    ${r} * {
      box-sizing: border-box;
    }
    ${r} *:-webkit-full-screen {
      width: 100%;
      height: 100%;
    }
    ${r} .${lc} {
      object-fit: contain;
    }
  `:`
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
	    background-color: ${e};
    }
    .${lc} {
      object-fit: contain;
    }
    `,cv="__remotion-studio-container",y5=()=>document.getElementById(cv),b5=null,Hh=[],w5=()=>b5,x5=r=>(Hh.push(r),()=>{Hh=Hh.filter(e=>e!==r)}),_5=({children:r,numberOfAudioTags:e})=>{const[t]=v.useState(()=>String(Ai(null))),[n,i]=v.useState(()=>I0()),[s,a]=v.useState(!1),c=v.useRef(!1),[u,h]=v.useState(0),[d,g]=v.useState(1),p=v.useRef([]);typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_setFrame=(S,T,k)=>{window.remotion_attempt=k;const I=ti(`Setting the current frame to ${S}`);let M=!0;i(L=>(L[T]??window.remotion_initialFrame)===S?(M=!1,L):{...L,[T]:S}),M?requestAnimationFrame(()=>gt(I)):gt(I)},window.remotion_isPlayer=!1},[]);const y=v.useMemo(()=>({frame:n,playing:s,imperativePlaying:c,rootId:t,playbackRate:d,setPlaybackRate:g,audioAndVideoTags:p}),[n,d,s,t]),w=v.useMemo(()=>({setFrame:i,setPlaying:a}),[]),_=v.useMemo(()=>{let S=0;return{getNonce:()=>S++,fastRefreshes:u}},[u]);return v.useEffect(()=>{typeof __webpack_module__<"u"&&__webpack_module__.hot&&__webpack_module__.hot.addStatusHandler(S=>{S==="idle"&&h(T=>T+1)})},[]),b.jsx(Ss.Provider,{value:_,children:b.jsx(Xr.Provider,{value:y,children:b.jsx(Cs.Provider,{value:w,children:b.jsx(p0,{children:b.jsx(L0,{children:b.jsx(d5,{numberOfAudioTags:e,children:b.jsx(F0,{children:b.jsx(B0,{children:r})})})})})})})})},S5=()=>{if(Ct().isRendering){const r=window.remotion_envVariables;return r?{...JSON.parse(r),NODE_ENV:"production"}:{}}return{NODE_ENV:"production"}},C5=()=>{const r=S5();window.process||(window.process={}),window.process.env||(window.process.env={}),Object.keys(r).forEach(e=>{window.process.env[e]=r[e]})},T5=v.createContext(null),E5=v.createContext({setSize:()=>{},size:{size:"auto",translation:{x:0,y:0}}}),k5=({canvasSize:r,compositionHeight:e,compositionWidth:t,previewSize:n})=>{const i=r.height/e,s=r.width/t,a=Math.min(i,s);return n==="auto"?a:Number(n)},I5="remotion_staticFilesChanged";function A5(){const r=v.useContext(Jn),e=v.useContext(Xr),t=v.useContext(Cs),n=v.useContext(Wt),i=v.useContext(Ss),s=v.useContext(ki),a=v.useContext(ic),c=v.useContext(ec),u=v.useContext(Ii),h=v.useContext(_s),d=v.useContext(Is);return v.useMemo(()=>({compositionManagerCtx:r,timelineContext:e,setTimelineContext:t,sequenceContext:n,nonceContext:i,canUseRemotionHooksContext:s,preloadContext:a,resolveCompositionContext:c,renderAssetManagerContext:u,sequenceManagerContext:h,bufferManagerContext:d}),[r,i,n,t,e,s,a,c,u,h,d])}var M5=r=>{const{children:e,contexts:t}=r;return b.jsx(ki.Provider,{value:t.canUseRemotionHooksContext,children:b.jsx(Ss.Provider,{value:t.nonceContext,children:b.jsx(ic.Provider,{value:t.preloadContext,children:b.jsx(Jn.Provider,{value:t.compositionManagerCtx,children:b.jsx(_s.Provider,{value:t.sequenceManagerContext,children:b.jsx(Ii.Provider,{value:t.renderAssetManagerContext,children:b.jsx(ec.Provider,{value:t.resolveCompositionContext,children:b.jsx(Xr.Provider,{value:t.timelineContext,children:b.jsx(Cs.Provider,{value:t.setTimelineContext,children:b.jsx(Wt.Provider,{value:t.sequenceContext,children:b.jsx(Is.Provider,{value:t.bufferManagerContext,children:e})})})})})})})})})})})},xe={useUnsafeVideoConfig:rc,Timeline:f0,CompositionManager:Jn,SequenceManager:_s,SequenceVisibilityToggleContext:ko,RemotionRoot:_5,useVideo:tc,getRoot:w5,useMediaVolumeState:Vh,useMediaMutedState:Bh,useLazyComponent:ev,truthy:Ka,SequenceContext:Wt,useRemotionContexts:A5,RemotionContextProvider:M5,CSSUtils:ov,setupEnvVariables:C5,MediaVolumeContext:Nh,SetMediaVolumeContext:Rh,getRemotionEnvironment:Ct,SharedAudioContext:ac,SharedAudioContextProvider:Z0,invalidCompositionErrorMessage:l5,isCompositionIdValid:rv,getPreviewDomElement:y5,compositionsRef:iv,portalNode:zh,waitForRoot:x5,CanUseRemotionHooksProvider:Eh,CanUseRemotionHooks:ki,PrefetchProvider:L0,DurationsContextProvider:F0,IsPlayerContextProvider:rk,useIsPlayer:vh,EditorPropsProvider:p0,EditorPropsContext:Ja,usePreload:Ts,NonceContext:Ss,resolveVideoConfig:S0,useResolvedVideoConfig:Sh,resolveCompositionsRef:C0,ResolveCompositionConfig:E0,REMOTION_STUDIO_CONTAINER_ELEMENT:cv,RenderAssetManager:Ii,persistCurrentFrame:k0,useTimelineSetFrame:M0,isIosSafari:oc,WATCH_REMOTION_STATIC_FILES:I5,addSequenceStackTraces:To,useMediaStartsAt:Es,BufferingProvider:B0,BufferingContextReact:Is,enableSequenceStackTraces:h0,CurrentScaleContext:T5,PreviewSizeContext:E5,calculateScale:k5,editorPropsProviderRef:g0,PROPS_UPDATED_EXTERNALLY:mk,validateRenderAsset:O0},O5=({src:r,transparent:e,currentTime:t,toneMapped:n})=>`http://localhost:${window.remotion_proxyPort}/proxy?src=${encodeURIComponent(En(r))}&time=${encodeURIComponent(t)}&transparent=${String(e)}&toneMapped=${String(n)}`,lv=v.createContext(!1),P5=({children:r})=>b.jsx(lv.Provider,{value:!1,children:r}),D5=()=>{if(!v.useContext(lv))throw new Error("This component must be inside a <Series /> component.")},j5=({children:r},e)=>(D5(),b.jsx(P5,{children:r})),L5=v.forwardRef(j5);To(L5);var F5=({onError:r,volume:e,playbackRate:t,src:n,muted:i,allowAmplificationDuringRender:s,transparent:a=!1,toneMapped:c=!0,toneFrequency:u,name:h,loopVolumeCurveBehavior:d,delayRenderRetries:g,delayRenderTimeoutInMilliseconds:p,onVideoFrame:y,...w})=>{const _=Ei(),S=ei(),T=Ao(d??"repeat"),k=rc(),I=v.useContext(Wt),M=Es(),{registerRenderAsset:L,unregisterRenderAsset:N}=v.useContext(Ii);if(!n)throw new TypeError("No `src` was passed to <OffthreadVideo>.");const H=v.useMemo(()=>`offthreadvideo-${Ai(n??"")}-${I?.cumulatedFrom}-${I?.relativeFrom}-${I?.durationInFrames}`,[n,I?.cumulatedFrom,I?.relativeFrom,I?.durationInFrames]);if(!k)throw new Error("No video config found");const R=ks({volume:e,frame:T,mediaVolume:1,allowAmplificationDuringRender:s??!1});v.useEffect(()=>{if(!n)throw new Error("No src passed");if(window.remotion_audioEnabled&&!i&&!(R<=0))return L({type:"video",src:En(n),id:H,frame:_,volume:R,mediaFrame:S,playbackRate:t??1,allowAmplificationDuringRender:s??!1,toneFrequency:u??null,audioStartFrame:Math.max(0,-(I?.relativeFrom??0))}),()=>N(H)},[i,n,L,H,N,R,S,_,t,s,u,I?.relativeFrom]);const X=v.useMemo(()=>W0({frame:S,playbackRate:t||1,startFrom:-M})/k.fps,[S,M,t,k.fps]),U=v.useMemo(()=>O5({src:n,currentTime:X,transparent:a,toneMapped:c}),[c,X,n,a]),[K,$]=v.useState(null);v.useLayoutEffect(()=>{if(!window.remotion_videoEnabled)return;const Q=[];$(null);const ue=new AbortController,oe=ti(`Fetching ${U} from server`,{retries:g??void 0,timeoutInMilliseconds:p??void 0});return(async()=>{try{const de=await fetch(U,{signal:ue.signal});if(de.status!==200){if(de.status===500){const Ge=await de.json();if(Ge.error){const Re=Ge.error.replace(/^Error: /,"");throw new Error(Re)}}throw new Error(`Server returned status ${de.status} while fetching ${U}`)}const ne=await de.blob(),Fe=URL.createObjectURL(ne);Q.push(()=>URL.revokeObjectURL(Fe)),$({src:Fe,handle:oe})}catch(de){if(de.message.includes("aborted")){gt(oe);return}if(ue.signal.aborted){gt(oe);return}de.message.includes("Failed to fetch")&&(de=new Error(`Failed to fetch ${U}. This could be caused by Chrome rejecting the request because the disk space is low. Consider increasing the disk size of your environment.`,{cause:de})),r?r(de):Io(de)}})(),Q.push(()=>{ue.signal.aborted||ue.abort()}),()=>{Q.forEach(de=>de())}},[U,g,p,r]);const G=v.useCallback(()=>{r?r?.(new Error("Failed to load image with src "+K)):Io("Failed to load image with src "+K)},[K,r]),re=v.useMemo(()=>[lc,w.className].filter(Ka).join(" "),[w.className]),fe=v.useCallback(Q=>{y&&y(Q)},[y]);return!K||!window.remotion_videoEnabled?null:(gt(K.handle),b.jsx(sv,{src:K.src,className:re,delayRenderRetries:g,delayRenderTimeoutInMilliseconds:p,onImageFrame:fe,...w,onError:G}))},N5=({ref:r,onVideoFrame:e})=>{v.useEffect(()=>{const{current:t}=r;if(!t||!e)return;let n=0;const i=()=>{r.current&&(e(r.current),n=r.current.requestVideoFrameCallback(i))};return i(),()=>{t.cancelVideoFrameCallback(n)}},[e,r])},R5=(r,e)=>{const t=v.useRef(null),{volume:n,muted:i,playbackRate:s,onlyWarnForMediaSeekingError:a,src:c,onDuration:u,acceptableTimeShift:h,acceptableTimeShiftInSeconds:d,toneFrequency:g,name:p,_remotionInternalNativeLoopPassed:y,_remotionInternalStack:w,_remotionDebugSeeking:_,style:S,pauseWhenBuffering:T,showInTimeline:k,loopVolumeCurveBehavior:I,onError:M,onAutoPlayError:L,onVideoFrame:N,crossOrigin:H,...R}=r,X=Ao(I??"repeat"),{fps:U,durationInFrames:K}=Qn(),$=v.useContext(Wt),{hidden:G}=v.useContext(ko),[re]=v.useState(()=>String(Math.random())),fe=G[re]??!1;if(typeof h<"u")throw new Error("acceptableTimeShift has been removed. Use acceptableTimeShiftInSeconds instead.");const Q=G0(t),[ue]=Vh(),[oe]=Bh();V0({mediaRef:t,volume:n,mediaVolume:ue,mediaType:"video",src:c,playbackRate:r.playbackRate??1,displayName:p??null,id:re,stack:w,showInTimeline:k,premountDisplay:null,onAutoPlayError:L??null}),q0({volumePropFrame:X,actualVolume:Q,volume:n,mediaVolume:ue,mediaRef:t}),X0({mediaRef:t,src:c,mediaType:"video",playbackRate:r.playbackRate??1,onlyWarnForMediaSeekingError:a,acceptableTimeshift:d??jh,isPremounting:!!$?.premounting,pauseWhenBuffering:T,debugSeeking:_,onAutoPlayError:L??null});const se=$?$.relativeFrom:0,de=$?Math.min($.durationInFrames,K):K,ne=Wk({actualSrc:Ts(c),actualFrom:se,duration:de,fps:U});v.useImperativeHandle(e,()=>t.current,[]),v.useEffect(()=>{const{current:_e}=t;if(!_e)return;const ke=()=>{if(_e.error){if(console.error("Error occurred in video",_e?.error),M){const ht=new Error(`Code ${_e.error.code}: ${_e.error.message}`);M(ht);return}throw new Error(`The browser threw an error while playing the video ${c}: Code ${_e.error.code} - ${_e?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else{if(M){const ht=new Error(`The browser threw an error while playing the video ${c}`);M(ht);return}throw new Error("The browser threw an error while playing the video")}};return _e.addEventListener("error",ke,{once:!0}),()=>{_e.removeEventListener("error",ke)}},[M,c]);const Fe=v.useRef();Fe.current=u,N5({ref:t,onVideoFrame:N}),v.useEffect(()=>{const{current:_e}=t;if(!_e)return;if(_e.duration){Fe.current?.(c,_e.duration);return}const ke=()=>{Fe.current?.(c,_e.duration)};return _e.addEventListener("loadedmetadata",ke),()=>{_e.removeEventListener("loadedmetadata",ke)}},[c]),v.useEffect(()=>{const{current:_e}=t;_e&&(oc()?_e.preload="metadata":_e.preload="auto")},[]);const Ge=v.useMemo(()=>({...S,opacity:fe?0:S?.opacity??1}),[fe,S]),Re=H??(N?"anonymous":void 0);return b.jsx("video",{ref:t,muted:i||oe,playsInline:!0,src:ne,loop:y,style:Ge,disableRemotePlayback:!0,crossOrigin:Re,...R})},uv=v.forwardRef(R5),hv=r=>{const{startFrom:e,endAt:t,name:n,pauseWhenBuffering:i,stack:s,showInTimeline:a,...c}=r,u=Ct(),h=v.useCallback(()=>{},[]);if(typeof r.src!="string")throw new TypeError(`The \`<OffthreadVideo>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);if(r.imageFormat)throw new TypeError("The `<OffthreadVideo>` tag does no longer accept `imageFormat`. Use the `transparent` prop if you want to render a transparent video.");if(typeof e<"u"||typeof t<"u"){Ah(e,t);const T=e??0,k=t??1/0;return b.jsx(dn,{layout:"none",from:0-T,showInTimeline:!1,durationInFrames:k,name:n,children:b.jsx(hv,{pauseWhenBuffering:i??!1,...c})})}if(Ih(r,"Video"),u.isRendering)return b.jsx(F5,{...c});const{transparent:d,toneMapped:g,_remotionDebugSeeking:p,onAutoPlayError:y,onVideoFrame:w,crossOrigin:_,...S}=c;return b.jsx(uv,{_remotionInternalStack:s??null,_remotionInternalNativeLoopPassed:!1,_remotionDebugSeeking:p??!1,onDuration:h,onlyWarnForMediaSeekingError:!0,pauseWhenBuffering:i??!1,showInTimeline:a??!0,onAutoPlayError:y??void 0,onVideoFrame:w??null,crossOrigin:_,...S})},dv=r=>Math.round(r*1e5)/1e5,Wh=(r,e)=>{if(Fh(r.currentTime,e))return{wait:Promise.resolve(e),cancel:()=>{}};r.currentTime=e;let t,n=null;const i=new Promise(a=>{t=r.requestVideoFrameCallback((c,u)=>{const h=u.expectedDisplayTime-c;if(h<=0){a(u.mediaTime);return}setTimeout(()=>{a(u.mediaTime)},h+150)})}),s=new Promise(a=>{const c=()=>{a()};r.addEventListener("seeked",c,{once:!0}),n=()=>{r.removeEventListener("seeked",c)}});return{wait:Promise.all([i,s]).then(([a])=>a),cancel:()=>{n?.(),r.cancelVideoFrameCallback(t)}}},V5=(r,e,t)=>{const n=1/t/2;let i=()=>{};return Number.isFinite(r.duration)&&r.currentTime>=r.duration&&e>=r.duration?{prom:Promise.resolve(),cancel:()=>{}}:{prom:new Promise((a,c)=>{const u=Wh(r,e+n);u.wait.then(h=>{if(Math.abs(e-h)<=n)return a();const g=e>h?1:-1,p=Wh(r,h+n*g);i=p.cancel,p.wait.then(y=>{const w=Math.abs(e-y);if(dv(w)<=dv(n))return a();const _=Wh(r,e+n);return i=_.cancel,_.wait.then(()=>{a()}).catch(S=>{c(S)})}).catch(y=>{c(y)})}),i=u.cancel}),cancel:()=>{i()}}},B5=({onError:r,volume:e,allowAmplificationDuringRender:t,playbackRate:n,onDuration:i,toneFrequency:s,name:a,acceptableTimeShiftInSeconds:c,delayRenderRetries:u,delayRenderTimeoutInMilliseconds:h,loopVolumeCurveBehavior:d,...g},p)=>{const y=Ei(),w=ei(),_=Ao(d??"repeat"),S=rc(),T=v.useRef(null),k=v.useContext(Wt),I=Es(),M=Ct(),{registerRenderAsset:L,unregisterRenderAsset:N}=v.useContext(Ii),H=v.useMemo(()=>`video-${Ai(g.src??"")}-${k?.cumulatedFrom}-${k?.relativeFrom}-${k?.durationInFrames}`,[g.src,k?.cumulatedFrom,k?.relativeFrom,k?.durationInFrames]);if(!S)throw new Error("No video config found");const R=ks({volume:e,frame:_,mediaVolume:1,allowAmplificationDuringRender:t??!1});v.useEffect(()=>{if(!g.src)throw new Error("No src passed");if(!g.muted&&!(R<=0)&&window.remotion_audioEnabled)return L({type:"video",src:En(g.src),id:H,frame:y,volume:R,mediaFrame:w,playbackRate:n??1,allowAmplificationDuringRender:t??!1,toneFrequency:s??null,audioStartFrame:Math.max(0,-(k?.relativeFrom??0))}),()=>N(H)},[g.muted,g.src,L,H,N,R,w,y,n,t,s,k?.relativeFrom]),v.useImperativeHandle(p,()=>T.current,[]),v.useEffect(()=>{if(!window.remotion_videoEnabled)return;const{current:U}=T;if(!U)return;const K=U0({frame:w,playbackRate:n||1,startFrom:-I,fps:S.fps}),$=ti(`Rendering <Video /> with src="${g.src}" at time ${K}`,{retries:u??void 0,timeoutInMilliseconds:h??void 0});if(window.process?.env?.NODE_ENV==="test"){gt($);return}if(Fh(U.currentTime,K)){if(U.readyState>=2){gt($);return}const Q=()=>{gt($)};return U.addEventListener("loadeddata",Q,{once:!0}),()=>{U.removeEventListener("loadeddata",Q)}}const G=()=>{gt($)},re=V5(U,K,S.fps);re.prom.then(()=>{gt($)}),U.addEventListener("ended",G,{once:!0});const fe=()=>{if(U?.error){if(console.error("Error occurred in video",U?.error),r)return;throw new Error(`The browser threw an error while playing the video ${g.src}: Code ${U.error.code} - ${U?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else throw new Error("The browser threw an error")};return U.addEventListener("error",fe,{once:!0}),()=>{re.cancel(),U.removeEventListener("ended",G),U.removeEventListener("error",fe),gt($)}},[_,g.src,n,S.fps,w,I,r,u,h]);const{src:X}=g;return M.isRendering&&v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test")return;const U=ti("Loading <Video> duration with src="+X,{retries:u??void 0,timeoutInMilliseconds:h??void 0}),{current:K}=T,$=()=>{K?.duration&&i(X,K.duration),gt(U)};return K?.duration?(i(X,K.duration),gt(U)):K?.addEventListener("loadedmetadata",$,{once:!0}),()=>{K?.removeEventListener("loadedmetadata",$),gt(U)}},[X,i,u,h]),b.jsx("video",{ref:T,disableRemotePlayback:!0,...g})},z5=v.forwardRef(B5),H5=(r,e)=>{const{startFrom:t,endAt:n,name:i,pauseWhenBuffering:s,stack:a,_remotionInternalNativeLoopPassed:c,showInTimeline:u,onAutoPlayError:h,...d}=r,{loop:g,_remotionDebugSeeking:p,...y}=r,{fps:w}=Qn(),_=Ct(),{durations:S,setDurations:T}=v.useContext(Mh);if(typeof e=="string")throw new Error("string refs are not supported");if(typeof r.src!="string")throw new TypeError(`The \`<Video>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const k=Ts(r.src),I=v.useCallback((N,H)=>{T({type:"got-duration",durationInSeconds:H,src:N})},[T]),M=v.useCallback(()=>{},[]),L=S[En(k)]??S[En(r.src)];if(g&&L!==void 0){if(!Number.isFinite(L))return b.jsx(uc,{...y,ref:e,_remotionInternalNativeLoopPassed:!0});const N=L*w;return b.jsx(nc,{durationInFrames:P0({endAt:n,mediaDuration:N,playbackRate:r.playbackRate??1,startFrom:t}),layout:"none",name:i,children:b.jsx(uc,{...y,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof t<"u"||typeof n<"u"){Ah(t,n);const N=t??0,H=n??1/0;return b.jsx(dn,{layout:"none",from:0-N,showInTimeline:!1,durationInFrames:H,name:i,children:b.jsx(uc,{pauseWhenBuffering:s??!1,...d,ref:e})})}return Ih(r,"Video"),_.isRendering?b.jsx(z5,{onDuration:I,onVideoFrame:M??null,...d,ref:e}):b.jsx(uv,{onlyWarnForMediaSeekingError:!1,...d,ref:e,onVideoFrame:null,pauseWhenBuffering:s??!1,onDuration:I,_remotionInternalStack:a??null,_remotionInternalNativeLoopPassed:c??!1,_remotionDebugSeeking:p??!1,showInTimeline:u??!0,onAutoPlayError:h??void 0})},uc=v.forwardRef(H5);To(uc),nk();var W5={},U5=new Proxy(W5,{get(r,e){return e==="Bundling"||e==="Rendering"||e==="Log"||e==="Puppeteer"||e==="Output"?U5:()=>{console.warn("  The CLI configuration has been extracted from Remotion Core."),console.warn("Update the import from the config file:"),console.warn(),console.warn("- Delete:"),console.warn('import {Config} from "remotion";'),console.warn("+ Replace:"),console.warn('import {Config} from "@remotion/cli/config";'),console.warn(),console.warn("For more information, see https://www.remotion.dev/docs/4-0-migration."),process.exit(1)}}});To(dn),typeof window<"u"&&(window.remotion_renderReady=!1),typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var $5=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}};function Y5(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function X5(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function G5(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`);if(t&&r>50)throw new TypeError("The FPS for a GIF cannot be higher than 50. Use the --every-nth-frame option to lower the FPS: https://remotion.dev/docs/render-as-gif")}var hc={validateFps:G5,validateDimension:Y5,validateDurationInFrames:X5,validateDefaultAndInputProps:$5},Rt=25,Uh=16,q5=()=>b.jsx("svg",{width:Rt,height:Rt,viewBox:"0 0 25 25",fill:"none",children:b.jsx("path",{d:"M8 6.375C7.40904 8.17576 7.06921 10.2486 7.01438 12.3871C6.95955 14.5255 7.19163 16.6547 7.6875 18.5625C9.95364 18.2995 12.116 17.6164 14.009 16.5655C15.902 15.5147 17.4755 14.124 18.6088 12.5C17.5158 10.8949 15.9949 9.51103 14.1585 8.45082C12.3222 7.3906 10.2174 6.68116 8 6.375Z",fill:"white",stroke:"white",strokeWidth:"6.25",strokeLinejoin:"round"})}),K5=()=>b.jsxs("svg",{viewBox:"0 0 100 100",width:Rt,height:Rt,children:[b.jsx("rect",{x:"25",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"}),b.jsx("rect",{x:"55",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"})]}),Z5=({isFullscreen:r})=>{const n=r?0:3,i=r?6*1.6:6/2,s=r?6*1.6:6*2;return b.jsxs("svg",{viewBox:"0 0 32 32",height:Uh,width:Uh,children:[b.jsx("path",{d:`
				M ${n} ${s}
				L ${i} ${i}
				L ${s} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),b.jsx("path",{d:`
				M ${32-n} ${s}
				L ${32-i} ${i}
				L ${32-s} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),b.jsx("path",{d:`
				M ${n} ${32-s}
				L ${i} ${32-i}
				L ${s} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),b.jsx("path",{d:`
				M ${32-n} ${32-s}
				L ${32-i} ${32-i}
				L ${32-s} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"})]})},J5=()=>b.jsx("svg",{width:Rt,height:Rt,viewBox:"0 0 24 24",children:b.jsx("path",{d:"M3.63 3.63a.996.996 0 000 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z",fill:"#fff"})}),Q5=()=>b.jsx("svg",{width:Rt,height:Rt,viewBox:"0 0 24 24",children:b.jsx("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z",fill:"#fff"})}),fv="__remotion_buffering_indicator",gv="__remotion_buffering_animation",eI={width:Rt,height:Rt,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},tI={width:14,height:14,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},rI=({type:r})=>{const e=r==="player"?eI:tI;return b.jsxs(b.Fragment,{children:[b.jsx("style",{type:"text/css",children:`
				@keyframes ${gv} {
          0% {
            rotate: 0deg;
          }
          100% {
            rotate: 360deg;
          }
        }
        
        .${fv} {
            animation: ${gv} 1s linear infinite;
        }        
			`}),b.jsx("div",{style:e,children:b.jsx("svg",{viewBox:r==="player"?"0 0 22 22":"0 0 18 18",style:e,className:fv,children:b.jsx("path",{d:r==="player"?"M 11 4 A 7 7 0 0 1 15.1145 16.66312":"M 9 2 A 7 7 0 0 1 13.1145 14.66312",stroke:"white",strokeLinecap:"round",fill:"none",strokeWidth:3})})})]})},nI=({currentSize:r,width:e,height:t,compositionWidth:n,compositionHeight:i})=>e!==void 0&&t===void 0?{aspectRatio:[n,i].join("/")}:t!==void 0&&e===void 0?{aspectRatio:[n,i].join("/")}:r?{width:n,height:i}:{width:n,height:i},pv=({previewSize:r,compositionWidth:e,compositionHeight:t,canvasSize:n})=>{const i=xe.calculateScale({canvasSize:n,compositionHeight:t,compositionWidth:e,previewSize:r}),s=0-(1-i)/2,a=s*e,c=s*t,u=e*i,h=t*i,d=n.width/2-u/2,g=n.height/2-h/2;return{centerX:d,centerY:g,xCorrection:a,yCorrection:c,scale:i}},mv=({config:r,style:e,canvasSize:t,overflowVisible:n,layout:i})=>r?{position:"relative",overflow:n?"visible":"hidden",...nI({compositionHeight:r.height,compositionWidth:r.width,currentSize:t,height:e?.height,width:e?.width}),opacity:i?1:0,...e}:{},vv=({config:r,canvasSize:e,layout:t,scale:n,overflowVisible:i})=>!r||!e||!t?{}:{position:"absolute",width:r.width,height:r.height,display:"flex",transform:`scale(${n})`,marginLeft:t.xCorrection,marginTop:t.yCorrection,overflow:i?"visible":"hidden"},yv=({layout:r,scale:e,config:t,overflowVisible:n})=>{if(!r||!t)return{};const{centerX:i,centerY:s}=r;return{width:t.width*e,height:t.height*e,display:"flex",flexDirection:"column",position:"absolute",left:i,top:s,overflow:n?"visible":"hidden"}},bv=v.createContext(void 0),wv=v.createContext(void 0);class iI{listeners={ended:[],error:[],pause:[],play:[],ratechange:[],scalechange:[],seeked:[],timeupdate:[],frameupdate:[],fullscreenchange:[],volumechange:[],mutechange:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchSeek(e){this.dispatchEvent("seeked",{frame:e})}dispatchVolumeChange(e){this.dispatchEvent("volumechange",{volume:e})}dispatchPause(){this.dispatchEvent("pause",void 0)}dispatchPlay(){this.dispatchEvent("play",void 0)}dispatchEnded(){this.dispatchEvent("ended",void 0)}dispatchRateChange(e){this.dispatchEvent("ratechange",{playbackRate:e})}dispatchScaleChange(e){this.dispatchEvent("scalechange",{scale:e})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchTimeUpdate(e){this.dispatchEvent("timeupdate",e)}dispatchFrameUpdate(e){this.dispatchEvent("frameupdate",e)}dispatchFullscreenChange(e){this.dispatchEvent("fullscreenchange",e)}dispatchMuteChange(e){this.dispatchEvent("mutechange",e)}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}class sI{listeners={error:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}var xv=r=>{const e=v.useContext(xe.BufferingContextReact);if(!e)throw new Error("BufferingContextReact not found");v.useEffect(()=>{const t=e.listenForBuffering(()=>{e.buffering.current=!0,r.dispatchWaiting({})}),n=e.listenForResume(()=>{e.buffering.current=!1,r.dispatchResume({})});return()=>{t.remove(),n.remove()}},[e,r])},oI=({children:r,currentPlaybackRate:e})=>{const[t]=v.useState(()=>new iI);if(!v.useContext(xe.BufferingContextReact))throw new Error("BufferingContextReact not found");return v.useEffect(()=>{e&&t.dispatchRateChange(e)},[t,e]),xv(t),b.jsx(bv.Provider,{value:t,children:r})},$h=(r,e)=>{const[t,n]=v.useState(!1);return v.useEffect(()=>{const{current:i}=r;if(!i)return;let s;const a=()=>{e&&(clearTimeout(s),s=setTimeout(()=>{n(!1)},e===!0?3e3:e))},c=()=>{n(!0),a()},u=()=>{n(!1),clearTimeout(s)},h=()=>{n(!0),a()};return i.addEventListener("mouseenter",c),i.addEventListener("mouseleave",u),i.addEventListener("mousemove",h),()=>{i.removeEventListener("mouseenter",c),i.removeEventListener("mouseleave",u),i.removeEventListener("mousemove",h),clearTimeout(s)}},[e,r]),t},dc=()=>{const[r,e,t]=xe.Timeline.usePlayingState(),[n,i]=v.useState(!1),s=xe.Timeline.useTimelinePosition(),a=v.useRef(s),c=xe.Timeline.useTimelineSetFrame(),u=xe.Timeline.useTimelineSetFrame(),h=v.useContext(xe.SharedAudioContext),{audioAndVideoTags:d}=v.useContext(xe.Timeline.TimelineContext),g=v.useRef(s);g.current=s;const p=xe.useVideo(),y=xe.useUnsafeVideoConfig(),w=v.useContext(bv),_=(y?.durationInFrames??1)-1,S=s===_,T=s===0;if(!w)throw new TypeError("Expected Player event emitter context");const k=v.useContext(xe.BufferingContextReact);if(!k)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");const{buffering:I}=k,M=v.useCallback($=>{p?.id&&u(G=>({...G,[p.id]:$})),g.current=$,w.dispatchSeek($)},[w,u,p?.id]),L=v.useCallback($=>{t.current||(i(!0),S&&M(0),h&&h.numberOfAudioTags>0&&$&&h.playAllAudios(),d.current.forEach(G=>G.play()),t.current=!0,e(!0),a.current=g.current,w.dispatchPlay())},[t,S,h,e,w,M,d]),N=v.useCallback(()=>{t.current&&(t.current=!1,e(!1),w.dispatchPause())},[w,t,e]),H=v.useCallback(()=>{t.current&&(t.current=!1,g.current=a.current,y&&(u($=>({...$,[y.id]:a.current})),e(!1),w.dispatchPause()))},[y,w,t,e,u]),R=p?.id,X=v.useCallback($=>{if(!R)return null;t.current||c(G=>{const re=G[R]??window.remotion_initialFrame??0;return{...G,[R]:Math.max(0,re-$)}})},[t,c,R]),U=v.useCallback($=>{if(!R)return null;t.current||c(G=>{const re=G[R]??window.remotion_initialFrame??0;return{...G,[R]:Math.min(_,re+$)}})},[R,t,_,c]);return v.useMemo(()=>({frameBack:X,frameForward:U,isLastFrame:S,emitter:w,playing:r,play:L,pause:N,seek:M,isFirstFrame:T,getCurrentFrame:()=>g.current,isPlaying:()=>t.current,isBuffering:()=>I.current,pauseAndReturnToPlayStart:H,hasPlayed:n,remotionInternal_currentFrameRef:g}),[X,U,S,w,r,L,N,M,T,H,n,t,I])},aI=({browserMediaControlsBehavior:r,videoConfig:e,playbackRate:t})=>{const{playing:n,pause:i,play:s,emitter:a,getCurrentFrame:c,seek:u}=dc();v.useEffect(()=>{navigator.mediaSession&&r.mode!=="do-nothing"&&(n?navigator.mediaSession.playbackState="playing":navigator.mediaSession.playbackState="paused")},[r.mode,n]),v.useEffect(()=>{if(!navigator.mediaSession||r.mode==="do-nothing")return;const h=()=>{e&&navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:e.durationInFrames/e.fps,playbackRate:t,position:c()/e.fps})};return a.addEventListener("timeupdate",h),()=>{a.removeEventListener("timeupdate",h)}},[r.mode,a,c,t,e]),v.useEffect(()=>{if(navigator.mediaSession&&r.mode!=="do-nothing")return navigator.mediaSession.setActionHandler("play",()=>{r.mode==="register-media-session"&&s()}),navigator.mediaSession.setActionHandler("pause",()=>{r.mode==="register-media-session"&&i()}),navigator.mediaSession.setActionHandler("seekto",h=>{r.mode==="register-media-session"&&h.seekTime!==void 0&&e&&u(Math.round(h.seekTime*e.fps))}),navigator.mediaSession.setActionHandler("seekbackward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(0,Math.round((c()-10)*e.fps)))}),navigator.mediaSession.setActionHandler("seekforward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(e.durationInFrames-1,Math.round((c()+10)*e.fps)))}),navigator.mediaSession.setActionHandler("previoustrack",()=>{r.mode==="register-media-session"&&u(0)}),()=>{navigator.mediaSession.metadata=null,navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("seekto",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null)}},[r.mode,c,i,s,u,e])},cI=({time:r,currentFrame:e,playbackSpeed:t,fps:n,actualLastFrame:i,actualFirstFrame:s,framesAdvanced:a,shouldLoop:c})=>{const h=(t<0?Math.ceil:Math.floor)(r*t/(1e3/n))-a,d=h+e,g=e>i||e<s,p=d>i||d<s,y=!c&&p&&!g;return t>0?p?{nextFrame:s,framesToAdvance:h,hasEnded:y}:{nextFrame:d,framesToAdvance:h,hasEnded:y}:p?{nextFrame:i,framesToAdvance:h,hasEnded:y}:{nextFrame:d,framesToAdvance:h,hasEnded:y}},_v=()=>typeof document>"u"?!1:document.visibilityState==="hidden",lI=()=>{const r=v.useRef(_v());return v.useEffect(()=>{const e=()=>{r.current=_v()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),r},uI=({loop:r,playbackRate:e,moveToBeginningWhenEnded:t,inFrame:n,outFrame:i,frameRef:s,browserMediaControlsBehavior:a})=>{const c=xe.useUnsafeVideoConfig(),u=xe.Timeline.useTimelinePosition(),{playing:h,pause:d,emitter:g}=dc(),p=xe.Timeline.useTimelineSetFrame(),y=v.useRef(null),w=lI(),_=v.useRef(null),S=v.useContext(xe.BufferingContextReact);if(!S)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");aI({browserMediaControlsBehavior:a,playbackRate:e,videoConfig:c}),v.useEffect(()=>{const T=S.listenForBuffering(()=>{y.current=performance.now()}),k=S.listenForResume(()=>{y.current=null});return()=>{T.remove(),k.remove()}},[S]),v.useEffect(()=>{if(!c||!h)return;let T=!1,k=null,I=performance.now(),M=0;const L=()=>{k!==null&&(k.type==="raf"?cancelAnimationFrame(k.id):clearTimeout(k.id))},N=()=>{T=!0,L()},H=()=>{const U=performance.now()-I,K=i??c.durationInFrames-1,$=n??0,G=s.current,{nextFrame:re,framesToAdvance:fe,hasEnded:Q}=cI({time:U,currentFrame:G,playbackSpeed:e,fps:c.fps,actualFirstFrame:$,actualLastFrame:K,framesAdvanced:M,shouldLoop:r});if(M+=fe,re!==s.current&&(!Q||t)&&p(ue=>({...ue,[c.id]:re})),Q){N(),d(),g.dispatchEnded();return}T||R()},R=()=>{if(y.current){const U=S.listenForResume(()=>{U.remove(),!T&&(I=performance.now(),M=0,H())});return}w.current?k={type:"timeout",id:setTimeout(H,1e3/c.fps)}:k={type:"raf",id:requestAnimationFrame(H)}};R();const X=()=>{document.visibilityState!=="visible"&&(L(),H())};return window.addEventListener("visibilitychange",X),()=>{window.removeEventListener("visibilitychange",X),N()}},[c,r,d,h,p,g,e,n,i,t,w,s,y,S]),v.useEffect(()=>{const T=setInterval(()=>{_.current!==s.current&&(g.dispatchTimeUpdate({frame:s.current}),_.current=s.current)},250);return()=>clearInterval(T)},[g,s]),v.useEffect(()=>{g.dispatchFrameUpdate({frame:u})},[g,u])},Yh=[],Xh=(r,e)=>{const[t,n]=v.useState(()=>{if(!r.current)return null;const a=r.current.getClientRects();return a[0]?{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}}:null}),i=v.useMemo(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(a=>{const{contentRect:c,target:u}=a[0],h=u.getClientRects();if(!h?.[0]){n(null);return}const d=c.width===0?1:h[0].width/c.width,g=e.shouldApplyCssTransforms?h[0].width:h[0].width*(1/d),p=e.shouldApplyCssTransforms?h[0].height:h[0].height*(1/d);n({width:g,height:p,left:h[0].x,top:h[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})}),[e.shouldApplyCssTransforms]),s=v.useCallback(()=>{if(!r.current)return;const a=r.current.getClientRects();if(!a[0]){n(null);return}n(c=>c&&c.width===a[0].width&&c.height===a[0].height&&c.left===a[0].x&&c.top===a[0].y&&c.windowSize.height===window.innerHeight&&c.windowSize.width===window.innerWidth?c:{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})},[r]);return v.useEffect(()=>{if(!i)return;const{current:a}=r;return a&&i.observe(a),()=>{a&&i.unobserve(a)}},[i,r,s]),v.useEffect(()=>{if(e.triggerOnWindowResize)return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[e.triggerOnWindowResize,s]),v.useEffect(()=>(Yh.push(s),()=>{Yh=Yh.filter(a=>a!==s)}),[s]),v.useMemo(()=>t?{...t,refresh:s}:null,[t,s])},Sv=({playing:r,buffering:e})=>r&&e?b.jsx(rI,{type:"player"}):r?b.jsx(K5,{}):b.jsx(q5,{}),As=12,Cv=5,hI=({volume:r,isVertical:e,onBlur:t,inputRef:n,setVolume:i})=>{const s=v.useMemo(()=>{const p={paddingLeft:5,height:Rt,width:Mi,display:"inline-flex",alignItems:"center"};return e?{...p,position:"absolute",transform:`rotate(-90deg) translateX(${Mi/2+Rt/2}px)`}:{...p}},[e]),a=typeof v.useId>"u"?"volume-slider":v.useId(),[c]=v.useState(()=>`__remotion-volume-slider-${Ai(a)}`.replace(".","")),u=v.useCallback(g=>{i(parseFloat(g.target.value))},[i]),h=v.useMemo(()=>{const g={WebkitAppearance:"none",backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:Cv/2,cursor:"pointer",height:Cv,width:Mi,backgroundImage:`linear-gradient(
				to right,
				white ${r*100}%, rgba(255, 255, 255, 0) ${r*100}%
			)`};return e?{...g,bottom:Rt+Mi/2}:g},[e,r]),d=`
	.${c}::-webkit-slider-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${As/2}px;
		box-shadow: 0 0 2px black;
		height: ${As}px;
		width: ${As}px;
	}

	.${c}::-moz-range-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${As/2}px;
		box-shadow: 0 0 2px black;
		height: ${As}px;
		width: ${As}px;
	}
`;return b.jsxs("div",{style:s,children:[b.jsx("style",{dangerouslySetInnerHTML:{__html:d}}),b.jsx("input",{ref:n,"aria-label":"Change volume",className:c,max:1,min:0,onBlur:t,onChange:u,step:.01,type:"range",value:r,style:h})]})},dI=r=>b.jsx(hI,{...r}),Mi=100,fI=({displayVerticalVolumeSlider:r,renderMuteButton:e,renderVolumeSlider:t})=>{const[n,i]=xe.useMediaMutedState(),[s,a]=xe.useMediaVolumeState(),[c,u]=v.useState(!1),h=v.useRef(null),d=v.useRef(null),g=$h(h,!1),p=v.useCallback(()=>{setTimeout(()=>{d.current&&document.activeElement!==d.current&&u(!1)},10)},[]),y=s===0,w=v.useCallback(()=>{if(y){a(1),i(!1);return}i(M=>!M)},[y,i,a]),_=v.useMemo(()=>({display:"inline-flex",background:"none",border:"none",justifyContent:"center",alignItems:"center",touchAction:"none",...r&&{position:"relative"}}),[r]),S=v.useMemo(()=>({display:"inline",width:Rt,height:Rt,cursor:"pointer",appearance:"none",background:"none",border:"none",padding:0}),[]),T=v.useCallback(({muted:M,volume:L})=>{const N=M||L===0;return b.jsx("button",{"aria-label":N?"Unmute sound":"Mute sound",title:N?"Unmute sound":"Mute sound",onClick:w,onBlur:p,onFocus:()=>u(!0),style:S,type:"button",children:N?b.jsx(J5,{}):b.jsx(Q5,{})})},[p,w,S]),k=v.useMemo(()=>e?e({muted:n,volume:s}):T({muted:n,volume:s}),[n,s,T,e]),I=v.useMemo(()=>(c||g)&&!n&&!xe.isIosSafari()?(t??dI)({isVertical:r,volume:s,onBlur:()=>u(!1),inputRef:d,setVolume:a}):null,[r,c,g,n,s,t,a]);return b.jsxs("div",{ref:h,style:_,children:[k,I]})};function gI(r){const[e,t]=v.useState(r),n=v.useRef(null);return v.useEffect(()=>{const i=s=>{n.current&&!n.current.contains(s.target)&&t(!1)};return document.addEventListener("pointerup",i,!0),()=>{document.removeEventListener("pointerup",i,!0)}},[]),{ref:n,isComponentVisible:e,setIsComponentVisible:t}}var pI=35,mI=70,vI={height:30,paddingRight:15,paddingLeft:12,display:"flex",flexDirection:"row",alignItems:"center"},yI={width:22,display:"flex",alignItems:"center"},bI={width:14,height:14,color:"black"},wI=()=>b.jsx("svg",{viewBox:"0 0 512 512",style:bI,children:b.jsx("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})}),xI=({rate:r,onSelect:e,selectedRate:t,keyboardSelectedRate:n})=>{const i=v.useCallback(g=>{g.stopPropagation(),g.preventDefault(),e(r)},[e,r]),[s,a]=v.useState(!1),c=v.useCallback(()=>{a(!0)},[]),u=v.useCallback(()=>{a(!1)},[]),h=n===r,d=v.useMemo(()=>({...vI,backgroundColor:s||h?"#eee":"transparent"}),[s,h]);return b.jsxs("div",{onMouseEnter:c,onMouseLeave:u,tabIndex:0,style:d,onClick:i,children:[b.jsx("div",{style:yI,children:r===t?b.jsx(wI,{}):null}),r.toFixed(1),"x"]},r)},_I=({setIsComponentVisible:r,playbackRates:e,canvasSize:t})=>{const{setPlaybackRate:n,playbackRate:i}=v.useContext(xe.Timeline.TimelineContext),[s,a]=v.useState(i);v.useEffect(()=>{const h=d=>{if(d.preventDefault(),d.key==="ArrowUp"){const g=e.findIndex(p=>p===s);if(g===0)return;a(g===-1?e[0]:e[g-1])}else if(d.key==="ArrowDown"){const g=e.findIndex(p=>p===s);if(g===e.length-1)return;a(g===-1?e[e.length-1]:e[g+1])}else d.key==="Enter"&&(n(s),r(!1))};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[e,s,n,r]);const c=v.useCallback(h=>{n(h),r(!1)},[r,n]),u=v.useMemo(()=>({position:"absolute",right:0,width:125,maxHeight:t.height-mI-pI,bottom:35,background:"#fff",borderRadius:4,overflow:"auto",color:"black",textAlign:"left"}),[t.height]);return b.jsx("div",{style:u,children:e.map(h=>b.jsx(xI,{selectedRate:i,onSelect:c,rate:h,keyboardSelectedRate:s},h))})},SI={fontSize:13,fontWeight:"bold",color:"white",border:"2px solid white",borderRadius:20,paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2},Gh={appearance:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",paddingLeft:0,paddingRight:0,paddingTop:6,paddingBottom:6,height:37,display:"inline-flex",marginBottom:0,marginTop:0,alignItems:"center"},CI={...Gh,position:"relative"},TI=({playbackRates:r,canvasSize:e})=>{const{ref:t,isComponentVisible:n,setIsComponentVisible:i}=gI(!1),{playbackRate:s}=v.useContext(xe.Timeline.TimelineContext),a=v.useCallback(c=>{c.stopPropagation(),c.preventDefault(),i(u=>!u)},[i]);return b.jsx("div",{ref:t,children:b.jsxs("button",{type:"button","aria-label":"Change playback rate",style:CI,onClick:a,children:[b.jsxs("div",{style:SI,children:[s,"x"]}),n&&b.jsx(_I,{canvasSize:e,playbackRates:r,setIsComponentVisible:i})]})})},Tv=(r,e,t)=>Math.round(H0(r,[0,t],[0,e-1],{extrapolateLeft:"clamp",extrapolateRight:"clamp"})),Ms=5,Oo=12,qh=4,EI={userSelect:"none",WebkitUserSelect:"none",paddingTop:qh,paddingBottom:qh,boxSizing:"border-box",cursor:"pointer",position:"relative",touchAction:"none"},kI={height:Ms,backgroundColor:"rgba(255, 255, 255, 0.25)",width:"100%",borderRadius:Ms/2},II=r=>{let e=r;for(;e.parentElement;)e=e.parentElement;return e},AI=({durationInFrames:r,onSeekEnd:e,onSeekStart:t,inFrame:n,outFrame:i})=>{const s=v.useRef(null),a=$h(s,!1),c=Xh(s,{triggerOnWindowResize:!0,shouldApplyCssTransforms:!0}),{seek:u,play:h,pause:d,playing:g}=dc(),p=xe.Timeline.useTimelinePosition(),[y,w]=v.useState({dragging:!1}),_=c?.width??0,S=v.useCallback(N=>{if(N.button!==0)return;const H=s.current?.getBoundingClientRect().left,R=Tv(N.clientX-H,r,_);d(),u(R),w({dragging:!0,wasPlaying:g}),t()},[r,_,d,u,g,t]),T=v.useCallback(N=>{if(!c)throw new Error("Player has no size");if(!y.dragging)return;const H=s.current?.getBoundingClientRect().left,R=Tv(N.clientX-H,r,c.width);u(R)},[y.dragging,r,u,c]),k=v.useCallback(()=>{w({dragging:!1}),y.dragging&&(y.wasPlaying?h():d(),e())},[y,e,d,h]);v.useEffect(()=>{if(!y.dragging)return;const N=II(s.current);return N.addEventListener("pointermove",T),N.addEventListener("pointerup",k),()=>{N.removeEventListener("pointermove",T),N.removeEventListener("pointerup",k)}},[y.dragging,T,k]);const I=v.useMemo(()=>({height:Oo,width:Oo,borderRadius:Oo/2,position:"absolute",top:qh-Oo/2+5/2,backgroundColor:"white",left:Math.max(0,p/Math.max(1,r-1)*_-Oo/2),boxShadow:"0 0 2px black",opacity:Number(a)}),[a,r,p,_]),M=v.useMemo(()=>({height:Ms,backgroundColor:"rgba(255, 255, 255, 1)",width:(p-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:Ms/2}),[r,p,n]),L=v.useMemo(()=>({height:Ms,backgroundColor:"rgba(255, 255, 255, 0.25)",width:((i??r-1)-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:Ms/2,position:"absolute"}),[r,n,i]);return b.jsxs("div",{ref:s,onPointerDown:S,style:EI,children:[b.jsxs("div",{style:kI,children:[b.jsx("div",{style:L}),b.jsx("div",{style:M})]}),b.jsx("div",{style:I})]})},Ev=r=>{const e=Math.floor(r/60),t=Math.floor(r-e*60);return`${String(e)}:${String(t).padStart(2,"0")}`},MI=10,Kh=12,OI=({allowFullscreen:r,playerWidth:e})=>v.useMemo(()=>{const n=Rt,i=Rt,s=r?Uh:0,a=i+n+s+Kh*2+MI*2,c=e-a,u=Math.max(c,0),h=u-Mi,g=(h<Mi?u:h)+a+Mi,p=e<g;return{maxTimeLabelWidth:u===0?null:u,displayVerticalVolumeSlider:p}},[r,e]),PI=[0,.013,.049,.104,.175,.259,.352,.45,.55,.648,.741,.825,.896,.951,.987],DI=[0,8.1,15.5,22.5,29,35.3,41.2,47.1,52.9,58.8,64.7,71,77.5,84.5,91.9],jI=1/.7,LI={boxSizing:"border-box",position:"absolute",bottom:0,width:"100%",paddingTop:40,paddingBottom:10,backgroundImage:`linear-gradient(to bottom,${PI.map((r,e)=>`hsla(0, 0%, 0%, ${r}) ${DI[e]*jI}%`).join(", ")}, hsl(0, 0%, 0%) 100%)`,backgroundSize:"auto 145px",display:"flex",paddingRight:Kh,paddingLeft:Kh,flexDirection:"column",transition:"opacity 0.3s"},FI={display:"flex",flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none"},NI={display:"flex",flexDirection:"row",userSelect:"none",WebkitUserSelect:"none",alignItems:"center"},fc={width:12},RI={height:8},VI={flex:1},BI={},zI=({durationInFrames:r,isFullscreen:e,fps:t,player:n,showVolumeControls:i,onFullscreenButtonClick:s,allowFullscreen:a,onExitFullscreenButtonClick:c,spaceKeyToPlayOrPause:u,onSeekEnd:h,onSeekStart:d,inFrame:g,outFrame:p,initiallyShowControls:y,canvasSize:w,renderPlayPauseButton:_,renderFullscreenButton:S,alwaysShowControls:T,showPlaybackRateControl:k,containerRef:I,buffering:M,hideControlsWhenPointerDoesntMove:L,onPointerDown:N,onDoubleClick:H,renderMuteButton:R,renderVolumeSlider:X})=>{const U=v.useRef(null),K=xe.Timeline.useTimelinePosition(),[$,G]=v.useState(!1),re=$h(I,L),{maxTimeLabelWidth:fe,displayVerticalVolumeSlider:Q}=OI({allowFullscreen:a,playerWidth:w?.width??0}),[ue,oe]=v.useState(()=>{if(typeof y=="boolean")return y;if(typeof y=="number"){if(y%1!==0)throw new Error("initiallyShowControls must be an integer or a boolean");if(Number.isNaN(y))throw new Error("initiallyShowControls must not be NaN");if(!Number.isFinite(y))throw new Error("initiallyShowControls must be finite");if(y<=0)throw new Error("initiallyShowControls must be a positive integer");return y}throw new TypeError("initiallyShowControls must be a number or a boolean")}),se=v.useMemo(()=>{const ke=re||!n.playing||ue||T;return{...LI,opacity:Number(ke)}},[re,ue,n.playing,T]);v.useEffect(()=>{U.current&&u&&U.current.focus({preventScroll:!0})},[n.playing,u]),v.useEffect(()=>{G((typeof document<"u"&&(document.fullscreenEnabled||document.webkitFullscreenEnabled))??!1)},[]),v.useEffect(()=>{if(ue===!1)return;const ht=setTimeout(()=>{oe(!1)},ue===!0?2e3:ue);return()=>{clearInterval(ht)}},[ue]);const de=v.useMemo(()=>({color:"white",fontFamily:"sans-serif",fontSize:14,maxWidth:fe===null?void 0:fe,overflow:"hidden",textOverflow:"ellipsis"}),[fe]),ne=v.useMemo(()=>{if(k===!0)return[.5,.8,1,1.2,1.5,1.8,2,2.5,3];if(Array.isArray(k)){for(const ke of k){if(typeof ke!="number")throw new Error("Every item in showPlaybackRateControl must be a number");if(ke<=0)throw new Error("Every item in showPlaybackRateControl must be positive")}return k}return null},[k]),Fe=v.useRef(null),Ge=v.useRef(null),Re=v.useCallback(ke=>{(ke.target===Fe.current||ke.target===Ge.current)&&N?.(ke)},[N]),_e=v.useCallback(ke=>{(ke.target===Fe.current||ke.target===Ge.current)&&H?.(ke)},[H]);return b.jsxs("div",{ref:Fe,style:se,onPointerDown:Re,onDoubleClick:_e,children:[b.jsxs("div",{ref:Ge,style:FI,children:[b.jsxs("div",{style:NI,children:[b.jsx("button",{ref:U,type:"button",style:Gh,onClick:n.playing?n.pause:n.play,"aria-label":n.playing?"Pause video":"Play video",title:n.playing?"Pause video":"Play video",children:_===null?b.jsx(Sv,{buffering:M,playing:n.playing}):_({playing:n.playing,isBuffering:M})??b.jsx(Sv,{buffering:M,playing:n.playing})}),i?b.jsxs(b.Fragment,{children:[b.jsx("div",{style:fc}),b.jsx(fI,{renderMuteButton:R,renderVolumeSlider:X,displayVerticalVolumeSlider:Q})]}):null,b.jsx("div",{style:fc}),b.jsxs("div",{style:de,children:[Ev(K/t)," / ",Ev(r/t)]}),b.jsx("div",{style:fc})]}),b.jsx("div",{style:VI}),ne&&w&&b.jsx(TI,{canvasSize:w,playbackRates:ne}),ne&&$&&a?b.jsx("div",{style:fc}):null,b.jsx("div",{style:BI,children:$&&a?b.jsx("button",{type:"button","aria-label":e?"Exit fullscreen":"Enter Fullscreen",title:e?"Exit fullscreen":"Enter Fullscreen",style:Gh,onClick:e?c:s,children:S===null?b.jsx(Z5,{isFullscreen:e}):S({isFullscreen:e})}):null})]}),b.jsx("div",{style:RI}),b.jsx(AI,{onSeekEnd:h,onSeekStart:d,durationInFrames:r,inFrame:g,outFrame:p})]})},HI={display:"flex",justifyContent:"center",alignItems:"center",flex:1,height:"100%",width:"100%"};class kv extends v.Component{state={hasError:null};static getDerivedStateFromError(e){return{hasError:e}}componentDidCatch(e){this.props.onError(e)}render(){return this.state.hasError?b.jsx("div",{style:HI,children:this.props.errorFallback({error:this.state.hasError})}):this.props.children}}var Zh="__remotion-player",Iv=typeof document>"u",WI=r=>{let e=!1;return{promise:new Promise((n,i)=>{r.then(s=>{if(e){i({isCanceled:e,value:s});return}n(s)}).catch(s=>{i({isCanceled:e,error:s})})}),cancel:()=>{e=!0}}},UI=r=>new Promise(e=>setTimeout(e,r)),$I=()=>{const r=v.useRef([]),e=v.useCallback(s=>{r.current=[...r.current,s]},[]),t=v.useCallback(s=>{r.current=r.current.filter(a=>a!==s)},[]),n=v.useCallback(()=>r.current.map(s=>s.cancel()),[]);return v.useMemo(()=>({appendPendingPromise:e,removePendingPromise:t,clearPendingPromises:n}),[e,n,t])},YI=(r,e,t)=>{const n=$I(),i=v.useCallback(async u=>{if(u instanceof PointerEvent?u.pointerType==="touch":u.nativeEvent.pointerType==="touch"){r(u);return}n.clearPendingPromises();const h=WI(UI(200));n.appendPendingPromise(h);try{await h.promise,n.removePendingPromise(h),r(u)}catch(d){const g=d;if(n.removePendingPromise(h),!g.isCanceled)throw g.error}},[n,r]),s=v.useCallback(()=>{document.addEventListener("pointerup",u=>{i(u)},{once:!0})},[i]),a=v.useCallback(()=>{n.clearPendingPromises(),e()},[n,e]);return v.useMemo(()=>t?{handlePointerDown:s,handleDoubleClick:a}:{handlePointerDown:r,handleDoubleClick:()=>{}},[t,a,s,r])},Jh=v.version.split(".")[0];if(Jh==="0")throw new Error(`Version ${Jh} of "react" is not supported by Remotion`);var XI=parseInt(Jh,10)>=18,GI=({controls:r,style:e,loop:t,autoPlay:n,allowFullscreen:i,inputProps:s,clickToPlay:a,showVolumeControls:c,doubleClickToFullscreen:u,spaceKeyToPlayOrPause:h,errorFallback:d,playbackRate:g,renderLoading:p,renderPoster:y,className:w,moveToBeginningWhenEnded:_,showPosterWhenUnplayed:S,showPosterWhenEnded:T,showPosterWhenPaused:k,showPosterWhenBuffering:I,inFrame:M,outFrame:L,initiallyShowControls:N,renderFullscreen:H,renderPlayPauseButton:R,renderMuteButton:X,renderVolumeSlider:U,alwaysShowControls:K,showPlaybackRateControl:$,posterFillMode:G,bufferStateDelayInMilliseconds:re,hideControlsWhenPointerDoesntMove:fe,overflowVisible:Q,browserMediaControlsBehavior:ue},oe)=>{const se=xe.useUnsafeVideoConfig(),de=xe.useVideo(),ne=v.useRef(null),Fe=Xh(ne,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),[Ge,Re]=v.useState(!1),[_e,ke]=v.useState(n),[ht,ar]=v.useState(()=>!1),[Vt,Ot]=v.useState(!1),cr=v.useMemo(()=>typeof document>"u"?!1:!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),[]),pe=dc();uI({loop:t,playbackRate:g,moveToBeginningWhenEnded:_,inFrame:M,outFrame:L,frameRef:pe.remotionInternal_currentFrameRef,browserMediaControlsBehavior:ue}),v.useEffect(()=>{Ge&&!pe.playing&&(Re(!1),pe.play())},[Ge,pe]),v.useEffect(()=>{const{current:ze}=ne;if(!ze)return;const Be=()=>{const Cr=document.fullscreenElement===ze||document.webkitFullscreenElement===ze;ar(Cr)};return document.addEventListener("fullscreenchange",Be),document.addEventListener("webkitfullscreenchange",Be),()=>{document.removeEventListener("fullscreenchange",Be),document.removeEventListener("webkitfullscreenchange",Be)}},[]);const xr=v.useCallback(ze=>{pe.isPlaying()?pe.pause():pe.play(ze)},[pe]),rt=v.useCallback(()=>{if(!i)throw new Error("allowFullscreen is false");if(!cr)throw new Error("Browser doesnt support fullscreen");if(!ne.current)throw new Error("No player ref found");ne.current.webkitRequestFullScreen?ne.current.webkitRequestFullScreen():ne.current.requestFullscreen()},[i,cr]),Lt=v.useCallback(()=>{document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen()},[]);v.useEffect(()=>{const{current:ze}=ne;if(!ze)return;const Be=()=>{const Cr=document.webkitFullscreenElement??document.fullscreenElement;Cr&&Cr===ne.current?pe.emitter.dispatchFullscreenChange({isFullscreen:!0}):pe.emitter.dispatchFullscreenChange({isFullscreen:!1})};return ze.addEventListener("webkitfullscreenchange",Be),ze.addEventListener("fullscreenchange",Be),()=>{ze.removeEventListener("webkitfullscreenchange",Be),ze.removeEventListener("fullscreenchange",Be)}},[pe.emitter]);const gi=se?.durationInFrames??1,Qe=v.useMemo(()=>!se||!Fe?null:pv({canvasSize:Fe,compositionHeight:se.height,compositionWidth:se.width,previewSize:"auto"}),[Fe,se]),Pt=Qe?.scale??1,Vn=v.useRef(!1);v.useEffect(()=>{if(!Vn.current){Vn.current=!0;return}pe.emitter.dispatchScaleChange(Pt)},[pe.emitter,Pt]);const{setMediaVolume:_r,setMediaMuted:P}=v.useContext(xe.SetMediaVolumeContext),{mediaMuted:le,mediaVolume:ce}=v.useContext(xe.MediaVolumeContext);v.useEffect(()=>{pe.emitter.dispatchVolumeChange(ce)},[pe.emitter,ce]);const Oe=le||ce===0;v.useEffect(()=>{pe.emitter.dispatchMuteChange({isMuted:Oe})},[pe.emitter,Oe]);const[Ke,$e]=v.useState(!1);v.useEffect(()=>{let ze=null,Be=!1;const Cr=()=>{Be=!1,requestAnimationFrame(()=>{re===0?$e(!0):ze=setTimeout(()=>{Be||$e(!0)},re)})},bn=()=>{requestAnimationFrame(()=>{Be=!0,$e(!1),ze&&clearTimeout(ze)})};return pe.emitter.addEventListener("waiting",Cr),pe.emitter.addEventListener("resume",bn),()=>{pe.emitter.removeEventListener("waiting",Cr),pe.emitter.removeEventListener("resume",bn),$e(!1),ze&&clearTimeout(ze),Be=!0}},[re,pe.emitter]),v.useImperativeHandle(oe,()=>{const ze={play:pe.play,pause:()=>{Re(!1),pe.pause()},toggle:xr,getContainerNode:()=>ne.current,getCurrentFrame:pe.getCurrentFrame,isPlaying:pe.isPlaying,seekTo:Be=>{const Cr=gi-1,bn=Math.max(0,Math.min(Cr,Be));pe.isPlaying()&&(Re(bn!==Cr||t),pe.pause()),bn===Cr&&!t&&pe.emitter.dispatchEnded(),pe.seek(bn)},isFullscreen:()=>{const{current:Be}=ne;return Be?document.fullscreenElement===Be||document.webkitFullscreenElement===Be:!1},requestFullscreen:rt,exitFullscreen:Lt,getVolume:()=>le?0:ce,setVolume:Be=>{if(typeof Be!="number")throw new TypeError(`setVolume() takes a number, got value of type ${typeof Be}`);if(isNaN(Be))throw new TypeError("setVolume() got a number that is NaN. Volume must be between 0 and 1.");if(Be<0||Be>1)throw new TypeError(`setVolume() got a number that is out of range. Must be between 0 and 1, got ${typeof Be}`);_r(Be)},isMuted:()=>Oe,mute:()=>{P(!0)},unmute:()=>{P(!1)},getScale:()=>Pt,pauseAndReturnToPlayStart:()=>{pe.pauseAndReturnToPlayStart()}};return Object.assign(pe.emitter,ze)},[gi,Lt,t,le,Oe,ce,pe,rt,P,_r,xr,Pt]);const be=de?de.component:null,nt=v.useMemo(()=>mv({canvasSize:Fe,config:se,style:e,overflowVisible:Q,layout:Qe}),[Fe,se,Qe,Q,e]),lr=v.useMemo(()=>yv({config:se,layout:Qe,scale:Pt,overflowVisible:Q}),[se,Qe,Q,Pt]),xt=v.useMemo(()=>vv({canvasSize:Fe,config:se,layout:Qe,scale:Pt,overflowVisible:Q}),[Fe,se,Qe,Q,Pt]),Sr=v.useCallback(ze=>{pe.pause(),pe.emitter.dispatchError(ze)},[pe]),rn=v.useCallback(ze=>{ze.stopPropagation(),rt()},[rt]),ur=v.useCallback(ze=>{ze.stopPropagation(),Lt()},[Lt]),yn=v.useCallback(ze=>{(ze instanceof MouseEvent?ze.button===2:ze.nativeEvent.button)||xr(ze)},[xr]),er=v.useCallback(()=>{Ot(!0)},[]),ga=v.useCallback(()=>{Ot(!1)},[]),pa=v.useCallback(()=>{ht?Lt():rt()},[Lt,ht,rt]),{handlePointerDown:Ks,handleDoubleClick:Zs}=YI(yn,pa,u&&i&&cr);v.useEffect(()=>{_e&&(pe.play(),ke(!1))},[_e,pe]);const jf=v.useMemo(()=>p?p({height:nt.height,width:nt.width,isBuffering:Ke}):null,[nt.height,nt.width,p,Ke]),Il=v.useMemo(()=>({type:"scale",scale:Pt}),[Pt]);if(!se)return null;const rs=y?y({height:G==="player-size"?nt.height:se.height,width:G==="player-size"?nt.width:se.width,isBuffering:Ke}):null;if(rs===void 0)throw new TypeError("renderPoster() must return a React element, but undefined was returned");const Al=rs&&[k&&!pe.isPlaying()&&!Vt,T&&pe.isLastFrame&&!pe.isPlaying(),S&&!pe.hasPlayed&&!pe.isPlaying(),I&&Ke&&pe.isPlaying()].some(Boolean),{left:Hw,top:Ww,width:Uw,height:Lf,...Ff}=lr,Ml=b.jsxs(b.Fragment,{children:[b.jsx("div",{style:lr,onPointerDown:a?Ks:void 0,onDoubleClick:u?Zs:void 0,children:b.jsxs("div",{style:xt,className:Zh,children:[be?b.jsx(kv,{onError:Sr,errorFallback:d,children:b.jsx(xe.CurrentScaleContext.Provider,{value:Il,children:b.jsx(be,{...de?.props??{},...s??{}})})}):null,Al&&G==="composition-size"?b.jsx("div",{style:{...Ff,width:se.width,height:se.height},onPointerDown:a?Ks:void 0,onDoubleClick:u?Zs:void 0,children:rs}):null]})}),Al&&G==="player-size"?b.jsx("div",{style:lr,onPointerDown:a?Ks:void 0,onDoubleClick:u?Zs:void 0,children:rs}):null,r?b.jsx(zI,{fps:se.fps,durationInFrames:se.durationInFrames,player:pe,containerRef:ne,onFullscreenButtonClick:rn,isFullscreen:ht,allowFullscreen:i,showVolumeControls:c,onExitFullscreenButtonClick:ur,spaceKeyToPlayOrPause:h,onSeekEnd:ga,onSeekStart:er,inFrame:M,outFrame:L,initiallyShowControls:N,canvasSize:Fe,renderFullscreenButton:H,renderPlayPauseButton:R,alwaysShowControls:K,showPlaybackRateControl:$,buffering:Ke,hideControlsWhenPointerDoesntMove:fe,onDoubleClick:u?Zs:void 0,onPointerDown:a?Ks:void 0,renderMuteButton:X,renderVolumeSlider:U}):null]});return Iv&&!XI?b.jsx("div",{ref:ne,style:nt,className:w,children:Ml}):b.jsx("div",{ref:ne,style:nt,className:w,children:b.jsx(v.Suspense,{fallback:jf,children:Ml})})},qI=v.forwardRef(GI),Av="remotion.volumePreference",KI=r=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Av,String(r))}catch(e){console.log("Could not persist volume",e)}},ZI=()=>{if(typeof window>"u")return 1;try{const r=window.localStorage.getItem(Av);return r?Number(r):1}catch{return 1}},Qh="player-comp",Mv=({children:r,timelineContext:e,fps:t,compositionHeight:n,compositionWidth:i,durationInFrames:s,component:a,numberOfSharedAudioTags:c,initiallyMuted:u})=>{const h=v.useMemo(()=>({compositions:[{component:a,durationInFrames:s,height:n,width:i,fps:t,id:Qh,nonce:777,folderName:null,parentFolderName:null,schema:null,calculateMetadata:null}],folders:[],registerFolder:()=>{},unregisterFolder:()=>{},registerComposition:()=>{},unregisterComposition:()=>{},currentCompositionMetadata:null,setCurrentCompositionMetadata:()=>{},canvasContent:{type:"composition",compositionId:"player-comp"},setCanvasContent:()=>{},updateCompositionDefaultProps:()=>{}}),[a,s,n,i,t]),[d,g]=v.useState(()=>u),[p,y]=v.useState(()=>ZI()),w=v.useMemo(()=>({mediaMuted:d,mediaVolume:p}),[d,p]),_=v.useCallback(T=>{y(T),KI(T)},[]),S=v.useMemo(()=>({setMediaMuted:g,setMediaVolume:_}),[_]);return b.jsx(xe.CanUseRemotionHooksProvider,{children:b.jsx(xe.Timeline.TimelineContext.Provider,{value:e,children:b.jsx(xe.CompositionManager.Provider,{value:h,children:b.jsx(xe.ResolveCompositionConfig,{children:b.jsx(xe.PrefetchProvider,{children:b.jsx(xe.DurationsContextProvider,{children:b.jsx(xe.MediaVolumeContext.Provider,{value:w,children:b.jsx(xe.SetMediaVolumeContext.Provider,{value:S,children:b.jsx(xe.SharedAudioContextProvider,{numberOfAudioTags:c,component:a,children:b.jsx(xe.BufferingProvider,{children:r})})})})})})})})})})},Ov=(r,e)=>{if(typeof r>"u"||r===null)return r??null;if(typeof r!="number")throw new TypeError(`"${e}" must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new TypeError(`"${e}" must not be NaN, but is ${JSON.stringify(r)}`);if(!Number.isFinite(r))throw new TypeError(`"${e}" must be finite, but is ${JSON.stringify(r)}`);if(r%1!==0)throw new TypeError(`"${e}" must be an integer, but is ${JSON.stringify(r)}`);return r},JI=({inFrame:r,durationInFrames:e,outFrame:t})=>{const n=Ov(r,"inFrame"),i=Ov(t,"outFrame");if(!(n===null&&i===null)){if(n!==null&&n>e-1)throw new Error("inFrame must be less than (durationInFrames - 1), but is "+n);if(i!==null&&i>e-1)throw new Error("outFrame must be less than (durationInFrames - 1), but is "+i);if(n!==null&&n<0)throw new Error("inFrame must be greater than 0, but is "+n);if(i!==null&&i<=0)throw new Error(`outFrame must be greater than 0, but is ${i}. If you want to render a single frame, use <Thumbnail /> instead.`);if(i!==null&&n!==null&&i<=n)throw new Error("outFrame must be greater than inFrame, but is "+i+" <= "+n)}},QI=({initialFrame:r,durationInFrames:e})=>{if(typeof e!="number")throw new Error(`\`durationInFrames\` must be a number, but is ${JSON.stringify(e)}`);if(!(typeof r>"u")){if(typeof r!="number")throw new Error(`\`initialFrame\` must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new Error("`initialFrame` must be a number, but is NaN");if(!Number.isFinite(r))throw new Error("`initialFrame` must be a number, but is Infinity");if(r%1!==0)throw new Error(`\`initialFrame\` must be an integer, but is ${JSON.stringify(r)}`);if(r>e-1)throw new Error(`\`initialFrame\` must be less or equal than \`durationInFrames - 1\`, but is ${JSON.stringify(r)}`)}},eA=r=>{if(r!==void 0){if(r>4)throw new Error(`The highest possible playback rate is 4. You passed: ${r}`);if(r<-4)throw new Error(`The lowest possible playback rate is -4. You passed: ${r}`);if(r===0)throw new Error("A playback rate of 0 is not supported.")}},tA=hc.validateFps,Pv=hc.validateDimension,rA=hc.validateDurationInFrames,nA=hc.validateDefaultAndInputProps,iA=r=>"component"in r?r.component:null,sA=({durationInFrames:r,compositionHeight:e,compositionWidth:t,fps:n,inputProps:i,style:s,controls:a=!1,loop:c=!1,autoPlay:u=!1,showVolumeControls:h=!0,allowFullscreen:d=!0,clickToPlay:g,doubleClickToFullscreen:p=!1,spaceKeyToPlayOrPause:y=!0,moveToBeginningWhenEnded:w=!0,numberOfSharedAudioTags:_=5,errorFallback:S=()=>"",playbackRate:T=1,renderLoading:k,className:I,showPosterWhenUnplayed:M,showPosterWhenEnded:L,showPosterWhenPaused:N,showPosterWhenBuffering:H,initialFrame:R,renderPoster:X,inFrame:U,outFrame:K,initiallyShowControls:$,renderFullscreenButton:G,renderPlayPauseButton:re,renderVolumeSlider:fe,alwaysShowControls:Q=!1,initiallyMuted:ue=!1,showPlaybackRateControl:oe=!1,posterFillMode:se="player-size",bufferStateDelayInMilliseconds:de,hideControlsWhenPointerDoesntMove:ne=!0,overflowVisible:Fe=!1,renderMuteButton:Ge,browserMediaControlsBehavior:Re,..._e},ke)=>{if(typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]),_e.defaultProps!==void 0)throw new Error("The <Player /> component does not accept `defaultProps`, but some were passed. Use `inputProps` instead.");const ht=iA(_e);if(ht?.type===nv)throw new TypeError("'component' should not be an instance of <Composition/>. Pass the React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");if(ht===nv)throw new TypeError("'component' must not be the 'Composition' component. Pass your own React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");const ar=xe.useLazyComponent(_e);QI({initialFrame:R,durationInFrames:r});const[Vt,Ot]=v.useState(()=>({[Qh]:R??0})),[cr,pe]=v.useState(!1),[xr]=v.useState("player-comp"),rt=v.useRef(null),Lt=v.useRef([]),gi=v.useRef(!1),[Qe,Pt]=v.useState(T);if(typeof e!="number")throw new TypeError(`'compositionHeight' must be a number but got '${typeof e}' instead`);if(typeof t!="number")throw new TypeError(`'compositionWidth' must be a number but got '${typeof t}' instead`);if(Pv(e,"compositionHeight","of the <Player /> component"),Pv(t,"compositionWidth","of the <Player /> component"),rA(r,{component:"of the <Player/> component",allowFloats:!1}),tA(n,"as a prop of the <Player/> component",!1),nA(i,"inputProps",null),JI({durationInFrames:r,inFrame:U,outFrame:K}),typeof a!="boolean"&&typeof a<"u")throw new TypeError(`'controls' must be a boolean or undefined but got '${typeof a}' instead`);if(typeof u!="boolean"&&typeof u<"u")throw new TypeError(`'autoPlay' must be a boolean or undefined but got '${typeof u}' instead`);if(typeof c!="boolean"&&typeof c<"u")throw new TypeError(`'loop' must be a boolean or undefined but got '${typeof c}' instead`);if(typeof p!="boolean"&&typeof p<"u")throw new TypeError(`'doubleClickToFullscreen' must be a boolean or undefined but got '${typeof p}' instead`);if(typeof h!="boolean"&&typeof h<"u")throw new TypeError(`'showVolumeControls' must be a boolean or undefined but got '${typeof h}' instead`);if(typeof d!="boolean"&&typeof d<"u")throw new TypeError(`'allowFullscreen' must be a boolean or undefined but got '${typeof d}' instead`);if(typeof g!="boolean"&&typeof g<"u")throw new TypeError(`'clickToPlay' must be a boolean or undefined but got '${typeof g}' instead`);if(typeof y!="boolean"&&typeof y<"u")throw new TypeError(`'spaceKeyToPlayOrPause' must be a boolean or undefined but got '${typeof y}' instead`);if(typeof _!="number"||_%1!==0||!Number.isFinite(_)||Number.isNaN(_)||_<0)throw new TypeError(`'numberOfSharedAudioTags' must be an integer but got '${_}' instead`);eA(Qe),v.useEffect(()=>{Pt(T)},[T]),v.useImperativeHandle(ke,()=>rt.current,[]);const Vn=v.useMemo(()=>({frame:Vt,playing:cr,rootId:xr,playbackRate:Qe,imperativePlaying:gi,setPlaybackRate:ce=>{Pt(ce)},audioAndVideoTags:Lt}),[Vt,Qe,cr,xr]),_r=v.useMemo(()=>({setFrame:Ot,setPlaying:pe}),[Ot]);typeof window<"u"&&v.useLayoutEffect(()=>{xe.CSSUtils.injectCSS(xe.CSSUtils.makeDefaultPreviewCSS(`.${Zh}`,"#fff"))},[]);const P=v.useMemo(()=>i??{},[i]),le=v.useMemo(()=>Re??{mode:"prevent-media-session"},[Re]);return b.jsx(xe.IsPlayerContextProvider,{children:b.jsx(Mv,{timelineContext:Vn,component:ar,compositionHeight:e,compositionWidth:t,durationInFrames:r,fps:n,numberOfSharedAudioTags:_,initiallyMuted:ue,children:b.jsx(xe.Timeline.SetTimelineContext.Provider,{value:_r,children:b.jsx(oI,{currentPlaybackRate:Qe,children:b.jsx(qI,{ref:rt,posterFillMode:se,renderLoading:k,autoPlay:!!u,loop:!!c,controls:!!a,errorFallback:S,style:s,inputProps:P,allowFullscreen:!!d,moveToBeginningWhenEnded:!!w,clickToPlay:typeof g=="boolean"?g:!!a,showVolumeControls:!!h,doubleClickToFullscreen:!!p,spaceKeyToPlayOrPause:!!y,playbackRate:Qe,className:I??void 0,showPosterWhenUnplayed:!!M,showPosterWhenEnded:!!L,showPosterWhenPaused:!!N,showPosterWhenBuffering:!!H,renderPoster:X,inFrame:U??null,outFrame:K??null,initiallyShowControls:$??!0,renderFullscreen:G??null,renderPlayPauseButton:re??null,renderMuteButton:Ge??null,renderVolumeSlider:fe??null,alwaysShowControls:Q,showPlaybackRateControl:oe,bufferStateDelayInMilliseconds:de??300,hideControlsWhenPointerDoesntMove:ne,overflowVisible:Fe,browserMediaControlsBehavior:le})})})})})},oA=v.forwardRef,aA=oA(sA),cA=()=>{const r=v.useContext(wv);if(!r)throw new TypeError("Expected Player event emitter context");return v.useMemo(()=>({emitter:r}),[r])},ed=v.version.split(".")[0];if(ed==="0")throw new Error(`Version ${ed} of "react" is not supported by Remotion`);var lA=parseInt(ed,10)>=18,uA=({style:r,inputProps:e,errorFallback:t,renderLoading:n,className:i,overflowVisible:s},a)=>{const c=xe.useUnsafeVideoConfig(),u=xe.useVideo(),h=v.useRef(null),d=Xh(h,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),g=v.useMemo(()=>!c||!d?null:pv({canvasSize:d,compositionHeight:c.height,compositionWidth:c.width,previewSize:"auto"}),[d,c]),p=g?.scale??1,y=cA();xv(y.emitter),v.useImperativeHandle(a,()=>{const N={getContainerNode:()=>h.current,getScale:()=>p};return Object.assign(y.emitter,N)},[p,y.emitter]);const w=u?u.component:null,_=v.useMemo(()=>mv({config:c,style:r,canvasSize:d,overflowVisible:s,layout:g}),[d,c,g,s,r]),S=v.useMemo(()=>yv({config:c,layout:g,scale:p,overflowVisible:s}),[c,g,s,p]),T=v.useMemo(()=>vv({canvasSize:d,config:c,layout:g,scale:p,overflowVisible:s}),[d,c,g,s,p]),k=v.useCallback(N=>{y.emitter.dispatchError(N)},[y.emitter]),I=v.useMemo(()=>n?n({height:_.height,width:_.width,isBuffering:!1}):null,[_.height,_.width,n]),M=v.useMemo(()=>({type:"scale",scale:p}),[p]);if(!c)return null;const L=b.jsx("div",{style:S,children:b.jsx("div",{style:T,className:Zh,children:w?b.jsx(kv,{onError:k,errorFallback:t,children:b.jsx(xe.CurrentScaleContext.Provider,{value:M,children:b.jsx(w,{...u?.props??{},...e??{}})})}):null})});return Iv&&!lA?b.jsx("div",{ref:h,style:_,className:i,children:L}):b.jsx("div",{ref:h,style:_,className:i,children:b.jsx(v.Suspense,{fallback:I,children:L})})},hA=v.forwardRef(uA),dA=({frameToDisplay:r,style:e,inputProps:t,compositionHeight:n,compositionWidth:i,durationInFrames:s,fps:a,className:c,errorFallback:u=()=>"",renderLoading:h,overflowVisible:d=!1,...g},p)=>{typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]);const[y]=v.useState(()=>String(Ai(null))),w=v.useRef(null),_=v.useMemo(()=>({playing:!1,frame:{[Qh]:r},rootId:y,imperativePlaying:{current:!1},playbackRate:1,setPlaybackRate:()=>{throw new Error("thumbnail")},audioAndVideoTags:{current:[]}}),[r,y]);v.useImperativeHandle(p,()=>w.current,[]);const S=xe.useLazyComponent(g),[T]=v.useState(()=>new sI),k=v.useMemo(()=>t??{},[t]);return b.jsx(xe.IsPlayerContextProvider,{children:b.jsx(Mv,{timelineContext:_,component:S,compositionHeight:n,compositionWidth:i,durationInFrames:s,fps:a,numberOfSharedAudioTags:0,initiallyMuted:!0,children:b.jsx(wv.Provider,{value:T,children:b.jsx(hA,{ref:w,className:c,errorFallback:u,inputProps:k,renderLoading:h,style:e,overflowVisible:d})})})})},fA=v.forwardRef;fA(dA);const gc=(r,e)=>{const t=r.from/1e3*e,n=r.to/1e3*e-t;return{from:t,durationInFrames:n}},Dv={text:(r,e)=>{const{fps:t,height:n,width:i}=e,{from:s,durationInFrames:a}=gc(r.display,t);return b.jsx(dn,{from:s,durationInFrames:a,"data-track-item":"transition-element",style:{position:"absolute",width:r.details.width??300,height:r.details.height??400,transform:r.details.transform??"none",fontSize:r.details.fontSize||"16px",textAlign:r.details.textAlign||"left",top:r.details.top??300,left:r.details.left??600,color:r.details.color||"#000000",backgroundColor:r.details.backgroundColor||"transparent",border:r.details.border??"none",opacity:r.details.opacity??100/100,fontFamily:r.details.fontFamily||"Arial",textDecoration:r.details.textDecoration||"none",fontWeight:r.details.fontWeight||"normal",lineHeight:r.details.lineHeight||"normal",letterSpacing:r.details.letterSpacing||"normal",wordSpacing:r.details.wordSpacing||"normal",wordWrap:r.details.wordWrap||"normal",wordBreak:r.details.wordBreak||"normal",pointerEvents:"auto"},children:b.jsx("div",{children:r.details.text})},r.id)},image:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:i}=gc(r.display,t);return b.jsx(dn,{from:n,durationInFrames:i,style:{width:r.details.width??"100%",height:r.details.height??"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",filter:r.details.filter||"none",top:r.details.top??0,left:r.details.left??0},children:b.jsx(Eo,{style:{pointerEvents:"none"},children:b.jsx(sv,{style:{pointerEvents:"none"},"data-id":r.id,src:r.details.src})})},r.id)},video:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:i}=gc(r.display,t),s=r.trim,a=r.details.crop||{x:0,y:0,width:r.details.width,height:r.details.height};return s?b.jsx(dn,{premountFor:30*5,from:n,durationInFrames:i,style:{width:a.width||"100%",height:a.height||"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",top:r.details.top??0,left:r.details.left??0,overflow:"hidden"},children:b.jsx(Eo,{style:{pointerEvents:"none",width:r.details.width,height:r.details.height,top:-a.y,left:-a.x},children:b.jsx(hv,{startFrom:s.from/1e3*t,endAt:s.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100,style:{pointerEvents:"none",width:r.details.width,height:r.details.height}})})},r.id):b.jsx(b.Fragment,{})},audio:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:i}=gc(r.display,t),s=r.trim;return s?b.jsx(dn,{className:`moonshine-scene-item id-${r.id} moonshine-scene-item-type-${r.type}`,from:n,durationInFrames:i,style:{userSelect:"none",pointerEvents:"none"},children:b.jsx(Eo,{children:b.jsx(Mo,{startFrom:s.from/1e3*t,endAt:s.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100})})},r.id):b.jsx(b.Fragment,{})}};var pc={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */pc.exports,function(r,e){(function(){var t,n="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",g=1,p=2,y=4,w=1,_=2,S=1,T=2,k=4,I=8,M=16,L=32,N=64,H=128,R=256,X=512,U=30,K="...",$=800,G=16,re=1,fe=2,Q=3,ue=1/0,oe=9007199254740991,se=17976931348623157e292,de=NaN,ne=4294967295,Fe=ne-1,Ge=ne>>>1,Re=[["ary",H],["bind",S],["bindKey",T],["curry",I],["curryRight",M],["flip",X],["partial",L],["partialRight",N],["rearg",R]],_e="[object Arguments]",ke="[object Array]",ht="[object AsyncFunction]",ar="[object Boolean]",Vt="[object Date]",Ot="[object DOMException]",cr="[object Error]",pe="[object Function]",xr="[object GeneratorFunction]",rt="[object Map]",Lt="[object Number]",gi="[object Null]",Qe="[object Object]",Pt="[object Promise]",Vn="[object Proxy]",_r="[object RegExp]",P="[object Set]",le="[object String]",ce="[object Symbol]",Oe="[object Undefined]",Ke="[object WeakMap]",$e="[object WeakSet]",be="[object ArrayBuffer]",nt="[object DataView]",lr="[object Float32Array]",xt="[object Float64Array]",Sr="[object Int8Array]",rn="[object Int16Array]",ur="[object Int32Array]",yn="[object Uint8Array]",er="[object Uint8ClampedArray]",ga="[object Uint16Array]",pa="[object Uint32Array]",Ks=/\b__p \+= '';/g,Zs=/\b(__p \+=) '' \+/g,jf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Il=/&(?:amp|lt|gt|quot|#39);/g,rs=/[&<>"']/g,Al=RegExp(Il.source),Hw=RegExp(rs.source),Ww=/<%-([\s\S]+?)%>/g,Uw=/<%([\s\S]+?)%>/g,Lf=/<%=([\s\S]+?)%>/g,Ff=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ml=/^\w*$/,ze=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Be=/[\\^$.*+?()[\]{}|]/g,Cr=RegExp(Be.source),bn=/^\s+/,$w=/\s/,CD=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,TD=/\{\n\/\* \[wrapped with (.+)\] \*/,ED=/,? & /,kD=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ID=/[()=,{}\[\]\/\s]/,AD=/\\(\\)?/g,MD=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Yw=/\w*$/,OD=/^[-+]0x[0-9a-f]+$/i,PD=/^0b[01]+$/i,DD=/^\[object .+?Constructor\]$/,jD=/^0o[0-7]+$/i,LD=/^(?:0|[1-9]\d*)$/,FD=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ol=/($^)/,ND=/['\n\r\u2028\u2029\\]/g,Pl="\\ud800-\\udfff",RD="\\u0300-\\u036f",VD="\\ufe20-\\ufe2f",BD="\\u20d0-\\u20ff",Xw=RD+VD+BD,Gw="\\u2700-\\u27bf",qw="a-z\\xdf-\\xf6\\xf8-\\xff",zD="\\xac\\xb1\\xd7\\xf7",HD="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",WD="\\u2000-\\u206f",UD=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Kw="A-Z\\xc0-\\xd6\\xd8-\\xde",Zw="\\ufe0e\\ufe0f",Jw=zD+HD+WD+UD,Nf="[']",$D="["+Pl+"]",Qw="["+Jw+"]",Dl="["+Xw+"]",ex="\\d+",YD="["+Gw+"]",tx="["+qw+"]",rx="[^"+Pl+Jw+ex+Gw+qw+Kw+"]",Rf="\\ud83c[\\udffb-\\udfff]",XD="(?:"+Dl+"|"+Rf+")",nx="[^"+Pl+"]",Vf="(?:\\ud83c[\\udde6-\\uddff]){2}",Bf="[\\ud800-\\udbff][\\udc00-\\udfff]",Js="["+Kw+"]",ix="\\u200d",sx="(?:"+tx+"|"+rx+")",GD="(?:"+Js+"|"+rx+")",ox="(?:"+Nf+"(?:d|ll|m|re|s|t|ve))?",ax="(?:"+Nf+"(?:D|LL|M|RE|S|T|VE))?",cx=XD+"?",lx="["+Zw+"]?",qD="(?:"+ix+"(?:"+[nx,Vf,Bf].join("|")+")"+lx+cx+")*",KD="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ZD="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ux=lx+cx+qD,JD="(?:"+[YD,Vf,Bf].join("|")+")"+ux,QD="(?:"+[nx+Dl+"?",Dl,Vf,Bf,$D].join("|")+")",e6=RegExp(Nf,"g"),t6=RegExp(Dl,"g"),zf=RegExp(Rf+"(?="+Rf+")|"+QD+ux,"g"),r6=RegExp([Js+"?"+tx+"+"+ox+"(?="+[Qw,Js,"$"].join("|")+")",GD+"+"+ax+"(?="+[Qw,Js+sx,"$"].join("|")+")",Js+"?"+sx+"+"+ox,Js+"+"+ax,ZD,KD,ex,JD].join("|"),"g"),n6=RegExp("["+ix+Pl+Xw+Zw+"]"),i6=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,s6=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],o6=-1,it={};it[lr]=it[xt]=it[Sr]=it[rn]=it[ur]=it[yn]=it[er]=it[ga]=it[pa]=!0,it[_e]=it[ke]=it[be]=it[ar]=it[nt]=it[Vt]=it[cr]=it[pe]=it[rt]=it[Lt]=it[Qe]=it[_r]=it[P]=it[le]=it[Ke]=!1;var et={};et[_e]=et[ke]=et[be]=et[nt]=et[ar]=et[Vt]=et[lr]=et[xt]=et[Sr]=et[rn]=et[ur]=et[rt]=et[Lt]=et[Qe]=et[_r]=et[P]=et[le]=et[ce]=et[yn]=et[er]=et[ga]=et[pa]=!0,et[cr]=et[pe]=et[Ke]=!1;var a6={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},c6={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},l6={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},u6={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},h6=parseFloat,d6=parseInt,hx=typeof fo=="object"&&fo&&fo.Object===Object&&fo,f6=typeof self=="object"&&self&&self.Object===Object&&self,Bt=hx||f6||Function("return this")(),Hf=e&&!e.nodeType&&e,ns=Hf&&!0&&r&&!r.nodeType&&r,dx=ns&&ns.exports===Hf,Wf=dx&&hx.process,Rr=function(){try{var V=ns&&ns.require&&ns.require("util").types;return V||Wf&&Wf.binding&&Wf.binding("util")}catch{}}(),fx=Rr&&Rr.isArrayBuffer,gx=Rr&&Rr.isDate,px=Rr&&Rr.isMap,mx=Rr&&Rr.isRegExp,vx=Rr&&Rr.isSet,yx=Rr&&Rr.isTypedArray;function Tr(V,q,Y){switch(Y.length){case 0:return V.call(q);case 1:return V.call(q,Y[0]);case 2:return V.call(q,Y[0],Y[1]);case 3:return V.call(q,Y[0],Y[1],Y[2])}return V.apply(q,Y)}function g6(V,q,Y,he){for(var Se=-1,We=V==null?0:V.length;++Se<We;){var Dt=V[Se];q(he,Dt,Y(Dt),V)}return he}function Vr(V,q){for(var Y=-1,he=V==null?0:V.length;++Y<he&&q(V[Y],Y,V)!==!1;);return V}function p6(V,q){for(var Y=V==null?0:V.length;Y--&&q(V[Y],Y,V)!==!1;);return V}function bx(V,q){for(var Y=-1,he=V==null?0:V.length;++Y<he;)if(!q(V[Y],Y,V))return!1;return!0}function pi(V,q){for(var Y=-1,he=V==null?0:V.length,Se=0,We=[];++Y<he;){var Dt=V[Y];q(Dt,Y,V)&&(We[Se++]=Dt)}return We}function jl(V,q){var Y=V==null?0:V.length;return!!Y&&Qs(V,q,0)>-1}function Uf(V,q,Y){for(var he=-1,Se=V==null?0:V.length;++he<Se;)if(Y(q,V[he]))return!0;return!1}function ct(V,q){for(var Y=-1,he=V==null?0:V.length,Se=Array(he);++Y<he;)Se[Y]=q(V[Y],Y,V);return Se}function mi(V,q){for(var Y=-1,he=q.length,Se=V.length;++Y<he;)V[Se+Y]=q[Y];return V}function $f(V,q,Y,he){var Se=-1,We=V==null?0:V.length;for(he&&We&&(Y=V[++Se]);++Se<We;)Y=q(Y,V[Se],Se,V);return Y}function m6(V,q,Y,he){var Se=V==null?0:V.length;for(he&&Se&&(Y=V[--Se]);Se--;)Y=q(Y,V[Se],Se,V);return Y}function Yf(V,q){for(var Y=-1,he=V==null?0:V.length;++Y<he;)if(q(V[Y],Y,V))return!0;return!1}var v6=Xf("length");function y6(V){return V.split("")}function b6(V){return V.match(kD)||[]}function wx(V,q,Y){var he;return Y(V,function(Se,We,Dt){if(q(Se,We,Dt))return he=We,!1}),he}function Ll(V,q,Y,he){for(var Se=V.length,We=Y+(he?1:-1);he?We--:++We<Se;)if(q(V[We],We,V))return We;return-1}function Qs(V,q,Y){return q===q?O6(V,q,Y):Ll(V,xx,Y)}function w6(V,q,Y,he){for(var Se=Y-1,We=V.length;++Se<We;)if(he(V[Se],q))return Se;return-1}function xx(V){return V!==V}function _x(V,q){var Y=V==null?0:V.length;return Y?qf(V,q)/Y:de}function Xf(V){return function(q){return q==null?t:q[V]}}function Gf(V){return function(q){return V==null?t:V[q]}}function Sx(V,q,Y,he,Se){return Se(V,function(We,Dt,Je){Y=he?(he=!1,We):q(Y,We,Dt,Je)}),Y}function x6(V,q){var Y=V.length;for(V.sort(q);Y--;)V[Y]=V[Y].value;return V}function qf(V,q){for(var Y,he=-1,Se=V.length;++he<Se;){var We=q(V[he]);We!==t&&(Y=Y===t?We:Y+We)}return Y}function Kf(V,q){for(var Y=-1,he=Array(V);++Y<V;)he[Y]=q(Y);return he}function _6(V,q){return ct(q,function(Y){return[Y,V[Y]]})}function Cx(V){return V&&V.slice(0,Ix(V)+1).replace(bn,"")}function Er(V){return function(q){return V(q)}}function Zf(V,q){return ct(q,function(Y){return V[Y]})}function ma(V,q){return V.has(q)}function Tx(V,q){for(var Y=-1,he=V.length;++Y<he&&Qs(q,V[Y],0)>-1;);return Y}function Ex(V,q){for(var Y=V.length;Y--&&Qs(q,V[Y],0)>-1;);return Y}function S6(V,q){for(var Y=V.length,he=0;Y--;)V[Y]===q&&++he;return he}var C6=Gf(a6),T6=Gf(c6);function E6(V){return"\\"+u6[V]}function k6(V,q){return V==null?t:V[q]}function eo(V){return n6.test(V)}function I6(V){return i6.test(V)}function A6(V){for(var q,Y=[];!(q=V.next()).done;)Y.push(q.value);return Y}function Jf(V){var q=-1,Y=Array(V.size);return V.forEach(function(he,Se){Y[++q]=[Se,he]}),Y}function kx(V,q){return function(Y){return V(q(Y))}}function vi(V,q){for(var Y=-1,he=V.length,Se=0,We=[];++Y<he;){var Dt=V[Y];(Dt===q||Dt===d)&&(V[Y]=d,We[Se++]=Y)}return We}function Fl(V){var q=-1,Y=Array(V.size);return V.forEach(function(he){Y[++q]=he}),Y}function M6(V){var q=-1,Y=Array(V.size);return V.forEach(function(he){Y[++q]=[he,he]}),Y}function O6(V,q,Y){for(var he=Y-1,Se=V.length;++he<Se;)if(V[he]===q)return he;return-1}function P6(V,q,Y){for(var he=Y+1;he--;)if(V[he]===q)return he;return he}function to(V){return eo(V)?j6(V):v6(V)}function nn(V){return eo(V)?L6(V):y6(V)}function Ix(V){for(var q=V.length;q--&&$w.test(V.charAt(q)););return q}var D6=Gf(l6);function j6(V){for(var q=zf.lastIndex=0;zf.test(V);)++q;return q}function L6(V){return V.match(zf)||[]}function F6(V){return V.match(r6)||[]}var N6=function V(q){q=q==null?Bt:ro.defaults(Bt.Object(),q,ro.pick(Bt,s6));var Y=q.Array,he=q.Date,Se=q.Error,We=q.Function,Dt=q.Math,Je=q.Object,Qf=q.RegExp,R6=q.String,Br=q.TypeError,Nl=Y.prototype,V6=We.prototype,no=Je.prototype,Rl=q["__core-js_shared__"],Vl=V6.toString,qe=no.hasOwnProperty,B6=0,Ax=function(){var o=/[^.]+$/.exec(Rl&&Rl.keys&&Rl.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Bl=no.toString,z6=Vl.call(Je),H6=Bt._,W6=Qf("^"+Vl.call(qe).replace(Be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zl=dx?q.Buffer:t,yi=q.Symbol,Hl=q.Uint8Array,Mx=zl?zl.allocUnsafe:t,Wl=kx(Je.getPrototypeOf,Je),Ox=Je.create,Px=no.propertyIsEnumerable,Ul=Nl.splice,Dx=yi?yi.isConcatSpreadable:t,va=yi?yi.iterator:t,is=yi?yi.toStringTag:t,$l=function(){try{var o=ls(Je,"defineProperty");return o({},"",{}),o}catch{}}(),U6=q.clearTimeout!==Bt.clearTimeout&&q.clearTimeout,$6=he&&he.now!==Bt.Date.now&&he.now,Y6=q.setTimeout!==Bt.setTimeout&&q.setTimeout,Yl=Dt.ceil,Xl=Dt.floor,eg=Je.getOwnPropertySymbols,X6=zl?zl.isBuffer:t,jx=q.isFinite,G6=Nl.join,q6=kx(Je.keys,Je),jt=Dt.max,Yt=Dt.min,K6=he.now,Z6=q.parseInt,Lx=Dt.random,J6=Nl.reverse,tg=ls(q,"DataView"),ya=ls(q,"Map"),rg=ls(q,"Promise"),io=ls(q,"Set"),ba=ls(q,"WeakMap"),wa=ls(Je,"create"),Gl=ba&&new ba,so={},Q6=us(tg),e7=us(ya),t7=us(rg),r7=us(io),n7=us(ba),ql=yi?yi.prototype:t,xa=ql?ql.valueOf:t,Fx=ql?ql.toString:t;function C(o){if(yt(o)&&!Ce(o)&&!(o instanceof Le)){if(o instanceof zr)return o;if(qe.call(o,"__wrapped__"))return N_(o)}return new zr(o)}var oo=function(){function o(){}return function(l){if(!dt(l))return{};if(Ox)return Ox(l);o.prototype=l;var f=new o;return o.prototype=t,f}}();function Kl(){}function zr(o,l){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=t}C.templateSettings={escape:Ww,evaluate:Uw,interpolate:Lf,variable:"",imports:{_:C}},C.prototype=Kl.prototype,C.prototype.constructor=C,zr.prototype=oo(Kl.prototype),zr.prototype.constructor=zr;function Le(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ne,this.__views__=[]}function i7(){var o=new Le(this.__wrapped__);return o.__actions__=hr(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=hr(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=hr(this.__views__),o}function s7(){if(this.__filtered__){var o=new Le(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function o7(){var o=this.__wrapped__.value(),l=this.__dir__,f=Ce(o),m=l<0,x=f?o.length:0,E=y8(0,x,this.__views__),O=E.start,D=E.end,B=D-O,Z=m?D:O-1,J=this.__iteratees__,ee=J.length,ae=0,ge=Yt(B,this.__takeCount__);if(!f||!m&&x==B&&ge==B)return o_(o,this.__actions__);var ve=[];e:for(;B--&&ae<ge;){Z+=l;for(var Ae=-1,ye=o[Z];++Ae<ee;){var De=J[Ae],Ne=De.iteratee,Ar=De.type,nr=Ne(ye);if(Ar==fe)ye=nr;else if(!nr){if(Ar==re)continue e;break e}}ve[ae++]=ye}return ve}Le.prototype=oo(Kl.prototype),Le.prototype.constructor=Le;function ss(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function a7(){this.__data__=wa?wa(null):{},this.size=0}function c7(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}function l7(o){var l=this.__data__;if(wa){var f=l[o];return f===u?t:f}return qe.call(l,o)?l[o]:t}function u7(o){var l=this.__data__;return wa?l[o]!==t:qe.call(l,o)}function h7(o,l){var f=this.__data__;return this.size+=this.has(o)?0:1,f[o]=wa&&l===t?u:l,this}ss.prototype.clear=a7,ss.prototype.delete=c7,ss.prototype.get=l7,ss.prototype.has=u7,ss.prototype.set=h7;function Bn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function d7(){this.__data__=[],this.size=0}function f7(o){var l=this.__data__,f=Zl(l,o);if(f<0)return!1;var m=l.length-1;return f==m?l.pop():Ul.call(l,f,1),--this.size,!0}function g7(o){var l=this.__data__,f=Zl(l,o);return f<0?t:l[f][1]}function p7(o){return Zl(this.__data__,o)>-1}function m7(o,l){var f=this.__data__,m=Zl(f,o);return m<0?(++this.size,f.push([o,l])):f[m][1]=l,this}Bn.prototype.clear=d7,Bn.prototype.delete=f7,Bn.prototype.get=g7,Bn.prototype.has=p7,Bn.prototype.set=m7;function zn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function v7(){this.size=0,this.__data__={hash:new ss,map:new(ya||Bn),string:new ss}}function y7(o){var l=lu(this,o).delete(o);return this.size-=l?1:0,l}function b7(o){return lu(this,o).get(o)}function w7(o){return lu(this,o).has(o)}function x7(o,l){var f=lu(this,o),m=f.size;return f.set(o,l),this.size+=f.size==m?0:1,this}zn.prototype.clear=v7,zn.prototype.delete=y7,zn.prototype.get=b7,zn.prototype.has=w7,zn.prototype.set=x7;function os(o){var l=-1,f=o==null?0:o.length;for(this.__data__=new zn;++l<f;)this.add(o[l])}function _7(o){return this.__data__.set(o,u),this}function S7(o){return this.__data__.has(o)}os.prototype.add=os.prototype.push=_7,os.prototype.has=S7;function sn(o){var l=this.__data__=new Bn(o);this.size=l.size}function C7(){this.__data__=new Bn,this.size=0}function T7(o){var l=this.__data__,f=l.delete(o);return this.size=l.size,f}function E7(o){return this.__data__.get(o)}function k7(o){return this.__data__.has(o)}function I7(o,l){var f=this.__data__;if(f instanceof Bn){var m=f.__data__;if(!ya||m.length<i-1)return m.push([o,l]),this.size=++f.size,this;f=this.__data__=new zn(m)}return f.set(o,l),this.size=f.size,this}sn.prototype.clear=C7,sn.prototype.delete=T7,sn.prototype.get=E7,sn.prototype.has=k7,sn.prototype.set=I7;function Nx(o,l){var f=Ce(o),m=!f&&hs(o),x=!f&&!m&&Si(o),E=!f&&!m&&!x&&uo(o),O=f||m||x||E,D=O?Kf(o.length,R6):[],B=D.length;for(var Z in o)(l||qe.call(o,Z))&&!(O&&(Z=="length"||x&&(Z=="offset"||Z=="parent")||E&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||$n(Z,B)))&&D.push(Z);return D}function Rx(o){var l=o.length;return l?o[fg(0,l-1)]:t}function A7(o,l){return uu(hr(o),as(l,0,o.length))}function M7(o){return uu(hr(o))}function ng(o,l,f){(f!==t&&!on(o[l],f)||f===t&&!(l in o))&&Hn(o,l,f)}function _a(o,l,f){var m=o[l];(!(qe.call(o,l)&&on(m,f))||f===t&&!(l in o))&&Hn(o,l,f)}function Zl(o,l){for(var f=o.length;f--;)if(on(o[f][0],l))return f;return-1}function O7(o,l,f,m){return bi(o,function(x,E,O){l(m,x,f(x),O)}),m}function Vx(o,l){return o&&xn(l,Ft(l),o)}function P7(o,l){return o&&xn(l,fr(l),o)}function Hn(o,l,f){l=="__proto__"&&$l?$l(o,l,{configurable:!0,enumerable:!0,value:f,writable:!0}):o[l]=f}function ig(o,l){for(var f=-1,m=l.length,x=Y(m),E=o==null;++f<m;)x[f]=E?t:Rg(o,l[f]);return x}function as(o,l,f){return o===o&&(f!==t&&(o=o<=f?o:f),l!==t&&(o=o>=l?o:l)),o}function Hr(o,l,f,m,x,E){var O,D=l&g,B=l&p,Z=l&y;if(f&&(O=x?f(o,m,x,E):f(o)),O!==t)return O;if(!dt(o))return o;var J=Ce(o);if(J){if(O=w8(o),!D)return hr(o,O)}else{var ee=Xt(o),ae=ee==pe||ee==xr;if(Si(o))return l_(o,D);if(ee==Qe||ee==_e||ae&&!x){if(O=B||ae?{}:I_(o),!D)return B?l8(o,P7(O,o)):c8(o,Vx(O,o))}else{if(!et[ee])return x?o:{};O=x8(o,ee,D)}}E||(E=new sn);var ge=E.get(o);if(ge)return ge;E.set(o,O),n2(o)?o.forEach(function(ye){O.add(Hr(ye,l,f,ye,o,E))}):t2(o)&&o.forEach(function(ye,De){O.set(De,Hr(ye,l,f,De,o,E))});var ve=Z?B?Cg:Sg:B?fr:Ft,Ae=J?t:ve(o);return Vr(Ae||o,function(ye,De){Ae&&(De=ye,ye=o[De]),_a(O,De,Hr(ye,l,f,De,o,E))}),O}function D7(o){var l=Ft(o);return function(f){return Bx(f,o,l)}}function Bx(o,l,f){var m=f.length;if(o==null)return!m;for(o=Je(o);m--;){var x=f[m],E=l[x],O=o[x];if(O===t&&!(x in o)||!E(O))return!1}return!0}function zx(o,l,f){if(typeof o!="function")throw new Br(a);return Aa(function(){o.apply(t,f)},l)}function Sa(o,l,f,m){var x=-1,E=jl,O=!0,D=o.length,B=[],Z=l.length;if(!D)return B;f&&(l=ct(l,Er(f))),m?(E=Uf,O=!1):l.length>=i&&(E=ma,O=!1,l=new os(l));e:for(;++x<D;){var J=o[x],ee=f==null?J:f(J);if(J=m||J!==0?J:0,O&&ee===ee){for(var ae=Z;ae--;)if(l[ae]===ee)continue e;B.push(J)}else E(l,ee,m)||B.push(J)}return B}var bi=g_(wn),Hx=g_(og,!0);function j7(o,l){var f=!0;return bi(o,function(m,x,E){return f=!!l(m,x,E),f}),f}function Jl(o,l,f){for(var m=-1,x=o.length;++m<x;){var E=o[m],O=l(E);if(O!=null&&(D===t?O===O&&!Ir(O):f(O,D)))var D=O,B=E}return B}function L7(o,l,f,m){var x=o.length;for(f=Ie(f),f<0&&(f=-f>x?0:x+f),m=m===t||m>x?x:Ie(m),m<0&&(m+=x),m=f>m?0:s2(m);f<m;)o[f++]=l;return o}function Wx(o,l){var f=[];return bi(o,function(m,x,E){l(m,x,E)&&f.push(m)}),f}function zt(o,l,f,m,x){var E=-1,O=o.length;for(f||(f=S8),x||(x=[]);++E<O;){var D=o[E];l>0&&f(D)?l>1?zt(D,l-1,f,m,x):mi(x,D):m||(x[x.length]=D)}return x}var sg=p_(),Ux=p_(!0);function wn(o,l){return o&&sg(o,l,Ft)}function og(o,l){return o&&Ux(o,l,Ft)}function Ql(o,l){return pi(l,function(f){return Yn(o[f])})}function cs(o,l){l=xi(l,o);for(var f=0,m=l.length;o!=null&&f<m;)o=o[_n(l[f++])];return f&&f==m?o:t}function $x(o,l,f){var m=l(o);return Ce(o)?m:mi(m,f(o))}function tr(o){return o==null?o===t?Oe:gi:is&&is in Je(o)?v8(o):M8(o)}function ag(o,l){return o>l}function F7(o,l){return o!=null&&qe.call(o,l)}function N7(o,l){return o!=null&&l in Je(o)}function R7(o,l,f){return o>=Yt(l,f)&&o<jt(l,f)}function cg(o,l,f){for(var m=f?Uf:jl,x=o[0].length,E=o.length,O=E,D=Y(E),B=1/0,Z=[];O--;){var J=o[O];O&&l&&(J=ct(J,Er(l))),B=Yt(J.length,B),D[O]=!f&&(l||x>=120&&J.length>=120)?new os(O&&J):t}J=o[0];var ee=-1,ae=D[0];e:for(;++ee<x&&Z.length<B;){var ge=J[ee],ve=l?l(ge):ge;if(ge=f||ge!==0?ge:0,!(ae?ma(ae,ve):m(Z,ve,f))){for(O=E;--O;){var Ae=D[O];if(!(Ae?ma(Ae,ve):m(o[O],ve,f)))continue e}ae&&ae.push(ve),Z.push(ge)}}return Z}function V7(o,l,f,m){return wn(o,function(x,E,O){l(m,f(x),E,O)}),m}function Ca(o,l,f){l=xi(l,o),o=P_(o,l);var m=o==null?o:o[_n(Ur(l))];return m==null?t:Tr(m,o,f)}function Yx(o){return yt(o)&&tr(o)==_e}function B7(o){return yt(o)&&tr(o)==be}function z7(o){return yt(o)&&tr(o)==Vt}function Ta(o,l,f,m,x){return o===l?!0:o==null||l==null||!yt(o)&&!yt(l)?o!==o&&l!==l:H7(o,l,f,m,Ta,x)}function H7(o,l,f,m,x,E){var O=Ce(o),D=Ce(l),B=O?ke:Xt(o),Z=D?ke:Xt(l);B=B==_e?Qe:B,Z=Z==_e?Qe:Z;var J=B==Qe,ee=Z==Qe,ae=B==Z;if(ae&&Si(o)){if(!Si(l))return!1;O=!0,J=!1}if(ae&&!J)return E||(E=new sn),O||uo(o)?T_(o,l,f,m,x,E):p8(o,l,B,f,m,x,E);if(!(f&w)){var ge=J&&qe.call(o,"__wrapped__"),ve=ee&&qe.call(l,"__wrapped__");if(ge||ve){var Ae=ge?o.value():o,ye=ve?l.value():l;return E||(E=new sn),x(Ae,ye,f,m,E)}}return ae?(E||(E=new sn),m8(o,l,f,m,x,E)):!1}function W7(o){return yt(o)&&Xt(o)==rt}function lg(o,l,f,m){var x=f.length,E=x,O=!m;if(o==null)return!E;for(o=Je(o);x--;){var D=f[x];if(O&&D[2]?D[1]!==o[D[0]]:!(D[0]in o))return!1}for(;++x<E;){D=f[x];var B=D[0],Z=o[B],J=D[1];if(O&&D[2]){if(Z===t&&!(B in o))return!1}else{var ee=new sn;if(m)var ae=m(Z,J,B,o,l,ee);if(!(ae===t?Ta(J,Z,w|_,m,ee):ae))return!1}}return!0}function Xx(o){if(!dt(o)||T8(o))return!1;var l=Yn(o)?W6:DD;return l.test(us(o))}function U7(o){return yt(o)&&tr(o)==_r}function $7(o){return yt(o)&&Xt(o)==P}function Y7(o){return yt(o)&&mu(o.length)&&!!it[tr(o)]}function Gx(o){return typeof o=="function"?o:o==null?gr:typeof o=="object"?Ce(o)?Zx(o[0],o[1]):Kx(o):m2(o)}function ug(o){if(!Ia(o))return q6(o);var l=[];for(var f in Je(o))qe.call(o,f)&&f!="constructor"&&l.push(f);return l}function X7(o){if(!dt(o))return A8(o);var l=Ia(o),f=[];for(var m in o)m=="constructor"&&(l||!qe.call(o,m))||f.push(m);return f}function hg(o,l){return o<l}function qx(o,l){var f=-1,m=dr(o)?Y(o.length):[];return bi(o,function(x,E,O){m[++f]=l(x,E,O)}),m}function Kx(o){var l=Eg(o);return l.length==1&&l[0][2]?M_(l[0][0],l[0][1]):function(f){return f===o||lg(f,o,l)}}function Zx(o,l){return Ig(o)&&A_(l)?M_(_n(o),l):function(f){var m=Rg(f,o);return m===t&&m===l?Vg(f,o):Ta(l,m,w|_)}}function eu(o,l,f,m,x){o!==l&&sg(l,function(E,O){if(x||(x=new sn),dt(E))G7(o,l,O,f,eu,m,x);else{var D=m?m(Mg(o,O),E,O+"",o,l,x):t;D===t&&(D=E),ng(o,O,D)}},fr)}function G7(o,l,f,m,x,E,O){var D=Mg(o,f),B=Mg(l,f),Z=O.get(B);if(Z){ng(o,f,Z);return}var J=E?E(D,B,f+"",o,l,O):t,ee=J===t;if(ee){var ae=Ce(B),ge=!ae&&Si(B),ve=!ae&&!ge&&uo(B);J=B,ae||ge||ve?Ce(D)?J=D:_t(D)?J=hr(D):ge?(ee=!1,J=l_(B,!0)):ve?(ee=!1,J=u_(B,!0)):J=[]:Ma(B)||hs(B)?(J=D,hs(D)?J=o2(D):(!dt(D)||Yn(D))&&(J=I_(B))):ee=!1}ee&&(O.set(B,J),x(J,B,m,E,O),O.delete(B)),ng(o,f,J)}function Jx(o,l){var f=o.length;if(f)return l+=l<0?f:0,$n(l,f)?o[l]:t}function Qx(o,l,f){l.length?l=ct(l,function(E){return Ce(E)?function(O){return cs(O,E.length===1?E[0]:E)}:E}):l=[gr];var m=-1;l=ct(l,Er(me()));var x=qx(o,function(E,O,D){var B=ct(l,function(Z){return Z(E)});return{criteria:B,index:++m,value:E}});return x6(x,function(E,O){return a8(E,O,f)})}function q7(o,l){return e_(o,l,function(f,m){return Vg(o,m)})}function e_(o,l,f){for(var m=-1,x=l.length,E={};++m<x;){var O=l[m],D=cs(o,O);f(D,O)&&Ea(E,xi(O,o),D)}return E}function K7(o){return function(l){return cs(l,o)}}function dg(o,l,f,m){var x=m?w6:Qs,E=-1,O=l.length,D=o;for(o===l&&(l=hr(l)),f&&(D=ct(o,Er(f)));++E<O;)for(var B=0,Z=l[E],J=f?f(Z):Z;(B=x(D,J,B,m))>-1;)D!==o&&Ul.call(D,B,1),Ul.call(o,B,1);return o}function t_(o,l){for(var f=o?l.length:0,m=f-1;f--;){var x=l[f];if(f==m||x!==E){var E=x;$n(x)?Ul.call(o,x,1):mg(o,x)}}return o}function fg(o,l){return o+Xl(Lx()*(l-o+1))}function Z7(o,l,f,m){for(var x=-1,E=jt(Yl((l-o)/(f||1)),0),O=Y(E);E--;)O[m?E:++x]=o,o+=f;return O}function gg(o,l){var f="";if(!o||l<1||l>oe)return f;do l%2&&(f+=o),l=Xl(l/2),l&&(o+=o);while(l);return f}function Me(o,l){return Og(O_(o,l,gr),o+"")}function J7(o){return Rx(ho(o))}function Q7(o,l){var f=ho(o);return uu(f,as(l,0,f.length))}function Ea(o,l,f,m){if(!dt(o))return o;l=xi(l,o);for(var x=-1,E=l.length,O=E-1,D=o;D!=null&&++x<E;){var B=_n(l[x]),Z=f;if(B==="__proto__"||B==="constructor"||B==="prototype")return o;if(x!=O){var J=D[B];Z=m?m(J,B,D):t,Z===t&&(Z=dt(J)?J:$n(l[x+1])?[]:{})}_a(D,B,Z),D=D[B]}return o}var r_=Gl?function(o,l){return Gl.set(o,l),o}:gr,e8=$l?function(o,l){return $l(o,"toString",{configurable:!0,enumerable:!1,value:zg(l),writable:!0})}:gr;function t8(o){return uu(ho(o))}function Wr(o,l,f){var m=-1,x=o.length;l<0&&(l=-l>x?0:x+l),f=f>x?x:f,f<0&&(f+=x),x=l>f?0:f-l>>>0,l>>>=0;for(var E=Y(x);++m<x;)E[m]=o[m+l];return E}function r8(o,l){var f;return bi(o,function(m,x,E){return f=l(m,x,E),!f}),!!f}function tu(o,l,f){var m=0,x=o==null?m:o.length;if(typeof l=="number"&&l===l&&x<=Ge){for(;m<x;){var E=m+x>>>1,O=o[E];O!==null&&!Ir(O)&&(f?O<=l:O<l)?m=E+1:x=E}return x}return pg(o,l,gr,f)}function pg(o,l,f,m){var x=0,E=o==null?0:o.length;if(E===0)return 0;l=f(l);for(var O=l!==l,D=l===null,B=Ir(l),Z=l===t;x<E;){var J=Xl((x+E)/2),ee=f(o[J]),ae=ee!==t,ge=ee===null,ve=ee===ee,Ae=Ir(ee);if(O)var ye=m||ve;else Z?ye=ve&&(m||ae):D?ye=ve&&ae&&(m||!ge):B?ye=ve&&ae&&!ge&&(m||!Ae):ge||Ae?ye=!1:ye=m?ee<=l:ee<l;ye?x=J+1:E=J}return Yt(E,Fe)}function n_(o,l){for(var f=-1,m=o.length,x=0,E=[];++f<m;){var O=o[f],D=l?l(O):O;if(!f||!on(D,B)){var B=D;E[x++]=O===0?0:O}}return E}function i_(o){return typeof o=="number"?o:Ir(o)?de:+o}function kr(o){if(typeof o=="string")return o;if(Ce(o))return ct(o,kr)+"";if(Ir(o))return Fx?Fx.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function wi(o,l,f){var m=-1,x=jl,E=o.length,O=!0,D=[],B=D;if(f)O=!1,x=Uf;else if(E>=i){var Z=l?null:f8(o);if(Z)return Fl(Z);O=!1,x=ma,B=new os}else B=l?[]:D;e:for(;++m<E;){var J=o[m],ee=l?l(J):J;if(J=f||J!==0?J:0,O&&ee===ee){for(var ae=B.length;ae--;)if(B[ae]===ee)continue e;l&&B.push(ee),D.push(J)}else x(B,ee,f)||(B!==D&&B.push(ee),D.push(J))}return D}function mg(o,l){return l=xi(l,o),o=P_(o,l),o==null||delete o[_n(Ur(l))]}function s_(o,l,f,m){return Ea(o,l,f(cs(o,l)),m)}function ru(o,l,f,m){for(var x=o.length,E=m?x:-1;(m?E--:++E<x)&&l(o[E],E,o););return f?Wr(o,m?0:E,m?E+1:x):Wr(o,m?E+1:0,m?x:E)}function o_(o,l){var f=o;return f instanceof Le&&(f=f.value()),$f(l,function(m,x){return x.func.apply(x.thisArg,mi([m],x.args))},f)}function vg(o,l,f){var m=o.length;if(m<2)return m?wi(o[0]):[];for(var x=-1,E=Y(m);++x<m;)for(var O=o[x],D=-1;++D<m;)D!=x&&(E[x]=Sa(E[x]||O,o[D],l,f));return wi(zt(E,1),l,f)}function a_(o,l,f){for(var m=-1,x=o.length,E=l.length,O={};++m<x;){var D=m<E?l[m]:t;f(O,o[m],D)}return O}function yg(o){return _t(o)?o:[]}function bg(o){return typeof o=="function"?o:gr}function xi(o,l){return Ce(o)?o:Ig(o,l)?[o]:F_(Ye(o))}var n8=Me;function _i(o,l,f){var m=o.length;return f=f===t?m:f,!l&&f>=m?o:Wr(o,l,f)}var c_=U6||function(o){return Bt.clearTimeout(o)};function l_(o,l){if(l)return o.slice();var f=o.length,m=Mx?Mx(f):new o.constructor(f);return o.copy(m),m}function wg(o){var l=new o.constructor(o.byteLength);return new Hl(l).set(new Hl(o)),l}function i8(o,l){var f=l?wg(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.byteLength)}function s8(o){var l=new o.constructor(o.source,Yw.exec(o));return l.lastIndex=o.lastIndex,l}function o8(o){return xa?Je(xa.call(o)):{}}function u_(o,l){var f=l?wg(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.length)}function h_(o,l){if(o!==l){var f=o!==t,m=o===null,x=o===o,E=Ir(o),O=l!==t,D=l===null,B=l===l,Z=Ir(l);if(!D&&!Z&&!E&&o>l||E&&O&&B&&!D&&!Z||m&&O&&B||!f&&B||!x)return 1;if(!m&&!E&&!Z&&o<l||Z&&f&&x&&!m&&!E||D&&f&&x||!O&&x||!B)return-1}return 0}function a8(o,l,f){for(var m=-1,x=o.criteria,E=l.criteria,O=x.length,D=f.length;++m<O;){var B=h_(x[m],E[m]);if(B){if(m>=D)return B;var Z=f[m];return B*(Z=="desc"?-1:1)}}return o.index-l.index}function d_(o,l,f,m){for(var x=-1,E=o.length,O=f.length,D=-1,B=l.length,Z=jt(E-O,0),J=Y(B+Z),ee=!m;++D<B;)J[D]=l[D];for(;++x<O;)(ee||x<E)&&(J[f[x]]=o[x]);for(;Z--;)J[D++]=o[x++];return J}function f_(o,l,f,m){for(var x=-1,E=o.length,O=-1,D=f.length,B=-1,Z=l.length,J=jt(E-D,0),ee=Y(J+Z),ae=!m;++x<J;)ee[x]=o[x];for(var ge=x;++B<Z;)ee[ge+B]=l[B];for(;++O<D;)(ae||x<E)&&(ee[ge+f[O]]=o[x++]);return ee}function hr(o,l){var f=-1,m=o.length;for(l||(l=Y(m));++f<m;)l[f]=o[f];return l}function xn(o,l,f,m){var x=!f;f||(f={});for(var E=-1,O=l.length;++E<O;){var D=l[E],B=m?m(f[D],o[D],D,f,o):t;B===t&&(B=o[D]),x?Hn(f,D,B):_a(f,D,B)}return f}function c8(o,l){return xn(o,kg(o),l)}function l8(o,l){return xn(o,E_(o),l)}function nu(o,l){return function(f,m){var x=Ce(f)?g6:O7,E=l?l():{};return x(f,o,me(m,2),E)}}function ao(o){return Me(function(l,f){var m=-1,x=f.length,E=x>1?f[x-1]:t,O=x>2?f[2]:t;for(E=o.length>3&&typeof E=="function"?(x--,E):t,O&&rr(f[0],f[1],O)&&(E=x<3?t:E,x=1),l=Je(l);++m<x;){var D=f[m];D&&o(l,D,m,E)}return l})}function g_(o,l){return function(f,m){if(f==null)return f;if(!dr(f))return o(f,m);for(var x=f.length,E=l?x:-1,O=Je(f);(l?E--:++E<x)&&m(O[E],E,O)!==!1;);return f}}function p_(o){return function(l,f,m){for(var x=-1,E=Je(l),O=m(l),D=O.length;D--;){var B=O[o?D:++x];if(f(E[B],B,E)===!1)break}return l}}function u8(o,l,f){var m=l&S,x=ka(o);function E(){var O=this&&this!==Bt&&this instanceof E?x:o;return O.apply(m?f:this,arguments)}return E}function m_(o){return function(l){l=Ye(l);var f=eo(l)?nn(l):t,m=f?f[0]:l.charAt(0),x=f?_i(f,1).join(""):l.slice(1);return m[o]()+x}}function co(o){return function(l){return $f(g2(f2(l).replace(e6,"")),o,"")}}function ka(o){return function(){var l=arguments;switch(l.length){case 0:return new o;case 1:return new o(l[0]);case 2:return new o(l[0],l[1]);case 3:return new o(l[0],l[1],l[2]);case 4:return new o(l[0],l[1],l[2],l[3]);case 5:return new o(l[0],l[1],l[2],l[3],l[4]);case 6:return new o(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new o(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var f=oo(o.prototype),m=o.apply(f,l);return dt(m)?m:f}}function h8(o,l,f){var m=ka(o);function x(){for(var E=arguments.length,O=Y(E),D=E,B=lo(x);D--;)O[D]=arguments[D];var Z=E<3&&O[0]!==B&&O[E-1]!==B?[]:vi(O,B);if(E-=Z.length,E<f)return x_(o,l,iu,x.placeholder,t,O,Z,t,t,f-E);var J=this&&this!==Bt&&this instanceof x?m:o;return Tr(J,this,O)}return x}function v_(o){return function(l,f,m){var x=Je(l);if(!dr(l)){var E=me(f,3);l=Ft(l),f=function(D){return E(x[D],D,x)}}var O=o(l,f,m);return O>-1?x[E?l[O]:O]:t}}function y_(o){return Un(function(l){var f=l.length,m=f,x=zr.prototype.thru;for(o&&l.reverse();m--;){var E=l[m];if(typeof E!="function")throw new Br(a);if(x&&!O&&cu(E)=="wrapper")var O=new zr([],!0)}for(m=O?m:f;++m<f;){E=l[m];var D=cu(E),B=D=="wrapper"?Tg(E):t;B&&Ag(B[0])&&B[1]==(H|I|L|R)&&!B[4].length&&B[9]==1?O=O[cu(B[0])].apply(O,B[3]):O=E.length==1&&Ag(E)?O[D]():O.thru(E)}return function(){var Z=arguments,J=Z[0];if(O&&Z.length==1&&Ce(J))return O.plant(J).value();for(var ee=0,ae=f?l[ee].apply(this,Z):J;++ee<f;)ae=l[ee].call(this,ae);return ae}})}function iu(o,l,f,m,x,E,O,D,B,Z){var J=l&H,ee=l&S,ae=l&T,ge=l&(I|M),ve=l&X,Ae=ae?t:ka(o);function ye(){for(var De=arguments.length,Ne=Y(De),Ar=De;Ar--;)Ne[Ar]=arguments[Ar];if(ge)var nr=lo(ye),Mr=S6(Ne,nr);if(m&&(Ne=d_(Ne,m,x,ge)),E&&(Ne=f_(Ne,E,O,ge)),De-=Mr,ge&&De<Z){var St=vi(Ne,nr);return x_(o,l,iu,ye.placeholder,f,Ne,St,D,B,Z-De)}var an=ee?f:this,Gn=ae?an[o]:o;return De=Ne.length,D?Ne=O8(Ne,D):ve&&De>1&&Ne.reverse(),J&&B<De&&(Ne.length=B),this&&this!==Bt&&this instanceof ye&&(Gn=Ae||ka(Gn)),Gn.apply(an,Ne)}return ye}function b_(o,l){return function(f,m){return V7(f,o,l(m),{})}}function su(o,l){return function(f,m){var x;if(f===t&&m===t)return l;if(f!==t&&(x=f),m!==t){if(x===t)return m;typeof f=="string"||typeof m=="string"?(f=kr(f),m=kr(m)):(f=i_(f),m=i_(m)),x=o(f,m)}return x}}function xg(o){return Un(function(l){return l=ct(l,Er(me())),Me(function(f){var m=this;return o(l,function(x){return Tr(x,m,f)})})})}function ou(o,l){l=l===t?" ":kr(l);var f=l.length;if(f<2)return f?gg(l,o):l;var m=gg(l,Yl(o/to(l)));return eo(l)?_i(nn(m),0,o).join(""):m.slice(0,o)}function d8(o,l,f,m){var x=l&S,E=ka(o);function O(){for(var D=-1,B=arguments.length,Z=-1,J=m.length,ee=Y(J+B),ae=this&&this!==Bt&&this instanceof O?E:o;++Z<J;)ee[Z]=m[Z];for(;B--;)ee[Z++]=arguments[++D];return Tr(ae,x?f:this,ee)}return O}function w_(o){return function(l,f,m){return m&&typeof m!="number"&&rr(l,f,m)&&(f=m=t),l=Xn(l),f===t?(f=l,l=0):f=Xn(f),m=m===t?l<f?1:-1:Xn(m),Z7(l,f,m,o)}}function au(o){return function(l,f){return typeof l=="string"&&typeof f=="string"||(l=$r(l),f=$r(f)),o(l,f)}}function x_(o,l,f,m,x,E,O,D,B,Z){var J=l&I,ee=J?O:t,ae=J?t:O,ge=J?E:t,ve=J?t:E;l|=J?L:N,l&=~(J?N:L),l&k||(l&=-4);var Ae=[o,l,x,ge,ee,ve,ae,D,B,Z],ye=f.apply(t,Ae);return Ag(o)&&D_(ye,Ae),ye.placeholder=m,j_(ye,o,l)}function _g(o){var l=Dt[o];return function(f,m){if(f=$r(f),m=m==null?0:Yt(Ie(m),292),m&&jx(f)){var x=(Ye(f)+"e").split("e"),E=l(x[0]+"e"+(+x[1]+m));return x=(Ye(E)+"e").split("e"),+(x[0]+"e"+(+x[1]-m))}return l(f)}}var f8=io&&1/Fl(new io([,-0]))[1]==ue?function(o){return new io(o)}:Ug;function __(o){return function(l){var f=Xt(l);return f==rt?Jf(l):f==P?M6(l):_6(l,o(l))}}function Wn(o,l,f,m,x,E,O,D){var B=l&T;if(!B&&typeof o!="function")throw new Br(a);var Z=m?m.length:0;if(Z||(l&=-97,m=x=t),O=O===t?O:jt(Ie(O),0),D=D===t?D:Ie(D),Z-=x?x.length:0,l&N){var J=m,ee=x;m=x=t}var ae=B?t:Tg(o),ge=[o,l,f,m,x,J,ee,E,O,D];if(ae&&I8(ge,ae),o=ge[0],l=ge[1],f=ge[2],m=ge[3],x=ge[4],D=ge[9]=ge[9]===t?B?0:o.length:jt(ge[9]-Z,0),!D&&l&(I|M)&&(l&=-25),!l||l==S)var ve=u8(o,l,f);else l==I||l==M?ve=h8(o,l,D):(l==L||l==(S|L))&&!x.length?ve=d8(o,l,f,m):ve=iu.apply(t,ge);var Ae=ae?r_:D_;return j_(Ae(ve,ge),o,l)}function S_(o,l,f,m){return o===t||on(o,no[f])&&!qe.call(m,f)?l:o}function C_(o,l,f,m,x,E){return dt(o)&&dt(l)&&(E.set(l,o),eu(o,l,t,C_,E),E.delete(l)),o}function g8(o){return Ma(o)?t:o}function T_(o,l,f,m,x,E){var O=f&w,D=o.length,B=l.length;if(D!=B&&!(O&&B>D))return!1;var Z=E.get(o),J=E.get(l);if(Z&&J)return Z==l&&J==o;var ee=-1,ae=!0,ge=f&_?new os:t;for(E.set(o,l),E.set(l,o);++ee<D;){var ve=o[ee],Ae=l[ee];if(m)var ye=O?m(Ae,ve,ee,l,o,E):m(ve,Ae,ee,o,l,E);if(ye!==t){if(ye)continue;ae=!1;break}if(ge){if(!Yf(l,function(De,Ne){if(!ma(ge,Ne)&&(ve===De||x(ve,De,f,m,E)))return ge.push(Ne)})){ae=!1;break}}else if(!(ve===Ae||x(ve,Ae,f,m,E))){ae=!1;break}}return E.delete(o),E.delete(l),ae}function p8(o,l,f,m,x,E,O){switch(f){case nt:if(o.byteLength!=l.byteLength||o.byteOffset!=l.byteOffset)return!1;o=o.buffer,l=l.buffer;case be:return!(o.byteLength!=l.byteLength||!E(new Hl(o),new Hl(l)));case ar:case Vt:case Lt:return on(+o,+l);case cr:return o.name==l.name&&o.message==l.message;case _r:case le:return o==l+"";case rt:var D=Jf;case P:var B=m&w;if(D||(D=Fl),o.size!=l.size&&!B)return!1;var Z=O.get(o);if(Z)return Z==l;m|=_,O.set(o,l);var J=T_(D(o),D(l),m,x,E,O);return O.delete(o),J;case ce:if(xa)return xa.call(o)==xa.call(l)}return!1}function m8(o,l,f,m,x,E){var O=f&w,D=Sg(o),B=D.length,Z=Sg(l),J=Z.length;if(B!=J&&!O)return!1;for(var ee=B;ee--;){var ae=D[ee];if(!(O?ae in l:qe.call(l,ae)))return!1}var ge=E.get(o),ve=E.get(l);if(ge&&ve)return ge==l&&ve==o;var Ae=!0;E.set(o,l),E.set(l,o);for(var ye=O;++ee<B;){ae=D[ee];var De=o[ae],Ne=l[ae];if(m)var Ar=O?m(Ne,De,ae,l,o,E):m(De,Ne,ae,o,l,E);if(!(Ar===t?De===Ne||x(De,Ne,f,m,E):Ar)){Ae=!1;break}ye||(ye=ae=="constructor")}if(Ae&&!ye){var nr=o.constructor,Mr=l.constructor;nr!=Mr&&"constructor"in o&&"constructor"in l&&!(typeof nr=="function"&&nr instanceof nr&&typeof Mr=="function"&&Mr instanceof Mr)&&(Ae=!1)}return E.delete(o),E.delete(l),Ae}function Un(o){return Og(O_(o,t,B_),o+"")}function Sg(o){return $x(o,Ft,kg)}function Cg(o){return $x(o,fr,E_)}var Tg=Gl?function(o){return Gl.get(o)}:Ug;function cu(o){for(var l=o.name+"",f=so[l],m=qe.call(so,l)?f.length:0;m--;){var x=f[m],E=x.func;if(E==null||E==o)return x.name}return l}function lo(o){var l=qe.call(C,"placeholder")?C:o;return l.placeholder}function me(){var o=C.iteratee||Hg;return o=o===Hg?Gx:o,arguments.length?o(arguments[0],arguments[1]):o}function lu(o,l){var f=o.__data__;return C8(l)?f[typeof l=="string"?"string":"hash"]:f.map}function Eg(o){for(var l=Ft(o),f=l.length;f--;){var m=l[f],x=o[m];l[f]=[m,x,A_(x)]}return l}function ls(o,l){var f=k6(o,l);return Xx(f)?f:t}function v8(o){var l=qe.call(o,is),f=o[is];try{o[is]=t;var m=!0}catch{}var x=Bl.call(o);return m&&(l?o[is]=f:delete o[is]),x}var kg=eg?function(o){return o==null?[]:(o=Je(o),pi(eg(o),function(l){return Px.call(o,l)}))}:$g,E_=eg?function(o){for(var l=[];o;)mi(l,kg(o)),o=Wl(o);return l}:$g,Xt=tr;(tg&&Xt(new tg(new ArrayBuffer(1)))!=nt||ya&&Xt(new ya)!=rt||rg&&Xt(rg.resolve())!=Pt||io&&Xt(new io)!=P||ba&&Xt(new ba)!=Ke)&&(Xt=function(o){var l=tr(o),f=l==Qe?o.constructor:t,m=f?us(f):"";if(m)switch(m){case Q6:return nt;case e7:return rt;case t7:return Pt;case r7:return P;case n7:return Ke}return l});function y8(o,l,f){for(var m=-1,x=f.length;++m<x;){var E=f[m],O=E.size;switch(E.type){case"drop":o+=O;break;case"dropRight":l-=O;break;case"take":l=Yt(l,o+O);break;case"takeRight":o=jt(o,l-O);break}}return{start:o,end:l}}function b8(o){var l=o.match(TD);return l?l[1].split(ED):[]}function k_(o,l,f){l=xi(l,o);for(var m=-1,x=l.length,E=!1;++m<x;){var O=_n(l[m]);if(!(E=o!=null&&f(o,O)))break;o=o[O]}return E||++m!=x?E:(x=o==null?0:o.length,!!x&&mu(x)&&$n(O,x)&&(Ce(o)||hs(o)))}function w8(o){var l=o.length,f=new o.constructor(l);return l&&typeof o[0]=="string"&&qe.call(o,"index")&&(f.index=o.index,f.input=o.input),f}function I_(o){return typeof o.constructor=="function"&&!Ia(o)?oo(Wl(o)):{}}function x8(o,l,f){var m=o.constructor;switch(l){case be:return wg(o);case ar:case Vt:return new m(+o);case nt:return i8(o,f);case lr:case xt:case Sr:case rn:case ur:case yn:case er:case ga:case pa:return u_(o,f);case rt:return new m;case Lt:case le:return new m(o);case _r:return s8(o);case P:return new m;case ce:return o8(o)}}function _8(o,l){var f=l.length;if(!f)return o;var m=f-1;return l[m]=(f>1?"& ":"")+l[m],l=l.join(f>2?", ":" "),o.replace(CD,`{
/* [wrapped with `+l+`] */
`)}function S8(o){return Ce(o)||hs(o)||!!(Dx&&o&&o[Dx])}function $n(o,l){var f=typeof o;return l=l??oe,!!l&&(f=="number"||f!="symbol"&&LD.test(o))&&o>-1&&o%1==0&&o<l}function rr(o,l,f){if(!dt(f))return!1;var m=typeof l;return(m=="number"?dr(f)&&$n(l,f.length):m=="string"&&l in f)?on(f[l],o):!1}function Ig(o,l){if(Ce(o))return!1;var f=typeof o;return f=="number"||f=="symbol"||f=="boolean"||o==null||Ir(o)?!0:Ml.test(o)||!Ff.test(o)||l!=null&&o in Je(l)}function C8(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}function Ag(o){var l=cu(o),f=C[l];if(typeof f!="function"||!(l in Le.prototype))return!1;if(o===f)return!0;var m=Tg(f);return!!m&&o===m[0]}function T8(o){return!!Ax&&Ax in o}var E8=Rl?Yn:Yg;function Ia(o){var l=o&&o.constructor,f=typeof l=="function"&&l.prototype||no;return o===f}function A_(o){return o===o&&!dt(o)}function M_(o,l){return function(f){return f==null?!1:f[o]===l&&(l!==t||o in Je(f))}}function k8(o){var l=gu(o,function(m){return f.size===h&&f.clear(),m}),f=l.cache;return l}function I8(o,l){var f=o[1],m=l[1],x=f|m,E=x<(S|T|H),O=m==H&&f==I||m==H&&f==R&&o[7].length<=l[8]||m==(H|R)&&l[7].length<=l[8]&&f==I;if(!(E||O))return o;m&S&&(o[2]=l[2],x|=f&S?0:k);var D=l[3];if(D){var B=o[3];o[3]=B?d_(B,D,l[4]):D,o[4]=B?vi(o[3],d):l[4]}return D=l[5],D&&(B=o[5],o[5]=B?f_(B,D,l[6]):D,o[6]=B?vi(o[5],d):l[6]),D=l[7],D&&(o[7]=D),m&H&&(o[8]=o[8]==null?l[8]:Yt(o[8],l[8])),o[9]==null&&(o[9]=l[9]),o[0]=l[0],o[1]=x,o}function A8(o){var l=[];if(o!=null)for(var f in Je(o))l.push(f);return l}function M8(o){return Bl.call(o)}function O_(o,l,f){return l=jt(l===t?o.length-1:l,0),function(){for(var m=arguments,x=-1,E=jt(m.length-l,0),O=Y(E);++x<E;)O[x]=m[l+x];x=-1;for(var D=Y(l+1);++x<l;)D[x]=m[x];return D[l]=f(O),Tr(o,this,D)}}function P_(o,l){return l.length<2?o:cs(o,Wr(l,0,-1))}function O8(o,l){for(var f=o.length,m=Yt(l.length,f),x=hr(o);m--;){var E=l[m];o[m]=$n(E,f)?x[E]:t}return o}function Mg(o,l){if(!(l==="constructor"&&typeof o[l]=="function")&&l!="__proto__")return o[l]}var D_=L_(r_),Aa=Y6||function(o,l){return Bt.setTimeout(o,l)},Og=L_(e8);function j_(o,l,f){var m=l+"";return Og(o,_8(m,P8(b8(m),f)))}function L_(o){var l=0,f=0;return function(){var m=K6(),x=G-(m-f);if(f=m,x>0){if(++l>=$)return arguments[0]}else l=0;return o.apply(t,arguments)}}function uu(o,l){var f=-1,m=o.length,x=m-1;for(l=l===t?m:l;++f<l;){var E=fg(f,x),O=o[E];o[E]=o[f],o[f]=O}return o.length=l,o}var F_=k8(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(ze,function(f,m,x,E){l.push(x?E.replace(AD,"$1"):m||f)}),l});function _n(o){if(typeof o=="string"||Ir(o))return o;var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function us(o){if(o!=null){try{return Vl.call(o)}catch{}try{return o+""}catch{}}return""}function P8(o,l){return Vr(Re,function(f){var m="_."+f[0];l&f[1]&&!jl(o,m)&&o.push(m)}),o.sort()}function N_(o){if(o instanceof Le)return o.clone();var l=new zr(o.__wrapped__,o.__chain__);return l.__actions__=hr(o.__actions__),l.__index__=o.__index__,l.__values__=o.__values__,l}function D8(o,l,f){(f?rr(o,l,f):l===t)?l=1:l=jt(Ie(l),0);var m=o==null?0:o.length;if(!m||l<1)return[];for(var x=0,E=0,O=Y(Yl(m/l));x<m;)O[E++]=Wr(o,x,x+=l);return O}function j8(o){for(var l=-1,f=o==null?0:o.length,m=0,x=[];++l<f;){var E=o[l];E&&(x[m++]=E)}return x}function L8(){var o=arguments.length;if(!o)return[];for(var l=Y(o-1),f=arguments[0],m=o;m--;)l[m-1]=arguments[m];return mi(Ce(f)?hr(f):[f],zt(l,1))}var F8=Me(function(o,l){return _t(o)?Sa(o,zt(l,1,_t,!0)):[]}),N8=Me(function(o,l){var f=Ur(l);return _t(f)&&(f=t),_t(o)?Sa(o,zt(l,1,_t,!0),me(f,2)):[]}),R8=Me(function(o,l){var f=Ur(l);return _t(f)&&(f=t),_t(o)?Sa(o,zt(l,1,_t,!0),t,f):[]});function V8(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ie(l),Wr(o,l<0?0:l,m)):[]}function B8(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ie(l),l=m-l,Wr(o,0,l<0?0:l)):[]}function z8(o,l){return o&&o.length?ru(o,me(l,3),!0,!0):[]}function H8(o,l){return o&&o.length?ru(o,me(l,3),!0):[]}function W8(o,l,f,m){var x=o==null?0:o.length;return x?(f&&typeof f!="number"&&rr(o,l,f)&&(f=0,m=x),L7(o,l,f,m)):[]}function R_(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=f==null?0:Ie(f);return x<0&&(x=jt(m+x,0)),Ll(o,me(l,3),x)}function V_(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=m-1;return f!==t&&(x=Ie(f),x=f<0?jt(m+x,0):Yt(x,m-1)),Ll(o,me(l,3),x,!0)}function B_(o){var l=o==null?0:o.length;return l?zt(o,1):[]}function U8(o){var l=o==null?0:o.length;return l?zt(o,ue):[]}function $8(o,l){var f=o==null?0:o.length;return f?(l=l===t?1:Ie(l),zt(o,l)):[]}function Y8(o){for(var l=-1,f=o==null?0:o.length,m={};++l<f;){var x=o[l];m[x[0]]=x[1]}return m}function z_(o){return o&&o.length?o[0]:t}function X8(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=f==null?0:Ie(f);return x<0&&(x=jt(m+x,0)),Qs(o,l,x)}function G8(o){var l=o==null?0:o.length;return l?Wr(o,0,-1):[]}var q8=Me(function(o){var l=ct(o,yg);return l.length&&l[0]===o[0]?cg(l):[]}),K8=Me(function(o){var l=Ur(o),f=ct(o,yg);return l===Ur(f)?l=t:f.pop(),f.length&&f[0]===o[0]?cg(f,me(l,2)):[]}),Z8=Me(function(o){var l=Ur(o),f=ct(o,yg);return l=typeof l=="function"?l:t,l&&f.pop(),f.length&&f[0]===o[0]?cg(f,t,l):[]});function J8(o,l){return o==null?"":G6.call(o,l)}function Ur(o){var l=o==null?0:o.length;return l?o[l-1]:t}function Q8(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=m;return f!==t&&(x=Ie(f),x=x<0?jt(m+x,0):Yt(x,m-1)),l===l?P6(o,l,x):Ll(o,xx,x,!0)}function e9(o,l){return o&&o.length?Jx(o,Ie(l)):t}var t9=Me(H_);function H_(o,l){return o&&o.length&&l&&l.length?dg(o,l):o}function r9(o,l,f){return o&&o.length&&l&&l.length?dg(o,l,me(f,2)):o}function n9(o,l,f){return o&&o.length&&l&&l.length?dg(o,l,t,f):o}var i9=Un(function(o,l){var f=o==null?0:o.length,m=ig(o,l);return t_(o,ct(l,function(x){return $n(x,f)?+x:x}).sort(h_)),m});function s9(o,l){var f=[];if(!(o&&o.length))return f;var m=-1,x=[],E=o.length;for(l=me(l,3);++m<E;){var O=o[m];l(O,m,o)&&(f.push(O),x.push(m))}return t_(o,x),f}function Pg(o){return o==null?o:J6.call(o)}function o9(o,l,f){var m=o==null?0:o.length;return m?(f&&typeof f!="number"&&rr(o,l,f)?(l=0,f=m):(l=l==null?0:Ie(l),f=f===t?m:Ie(f)),Wr(o,l,f)):[]}function a9(o,l){return tu(o,l)}function c9(o,l,f){return pg(o,l,me(f,2))}function l9(o,l){var f=o==null?0:o.length;if(f){var m=tu(o,l);if(m<f&&on(o[m],l))return m}return-1}function u9(o,l){return tu(o,l,!0)}function h9(o,l,f){return pg(o,l,me(f,2),!0)}function d9(o,l){var f=o==null?0:o.length;if(f){var m=tu(o,l,!0)-1;if(on(o[m],l))return m}return-1}function f9(o){return o&&o.length?n_(o):[]}function g9(o,l){return o&&o.length?n_(o,me(l,2)):[]}function p9(o){var l=o==null?0:o.length;return l?Wr(o,1,l):[]}function m9(o,l,f){return o&&o.length?(l=f||l===t?1:Ie(l),Wr(o,0,l<0?0:l)):[]}function v9(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ie(l),l=m-l,Wr(o,l<0?0:l,m)):[]}function y9(o,l){return o&&o.length?ru(o,me(l,3),!1,!0):[]}function b9(o,l){return o&&o.length?ru(o,me(l,3)):[]}var w9=Me(function(o){return wi(zt(o,1,_t,!0))}),x9=Me(function(o){var l=Ur(o);return _t(l)&&(l=t),wi(zt(o,1,_t,!0),me(l,2))}),_9=Me(function(o){var l=Ur(o);return l=typeof l=="function"?l:t,wi(zt(o,1,_t,!0),t,l)});function S9(o){return o&&o.length?wi(o):[]}function C9(o,l){return o&&o.length?wi(o,me(l,2)):[]}function T9(o,l){return l=typeof l=="function"?l:t,o&&o.length?wi(o,t,l):[]}function Dg(o){if(!(o&&o.length))return[];var l=0;return o=pi(o,function(f){if(_t(f))return l=jt(f.length,l),!0}),Kf(l,function(f){return ct(o,Xf(f))})}function W_(o,l){if(!(o&&o.length))return[];var f=Dg(o);return l==null?f:ct(f,function(m){return Tr(l,t,m)})}var E9=Me(function(o,l){return _t(o)?Sa(o,l):[]}),k9=Me(function(o){return vg(pi(o,_t))}),I9=Me(function(o){var l=Ur(o);return _t(l)&&(l=t),vg(pi(o,_t),me(l,2))}),A9=Me(function(o){var l=Ur(o);return l=typeof l=="function"?l:t,vg(pi(o,_t),t,l)}),M9=Me(Dg);function O9(o,l){return a_(o||[],l||[],_a)}function P9(o,l){return a_(o||[],l||[],Ea)}var D9=Me(function(o){var l=o.length,f=l>1?o[l-1]:t;return f=typeof f=="function"?(o.pop(),f):t,W_(o,f)});function U_(o){var l=C(o);return l.__chain__=!0,l}function j9(o,l){return l(o),o}function hu(o,l){return l(o)}var L9=Un(function(o){var l=o.length,f=l?o[0]:0,m=this.__wrapped__,x=function(E){return ig(E,o)};return l>1||this.__actions__.length||!(m instanceof Le)||!$n(f)?this.thru(x):(m=m.slice(f,+f+(l?1:0)),m.__actions__.push({func:hu,args:[x],thisArg:t}),new zr(m,this.__chain__).thru(function(E){return l&&!E.length&&E.push(t),E}))});function F9(){return U_(this)}function N9(){return new zr(this.value(),this.__chain__)}function R9(){this.__values__===t&&(this.__values__=i2(this.value()));var o=this.__index__>=this.__values__.length,l=o?t:this.__values__[this.__index__++];return{done:o,value:l}}function V9(){return this}function B9(o){for(var l,f=this;f instanceof Kl;){var m=N_(f);m.__index__=0,m.__values__=t,l?x.__wrapped__=m:l=m;var x=m;f=f.__wrapped__}return x.__wrapped__=o,l}function z9(){var o=this.__wrapped__;if(o instanceof Le){var l=o;return this.__actions__.length&&(l=new Le(this)),l=l.reverse(),l.__actions__.push({func:hu,args:[Pg],thisArg:t}),new zr(l,this.__chain__)}return this.thru(Pg)}function H9(){return o_(this.__wrapped__,this.__actions__)}var W9=nu(function(o,l,f){qe.call(o,f)?++o[f]:Hn(o,f,1)});function U9(o,l,f){var m=Ce(o)?bx:j7;return f&&rr(o,l,f)&&(l=t),m(o,me(l,3))}function $9(o,l){var f=Ce(o)?pi:Wx;return f(o,me(l,3))}var Y9=v_(R_),X9=v_(V_);function G9(o,l){return zt(du(o,l),1)}function q9(o,l){return zt(du(o,l),ue)}function K9(o,l,f){return f=f===t?1:Ie(f),zt(du(o,l),f)}function $_(o,l){var f=Ce(o)?Vr:bi;return f(o,me(l,3))}function Y_(o,l){var f=Ce(o)?p6:Hx;return f(o,me(l,3))}var Z9=nu(function(o,l,f){qe.call(o,f)?o[f].push(l):Hn(o,f,[l])});function J9(o,l,f,m){o=dr(o)?o:ho(o),f=f&&!m?Ie(f):0;var x=o.length;return f<0&&(f=jt(x+f,0)),vu(o)?f<=x&&o.indexOf(l,f)>-1:!!x&&Qs(o,l,f)>-1}var Q9=Me(function(o,l,f){var m=-1,x=typeof l=="function",E=dr(o)?Y(o.length):[];return bi(o,function(O){E[++m]=x?Tr(l,O,f):Ca(O,l,f)}),E}),ej=nu(function(o,l,f){Hn(o,f,l)});function du(o,l){var f=Ce(o)?ct:qx;return f(o,me(l,3))}function tj(o,l,f,m){return o==null?[]:(Ce(l)||(l=l==null?[]:[l]),f=m?t:f,Ce(f)||(f=f==null?[]:[f]),Qx(o,l,f))}var rj=nu(function(o,l,f){o[f?0:1].push(l)},function(){return[[],[]]});function nj(o,l,f){var m=Ce(o)?$f:Sx,x=arguments.length<3;return m(o,me(l,4),f,x,bi)}function ij(o,l,f){var m=Ce(o)?m6:Sx,x=arguments.length<3;return m(o,me(l,4),f,x,Hx)}function sj(o,l){var f=Ce(o)?pi:Wx;return f(o,pu(me(l,3)))}function oj(o){var l=Ce(o)?Rx:J7;return l(o)}function aj(o,l,f){(f?rr(o,l,f):l===t)?l=1:l=Ie(l);var m=Ce(o)?A7:Q7;return m(o,l)}function cj(o){var l=Ce(o)?M7:t8;return l(o)}function lj(o){if(o==null)return 0;if(dr(o))return vu(o)?to(o):o.length;var l=Xt(o);return l==rt||l==P?o.size:ug(o).length}function uj(o,l,f){var m=Ce(o)?Yf:r8;return f&&rr(o,l,f)&&(l=t),m(o,me(l,3))}var hj=Me(function(o,l){if(o==null)return[];var f=l.length;return f>1&&rr(o,l[0],l[1])?l=[]:f>2&&rr(l[0],l[1],l[2])&&(l=[l[0]]),Qx(o,zt(l,1),[])}),fu=$6||function(){return Bt.Date.now()};function dj(o,l){if(typeof l!="function")throw new Br(a);return o=Ie(o),function(){if(--o<1)return l.apply(this,arguments)}}function X_(o,l,f){return l=f?t:l,l=o&&l==null?o.length:l,Wn(o,H,t,t,t,t,l)}function G_(o,l){var f;if(typeof l!="function")throw new Br(a);return o=Ie(o),function(){return--o>0&&(f=l.apply(this,arguments)),o<=1&&(l=t),f}}var jg=Me(function(o,l,f){var m=S;if(f.length){var x=vi(f,lo(jg));m|=L}return Wn(o,m,l,f,x)}),q_=Me(function(o,l,f){var m=S|T;if(f.length){var x=vi(f,lo(q_));m|=L}return Wn(l,m,o,f,x)});function K_(o,l,f){l=f?t:l;var m=Wn(o,I,t,t,t,t,t,l);return m.placeholder=K_.placeholder,m}function Z_(o,l,f){l=f?t:l;var m=Wn(o,M,t,t,t,t,t,l);return m.placeholder=Z_.placeholder,m}function J_(o,l,f){var m,x,E,O,D,B,Z=0,J=!1,ee=!1,ae=!0;if(typeof o!="function")throw new Br(a);l=$r(l)||0,dt(f)&&(J=!!f.leading,ee="maxWait"in f,E=ee?jt($r(f.maxWait)||0,l):E,ae="trailing"in f?!!f.trailing:ae);function ge(St){var an=m,Gn=x;return m=x=t,Z=St,O=o.apply(Gn,an),O}function ve(St){return Z=St,D=Aa(De,l),J?ge(St):O}function Ae(St){var an=St-B,Gn=St-Z,v2=l-an;return ee?Yt(v2,E-Gn):v2}function ye(St){var an=St-B,Gn=St-Z;return B===t||an>=l||an<0||ee&&Gn>=E}function De(){var St=fu();if(ye(St))return Ne(St);D=Aa(De,Ae(St))}function Ne(St){return D=t,ae&&m?ge(St):(m=x=t,O)}function Ar(){D!==t&&c_(D),Z=0,m=B=x=D=t}function nr(){return D===t?O:Ne(fu())}function Mr(){var St=fu(),an=ye(St);if(m=arguments,x=this,B=St,an){if(D===t)return ve(B);if(ee)return c_(D),D=Aa(De,l),ge(B)}return D===t&&(D=Aa(De,l)),O}return Mr.cancel=Ar,Mr.flush=nr,Mr}var fj=Me(function(o,l){return zx(o,1,l)}),gj=Me(function(o,l,f){return zx(o,$r(l)||0,f)});function pj(o){return Wn(o,X)}function gu(o,l){if(typeof o!="function"||l!=null&&typeof l!="function")throw new Br(a);var f=function(){var m=arguments,x=l?l.apply(this,m):m[0],E=f.cache;if(E.has(x))return E.get(x);var O=o.apply(this,m);return f.cache=E.set(x,O)||E,O};return f.cache=new(gu.Cache||zn),f}gu.Cache=zn;function pu(o){if(typeof o!="function")throw new Br(a);return function(){var l=arguments;switch(l.length){case 0:return!o.call(this);case 1:return!o.call(this,l[0]);case 2:return!o.call(this,l[0],l[1]);case 3:return!o.call(this,l[0],l[1],l[2])}return!o.apply(this,l)}}function mj(o){return G_(2,o)}var vj=n8(function(o,l){l=l.length==1&&Ce(l[0])?ct(l[0],Er(me())):ct(zt(l,1),Er(me()));var f=l.length;return Me(function(m){for(var x=-1,E=Yt(m.length,f);++x<E;)m[x]=l[x].call(this,m[x]);return Tr(o,this,m)})}),Lg=Me(function(o,l){var f=vi(l,lo(Lg));return Wn(o,L,t,l,f)}),Q_=Me(function(o,l){var f=vi(l,lo(Q_));return Wn(o,N,t,l,f)}),yj=Un(function(o,l){return Wn(o,R,t,t,t,l)});function bj(o,l){if(typeof o!="function")throw new Br(a);return l=l===t?l:Ie(l),Me(o,l)}function wj(o,l){if(typeof o!="function")throw new Br(a);return l=l==null?0:jt(Ie(l),0),Me(function(f){var m=f[l],x=_i(f,0,l);return m&&mi(x,m),Tr(o,this,x)})}function xj(o,l,f){var m=!0,x=!0;if(typeof o!="function")throw new Br(a);return dt(f)&&(m="leading"in f?!!f.leading:m,x="trailing"in f?!!f.trailing:x),J_(o,l,{leading:m,maxWait:l,trailing:x})}function _j(o){return X_(o,1)}function Sj(o,l){return Lg(bg(l),o)}function Cj(){if(!arguments.length)return[];var o=arguments[0];return Ce(o)?o:[o]}function Tj(o){return Hr(o,y)}function Ej(o,l){return l=typeof l=="function"?l:t,Hr(o,y,l)}function kj(o){return Hr(o,g|y)}function Ij(o,l){return l=typeof l=="function"?l:t,Hr(o,g|y,l)}function Aj(o,l){return l==null||Bx(o,l,Ft(l))}function on(o,l){return o===l||o!==o&&l!==l}var Mj=au(ag),Oj=au(function(o,l){return o>=l}),hs=Yx(function(){return arguments}())?Yx:function(o){return yt(o)&&qe.call(o,"callee")&&!Px.call(o,"callee")},Ce=Y.isArray,Pj=fx?Er(fx):B7;function dr(o){return o!=null&&mu(o.length)&&!Yn(o)}function _t(o){return yt(o)&&dr(o)}function Dj(o){return o===!0||o===!1||yt(o)&&tr(o)==ar}var Si=X6||Yg,jj=gx?Er(gx):z7;function Lj(o){return yt(o)&&o.nodeType===1&&!Ma(o)}function Fj(o){if(o==null)return!0;if(dr(o)&&(Ce(o)||typeof o=="string"||typeof o.splice=="function"||Si(o)||uo(o)||hs(o)))return!o.length;var l=Xt(o);if(l==rt||l==P)return!o.size;if(Ia(o))return!ug(o).length;for(var f in o)if(qe.call(o,f))return!1;return!0}function Nj(o,l){return Ta(o,l)}function Rj(o,l,f){f=typeof f=="function"?f:t;var m=f?f(o,l):t;return m===t?Ta(o,l,t,f):!!m}function Fg(o){if(!yt(o))return!1;var l=tr(o);return l==cr||l==Ot||typeof o.message=="string"&&typeof o.name=="string"&&!Ma(o)}function Vj(o){return typeof o=="number"&&jx(o)}function Yn(o){if(!dt(o))return!1;var l=tr(o);return l==pe||l==xr||l==ht||l==Vn}function e2(o){return typeof o=="number"&&o==Ie(o)}function mu(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=oe}function dt(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}function yt(o){return o!=null&&typeof o=="object"}var t2=px?Er(px):W7;function Bj(o,l){return o===l||lg(o,l,Eg(l))}function zj(o,l,f){return f=typeof f=="function"?f:t,lg(o,l,Eg(l),f)}function Hj(o){return r2(o)&&o!=+o}function Wj(o){if(E8(o))throw new Se(s);return Xx(o)}function Uj(o){return o===null}function $j(o){return o==null}function r2(o){return typeof o=="number"||yt(o)&&tr(o)==Lt}function Ma(o){if(!yt(o)||tr(o)!=Qe)return!1;var l=Wl(o);if(l===null)return!0;var f=qe.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&Vl.call(f)==z6}var Ng=mx?Er(mx):U7;function Yj(o){return e2(o)&&o>=-9007199254740991&&o<=oe}var n2=vx?Er(vx):$7;function vu(o){return typeof o=="string"||!Ce(o)&&yt(o)&&tr(o)==le}function Ir(o){return typeof o=="symbol"||yt(o)&&tr(o)==ce}var uo=yx?Er(yx):Y7;function Xj(o){return o===t}function Gj(o){return yt(o)&&Xt(o)==Ke}function qj(o){return yt(o)&&tr(o)==$e}var Kj=au(hg),Zj=au(function(o,l){return o<=l});function i2(o){if(!o)return[];if(dr(o))return vu(o)?nn(o):hr(o);if(va&&o[va])return A6(o[va]());var l=Xt(o),f=l==rt?Jf:l==P?Fl:ho;return f(o)}function Xn(o){if(!o)return o===0?o:0;if(o=$r(o),o===ue||o===-1/0){var l=o<0?-1:1;return l*se}return o===o?o:0}function Ie(o){var l=Xn(o),f=l%1;return l===l?f?l-f:l:0}function s2(o){return o?as(Ie(o),0,ne):0}function $r(o){if(typeof o=="number")return o;if(Ir(o))return de;if(dt(o)){var l=typeof o.valueOf=="function"?o.valueOf():o;o=dt(l)?l+"":l}if(typeof o!="string")return o===0?o:+o;o=Cx(o);var f=PD.test(o);return f||jD.test(o)?d6(o.slice(2),f?2:8):OD.test(o)?de:+o}function o2(o){return xn(o,fr(o))}function Jj(o){return o?as(Ie(o),-9007199254740991,oe):o===0?o:0}function Ye(o){return o==null?"":kr(o)}var Qj=ao(function(o,l){if(Ia(l)||dr(l)){xn(l,Ft(l),o);return}for(var f in l)qe.call(l,f)&&_a(o,f,l[f])}),a2=ao(function(o,l){xn(l,fr(l),o)}),yu=ao(function(o,l,f,m){xn(l,fr(l),o,m)}),eL=ao(function(o,l,f,m){xn(l,Ft(l),o,m)}),tL=Un(ig);function rL(o,l){var f=oo(o);return l==null?f:Vx(f,l)}var nL=Me(function(o,l){o=Je(o);var f=-1,m=l.length,x=m>2?l[2]:t;for(x&&rr(l[0],l[1],x)&&(m=1);++f<m;)for(var E=l[f],O=fr(E),D=-1,B=O.length;++D<B;){var Z=O[D],J=o[Z];(J===t||on(J,no[Z])&&!qe.call(o,Z))&&(o[Z]=E[Z])}return o}),iL=Me(function(o){return o.push(t,C_),Tr(c2,t,o)});function sL(o,l){return wx(o,me(l,3),wn)}function oL(o,l){return wx(o,me(l,3),og)}function aL(o,l){return o==null?o:sg(o,me(l,3),fr)}function cL(o,l){return o==null?o:Ux(o,me(l,3),fr)}function lL(o,l){return o&&wn(o,me(l,3))}function uL(o,l){return o&&og(o,me(l,3))}function hL(o){return o==null?[]:Ql(o,Ft(o))}function dL(o){return o==null?[]:Ql(o,fr(o))}function Rg(o,l,f){var m=o==null?t:cs(o,l);return m===t?f:m}function fL(o,l){return o!=null&&k_(o,l,F7)}function Vg(o,l){return o!=null&&k_(o,l,N7)}var gL=b_(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=Bl.call(l)),o[l]=f},zg(gr)),pL=b_(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=Bl.call(l)),qe.call(o,l)?o[l].push(f):o[l]=[f]},me),mL=Me(Ca);function Ft(o){return dr(o)?Nx(o):ug(o)}function fr(o){return dr(o)?Nx(o,!0):X7(o)}function vL(o,l){var f={};return l=me(l,3),wn(o,function(m,x,E){Hn(f,l(m,x,E),m)}),f}function yL(o,l){var f={};return l=me(l,3),wn(o,function(m,x,E){Hn(f,x,l(m,x,E))}),f}var bL=ao(function(o,l,f){eu(o,l,f)}),c2=ao(function(o,l,f,m){eu(o,l,f,m)}),wL=Un(function(o,l){var f={};if(o==null)return f;var m=!1;l=ct(l,function(E){return E=xi(E,o),m||(m=E.length>1),E}),xn(o,Cg(o),f),m&&(f=Hr(f,g|p|y,g8));for(var x=l.length;x--;)mg(f,l[x]);return f});function xL(o,l){return l2(o,pu(me(l)))}var _L=Un(function(o,l){return o==null?{}:q7(o,l)});function l2(o,l){if(o==null)return{};var f=ct(Cg(o),function(m){return[m]});return l=me(l),e_(o,f,function(m,x){return l(m,x[0])})}function SL(o,l,f){l=xi(l,o);var m=-1,x=l.length;for(x||(x=1,o=t);++m<x;){var E=o==null?t:o[_n(l[m])];E===t&&(m=x,E=f),o=Yn(E)?E.call(o):E}return o}function CL(o,l,f){return o==null?o:Ea(o,l,f)}function TL(o,l,f,m){return m=typeof m=="function"?m:t,o==null?o:Ea(o,l,f,m)}var u2=__(Ft),h2=__(fr);function EL(o,l,f){var m=Ce(o),x=m||Si(o)||uo(o);if(l=me(l,4),f==null){var E=o&&o.constructor;x?f=m?new E:[]:dt(o)?f=Yn(E)?oo(Wl(o)):{}:f={}}return(x?Vr:wn)(o,function(O,D,B){return l(f,O,D,B)}),f}function kL(o,l){return o==null?!0:mg(o,l)}function IL(o,l,f){return o==null?o:s_(o,l,bg(f))}function AL(o,l,f,m){return m=typeof m=="function"?m:t,o==null?o:s_(o,l,bg(f),m)}function ho(o){return o==null?[]:Zf(o,Ft(o))}function ML(o){return o==null?[]:Zf(o,fr(o))}function OL(o,l,f){return f===t&&(f=l,l=t),f!==t&&(f=$r(f),f=f===f?f:0),l!==t&&(l=$r(l),l=l===l?l:0),as($r(o),l,f)}function PL(o,l,f){return l=Xn(l),f===t?(f=l,l=0):f=Xn(f),o=$r(o),R7(o,l,f)}function DL(o,l,f){if(f&&typeof f!="boolean"&&rr(o,l,f)&&(l=f=t),f===t&&(typeof l=="boolean"?(f=l,l=t):typeof o=="boolean"&&(f=o,o=t)),o===t&&l===t?(o=0,l=1):(o=Xn(o),l===t?(l=o,o=0):l=Xn(l)),o>l){var m=o;o=l,l=m}if(f||o%1||l%1){var x=Lx();return Yt(o+x*(l-o+h6("1e-"+((x+"").length-1))),l)}return fg(o,l)}var jL=co(function(o,l,f){return l=l.toLowerCase(),o+(f?d2(l):l)});function d2(o){return Bg(Ye(o).toLowerCase())}function f2(o){return o=Ye(o),o&&o.replace(FD,C6).replace(t6,"")}function LL(o,l,f){o=Ye(o),l=kr(l);var m=o.length;f=f===t?m:as(Ie(f),0,m);var x=f;return f-=l.length,f>=0&&o.slice(f,x)==l}function FL(o){return o=Ye(o),o&&Hw.test(o)?o.replace(rs,T6):o}function NL(o){return o=Ye(o),o&&Cr.test(o)?o.replace(Be,"\\$&"):o}var RL=co(function(o,l,f){return o+(f?"-":"")+l.toLowerCase()}),VL=co(function(o,l,f){return o+(f?" ":"")+l.toLowerCase()}),BL=m_("toLowerCase");function zL(o,l,f){o=Ye(o),l=Ie(l);var m=l?to(o):0;if(!l||m>=l)return o;var x=(l-m)/2;return ou(Xl(x),f)+o+ou(Yl(x),f)}function HL(o,l,f){o=Ye(o),l=Ie(l);var m=l?to(o):0;return l&&m<l?o+ou(l-m,f):o}function WL(o,l,f){o=Ye(o),l=Ie(l);var m=l?to(o):0;return l&&m<l?ou(l-m,f)+o:o}function UL(o,l,f){return f||l==null?l=0:l&&(l=+l),Z6(Ye(o).replace(bn,""),l||0)}function $L(o,l,f){return(f?rr(o,l,f):l===t)?l=1:l=Ie(l),gg(Ye(o),l)}function YL(){var o=arguments,l=Ye(o[0]);return o.length<3?l:l.replace(o[1],o[2])}var XL=co(function(o,l,f){return o+(f?"_":"")+l.toLowerCase()});function GL(o,l,f){return f&&typeof f!="number"&&rr(o,l,f)&&(l=f=t),f=f===t?ne:f>>>0,f?(o=Ye(o),o&&(typeof l=="string"||l!=null&&!Ng(l))&&(l=kr(l),!l&&eo(o))?_i(nn(o),0,f):o.split(l,f)):[]}var qL=co(function(o,l,f){return o+(f?" ":"")+Bg(l)});function KL(o,l,f){return o=Ye(o),f=f==null?0:as(Ie(f),0,o.length),l=kr(l),o.slice(f,f+l.length)==l}function ZL(o,l,f){var m=C.templateSettings;f&&rr(o,l,f)&&(l=t),o=Ye(o),l=yu({},l,m,S_);var x=yu({},l.imports,m.imports,S_),E=Ft(x),O=Zf(x,E),D,B,Z=0,J=l.interpolate||Ol,ee="__p += '",ae=Qf((l.escape||Ol).source+"|"+J.source+"|"+(J===Lf?MD:Ol).source+"|"+(l.evaluate||Ol).source+"|$","g"),ge="//# sourceURL="+(qe.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++o6+"]")+`
`;o.replace(ae,function(ye,De,Ne,Ar,nr,Mr){return Ne||(Ne=Ar),ee+=o.slice(Z,Mr).replace(ND,E6),De&&(D=!0,ee+=`' +
__e(`+De+`) +
'`),nr&&(B=!0,ee+=`';
`+nr+`;
__p += '`),Ne&&(ee+=`' +
((__t = (`+Ne+`)) == null ? '' : __t) +
'`),Z=Mr+ye.length,ye}),ee+=`';
`;var ve=qe.call(l,"variable")&&l.variable;if(!ve)ee=`with (obj) {
`+ee+`
}
`;else if(ID.test(ve))throw new Se(c);ee=(B?ee.replace(Ks,""):ee).replace(Zs,"$1").replace(jf,"$1;"),ee="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(D?", __e = _.escape":"")+(B?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ee+`return __p
}`;var Ae=p2(function(){return We(E,ge+"return "+ee).apply(t,O)});if(Ae.source=ee,Fg(Ae))throw Ae;return Ae}function JL(o){return Ye(o).toLowerCase()}function QL(o){return Ye(o).toUpperCase()}function eF(o,l,f){if(o=Ye(o),o&&(f||l===t))return Cx(o);if(!o||!(l=kr(l)))return o;var m=nn(o),x=nn(l),E=Tx(m,x),O=Ex(m,x)+1;return _i(m,E,O).join("")}function tF(o,l,f){if(o=Ye(o),o&&(f||l===t))return o.slice(0,Ix(o)+1);if(!o||!(l=kr(l)))return o;var m=nn(o),x=Ex(m,nn(l))+1;return _i(m,0,x).join("")}function rF(o,l,f){if(o=Ye(o),o&&(f||l===t))return o.replace(bn,"");if(!o||!(l=kr(l)))return o;var m=nn(o),x=Tx(m,nn(l));return _i(m,x).join("")}function nF(o,l){var f=U,m=K;if(dt(l)){var x="separator"in l?l.separator:x;f="length"in l?Ie(l.length):f,m="omission"in l?kr(l.omission):m}o=Ye(o);var E=o.length;if(eo(o)){var O=nn(o);E=O.length}if(f>=E)return o;var D=f-to(m);if(D<1)return m;var B=O?_i(O,0,D).join(""):o.slice(0,D);if(x===t)return B+m;if(O&&(D+=B.length-D),Ng(x)){if(o.slice(D).search(x)){var Z,J=B;for(x.global||(x=Qf(x.source,Ye(Yw.exec(x))+"g")),x.lastIndex=0;Z=x.exec(J);)var ee=Z.index;B=B.slice(0,ee===t?D:ee)}}else if(o.indexOf(kr(x),D)!=D){var ae=B.lastIndexOf(x);ae>-1&&(B=B.slice(0,ae))}return B+m}function iF(o){return o=Ye(o),o&&Al.test(o)?o.replace(Il,D6):o}var sF=co(function(o,l,f){return o+(f?" ":"")+l.toUpperCase()}),Bg=m_("toUpperCase");function g2(o,l,f){return o=Ye(o),l=f?t:l,l===t?I6(o)?F6(o):b6(o):o.match(l)||[]}var p2=Me(function(o,l){try{return Tr(o,t,l)}catch(f){return Fg(f)?f:new Se(f)}}),oF=Un(function(o,l){return Vr(l,function(f){f=_n(f),Hn(o,f,jg(o[f],o))}),o});function aF(o){var l=o==null?0:o.length,f=me();return o=l?ct(o,function(m){if(typeof m[1]!="function")throw new Br(a);return[f(m[0]),m[1]]}):[],Me(function(m){for(var x=-1;++x<l;){var E=o[x];if(Tr(E[0],this,m))return Tr(E[1],this,m)}})}function cF(o){return D7(Hr(o,g))}function zg(o){return function(){return o}}function lF(o,l){return o==null||o!==o?l:o}var uF=y_(),hF=y_(!0);function gr(o){return o}function Hg(o){return Gx(typeof o=="function"?o:Hr(o,g))}function dF(o){return Kx(Hr(o,g))}function fF(o,l){return Zx(o,Hr(l,g))}var gF=Me(function(o,l){return function(f){return Ca(f,o,l)}}),pF=Me(function(o,l){return function(f){return Ca(o,f,l)}});function Wg(o,l,f){var m=Ft(l),x=Ql(l,m);f==null&&!(dt(l)&&(x.length||!m.length))&&(f=l,l=o,o=this,x=Ql(l,Ft(l)));var E=!(dt(f)&&"chain"in f)||!!f.chain,O=Yn(o);return Vr(x,function(D){var B=l[D];o[D]=B,O&&(o.prototype[D]=function(){var Z=this.__chain__;if(E||Z){var J=o(this.__wrapped__),ee=J.__actions__=hr(this.__actions__);return ee.push({func:B,args:arguments,thisArg:o}),J.__chain__=Z,J}return B.apply(o,mi([this.value()],arguments))})}),o}function mF(){return Bt._===this&&(Bt._=H6),this}function Ug(){}function vF(o){return o=Ie(o),Me(function(l){return Jx(l,o)})}var yF=xg(ct),bF=xg(bx),wF=xg(Yf);function m2(o){return Ig(o)?Xf(_n(o)):K7(o)}function xF(o){return function(l){return o==null?t:cs(o,l)}}var _F=w_(),SF=w_(!0);function $g(){return[]}function Yg(){return!1}function CF(){return{}}function TF(){return""}function EF(){return!0}function kF(o,l){if(o=Ie(o),o<1||o>oe)return[];var f=ne,m=Yt(o,ne);l=me(l),o-=ne;for(var x=Kf(m,l);++f<o;)l(f);return x}function IF(o){return Ce(o)?ct(o,_n):Ir(o)?[o]:hr(F_(Ye(o)))}function AF(o){var l=++B6;return Ye(o)+l}var MF=su(function(o,l){return o+l},0),OF=_g("ceil"),PF=su(function(o,l){return o/l},1),DF=_g("floor");function jF(o){return o&&o.length?Jl(o,gr,ag):t}function LF(o,l){return o&&o.length?Jl(o,me(l,2),ag):t}function FF(o){return _x(o,gr)}function NF(o,l){return _x(o,me(l,2))}function RF(o){return o&&o.length?Jl(o,gr,hg):t}function VF(o,l){return o&&o.length?Jl(o,me(l,2),hg):t}var BF=su(function(o,l){return o*l},1),zF=_g("round"),HF=su(function(o,l){return o-l},0);function WF(o){return o&&o.length?qf(o,gr):0}function UF(o,l){return o&&o.length?qf(o,me(l,2)):0}return C.after=dj,C.ary=X_,C.assign=Qj,C.assignIn=a2,C.assignInWith=yu,C.assignWith=eL,C.at=tL,C.before=G_,C.bind=jg,C.bindAll=oF,C.bindKey=q_,C.castArray=Cj,C.chain=U_,C.chunk=D8,C.compact=j8,C.concat=L8,C.cond=aF,C.conforms=cF,C.constant=zg,C.countBy=W9,C.create=rL,C.curry=K_,C.curryRight=Z_,C.debounce=J_,C.defaults=nL,C.defaultsDeep=iL,C.defer=fj,C.delay=gj,C.difference=F8,C.differenceBy=N8,C.differenceWith=R8,C.drop=V8,C.dropRight=B8,C.dropRightWhile=z8,C.dropWhile=H8,C.fill=W8,C.filter=$9,C.flatMap=G9,C.flatMapDeep=q9,C.flatMapDepth=K9,C.flatten=B_,C.flattenDeep=U8,C.flattenDepth=$8,C.flip=pj,C.flow=uF,C.flowRight=hF,C.fromPairs=Y8,C.functions=hL,C.functionsIn=dL,C.groupBy=Z9,C.initial=G8,C.intersection=q8,C.intersectionBy=K8,C.intersectionWith=Z8,C.invert=gL,C.invertBy=pL,C.invokeMap=Q9,C.iteratee=Hg,C.keyBy=ej,C.keys=Ft,C.keysIn=fr,C.map=du,C.mapKeys=vL,C.mapValues=yL,C.matches=dF,C.matchesProperty=fF,C.memoize=gu,C.merge=bL,C.mergeWith=c2,C.method=gF,C.methodOf=pF,C.mixin=Wg,C.negate=pu,C.nthArg=vF,C.omit=wL,C.omitBy=xL,C.once=mj,C.orderBy=tj,C.over=yF,C.overArgs=vj,C.overEvery=bF,C.overSome=wF,C.partial=Lg,C.partialRight=Q_,C.partition=rj,C.pick=_L,C.pickBy=l2,C.property=m2,C.propertyOf=xF,C.pull=t9,C.pullAll=H_,C.pullAllBy=r9,C.pullAllWith=n9,C.pullAt=i9,C.range=_F,C.rangeRight=SF,C.rearg=yj,C.reject=sj,C.remove=s9,C.rest=bj,C.reverse=Pg,C.sampleSize=aj,C.set=CL,C.setWith=TL,C.shuffle=cj,C.slice=o9,C.sortBy=hj,C.sortedUniq=f9,C.sortedUniqBy=g9,C.split=GL,C.spread=wj,C.tail=p9,C.take=m9,C.takeRight=v9,C.takeRightWhile=y9,C.takeWhile=b9,C.tap=j9,C.throttle=xj,C.thru=hu,C.toArray=i2,C.toPairs=u2,C.toPairsIn=h2,C.toPath=IF,C.toPlainObject=o2,C.transform=EL,C.unary=_j,C.union=w9,C.unionBy=x9,C.unionWith=_9,C.uniq=S9,C.uniqBy=C9,C.uniqWith=T9,C.unset=kL,C.unzip=Dg,C.unzipWith=W_,C.update=IL,C.updateWith=AL,C.values=ho,C.valuesIn=ML,C.without=E9,C.words=g2,C.wrap=Sj,C.xor=k9,C.xorBy=I9,C.xorWith=A9,C.zip=M9,C.zipObject=O9,C.zipObjectDeep=P9,C.zipWith=D9,C.entries=u2,C.entriesIn=h2,C.extend=a2,C.extendWith=yu,Wg(C,C),C.add=MF,C.attempt=p2,C.camelCase=jL,C.capitalize=d2,C.ceil=OF,C.clamp=OL,C.clone=Tj,C.cloneDeep=kj,C.cloneDeepWith=Ij,C.cloneWith=Ej,C.conformsTo=Aj,C.deburr=f2,C.defaultTo=lF,C.divide=PF,C.endsWith=LL,C.eq=on,C.escape=FL,C.escapeRegExp=NL,C.every=U9,C.find=Y9,C.findIndex=R_,C.findKey=sL,C.findLast=X9,C.findLastIndex=V_,C.findLastKey=oL,C.floor=DF,C.forEach=$_,C.forEachRight=Y_,C.forIn=aL,C.forInRight=cL,C.forOwn=lL,C.forOwnRight=uL,C.get=Rg,C.gt=Mj,C.gte=Oj,C.has=fL,C.hasIn=Vg,C.head=z_,C.identity=gr,C.includes=J9,C.indexOf=X8,C.inRange=PL,C.invoke=mL,C.isArguments=hs,C.isArray=Ce,C.isArrayBuffer=Pj,C.isArrayLike=dr,C.isArrayLikeObject=_t,C.isBoolean=Dj,C.isBuffer=Si,C.isDate=jj,C.isElement=Lj,C.isEmpty=Fj,C.isEqual=Nj,C.isEqualWith=Rj,C.isError=Fg,C.isFinite=Vj,C.isFunction=Yn,C.isInteger=e2,C.isLength=mu,C.isMap=t2,C.isMatch=Bj,C.isMatchWith=zj,C.isNaN=Hj,C.isNative=Wj,C.isNil=$j,C.isNull=Uj,C.isNumber=r2,C.isObject=dt,C.isObjectLike=yt,C.isPlainObject=Ma,C.isRegExp=Ng,C.isSafeInteger=Yj,C.isSet=n2,C.isString=vu,C.isSymbol=Ir,C.isTypedArray=uo,C.isUndefined=Xj,C.isWeakMap=Gj,C.isWeakSet=qj,C.join=J8,C.kebabCase=RL,C.last=Ur,C.lastIndexOf=Q8,C.lowerCase=VL,C.lowerFirst=BL,C.lt=Kj,C.lte=Zj,C.max=jF,C.maxBy=LF,C.mean=FF,C.meanBy=NF,C.min=RF,C.minBy=VF,C.stubArray=$g,C.stubFalse=Yg,C.stubObject=CF,C.stubString=TF,C.stubTrue=EF,C.multiply=BF,C.nth=e9,C.noConflict=mF,C.noop=Ug,C.now=fu,C.pad=zL,C.padEnd=HL,C.padStart=WL,C.parseInt=UL,C.random=DL,C.reduce=nj,C.reduceRight=ij,C.repeat=$L,C.replace=YL,C.result=SL,C.round=zF,C.runInContext=V,C.sample=oj,C.size=lj,C.snakeCase=XL,C.some=uj,C.sortedIndex=a9,C.sortedIndexBy=c9,C.sortedIndexOf=l9,C.sortedLastIndex=u9,C.sortedLastIndexBy=h9,C.sortedLastIndexOf=d9,C.startCase=qL,C.startsWith=KL,C.subtract=HF,C.sum=WF,C.sumBy=UF,C.template=ZL,C.times=kF,C.toFinite=Xn,C.toInteger=Ie,C.toLength=s2,C.toLower=JL,C.toNumber=$r,C.toSafeInteger=Jj,C.toString=Ye,C.toUpper=QL,C.trim=eF,C.trimEnd=tF,C.trimStart=rF,C.truncate=nF,C.unescape=iF,C.uniqueId=AF,C.upperCase=sF,C.upperFirst=Bg,C.each=$_,C.eachRight=Y_,C.first=z_,Wg(C,function(){var o={};return wn(C,function(l,f){qe.call(C.prototype,f)||(o[f]=l)}),o}(),{chain:!1}),C.VERSION=n,Vr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){C[o].placeholder=C}),Vr(["drop","take"],function(o,l){Le.prototype[o]=function(f){f=f===t?1:jt(Ie(f),0);var m=this.__filtered__&&!l?new Le(this):this.clone();return m.__filtered__?m.__takeCount__=Yt(f,m.__takeCount__):m.__views__.push({size:Yt(f,ne),type:o+(m.__dir__<0?"Right":"")}),m},Le.prototype[o+"Right"]=function(f){return this.reverse()[o](f).reverse()}}),Vr(["filter","map","takeWhile"],function(o,l){var f=l+1,m=f==re||f==Q;Le.prototype[o]=function(x){var E=this.clone();return E.__iteratees__.push({iteratee:me(x,3),type:f}),E.__filtered__=E.__filtered__||m,E}}),Vr(["head","last"],function(o,l){var f="take"+(l?"Right":"");Le.prototype[o]=function(){return this[f](1).value()[0]}}),Vr(["initial","tail"],function(o,l){var f="drop"+(l?"":"Right");Le.prototype[o]=function(){return this.__filtered__?new Le(this):this[f](1)}}),Le.prototype.compact=function(){return this.filter(gr)},Le.prototype.find=function(o){return this.filter(o).head()},Le.prototype.findLast=function(o){return this.reverse().find(o)},Le.prototype.invokeMap=Me(function(o,l){return typeof o=="function"?new Le(this):this.map(function(f){return Ca(f,o,l)})}),Le.prototype.reject=function(o){return this.filter(pu(me(o)))},Le.prototype.slice=function(o,l){o=Ie(o);var f=this;return f.__filtered__&&(o>0||l<0)?new Le(f):(o<0?f=f.takeRight(-o):o&&(f=f.drop(o)),l!==t&&(l=Ie(l),f=l<0?f.dropRight(-l):f.take(l-o)),f)},Le.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},Le.prototype.toArray=function(){return this.take(ne)},wn(Le.prototype,function(o,l){var f=/^(?:filter|find|map|reject)|While$/.test(l),m=/^(?:head|last)$/.test(l),x=C[m?"take"+(l=="last"?"Right":""):l],E=m||/^find/.test(l);x&&(C.prototype[l]=function(){var O=this.__wrapped__,D=m?[1]:arguments,B=O instanceof Le,Z=D[0],J=B||Ce(O),ee=function(De){var Ne=x.apply(C,mi([De],D));return m&&ae?Ne[0]:Ne};J&&f&&typeof Z=="function"&&Z.length!=1&&(B=J=!1);var ae=this.__chain__,ge=!!this.__actions__.length,ve=E&&!ae,Ae=B&&!ge;if(!E&&J){O=Ae?O:new Le(this);var ye=o.apply(O,D);return ye.__actions__.push({func:hu,args:[ee],thisArg:t}),new zr(ye,ae)}return ve&&Ae?o.apply(this,D):(ye=this.thru(ee),ve?m?ye.value()[0]:ye.value():ye)})}),Vr(["pop","push","shift","sort","splice","unshift"],function(o){var l=Nl[o],f=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",m=/^(?:pop|shift)$/.test(o);C.prototype[o]=function(){var x=arguments;if(m&&!this.__chain__){var E=this.value();return l.apply(Ce(E)?E:[],x)}return this[f](function(O){return l.apply(Ce(O)?O:[],x)})}}),wn(Le.prototype,function(o,l){var f=C[l];if(f){var m=f.name+"";qe.call(so,m)||(so[m]=[]),so[m].push({name:l,func:f})}}),so[iu(t,T).name]=[{name:"wrapper",func:t}],Le.prototype.clone=i7,Le.prototype.reverse=s7,Le.prototype.value=o7,C.prototype.at=L9,C.prototype.chain=F9,C.prototype.commit=N9,C.prototype.next=R9,C.prototype.plant=B9,C.prototype.reverse=z9,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=H9,C.prototype.first=C.prototype.head,va&&(C.prototype[va]=V9),C},ro=N6();ns?((ns.exports=ro)._=ro,Hf._=ro):Bt._=ro}).call(fo)}(pc,pc.exports);var He=pc.exports;const gA=()=>{const{trackItemIds:r,trackItemsMap:e,fps:t,trackItemDetailsMap:n}=hn(),i=He.merge(e,n);return b.jsx(b.Fragment,{children:r.map(s=>{const a=i[s];return Dv[a.type](a,{fps:t})})})};var jv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var s="",a=0;a<arguments.length;a++){var c=arguments[a];c&&(s=i(s,n(c)))}return s}function n(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var c in s)e.call(s,c)&&s[c]&&(a=i(a,c));return a}function i(s,a){return a?s?s+" "+a:s+a:s}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(jv);var pA=jv.exports;const Po=b2(pA),mA={asChild:{type:"boolean"}},vA={width:{type:"string",className:"rt-r-w",customProperties:["--width"],responsive:!0},minWidth:{type:"string",className:"rt-r-min-w",customProperties:["--min-width"],responsive:!0},maxWidth:{type:"string",className:"rt-r-max-w",customProperties:["--max-width"],responsive:!0}},yA={height:{type:"string",className:"rt-r-h",customProperties:["--height"],responsive:!0},minHeight:{type:"string",className:"rt-r-min-h",customProperties:["--min-height"],responsive:!0},maxHeight:{type:"string",className:"rt-r-max-h",customProperties:["--max-height"],responsive:!0}},td=["initial","xs","sm","md","lg","xl"];function Lv(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Do(r){return typeof r=="object"&&Object.keys(r).some(e=>td.includes(e))}function bA({className:r,customProperties:e,...t}){const n=Fv({allowArbitraryValues:!0,className:r,...t}),i=wA({customProperties:e,...t});return[n,i]}function Fv({allowArbitraryValues:r,value:e,className:t,propValues:n,parseValue:i=s=>s}){const s=[];if(e){if(typeof e=="string"&&n.includes(e))return Nv(t,e,i);if(Do(e)){const a=e;for(const c in a){if(!Lv(a,c)||!td.includes(c))continue;const u=a[c];if(u!==void 0){if(n.includes(u)){const h=Nv(t,u,i),d=c==="initial"?h:`${c}:${h}`;s.push(d)}else if(r){const h=c==="initial"?t:`${c}:${t}`;s.push(h)}}}return s.join(" ")}if(r)return t}}function Nv(r,e,t){const n=r?"-":"",i=t(e),s=i?.startsWith("-"),a=s?"-":"",c=s?i?.substring(1):i;return`${a}${r}${n}${c}`}function wA({customProperties:r,value:e,propValues:t,parseValue:n=i=>i}){let i={};if(!(!e||typeof e=="string"&&t.includes(e))){if(typeof e=="string"&&(i=Object.fromEntries(r.map(s=>[s,e]))),Do(e)){const s=e;for(const a in s){if(!Lv(s,a)||!td.includes(a))continue;const c=s[a];if(!t.includes(c))for(const u of r)i={[a==="initial"?u:`${u}-${a}`]:c,...i}}}for(const s in i){const a=i[s];a!==void 0&&(i[s]=n(a))}return i}}function Rv(...r){let e={};for(const t of r)t&&(e={...e,...t});return Object.keys(e).length?e:void 0}function xA(...r){return Object.assign({},...r)}function _A(r,...e){let t,n;const i={...r},s=xA(...e);for(const a in s){let c=i[a];const u=s[a];if(u.default!==void 0&&c===void 0&&(c=u.default),u.type==="enum"&&![u.default,...u.values].includes(c)&&!Do(c)&&(c=u.default),i[a]=c,"className"in u&&u.className){delete i[a];const h="responsive"in u;if(!c||Do(c)&&!h)continue;if(Do(c)&&(u.default!==void 0&&c.initial===void 0&&(c.initial=u.default),u.type==="enum"&&([u.default,...u.values].includes(c.initial)||(c.initial=u.default))),u.type==="enum"){const d=Fv({allowArbitraryValues:!1,value:c,className:u.className,propValues:u.values,parseValue:u.parseValue});t=Po(t,d);continue}if(u.type==="string"||u.type==="enum | string"){const d=u.type==="string"?[]:u.values,[g,p]=bA({className:u.className,customProperties:u.customProperties,propValues:d,parseValue:u.parseValue,value:c});n=Rv(n,p),t=Po(t,g);continue}if(u.type==="boolean"&&c){t=Po(t,u.className);continue}}}return i.className=Po(t,r.className),i.style=Rv(n,r.style),i}const Oi=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],SA={m:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-m",customProperties:["--m"]},mx:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-mx",customProperties:["--ml","--mr"]},my:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-my",customProperties:["--mt","--mb"]},mt:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-mt",customProperties:["--mt"]},mr:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-mr",customProperties:["--mr"]},mb:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-mb",customProperties:["--mb"]},ml:{type:"enum | string",values:Oi,responsive:!0,className:"rt-r-ml",customProperties:["--ml"]}},CA=E2,Pi=["0","1","2","3","4","5","6","7","8","9"],TA={p:{type:"enum | string",className:"rt-r-p",customProperties:["--p"],values:Pi,responsive:!0},px:{type:"enum | string",className:"rt-r-px",customProperties:["--pl","--pr"],values:Pi,responsive:!0},py:{type:"enum | string",className:"rt-r-py",customProperties:["--pt","--pb"],values:Pi,responsive:!0},pt:{type:"enum | string",className:"rt-r-pt",customProperties:["--pt"],values:Pi,responsive:!0},pr:{type:"enum | string",className:"rt-r-pr",customProperties:["--pr"],values:Pi,responsive:!0},pb:{type:"enum | string",className:"rt-r-pb",customProperties:["--pb"],values:Pi,responsive:!0},pl:{type:"enum | string",className:"rt-r-pl",customProperties:["--pl"],values:Pi,responsive:!0}},rd=["visible","hidden","clip","scroll","auto"],EA=["static","relative","absolute","fixed","sticky"],jo=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],kA=["0","1"],IA=["0","1"],AA={...TA,...vA,...yA,position:{type:"enum",className:"rt-r-position",values:EA,responsive:!0},inset:{type:"enum | string",className:"rt-r-inset",customProperties:["--inset"],values:jo,responsive:!0},top:{type:"enum | string",className:"rt-r-top",customProperties:["--top"],values:jo,responsive:!0},right:{type:"enum | string",className:"rt-r-right",customProperties:["--right"],values:jo,responsive:!0},bottom:{type:"enum | string",className:"rt-r-bottom",customProperties:["--bottom"],values:jo,responsive:!0},left:{type:"enum | string",className:"rt-r-left",customProperties:["--left"],values:jo,responsive:!0},overflow:{type:"enum",className:"rt-r-overflow",values:rd,responsive:!0},overflowX:{type:"enum",className:"rt-r-ox",values:rd,responsive:!0},overflowY:{type:"enum",className:"rt-r-oy",values:rd,responsive:!0},flexBasis:{type:"string",className:"rt-r-fb",customProperties:["--flex-basis"],responsive:!0},flexShrink:{type:"enum | string",className:"rt-r-fs",customProperties:["--flex-shrink"],values:kA,responsive:!0},flexGrow:{type:"enum | string",className:"rt-r-fg",customProperties:["--flex-grow"],values:IA,responsive:!0},gridArea:{type:"string",className:"rt-r-ga",customProperties:["--grid-area"],responsive:!0},gridColumn:{type:"string",className:"rt-r-gc",customProperties:["--grid-column"],responsive:!0},gridColumnStart:{type:"string",className:"rt-r-gcs",customProperties:["--grid-column-start"],responsive:!0},gridColumnEnd:{type:"string",className:"rt-r-gce",customProperties:["--grid-column-end"],responsive:!0},gridRow:{type:"string",className:"rt-r-gr",customProperties:["--grid-row"],responsive:!0},gridRowStart:{type:"string",className:"rt-r-grs",customProperties:["--grid-row-start"],responsive:!0},gridRowEnd:{type:"string",className:"rt-r-gre",customProperties:["--grid-row-end"],responsive:!0}},nd=["0","1","2","3","4","5","6","7","8","9"],MA={gap:{type:"enum | string",className:"rt-r-gap",customProperties:["--gap"],values:nd,responsive:!0},gapX:{type:"enum | string",className:"rt-r-cg",customProperties:["--column-gap"],values:nd,responsive:!0},gapY:{type:"enum | string",className:"rt-r-rg",customProperties:["--row-gap"],values:nd,responsive:!0}},OA=["div","span"],PA=["none","inline-flex","flex"],DA=["row","column","row-reverse","column-reverse"],jA=["start","center","end","baseline","stretch"],LA=["start","center","end","between"],FA=["nowrap","wrap","wrap-reverse"],NA={as:{type:"enum",values:OA,default:"div"},...mA,display:{type:"enum",className:"rt-r-display",values:PA,responsive:!0},direction:{type:"enum",className:"rt-r-fd",values:DA,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:jA,responsive:!0},justify:{type:"enum",className:"rt-r-jc",values:LA,parseValue:RA,responsive:!0},wrap:{type:"enum",className:"rt-r-fw",values:FA,responsive:!0},...MA};function RA(r){return r==="between"?"space-between":r}const id=W.forwardRef((r,e)=>{const{className:t,asChild:n,as:i="div",...s}=_A(r,NA,AA,SA);return W.createElement(n?CA:i,{...s,ref:e,className:Po("rt-Flex",t)})});id.displayName="Flex";const Vv=()=>{const r=v.useRef(null),{setPlayerRef:e,duration:t,fps:n,size:i}=hn();return v.useEffect(()=>{e(r)},[]),b.jsx(id,{className:"size-full",children:b.jsx(aA,{ref:r,component:gA,durationInFrames:Math.round(t/1e3*n)||5*30,compositionWidth:1920,compositionHeight:1080,style:{width:"100%",height:"100%"},inputProps:{},fps:n,controls:!0})})},Bv=({scrollLeft:r})=>{const e=v.useRef(null),{playerRef:t,fps:n,scale:i}=hn(),s=Ga(t??void 0),a=bt(s/n*1e3,i.zoom)-r,[c,u]=v.useState(!1),[h,d]=v.useState(0),[g,p]=v.useState(a),y=()=>{u(!1)},w=S=>{u(!0);const T="touches"in S?S.touches[0].clientX:S.clientX;d(T),p(a)},_=S=>{if(c){const k=("touches"in S?S.touches[0].clientX:S.clientX)-h,I=g+k,M=Zn(I,i.zoom);t?.current?.seekTo(M*n/1e3)}};return v.useEffect(()=>{const S=T=>{T.preventDefault()};return c?(document.addEventListener("mousemove",_),document.addEventListener("mouseup",y),document.addEventListener("touchmove",_),document.addEventListener("touchend",y),document.addEventListener("dragstart",S)):(document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",y)),()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",y),document.removeEventListener("dragstart",S)}},[c,_,y]),b.jsx("div",{ref:e,role:"button",tabIndex:0,onMouseDown:S=>{w(S)},onTouchStart:S=>{w(S)},onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&w(S)},style:{position:"absolute",left:40+Xa+a,top:80,width:1,height:"calc(100% - 80px)",background:"#d4d4d8",zIndex:10,cursor:"pointer"},children:b.jsxs("div",{className:"relative h-full",children:[b.jsx("div",{className:"absolute top-0  h-full w-3 -translate-x-1/2"}),b.jsx("div",{className:"absolute top-0  h-full w-0.5 -translate-x-1/2 bg-white/50"}),b.jsx("div",{style:{borderRadius:"0 0 20px 20px"},className:"absolute h-3 -translate-x-1/2 px-1.5",children:b.jsx("svg",{height:"12",viewBox:"0 0 12 12",fill:"none",children:b.jsx("path",{fill:"currentColor",d:"M11.6585 7.04881L6.6585 11.4238C6.28148 11.7537 5.71852 11.7537 5.3415 11.4238L0.341495 7.04881C0.12448 6.85892 0 6.58459 0 6.29623V1C0 0.447715 0.447715 0 1 0H11C11.5523 0 12 0.447715 12 1V6.29623C12 6.58459 11.8755 6.85892 11.6585 7.04881Z"})})})]})})},zv=r=>{const{height:e=40,longLineSize:t=8,shortLineSize:n=6,offsetX:i=Ya+Xa,textOffsetY:s=12,textFormat:a=Fm,scrollLeft:c=0,onClick:u}=r,{scale:h}=hn(),d=v.useRef(null),[g,p]=v.useState(null),[y,w]=v.useState({width:0,height:e});v.useEffect(()=>{const k=d.current;if(k){const I=k.getContext("2d");p(I),_(k,I,c)}},[]),v.useEffect(()=>{g&&_(d.current,g,c)},[g,c,h]);const _=(k,I,M)=>{if(!k||!I)return;const N=k.offsetParent.offsetWidth??k.offsetWidth,H=y.height;k.width=N,k.height=H,S(I,M,N,H),w({width:N,height:H})},S=(k,I,M,L)=>{const N=h.zoom,H=h.unit,R=h.segments;k.clearRect(0,0,M,L),k.save(),k.strokeStyle="#71717a",k.fillStyle="#71717a",k.lineWidth=1,k.font=`${Mm}px ${Om}`,k.textBaseline="top",k.translate(.5,0),k.beginPath();const X=H*N*_o,U=Math.floor(I/X),$=Math.ceil((I+M)/X)-U;for(let G=0;G<=$;++G){const re=G+U;if(re<0)continue;const fe=re*X/N,Q=(fe-I/N)*N;if(Q<-X||Q>=M+X)continue;const ue=a(fe),se=-k.measureText(ue).width/2;k.fillText(ue,Q+se+i,s)}for(let G=0;G<=$;++G){const re=G+U;if(re<0)continue;const Q=re*X-I+i;for(let ue=0;ue<R;++ue){const oe=Q+ue/R*X;if(oe<0||oe>=M)continue;const se=ue%R?n:t;se===n?k.strokeStyle="#a1a1aa":k.strokeStyle="#d4d4d8";const de=32,[ne,Fe]=[oe,de],[Ge,Re]=[ne,Fe+se];k.beginPath(),k.moveTo(ne,Fe),k.lineTo(Ge,Re),k.stroke()}}k.restore()},T=k=>{const I=d.current;if(!I)return;const M=I.getBoundingClientRect(),N=k.clientX-M.left+c-Ya;u?.(N)};return b.jsx("div",{className:"border-border border-t",style:{position:"relative",width:"100%",height:`${y.height}px`,backgroundColor:"transparent"},children:b.jsx("canvas",{onClick:T,ref:d,height:y.height})})},Hv=()=>b.jsx(id,{flexGrow:"1",justify:"center",width:"100%",height:"100%",className:"bg-scene py-3",children:b.jsx("div",{className:"max-w-3xl flex-1  w-full h-full flex relative",children:b.jsx(Vv,{})})});function F(r,e,t){return(e=function(n){var i=function(s,a){if(typeof s!="object"||!s)return s;var c=s[Symbol.toPrimitive];if(c!==void 0){var u=c.call(s,a);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(s)}(n,"string");return typeof i=="symbol"?i:i+""}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Wv(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function j(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wv(Object(t),!0).forEach(function(n){F(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Wv(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function ot(r,e){if(r==null)return{};var t,n,i=function(a,c){if(a==null)return{};var u={};for(var h in a)if({}.hasOwnProperty.call(a,h)){if(c.indexOf(h)>=0)continue;u[h]=a[h]}return u}(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function ri(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}class Uv{constructor(){F(this,"browserShadowBlurConstant",1),F(this,"DPI",96),F(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),F(this,"perfLimitSizeTotal",2097152),F(this,"maxCacheSideLimit",4096),F(this,"minCacheSideLimit",256),F(this,"disableStyleCopyPaste",!1),F(this,"enableGLFiltering",!0),F(this,"textureSize",4096),F(this,"forceGLPutImageData",!1),F(this,"cachesBoundsOfCurve",!1),F(this,"fontPaths",{}),F(this,"NUM_FRACTION_DIGITS",4)}}const Ve=new class extends Uv{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=j(j({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){const e=new Uv,t=r?.reduce((n,i)=>(n[i]=e[i],n),{})||e;this.configure(t)}},ni=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[r]("fabric",...t)};class fn extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class $v extends fn{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class VA{}class BA extends VA{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),i=e.createShader(e.FRAGMENT_SHADER);return!!i&&(e.shaderSource(i,n),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),ni("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const zA={};let Yv;const gn=()=>Yv||(Yv={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new BA,dispose(){},copyPasteData:zA}),Os=()=>gn().document,mc=()=>gn().window,Xv=()=>{var r;return Math.max((r=Ve.devicePixelRatio)!==null&&r!==void 0?r:mc().devicePixelRatio,1)},Lo=new class{constructor(){F(this,"charWidthsCache",{}),F(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:e,fontStyle:t,fontWeight:n}=r;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const i=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return i[s]||(i[s]={}),i[s]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){const{perfLimitSizeTotal:e}=Ve,t=Math.sqrt(e*r);return[Math.floor(t),Math.floor(e/t)]}},sd="6.5.4";function Di(){}const ii=Math.PI/2,kn=2*Math.PI,od=Math.PI/180,Kt=Object.freeze([1,0,0,1,0,0]),ad=16,si=.4477152502,Ee="center",Ue="left",ir="top",cd="bottom",wt="right",sr="none",ld=/\r?\n/,Gv="moving",vc="scaling",qv="rotating",ud="rotate",Kv="skewing",Fo="resizing",Zv="modifyPoly",HA="modifyPath",yc="changed",bc="scale",Zt="scaleX",mr="scaleY",Ps="skewX",Ds="skewY",It="fill",or="stroke",wc="modified",js="json",hd="svg",ie=new class{constructor(){this[js]=new Map,this[hd]=new Map}has(r){return this[js].has(r)}getClass(r){const e=this[js].get(r);if(!e)throw new fn("No class registered for ".concat(r));return e}setClass(r,e){e?this[js].set(e,r):(this[js].set(r.type,r),this[js].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[hd].get(r)}setSVGClass(r,e){this[hd].set(e??r.type.toLowerCase(),r)}},xc=new class extends Array{remove(r){const e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){const r=this.splice(0);return r.forEach(e=>e.abort()),r}cancelByCanvas(r){if(!r)return[];const e=this.filter(t=>{var n;return t.target===r||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===r});return e.forEach(t=>t.abort()),e}cancelByTarget(r){if(!r)return[];const e=this.filter(t=>t.target===r);return e.forEach(t=>t.abort()),e}};class WA{constructor(){F(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[i,s]=n;this.on(i,s)}),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(i=>{let[s,a]=i;n.push(this.once(s,a))}),()=>n.forEach(i=>i())}if(t){const n=this.on(e,function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];t.call(this,...s),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],i=n.indexOf(t);i>-1&&n.splice(i,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[i,s]=n;this._removeEventListener(i,s)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const i=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(i)for(let s=0;s<i.length;s++)i[s].call(this,t||{})}}const ji=(r,e)=>{const t=r.indexOf(e);return t!==-1&&r.splice(t,1),r},Gr=r=>{if(r===0)return 1;switch(Math.abs(r)/ii){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},qr=r=>{if(r===0)return 0;const e=r/ii,t=Math.sign(r);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(r)};class z{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new z(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new z(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new z(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new z(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new z(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new z(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new z(this.x/e.x,this.y/e.y)}scalarDivide(e){return new z(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new z(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new z(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new z(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new z(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dd;const n=qr(e),i=Gr(e),s=this.subtract(t);return new z(s.x*i-s.y*n,s.x*n+s.y*i).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new z(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const dd=new z(0,0),_c=r=>!!r&&Array.isArray(r._objects);function Jv(r){class e extends r{constructor(){super(...arguments),F(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];const a=this._objects.push(...i);return i.forEach(c=>this._onObjectAdded(c)),a}insertAt(n){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return this._objects.splice(n,0,...s),s.forEach(c=>this._onObjectAdded(c)),this._objects.length}remove(){const n=this._objects,i=[];for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return a.forEach(u=>{const h=n.indexOf(u);h!==-1&&(n.splice(h,1),i.push(u),this._onObjectRemoved(u))}),i}forEachObject(n){this.getObjects().forEach((i,s,a)=>n(i,s,a))}getObjects(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.length===0?[...this._objects]:this._objects.filter(a=>a.isType(...i))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,i){return!!this._objects.includes(n)||!!i&&this._objects.some(s=>s instanceof e&&s.contains(n,!0))}complexity(){return this._objects.reduce((n,i)=>n+=i.complexity?i.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(ji(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(ji(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,i){if(!n)return!1;const s=this._objects.indexOf(n);if(s!==0){const a=this.findNewLowerIndex(n,s,i);return ji(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,i){if(!n)return!1;const s=this._objects.indexOf(n);if(s!==this._objects.length-1){const a=this.findNewUpperIndex(n,s,i);return ji(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,i){return n!==this._objects[i]&&(ji(this._objects,n),this._objects.splice(i,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,i,s){let a;if(s){a=i;for(let c=i-1;c>=0;--c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=i-1;return a}findNewUpperIndex(n,i,s){let a;if(s){a=i;for(let c=i+1;c<this._objects.length;++c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=i+1;return a}collectObjects(n){let{left:i,top:s,width:a,height:c}=n,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],d=new z(i,s),g=d.add(new z(a,c));for(let p=this._objects.length-1;p>=0;p--){const y=this._objects[p];y.selectable&&y.visible&&(u&&y.intersectsWithRect(d,g)||y.isContainedWithinRect(d,g)||u&&y.containsPoint(d)||u&&y.containsPoint(g))&&h.push(y)}return h}}return e}class Qv extends WA{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function No(r){return mc().requestAnimationFrame(r)}function e1(r){return mc().cancelAnimationFrame(r)}let UA=0;const oi=()=>UA++,Pr=()=>{const r=Os().createElement("canvas");if(!r||r.getContext===void 0)throw new fn("Failed to create `canvas` element");return r},t1=()=>Os().createElement("img"),Kr=r=>{const e=Pr();return e.width=r.width,e.height=r.height,e},fd=(r,e,t)=>r.toDataURL("image/".concat(e),t),pt=r=>r*od,ai=r=>r/od,r1=r=>r.every((e,t)=>e===Kt[t]),Ut=(r,e,t)=>new z(r).transform(e,t),vr=r=>{const e=1/(r[0]*r[3]-r[1]*r[2]),t=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:n,y:i}=new z(r[4],r[5]).transform(t,!0);return t[4]=-n,t[5]=-i,t},mt=(r,e,t)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],t?0:r[0]*e[4]+r[2]*e[5]+r[4],t?0:r[1]*e[4]+r[3]*e[5]+r[5]],Sc=(r,e)=>r.reduceRight((t,n)=>n&&t?mt(n,t,e):n||t,void 0)||Kt.concat(),n1=r=>{let[e,t]=r;return Math.atan2(t,e)},Ls=r=>{const e=n1(r),t=Math.pow(r[0],2)+Math.pow(r[1],2),n=Math.sqrt(t),i=(r[0]*r[3]-r[2]*r[1])/n,s=Math.atan2(r[0]*r[2]+r[1]*r[3],t);return{angle:ai(e),scaleX:n,scaleY:i,skewX:ai(s),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},Fs=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Ns(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=pt(r),i=Gr(n),s=qr(n);return[i,s,-s,i,e?e-(i*e-s*t):0,t?t-(s*e+i*t):0]}const Cc=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},i1=r=>Math.tan(pt(r)),gd=r=>[1,0,i1(r),1,0,0],pd=r=>[1,i1(r),0,1,0,0],Ro=r=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:i=!1,skewX:s=0,skewY:a=0}=r,c=Cc(n?-e:e,i?-t:t);return s&&(c=mt(c,gd(s),!0)),a&&(c=mt(c,pd(a),!0)),c},s1=r=>{const{translateX:e=0,translateY:t=0,angle:n=0}=r;let i=Fs(e,t);n&&(i=mt(i,Ns({angle:n})));const s=Ro(r);return r1(s)||(i=mt(i,s)),i},Vo=function(r){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,i){if(e&&e.aborted)return i(new $v("loadImage"));const s=t1();let a;e&&(a=function(u){s.src="",i(u)},e.addEventListener("abort",a,{once:!0}));const c=function(){s.onload=s.onerror=null,a&&e?.removeEventListener("abort",a),n(s)};r?(s.onload=c,s.onerror=function(){a&&e?.removeEventListener("abort",a),i(new fn("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=r):c()})},Rs=function(r){let{signal:e,reviver:t=Di}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,i)=>{const s=[];e&&e.addEventListener("abort",i,{once:!0}),Promise.all(r.map(a=>ie.getClass(a.type).fromObject(a,{signal:e}).then(c=>(t(a,c),s.push(c),c)))).then(n).catch(a=>{s.forEach(c=>{c.dispose&&c.dispose()}),i(a)}).finally(()=>{e&&e.removeEventListener("abort",i)})})},Bo=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{const i=[];e&&e.addEventListener("abort",n,{once:!0});const s=Object.values(r).map(c=>c&&c.type&&ie.has(c.type)?Rs([c],{signal:e}).then(u=>{let[h]=u;return i.push(h),h}):c),a=Object.keys(r);Promise.all(s).then(c=>c.reduce((u,h,d)=>(u[a[d]]=h,u),{})).then(t).catch(c=>{i.forEach(u=>{u.dispose&&u.dispose()}),n(c)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},Li=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in r&&(e[t]=r[t]),e),{})},md=(r,e)=>Object.keys(r).reduce((t,n)=>(e(r[n],n,r)&&(t[n]=r[n]),t),{}),o1={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},vd=(r,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+(e-r)*(2/3-t)*6:r),a1=(r,e,t,n)=>{r/=255,e/=255,t/=255;const i=Math.max(r,e,t),s=Math.min(r,e,t);let a,c;const u=(i+s)/2;if(i===s)a=c=0;else{const h=i-s;switch(c=u>.5?h/(2-i-s):h/(i+s),i){case r:a=(e-t)/h+(e<t?6:0);break;case e:a=(t-r)/h+2;break;case t:a=(r-e)/h+4}a/=6}return[Math.round(360*a),Math.round(100*c),Math.round(100*u),n]},c1=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Tc=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),l1=r=>{let[e,t,n,i=1]=r;const s=Math.round(.3*e+.59*t+.11*n);return[s,s,s,i]};class Xe{constructor(e){if(F(this,"isUnrecognised",!1),e)if(e instanceof Xe)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,i,s=1]=e;this.setSource([t,n,i,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in o1&&(e=o1[e]),e==="transparent"?[255,255,255,0]:Xe.sourceFromHex(e)||Xe.sourceFromRgb(e)||Xe.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=a1(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,i]=a1(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(i,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,i]=this.getSource();return"".concat(Tc(e)).concat(Tc(t)).concat(Tc(n)).concat(Tc(Math.round(255*i)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(l1(this.getSource())),this}toBlackWhite(e){const[t,,,n]=l1(this.getSource()),i=t<(e||127)?0:255;return this.setSource([i,i,i,n]),this}overlayWith(e){e instanceof Xe||(e=new Xe(e));const t=this.getSource(),n=e.getSource(),[i,s,a]=t.map((c,u)=>Math.round(.5*c+.5*n[u]));return this.setSource([i,s,a,t[3]]),this}static fromRgb(e){return Xe.fromRgba(e)}static fromRgba(e){return new Xe(Xe.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[n,i,s]=t.slice(1,4).map(a=>{const c=parseFloat(a);return a.endsWith("%")?Math.round(2.55*c):c});return[n,i,s,c1(t[4])]}}static fromHsl(e){return Xe.fromHsla(e)}static fromHsla(e){return new Xe(Xe.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const n=(Xe.parseAngletoDegrees(t[1])%360+360)%360/360,i=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let a,c,u;if(i===0)a=c=u=s;else{const h=s<=.5?s*(i+1):s+i-s*i,d=2*s-h;a=vd(d,h,n+1/3),c=vd(d,h,n),u=vd(d,h,n-1/3)}return[Math.round(255*a),Math.round(255*c),Math.round(255*u),c1(t[4])]}static fromHex(e){return new Xe(Xe.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map(u=>u+u):t.match(/.{2}/g);const[i,s,a,c=255]=n.map(u=>parseInt(u,16));return[i,s,a,c/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?ai(n):t.includes("turn")?360*n:n}}const at=(r,e)=>parseFloat(Number(r).toFixed(e)),Fi=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ad;const t=/\D{0,2}$/.exec(r),n=parseFloat(r),i=Ve.DPI;switch(t?.[0]){case"mm":return n*i/25.4;case"cm":return n*i/2.54;case"in":return n*i;case"pt":return n*i/72;case"pc":return n*i/72*12;case"em":return n*e;default:return n}},u1=r=>{const[e,t]=r.trim().split(" "),[n,i]=(s=e)&&s!==sr?[s.slice(1,4),s.slice(5,8)]:s===sr?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:n,alignY:i}},zo=r=>"matrix("+r.map(e=>at(e,Ve.NUM_FRACTION_DIGITS)).join(" ")+")",Ho=function(r,e){let t,n,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const s=new Xe(e),a=s.getAlpha();t=s.toRgb(),a!==1&&(n=a.toString())}else t="none";return i?"".concat(r,": ").concat(t,"; ").concat(n?"".concat(r,"-opacity: ").concat(n,"; "):""):"".concat(r,'="').concat(t,'" ').concat(n?"".concat(r,'-opacity="').concat(n,'" '):"")},Dr=r=>!!r&&r.toLive!==void 0,h1=r=>!!r&&typeof r.toObject=="function",d1=r=>!!r&&r.offsetX!==void 0&&"source"in r,Ni=r=>!!r&&"multiSelectionStacking"in r;function f1(r){const e=r&&Zr(r);let t=0,n=0;if(!r||!e)return{left:t,top:n};let i=r;const s=e.documentElement,a=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===e?(t=a.scrollLeft||s.scrollLeft||0,n=a.scrollTop||s.scrollTop||0):(t+=i.scrollLeft||0,n+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:t,top:n}}const Zr=r=>r.ownerDocument||null,g1=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},p1=function(r,e,t){let{width:n,height:i}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=n,r.height=i,s>1&&(r.setAttribute("width",(n*s).toString()),r.setAttribute("height",(i*s).toString()),e.scale(s,s))},yd=(r,e)=>{let{width:t,height:n}=e;t&&(r.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(r.style.height=typeof n=="number"?"".concat(n,"px"):n)};function m1(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=sr,r}class v1{constructor(e){F(this,"_originalCanvasStyle",void 0),F(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&Os().getElementById(e)||Pr();var n;if(t.hasAttribute("data-fabric"))throw new fn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width","".concat(t)),i.setAttribute("height","".concat(n)),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:i}=this.lower;p1(n,i,e,t)}setCSSDimensions(e){yd(this.lower.el,e)}calcOffset(){return function(e){var t;const n=e&&Zr(e),i={left:0,top:0};if(!n)return i;const s=((t=g1(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};i.left+=parseInt(s.borderLeftWidth,10)||0,i.top+=parseInt(s.borderTopWidth,10)||0,i.left+=parseInt(s.paddingLeft,10)||0,i.top+=parseInt(s.paddingTop,10)||0;let a={left:0,top:0};const c=n.documentElement;e.getBoundingClientRect!==void 0&&(a=e.getBoundingClientRect());const u=f1(e);return{left:a.left+u.left-(c.clientLeft||0)+i.left,top:a.top+u.top-(c.clientTop||0)+i.top}}(this.lower.el)}dispose(){gn().dispose(this.lower.el),delete this.lower}}const $A={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Kt]};class Wo extends Jv(Qv){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Wo.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new v1(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const s=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(ni("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Xv():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const i=j({width:this.width,height:this.height},e);this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,i=[...this.viewportTransform],s=Ut(e,vr(i));i[0]=t,i[3]=t;const a=Ut(s,i);i[4]+=n.x-a.x,i[5]+=n.y-a.y,this.setViewportTransform(i)}setZoom(e){this.zoomToPoint(new z(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new z(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=No(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,n=vr(this.viewportTransform),i=Ut({x:0,y:0},n),s=Ut({x:e,y:t},n),a=i.min(s),c=i.max(s);return this.vptCoords={tl:a,tr:new z(c.x,a.y),bl:new z(a.x,c.y),br:c}}cancelRequestedRender(){this.nextRenderHandle&&(e1(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,i)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,i=t.length;n<i;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],i=this["".concat(t,"Image")],s=this.viewportTransform,a=this["".concat(t,"Vpt")];if(!n&&!i)return;const c=Dr(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=c?n.toLive(e):n,a&&e.transform(...s),c){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const u=n.gradientTransform||n.patternTransform;u&&e.transform(...u)}e.fill(),e.restore()}if(i){e.save();const{skipOffscreen:u}=this;this.skipOffscreen=a,a&&e.transform(...s),i.render(e),this.skipOffscreen=u,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new z(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new z(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new z(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new z(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new z(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Ut(this.getCenterPoint(),vr(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Ee,Ee),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,i=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return j(j(j({version:sd},Li(this,t)),{},{objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,e,t))},this.__serializeBgOverlay(e,t)),i?{clipPath:i}:null)}_toObject(e,t,n){let i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!i),s}__serializeBgOverlay(e,t){const n={},i=this.backgroundImage,s=this.overlayImage,a=this.backgroundColor,c=this.overlayColor;return Dr(a)?a.excludeFromExport||(n.background=a.toObject(t)):a&&(n.background=a),Dr(c)?c.excludeFromExport||(n.overlay=c.toObject(t)):c&&(n.overlay=c),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,e,t)),s&&!s.excludeFromExport&&(n.overlayImage=this._toObject(s,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),i=t.height||"".concat(this.height),s=Ve.NUM_FRACTION_DIGITS,a=t.viewBox;let c;if(a)c='viewBox="'.concat(a.x," ").concat(a.y," ").concat(a.width," ").concat(a.height,'" ');else if(this.svgViewportTransformation){const u=this.viewportTransform;c='viewBox="'.concat(at(-u[4]/u[0],s)," ").concat(at(-u[5]/u[3],s)," ").concat(at(this.width/u[0],s)," ").concat(at(this.height/u[3],s),'" ')}else c='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',i,'" ',c,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",sd,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(oi()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Dr(t)){const n=this["".concat(e,"Vpt")],i=this.viewportTransform,s={isType:()=>!1,width:this.width/(n?i[0]:1),height:this.height/(n?i[3]:1)};return t.toSVG(s,{additionalTransform:n?zo(i):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=Ve.fontPaths;this._objects.forEach(function s(a){e.push(a),_c(a)&&a._objects.forEach(s)}),e.forEach(s=>{if(!(a=s)||typeof a._renderText!="function")return;var a;const{styles:c,fontFamily:u}=s;!t[u]&&n[u]&&(t[u]=!0,c&&Object.values(c).forEach(h=>{Object.values(h).forEach(d=>{let{fontFamily:g=""}=d;!t[g]&&n[g]&&(t[g]=!0)})}))});const i=Object.keys(t).map(s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(n[s],`');
		}
`)).join("");return i?`	<style type="text/css"><![CDATA[
`.concat(i,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const i=this[t];i&&!i.excludeFromExport&&i.toSVG&&e.push(i.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(Dr(n)){const i=n.repeat||"",s=this.width,a=this.height,c=this["".concat(t,"Vpt")]?zo(vr(this.viewportTransform)):"";e.push('<rect transform="'.concat(c," translate(").concat(s/2,",").concat(a/2,')" x="').concat(n.offsetX-s/2,'" y="').concat(n.offsetY-a/2,'" width="').concat(i!=="repeat-y"&&i!=="no-repeat"||!d1(n)?s:n.source.width,'" height="').concat(i!=="repeat-x"&&i!=="no-repeat"||!d1(n)?a:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new fn("`json` is undefined"));const i=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:a,background:c,overlayImage:u,overlay:h,clipPath:d}=i,g=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Rs(s,{reviver:t,signal:n}),Bo({backgroundImage:a,backgroundColor:c,overlayImage:u,overlayColor:h,clipPath:d},{signal:n})]).then(p=>{let[y,w]=p;return this.clear(),this.add(...y),this.set(i),this.set(w),this.renderOnAddRemove=g,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Kr(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:i=1,enableRetinaScaling:s=!1}=e,a=i*(s?this.getRetinaScaling():1);return fd(this.toCanvasElement(a,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:i,top:s,filter:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=(t||this.width)*e,u=(n||this.height)*e,h=this.getZoom(),d=this.width,g=this.height,p=this.skipControlsDrawing,y=h*e,w=this.viewportTransform,_=[y,0,0,y,(w[4]-(i||0))*e,(w[5]-(s||0))*e],S=this.enableRetinaScaling,T=Kr({width:c,height:u}),k=a?this._objects.filter(I=>a(I)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=_,this.width=c,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(T.getContext("2d"),k),this.viewportTransform=w,this.width=d,this.height=g,this.calcViewportBoundaries(),this.enableRetinaScaling=S,this.skipControlsDrawing=p,T}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),xc.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}F(Wo,"ownDefaults",$A);const YA=["touchstart","touchmove","touchend"],y1=r=>{const e=f1(r.target),t=function(n){const i=n.changedTouches;return i&&i[0]?i[0]:n}(r);return new z(t.clientX+e.left,t.clientY+e.top)},Ec=r=>YA.includes(r.type)||r.pointerType==="touch",bd=r=>{r.preventDefault(),r.stopPropagation()},pn=r=>{let e=0,t=0,n=0,i=0;for(let s=0,a=r.length;s<a;s++){const{x:c,y:u}=r[s];(c>n||!s)&&(n=c),(c<e||!s)&&(e=c),(u>i||!s)&&(i=u),(u<t||!s)&&(t=u)}return{left:e,top:t,width:n-e,height:i-t}},XA=["translateX","translateY","scaleX","scaleY"],b1=(r,e)=>Vs(r,mt(e,r.calcOwnMatrix())),Vs=(r,e)=>{const t=Ls(e),{translateX:n,translateY:i,scaleX:s,scaleY:a}=t,c=ot(t,XA),u=new z(n,i);r.flipX=!1,r.flipY=!1,Object.assign(r,c),r.set({scaleX:s,scaleY:a}),r.setPositionByOrigin(u,Ee,Ee)},w1=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},wd=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),kc=(r,e,t)=>{const n=r/2,i=e/2,s=[new z(-n,-i),new z(n,-i),new z(-n,i),new z(n,i)].map(c=>c.transform(t)),a=pn(s);return new z(a.width,a.height)},Uo=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Kt;return mt(vr(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kt),r)},In=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kt,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Kt;return r.transform(Uo(e,t))},x1=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kt,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Kt;return r.transform(Uo(e,t),!0)},xd=(r,e,t)=>{const n=Uo(e,t);return Vs(r,mt(n,r.calcOwnMatrix())),n},_d=(r,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(r),j(j({},e),{},{target:n})),n.fire(r,e)},GA={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Tt=r=>typeof r=="string"?GA[r]:r-.5,Ic="not-allowed";function _1(r){return Tt(r.originX)===Tt(Ee)&&Tt(r.originY)===Tt(Ee)}function S1(r){return .5-Tt(r)}const Jr=(r,e)=>r[e],Sd=(r,e,t,n)=>({e:r,transform:e,pointer:new z(t,n)});function C1(r,e){const t=r.getTotalAngle()+ai(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function Ac(r,e,t,n,i){var s;let{target:a,corner:c}=r;const u=a.controls[c],h=((s=a.canvas)===null||s===void 0?void 0:s.getZoom())||1,d=a.padding/h,g=function(p,y,w,_){const S=p.getRelativeCenterPoint(),T=w!==void 0&&_!==void 0?p.translateToGivenOrigin(S,Ee,Ee,w,_):new z(p.left,p.top);return(p.angle?y.rotate(-pt(p.angle),S):y).subtract(T)}(a,new z(n,i),e,t);return g.x>=d&&(g.x-=d),g.x<=-d&&(g.x+=d),g.y>=d&&(g.y-=d),g.y<=d&&(g.y+=d),g.x-=u.offsetX,g.y-=u.offsetY,g}const T1=(r,e,t,n)=>{const{target:i,offsetX:s,offsetY:a}=e,c=t-s,u=n-a,h=!Jr(i,"lockMovementX")&&i.left!==c,d=!Jr(i,"lockMovementY")&&i.top!==u;return h&&i.set(Ue,c),d&&i.set(ir,u),(h||d)&&_d(Gv,Sd(r,e,t,n)),h||d};class E1{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):sr,s=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",g=e?"":this.getSvgFilter(),p=Ho(It,this.fill);return[Ho(or,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",u,"; ",p,"fill-rule: ",t,"; ","opacity: ",h,";",g,d].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'.concat(zo(n));return"".concat(i).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=i,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:i,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=t?"":'style="'.concat(this.getSvgStyles(),'" '),c=i?'style="'.concat(this.getSvgFilter(),'" '):"",u=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,g=this.stroke,p=this.fill,y=this.shadow,w=[],_=e.indexOf("COMMON_PARTS");let S;u&&(u.clipPathId="CLIPPATH_".concat(oi()),S='<clipPath id="'.concat(u.clipPathId,`" >
`).concat(u.toClipPathSVG(n),`</clipPath>
`)),d&&w.push("<g ",c,this.getSvgCommons(),` >
`),w.push("<g ",this.getSvgTransform(!1),d?"":c+this.getSvgCommons(),` >
`);const T=[a,h,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[_]=T,Dr(p)&&w.push(p.toSVG(this)),Dr(g)&&w.push(g.toSVG(this)),y&&w.push(y.toSVG(this)),u&&w.push(S),w.push(e.join("")),w.push(`</g>
`),d&&w.push(`</g>
`),n?n(w.join("")):w.join("")}addPaintOrder(){return this.paintFirst!==It?' paint-order="'.concat(this.paintFirst,'" '):""}}function Mc(r){return new RegExp("^("+r.join("|")+")\\b","i")}var k1;const Ri=String.raw(k1||(k1=ri(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),qA=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Ri+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Ri+"))?\\s+(.*)"),KA={cx:Ue,x:Ue,r:"radius",cy:ir,y:ir,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Cd="font-size",Td="clip-path";Mc(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),Mc(["symbol","image","marker","pattern","view","svg"]);const I1=Mc(["symbol","g","a","svg","clipPath","defs"]),ZA=new z(1,0),A1=new z,Ed=(r,e)=>r.rotate(e),Oc=(r,e)=>new z(e).subtract(r),Pc=r=>r.distanceFrom(A1),Dc=(r,e)=>Math.atan2(Bs(r,e),O1(r,e)),M1=r=>Dc(ZA,r),jc=r=>r.eq(A1)?r:r.scalarDivide(Pc(r)),kd=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return jc(new z(-r.y,r.x).scalarMultiply(e?1:-1))},Bs=(r,e)=>r.x*e.y-r.y*e.x,O1=(r,e)=>r.x*e.x+r.y*e.y,Id=(r,e,t)=>{if(r.eq(e)||r.eq(t))return!0;const n=Bs(e,t),i=Bs(e,r),s=Bs(t,r);return n>=0?i>=0&&s<=0:!(i<=0&&s>=0)},P1="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",D1=new RegExp("(?:\\s|^)"+P1+P1+"("+Ri+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class An{constructor(e){const t=typeof e=="string"?An.parseShadow(e):e;Object.assign(this,An.ownDefaults,t),this.id=oi()}static parseShadow(e){const t=e.trim(),[,n=0,i=0,s=0]=(D1.exec(t)||[]).map(a=>parseFloat(a)||0);return{color:(t.replace(D1,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:i,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=Ed(new z(this.offsetX,this.offsetY),pt(-e.angle)),n=new Xe(this.color);let i=40,s=40;return e.width&&e.height&&(i=100*at((Math.abs(t.x)+this.blur)/e.width,Ve.NUM_FRACTION_DIGITS)+20,s=100*at((Math.abs(t.y)+this.blur)/e.height,Ve.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(i,'%" width="').concat(100+2*i,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(at(this.blur?this.blur/2:0,Ve.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(at(t.x,Ve.NUM_FRACTION_DIGITS),'" dy="').concat(at(t.y,Ve.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=An.ownDefaults;return this.includeDefaultValues?e:md(e,(n,i)=>n!==t[i])}static async fromObject(e){return new this(e)}}F(An,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),F(An,"type","shadow"),ie.setClass(An,"shadow");const Vi=(r,e,t)=>Math.max(r,Math.min(e,t)),JA=[ir,Ue,Zt,mr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Ps,Ds],Mn=[It,or,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],QA={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Ue,originY:ir,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:It,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Ad=(r,e,t,n)=>(r<Math.abs(e)?(r=e,n=t/4):n=e===0&&r===0?t/kn*Math.asin(1):t/kn*Math.asin(e/r),{a:r,c:e,p:t,s:n}),j1=(r,e,t,n,i)=>r*Math.pow(2,10*(n-=1))*Math.sin((n*i-e)*kn/t),L1=(r,e,t,n)=>-t*Math.cos(r/n*ii)+t+e,Md=(r,e,t,n)=>(r/=n)<1/2.75?t*(7.5625*r*r)+e:r<2/2.75?t*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?t*(7.5625*(r-=2.25/2.75)*r+.9375)+e:t*(7.5625*(r-=2.625/2.75)*r+.984375)+e,F1=(r,e,t,n)=>t-Md(n-r,0,t,n)+e;var eM=Object.freeze({__proto__:null,defaultEasing:L1,easeInBack:function(r,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(r/=n)*r*((i+1)*r-i)+e},easeInBounce:F1,easeInCirc:(r,e,t,n)=>-t*(Math.sqrt(1-(r/=n)*r)-1)+e,easeInCubic:(r,e,t,n)=>t*(r/n)**3+e,easeInElastic:(r,e,t,n)=>{const i=t;let s=0;if(r===0)return e;if((r/=n)===1)return e+t;s||(s=.3*n);const{a,s:c,p:u}=Ad(i,t,s,1.70158);return-j1(a,c,u,r,n)+e},easeInExpo:(r,e,t,n)=>r===0?e:t*2**(10*(r/n-1))+e,easeInOutBack:function(r,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=n/2)<1?t/2*(r*r*((1+(i*=1.525))*r-i))+e:t/2*((r-=2)*r*((1+(i*=1.525))*r+i)+2)+e},easeInOutBounce:(r,e,t,n)=>r<n/2?.5*F1(2*r,0,t,n)+e:.5*Md(2*r-n,0,t,n)+.5*t+e,easeInOutCirc:(r,e,t,n)=>(r/=n/2)<1?-t/2*(Math.sqrt(1-r**2)-1)+e:t/2*(Math.sqrt(1-(r-=2)*r)+1)+e,easeInOutCubic:(r,e,t,n)=>(r/=n/2)<1?t/2*r**3+e:t/2*((r-2)**3+2)+e,easeInOutElastic:(r,e,t,n)=>{const i=t;let s=0;if(r===0)return e;if((r/=n/2)===2)return e+t;s||(s=n*(.3*1.5));const{a,s:c,p:u,c:h}=Ad(i,t,s,1.70158);return r<1?-.5*j1(a,c,u,r,n)+e:a*Math.pow(2,-10*(r-=1))*Math.sin((r*n-c)*kn/u)*.5+h+e},easeInOutExpo:(r,e,t,n)=>r===0?e:r===n?e+t:(r/=n/2)<1?t/2*2**(10*(r-1))+e:t/2*-(2**(-10*--r)+2)+e,easeInOutQuad:(r,e,t,n)=>(r/=n/2)<1?t/2*r**2+e:-t/2*(--r*(r-2)-1)+e,easeInOutQuart:(r,e,t,n)=>(r/=n/2)<1?t/2*r**4+e:-t/2*((r-=2)*r**3-2)+e,easeInOutQuint:(r,e,t,n)=>(r/=n/2)<1?t/2*r**5+e:t/2*((r-2)**5+2)+e,easeInOutSine:(r,e,t,n)=>-t/2*(Math.cos(Math.PI*r/n)-1)+e,easeInQuad:(r,e,t,n)=>t*(r/=n)*r+e,easeInQuart:(r,e,t,n)=>t*(r/=n)*r**3+e,easeInQuint:(r,e,t,n)=>t*(r/n)**5+e,easeInSine:(r,e,t,n)=>-t*Math.cos(r/n*ii)+t+e,easeOutBack:function(r,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((r=r/n-1)*r*((i+1)*r+i)+1)+e},easeOutBounce:Md,easeOutCirc:(r,e,t,n)=>t*Math.sqrt(1-(r=r/n-1)*r)+e,easeOutCubic:(r,e,t,n)=>t*((r/n-1)**3+1)+e,easeOutElastic:(r,e,t,n)=>{const i=t;let s=0;if(r===0)return e;if((r/=n)===1)return e+t;s||(s=.3*n);const{a,s:c,p:u,c:h}=Ad(i,t,s,1.70158);return a*2**(-10*r)*Math.sin((r*n-c)*kn/u)+h+e},easeOutExpo:(r,e,t,n)=>r===n?e+t:t*-(2**(-10*r/n)+1)+e,easeOutQuad:(r,e,t,n)=>-t*(r/=n)*(r-2)+e,easeOutQuart:(r,e,t,n)=>-t*((r=r/n-1)*r**3-1)+e,easeOutQuint:(r,e,t,n)=>t*((r/n-1)**5+1)+e,easeOutSine:(r,e,t,n)=>t*Math.sin(r/n*ii)+e});const tM=()=>!1;class Od{constructor(e){let{startValue:t,byValue:n,duration:i=500,delay:s=0,easing:a=L1,onStart:c=Di,onChange:u=Di,onComplete:h=Di,abort:d=tM,target:g}=e;F(this,"_state","pending"),F(this,"durationProgress",0),F(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=s,this.easing=a,this._onStart=c,this._onChange=u,this._onComplete=h,this._abort=d,this.target=g,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>No(e),this.delay):No(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:i,valueProgress:s}=this.calculate(n);this.value=Object.freeze(i),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),No(this.tick)))}register(){xc.push(this)}unregister(){xc.remove(this)}abort(){this._state="aborted",this.unregister()}}const rM=["startValue","endValue"];class nM extends Od{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(j(j({},ot(e,rM)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const iM=["startValue","endValue"];class sM extends Od{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(j(j({},ot(e,iM)),{},{startValue:t,byValue:n.map((i,s)=>i-t[s])}))}calculate(e){const t=this.startValue.map((n,i)=>this.easing(e,n,this.byValue[i],this.duration,i));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const oM=["startValue","endValue","easing","onChange","onComplete","abort"],aM=(r,e,t,n)=>e+t*(1-Math.cos(r/n*ii)),Pd=r=>r&&((e,t,n)=>r(new Xe(e).toRgba(),t,n));class cM extends Od{constructor(e){let{startValue:t,endValue:n,easing:i=aM,onChange:s,onComplete:a,abort:c}=e,u=ot(e,oM);const h=new Xe(t).getSource(),d=new Xe(n).getSource();super(j(j({},u),{},{startValue:h,byValue:d.map((g,p)=>g-h[p]),easing:i,onChange:Pd(s),onComplete:Pd(a),abort:Pd(c)}))}calculate(e){const[t,n,i,s]=this.startValue.map((c,u)=>this.easing(e,c,this.byValue[u],this.duration,u)),a=[...[t,n,i].map(Math.round),Vi(0,s,1)];return{value:a,valueProgress:a.map((c,u)=>this.byValue[u]!==0?Math.abs((c-this.startValue[u])/this.byValue[u]):0).find(c=>c!==0)||0}}}function Dd(r){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(r)?new sM(r):new nM(r);return e.start(),e}function N1(r){const e=new cM(r);return e.start(),e}class lt{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(i=>!this.includes(i))),this}static isPointContained(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(i||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(i||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const s=Oc(t,n),a=Oc(t,e).divide(s);return i?Math.abs(a.x)===Math.abs(a.y):a.x===a.y&&a.x>=0&&a.x<=1}}static isPointInPolygon(e,t){const n=new z(e).setX(Math.min(e.x-1,...t.map(s=>s.x)));let i=0;for(let s=0;s<t.length;s++){const a=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,n);if(a.includes(e))return!0;i+=+(a.status==="Intersection")}return i%2==1}static intersectLineLine(e,t,n,i){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],a=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const c=t.x-e.x,u=t.y-e.y,h=i.x-n.x,d=i.y-n.y,g=e.x-n.x,p=e.y-n.y,y=h*p-d*g,w=c*p-u*g,_=d*c-h*u;if(_!==0){const S=y/_,T=w/_;return(s||0<=S&&S<=1)&&(a||0<=T&&T<=1)?new lt("Intersection").append(new z(e.x+S*c,e.y+S*u)):new lt}if(y===0||w===0){const S=s||a||lt.isPointContained(e,n,i)||lt.isPointContained(t,n,i)||lt.isPointContained(n,e,t)||lt.isPointContained(i,e,t);return new lt(S?"Coincident":void 0)}return new lt("Parallel")}static intersectSegmentLine(e,t,n,i){return lt.intersectLineLine(e,t,n,i,!1,!0)}static intersectSegmentSegment(e,t,n,i){return lt.intersectLineLine(e,t,n,i,!1,!1)}static intersectLinePolygon(e,t,n){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new lt,a=n.length;for(let c,u,h,d=0;d<a;d++){if(c=n[d],u=n[(d+1)%a],h=lt.intersectLineLine(e,t,c,u,i,!1),h.status==="Coincident")return h;s.append(...h.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,n){return lt.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new lt,i=e.length,s=[];for(let a=0;a<i;a++){const c=e[a],u=e[(a+1)%i],h=lt.intersectSegmentPolygon(c,u,t);h.status==="Coincident"?(s.push(h),n.append(c,u)):n.append(...h.points)}return s.length>0&&s.length===e.length?new lt("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const i=t.min(n),s=t.max(n),a=new z(s.x,i.y),c=new z(i.x,s.y);return lt.intersectPolygonPolygon(e,[i,a,s,c])}}class lM extends Qv{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Ut(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=Ut(e,vr(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new z(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,n,i];if(this.group){const a=this.group.calcTransformMatrix();return s.map(c=>Ut(c,a))}return s}intersectsWithRect(e,t){return lt.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=lt.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:n,top:i,width:s,height:a}=this.getBoundingRect();return n>=e.x&&n+s<=t.x&&i>=e.y&&i+a<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return lt.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return pn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Zt,e),this._set(mr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ai(n1(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Kt.concat()}calcACoords(){const e=Ns({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),i=Fs(t,n),s=mt(i,e),a=this._getTransformedDimensions(),c=a.x/2,u=a.y/2;return{tl:Ut({x:-c,y:-u},s),tr:Ut({x:c,y:-u},s),bl:Ut({x:-c,y:u},s),br:Ut({x:c,y:u},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Tt(this.originX),Tt(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),i=this.matrixCache;return i&&i.key.every((s,a)=>s===n[a])?i.value:(this.group&&(t=mt(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=s1(i);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new z(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=j({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let i=n,s=0;this.strokeUniform&&(i=0,s=n);const a=t.width+i,c=t.height+i;let u;return u=t.skewX===0&&t.skewY===0?new z(a*t.scaleX,c*t.scaleY):kc(a,c,Ro(t)),u.scalarAdd(s)}translateToGivenOrigin(e,t,n,i,s){let a=e.x,c=e.y;const u=Tt(i)-Tt(t),h=Tt(s)-Tt(n);if(u||h){const d=this._getTransformedDimensions();a+=u*d.x,c+=h*d.y}return new z(a,c)}translateToCenterPoint(e,t,n){if(t===Ee&&n===Ee)return e;const i=this.translateToGivenOrigin(e,t,n,Ee,Ee);return this.angle?i.rotate(pt(this.angle),e):i}translateToOriginPoint(e,t,n){const i=this.translateToGivenOrigin(e,Ee,Ee,t,n);return this.angle?i.rotate(pt(this.angle),e):i}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Ut(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new z(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const i=this.translateToCenterPoint(e,t,n),s=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Ue,ir)}}const uM=["type"],hM=["extraParam"];let On=class bu extends lM{static getDefaults(){return bu.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){ni("warn","Setting type has no effect",e)}constructor(e){super(),F(this,"_cacheContext",null),Object.assign(this,bu.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Pr(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,i=Ve.maxCacheSideLimit,s=Ve.minCacheSideLimit;if(t<=i&&n<=i&&t*n<=Ve.perfLimitSizeTotal)return t<s&&(e.width=s),n<s&&(e.height=s),e;const a=t/n,[c,u]=Lo.limitDimsByArea(a),h=Vi(s,c,i),d=Vi(s,u,i);return t>h&&(e.zoomX/=t/h,e.width=h,e.capped=!0),n>d&&(e.zoomY/=n/d,e.height=d,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,i=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(i+2),zoomX:e.x,zoomY:e.y,x:n,y:i}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:i,zoomX:s,zoomY:a,x:c,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=n!==e.width||i!==e.height,d=this.zoomX!==s||this.zoomY!==a;if(!e||!t)return!1;if(h||d){n!==e.width||i!==e.height?(e.width=n,e.height=i):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const g=c/2,p=u/2;return this.cacheTranslationX=Math.round(e.width/2-g)+g,this.cacheTranslationY=Math.round(e.height/2-p)+p,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,a),this.zoomX=s,this.zoomY=a,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new z(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Ls(this.calcTransformMatrix());return new z(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Zt&&e!==mr||(t=this._constrainScale(t)),e===Zt&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof An||(t=new An(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:i,cacheTranslationY:s}=this,{width:a,height:c}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:i,cacheTranslationY:s,width:a,height:c,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===or&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const i=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=i,this.stroke=s}createClipPathLayer(e,t){const n=Kr(t),i=n.getContext("2d");if(i.translate(t.cacheTranslationX,t.cacheTranslationY),i.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach(s=>{s.transform(i)}),t.parentClipPaths.push(e),e.absolutePositioned){const s=vr(this.calcTransformMatrix());i.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return e.transform(i),e.drawObject(i,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const i=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,i)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Dr(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(Dr(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,i=this.getCanvasRetinaScaling(),[s,,,a]=n?.viewportTransform||Kt,c=s*i,u=a*i,h=t.nonScaling?new z(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Ve.browserShadowBlurConstant*(c+u)*(h.x+h.y)/4,e.shadowOffsetX=t.offsetX*c*h.x,e.shadowOffsetY=t.offsetY*u*h.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Dr(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,i,s):e.transform(1,0,0,1,i,s),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===or?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const i=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),a=i.x/this.scaleX/s,c=i.y/this.scaleY/s,u=Kr({width:Math.ceil(a),height:Math.ceil(c)}),h=u.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(a,0),h.lineTo(a,c),h.lineTo(0,c),h.closePath(),h.translate(a/2,c/2),h.scale(i.zoomX/this.scaleX/s,i.zoomY/this.scaleY/s),this._applyPatternGradientTransform(h,t),h.fillStyle=t.toLive(e),h.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/i.zoomX,s*this.scaleY/i.zoomY),e.strokeStyle=(n=h.createPattern(u,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new z(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(ie.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=wd(this),n=this.group,i=this.shadow,s=Math.abs,a=e.enableRetinaScaling?Xv():1,c=(e.multiplier||1)*a,u=e.canvasProvider||(k=>new Wo(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&w1(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&xd(this,this.getViewportTransform()),this.setCoords();const h=Pr(),d=this.getBoundingRect(),g=this.shadow,p=new z;if(g){const k=g.blur,I=g.nonScaling?new z(1,1):this.getObjectScaling();p.x=2*Math.round(s(g.offsetX)+k)*s(I.x),p.y=2*Math.round(s(g.offsetY)+k)*s(I.y)}const y=d.width+p.x,w=d.height+p.y;h.width=Math.ceil(y),h.height=Math.ceil(w);const _=u(h);e.format==="jpeg"&&(_.backgroundColor="#fff"),this.setPositionByOrigin(new z(_.width/2,_.height/2),Ee,Ee);const S=this.canvas;_._objects=[this],this.set("canvas",_),this.setCoords();const T=_.toCanvasElement(c||1,e);return this.set("canvas",S),this.shadow=i,n&&(this.group=n),this.set(t),this.setCoords(),_._objects=[],_.destroy(),T}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return fd(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:i}=this;if(t){const{x:s,y:a}=this.getRelativeCenterPoint();this.originX=Ee,this.originY=Ee,this.left=s,this.top=a}if(this.set("angle",e),t){const{x:s,y:a}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,i);this.left=s,this.top=a,this.originX=n,this.originY=i}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){xc.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&gn().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((n,i)=>{let[s,a]=i;return n[s]=this._animate(s,a,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=e.split("."),s=this.constructor.colorProperties.includes(i[i.length-1]),{abort:a,startValue:c,onChange:u,onComplete:h}=n,d=j(j({},n),{},{target:this,startValue:c??i.reduce((g,p)=>g[p],this),endValue:t,abort:a?.bind(this),onChange:(g,p,y)=>{i.reduce((w,_,S)=>(S===i.length-1&&(w[_]=g),w[_]),this),u&&u(g,p,y)},onComplete:(g,p,y)=>{this.setCoords(),h&&h(g,p,y)}});return s?N1(d):Dd(d)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let i,s=0;s<t.length;s++){if(i=t[s],i===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let a=0;a<n.length;a++){if(this===n[a])return{fork:[],otherFork:[e,...n.slice(0,a)],common:[this,...t]};if(i===n[a])return{fork:[this,...t.slice(0,s)],otherFork:[e,...n.slice(0,a)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const i=t.fork.pop(),s=t.otherFork.pop(),a=n._objects.indexOf(i),c=n._objects.indexOf(s);return a>-1&&a>c}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(bu.customProperties,this.constructor.customProperties||[]);let t;const n=Ve.NUM_FRACTION_DIGITS,{clipPath:i,fill:s,stroke:a,shadow:c,strokeDashArray:u,left:h,top:d,originX:g,originY:p,width:y,height:w,strokeWidth:_,strokeLineCap:S,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:M,scaleX:L,scaleY:N,angle:H,flipX:R,flipY:X,opacity:U,visible:K,backgroundColor:$,fillRule:G,paintFirst:re,globalCompositeOperation:fe,skewX:Q,skewY:ue}=this;i&&!i.excludeFromExport&&(t=i.toObject(e.concat("inverted","absolutePositioned")));const oe=de=>at(de,n),se=j(j({},Li(this,e)),{},{type:this.constructor.type,version:sd,originX:g,originY:p,left:oe(h),top:oe(d),width:oe(y),height:oe(w),fill:h1(s)?s.toObject():s,stroke:h1(a)?a.toObject():a,strokeWidth:oe(_),strokeDashArray:u&&u.concat(),strokeLineCap:S,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:oe(M),scaleX:oe(L),scaleY:oe(N),angle:oe(H),flipX:R,flipY:X,opacity:oe(U),shadow:c&&c.toObject(),visible:K,backgroundColor:$,fillRule:G,paintFirst:re,globalCompositeOperation:fe,skewX:oe(Q),skewY:oe(ue)},t?{clipPath:t}:null);return this.includeDefaultValues?se:this._removeDefaultValues(se)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return md(e,(i,s)=>{if(s===Ue||s===ir||s==="type")return!0;const a=n[s];return i!==a&&!(Array.isArray(i)&&Array.isArray(a)&&i.length===0&&a.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=ot(e,uM),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:i}=n,s=ot(n,hM);return Bo(t,s).then(a=>i?(delete a[i],new this(t[i],a)):new this(a))}static fromObject(e,t){return this._fromObject(e,t)}};F(On,"stateProperties",JA),F(On,"cacheProperties",Mn),F(On,"ownDefaults",QA),F(On,"type","FabricObject"),F(On,"colorProperties",[It,or,"backgroundColor"]),F(On,"customProperties",[]),ie.setClass(On),ie.setClass(On,"object");const ci=(r,e,t)=>(n,i,s,a)=>{const c=e(n,i,s,a);return c&&_d(r,j(j({},Sd(n,i,s,a)),t)),c};function Bi(r){return(e,t,n,i)=>{const{target:s,originX:a,originY:c}=t,u=s.getRelativeCenterPoint(),h=s.translateToOriginPoint(u,a,c),d=r(e,t,n,i);return s.setPositionByOrigin(h,t.originX,t.originY),d}}const jd=ci(Fo,Bi((r,e,t,n)=>{const i=Ac(e,e.originX,e.originY,t,n);if(Tt(e.originX)===Tt(Ee)||Tt(e.originX)===Tt(wt)&&i.x<0||Tt(e.originX)===Tt(Ue)&&i.x>0){const{target:s}=e,a=s.strokeWidth/(s.strokeUniform?s.scaleX:1),c=_1(e)?2:1,u=s.width,h=Math.abs(i.x*c/s.scaleX)-a;return s.set("width",Math.max(h,1)),u!==s.width}return!1}));function R1(r,e,t,n,i){n=n||{};const s=this.sizeX||n.cornerSize||i.cornerSize,a=this.sizeY||n.cornerSize||i.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:i.transparentCorners,u=c?or:It,h=!c&&(n.cornerStrokeColor||i.cornerStrokeColor);let d,g=e,p=t;r.save(),r.fillStyle=n.cornerColor||i.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||i.cornerStrokeColor||"",s>a?(d=s,r.scale(1,a/s),p=t*s/a):a>s?(d=a,r.scale(s/a,1),g=e*a/s):d=s,r.beginPath(),r.arc(g,p,d/2,0,kn,!1),r[u](),h&&r.stroke(),r.restore()}function V1(r,e,t,n,i){n=n||{};const s=this.sizeX||n.cornerSize||i.cornerSize,a=this.sizeY||n.cornerSize||i.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:i.transparentCorners,u=c?or:It,h=!c&&(n.cornerStrokeColor||i.cornerStrokeColor),d=s/2,g=a/2;r.save(),r.fillStyle=n.cornerColor||i.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||i.cornerStrokeColor||"",r.translate(e,t);const p=i.getTotalAngle();r.rotate(pt(p)),r["".concat(u,"Rect")](-d,-g,s,a),h&&r.strokeRect(-d,-g,s,a),r.restore()}class ut{constructor(e){F(this,"visible",!0),F(this,"actionName",bc),F(this,"angle",0),F(this,"x",0),F(this,"y",0),F(this,"offsetX",0),F(this,"offsetY",0),F(this,"sizeX",0),F(this,"sizeY",0),F(this,"touchSizeX",0),F(this,"touchSizeY",0),F(this,"cursorStyle","crosshair"),F(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,i){var s;let{tl:a,tr:c,br:u,bl:h}=i;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&lt.isPointInPolygon(n,[a,c,u,h])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,i;return(n=(i=e._controlsVisibility)===null||i===void 0?void 0:i[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,i){return new z(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,i,s,a){const c=Sc([Fs(n,i),Ns({angle:e}),Cc((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new z(-.5,-.5).transform(c),tr:new z(.5,-.5).transform(c),br:new z(.5,.5).transform(c),bl:new z(-.5,.5).transform(c)}}render(e,t,n,i,s){((i=i||{}).cornerStyle||s.cornerStyle)==="circle"?R1.call(this,e,t,n,i,s):V1.call(this,e,t,n,i,s)}}const B1=(r,e,t)=>t.lockRotation?Ic:e.cursorStyle,z1=ci(qv,Bi((r,e,t,n)=>{let{target:i,ex:s,ey:a,theta:c,originX:u,originY:h}=e;const d=i.translateToOriginPoint(i.getRelativeCenterPoint(),u,h);if(Jr(i,"lockRotation"))return!1;const g=Math.atan2(a-d.y,s-d.x),p=Math.atan2(n-d.y,t-d.x);let y=ai(p-g+c);if(i.snapAngle&&i.snapAngle>0){const _=i.snapAngle,S=i.snapThreshold||_,T=Math.ceil(y/_)*_,k=Math.floor(y/_)*_;Math.abs(y-k)<S?y=k:Math.abs(y-T)<S&&(y=T)}y<0&&(y=360+y),y%=360;const w=i.angle!==y;return i.angle=y,w}));function H1(r,e){const t=e.canvas,n=r[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function W1(r,e,t){const n=Jr(r,"lockScalingX"),i=Jr(r,"lockScalingY");if(n&&i||!e&&(n||i)&&t||n&&e==="x"||i&&e==="y")return!0;const{width:s,height:a,strokeWidth:c}=r;return s===0&&c===0&&e!=="y"||a===0&&c===0&&e!=="x"}const dM=["e","se","s","sw","w","nw","n","ne","e"],zs=(r,e,t)=>{const n=H1(r,t);if(W1(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Ic;const i=C1(t,e);return"".concat(dM[i],"-resize")};function Ld(r,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=e.target,a=i.by,c=H1(r,s);let u,h,d,g,p,y;if(W1(s,a,c))return!1;if(e.gestureScale)h=e.scaleX*e.gestureScale,d=e.scaleY*e.gestureScale;else{if(u=Ac(e,e.originX,e.originY,t,n),p=a!=="y"?Math.sign(u.x||e.signX||1):1,y=a!=="x"?Math.sign(u.y||e.signY||1):1,e.signX||(e.signX=p),e.signY||(e.signY=y),Jr(s,"lockScalingFlip")&&(e.signX!==p||e.signY!==y))return!1;if(g=s._getTransformedDimensions(),c&&!a){const S=Math.abs(u.x)+Math.abs(u.y),{original:T}=e,k=S/(Math.abs(g.x*T.scaleX/s.scaleX)+Math.abs(g.y*T.scaleY/s.scaleY));h=T.scaleX*k,d=T.scaleY*k}else h=Math.abs(u.x*s.scaleX/g.x),d=Math.abs(u.y*s.scaleY/g.y);_1(e)&&(h*=2,d*=2),e.signX!==p&&a!=="y"&&(e.originX=S1(e.originX),h*=-1,e.signX=p),e.signY!==y&&a!=="x"&&(e.originY=S1(e.originY),d*=-1,e.signY=y)}const w=s.scaleX,_=s.scaleY;return a?(a==="x"&&s.set(Zt,h),a==="y"&&s.set(mr,d)):(!Jr(s,"lockScalingX")&&s.set(Zt,h),!Jr(s,"lockScalingY")&&s.set(mr,d)),w!==s.scaleX||_!==s.scaleY}const $o=ci(vc,Bi((r,e,t,n)=>Ld(r,e,t,n))),U1=ci(vc,Bi((r,e,t,n)=>Ld(r,e,t,n,{by:"x"}))),$1=ci(vc,Bi((r,e,t,n)=>Ld(r,e,t,n,{by:"y"}))),fM=["target","ex","ey","skewingSide"],Fd={x:{counterAxis:"y",scale:Zt,skew:Ps,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:mr,skew:Ds,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},gM=["ns","nesw","ew","nwse"],Y1=(r,e,t)=>{if(e.x!==0&&Jr(t,"lockSkewingY")||e.y!==0&&Jr(t,"lockSkewingX"))return Ic;const n=C1(t,e)%4;return"".concat(gM[n],"-resize")};function X1(r,e,t,n,i){const{target:s}=t,{counterAxis:a,origin:c,lockSkewing:u,skew:h,flip:d}=Fd[r];if(Jr(s,u))return!1;const{origin:g,flip:p}=Fd[a],y=Tt(t[g])*(s[p]?-1:1),w=-Math.sign(y)*(s[d]?-1:1),_=.5*-((s[h]===0&&Ac(t,Ee,Ee,n,i)[r]>0||s[h]>0?1:-1)*w)+.5;return ci(Kv,Bi((T,k,I,M)=>function(L,N,H){let{target:R,ex:X,ey:U,skewingSide:K}=N,$=ot(N,fM);const{skew:G}=Fd[L],re=H.subtract(new z(X,U)).divide(new z(R.scaleX,R.scaleY))[L],fe=R[G],Q=$[G],ue=Math.tan(pt(Q)),oe=L==="y"?R._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:R._getTransformedDimensions({scaleX:1,scaleY:1}).y,se=2*re*K/Math.max(oe,1)+ue,de=ai(Math.atan(se));R.set(G,de);const ne=fe!==R[G];if(ne&&L==="y"){const{skewX:Fe,scaleX:Ge}=R,Re=R._getTransformedDimensions({skewY:fe}),_e=R._getTransformedDimensions(),ke=Fe!==0?Re.x/_e.x:1;ke!==1&&R.set(Zt,ke*Ge)}return ne}(r,k,new z(I,M))))(e,j(j({},t),{},{[c]:_,skewingSide:w}),n,i)}const G1=(r,e,t,n)=>X1("x",r,e,t,n),q1=(r,e,t,n)=>X1("y",r,e,t,n);function Lc(r,e){return r[e.canvas.altActionKey]}const Yo=(r,e,t)=>{const n=Lc(r,t);return e.x===0?n?Ps:mr:e.y===0?n?Ds:Zt:""},zi=(r,e,t)=>Lc(r,t)?Y1(0,e,t):zs(r,e,t),Nd=(r,e,t,n)=>Lc(r,e.target)?q1(r,e,t,n):U1(r,e,t,n),Rd=(r,e,t,n)=>Lc(r,e.target)?G1(r,e,t,n):$1(r,e,t,n),Vd=()=>({ml:new ut({x:-.5,y:0,cursorStyleHandler:zi,actionHandler:Nd,getActionName:Yo}),mr:new ut({x:.5,y:0,cursorStyleHandler:zi,actionHandler:Nd,getActionName:Yo}),mb:new ut({x:0,y:.5,cursorStyleHandler:zi,actionHandler:Rd,getActionName:Yo}),mt:new ut({x:0,y:-.5,cursorStyleHandler:zi,actionHandler:Rd,getActionName:Yo}),tl:new ut({x:-.5,y:-.5,cursorStyleHandler:zs,actionHandler:$o}),tr:new ut({x:.5,y:-.5,cursorStyleHandler:zs,actionHandler:$o}),bl:new ut({x:-.5,y:.5,cursorStyleHandler:zs,actionHandler:$o}),br:new ut({x:.5,y:.5,cursorStyleHandler:zs,actionHandler:$o}),mtr:new ut({x:0,y:-.5,actionHandler:z1,cursorStyleHandler:B1,offsetY:-40,withConnection:!0,actionName:ud})}),K1=()=>({mr:new ut({x:.5,y:0,actionHandler:jd,cursorStyleHandler:zi,actionName:Fo}),ml:new ut({x:-.5,y:0,actionHandler:jd,cursorStyleHandler:zi,actionName:Fo})}),Z1=()=>j(j({},Vd()),K1());class Xo extends On{static getDefaults(){return j(j({},super.getDefaults()),Xo.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),Xo.ownDefaults),this.setOptions(e)}static createControls(){return{controls:Vd()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,i=t.action;if(this===n&&i&&i.startsWith(bc))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let i=n.length-1;i>=0;i--){const[s,a]=n[i],c=this.controls[s];if(c.shouldActivate(s,this,e,t?a.touchCorner:a.corner))return this.__corner=s,{key:s,control:c,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=Fs(t.x,t.y),i=Ns({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=mt(n,i),a=mt(e,s),c=mt(a,[1/e[0],0,0,1/e[3],0,0]),u=this.group?Ls(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const h=this._calculateCurrentDimensions(u),d={};return this.forEachControl((g,p)=>{const y=g.positionHandler(h,c,this,g);d[p]=Object.assign(y,this._calcCornerCoords(g,y))}),d}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),i=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/i[0],1/i[3]),e.rotate(pt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=j({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=i.borderColor,this._setLineDash(e,i.borderDashArray),this.strokeBorders(e,t),i.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:i}=this,s=j({hasBorders:n,hasControls:i},t),a=this.getViewportTransform(),c=s.hasBorders,u=s.hasControls,h=mt(a,this.calcTransformMatrix()),d=Ls(h);e.save(),e.translate(d.translateX,d.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),e.rotate(pt(this.group?d.angle:this.angle)),c&&this.drawBorders(e,d,t),u&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let i;if(n&&n.forActiveSelection||this.group){const s=kc(this.width,this.height,Ro(t)),a=this.isStrokeAccountedForInDimensions()?dd:(this.strokeUniform?new z().scalarAdd(this.canvas?this.canvas.getZoom():1):new z(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);i=s.add(a).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,i,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((i,s)=>{i.withConnection&&i.getVisibility(this,s)&&(n=!0,e.moveTo(i.x*t.x,i.y*t.y),e.lineTo(i.x*t.x+i.offsetX,i.y*t.y+i.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:s,cornerColor:a}=this,c=j({cornerStrokeColor:i,cornerDashArray:s,cornerColor:a},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=c.cornerColor,this.transparentCorners||(e.strokeStyle=c.cornerStrokeColor),this._setLineDash(e,c.cornerDashArray),this.forEachControl((u,h)=>{if(u.getVisibility(this,h)){const d=this.oCoords[h];u.render(e,d.x,d.y,c,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,i]=t;return this.setControlVisible(n,i)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const i=this.width+4,s=this.height+4;return t.clearRect(-i/2,-s/2,i,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function J1(r,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),r}F(Xo,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Ze extends Xo{}J1(Ze,[E1]),ie.setClass(Ze),ie.setClass(Ze,"object");const Q1=(r,e,t,n)=>{const i=2*(n=Math.round(n))+1,{data:s}=r.getImageData(e-n,t-n,i,i);for(let a=3;a<s.length;a+=4)if(s[a]>0)return!1;return!0};class ey{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new z(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new z(1/this.options.scaleX,1/this.options.scaleY):new z(1,1)}createSideVector(e,t){const n=Oc(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new z(e);return t.y+=t.x*Math.tan(pt(this.options.skewY)),t.x+=t.y*Math.tan(pt(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const pM=new z;class Hs extends ey{static getOrthogonalRotationFactor(e,t){const n=t?Dc(e,t):M1(e);return Math.abs(n)<ii?-1:1}constructor(e,t,n,i){super(i),F(this,"AB",void 0),F(this,"AC",void 0),F(this,"alpha",void 0),F(this,"bisector",void 0),this.A=new z(e),this.B=new z(t),this.C=new z(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Dc(this.AB,this.AC),this.bisector=jc(Ed(this.AB.eq(pM)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(e,t),s=kd(i),a=Hs.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,n*a)}projectBevel(){const e=[];return(this.alpha%kn==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),s=this.options.strokeUniform?Pc(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Pc(i)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(i))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],i=new z(Hs.getOrthogonalRotationFactor(this.bisector),Hs.getOrthogonalRotationFactor(new z(this.bisector.y,this.bisector.x)));return[new z(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new z(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach(s=>{Id(s,e,t)&&n.push(this.A.add(s))}),n}projectRoundWithSkew(e,t){const n=[],{skewX:i,skewY:s,scaleX:a,scaleY:c,strokeUniform:u}=this.options,h=new z(Math.tan(pt(i)),Math.tan(pt(s))),d=this.strokeProjectionMagnitude,g=u?d/c/Math.sqrt(1/c**2+1/a**2*h.y**2):d/Math.sqrt(1+h.y**2),p=new z(Math.sqrt(Math.max(d**2-g**2,0)),g),y=u?d/Math.sqrt(1+h.x**2*(1/c)**2/(1/a+1/a*h.x*h.y)**2):d/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),w=new z(y,Math.sqrt(Math.max(d**2-y**2,0)));return[w,w.scalarMultiply(-1),p,p.scalarMultiply(-1)].map(_=>this.applySkew(u?_.multiply(this.strokeUniformScalar):_)).forEach(_=>{Id(_,e,t)&&n.push(this.applySkew(this.A).add(_))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%kn==0,n=this.applySkew(this.A),i=e[t?0:2].subtract(n),s=e[t?1:0].subtract(n),a=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),c=Bs(i,a)>0,u=c?i:s,h=c?s:i;return this.isSkewed()?e.push(...this.projectRoundWithSkew(u,h)):e.push(...this.projectRoundNoSkew(u,h)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class ty extends ey{constructor(e,t,n){super(n),this.A=new z(e),this.T=new z(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(e,t);return this.scaleUnitVector(kd(i),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new z(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Hs(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new z(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(jc(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(n);e.push(i.add(t),i.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const ry=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(r.length===0)return n;const i=r.reduce((s,a)=>(s[s.length-1].eq(a)||s.push(new z(a)),s),[new z(r[0])]);if(i.length===1)t=!0;else if(!t){const s=i[0],a=((c,u)=>{for(let h=c.length-1;h>=0;h--)if(u(c[h],h,c))return h;return-1})(i,c=>!c.eq(s));i.splice(a+1)}return i.forEach((s,a,c)=>{let u,h;a===0?(h=c[1],u=t?s:c[c.length-1]):a===c.length-1?(u=c[a-1],h=t?s:c[0]):(u=c[a-1],h=c[a+1]),t&&c.length===1?n.push(...new ty(s,s,e).project()):!t||a!==0&&a!==c.length-1?n.push(...new Hs(s,u,h,e).project()):n.push(...new ty(s,a===0?h:u,e).project())}),n},Bd=r=>{const e={};return Object.keys(r).forEach(t=>{e[t]={},Object.keys(r[t]).forEach(n=>{e[t][n]=j({},r[t][n])})}),e},ny=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Fc=r=>{const e=[];for(let t,n=0;n<r.length;n++)(t=mM(r,n))!==!1&&e.push(t);return e},mM=(r,e)=>{const t=r.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return r.charAt(e);if(55296<=t&&t<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";const i=r.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=r.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var vM=Object.freeze({__proto__:null,capitalize:function(r){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(e?r.slice(1):r.slice(1).toLowerCase())},escapeXml:ny,graphemeSplit:Fc});const Nc=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||t&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},iy=(r,e)=>{const t=e.split(`
`),n=[];let i=-1,s={};r=Bd(r);for(let a=0;a<t.length;a++){const c=Fc(t[a]);if(r[a])for(let u=0;u<c.length;u++){i++;const h=r[a][u];h&&Object.keys(h).length>0&&(Nc(s,h,!0)?n.push({start:i,end:i+1,style:h}):n[n.length-1].end++),s=h||{}}else i+=c.length,s={}}return n},sy=(r,e)=>{if(!Array.isArray(r))return Bd(r);const t=e.split(ld),n={};let i=-1,s=0;for(let a=0;a<t.length;a++){const c=Fc(t[a]);for(let u=0;u<c.length;u++)i++,r[s]&&r[s].start<=i&&i<r[s].end&&(n[a]=n[a]||{},n[a][u]=j({},r[s].style),i===r[s].end-1&&s++)}return n},li=["display","transform",It,"fill-opacity","fill-rule","opacity",or,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function oy(r,e){const t=r.nodeName,n=r.getAttribute("class"),i=r.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let a;if(a=new RegExp("^"+t,"i"),e=e.replace(a,""),i&&e.length&&(a=new RegExp("#"+i+s,"i"),e=e.replace(a,"")),n&&e.length){const c=n.split(" ");for(let u=c.length;u--;)a=new RegExp("\\."+c[u]+s,"i"),e=e.replace(a,"")}return e.length===0}function yM(r,e){let t=!0;const n=oy(r,e.pop());return n&&e.length&&(t=function(i,s){let a,c=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&s.length;)c&&(a=s.pop()),c=oy(i=i.parentElement,a);return s.length===0}(r,e)),n&&t&&e.length===0}const bM=r=>{var e;return(e=KA[r])!==null&&e!==void 0?e:r},wM=new RegExp("(".concat(Ri,")"),"gi"),xM=r=>r.replace(wM," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var ay,cy,ly,uy,hy,dy,fy;const Jt="(".concat(Ri,")"),_M=String.raw(ay||(ay=ri(["(skewX)(",")"],["(skewX)\\(","\\)"])),Jt),SM=String.raw(cy||(cy=ri(["(skewY)(",")"],["(skewY)\\(","\\)"])),Jt),CM=String.raw(ly||(ly=ri(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Jt,Jt,Jt),TM=String.raw(uy||(uy=ri(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Jt,Jt),EM=String.raw(hy||(hy=ri(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Jt,Jt),kM=String.raw(dy||(dy=ri(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Jt,Jt,Jt,Jt,Jt,Jt),zd="(?:".concat(kM,"|").concat(EM,"|").concat(CM,"|").concat(TM,"|").concat(_M,"|").concat(SM,")"),IM="(?:".concat(zd,"*)"),AM=String.raw(fy||(fy=ri(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),IM),MM=new RegExp(AM),OM=new RegExp(zd),PM=new RegExp(zd,"g");function Hd(r){const e=[];if(!(r=xM(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!MM.test(r))return[...Kt];for(const t of r.matchAll(PM)){const n=OM.exec(t[0]);if(!n)continue;let i=Kt;const s=n.filter(w=>!!w),[,a,...c]=s,[u,h,d,g,p,y]=c.map(w=>parseFloat(w));switch(a){case"translate":i=Fs(u,h);break;case ud:i=Ns({angle:u},{x:h,y:d});break;case bc:i=Cc(u,h);break;case Ps:i=gd(u);break;case Ds:i=pd(u);break;case"matrix":i=[u,h,d,g,p,y]}e.push(i)}return Sc(e)}function DM(r,e,t,n){const i=Array.isArray(e);let s,a=e;if(r!==It&&r!==or||e!==sr){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")a=e===sr?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")a=t&&t.transformMatrix?mt(t.transformMatrix,Hd(e)):Hd(e);else if(r==="visible")a=e!==sr&&e!=="hidden",t&&t.visible===!1&&(a=!1);else if(r==="opacity")a=parseFloat(e),t&&t.opacity!==void 0&&(a*=t.opacity);else if(r==="textAnchor")a=e==="start"?Ue:e==="end"?wt:Ee;else if(r==="charSpacing")s=Fi(e,n)/n*1e3;else if(r==="paintFirst"){const c=e.indexOf(It),u=e.indexOf(or);a=It,(c>-1&&u>-1&&u<c||c===-1&&u>-1)&&(a=or)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";s=i?e.map(Fi):Fi(e,n)}}else a="";return!i&&isNaN(s)?a:s}function jM(r,e){const t=r.match(qA);if(!t)return;const n=t[1],i=t[3],s=t[4],a=t[5],c=t[6];n&&(e.fontStyle=n),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),s&&(e.fontSize=Fi(s)),c&&(e.fontFamily=c),a&&(e.lineHeight=a==="normal"?1:a)}function LM(r,e){r.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[n,i]=t.split(":");e[n.trim().toLowerCase()]=i.trim()})}function FM(r){const e={},t=r.getAttribute("style");return t&&(typeof t=="string"?LM(t,e):function(n,i){Object.entries(n).forEach(s=>{let[a,c]=s;c!==void 0&&(i[a.toLowerCase()]=c)})}(t,e)),e}const NM={stroke:"strokeOpacity",fill:"fillOpacity"};function Pn(r,e,t){if(!r)return{};let n,i={},s=ad;r.parentNode&&I1.test(r.parentNode.nodeName)&&(i=Pn(r.parentElement,e,t),i.fontSize&&(n=s=Fi(i.fontSize)));const a=j(j(j({},e.reduce((h,d)=>{const g=r.getAttribute(d);return g&&(h[d]=g),h},{})),function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g={};for(const p in d)yM(h,p.split(" "))&&(g=j(j({},g),d[p]));return g}(r,t)),FM(r));a[Td]&&r.setAttribute(Td,a[Td]),a[Cd]&&(n=Fi(a[Cd],s),a[Cd]="".concat(n));const c={};for(const h in a){const d=bM(h),g=DM(d,a[h],i,n);c[d]=g}c&&c.font&&jM(c.font,c);const u=j(j({},i),c);return I1.test(r.nodeName)?u:function(h){const d=Ze.getDefaults();return Object.entries(NM).forEach(g=>{let[p,y]=g;if(h[y]===void 0||h[p]==="")return;if(h[p]===void 0){if(!d[p])return;h[p]=d[p]}if(h[p].indexOf("url(")===0)return;const w=new Xe(h[p]);h[p]=w.setAlpha(at(w.getAlpha()*h[y],2)).toRgba()}),h}(u)}const RM=["left","top","width","height","visible"],gy=["rx","ry"];class Et extends Ze{static getDefaults(){return j(j({},super.getDefaults()),Et.ownDefaults)}constructor(e){super(),Object.assign(this,Et.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,i=-t/2,s=-n/2,a=this.rx?Math.min(this.rx,t/2):0,c=this.ry?Math.min(this.ry,n/2):0,u=a!==0||c!==0;e.beginPath(),e.moveTo(i+a,s),e.lineTo(i+t-a,s),u&&e.bezierCurveTo(i+t-si*a,s,i+t,s+si*c,i+t,s+c),e.lineTo(i+t,s+n-c),u&&e.bezierCurveTo(i+t,s+n-si*c,i+t-si*a,s+n,i+t-a,s+n),e.lineTo(i+a,s+n),u&&e.bezierCurveTo(i+si*a,s+n,i,s+n-si*c,i,s+n-c),e.lineTo(i,s+c),u&&e.bezierCurveTo(i,s+si*c,i+si*a,s,i+a,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...gy,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:i}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(i,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const i=Pn(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:a=0,width:c=0,height:u=0,visible:h=!0}=i,d=ot(i,RM);return new this(j(j(j({},t),d),{},{left:s,top:a,width:c,height:u,visible:!!(h&&c&&u)}))}}F(Et,"type","Rect"),F(Et,"cacheProperties",[...Mn,...gy]),F(Et,"ownDefaults",{rx:0,ry:0}),F(Et,"ATTRIBUTE_NAMES",[...li,"x","y","rx","ry","width","height"]),ie.setClass(Et),ie.setSVGClass(Et);const Dn="initialization",Rc="added",Wd="removed",Vc="imperative",py=(r,e)=>{const{strokeUniform:t,strokeWidth:n,width:i,height:s,group:a}=e,c=a&&a!==r?Uo(a.calcTransformMatrix(),r.calcTransformMatrix()):null,u=c?e.getRelativeCenterPoint().transform(c):e.getRelativeCenterPoint(),h=!e.isStrokeAccountedForInDimensions(),d=t&&h?x1(new z(n,n),void 0,r.calcTransformMatrix()):dd,g=!t&&h?n:0,p=kc(i+g,s+g,Sc([c,e.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[u.subtract(p),u.add(p)]};class Bc{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:i}=e;return t===Dn||t===Vc||!!n&&i!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==Dn&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:i}=t;if(n===Vc&&t.overrides)return t.overrides;if(e.length===0)return;const{left:s,top:a,width:c,height:u}=pn(e.map(g=>py(i,g)).reduce((g,p)=>g.concat(p),[])),h=new z(c,u),d=new z(s,a).add(h.scalarDivide(2));if(n===Dn){const g=this.getInitialSize(t,{size:h,center:d});return{center:d,relativeCorrection:new z(0,0),size:g}}return{center:d.transform(i.calcOwnMatrix()),size:h}}}F(Bc,"type","strategy");class Ud extends Bc{shouldPerformLayout(e){return!0}}F(Ud,"type","fit-content"),ie.setClass(Ud);const VM=["strategy"],BM=["target","strategy","bubbles","prevStrategy"],my="layoutManager";class Go{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Ud;F(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=j(j({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[wc,Gv,Fo,qv,vc,Kv,yc,Zv,HA].map(i=>e.on(i,s=>this.performLayout(i===wc?{type:"object_modified",trigger:i,e:s,target:n}:{type:"object_modifying",trigger:i,e:s,target:n})))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:i}=t;if(n===Dn||n===Rc?this.subscribeTargets(e):n===Wd&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),i&&i.fire("object:layout:before",{target:t,context:e}),n===Vc&&e.deep){const s=ot(e,VM);t.forEachObject(a=>a.layoutManager&&a.layoutManager.performLayout(j(j({},s),{},{bubbles:!1,target:a})))}}getLayoutResult(e){const{target:t,strategy:n,type:i}=e,s=n.calcLayoutResult(e,t.getObjects());if(!s)return;const a=i===Dn?new z:t.getRelativeCenterPoint(),{center:c,correction:u=new z,relativeCorrection:h=new z}=s,d=a.subtract(c).add(u).transform(i===Dn?Kt:vr(t.calcOwnMatrix()),!0).add(h);return{result:s,prevCenter:a,nextCenter:c,offset:d}}commitLayout(e,t){const{target:n}=e,{result:{size:i},nextCenter:s}=t;var a,c;n.set({width:i.x,height:i.y}),this.layoutObjects(e,t),e.type===Dn?n.set({left:(a=e.x)!==null&&a!==void 0?a:s.x+i.x*Tt(n.originX),top:(c=e.y)!==null&&c!==void 0?c:s.y+i.y*Tt(n.originY)}):(n.setPositionByOrigin(s,Ee,Ee),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject(i=>{i.group===n&&this.layoutObject(e,t,i)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:i}=t;n.set({left:n.left+i.x,top:n.top+i.y})}onAfterLayout(e,t){const{target:n,strategy:i,bubbles:s,prevStrategy:a}=e,c=ot(e,BM),{canvas:u}=n;n.fire("layout:after",{context:e,result:t}),u&&u.fire("object:layout:after",{context:e,result:t,target:n});const h=n.parent;s&&h!=null&&h.layoutManager&&((c.path||(c.path=[])).push(n),h.layoutManager.performLayout(j(j({},c),{},{target:h}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(n=>n())),e.clear()}toObject(){return{type:my,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ie.setClass(Go,my);const zM=["type","objects","layoutManager"];class HM extends Go{performLayout(){}}class jr extends Jv(Ze){static getDefaults(){return j(j({},super.getDefaults()),jr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),F(this,"_activeObjects",[]),F(this,"__objectSelectionTracker",void 0),F(this,"__objectSelectionDisposer",void 0),Object.assign(this,jr.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(i=>{this.enterGroup(i,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new Go,this.layoutManager.performLayout({type:Dn,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(ni("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(ni("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,i)=>this.canEnterGroup(t)&&i.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...i);return this._onAfterObjectsChange(Rc,i),s}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const s=this._filterObjectsBeforeEnteringGroup(n),a=super.insertAt(e,...s);return this._onAfterObjectsChange(Rc,s),a}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(Wd,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(i=>{i._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const i=this._activeObjects;if(e)i.push(n),this._set("dirty",!0);else if(i.length>0){const s=i.indexOf(n);s>-1&&(i.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&Vs(e,mt(vr(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(Vs(e,mt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Ze.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var i;const a=this._objects[s];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&a.group!==this?(e.save(),e.transform(...vr(this.calcTransformMatrix())),a.render(e),e.restore()):a.group===this&&a.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(j({target:this,type:Vc},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter(function(i){return!i.excludeFromExport}).map(function(i){const s=i.includeDefaultValues;i.includeDefaultValues=n;const a=i[e||"toObject"](t);return i.includeDefaultValues=s,a})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return j(j(j({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=Et.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const i=t.join("");return e?e(i):i}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let i=0;i<this._objects.length;i++)t.push("		",this._objects[i].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let i=0;i<this._objects.length;i++)t.push("	",this._objects[i].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:i=[],layoutManager:s}=e,a=ot(e,zM);return Promise.all([Rs(i,t),Bo(a,t)]).then(c=>{let[u,h]=c;const d=new this(u,j(j(j({},a),h),{},{layoutManager:new HM}));if(s){const g=ie.getClass(s.type),p=ie.getClass(s.strategy);d.layoutManager=new g(new p)}else d.layoutManager=new Go;return d.layoutManager.subscribeTargets({type:Dn,target:d,targets:d.getObjects()}),d.setCoords(),d})}}F(jr,"type","Group"),F(jr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ie.setClass(jr);const vy=(r,e)=>Math.min(e.width/r.width,e.height/r.height),yy=(r,e)=>Math.max(e.width/r.width,e.height/r.height),$d="\\s*,?\\s*",qo="".concat($d,"(").concat(Ri,")"),WM="".concat(qo).concat(qo).concat(qo).concat($d,"([01])").concat($d,"([01])").concat(qo).concat(qo),UM={m:"l",M:"L"},$M=(r,e,t,n,i,s,a,c,u,h,d)=>{const g=Gr(r),p=qr(r),y=Gr(e),w=qr(e),_=t*i*y-n*s*w+a,S=n*i*y+t*s*w+c;return["C",h+u*(-t*i*p-n*s*g),d+u*(-n*i*p+t*s*g),_+u*(t*i*w+n*s*y),S+u*(n*i*w-t*s*y),_,S]},by=(r,e,t,n)=>{const i=Math.atan2(e,r),s=Math.atan2(n,t);return s>=i?s-i:2*Math.PI-(i-s)};function Yd(r,e,t,n,i,s,a,c){let u;if(Ve.cachesBoundsOfCurve&&(u=[...arguments].join(),Lo.boundsOfCurveCache[u]))return Lo.boundsOfCurveCache[u];const h=Math.sqrt,d=Math.abs,g=[],p=[[0,0],[0,0]];let y=6*r-12*t+6*i,w=-3*r+9*t-9*i+3*a,_=3*t-3*r;for(let M=0;M<2;++M){if(M>0&&(y=6*e-12*n+6*s,w=-3*e+9*n-9*s+3*c,_=3*n-3*e),d(w)<1e-12){if(d(y)<1e-12)continue;const X=-_/y;0<X&&X<1&&g.push(X);continue}const L=y*y-4*_*w;if(L<0)continue;const N=h(L),H=(-y+N)/(2*w);0<H&&H<1&&g.push(H);const R=(-y-N)/(2*w);0<R&&R<1&&g.push(R)}let S=g.length;const T=S,k=xy(r,e,t,n,i,s,a,c);for(;S--;){const{x:M,y:L}=k(g[S]);p[0][S]=M,p[1][S]=L}p[0][T]=r,p[1][T]=e,p[0][T+1]=a,p[1][T+1]=c;const I=[new z(Math.min(...p[0]),Math.min(...p[1])),new z(Math.max(...p[0]),Math.max(...p[1]))];return Ve.cachesBoundsOfCurve&&(Lo.boundsOfCurveCache[u]=I),I}const YM=(r,e,t)=>{let[n,i,s,a,c,u,h,d]=t;const g=((p,y,w,_,S,T,k)=>{if(w===0||_===0)return[];let I=0,M=0,L=0;const N=Math.PI,H=k*od,R=qr(H),X=Gr(H),U=.5*(-X*p-R*y),K=.5*(-X*y+R*p),$=w**2,G=_**2,re=K**2,fe=U**2,Q=$*G-$*re-G*fe;let ue=Math.abs(w),oe=Math.abs(_);if(Q<0){const Ot=Math.sqrt(1-Q/($*G));ue*=Ot,oe*=Ot}else L=(S===T?-1:1)*Math.sqrt(Q/($*re+G*fe));const se=L*ue*K/oe,de=-L*oe*U/ue,ne=X*se-R*de+.5*p,Fe=R*se+X*de+.5*y;let Ge=by(1,0,(U-se)/ue,(K-de)/oe),Re=by((U-se)/ue,(K-de)/oe,(-U-se)/ue,(-K-de)/oe);T===0&&Re>0?Re-=2*N:T===1&&Re<0&&(Re+=2*N);const _e=Math.ceil(Math.abs(Re/N*2)),ke=[],ht=Re/_e,ar=8/3*Math.sin(ht/4)*Math.sin(ht/4)/Math.sin(ht/2);let Vt=Ge+ht;for(let Ot=0;Ot<_e;Ot++)ke[Ot]=$M(Ge,Vt,X,R,ue,oe,ne,Fe,ar,I,M),I=ke[Ot][5],M=ke[Ot][6],Ge=Vt,Vt+=ht;return ke})(h-r,d-e,i,s,c,u,a);for(let p=0,y=g.length;p<y;p++)g[p][1]+=r,g[p][2]+=e,g[p][3]+=r,g[p][4]+=e,g[p][5]+=r,g[p][6]+=e;return g},wy=r=>{let e=0,t=0,n=0,i=0;const s=[];let a,c=0,u=0;for(const h of r){const d=[...h];let g;switch(d[0]){case"l":d[1]+=e,d[2]+=t;case"L":e=d[1],t=d[2],g=["L",e,t];break;case"h":d[1]+=e;case"H":e=d[1],g=["L",e,t];break;case"v":d[1]+=t;case"V":t=d[1],g=["L",e,t];break;case"m":d[1]+=e,d[2]+=t;case"M":e=d[1],t=d[2],n=d[1],i=d[2],g=["M",e,t];break;case"c":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t,d[5]+=e,d[6]+=t;case"C":c=d[3],u=d[4],e=d[5],t=d[6],g=["C",d[1],d[2],c,u,e,t];break;case"s":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"S":a==="C"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[3],t=d[4],g=["C",c,u,d[1],d[2],e,t],c=g[3],u=g[4];break;case"q":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"Q":c=d[1],u=d[2],e=d[3],t=d[4],g=["Q",c,u,e,t];break;case"t":d[1]+=e,d[2]+=t;case"T":a==="Q"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[1],t=d[2],g=["Q",c,u,e,t];break;case"a":d[6]+=e,d[7]+=t;case"A":YM(e,t,d).forEach(p=>s.push(p)),e=d[6],t=d[7];break;case"z":case"Z":e=n,t=i,g=["Z"]}g?(s.push(g),a=g[0]):a=""}return s},zc=(r,e,t,n)=>Math.sqrt((t-r)**2+(n-e)**2),xy=(r,e,t,n,i,s,a,c)=>u=>{const h=u**3,d=(y=>3*y**2*(1-y))(u),g=(y=>3*y*(1-y)**2)(u),p=(y=>(1-y)**3)(u);return new z(a*h+i*d+t*g+r*p,c*h+s*d+n*g+e*p)},_y=r=>r**2,Sy=r=>2*r*(1-r),Cy=r=>(1-r)**2,XM=(r,e,t,n,i,s,a,c)=>u=>{const h=_y(u),d=Sy(u),g=Cy(u),p=3*(g*(t-r)+d*(i-t)+h*(a-i)),y=3*(g*(n-e)+d*(s-n)+h*(c-s));return Math.atan2(y,p)},GM=(r,e,t,n,i,s)=>a=>{const c=_y(a),u=Sy(a),h=Cy(a);return new z(i*c+t*u+r*h,s*c+n*u+e*h)},qM=(r,e,t,n,i,s)=>a=>{const c=1-a,u=2*(c*(t-r)+a*(i-t)),h=2*(c*(n-e)+a*(s-n));return Math.atan2(h,u)},Ty=(r,e,t)=>{let n=new z(e,t),i=0;for(let s=1;s<=100;s+=1){const a=r(s/100);i+=zc(n.x,n.y,a.x,a.y),n=a}return i},KM=(r,e)=>{let t,n=0,i=0,s={x:r.x,y:r.y},a=j({},s),c=.01,u=0;const h=r.iterator,d=r.angleFinder;for(;i<e&&c>1e-4;)a=h(n),u=n,t=zc(s.x,s.y,a.x,a.y),t+i>e?(n-=c,c/=2):(s=a,n+=c,i+=t);return j(j({},a),{},{angle:d(u)})},Xd=r=>{let e,t,n=0,i=0,s=0,a=0,c=0;const u=[];for(const h of r){const d={x:i,y:s,command:h[0],length:0};switch(h[0]){case"M":t=d,t.x=a=i=h[1],t.y=c=s=h[2];break;case"L":t=d,t.length=zc(i,s,h[1],h[2]),i=h[1],s=h[2];break;case"C":e=xy(i,s,h[1],h[2],h[3],h[4],h[5],h[6]),t=d,t.iterator=e,t.angleFinder=XM(i,s,h[1],h[2],h[3],h[4],h[5],h[6]),t.length=Ty(e,i,s),i=h[5],s=h[6];break;case"Q":e=GM(i,s,h[1],h[2],h[3],h[4]),t=d,t.iterator=e,t.angleFinder=qM(i,s,h[1],h[2],h[3],h[4]),t.length=Ty(e,i,s),i=h[3],s=h[4];break;case"Z":t=d,t.destX=a,t.destY=c,t.length=zc(i,s,a,c),i=a,s=c}n+=t.length,u.push(t)}return u.push({length:n,x:i,y:s}),u},Ey=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xd(r),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const i=t[n],s=e/i.length,a=r[n];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return j(j({},new z(i.x,i.y).lerp(new z(i.destX,i.destY),s)),{},{angle:Math.atan2(i.destY-i.y,i.destX-i.x)});case"L":return j(j({},new z(i.x,i.y).lerp(new z(a[1],a[2]),s)),{},{angle:Math.atan2(a[2]-i.y,a[1]-i.x)});case"C":case"Q":return KM(i,e)}},ZM=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),ky=new RegExp(WM,"g"),JM=new RegExp(Ri,"gi"),QM={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Iy=r=>{var e;const t=[],n=(e=r.match(ZM))!==null&&e!==void 0?e:[];for(const i of n){const s=i[0];if(s==="z"||s==="Z"){t.push([s]);continue}const a=QM[s.toLowerCase()];let c=[];if(s==="a"||s==="A"){ky.lastIndex=0;for(let u=null;u=ky.exec(i);)c.push(...u.slice(1))}else c=i.match(JM)||[];for(let u=0;u<c.length;u+=a){const h=new Array(a),d=UM[s];h[0]=u>0&&d?d:s;for(let g=0;g<a;g++)h[g+1]=parseFloat(c[u+g]);t.push(h)}}return t},eO=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new z(r[0]),n=new z(r[1]),i=1,s=0;const a=[],c=r.length,u=c>2;let h;for(u&&(i=r[2].x<n.x?-1:r[2].x===n.x?0:1,s=r[2].y<n.y?-1:r[2].y===n.y?0:1),a.push(["M",t.x-i*e,t.y-s*e]),h=1;h<c;h++){if(!t.eq(n)){const d=t.midPointFrom(n);a.push(["Q",t.x,t.y,d.x,d.y])}t=r[h],h+1<r.length&&(n=r[h+1])}return u&&(i=t.x>r[h-2].x?1:t.x===r[h-2].x?0:-1,s=t.y>r[h-2].y?1:t.y===r[h-2].y?0:-1),a.push(["L",t.x+i*e,t.y+s*e]),a},Ay=(r,e)=>r.map(t=>t.map((n,i)=>i===0||e===void 0?n:at(n,e)).join(" ")).join(" ");function Hc(r,e){const t=r.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(n=>{let[i,s]=n;return t.setProperty(i,s)}))}const tO=(r,e)=>Math.floor(Math.random()*(e-r+1))+r;function rO(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||Di,n=new(mc()).XMLHttpRequest,i=e.signal,s=function(){n.abort()},a=function(){i&&i.removeEventListener("abort",s),n.onerror=n.ontimeout=Di};if(i&&i.aborted)throw new $v("request");return i&&i.addEventListener("abort",s,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(a(),t(n),n.onreadystatechange=Di)},n.onerror=n.ontimeout=a,n.open("get",r,!0),n.send(),n}var My=Object.freeze({__proto__:null,addTransformToObject:b1,animate:Dd,animateColor:N1,applyTransformToObject:Vs,calcAngleBetweenVectors:Dc,calcDimensionsMatrix:Ro,calcPlaneChangeMatrix:Uo,calcVectorRotation:M1,cancelAnimFrame:e1,capValue:Vi,composeMatrix:s1,copyCanvasElement:r=>{var e;const t=Kr(r);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(r,0,0),t},cos:Gr,createCanvasElement:Pr,createImage:t1,createRotateMatrix:Ns,createScaleMatrix:Cc,createSkewXMatrix:gd,createSkewYMatrix:pd,createTranslateMatrix:Fs,createVector:Oc,crossProduct:Bs,degreesToRadians:pt,dotProduct:O1,ease:eM,enlivenObjectEnlivables:Bo,enlivenObjects:Rs,findScaleToCover:yy,findScaleToFit:vy,getBoundsOfCurve:Yd,getOrthonormalVector:kd,getPathSegmentsInfo:Xd,getPointOnPath:Ey,getPointer:y1,getRandomInt:tO,getRegularPolygonPath:(r,e)=>{const t=2*Math.PI/r;let n=-ii;r%2==0&&(n+=t/2);const i=new Array(r+1);for(let s=0;s<r;s++){const a=s*t+n,{x:c,y:u}=new z(Gr(a),qr(a)).scalarMultiply(e);i[s]=[s===0?"M":"L",c,u]}return i[r]=["Z"],i},getSmoothPathFromPoints:eO,getSvgAttributes:r=>{const e=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:jc,groupSVGElements:(r,e)=>r&&r.length===1?r[0]:new jr(r,e),hasStyleChanged:Nc,invertTransform:vr,isBetweenVectors:Id,isIdentityMatrix:r1,isTouchEvent:Ec,isTransparent:Q1,joinPath:Ay,loadImage:Vo,magnitude:Pc,makeBoundingBoxFromPoints:pn,makePathSimpler:wy,matrixToSVG:zo,mergeClipPaths:(r,e)=>{var t;let n=r,i=e;n.inverted&&!i.inverted&&(n=e,i=r),xd(i,(t=i.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());const s=n.inverted&&i.inverted;return s&&(n.inverted=i.inverted=!1),new jr([n],{clipPath:i,inverted:s})},multiplyTransformMatrices:mt,multiplyTransformMatrixArray:Sc,parsePath:Iy,parsePreserveAspectRatioAttribute:u1,parseUnit:Fi,pick:Li,projectStrokeOnPoints:ry,qrDecompose:Ls,radiansToDegrees:ai,removeFromArray:ji,removeTransformFromObject:(r,e)=>{const t=vr(e),n=mt(t,r.calcOwnMatrix());Vs(r,n)},removeTransformMatrixForSvgParsing:(r,e)=>{let t=r._findCenterFromElement();r.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:i,scaleY:s,angle:a,skewX:c}=Ls(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(Zt,i),n.set(mr,s),n.angle=a,n.skewX=c,n.skewY=0}})(r),t=t.transform(r.transformMatrix)),delete r.transformMatrix,e&&(r.scaleX*=e.scaleX,r.scaleY*=e.scaleY,r.cropX=e.cropX,r.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,r.width=e.width,r.height=e.height),r.setPositionByOrigin(t,Ee,Ee)},request:rO,requestAnimFrame:No,resetObjectTransform:w1,rotatePoint:(r,e,t)=>r.rotate(t,e),rotateVector:Ed,saveObjectTransform:wd,sendObjectToPlane:xd,sendPointToPlane:In,sendVectorToPlane:x1,setStyle:Hc,sin:qr,sizeAfterTransform:kc,string:vM,stylesFromArray:sy,stylesToArray:iy,toDataURL:fd,toFixed:at,transformPath:(r,e,t)=>(t&&(e=mt(e,[1,0,0,1,-t.x,-t.y])),r.map(n=>{const i=[...n];for(let s=1;s<n.length-1;s+=2){const{x:a,y:c}=Ut({x:n[s],y:n[s+1]},e);i[s]=a,i[s+1]=c}return i})),transformPoint:Ut});class nO extends v1{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),F(this,"upper",void 0),F(this,"container",void 0);const{el:i}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const a=this.createContainerElement();a.classList.add(n),i.parentNode&&i.parentNode.replaceChild(a,i),a.append(i,s),this.container=a}createUpperCanvas(){const{el:e}=this.lower,t=Pr();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Os().createElement("div");return e.setAttribute("data-fabric","wrapper"),Hc(e,{position:"relative"}),m1(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:i}=t;Hc(e,j(j({},n),{},{"touch-action":i?"manipulation":sr})),m1(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:i}=this.upper;p1(n,i,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),yd(this.upper.el,e),yd(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:i}=this.upper;super.cleanupDOM(e),t.removeChild(i),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),gn().dispose(this.upper.el),delete this.upper,delete this.container}}class Wc extends Wo{constructor(){super(...arguments),F(this,"targets",[]),F(this,"_hoveredTargets",[]),F(this,"_objectsToRender",void 0),F(this,"_currentTransform",null),F(this,"_groupSelector",null),F(this,"contextTopDirty",!1)}static getDefaults(){return j(j({},super.getDefaults()),Wc.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new nO(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const i=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+i,-n+i),s.transform(...this.viewportTransform);const a=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=a,s.restore();const c=Math.round(i*this.getRetinaScaling());return Q1(s,c,c,c)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),i=this._activeObject;return!!(!t||t&&i&&n.length>1&&n.indexOf(t)===-1&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let i;return t===bc||t===Zt||t===mr||t===Fo?i=this.centeredScaling||e.centeredScaling:t===ud&&(i=this.centeredRotation||e.centeredRotation),i?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=wt:["mr","tr","br"].includes(t)&&(n.x=Ue),["tl","mt","tr"].includes(t)?n.y=cd:["bl","mb","br"].includes(t)&&(n.y=ir)),n}_setupCurrentTransform(e,t,n){var i;const s=t.group?In(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:a="",control:c}=t.getActiveControl()||{},u=n&&c?(i=c.getActionHandler(e,t,c))===null||i===void 0?void 0:i.bind(c):T1,h=((y,w,_,S)=>{if(!w||!y)return"drag";const T=S.controls[w];return T.getActionName(_,T,S)})(n,a,e,t),d=e[this.centeredKey],g=this._shouldCenterTransform(t,h,d)?{x:Ee,y:Ee}:this._getOriginFromCorner(t,a),p={target:t,action:h,actionHandler:u,actionPerformed:!1,corner:a,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:g.x,originY:g.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:pt(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:d,original:j(j({},wd(t)),{},{originX:g.x,originY:g.y})};this._currentTransform=p,this.fire("before:transform",{e,transform:p})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:i,deltaY:s}=this._groupSelector,a=new z(t,n).transform(this.viewportTransform),c=new z(t+i,n+s).transform(this.viewportTransform),u=this.selectionLineWidth/2;let h=Math.min(a.x,c.x),d=Math.min(a.y,c.y),g=Math.max(a.x,c.x),p=Math.max(a.y,c.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(h,d,g-h,p-d)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,h+=u,d+=u,g-=u,p-=u,Ze.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(h,d,g-h,p-d))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,i=this.getActiveObjects();if(this.targets=[],n&&i.length>=1){if(n.findControl(t,Ec(e))||i.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const a=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&a&&a!==n?(this.targets=s,n):a}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const i=this.getZoom(),s=e.padding/i;if(s){const[a,c,u,h]=n,d=Math.atan2(c.y-a.y,c.x-a.x),g=Gr(d)*s,p=qr(d)*s,y=g+p,w=g-p;n=[new z(a.x-w,a.y-y),new z(c.x+y,c.y-w),new z(u.x+w,u.y+y),new z(h.x-y,h.y+w)]}return lt.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,In(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const i=e[n];if(this._checkTarget(i,t)){if(_c(i)&&i.subTargetCheck){const s=this._searchPossibleTargets(i._objects,t);s&&this.targets.push(s)}return i}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&_c(n)&&n.interactive&&this.targets[0]){const i=this.targets;for(let s=i.length-1;s>0;s--){const a=i[s];if(!_c(a)||!a.interactive)return a}return i[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,i=n.getBoundingClientRect();let s=y1(e),a=i.width||0,c=i.height||0;a&&c||(ir in i&&cd in i&&(c=Math.abs(i.top-i.bottom)),wt in i&&Ue in i&&(a=Math.abs(i.right-i.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=In(s,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(s.x/=u,s.y/=u);const h=a===0||c===0?new z(1,1):new z(n.width/a,n.height/c);return s.multiply(h)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Pr(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Ni(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,i=!1;const s=this.getActiveObjects(),a=[],c=[];e.forEach(u=>{s.includes(u)||(n=!0,u.fire("deselected",{e:t,target:u}),c.push(u))}),s.forEach(u=>{e.includes(u)||(n=!0,u.fire("selected",{e:t,target:u}),a.push(u))}),e.length>0&&s.length>0?(i=!0,n&&this.fire("selection:updated",{e:t,selected:a,deselected:c})):s.length>0?(i=!0,this.fire("selection:created",{e:t,selected:a})):e.length>0&&(i=!0,this.fire("selection:cleared",{e:t,deselected:c})),i&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),i=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),i}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Ni(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Ni(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const i=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),i}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,i={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",i),n.fire(wc,i))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Ni(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const i=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,n);return e.set(i),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Ni(t)&&this._activeObject===t){const n=Li(e,["angle","flipX","flipY",Ue,Zt,mr,Ps,Ds,ir]);return b1(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const i=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(i)}}F(Wc,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class iO{constructor(e){F(this,"targets",[]),F(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:i}=e.getActiveObject()||{};i&&i.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),ji(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const sO=["target","oldTarget","fireCanvas","e"],yr={passive:!1},Ws=(r,e)=>{const t=r.getViewportPoint(e),n=r.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},ui=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.addEventListener(...t)},Lr=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.removeEventListener(...t)},oO={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Gd extends Wc{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),F(this,"_isClick",void 0),F(this,"textEditingManager",new iO(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(ui,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,i=this._getEventPrefix();e(g1(n),"resize",this._onResize),e(n,i+"down",this._onMouseDown),e(n,"".concat(i,"move"),this._onMouseMove,yr),e(n,"".concat(i,"out"),this._onMouseOut),e(n,"".concat(i,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,yr)}removeListeners(){this.addOrRemove(Lr,"remove");const e=this._getEventPrefix(),t=Zr(this.upperCanvasEl);Lr(t,"".concat(e,"up"),this._onMouseUp),Lr(t,"touchend",this._onTouchEnd,yr),Lr(t,"".concat(e,"move"),this._onMouseMove,yr),Lr(t,"touchmove",this._onMouseMove,yr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=j({e},Ws(this,e));this.fire("mouse:out",j(j({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",j({},n)),this._hoveredTargets.forEach(i=>{this.fire("mouse:out",j(j({},n),{},{target:i})),i&&i.fire("mouseout",j({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",j({e},Ws(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void ui(this.upperCanvasEl,"drag",this._onDragProgress)}bd(e)}_renderDragEffects(e,t,n){let i=!1;const s=this._dropTarget;s&&s!==t&&s!==n&&(s.clearContextTop(),i=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();const a=this.contextTop;a.save(),a.transform(...this.viewportTransform),t&&(a.save(),t.transform(a),t.renderDragSourceEffect(e),a.restore(),i=!0),n&&(a.save(),n.transform(a),n.renderDropTargetEffect(e),a.restore(),i=!0),a.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==sr,n=t?this._activeObject:void 0,i={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};Lr(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",i),this._dragSource&&this._dragSource.fire("dragend",i),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:i}=this.findDragTargets(e),s=this._dragSource,a={e,target:n,subTargets:i,dragSource:s,canDrop:!1,dropTarget:void 0};let c;this.fire(t,a),this._fireEnterLeaveEvents(n,a),n&&(n.canDrop(e)&&(c=n),n.fire(t,a));for(let u=0;u<i.length;u++){const h=i[u];h.canDrop(e)&&(c=h),h.fire(t,a)}this._renderDragEffects(e,s,c),this._dropTarget=c}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),i={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(t,i)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),i=this._basicEventHandler("drop:before",j({e,target:t,subTargets:n,dragSource:this._dragSource},Ws(this,e)));i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],i=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&bd(e),this._basicEventHandler("contextmenu",i),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const i=this.upperCanvasEl,s=this._getEventPrefix(),a=Zr(i);ui(a,"touchend",this._onTouchEnd,yr),t&&ui(a,"touchmove",this._onMouseMove,yr),Lr(i,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();Lr(t,"".concat(n,"move"),this._onMouseMove,yr);const i=Zr(t);ui(i,"".concat(n,"up"),this._onMouseUp),ui(i,"".concat(n,"move"),this._onMouseMove,yr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=Zr(this.upperCanvasEl);Lr(n,"touchend",this._onTouchEnd,yr),Lr(n,"touchmove",this._onMouseMove,yr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{ui(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const i=Zr(this.upperCanvasEl);Lr(i,"".concat(n,"up"),this._onMouseUp),Lr(i,"".concat(n,"move"),this._onMouseMove,yr),ui(t,"".concat(n,"move"),this._onMouseMove,yr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,i=this._isClick,s=this._target,{button:a}=e;if(a)return(this.fireMiddleClick&&a===1||this.fireRightClick&&a===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let c,u,h=!1;if(n&&(this._finalizeCurrentTransform(e),h=n.actionPerformed),!i){const d=s===this._activeObject;this.handleSelection(e),h||(h=this._shouldRender(s)||!d&&s===this._activeObject)}if(s){const d=s.findControl(this.getViewportPoint(e),Ec(e)),{key:g,control:p}=d||{};if(u=g,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),h=!0;else if(p){const y=p.getMouseUpHandler(e,s,p);y&&(c=this.getScenePoint(e),y.call(p,e,n,c.x,c.y))}s.isMoving=!1}if(n&&(n.target!==s||n.corner!==u)){const d=n.target&&n.target.controls[n.corner],g=d&&d.getMouseUpHandler(e,n.target,d);c=c||this.getScenePoint(e),g&&g.call(d,e,n,c.x,c.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),h?this.requestRenderAll():i||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:i=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let s=0;s<i.length;s++)i[s]!==n&&i[s].fire(e,t);return t}_handleEvent(e,t){const n=this._target,i=this.targets||[],s=j(j({e,target:n,subTargets:i},Ws(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),s),n&&n.fire("mouse".concat(t),s);for(let a=0;a<i.length;a++)i[a]!==n&&i[a].fire("mouse".concat(t),s)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:n}=e;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,i=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(t){const a=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const c=t.findControl(this.getViewportPoint(e),Ec(e));if(t===this._activeObject&&(c||!s)){this._setupCurrentTransform(e,t,a);const u=c?c.control:void 0,h=this.getScenePoint(e),d=u&&u.getMouseDownHandler(e,t,u);d&&d.call(u,e,this._currentTransform,h.x,h.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=In(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,i=this._hoveredTargets,s=this.targets,a=Math.max(i.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("mouse",{e,target:s[c],oldTarget:i[c]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,i=this._hoveredTargets,s=this.targets,a=Math.max(i.length,s.length);this.fireSyntheticInOutEvents("drag",j(j({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("drag",j(j({},t),{},{target:s[c],oldTarget:i[c]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:i,fireCanvas:s,e:a}=t,c=ot(t,sO);const{targetIn:u,targetOut:h,canvasIn:d,canvasOut:g}=oO[e],p=i!==n;if(i&&p){const y=j(j({},c),{},{e:a,target:i,nextTarget:n},Ws(this,a));s&&this.fire(g,y),i.fire(h,y)}if(n&&p){const y=j(j({},c),{},{e:a,target:n,previousTarget:i},Ws(this,a));s&&this.fire(d,y),n.fire(u,y)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,i=n.target,s=i.group?In(t,void 0,i.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,s),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:i,actionHandler:s,target:a}=t,c=!!s&&s(e,t,n.x,n.y);c&&a.setCoords(),i==="drag"&&c&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||c}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const i=Ni(this._activeObject)?this._activeObject:null,s=(!i||t.group!==i)&&t.findControl(this.getViewportPoint(e));if(s){const a=s.control;this.setCursor(a.cursorStyleHandler(e,a,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(a=>{n=a.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,i=Ni(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||i)&&(i||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(i){const s=n.getObjects();if(t===n){const a=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,a)||this.searchPossibleTargets(this._objects,a))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{n.isEditing&&n.exitEditing();const s=new(ie.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(n,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:i,deltaY:s}=this._groupSelector,a=new z(t,n),c=a.add(new z(i,s)),u=a.min(c),h=a.max(c).subtract(u),d=this.collectObjects({left:u.x,top:u.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),g=a.eq(c)?d[0]?[d[0]]:[]:d.length>1?d.filter(p=>!p.onSelect({e})).reverse():d;if(g.length===1)this.setActiveObject(g[0],e);else if(g.length>1){const p=ie.getClass("ActiveSelection");this.setActiveObject(new p(g,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Oy={x1:0,y1:0,x2:0,y2:0},aO=j(j({},Oy),{},{r1:0,r2:0}),Us=(r,e)=>isNaN(r)&&typeof e=="number"?e:r,cO=/^(\d+\.\d+)%|(\d+)%$/;function Py(r){return r&&cO.test(r)}function Dy(r,e){const t=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(Py(r)?100:1):NaN;return Vi(0,Us(t,e),1)}const lO=/\s*;\s*/,uO=/\s*:\s*/;function hO(r,e){let t,n;const i=r.getAttribute("style");if(i){const a=i.split(lO);a[a.length-1]===""&&a.pop();for(let c=a.length;c--;){const[u,h]=a[c].split(uO).map(d=>d.trim());u==="stop-color"?t=h:u==="stop-opacity"&&(n=h)}}const s=new Xe(t||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:Dy(r.getAttribute("offset"),0),color:s.toRgb(),opacity:Us(parseFloat(n||r.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function dO(r,e){const t=[],n=r.getElementsByTagName("stop"),i=Dy(e,1);for(let s=n.length;s--;)t.push(hO(n[s],i));return t}function jy(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function Ly(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Qr(r,e){return r.getAttribute(e)}function fO(r,e){return function(t,n){let i,{width:s,height:a,gradientUnits:c}=n;return Object.keys(t).reduce((u,h)=>{const d=t[h];return d==="Infinity"?i=1:d==="-Infinity"?i=0:(i=typeof d=="string"?parseFloat(d):d,typeof d=="string"&&Py(d)&&(i*=.01,c==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(i*=s),h!=="y1"&&h!=="y2"||(i*=a)))),u[h]=i,u},{})}(jy(r)==="linear"?function(t){return{x1:Qr(t,"x1")||0,y1:Qr(t,"y1")||0,x2:Qr(t,"x2")||"100%",y2:Qr(t,"y2")||0}}(r):function(t){return{x1:Qr(t,"fx")||Qr(t,"cx")||"50%",y1:Qr(t,"fy")||Qr(t,"cy")||"50%",r1:0,x2:Qr(t,"cx")||"50%",y2:Qr(t,"cy")||"50%",r2:Qr(t,"r")||"50%"}}(r),j(j({},e),{},{gradientUnits:Ly(r)}))}class Uc{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:i={},colorStops:s=[],offsetX:a=0,offsetY:c=0,gradientTransform:u,id:h}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:j(j({},t==="radial"?aO:Oy),i),colorStops:s,offsetX:a,offsetY:c,gradientTransform:u,id:h?"".concat(h,"_").concat(oi()):oi()})}addColorStop(e){for(const t in e){const n=new Xe(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return j(j({},Li(this,e)),{},{type:this.type,coords:j({},this.coords),colorStops:this.colorStops.map(t=>j({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],i=this.gradientTransform?this.gradientTransform.concat():Kt.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",a=this.colorStops.map(g=>j({},g)).sort((g,p)=>g.offset-p.offset);let c=-this.offsetX,u=-this.offsetY;var h;s==="objectBoundingBox"?(c/=e.width,u/=e.height):(c+=e.width/2,u+=e.height/2),(h=e)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(c-=e.pathOffset.x,u-=e.pathOffset.y),i[4]-=c,i[5]-=u;const d=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(zo(i),'"'),""].join(" ");if(this.type==="linear"){const{x1:g,y1:p,x2:y,y2:w}=this.coords;n.push("<linearGradient ",d,' x1="',g,'" y1="',p,'" x2="',y,'" y2="',w,`">
`)}else if(this.type==="radial"){const{x1:g,y1:p,x2:y,y2:w,r1:_,r2:S}=this.coords,T=_>S;n.push("<radialGradient ",d,' cx="',T?g:y,'" cy="',T?p:w,'" r="',T?_:S,'" fx="',T?y:g,'" fy="',T?w:p,`">
`),T&&(a.reverse(),a.forEach(I=>{I.offset=1-I.offset}));const k=Math.min(_,S);if(k>0){const I=k/Math.max(_,S);a.forEach(M=>{M.offset+=I*(1-M.offset)})}}return a.forEach(g=>{let{color:p,offset:y,opacity:w}=g;n.push("<stop ",'offset="',100*y+"%",'" style="stop-color:',p,w!==void 0?";stop-opacity: "+w:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:i,y2:s,r1:a,r2:c}=this.coords,u=this.type==="linear"?e.createLinearGradient(t,n,i,s):e.createRadialGradient(t,n,a,i,s,c);return this.colorStops.forEach(h=>{let{color:d,opacity:g,offset:p}=h;u.addColorStop(p,g!==void 0?new Xe(d).setAlpha(g).toRgba():d)}),u}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(j(j({},e),{},{colorStops:t?t.map(i=>j({},i)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const i=Ly(e),s=t._findCenterFromElement();return new this(j({id:e.getAttribute("id")||void 0,type:jy(e),coords:fO(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:dO(e,n.opacity),gradientUnits:i,gradientTransform:Hd(e.getAttribute("gradientTransform")||"")},i==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}F(Uc,"type","Gradient"),ie.setClass(Uc,"gradient"),ie.setClass(Uc,"linear"),ie.setClass(Uc,"radial");const gO=["type","source","patternTransform"];class qd{get type(){return"pattern"}set type(e){ni("warn","Setting type has no effect",e)}constructor(e){F(this,"repeat","repeat"),F(this,"offsetX",0),F(this,"offsetY",0),F(this,"crossOrigin",""),this.id=oi(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return j(j({},Li(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:at(this.offsetX,Ve.NUM_FRACTION_DIGITS),offsetY:at(this.offsetY,Ve.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:i,repeat:s,id:a}=this,c=Us(this.offsetX/t,0),u=Us(this.offsetY/n,0),h=s==="repeat-y"||s==="no-repeat"?1+Math.abs(c||0):Us(i.width/t,0),d=s==="repeat-x"||s==="no-repeat"?1+Math.abs(u||0):Us(i.height/n,0);return['<pattern id="SVGID_'.concat(a,'" x="').concat(c,'" y="').concat(u,'" width="').concat(h,'" height="').concat(d,'">'),'<image x="0" y="0" width="'.concat(i.width,'" height="').concat(i.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:i,patternTransform:s}=e,a=ot(e,gO);const c=await Vo(i,j(j({},t),{},{crossOrigin:a.crossOrigin}));return new this(j(j({},a),{},{patternTransform:s&&s.slice(0),source:c}))}}F(qd,"type","Pattern"),ie.setClass(qd),ie.setClass(qd,"pattern");const pO=["path","left","top"],mO=["d"];class Hi extends Ze{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:i,top:s}=t,a=ot(t,pO);super(),Object.assign(this,Hi.ownDefaults),this.setOptions(a),this._setPath(e||[],!0),typeof i=="number"&&this.set(Ue,i),typeof s=="number"&&this.set(ir,s)}_setPath(e,t){this.path=wy(Array.isArray(e)?e:Iy(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new z(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const i of this.path)switch(i[0]){case"L":e.lineTo(i[1]+t,i[2]+n);break;case"M":e.moveTo(i[1]+t,i[2]+n);break;case"C":e.bezierCurveTo(i[1]+t,i[2]+n,i[3]+t,i[4]+n,i[5]+t,i[6]+n);break;case"Q":e.quadraticCurveTo(i[1]+t,i[2]+n,i[3]+t,i[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return j(j({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=Ay(this.path,Ve.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Ve.NUM_FRACTION_DIGITS;return" translate(".concat(at(-this.pathOffset.x,e),", ").concat(at(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:i}=this._calcDimensions();this.set({width:t,height:n,pathOffset:i}),e&&this.setPositionByOrigin(i,Ee,Ee)}_calcBoundsFromPath(){const e=[];let t=0,n=0,i=0,s=0;for(const a of this.path)switch(a[0]){case"L":i=a[1],s=a[2],e.push({x:t,y:n},{x:i,y:s});break;case"M":i=a[1],s=a[2],t=i,n=s;break;case"C":e.push(...Yd(i,s,a[1],a[2],a[3],a[4],a[5],a[6])),i=a[5],s=a[6];break;case"Q":e.push(...Yd(i,s,a[1],a[2],a[1],a[2],a[3],a[4])),i=a[3],s=a[4];break;case"Z":i=t,s=n}return pn(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return j(j({},e),{},{pathOffset:new z(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const i=Pn(e,this.ATTRIBUTE_NAMES,n),{d:s}=i;return new this(s,j(j(j({},ot(i,mO)),t),{},{left:void 0,top:void 0}))}}F(Hi,"type","Path"),F(Hi,"cacheProperties",[...Mn,"path","fillRule"]),F(Hi,"ATTRIBUTE_NAMES",[...li,"d"]),ie.setClass(Hi),ie.setSVGClass(Hi);const vO=["left","top","radius"],Fy=["radius","startAngle","endAngle","counterClockwise"];class jn extends Ze{static getDefaults(){return j(j({},super.getDefaults()),jn.ownDefaults)}constructor(e){super(),Object.assign(this,jn.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,pt(this.startAngle),pt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Zt)}getRadiusY(){return this.get("radius")*this.get(mr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Fy,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=pt(this.startAngle),i=pt(this.endAngle),s=Gr(n)*t,a=qr(n)*t,c=Gr(i)*t,u=qr(i)*t,h=e>180?1:0,d=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(a," A ").concat(t," ").concat(t," 0 ").concat(h," ").concat(d," ").concat(c," ").concat(u,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const i=Pn(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:a=0,radius:c=0}=i;return new this(j(j({},ot(i,vO)),{},{radius:c,left:s-c,top:a-c}))}static fromObject(e){return super._fromObject(e)}}F(jn,"type","Circle"),F(jn,"cacheProperties",[...Mn,...Fy]),F(jn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),F(jn,"ATTRIBUTE_NAMES",["cx","cy","r",...li]),ie.setClass(jn),ie.setSVGClass(jn);const yO=["x1","y1","x2","y2"],bO=["x1","y1","x2","y2"],Kd=["x1","x2","y1","y2"];class Wi extends Ze{constructor(){let[e,t,n,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Wi.ownDefaults),this.setOptions(s),this.x1=e,this.x2=n,this.y1=t,this.y2=i,this._setWidthHeight();const{left:a,top:c}=s;typeof a=="number"&&this.set(Ue,a),typeof c=="number"&&this.set(ir,c)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:i}=this;this.width=Math.abs(n-e),this.height=Math.abs(i-t);const{left:s,top:a,width:c,height:u}=pn([{x:e,y:t},{x:n,y:i}]),h=new z(s+c/2,a+u/2);this.setPositionByOrigin(h,Ee,Ee)}_set(e,t){return super._set(e,t),Kd.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var i;Dr(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new z((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return j(j({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:i,width:s,height:a}=this,c=e<=t?-1:1,u=n<=i?-1:1;return{x1:c*s/2,x2:c*-s/2,y1:u*a/2,y2:u*-a/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(i,`" />
`)]}static async fromElement(e,t,n){const i=Pn(e,this.ATTRIBUTE_NAMES,n),{x1:s=0,y1:a=0,x2:c=0,y2:u=0}=i;return new this([s,a,c,u],ot(i,yO))}static fromObject(e){let{x1:t,y1:n,x2:i,y2:s}=e,a=ot(e,bO);return this._fromObject(j(j({},a),{},{points:[t,n,i,s]}),{extraParam:"points"})}}F(Wi,"type","Line"),F(Wi,"cacheProperties",[...Mn,...Kd]),F(Wi,"ATTRIBUTE_NAMES",li.concat(Kd)),ie.setClass(Wi),ie.setSVGClass(Wi);class Ui extends Ze{static getDefaults(){return j(j({},super.getDefaults()),Ui.ownDefaults)}constructor(e){super(),Object.assign(this,Ui.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}F(Ui,"type","Triangle"),F(Ui,"ownDefaults",{width:100,height:100}),ie.setClass(Ui),ie.setSVGClass(Ui);const Ny=["rx","ry"];class Ln extends Ze{static getDefaults(){return j(j({},super.getDefaults()),Ln.ownDefaults)}constructor(e){super(),Object.assign(this,Ln.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Zt)}getRy(){return this.get("ry")*this.get(mr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Ny,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,kn,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const i=Pn(e,this.ATTRIBUTE_NAMES,n);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)}}function wO(r){if(!r)return[];const e=r.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}F(Ln,"type","Ellipse"),F(Ln,"cacheProperties",[...Mn,...Ny]),F(Ln,"ownDefaults",{rx:0,ry:0}),F(Ln,"ATTRIBUTE_NAMES",[...li,"cx","cy","rx","ry"]),ie.setClass(Ln),ie.setSVGClass(Ln);const xO=["left","top"],Ry={exactBoundingBox:!1};class en extends Ze{static getDefaults(){return j(j({},super.getDefaults()),en.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),F(this,"strokeDiff",void 0),Object.assign(this,en.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:i}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(Ue,n),typeof i=="number"&&this.set(ir,i)}isOpen(){return!0}_projectStrokeOnPoints(e){return ry(this.points,e,this.isOpen())}_calcDimensions(e){e=j({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(h=>h.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new z,strokeOffset:new z,strokeDiff:new z};const n=pn(t),i=Ro(j(j({},e),{},{scaleX:1,scaleY:1})),s=pn(this.points.map(h=>Ut(h,i,!0))),a=new z(this.scaleX,this.scaleY);let c=n.left+n.width/2,u=n.top+n.height/2;return this.exactBoundingBox&&(c-=u*Math.tan(pt(this.skewX)),u-=c*Math.tan(pt(this.skewY))),j(j({},n),{},{pathOffset:new z(c,u),strokeOffset:new z(s.left,s.top).subtract(new z(n.left,n.top)).multiply(a),strokeDiff:new z(n.width,n.height).subtract(new z(s.width,s.height)).multiply(a)})}_findCenterFromElement(){const e=pn(this.points);return new z(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:i,height:s,pathOffset:a,strokeOffset:c,strokeDiff:u}=this._calcDimensions();this.set({width:i,height:s,pathOffset:a,strokeOffset:c,strokeDiff:u}),e&&this.setPositionByOrigin(new z(t+i/2,n+s/2),Ee,Ee)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new z(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let a;if(Object.keys(e).some(c=>this.strokeUniform||this.constructor.layoutProperties.includes(c))){var t,n;const{width:c,height:u}=this._calcDimensions(e);a=new z((t=e.width)!==null&&t!==void 0?t:c,(n=e.height)!==null&&n!==void 0?n:u)}else{var i,s;a=new z((i=e.width)!==null&&i!==void 0?i:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return a.multiply(new z(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,i=super._set(e,t);return this.exactBoundingBox&&n&&((e===Zt||e===mr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),i}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return j(j({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:n,y:i}=t;return{x:n,y:i}})})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,i=Ve.NUM_FRACTION_DIGITS;for(let s=0,a=this.points.length;s<a;s++)e.push(at(this.points[s].x-t,i),",",at(this.points[s].y-n,i)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,i=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-i);for(let s=0;s<t;s++){const a=this.points[s];e.lineTo(a.x-n,a.y-i)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(wO(e.getAttribute("points")),j(j({},ot(Pn(e,this.ATTRIBUTE_NAMES,n),xO)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}F(en,"ownDefaults",Ry),F(en,"type","Polyline"),F(en,"layoutProperties",[Ps,Ds,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),F(en,"cacheProperties",[...Mn,"points"]),F(en,"ATTRIBUTE_NAMES",[...li]),ie.setClass(en),ie.setSVGClass(en);class $c extends en{isOpen(){return!1}}F($c,"ownDefaults",Ry),F($c,"type","Polygon"),ie.setClass($c),ie.setSVGClass($c);const Vy=["fontSize","fontWeight","fontFamily","fontStyle"],By=["underline","overline","linethrough"],zy=[...Vy,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Hy=[...zy,...By,"textBackgroundColor","direction"],_O=[...Vy,...By,or,"strokeWidth",It,"deltaY","textBackgroundColor"],SO={_reNewline:ld,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Ue,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Ue,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},mn="justify",Yc="justify-left",Ko="justify-right",Zo="justify-center";class Wy extends Ze{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const i in t[n])for(const s in t[n][i])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const i in n)for(const s in n[i])if(n[i][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,i,s=0,a=!0,c=0;for(const u in t){n=0;for(const h in t[u]){const d=t[u][h]||{};s++,d[e]!==void 0?(i?d[e]!==i&&(a=!1):i=d[e],d[e]===this[e]&&delete d[e]):a=!1,Object.keys(d).length!==0?n++:delete t[u][h]}n===0&&delete t[u]}for(let u=0;u<this._textLines.length;u++)c+=this._textLines[u].length;a&&s===c&&(this[e]=i,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,i,s;for(i in t){for(s in n=t[i],n)delete n[s][e],Object.keys(n[s]).length===0&&delete n[s];Object.keys(n).length===0&&delete t[i]}}_extendStyles(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const s=md(j(j({},this._getStyleDeclaration(n,i)),t),a=>a!==void 0);this._setStyleDeclaration(n,i,s)}getSelectionStyles(e,t,n){const i=[];for(let s=e;s<(t||e);s++)i.push(this.getStyleAtPosition(s,n));return i}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,i):this._getStyleDeclaration(n,i)}setSelectionStyles(e,t,n){for(let i=t;i<(n||t);i++)this._extendStyles(i,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const i=this.styles&&this.styles[e];return i&&(n=i[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return j(j({},Li(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}F(Wy,"_styleProperties",_O);const CO=/  +/g,TO=/"/g;function Zd(r,e,t,n,i){return"		".concat(function(s,a){let{left:c,top:u,width:h,height:d}=a,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ve.NUM_FRACTION_DIGITS;const p=Ho(It,s,!1),[y,w,_,S]=[c,u,h,d].map(T=>at(T,g));return"<rect ".concat(p,' x="').concat(y,'" y="').concat(w,'" width="').concat(_,'" height="').concat(S,'"></rect>')}(r,{left:e,top:t,width:n,height:i}),`
`)}const EO=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Jd;class Qt extends Wy{static getDefaults(){return j(j({},super.getDefaults()),Qt.ownDefaults)}constructor(e,t){super(),F(this,"__charBounds",[]),Object.assign(this,Qt.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Xd(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(mn)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,i,s,a,c;for(let u=0,h=this._textLines.length;u<h;u++)if((this.textAlign===mn||u!==h-1&&!this.isEndOfWrapping(u))&&(i=0,s=this._textLines[u],t=this.getLineWidth(u),t<this.width&&(c=this.textLines[u].match(this._reSpacesAndTabs)))){n=c.length,e=(this.width-t)/n;for(let d=0;d<=s.length;d++)a=this.__charBounds[u][d],this._reSpaceAndTab.test(s[d])?(a.width+=e,a.kernedWidth+=e,a.left+=i,i+=e):a.left+=i}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let i;for(i=0;i<n.length;i++){if(e<=n[i].length)return{lineIndex:i,charIndex:e};e-=n[i].length+this.missingNewlineOffset(i,t)}return{lineIndex:i-1,charIndex:n[i-1].length<e?n[i-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===or?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Ee:e.textBaseline="middle";break;case"ascender":e.textBaseline=ir;break;case"descender":e.textBaseline=cd}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const i=this.getLineWidth(t);i>e&&(e=i)}return e}_renderTextLine(e,t,n,i,s,a){this._renderChars(e,t,n,i,s,a)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let i=this._getTopOffset();for(let s=0,a=this._textLines.length;s<a;s++){const c=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){i+=c;continue}const u=this._textLines[s].length,h=this._getLineLeftOffset(s);let d,g,p=0,y=0,w=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let _=0;_<u;_++){const S=this.__charBounds[s][_];g=this.getValueOfPropertyAt(s,_,"textBackgroundColor"),this.path?(e.save(),e.translate(S.renderLeft,S.renderTop),e.rotate(S.angle),e.fillStyle=g,g&&e.fillRect(-S.width/2,-c/this.lineHeight*(1-this._fontSizeFraction),S.width,c/this.lineHeight),e.restore()):g!==w?(d=n+h+y,this.direction==="rtl"&&(d=this.width-d-p),e.fillStyle=w,w&&e.fillRect(d,i,p,c/this.lineHeight),y=S.left,p=S.width,w=g):p+=S.kernedWidth}g&&!this.path&&(d=n+h+y,this.direction==="rtl"&&(d=this.width-d-p),e.fillStyle=g,e.fillRect(d,i,p,c/this.lineHeight)),i+=c}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,i){const s=Lo.getFontCache(t),a=this._getFontDeclaration(t),c=n+e,u=n&&a===this._getFontDeclaration(i),h=t.fontSize/this.CACHE_FONT_SIZE;let d,g,p,y;if(n&&s[n]!==void 0&&(p=s[n]),s[e]!==void 0&&(y=d=s[e]),u&&s[c]!==void 0&&(g=s[c],y=g-p),d===void 0||p===void 0||g===void 0){const w=function(){return Jd||(Jd=Kr({width:0,height:0}).getContext("2d")),Jd}();this._setTextStyles(w,t,!0),d===void 0&&(y=d=w.measureText(e).width,s[e]=d),p===void 0&&u&&n&&(p=w.measureText(n).width,s[n]=p),u&&g===void 0&&(g=w.measureText(c).width,s[c]=g,y=g-p)}return{width:d*h,kernedWidth:y*h}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,i=0;const s=this.pathSide===wt,a=this.path,c=this._textLines[e],u=c.length,h=new Array(u);this.__charBounds[e]=h;for(let d=0;d<u;d++){const g=c[d];n=this._getGraphemeBox(g,e,d,t),h[d]=n,i+=n.kernedWidth,t=g}if(h[u]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},a&&a.segmentsInfo){let d=0;const g=a.segmentsInfo[a.segmentsInfo.length-1].length;switch(this.textAlign){case Ue:d=s?g-i:0;break;case Ee:d=(g-i)/2;break;case wt:d=s?0:g-i}d+=this.pathStartOffset*(s?-1:1);for(let p=s?u-1:0;s?p>=0:p<u;s?p--:p++)n=h[p],d>g?d%=g:d<0&&(d+=g),this._setGraphemeOnPath(d,n),d+=n.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,i=this.path,s=Ey(i.path,n,i.segmentsInfo);t.renderLeft=s.x-i.pathOffset.x,t.renderTop=s.y-i.pathOffset.y,t.angle=s.angle+(this.pathSide===wt?Math.PI:0)}_getGraphemeBox(e,t,n,i,s){const a=this.getCompleteStyleDeclaration(t,n),c=i?this.getCompleteStyleDeclaration(t,n-1):{},u=this._measureChar(e,a,i,c);let h,d=u.kernedWidth,g=u.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),g+=h,d+=h);const p={width:g,left:0,height:a.fontSize,kernedWidth:d,deltaY:a.deltaY};if(n>0&&!s){const y=this.__charBounds[t][n-1];p.left=y.left+y.width+u.kernedWidth-u.width}return p}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,i=this._textLines[e].length;n<i;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,i=this._textLines.length;n<i;n++)e=this.getHeightOfLine(n),t+=n===i-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const i=this._getLeftOffset(),s=this._getTopOffset();for(let a=0,c=this._textLines.length;a<c;a++){const u=this.getHeightOfLine(a),h=u/this.lineHeight,d=this._getLineLeftOffset(a);this._renderTextLine(t,e,this._textLines[a],i+d,s+n+h,a),n+=u}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(It))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,i,s,a){const c=this.getHeightOfLine(a),u=this.textAlign.includes(mn),h=this.path,d=!u&&this.charSpacing===0&&this.isEmptyStyles(a)&&!h,g=this.direction==="ltr",p=this.direction==="ltr"?1:-1,y=t.direction;let w,_,S,T,k,I="",M=0;if(t.save(),y!==this.direction&&(t.canvas.setAttribute("dir",g?"ltr":"rtl"),t.direction=g?"ltr":"rtl",t.textAlign=g?Ue:wt),s-=c*this._fontSizeFraction/this.lineHeight,d)return this._renderChar(e,t,a,0,n.join(""),i,s),void t.restore();for(let L=0,N=n.length-1;L<=N;L++)T=L===N||this.charSpacing||h,I+=n[L],S=this.__charBounds[a][L],M===0?(i+=p*(S.kernedWidth-S.width),M+=S.width):M+=S.kernedWidth,u&&!T&&this._reSpaceAndTab.test(n[L])&&(T=!0),T||(w=w||this.getCompleteStyleDeclaration(a,L),_=this.getCompleteStyleDeclaration(a,L+1),T=Nc(w,_,!1)),T&&(h?(t.save(),t.translate(S.renderLeft,S.renderTop),t.rotate(S.angle),this._renderChar(e,t,a,L,I,-M/2,0),t.restore()):(k=i,this._renderChar(e,t,a,L,I,k,s)),I="",w=_,i+=p*M,M=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,i=Kr({width:t,height:n}),s=i.getContext("2d");return i.width=t,i.height=n,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,n),s.lineTo(0,n),s.closePath(),s.translate(t/2,n/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(i,"no-repeat")}handleFiller(e,t,n){let i,s;return Dr(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(i=-this.width/2,s=-this.height/2,e.translate(i,s),e[t]=this._applyPatternGradientTransformText(n),{offsetX:i,offsetY:s}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:i}=t;return e.lineWidth=i,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,i,s,a,c){const u=this._getStyleDeclaration(n,i),h=this.getCompleteStyleDeclaration(n,i),d=e==="fillText"&&h.fill,g=e==="strokeText"&&h.stroke&&h.strokeWidth;if(g||d){if(t.save(),t.font=this._getFontDeclaration(h),u.textBackgroundColor&&this._removeShadow(t),u.deltaY&&(c+=u.deltaY),d){const p=this._setFillStyles(t,h);t.fillText(s,a-p.offsetX,c-p.offsetY)}if(g){const p=this._setStrokeStyles(t,h);t.strokeText(s,a-p.offsetX,c-p.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const i=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),a=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),c={fontSize:s*n.size,deltaY:a+s*n.baseline};this.setSelectionStyles(c,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,i=this.textAlign,s=this.direction,a=this.isEndOfWrapping(e);let c=0;return i===mn||i===Zo&&!a||i===Ko&&!a||i===Yc&&!a?0:(i===Ee&&(c=n/2),i===wt&&(c=n),i===Zo&&(c=n/2),i===Ko&&(c=n),s==="rtl"&&(i===wt||i===mn||i===Ko?c=0:i===Ue||i===Yc?c=-n:i!==Ee&&i!==Zo||(c=-n/2)),c)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var i;return(i=this._getStyleDeclaration(e,t)[n])!==null&&i!==void 0?i:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const i=this._getLeftOffset(),s=this.path,a=this._getWidthOfCharSpacing(),c=this.offsets[t];for(let u=0,h=this._textLines.length;u<h;u++){const d=this.getHeightOfLine(u);if(!this[t]&&!this.styleHas(t,u)){n+=d;continue}const g=this._textLines[u],p=d/this.lineHeight,y=this._getLineLeftOffset(u);let w,_,S=0,T=0,k=this.getValueOfPropertyAt(u,0,t),I=this.getValueOfPropertyAt(u,0,It);const M=n+p*(1-this._fontSizeFraction);let L=this.getHeightOfChar(u,0),N=this.getValueOfPropertyAt(u,0,"deltaY");for(let R=0,X=g.length;R<X;R++){const U=this.__charBounds[u][R];w=this.getValueOfPropertyAt(u,R,t),_=this.getValueOfPropertyAt(u,R,It);const K=this.getHeightOfChar(u,R),$=this.getValueOfPropertyAt(u,R,"deltaY");if(s&&w&&_)e.save(),e.fillStyle=I,e.translate(U.renderLeft,U.renderTop),e.rotate(U.angle),e.fillRect(-U.kernedWidth/2,c*K+$,U.kernedWidth,this.fontSize/15),e.restore();else if((w!==k||_!==I||K!==L||$!==N)&&T>0){let G=i+y+S;this.direction==="rtl"&&(G=this.width-G-T),k&&I&&(e.fillStyle=I,e.fillRect(G,M+c*L+N,T,this.fontSize/15)),S=U.left,T=U.width,k=w,I=_,L=K,N=$}else T+=U.kernedWidth}let H=i+y+S;this.direction==="rtl"&&(H=this.width-H-T),e.fillStyle=_,w&&_&&e.fillRect(H,M+c*L+N,T-a,this.fontSize/15),n+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const a=e.includes("'")||e.includes('"')||e.includes(",")||Qt.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(s?this.CACHE_FONT_SIZE:i,"px"),a].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return Fc(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),i=[`
`];let s=[];for(let a=0;a<t.length;a++)n[a]=this.graphemeSplit(t[a]),s=s.concat(n[a],i);return s.pop(),{_unwrappedLines:n,lines:t,graphemeText:s,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return j(j({},super.toObject([...Hy,...e])),{},{styles:iy(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let i=!1,s=!1;if(typeof e=="object")for(const a in e)a==="path"&&this.setPathInfo(),i=i||n.includes(a),s=s||a==="path";else i=n.includes(e),s=e==="path";return s&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const i=Pn(e,Qt.ATTRIBUTE_NAMES,n),s=j(j({},t),i),{textAnchor:a=Ue,textDecoration:c="",dx:u=0,dy:h=0,top:d=0,left:g=0,fontSize:p=ad,strokeWidth:y=1}=s,w=ot(s,EO),_=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),j({left:g+u,top:d+h,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:p},w)),S=_.getScaledHeight()/_.height,T=((_.height+_.strokeWidth)*_.lineHeight-_.height)*S,k=_.getScaledHeight()+T;let I=0;return a===Ee&&(I=_.getScaledWidth()/2),a===wt&&(I=_.getScaledWidth()),_.set({left:_.left-I,top:_.top-(k-_.fontSize*(.07+_._fontSizeFraction))/_.lineHeight,strokeWidth:y}),_}static fromObject(e){return this._fromObject(j(j({},e),{},{styles:sy(e.styles||{},e.text)}),{extraParam:"text"})}}F(Qt,"textLayoutProperties",zy),F(Qt,"cacheProperties",[...Mn,...Hy]),F(Qt,"ownDefaults",SO),F(Qt,"type","Text"),F(Qt,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),F(Qt,"ATTRIBUTE_NAMES",li.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),J1(Qt,[class extends E1{_toSVG(){const r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:t}=r;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(TO,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(r,e){const t=[],n=[];let i,s=r;this.backgroundColor&&n.push(...Zd(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let a=0,c=this._textLines.length;a<c;a++)i=this._getLineLeftOffset(a),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(n,a,e+i,s),this._setSVGTextLineText(t,a,e+i,s),s+=this.getHeightOfLine(a);return{textSpans:t,textBgRects:n}}_createTextCharSpan(r,e,t,n){const i=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(CO)),s=i?'style="'.concat(i,'"'):"",a=e.deltaY,c=a?' dy="'.concat(at(a,Ve.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(at(t,Ve.NUM_FRACTION_DIGITS),'" y="').concat(at(n,Ve.NUM_FRACTION_DIGITS),'" ').concat(c).concat(s,">").concat(ny(r),"</tspan>")}_setSVGTextLineText(r,e,t,n){const i=this.getHeightOfLine(e),s=this.textAlign.includes(mn),a=this._textLines[e];let c,u,h,d,g,p="",y=0;n+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let w=0,_=a.length-1;w<=_;w++)g=w===_||this.charSpacing,p+=a[w],h=this.__charBounds[e][w],y===0?(t+=h.kernedWidth-h.width,y+=h.width):y+=h.kernedWidth,s&&!g&&this._reSpaceAndTab.test(a[w])&&(g=!0),g||(c=c||this.getCompleteStyleDeclaration(e,w),u=this.getCompleteStyleDeclaration(e,w+1),g=Nc(c,u,!0)),g&&(d=this._getStyleDeclaration(e,w),r.push(this._createTextCharSpan(p,d,t,n)),p="",c=u,this.direction==="rtl"?t-=y:t+=y,y=0)}_setSVGTextLineBg(r,e,t,n){const i=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight;let a,c=0,u=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let d=0;d<i.length;d++){const{left:g,width:p,kernedWidth:y}=this.__charBounds[e][d];a=this.getValueOfPropertyAt(e,d,"textBackgroundColor"),a!==h?(h&&r.push(...Zd(h,t+u,n,c,s)),u=g,c=p,h=a):c+=y}a&&r.push(...Zd(h,t+u,n,c,s))}_getSVGLineTopOffset(r){let e,t=0;for(e=0;e<r;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," white-space: pre;")}getSvgSpanStyles(r,e){const{fontFamily:t,strokeWidth:n,stroke:i,fill:s,fontSize:a,fontStyle:c,fontWeight:u,deltaY:h}=r,d=this.getSvgTextDecoration(r);return[i?Ho(or,i):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",a?"font-size: ".concat(a,"px; "):"",c?"font-style: ".concat(c,"; "):"",u?"font-weight: ".concat(u,"; "):"",d&&"text-decoration: ".concat(d,"; "),s?Ho(It,s):"",h?"baseline-shift: ".concat(-h,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(e=>r[e.replace("-","")]).join(" ")}}]),ie.setClass(Qt),ie.setSVGClass(Qt);class kO{constructor(e){F(this,"target",void 0),F(this,"__mouseDownInPlace",!1),F(this,"__dragStartFired",!1),F(this,"__isDraggingOver",!1),F(this,"__dragStartSelection",void 0),F(this,"__dragImageDisposer",void 0),F(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:i,selectionEnd:s}=t;const a=this.target,c=a.canvas,u=new z(a.flipX?-1:1,a.flipY?-1:1),h=a._getCursorBoundaries(i),d=new z(h.left+h.leftOffset,h.top+h.topOffset).multiply(u).transform(a.calcTransformMatrix()),g=c.getScenePoint(e).subtract(d),p=a.getCanvasRetinaScaling(),y=a.getBoundingRect(),w=d.subtract(new z(y.left,y.top)),_=c.viewportTransform,S=w.add(g).transform(_,!0),T=a.backgroundColor,k=Bd(a.styles);a.backgroundColor="";const I={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};a.setSelectionStyles(I,0,i),a.setSelectionStyles(I,s,a.text.length),a.dirty=!0;const M=a.toCanvasElement({enableRetinaScaling:c.enableRetinaScaling,viewportTransform:!0});a.backgroundColor=T,a.styles=k,a.dirty=!0,Hc(M,{position:"fixed",left:"".concat(-M.width,"px"),border:sr,width:"".concat(M.width/p,"px"),height:"".concat(M.height/p,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{M.remove()},Zr(e.target||this.target.hiddenTextarea).body.appendChild(M),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(M,S.x,S.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const i=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(i.selectionStart,i.selectionEnd).join(""),a=j({text:t.text,value:s},i);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,a)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,i=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let s=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!i){const a=this.target,c=a.canvas;let u=a.getSelectionStartFromPointer(n);const{styles:h}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},d=s[Math.max(0,s.length-1)],g=0;if(this.__dragStartSelection){const p=this.__dragStartSelection.selectionStart,y=this.__dragStartSelection.selectionEnd;u>p&&u<=y?u=p:u>y&&(u-=y-p),a.removeChars(p,y),delete this.__dragStartSelection}a._reNewline.test(d)&&(a._reNewline.test(a._text[u])||u===a._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=a,a.insertChars(s,h,u),c.setActiveObject(a),a.enterEditing(n),a.selectionStart=Math.min(u+g,a._text.length),a.selectionEnd=Math.min(a.selectionStart+s.length,a._text.length),a.hiddenTextarea.value=a.text,a._updateTextarea(),a.hiddenTextarea.focus(),a.fire(yc,{index:u+g,action:"drop"}),c.fire("text:changed",{target:a}),c.contextTopDirty=!0,c.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const i=this.target,s=this.target.canvas,{selectionStart:a,selectionEnd:c}=this.__dragStartSelection,u=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||sr;u===sr?(i.selectionStart=a,i.selectionEnd=c,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),u==="move"&&(i.removeChars(a,c),i.selectionStart=i.selectionEnd=a,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(yc,{index:a,action:"dragend"}),s.fire("text:changed",{target:i}),s.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Uy=/[ \n\.,;!\?\-]/;class IO extends Qt{constructor(){super(...arguments),F(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:i,onComplete:s}=e;return Dd({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:i,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:a=>{this._currentCursorOpacity=a,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let i=e>0&&this._reSpace.test(n[e])&&(t===-1||!ld.test(n[e-1]))?e-1:e,s=n[i];for(;i>0&&i<n.length&&!Uy.test(s);)i+=t,s=n[i];return t===-1&&Uy.test(s)&&i++,i}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Zr(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),i=this.selectionStart,s=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&i!==s||i!==n&&s!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const i=n.slice(0,e),s=this.graphemeSplit(i).length;if(e===t)return{selectionStart:s,selectionEnd:s};const a=n.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(a).length}}fromGraphemeToStringSelection(e,t,n){const i=n.slice(0,e).join("").length;return e===t?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),i=n.lineIndex,s=n.charIndex,a=this.getValueOfPropertyAt(i,s,"fontSize")*this.lineHeight,c=t.leftOffset,u=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,g=h.height/u,p=d-a,y=g-a,w=new z(t.left+c,t.top+t.topOffset+a).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new z(h.clientWidth/d,h.clientHeight/g));return w.x<0&&(w.x=0),w.x>p&&(w.x=p),w.y<0&&(w.y=0),w.y>y&&(w.y=y),w.x+=this.canvas._offset.left,w.y+=this.canvas._offset.top,{left:"".concat(w.x,"px"),top:"".concat(w.y,"px"),fontSize:"".concat(a,"px"),charHeight:a}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(wc),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:a}=this.get2DCursorLocation(t,!0);if(n!==s){if(this.styles[n])for(let c=i;c<this._unwrappedTextLines[n].length;c++)delete this.styles[n][c];if(this.styles[s])for(let c=a;c<this._unwrappedTextLines[s].length;c++){const u=this.styles[s][c];u&&(this.styles[n]||(this.styles[n]={}),this.styles[n][i+c-a]=u)}for(let c=n+1;c<=s;c++)delete this.styles[c];this.shiftLineStyles(s,n-s)}else if(this.styles[n]){const c=this.styles[n],u=a-i;for(let h=i;h<a;h++)delete c[h];for(const h in this.styles[n]){const d=parseInt(h,10);d>=a&&(c[d-u]=c[h],delete c[h])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const i in this.styles){const s=parseInt(i,10);s>e&&(this.styles[s+t]=n[s],n[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,n,i){const s={},a=this._unwrappedTextLines[e].length,c=a===t;let u=!1;n||(n=1),this.shiftLineStyles(e,n);const h=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const g in this.styles[e]){const p=parseInt(g,10);p>=t&&(u=!0,s[p-t]=this.styles[e][g],c&&t===0||delete this.styles[e][g])}let d=!1;for(u&&!c&&(this.styles[e+n]=s,d=!0),(d||a>t)&&n--;n>0;)i&&i[n-1]?this.styles[e+n]={0:j({},i[n-1])}:h?this.styles[e+n]={0:j({},h)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,i){this.styles||(this.styles={});const s=this.styles[e],a=s?j({},s):{};n||(n=1);for(const u in a){const h=parseInt(u,10);h>=t&&(s[h+n]=a[h],a[h-n]||delete s[h])}if(this._forceClearCache=!0,i){for(;n--;)Object.keys(i[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=j({},i[n]));return}if(!s)return;const c=s[t?t-1:1];for(;c&&n--;)this.styles[e][t+n]=j({},c)}insertNewStyleBlock(e,t,n){const i=this.get2DCursorLocation(t,!0),s=[0];let a,c=0;for(let u=0;u<e.length;u++)e[u]===`
`?(c++,s[c]=0):s[c]++;for(s[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,s[0],n),n=n&&n.slice(s[0]+1)),c&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+s[0],c),a=1;a<c;a++)s[a]>0?this.insertCharStyleObject(i.lineIndex+a,0,s[a],n):n&&this.styles[i.lineIndex+a]&&n[0]&&(this.styles[i.lineIndex+a][0]=n[0]),n=n&&n.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(i.lineIndex+a,0,s[a],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;i>n&&this.removeStyleFromTo(n,i);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,n,t),this._text=[...this._text.slice(0,n),...s,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Ue:this._selectionDirection===wt&&(this._selectionDirection=Ue,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===wt?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=wt:this._selectionDirection===Ue&&(this._selectionDirection=wt,this.selectionStart=t),this.selectionEnd=n)}}class AO extends IO{initHiddenTextarea(){const e=this.canvas&&Zr(this.canvas.getElement())||Os(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(a=>{let[c,u]=a;return t.setAttribute(c,u)});const{top:n,left:i,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(i,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(a=>{let[c,u]=a;return t.addEventListener(c,this[u].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const n=()=>{this.updateFromTextArea(),this.fire(yc),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void n();const i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,a=i.length,c=this.selectionStart,u=this.selectionEnd,h=c!==u;let d,g,p,y,w=a-s;const _=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),S=c>_.selectionStart;h?(g=this._text.slice(c,u),w+=u-c):a<s&&(g=S?this._text.slice(u+w,u):this._text.slice(c,c-w));const T=i.slice(_.selectionEnd-w,_.selectionEnd);if(g&&g.length&&(T.length&&(d=this.getSelectionStyles(c,c+1,!1),d=T.map(()=>d[0])),h?(p=c,y=u):S?(p=u-g.length,y=u):(p=u,y=u+g.length),this.removeStyleFromTo(p,y)),T.length){const{copyPasteData:k}=gn();t&&T.join("")===k.copiedText&&!Ve.disableStyleCopyPaste&&(d=k.copiedTextStyle),this.insertNewStyleBlock(T,c,d)}n()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:i}=t;this.compositionStart=n,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=gn();e.copiedText=this.getSelectedText(),Ve.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,i=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],i+=n.left+n.width),i}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),s=i.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const a=i.charIndex,c=this._getWidthBeforeCursor(s,a),u=this._getIndexOnLine(s+1,c);return this._textLines[s].slice(a).length+u+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),s=i.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-n;const a=i.charIndex,c=this._getWidthBeforeCursor(s,a),u=this._getIndexOnLine(s-1,c),h=this._textLines[s].slice(0,a),d=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+u-h.length+(1-d)}_getIndexOnLine(e,t){const n=this._textLines[e];let i,s,a=this._getLineLeftOffset(e),c=0;for(let u=0,h=n.length;u<h;u++)if(i=this.__charBounds[e][u].width,a+=i,a>t){s=!0;const d=a-i,g=a,p=Math.abs(d-t);c=Math.abs(g-t)<p?u:u-1;break}return s||(c=n.length-1),c}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===wt);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const i=this.text.length;this.selectionStart=Vi(0,this.selectionStart,i),this.selectionEnd=Vi(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Ue?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let i;if(e.altKey)i=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;i=this["findLineBoundary".concat(n)](this[t])}return i!==void 0&&this[t]!==i&&(this[t]=i,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Ue,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===wt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Ue,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Ue&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=wt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=wt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Qd=r=>!!r.button;class MO extends AO{constructor(){super(...arguments),F(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new kO(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),bd(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!Qd(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!Qd(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:n}=e;const i=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Qd(t)||i||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(vr(this.calcTransformMatrix())).add(new z(-this._getLeftOffset(),-this._getTopOffset()));let n=0,i=0,s=0;for(let h=0;h<this._textLines.length&&n<=t.y;h++)n+=this.getHeightOfLine(h),s=h,h>0&&(i+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let a=Math.abs(this._getLineLeftOffset(s));const c=this._textLines[s].length,u=this.__charBounds[s];for(let h=0;h<c;h++){const d=a+u[h].kernedWidth;if(t.x<=d){Math.abs(t.x-d)<=Math.abs(t.x-a)&&i++;break}a=d,i++}return Math.min(this.flipX?c-i:i,this._text.length)}}const Xc="moveCursorUp",Gc="moveCursorDown",qc="moveCursorLeft",Kc="moveCursorRight",Zc="exitEditing",OO=j({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Zc,27:Zc,33:Xc,34:Gc,35:Kc,36:qc,37:qc,38:Xc,39:Kc,40:Gc},keysMapRtl:{9:Zc,27:Zc,33:Xc,34:Gc,35:qc,36:Kc,37:Kc,38:Xc,39:qc,40:Gc},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Fn extends MO{static getDefaults(){return j(j({},super.getDefaults()),Fn.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,j(j({},Fn.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Gd&&this.canvas.textEditingManager.remove(this),t instanceof Gd&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),i=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:n,top:i,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:i,lineIndex:s}=this.get2DCursorLocation(e);for(let h=0;h<s;h++)t+=this.getHeightOfLine(h);const a=this._getLineLeftOffset(s),c=this.__charBounds[s][i];c&&(n=c.left),this.charSpacing!==0&&i===this._textLines[s].length&&(n-=this._getWidthOfCharSpacing());const u={top:t,left:a+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===wt||this.textAlign===mn||this.textAlign===Ko?u.left*=-1:this.textAlign===Ue||this.textAlign===Yc?u.left=a-(n>0?n:0):this.textAlign!==Ee&&this.textAlign!==Zo||(u.left=a-(n>0?n:0))),u}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),i=n.lineIndex,s=n.charIndex>0?n.charIndex-1:0,a=this.getValueOfPropertyAt(i,s,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/c,h=this.getValueOfPropertyAt(i,s,"deltaY"),d=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-a*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-u/2,top:d+t.top+h,width:u,height:a}}_renderCursor(e,t,n){const{color:i,opacity:s,left:a,top:c,width:u,height:h}=this.getCursorRenderingData(n,t);e.fillStyle=i,e.globalAlpha=s,e.fillRect(a,c,u,h)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const i=t.selectionStart,s=t.selectionEnd,a=this.textAlign.includes(mn),c=this.get2DCursorLocation(i),u=this.get2DCursorLocation(s),h=c.lineIndex,d=u.lineIndex,g=c.charIndex<0?0:c.charIndex,p=u.charIndex<0?0:u.charIndex;for(let y=h;y<=d;y++){const w=this._getLineLeftOffset(y)||0;let _=this.getHeightOfLine(y),S=0,T=0,k=0;if(y===h&&(T=this.__charBounds[h][g].left),y>=h&&y<d)k=a&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===d)if(p===0)k=this.__charBounds[d][p].left;else{const H=this._getWidthOfCharSpacing();k=this.__charBounds[d][p-1].left+this.__charBounds[d][p-1].width-H}S=_,(this.lineHeight<1||y===d&&this.lineHeight>1)&&(_/=this.lineHeight);let I=n.left+w+T,M=_,L=0;const N=k-T;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",M=1,L=_):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===wt||this.textAlign===mn||this.textAlign===Ko?I=this.width-I-N:this.textAlign===Ue||this.textAlign===Yc?I=n.left+w-k:this.textAlign!==Ee&&this.textAlign!==Zo||(I=n.left+w-k)),e.fillRect(I,n.top+n.topOffset+L,N,M),n.topOffset+=S}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,It)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}F(Fn,"ownDefaults",OO),F(Fn,"type","IText"),ie.setClass(Fn),ie.setClass(Fn,"i-text");class $i extends Fn{static getDefaults(){return j(j({},super.getDefaults()),$i.ownDefaults)}constructor(e,t){super(e,j(j({},$i.ownDefaults),t))}static createControls(){return{controls:Z1()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(mn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,i=0;const s={};for(let a=0;a<e.graphemeLines.length;a++)e.graphemeText[i]===`
`&&a>0?(n=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&a>0&&(n++,i++),s[a]={line:t,offset:n},i+=e.graphemeLines[a].length,n+=e.graphemeLines[a].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,i=e+1,s=!1;const a=this._styleMap[e],c=this._styleMap[e+1];a&&(e=a.line,n=a.offset),c&&(i=c.line,s=i===e,t=c.offset);const u=e===void 0?this.styles:{line:this.styles[e]};for(const h in u)for(const d in u[h]){const g=parseInt(d,10);if(g>=n&&(!s||g<t))for(const p in u[h][d])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const i=this._styleMap[e];super._setStyleDeclaration(i.line,i.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),i=[];for(let s=0;s<n.wordsData.length;s++)i.push(...this._wrapLine(s,t,n));return this.isWrapping=!1,i}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let i=0;return{wordsData:e.map((s,a)=>{let c=0;const u=t?this.graphemeSplit(s):this.wordSplit(s);return u.length===0?[{word:[],width:0}]:u.map(h=>{const d=t?[h]:this.graphemeSplit(h),g=this._measureWord(d,a,c);return i=Math.max(g,i),c+=d.length+n.length,{word:d,width:g}})}),largestWordWidth:i}}_measureWord(e,t){let n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let a=0,c=e.length;a<c;a++)s+=this._getGraphemeBox(e[a],t,a+i,n,!0).kernedWidth,n=e[a];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:i,wordsData:s}=n,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,h=[],d=u?"":" ";let g=0,p=[],y=0,w=0,_=!0;t-=a;const S=Math.max(t,i,this.dynamicMinWidth),T=s[e];let k;for(y=0,k=0;k<T.length;k++){const{word:I,width:M}=T[k];y+=I.length,g+=w+M-c,g>S&&!_?(h.push(p),p=[],g=M,_=!0):g+=c,_||u||p.push(d),p=p.concat(I),w=u?0:this._measureWord([d],e,y),y++,_=!1}return k&&h.push(p),i+a>this.dynamicMinWidth&&(this.dynamicMinWidth=i-c+a),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),i=new Array(n.length);for(let s=0;s<n.length;s++)i[s]=n[s].join("");return t.lines=i,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const i=this._styleMap[t].line;e.set("".concat(i),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}F($i,"type","Textbox"),F($i,"textLayoutProperties",[...Fn.textLayoutProperties,"width"]),F($i,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ie.setClass($i);class $y extends Bc{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:i,group:s}=n;if(!i||!this.shouldPerformLayout(e))return;const{width:a,height:c}=pn(py(n,i)),u=new z(a,c);if(i.absolutePositioned)return{center:In(i.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:u};{const h=i.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:d=new z,correction:g=new z}=this.calcBoundingBox(t,e)||{};return{center:d.add(h),correction:g.subtract(h),size:u}}return{center:n.getRelativeCenterPoint().add(h),size:u}}}}F($y,"type","clip-path"),ie.setClass($y);class Yy extends Bc{getInitialSize(e,t){let{target:n}=e,{size:i}=t;return new z(n.width||i.x,n.height||i.y)}}F(Yy,"type","fixed"),ie.setClass(Yy);class PO extends Go{subscribeTargets(e){const t=e.target;e.targets.reduce((n,i)=>(i.parent&&n.add(i.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce((i,s)=>(s.parent&&i.add(s.parent),i),new Set).forEach(i=>{!n.some(s=>s.parent===i)&&i.layoutManager.unsubscribeTargets({target:i,targets:[t]})})}}class vn extends jr{static getDefaults(){return j(j({},super.getDefaults()),vn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,vn.ownDefaults),this.setOptions(t);const{left:n,top:i,layoutManager:s}=t;this.groupInit(e,{left:n,top:i,layoutManager:s??new PO})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(i=>{const s=this._objects.findIndex(c=>c.isInFrontOf(i)),a=s===-1?this.size():s;this.insertAt(a,i)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(ni("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach(i=>{const{parent:s}=i;s&&n.add(s)}),e===Wd?n.forEach(i=>{i._onAfterObjectsChange(Rc,t)}):n.forEach(i=>{i._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const i=j(j({hasControls:!1},n),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,i);super._renderControls(e,t),e.restore()}}F(vn,"type","ActiveSelection"),F(vn,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ie.setClass(vn),ie.setClass(vn,"activeSelection");class DO{constructor(){F(this,"resources",{})}applyFilters(e,t,n,i,s){const a=s.getContext("2d");if(!a)return;a.drawImage(t,0,0,n,i);const c={sourceWidth:n,sourceHeight:i,imageData:a.getImageData(0,0,n,i),originalEl:t,originalImageData:a.getImageData(0,0,n,i),canvasEl:s,ctx:a,filterBackend:this};e.forEach(h=>{h.applyTo(c)});const{imageData:u}=c;return u.width===n&&u.height===i||(s.width=u.width,s.height=u.height),a.putImageData(u,0,0),c}}class Xy{constructor(){let{tileSize:e=Ve.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};F(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),F(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=Kr({width:e,height:t}),i=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)}applyFilters(e,t,n,i,s,a){const c=this.gl,u=s.getContext("2d");if(!c||!u)return;let h;a&&(h=this.getCachedTexture(a,t));const d={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:i,destinationWidth:n,destinationHeight:i,context:c,sourceTexture:this.createTexture(c,n,i,h?void 0:t),targetTexture:this.createTexture(c,n,i),originalTexture:h||this.createTexture(c,n,i,h?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},g=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,g),e.forEach(p=>{p&&p.applyTo(d)}),function(p){const y=p.targetCanvas,w=y.width,_=y.height,S=p.destinationWidth,T=p.destinationHeight;w===S&&_===T||(y.width=S,y.height=T)}(d),this.copyGLTo2D(c,d),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(d.sourceTexture),c.deleteTexture(d.targetTexture),c.deleteFramebuffer(g),u.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,i,s){const{NEAREST:a,TEXTURE_2D:c,RGBA:u,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:g,TEXTURE_MIN_FILTER:p,TEXTURE_WRAP_S:y,TEXTURE_WRAP_T:w}=e,_=e.createTexture();return e.bindTexture(c,_),e.texParameteri(c,g,s||a),e.texParameteri(c,p,s||a),e.texParameteri(c,y,d),e.texParameteri(c,w,d),i?e.texImage2D(c,0,u,u,h,i):e.texImage2D(c,0,u,t,n,0,u,h,null),_}getCachedTexture(e,t,n){const{textureCache:i}=this;if(i[e])return i[e];{const s=this.createTexture(this.gl,t.width,t.height,t,n);return s&&(i[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,i=t.targetCanvas,s=i.getContext("2d");if(!s)return;s.translate(0,i.height),s.scale(1,-1);const a=n.height-i.height;s.drawImage(n,0,a,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),i=t.destinationWidth,s=t.destinationHeight,a=i*s*4;if(!n)return;const c=new Uint8Array(this.imageBuffer,0,a),u=new Uint8ClampedArray(this.imageBuffer,0,a);e.readPixels(0,0,i,s,e.RGBA,e.UNSIGNED_BYTE,c);const h=new ImageData(u,i,s);n.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const i=e.getParameter(n.UNMASKED_RENDERER_WEBGL),s=e.getParameter(n.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let ef;function jO(){const{WebGLProbe:r}=gn();return r.queryWebGL(Pr()),Ve.enableGLFiltering&&r.isSupported(Ve.textureSize)?new Xy({tileSize:Ve.textureSize}):new DO}function tf(){return!ef&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(ef=jO()),ef}const LO=["filters","resizeFilter","src","crossOrigin","type"],Gy=["cropX","cropY"];class Fr extends Ze{static getDefaults(){return j(j({},super.getDefaults()),Fr.ownDefaults)}constructor(e,t){super(),F(this,"_lastScaleX",1),F(this,"_lastScaleY",1),F(this,"_filterScalingX",1),F(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Fr.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(oi()),this.setElement(typeof e=="string"?(this.canvas&&Zr(this.canvas.getElement())||Os()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(Fr.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=tf(!1);t instanceof Xy&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&gn().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),j(j({},super.toObject([...Gy,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,i=-this.height/2;let s=[],a=[],c="",u="";if(!t)return[];if(this.hasCrop()){const h=oi();s.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+n+'" y="'+i+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(i-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(u).concat(c,`></image>
`)),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,a=['	<rect x="'.concat(n,'" y="').concat(i,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=h}return s=this.paintFirst!==It?s.concat(a,e):s.concat(e,a),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Vo(e,{crossOrigin:t,signal:n}).then(i=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(i)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.x,s=n.y,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&s>t)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=s);const c=Kr(a),{width:u,height:h}=a;this._element=c,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=s,tf().applyFilters([e],a,u,h,this._element),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){const s=Kr({width:n,height:i});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1);tf().applyFilters(e,this._originalElement,n,i,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,i=this._filterScalingY,s=this.width,a=this.height,c=Math.max(this.cropX,0),u=Math.max(this.cropY,0),h=t.naturalWidth||t.width,d=t.naturalHeight||t.height,g=c*n,p=u*i,y=Math.min(s*n,h-g),w=Math.min(a*i,d-p),_=-s/2,S=-a/2,T=Math.min(s,h/n-c),k=Math.min(a,d/i-u);t&&e.drawImage(t,g,p,y,w,_,S,T,k)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=u1(this.preserveAspectRatio||""),t=this.width,n=this.height,i={width:t,height:n};let s,a=this._element.width,c=this._element.height,u=1,h=1,d=0,g=0,p=0,y=0;return!e||e.alignX===sr&&e.alignY===sr?(u=t/a,h=n/c):(e.meetOrSlice==="meet"&&(u=h=vy(this._element,i),s=(t-a*u)/2,e.alignX==="Min"&&(d=-s),e.alignX==="Max"&&(d=s),s=(n-c*h)/2,e.alignY==="Min"&&(g=-s),e.alignY==="Max"&&(g=s)),e.meetOrSlice==="slice"&&(u=h=yy(this._element,i),s=a-t/u,e.alignX==="Mid"&&(p=s/2),e.alignX==="Max"&&(p=s),s=c-n/h,e.alignY==="Mid"&&(y=s/2),e.alignY==="Max"&&(y=s),a=t/u,c=n/h)),{width:a,height:c,scaleX:u,scaleY:h,offsetLeft:d,offsetTop:g,cropX:p,cropY:y}}static fromObject(e,t){let{filters:n,resizeFilter:i,src:s,crossOrigin:a,type:c}=e,u=ot(e,LO);return Promise.all([Vo(s,j(j({},t),{},{crossOrigin:a})),n&&Rs(n,t),i&&Rs([i],t),Bo(u,t)]).then(h=>{let[d,g=[],[p]=[],y={}]=h;return new this(d,j(j({},u),{},{src:s,filters:g,resizeFilter:p},y))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return Vo(e,{crossOrigin:t,signal:n}).then(s=>new this(s,i))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const i=Pn(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(i["xlink:href"],t,i).catch(s=>(ni("log","Unable to parse Image",s),null))}}F(Fr,"type","Image"),F(Fr,"cacheProperties",[...Mn,...Gy]),F(Fr,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),F(Fr,"CSS_CANVAS","canvas-img"),F(Fr,"ATTRIBUTE_NAMES",[...li,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),ie.setClass(Fr),ie.setSVGClass(Fr),Mc(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const qy=Zv,Ky=r=>function(e,t,n){const{points:i,pathOffset:s}=n;return new z(i[r]).subtract(s).transform(mt(n.getViewportTransform(),n.calcTransformMatrix()))},Zy=(r,e,t,n)=>{const{target:i,pointIndex:s}=e,a=i,c=In(new z(t,n),void 0,a.calcOwnMatrix());return a.points[s]=c.add(a.pathOffset),a.setDimensions(),!0},Jy=(r,e)=>function(t,n,i,s){const a=n.target,c=new z(a.points[(r>0?r:a.points.length)-1]),u=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()),h=e(t,j(j({},n),{},{pointIndex:r}),i,s),d=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()).subtract(u);return a.left-=d.x,a.top-=d.y,h},Qy=r=>ci(qy,Jy(r,Zy)),rf=(r,e,t)=>{const{path:n,pathOffset:i}=r,s=n[e];return new z(s[t]-i.x,s[t+1]-i.y).transform(mt(r.getViewportTransform(),r.calcTransformMatrix()))};function FO(r,e,t){const{commandIndex:n,pointIndex:i}=this;return rf(t,n,i)}function NO(r,e,t,n){const{target:i}=e,{commandIndex:s,pointIndex:a}=this,c=((u,h,d,g,p)=>{const{path:y,pathOffset:w}=u,_=y[(g>0?g:y.length)-1],S=new z(_[p],_[p+1]),T=S.subtract(w).transform(u.calcOwnMatrix()),k=In(new z(h,d),void 0,u.calcOwnMatrix());y[g][p]=k.x+w.x,y[g][p+1]=k.y+w.y,u.setDimensions();const I=S.subtract(u.pathOffset).transform(u.calcOwnMatrix()).subtract(T);return u.left-=I.x,u.top-=I.y,u.set("dirty",!0),!0})(i,t,n,s,a);return _d(this.actionName,j(j({},Sd(r,e,t,n)),{},{commandIndex:s,pointIndex:a})),c}class eb extends ut{constructor(e){super(e)}render(e,t,n,i,s){const a=j(j({},i),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,a,s)}}class RO extends eb{constructor(e){super(e)}render(e,t,n,i,s){const{path:a}=s,{commandIndex:c,pointIndex:u,connectToCommandIndex:h,connectToPointIndex:d}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);const[g]=a[c],p=rf(s,h,d);if(g==="Q"){const y=rf(s,c,u+2);e.moveTo(y.x,y.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(p.x,p.y),e.stroke(),e.restore(),super.render(e,t,n,i,s)}}const Jc=(r,e,t,n,i,s)=>new(t?RO:eb)(j(j({commandIndex:r,pointIndex:e,actionName:"modifyPath",positionHandler:FO,actionHandler:NO,connectToCommandIndex:i,connectToPointIndex:s},n),t?n.controlPointStyle:n.pointStyle));var $t=Object.freeze({__proto__:null,changeWidth:jd,createObjectDefaultControls:Vd,createPathControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};let n="M";return r.path.forEach((i,s)=>{const a=i[0];switch(a!=="Z"&&(t["c_".concat(s,"_").concat(a)]=Jc(s,i.length-2,!1,e)),a){case"C":t["c_".concat(s,"_C_CP_1")]=Jc(s,1,!0,e,s-1,(c=>c==="C"?5:c==="Q"?3:1)(n)),t["c_".concat(s,"_C_CP_2")]=Jc(s,3,!0,e,s,5);break;case"Q":t["c_".concat(s,"_Q_CP_1")]=Jc(s,1,!0,e,s,3)}n=a}),t},createPolyActionHandler:Qy,createPolyControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};for(let n=0;n<(typeof r=="number"?r:r.points.length);n++)t["p".concat(n)]=new ut(j({actionName:qy,positionHandler:Ky(n),actionHandler:Qy(n)},e));return t},createPolyPositionHandler:Ky,createResizeControls:K1,createTextboxDefaultControls:Z1,dragHandler:T1,factoryPolyActionHandler:Jy,getLocalPoint:Ac,polyActionHandler:Zy,renderCircleControl:R1,renderSquareControl:V1,rotationStyleHandler:B1,rotationWithSnapping:z1,scaleCursorStyleHandler:zs,scaleOrSkewActionName:Yo,scaleSkewCursorStyleHandler:zi,scalingEqually:$o,scalingX:U1,scalingXOrSkewingY:Nd,scalingY:$1,scalingYOrSkewingX:Rd,skewCursorStyleHandler:Y1,skewHandlerX:G1,skewHandlerY:q1,wrapWithFireEvent:ci,wrapWithFixedAnchor:Bi});const Qc=r=>r.webgl!==void 0,nf="precision highp float",VO=`
    `.concat(nf,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),BO=["type"],zO=["type"],HO=new RegExp(nf,"g");class At{get type(){return this.constructor.type}constructor(){let e=ot(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},BO);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return VO}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:i="highp"}}=gn();i!=="highp"&&(t=t.replace(HO,nf.replace("highp",i)));const s=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER),c=e.createProgram();if(!s||!a||!c)throw new fn("Vertex, fragment shader or program creation error");if(e.shaderSource(s,n),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new fn("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new fn("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.attachShader(c,s),e.attachShader(c,a),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new fn('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(c)));const u=this.getUniformLocations(e,c)||{};return u.uStepW=e.getUniformLocation(c,"uStepW"),u.uStepH=e.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:this.getAttributeLocations(e,c),uniformLocations:u}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,i={};for(let s=0;s<n.length;s++)i[n[s]]=e.getUniformLocation(t,n[s]);return i}sendAttributeData(e,t,n){const i=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,i=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===i||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,i)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Qc(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,i=Kr({width:t,height:n});e.helpLayer=i}}toObject(){const e=Object.keys(this.constructor.defaults||{});return j({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(ot(e,zO))}}F(At,"type","BaseFilter"),F(At,"uniformLocations",[]);const WO={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class el extends At{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(WO[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new Xe(this.color).getSource(),i=this.alpha,s=n[0]*i,a=n[1]*i,c=n[2]*i,u=1-i;for(let h=0;h<t.length;h+=4){const d=t[h],g=t[h+1],p=t[h+2];let y,w,_;switch(this.mode){case"multiply":y=d*s/255,w=g*a/255,_=p*c/255;break;case"screen":y=255-(255-d)*(255-s)/255,w=255-(255-g)*(255-a)/255,_=255-(255-p)*(255-c)/255;break;case"add":y=d+s,w=g+a,_=p+c;break;case"difference":y=Math.abs(d-s),w=Math.abs(g-a),_=Math.abs(p-c);break;case"subtract":y=d-s,w=g-a,_=p-c;break;case"darken":y=Math.min(d,s),w=Math.min(g,a),_=Math.min(p,c);break;case"lighten":y=Math.max(d,s),w=Math.max(g,a),_=Math.max(p,c);break;case"overlay":y=s<128?2*d*s/255:255-2*(255-d)*(255-s)/255,w=a<128?2*g*a/255:255-2*(255-g)*(255-a)/255,_=c<128?2*p*c/255:255-2*(255-p)*(255-c)/255;break;case"exclusion":y=s+d-2*s*d/255,w=a+g-2*a*g/255,_=c+p-2*c*p/255;break;case"tint":y=s+d*u,w=a+g*u,_=c+p*u}t[h]=y,t[h+1]=w,t[h+2]=_}}sendUniformData(e,t){const n=new Xe(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}F(el,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),F(el,"type","BlendColor"),F(el,"uniformLocations",["uColor"]),ie.setClass(el);const UO={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},$O=["type","image"];class tl extends At{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return UO[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:i},filterBackend:{resources:s}}=e;const a=this.image;s.blendImage||(s.blendImage=Pr());const c=s.blendImage,u=c.getContext("2d");c.width!==n||c.height!==i?(c.width=n,c.height=i):u.clearRect(0,0,n,i),u.setTransform(a.scaleX,0,0,a.scaleY,a.left,a.top),u.drawImage(a.getElement(),0,0,n,i);const h=u.getImageData(0,0,n,i).data;for(let d=0;d<t.length;d+=4){const g=t[d],p=t[d+1],y=t[d+2],w=t[d+3],_=h[d],S=h[d+1],T=h[d+2],k=h[d+3];switch(this.mode){case"multiply":t[d]=g*_/255,t[d+1]=p*S/255,t[d+2]=y*T/255,t[d+3]=w*k/255;break;case"mask":t[d+3]=k}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return j(j({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:i}=e,s=ot(e,$O);return Fr.fromObject(i,t).then(a=>new this(j(j({},s),{},{image:a})))}}F(tl,"type","BlendImage"),F(tl,"defaults",{mode:"multiply",alpha:1}),F(tl,"uniformLocations",["uTransformMatrix","uImage"]),ie.setClass(tl);class rl extends At{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){Qc(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:n,filterBackend:{resources:i}}=e;const{width:s,height:a}=n;i.blurLayer1||(i.blurLayer1=Pr(),i.blurLayer2=Pr());const c=i.blurLayer1,u=i.blurLayer2;c.width===s&&c.height===a||(u.width=c.width=s,u.height=c.height=a);const h=c.getContext("2d"),d=u.getContext("2d"),g=15,p=.06*this.blur*.5;let y,w,_,S;for(h.putImageData(n,0,0),d.clearRect(0,0,s,a),S=-15;S<=g;S++)y=(Math.random()-.5)/4,w=S/g,_=p*w*s+y,d.globalAlpha=1-Math.abs(w),d.drawImage(c,_,y),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);for(S=-15;S<=g;S++)y=(Math.random()-.5)/4,w=S/g,_=p*w*a+y,d.globalAlpha=1-Math.abs(w),d.drawImage(c,y,_),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);t.drawImage(c,0,0);const T=t.getImageData(0,0,c.width,c.height);return h.globalAlpha=1,h.clearRect(0,0,c.width,c.height),T}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const n=e*this.blur*.12;return this.horizontal?t[0]=n:t[1]=n,t}}F(rl,"type","Blur"),F(rl,"defaults",{blur:0}),F(rl,"uniformLocations",["uDelta"]),ie.setClass(rl);class nl extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let i=0;i<t.length;i+=4)t[i]+=n,t[i+1]+=n,t[i+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}F(nl,"type","Brightness"),F(nl,"defaults",{brightness:0}),F(nl,"uniformLocations",["uBrightness"]),ie.setClass(nl);const tb={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class $s extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,i=this.colorsOnly;for(let s=0;s<t.length;s+=4){const a=t[s],c=t[s+1],u=t[s+2];if(t[s]=a*n[0]+c*n[1]+u*n[2]+255*n[4],t[s+1]=a*n[5]+c*n[6]+u*n[7]+255*n[9],t[s+2]=a*n[10]+c*n[11]+u*n[12]+255*n[14],!i){const h=t[s+3];t[s]+=h*n[3],t[s+1]+=h*n[8],t[s+2]+=h*n[13],t[s+3]=a*n[15]+c*n[16]+u*n[17]+h*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,i=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],s=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,s)}toObject(){return j(j({},super.toObject()),{},{matrix:[...this.matrix]})}}function Yi(r,e){var t;const n=(F(t=class extends $s{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),F(t,"defaults",{colorsOnly:!1,matrix:e}),t);return ie.setClass(n,r),n}F($s,"type","ColorMatrix"),F($s,"defaults",tb),F($s,"uniformLocations",["uColorMatrix","uConstants"]),ie.setClass($s),Yi("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),Yi("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),Yi("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),Yi("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),Yi("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),Yi("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),Yi("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class rb extends At{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Qc(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>ie.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}}F(rb,"type","Composed"),ie.setClass(rb);class il extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),i=259*(n+255)/(255*(259-n));for(let s=0;s<t.length;s+=4)t[s]=i*(t[s]-128)+128,t[s+1]=i*(t[s+1]-128)+128,t[s+2]=i*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}F(il,"type","Contrast"),F(il,"defaults",{contrast:0}),F(il,"uniformLocations",["uContrast"]),ie.setClass(il);const YO={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class sl extends At{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return YO[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,i=this.matrix,s=Math.round(Math.sqrt(i.length)),a=Math.floor(s/2),c=t.width,u=t.height,h=e.ctx.createImageData(c,u),d=h.data,g=this.opaque?1:0;let p,y,w,_,S,T,k,I,M,L,N,H,R;for(N=0;N<u;N++)for(L=0;L<c;L++){for(S=4*(N*c+L),p=0,y=0,w=0,_=0,R=0;R<s;R++)for(H=0;H<s;H++)k=N+R-a,T=L+H-a,k<0||k>=u||T<0||T>=c||(I=4*(k*c+T),M=i[R*s+H],p+=n[I]*M,y+=n[I+1]*M,w+=n[I+2]*M,g||(_+=n[I+3]*M));d[S]=p,d[S+1]=y,d[S+2]=w,d[S+3]=g?n[S+3]:_}e.imageData=h}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return j(j({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}F(sl,"type","Convolute"),F(sl,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),F(sl,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ie.setClass(sl);const nb="Gamma";class ol extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,i=1/n[0],s=1/n[1],a=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const c=this.rgbValues;for(let u=0;u<256;u++)c.r[u]=255*Math.pow(u/255,i),c.g[u]=255*Math.pow(u/255,s),c.b[u]=255*Math.pow(u/255,a);for(let u=0;u<t.length;u+=4)t[u]=c.r[t[u]],t[u+1]=c.g[t[u+1]],t[u+2]=c.b[t[u+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:nb,gamma:this.gamma.concat()}}}F(ol,"type",nb),F(ol,"defaults",{gamma:[1,1,1]}),F(ol,"uniformLocations",["uGamma"]),ie.setClass(ol);const XO={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class al extends At{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,i=0;i<t.length;i+=4){const s=t[i],a=t[i+1],c=t[i+2];switch(this.mode){case"average":n=(s+a+c)/3;break;case"lightness":n=(Math.min(s,a,c)+Math.max(s,a,c))/2;break;case"luminosity":n=.21*s+.72*a+.07*c}t[i+2]=t[i+1]=t[i]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return XO[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}F(al,"type","Grayscale"),F(al,"defaults",{mode:"average"}),F(al,"uniformLocations",["uMode"]),ie.setClass(al);const GO=j(j({},tb),{},{rotation:0});class sf extends $s{calculateMatrix(){const e=this.rotation*Math.PI,t=Gr(e),n=qr(e),i=1/3,s=Math.sqrt(i)*n,a=1-t;this.matrix=[t+a/3,i*a-s,i*a+s,0,0,i*a+s,t+i*a,i*a-s,0,0,i*a-s,i*a+s,t+i*a,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}F(sf,"type","HueRotation"),F(sf,"defaults",GO),ie.setClass(sf);class cl extends At{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}F(cl,"type","Invert"),F(cl,"defaults",{alpha:!1,invert:!0}),F(cl,"uniformLocations",["uInvert","uAlpha"]),ie.setClass(cl);class ll extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let i=0;i<t.length;i+=4){const s=(.5-Math.random())*n;t[i]+=s,t[i+1]+=s,t[i+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}F(ll,"type","Noise"),F(ll,"defaults",{noise:0}),F(ll,"uniformLocations",["uNoise","uSeed"]),ie.setClass(ll);class ul extends At{applyTo2d(e){let{imageData:{data:t,width:n,height:i}}=e;for(let s=0;s<i;s+=this.blocksize)for(let a=0;a<n;a+=this.blocksize){const c=4*s*n+4*a,u=t[c],h=t[c+1],d=t[c+2],g=t[c+3];for(let p=s;p<Math.min(s+this.blocksize,i);p++)for(let y=a;y<Math.min(a+this.blocksize,n);y++){const w=4*p*n+4*y;t[w]=u,t[w+1]=h,t[w+2]=d,t[w+3]=g}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}F(ul,"type","Pixelate"),F(ul,"defaults",{blocksize:4}),F(ul,"uniformLocations",["uBlocksize"]),ie.setClass(ul);class hl extends At{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,i=new Xe(this.color).getSource(),s=[i[0]-n,i[1]-n,i[2]-n],a=[i[0]+n,i[1]+n,i[2]+n];for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],d=t[c+2];u>s[0]&&h>s[1]&&d>s[2]&&u<a[0]&&h<a[1]&&d<a[2]&&(t[c+3]=0)}}sendUniformData(e,t){const n=new Xe(this.color).getSource(),i=this.distance,s=[0+n[0]/255-i,0+n[1]/255-i,0+n[2]/255-i,1],a=[n[0]/255+i,n[1]/255+i,n[2]/255+i,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,a)}}F(hl,"type","RemoveColor"),F(hl,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),F(hl,"uniformLocations",["uLow","uHigh"]),ie.setClass(hl);class dl extends At{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),i=new Array(n);for(let s=1;s<=n;s++)i[s-1]=e(s*t);return i}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,i)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(i,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(i,`];
              sum += 2.0 * uTaps[`).concat(i,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Qc(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,i=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/i;const s=t.width,a=t.height,c=Math.round(s*n),u=Math.round(a*i);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,a,c,u):this.resizeType==="hermite"?this.hermiteFastResize(e,s,a,c,u):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,a,c,u):this.resizeType==="lanczos"?this.lanczosResize(e,s,a,c,u):new ImageData(c,u),e.imageData=h}sliceByTwo(e,t,n,i,s){const a=e.imageData,c=.5;let u=!1,h=!1,d=t*c,g=n*c;const p=e.filterBackend.resources;let y=0,w=0;const _=t;let S=0;p.sliceByTwo||(p.sliceByTwo=Pr());const T=p.sliceByTwo;(T.width<1.5*t||T.height<n)&&(T.width=1.5*t,T.height=n);const k=T.getContext("2d");for(k.clearRect(0,0,1.5*t,n),k.putImageData(a,0,0),i=Math.floor(i),s=Math.floor(s);!u||!h;)t=d,n=g,i<Math.floor(d*c)?d=Math.floor(d*c):(d=i,u=!0),s<Math.floor(g*c)?g=Math.floor(g*c):(g=s,h=!0),k.drawImage(T,y,w,t,n,_,S,d,g),y=_,w=S,S+=g;return k.getImageData(y,w,i,s)}lanczosResize(e,t,n,i,s){const a=e.imageData.data,c=e.ctx.createImageData(i,s),u=c.data,h=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,g=this.rcpScaleY,p=2/this.rcpScaleX,y=2/this.rcpScaleY,w=Math.ceil(d*this.lanczosLobes/2),_=Math.ceil(g*this.lanczosLobes/2),S={},T={x:0,y:0},k={x:0,y:0};return function I(M){let L,N,H,R,X,U,K,$,G,re,fe;for(T.x=(M+.5)*d,k.x=Math.floor(T.x),L=0;L<s;L++){for(T.y=(L+.5)*g,k.y=Math.floor(T.y),X=0,U=0,K=0,$=0,G=0,N=k.x-w;N<=k.x+w;N++)if(!(N<0||N>=t)){re=Math.floor(1e3*Math.abs(N-T.x)),S[re]||(S[re]={});for(let Q=k.y-_;Q<=k.y+_;Q++)Q<0||Q>=n||(fe=Math.floor(1e3*Math.abs(Q-T.y)),S[re][fe]||(S[re][fe]=h(Math.sqrt(Math.pow(re*p,2)+Math.pow(fe*y,2))/1e3)),H=S[re][fe],H>0&&(R=4*(Q*t+N),X+=H,U+=H*a[R],K+=H*a[R+1],$+=H*a[R+2],G+=H*a[R+3]))}R=4*(L*i+M),u[R]=U/X,u[R+1]=K/X,u[R+2]=$/X,u[R+3]=G/X}return++M<i?I(M):c}(0)}bilinearFiltering(e,t,n,i,s){let a,c,u,h,d,g,p,y,w,_,S,T,k,I=0;const M=this.rcpScaleX,L=this.rcpScaleY,N=4*(t-1),H=e.imageData.data,R=e.ctx.createImageData(i,s),X=R.data;for(p=0;p<s;p++)for(y=0;y<i;y++)for(d=Math.floor(M*y),g=Math.floor(L*p),w=M*y-d,_=L*p-g,k=4*(g*t+d),S=0;S<4;S++)a=H[k+S],c=H[k+4+S],u=H[k+N+S],h=H[k+N+4+S],T=a*(1-w)*(1-_)+c*w*(1-_)+u*_*(1-w)+h*w*_,X[I++]=T;return R}hermiteFastResize(e,t,n,i,s){const a=this.rcpScaleX,c=this.rcpScaleY,u=Math.ceil(a/2),h=Math.ceil(c/2),d=e.imageData.data,g=e.ctx.createImageData(i,s),p=g.data;for(let y=0;y<s;y++)for(let w=0;w<i;w++){const _=4*(w+y*i);let S=0,T=0,k=0,I=0,M=0,L=0,N=0;const H=(y+.5)*c;for(let R=Math.floor(y*c);R<(y+1)*c;R++){const X=Math.abs(H-(R+.5))/h,U=(w+.5)*a,K=X*X;for(let $=Math.floor(w*a);$<(w+1)*a;$++){let G=Math.abs(U-($+.5))/u;const re=Math.sqrt(K+G*G);re>1&&re<-1||(S=2*re*re*re-3*re*re+1,S>0&&(G=4*($+R*t),N+=S*d[G+3],k+=S,d[G+3]<255&&(S=S*d[G+3]/250),I+=S*d[G],M+=S*d[G+1],L+=S*d[G+2],T+=S))}}p[_]=I/T,p[_+1]=M/T,p[_+2]=L/T,p[_+3]=N/k}return g}}F(dl,"type","Resize"),F(dl,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),F(dl,"uniformLocations",["uDelta","uTaps"]),ie.setClass(dl);class fl extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let i=0;i<t.length;i+=4){const s=t[i],a=t[i+1],c=t[i+2],u=Math.max(s,a,c);t[i]+=u!==s?(u-s)*n:0,t[i+1]+=u!==a?(u-a)*n:0,t[i+2]+=u!==c?(u-c)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}F(fl,"type","Saturation"),F(fl,"defaults",{saturation:0}),F(fl,"uniformLocations",["uSaturation"]),ie.setClass(fl);class gl extends At{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let i=0;i<t.length;i+=4){const s=t[i],a=t[i+1],c=t[i+2],u=Math.max(s,a,c),h=(s+a+c)/3,d=2*Math.abs(u-h)/255*n;t[i]+=u!==s?(u-s)*d:0,t[i+1]+=u!==a?(u-a)*d:0,t[i+2]+=u!==c?(u-c)*d:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}F(gl,"type","Vibrance"),F(gl,"defaults",{vibrance:0}),F(gl,"uniformLocations",["uVibrance"]),ie.setClass(gl);class ib{___eventListeners;___activeObjects;constructor(){this.___activeObjects=[],this.___eventListeners={}}pauseEventListeners(){this.___eventListeners=this.__eventListeners,this.__eventListeners={};const e=this.getActiveObjects();this.discardActiveObject(),this.___activeObjects=e}resumeEventListeners(){this.__eventListeners=this.___eventListeners,this.___eventListeners={};const e=this.___activeObjects;if(!e.length)return this.requestRenderAll(),!1;if(e.length===1)this.setActiveObject(e[0]);else{const t=new vn(e);this.setActiveObject(t)}this.requestRenderAll()}}class Xi extends Et{isSelected=!1;text;tScale;display;id;backgroundColor;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default",fontSize:16,fontFamily:"Arial",fontColor:"#ffffff",textAlign:"center"};static type="Text";constructor(e){super(e),Object.assign(this,Xi.ownDefaults),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.text=e.text||"",this.backgroundColor=e.backgroundColor||"transparent"}static createControls(){return{controls:of()}}static getDefaults(){return{...super.getDefaults(),...Xi.ownDefaults}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,6),e.lineWidth=2,e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore())}}function Nn(r,e,t,n,i){r.save(),r.translate(e,t),r.rotate(My.degreesToRadians(90+i.angle)),r.beginPath(),r.lineWidth=4,r.lineCap="round",r.strokeStyle="#dfe2e8",r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}function of(){return{mr:new ut({x:.5,y:0,actionHandler:Jo,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing",render:Nn}),ml:new ut({x:-.5,y:0,actionHandler:Jo,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing",render:Nn})}}const Jo=$t.wrapWithFireEvent("resizing",$t.wrapWithFixedAnchor((r,e,t,n)=>{const i=$t.getLocalPoint(e,e.originX,e.originY,t,n);if(qO(e.originX)||ZO(e.originX)&&i.x<0||KO(e.originX)&&i.x>0){const s=e.target,a=s.strokeWidth/(s.strokeUniform?s.scaleX:1),c=JO(e)?2:1,u=s.width,h=Math.ceil(Math.abs(i.x*c/s.scaleX)-a);if(e.corner==="ml"){const g=u-h;if(s.left+g<0)return s.set("width",s.width+s.left),!0}return s.set("width",Math.max(h,0)),u!==s.width}return!1})),sb={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Pe=r=>typeof r=="string"?sb[r]:r-.5,qO=r=>Pe(r)===Pe("center"),KO=r=>Pe(r)===Pe("left"),ZO=r=>Pe(r)===Pe("right");function JO(r){return Pe(r.originX)===Pe("center")&&Pe(r.originY)===Pe("center")}ie.setClass(Xi,"Text");class Nr extends Et{static type="Transition";id;duration;fromId;toId;static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0, 0, 0, 0.5)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};isSelected=!1;constructor(e){super(e),this.id=e.id,this.fromId=e.fromId,this.toId=e.toId,Object.assign(this,{duration:e.duration,fromId:e.fromId,toId:e.toId,kind:e.kind,tScale:e.tScale,strokeDashArray:e.strokeDashArray||[],isSelected:!1,centeredScaling:!0,strokeWidth:0}),Object.assign(this,Nr.ownDefaults)}static createControls(){return{controls:QO()}}static getDefaults(){return{...super.getDefaults(),...Nr.ownDefaults}}updateCoords(){}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle=this.isSelected?"rgba(255, 255, 255,1.0)":"rgba(255, 255, 255,0.15)",e.stroke(),e.restore()}}ie.setClass(Nr,"Transition");const QO=()=>({mr:new ut({x:.5,y:0,actionHandler:ob,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing",render:Nn}),ml:new ut({x:-.5,y:0,actionHandler:ob,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing",render:Nn})});ie.setClass(Nr,"Transition");const{wrapWithFireEvent:e3,getLocalPoint:t3}=$t,af="center",r3="left",n3="right";function i3(r){return(e,t,n,i)=>{const{target:s,originX:a,originY:c}=t,u=s.getRelativeCenterPoint(),h=s.translateToOriginPoint(u,a,c),d=r(e,t,n,i);return s.setPositionByOrigin(h,a,c),d}}const s3=(r,e,t,n)=>{const i=t3(e,e.originX,e.originY,t,n);if(Pe(e.originX)===Pe(af)||Pe(e.originX)===Pe(n3)&&i.x<0||Pe(e.originX)===Pe(r3)&&i.x>0){const{target:s}=e,a=s.strokeWidth/(s.strokeUniform?s.scaleX:1),c=o3(e)?2:1,u=s.width,h=Math.ceil(Math.abs(i.x*c/s.scaleX)-a),d=Zn(h,s.tScale);return d>=1500||d<500?!1:(s.set("width",Math.max(h,0)),s.set("duration",d),s.setCoords(),s.canvas&&s.canvas.renderAll(),u!==s.width)}return!1};function o3(r){return Pe(r.originX)===Pe(af)&&Pe(r.originY)===Pe(af)}const ob=e3("resizing",i3(s3));class Ys extends Et{static type="Placeholder";guideItemId;distXToActCenter;trackItemType;defaultPos;draggedObject=null;for;id;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",strokeWidth:0,fill:"rgba(255, 211, 42, 0.1)",stroke:"rgba(255, 211, 42, 1.0)",selectable:!1,borderOpacityWhenMoving:1,hoverCursor:"default",strokeDashArray:[5,1],evented:!1};constructor(e){super(e),this.id=e.id,this.for=e.for,Object.assign(this,Ys.ownDefaults)}static getDefaults(){return{...super.getDefaults(),...Ys.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore()}}ie.setClass(Ys,"Placeholder");const a3={top:{top:35,guideHeight:2,bottom:3},center:{top:3,guideHeight:2,bottom:3},bottom:{top:3,guideHeight:2,bottom:35}},Qo="rgba(0, 216, 214, 1.0)",cf=(r,e,t)=>new Et({top:r,left:0,strokeWidth:0,fill:"transparent",selectable:!0,height:t,width:e});class ea extends jr{static type="Helper";static defaultSettings={selectable:!1,evented:!1};static ownDefaults={...ea.defaultSettings};guide;topGuide;bottomGuide;id;metadata={};tScale;kind;constructor(e){const t=a3[e.kind],n=cf(0,e.width,t.top),i=cf(t.top,e.width,t.guideHeight),s=cf(t.top+t.guideHeight,e.width,t.bottom);super([n,i,s],{...ea.defaultSettings,...e}),this.topGuide=n,this.guide=i,this.bottomGuide=s,this.id=e.id,this.metadata=e.metadata??{},this.tScale=e.tScale,this.kind=e.kind}static getDefaults(){return{...super.getDefaults(),...ea.defaultSettings}}updateCoords(e){this.scaleToWidth(e),this.set("scaleY",1)}setSelected(e){this.guide.set("fill",e?Qo:"transparent")}}const Xs=ea;ie.setClass(Xs,"Helper");class hi extends Et{static ownDefaults={selectable:!1,evented:!1,strokeWidth:0,stroke:"transparent"};static type="Track";id;accepts;metadata;items;borderColor="transparent";stroke="transparent";strokeWidth=0;constructor(e){super(e),Object.assign(this,hi.ownDefaults),this.id=e.id,this.accepts=e.accepts||["audio","video","image","text"],this.items=e.items||[],this.metadata=e.metadata}static getDefaults(){return{...super.getDefaults(),...hi.ownDefaults}}updateCoords(e){this.width=e}}ie.setClass(hi,"Track");class pl extends Et{isSelected;tScale;display;id;src;itemType;static ownDefaults={rx:8,ry:8,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",fill:"#27272a"};static type="Image";constructor(e){super(e),this.itemType="image",this.isSelected=!1,Object.assign(this,pl.ownDefaults),this.id=e.id,this.src=e.src,this.display=e.display,this.tScale=e.tScale}static createControls(){return{controls:of()}}static getDefaults(){return{...super.getDefaults(),...pl.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=Qo,e.stroke(),e.restore())}}const ml=pl;ie.setClass(ml,"Image");class Gi extends Et{id;tScale;isSelected=!1;display;trim;static type="Video";static defaultProps={objectCaching:!1,rx:8,ry:8,fill:"#27272a"};constructor(e){super(Object.assign({},Gi.defaultProps,e)),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim}static createControls(){return{controls:ab()}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=Qo,e.stroke(),e.restore())}}ie.setClass(Gi,"Video");const ab=()=>({mr:new ut({x:.5,y:0,render:Nn,actionHandler:cb,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new ut({x:-.5,y:0,render:Nn,actionHandler:cb,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:c3,getLocalPoint:l3}=$t,u3=(r,e,t,n)=>{const i=l3(e,e.originX,e.originY,t,n);if(Pe(e.originX)===Pe("center")||Pe(e.originX)===Pe("right")&&i.x<0||Pe(e.originX)===Pe("left")&&i.x>0){const{target:s}=e;return s.width!==s.width}return!1};function lf(r){return(e,t,n,i)=>{const{target:s,originX:a,originY:c}=t,u=s.getRelativeCenterPoint(),h=s.translateToOriginPoint(u,a,c),d=r(e,t,n,i);return s.setPositionByOrigin(h,a,c),d}}const cb=c3("resizing",lf(u3));class Rn extends Et{id;itemType="audio";isSelected=!1;trim;src;tScale;display;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default"};static type="Audio";constructor(e){super({...Rn.getDefaults(),...e}),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim,this.src=e.src}static getDefaults(){return{...super.getDefaults(),...Rn.ownDefaults}}static createControls(){return{controls:lb()}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,Rn.ownDefaults.rx),e.lineWidth=2,e.strokeStyle=Qo,e.stroke(),e.restore())}}ie.setClass(Rn,"Audio");const lb=()=>({mr:new ut({x:.5,y:0,render:Nn,actionHandler:ub,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new ut({x:-.5,y:0,render:Nn,actionHandler:ub,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:h3,getLocalPoint:d3}=$t,f3=(r,e,t,n)=>{const i=d3(e,e.originX,e.originY,t,n);if(Pe(e.originX)===Pe("center")||Pe(e.originX)===Pe("right")&&i.x<0||Pe(e.originX)===Pe("left")&&i.x>0){const{target:s}=e,a=s.strokeWidth/(s.strokeUniform?s.scaleX:1),c=g3(e)?2:1,u=s.width,h=Math.ceil(Math.abs(i.x*c/s.scaleX)-a);if(e.corner==="mr"){const d=s.trim.to,g=h-u,p=Zn(g,s.tScale),y=d+p;if(y>s.duration)return!1;s.set("width",Math.max(h,0)),s.trim.to=y}else{if(s.left<0)return!1;const d=u-h;if(s.left+d<0)return s.set("width",s.width+s.left),!0;const g=h-u,p=s.trim.from,y=Zn(g,s.tScale),w=p-y;if(w<0)return!1;s.set("width",Math.max(h,0)),s.trim.from=w}return u!==s.width}return!1};function g3(r){return Pe(r.originX)===Pe("center")&&Pe(r.originY)===Pe("center")}const ub=h3("resizing",lf(f3));class ta extends Et{static type="TransitionGuide";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0,0,0,0.85)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};tScale;duration=0;fromId;toId;itemType="none";isSelected=!1;id;constructor(e){super(e),Object.assign(this,ta.ownDefaults),this.id=e.id}static createControls(){return{controls:hb()}}static getDefaults(){return{...super.getDefaults(),...ta.ownDefaults}}updateCoords(){const e=this.canvas;if(!e)return;const t=e.getObjects().find(s=>s.id===this.fromId);if(!t)return;const n=bt(this.duration,this.tScale),i=t.left+t.width-n/2;this.set({width:n,left:i})}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M3 5.30359C3 3.93159 4.659 3.24359 5.629 4.21359L11.997 10.5826L10.583 11.9966L5 6.41359V17.5856L10.586 11.9996L10.583 11.9966L11.997 10.5826L12 10.5856L18.371 4.21459C19.341 3.24459 21 3.93159 21 5.30359V18.6956C21 20.0676 19.341 20.7556 18.371 19.7856L12 13.5L13.414 11.9996L19 17.5866V6.41359L13.414 11.9996L13.421 12.0056L12.006 13.4206L12 13.4136L5.629 19.7846C4.659 20.7546 3 20.0676 3 18.6956V5.30359Z");e.save(),e.translate(-12,-12),e.fillStyle="#ffffff",e.fill(t),e.restore()}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=1,e.strokeStyle="rgba(255, 255, 255,1.0)",e.stroke(),e.restore())}}function hb(){return{mr:new ut({x:.5,y:0,actionHandler:Jo,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing",render:db}),ml:new ut({x:-.5,y:0,actionHandler:Jo,cursorStyleHandler:$t.scaleSkewCursorStyleHandler,actionName:"resizing",render:db})}}function db(r,e,t,n,i){r.save(),r.translate(e,t),r.rotate(My.degreesToRadians(90+i.angle)),r.lineWidth=6,r.lineCap="round",r.strokeStyle="white",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.lineWidth=4,r.strokeStyle="black",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}class ra extends Et{static type="PreviewTrackItem";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",rx:4,ry:4};duration=0;fromId="";toId="";isSelected=!1;name;durationString;id;constructor(e){super(e),Object.assign(this,ra.ownDefaults),this.id=e.id,this.name=e.name||"item",this.durationString="00:05",this.fill="#27272a"}static getDefaults(){return{...super.getDefaults(),...ra.ownDefaults}}_render(e){e.save(),super._render(e),e.beginPath(),e.rect(-this.width/2,-this.height/2,this.width,this.height),e.clip(),this.drawTextIdentity(e),e.restore()}drawTextIdentity(e){e.font="600 12px 'Geist variable'",e.textAlign="left";const u=e.measureText(this.name).width,h=e.measureText(this.durationString).width,d=-this.height/2+4,g=-this.width/2,p=g+u+8*2+4,y=u+8*2;this.drawRoundedRect(e,g,d,y,20,4),e.fillStyle="#f4f4f5",e.fillText(this.name,g+8,d+12+2);const w=h+8*2;this.drawRoundedRect(e,p,d,w,20,4),e.fillStyle="#f4f4f5",e.fillText(this.durationString,p+8,d+12+2)}drawRoundedRect(e,t,n,i,s,a){e.fillStyle="rgba(0, 0, 0, 0.5)",e.roundRect?(e.beginPath(),e.roundRect(t,n,i,s,a),e.fill()):e.fillRect(t,n,i,s)}}function fb(r,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{if(n!=="constructor"){const i=Object.getOwnPropertyDescriptor(t.prototype,n);i&&Object.defineProperty(r.prototype,n,i)}})})}const vl=(r,e)=>{const t={x:r.size.width/2,y:r.size.height/2},n={x:e.width/2,y:e.height/2},i=t.x-n.x,s=t.y-n.y,a=Math.min(r.size.width/e.width,r.size.height/e.height);return{top:`${s}px`,left:`${i}px`,transform:`scale(${a})`}},gb=r=>new Promise((e,t)=>{const n=new Audio;n.preload="auto",n.addEventListener("loadedmetadata",()=>{const i=n.duration*1e3;e({duration:i})}),n.addEventListener("error",i=>{t(i)}),n.src=r,n.crossOrigin="anonymous",n.load()}),pb=r=>new Promise((e,t)=>{const n=new Image;console.warn("Consider updating CDN config for CORS issues?"),n.onload=()=>{const i=n.width,s=n.height;e({width:i,height:s})},n.onerror=i=>{t(i)},n.crossOrigin="anonymous",n.src=r}),mb=r=>new Promise((e,t)=>{const n=document.createElement("video");n.preload="auto",n.addEventListener("loadedmetadata",()=>{const i=n.duration*1e3,s=n.videoWidth,a=n.videoHeight;e({duration:i,width:s,height:a})}),n.addEventListener("error",i=>{t(i)}),n.src=r,n.load()}),na=(r,e)=>{const t=document.createElement("div");Object.keys(e).forEach(i=>{i!=="height"&&(t.style[i]=e[i])}),document.body.appendChild(t),t.textContent=r,t.style.width=`${e.width}px`,t.style.fontSize=`${e.fontSize}px`;const n=getComputedStyle(t).height;return document.body.removeChild(t),parseFloat(n)},tn=r=>Object.keys(r).reduce((e,t)=>{const{display:{to:n}}=r[t];return Math.max(e,n)},0),vb=(r,e)=>{if(!r)return{from:0,to:e.duration};const{from:t,to:n}=r;return{from:t??0,to:n??e.duration}},yb=(r,e)=>{const{duration:t,trim:n}=e,i=n?n.to-n.from:t||5e3,s={from:0,to:i};if(!r)return s;if(r.from!==void 0&&r.from<0)return console.error("'from' must be a non-negative number. Returning default display."),s;if(r.from!==void 0&&r.to===void 0)return{from:r.from,to:r.from+i};if(r.to!==void 0){if(r.to<0)return console.error("'to' must be a non-negative number. Returning default display."),s;if(r.to<r.from)return console.error("'to' must be greater than or equal to 'from'. Returning default display."),s}return r};function bb(r,e){return r.map(t=>{const n=t.items.filter(i=>!e.includes(i));return{...t,items:n}}).filter(t=>t.items.length>0)}const wb=async(r,e)=>{const t=r.details,n=await pb(t.src),i=vl(e,n);return{id:r.id,type:"image",name:"",display:{from:e.origin||0,to:(e.origin||5e3)+5e3},details:{src:t.src||"",width:t.width||n.width||100,height:t.height||n.height||100,opacity:t.opacity??100,transform:i.transform,border:t.border||"none",borderRadius:t.borderRadius||"0",boxShadow:t.boxShadow||"none",top:i.top||"0px",left:i.left||"0px"},metadata:r.metadata||{}}},xb=async(r,e)=>{const t=r.details.src,n=await mb(t),i=vl(e,{...n}),s=vb(r.trim,{duration:n.duration}),a={width:n.width,height:n.height,duration:n.duration,src:t,volume:r.details.volume??100,top:r.details.top||i.top||"0px",left:r.details.left||i.left||"0px",text:r.details.text};return{...r,trim:s,type:"video",details:a,display:yb(r?.display,{duration:n.duration,trim:s})}},_b=async r=>{const e=r.details,t=(await gb(e.src)).duration,n=r?.display?.from??0;return{id:r.id,name:"",type:"audio",display:{from:n,to:n+t},trim:{from:0,to:t},details:{src:e.src,duration:t,volume:e.volume??100,text:e.text},metadata:{...r.metadata}}},p3=5e3,uf=async(r,e)=>{const t=r.id;await Ym([{fontFamily:r.details.fontFamily??"",fontUrl:r.details.fontUrl??""}]);const n={fontFamily:r.details.fontFamily??"Arial",fontSize:r.details.fontSize??"16px",fontWeight:r.details.fontWeight??"normal",fontStyle:r.details.fontStyle??"normal",textDecoration:r.details.textDecoration??"none",textAlign:r.details.textAlign??"left",lineHeight:r.details.lineHeight??"normal",letterSpacing:r.details.letterSpacing??"normal",wordSpacing:r.details.wordSpacing??"normal",color:r.details.color??"#ffffff",backgroundColor:r.details.backgroundColor??"transparent",border:r.details.border??"none",textShadow:r.details.textShadow??"none",text:r.details.text??"",opacity:r.details.opacity??100,width:r.details.width??300,wordWrap:r.details.wordWrap??"normal",wordBreak:r.details.wordBreak??"normal",WebkitTextStrokeColor:r.details.WebkitTextStrokeColor??"#ffffff",WebkitTextStrokeWidth:r.details.WebkitTextStrokeWidth??"0px",top:r.details.top??"0px",left:r.details.left??"0px"},i=na(r.details.text??"",n),s=vl(e,{width:n.width??0,height:i});return{id:t,name:"",type:"text",display:{from:0,to:p3},details:{...n,height:i,top:s.top,left:s.left,fontUrl:r.details.fontUrl,text:r.details.text??""},metadata:{}}},Sb=(r,e)=>{const t=r.display,n=bt(t.from,e.tScale),i=bt(t.to-t.from,e.tScale),s=ie.getClass("Audio")||Rn;return new s({width:i,height:42,top:10,left:n,id:r.id,display:t,text:r.details.text,trim:r.trim||{from:0,to:r.details.duration},duration:r.details.duration,src:r.details.src,tScale:e.tScale})},Cb=(r,e)=>{const t=bt(r.display.from,e.tScale),n=bt(r.details.duration||5e3,e.tScale),i=ie.getClass("Image")||ml;return new i({width:n,height:42,id:r.id,src:r.details.src,tScale:e.tScale,top:10,left:t,display:r.display})},Tb=(r,e)=>{const t=bt(r.trim.from,e.tScale),n=bt(r.trim.to-r.trim.from,e.tScale),i=ie.getClass("Video")||Gi;return new i({width:n,height:42,id:r.id,tScale:e.tScale,fill:"#333333",top:10,left:t,display:r.trim,trim:r.trim,text:r.details.text})},Eb=(r,e)=>{const t=r.display,n=bt(t.from,e.tScale),i=bt(t.to-t.from,e.tScale),s=ie.getClass("Text")||Xi;return new s({width:i,height:42,id:r.id,display:t,top:10,left:n,text:r.details.text,tScale:e.tScale})},kb={video:42,image:42,audio:42,text:42,caption:42,template:42},Ib=(r={})=>{const e={...kb,...r};return Object.fromEntries(Object.entries(e).filter(([,t])=>typeof t=="number"))};let Ab=class extends Rn{static type="Audio";text;constructor(e){super(e),this.text=e.text??"Audio"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M8.24092 0C8.24092 2.51565 10.2795 4.55419 12.7951 4.55419C12.9677 4.55419 13.1331 4.62274 13.2552 4.74475C13.3772 4.86676 13.4457 5.03224 13.4457 5.20479C13.4457 5.37734 13.3772 5.54282 13.2552 5.66483C13.1331 5.78685 12.9677 5.85539 12.7951 5.85539C11.9218 5.85605 11.0594 5.66105 10.2713 5.28471C9.48319 4.90838 8.78942 4.36027 8.24092 3.68066V13.8794C8.24094 14.8271 7.91431 15.7458 7.31606 16.4808C6.71781 17.2157 5.88451 17.722 4.95657 17.9143C4.02863 18.1066 3.06276 17.9731 2.22172 17.5364C1.38067 17.0997 0.715856 16.3865 0.339286 15.5169C-0.0372842 14.6473 -0.10259 13.6744 0.154372 12.7622C0.411334 11.8501 0.974857 11.0544 1.74999 10.5092C2.52512 9.96403 3.46449 9.7027 4.40981 9.76924C5.35512 9.83579 6.24861 10.2261 6.93972 10.8745V0H8.24092ZM6.93972 13.8794C6.93972 13.1317 6.6427 12.4146 6.11398 11.8859C5.58527 11.3572 4.86818 11.0602 4.12046 11.0602C3.37275 11.0602 2.65566 11.3572 2.12694 11.8859C1.59823 12.4146 1.3012 13.1317 1.3012 13.8794C1.3012 14.6272 1.59823 15.3443 2.12694 15.873C2.65566 16.4017 3.37275 16.6987 4.12046 16.6987C4.86818 16.6987 5.58527 16.4017 6.11398 15.873C6.6427 15.3443 6.93972 14.6272 6.93972 13.8794Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,10),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,14),e.translate(10,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class Mb extends Gi{static type="Video";text;constructor(e){super(e),this.text=e.text??"Video"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M16.5625 0.925L12.5 3.275V0.625L11.875 0H0.625L0 0.625V9.375L0.625 10H11.875L12.5 9.375V6.875L16.5625 9.2125L17.5 8.625V1.475L16.5625 0.925ZM11.25 8.75H1.25V1.25H11.25V8.75ZM16.25 7.5L12.5 5.375V4.725L16.25 2.5V7.5Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,14),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,10),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}class hf extends Xi{static type="Text";constructor(e){super(e),this.fill="#303030"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M6.23982 0.361968C6.18894 0.253743 6.10832 0.162234 6.00736 0.0981357C5.9064 0.034038 5.78929 0 5.6697 0C5.55012 0 5.433 0.034038 5.33204 0.0981357C5.23109 0.162234 5.15046 0.253743 5.09959 0.361968L0.0599035 11.0713C0.0246926 11.1462 0.00457285 11.2272 0.000693114 11.3099C-0.00318662 11.3925 0.00924959 11.4751 0.0372917 11.553C0.0939253 11.7102 0.210687 11.8384 0.361891 11.9095C0.513095 11.9806 0.686354 11.9888 0.843555 11.9322C1.00076 11.8755 1.12902 11.7588 1.20013 11.6075L2.51202 8.81998H8.82738L10.1393 11.6075C10.1745 11.6824 10.2241 11.7496 10.2853 11.8053C10.3465 11.861 10.418 11.9041 10.4958 11.9322C10.5737 11.9602 10.6563 11.9726 10.7389 11.9687C10.8216 11.9649 10.9026 11.9447 10.9775 11.9095C11.0524 11.8743 11.1196 11.8247 11.1753 11.7635C11.231 11.7023 11.2741 11.6308 11.3021 11.553C11.3302 11.4751 11.3426 11.3925 11.3387 11.3099C11.3348 11.2272 11.3147 11.1462 11.2795 11.0713L6.23982 0.361968ZM3.10498 7.56005L5.6697 2.11011L8.23443 7.56005H3.10498ZM15.1191 3.78029C14.1143 3.78029 13.3292 4.05354 12.7859 4.59294C12.6721 4.71153 12.6092 4.86987 12.6106 5.03419C12.6119 5.19851 12.6774 5.3558 12.7931 5.4725C12.9088 5.58921 13.0655 5.6561 13.2298 5.6589C13.3941 5.6617 13.553 5.60018 13.6726 5.48748C13.9718 5.19062 14.46 5.04021 15.1191 5.04021C16.1609 5.04021 17.009 5.74892 17.009 6.61511V6.86867C16.45 6.49465 15.7917 6.29663 15.1191 6.30013C13.382 6.30013 11.9693 7.57187 11.9693 9.13495C11.9693 10.698 13.382 11.9698 15.1191 11.9698C15.792 11.9727 16.4503 11.7739 17.009 11.3989C17.0168 11.566 17.0907 11.7231 17.2144 11.8357C17.3381 11.9483 17.5014 12.0071 17.6685 11.9993C17.8356 11.9915 17.9927 11.9176 18.1053 11.7939C18.2179 11.6702 18.2767 11.5069 18.2689 11.3398V6.61511C18.2689 5.05202 16.8562 3.78029 15.1191 3.78029ZM15.1191 10.7099C14.0773 10.7099 13.2292 10.0012 13.2292 9.13495C13.2292 8.26876 14.0773 7.56005 15.1191 7.56005C16.1609 7.56005 17.009 8.26876 17.009 9.13495C17.009 10.0012 16.1609 10.7099 15.1191 10.7099Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}let Ob=class extends ml{static type="Image";text;constructor(e){super(e),this.text=e.text??"Image"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M1.55556 0H14.4444C15.3031 0 16 0.696889 16 1.55556V14.4444C16 14.857 15.8361 15.2527 15.5444 15.5444C15.2527 15.8361 14.857 16 14.4444 16H1.55556C1.143 16 0.747335 15.8361 0.455612 15.5444C0.163889 15.2527 0 14.857 0 14.4444V1.55556C0 0.696889 0.696889 0 1.55556 0ZM14.4444 1.33333H1.55556C1.49662 1.33333 1.4401 1.35675 1.39842 1.39842C1.35675 1.4401 1.33333 1.49662 1.33333 1.55556V14.4444C1.33333 14.5671 1.43289 14.6667 1.55556 14.6667H1.72444L10.456 5.93511C10.6004 5.79065 10.7719 5.67605 10.9607 5.59787C11.1494 5.51968 11.3517 5.47944 11.556 5.47944C11.7603 5.47944 11.9626 5.51968 12.1513 5.59787C12.3401 5.67605 12.5116 5.79065 12.656 5.93511L14.6667 7.94578V1.55556C14.6667 1.49662 14.6433 1.4401 14.6016 1.39842C14.5599 1.35675 14.5034 1.33333 14.4444 1.33333ZM14.6667 9.83111L11.7129 6.87733C11.6922 6.85664 11.6677 6.84022 11.6407 6.82902C11.6137 6.81781 11.5848 6.81205 11.5556 6.81205C11.5263 6.81205 11.4974 6.81781 11.4704 6.82902C11.4434 6.84022 11.4189 6.85664 11.3982 6.87733L3.60978 14.6667H14.4444C14.5034 14.6667 14.5599 14.6433 14.6016 14.6016C14.6433 14.5599 14.6667 14.5034 14.6667 14.4444V9.83111ZM4.88889 7.11111C4.29952 7.11111 3.73429 6.87699 3.31754 6.46024C2.90079 6.04349 2.66667 5.47826 2.66667 4.88889C2.66667 4.29952 2.90079 3.73429 3.31754 3.31754C3.73429 2.90079 4.29952 2.66667 4.88889 2.66667C5.47826 2.66667 6.04349 2.90079 6.46024 3.31754C6.87699 3.73429 7.11111 4.29952 7.11111 4.88889C7.11111 5.47826 6.87699 6.04349 6.46024 6.46024C6.04349 6.87699 5.47826 7.11111 4.88889 7.11111ZM4.88889 5.77778C5.12464 5.77778 5.35073 5.68413 5.51743 5.51743C5.68413 5.35073 5.77778 5.12464 5.77778 4.88889C5.77778 4.65314 5.68413 4.42705 5.51743 4.26035C5.35073 4.09365 5.12464 4 4.88889 4C4.65314 4 4.42705 4.09365 4.26035 4.26035C4.09365 4.42705 4 4.65314 4 4.88889C4 5.12464 4.09365 5.35073 4.26035 5.51743C4.42705 5.68413 4.65314 5.77778 4.88889 5.77778Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class Pb extends hi{static type="Track";constructor(e){super(e),this.fill="#18181b"}_render(e){super._render(e);const t=new Path2D("M14.4444 13.3263H11.0667C12.5384 12.3991 13.6259 10.9716 14.1289 9.30644C14.632 7.64131 14.5169 5.85051 13.8048 4.26348C13.0927 2.67645 11.8314 1.39993 10.2531 0.668736C8.67478 -0.0624548 6.8855 -0.199136 5.21442 0.283835C3.54334 0.766806 2.10285 1.83695 1.15794 3.2974C0.213035 4.75785 -0.172743 6.51038 0.0715766 8.23261C0.315896 9.95484 1.17388 11.5309 2.4877 12.671C3.80151 13.811 5.4828 14.4383 7.22227 14.4374H14.4444C14.5918 14.4374 14.7331 14.3789 14.8373 14.2747C14.9415 14.1705 15 14.0292 15 13.8819C15 13.7345 14.9415 13.5932 14.8373 13.489C14.7331 13.3848 14.5918 13.3263 14.4444 13.3263ZM1.1112 7.21523C1.1112 6.00658 1.46961 4.82506 2.14111 3.8201C2.8126 2.81514 3.76702 2.03187 4.88367 1.56934C6.00032 1.10681 7.22905 0.985789 8.41449 1.22159C9.59992 1.45738 10.6888 2.03941 11.5435 2.89405C12.3981 3.7487 12.9801 4.83759 13.2159 6.02302C13.4517 7.20845 13.3307 8.43719 12.8682 9.55384C12.4056 10.6705 11.6224 11.6249 10.6174 12.2964C9.61244 12.9679 8.43093 13.3263 7.22227 13.3263C5.60208 13.3245 4.04878 12.68 2.90313 11.5344C1.75748 10.3887 1.11304 8.83542 1.1112 7.21523ZM7.22227 5.54858C7.55191 5.54858 7.87414 5.45083 8.14822 5.2677C8.4223 5.08456 8.63592 4.82426 8.76206 4.51972C8.88821 4.21518 8.92121 3.88007 8.85691 3.55677C8.7926 3.23347 8.63386 2.9365 8.40078 2.70342C8.16769 2.47033 7.87072 2.3116 7.54742 2.24729C7.22412 2.18298 6.88901 2.21599 6.58447 2.34213C6.27993 2.46828 6.01964 2.6819 5.8365 2.95598C5.65337 3.23006 5.55562 3.55229 5.55562 3.88192C5.55562 4.32395 5.73121 4.74787 6.04377 5.06043C6.35633 5.37298 6.78025 5.54858 7.22227 5.54858ZM7.22227 3.32637C7.33215 3.32637 7.43956 3.35895 7.53092 3.42C7.62228 3.48104 7.69349 3.56781 7.73554 3.66932C7.77759 3.77084 7.78859 3.88254 7.76715 3.9903C7.74572 4.09807 7.6928 4.19706 7.61511 4.27476C7.53741 4.35245 7.43842 4.40536 7.33066 4.4268C7.22289 4.44824 7.11119 4.43723 7.00967 4.39519C6.90816 4.35314 6.82139 4.28193 6.76035 4.19057C6.69931 4.09921 6.66672 3.9918 6.66672 3.88192C6.66672 3.73458 6.72525 3.59327 6.82944 3.48909C6.93363 3.3849 7.07493 3.32637 7.22227 3.32637ZM8.88893 10.5485C8.88893 10.2189 8.79118 9.89668 8.60805 9.6226C8.42491 9.34852 8.16462 9.1349 7.86008 9.00875C7.55553 8.88261 7.22043 8.8496 6.89713 8.91391C6.57383 8.97822 6.27686 9.13695 6.04377 9.37004C5.81069 9.60313 5.65195 9.9001 5.58764 10.2234C5.52334 10.5467 5.55634 10.8818 5.68249 11.1863C5.80863 11.4909 6.02225 11.7512 6.29633 11.9343C6.57041 12.1175 6.89264 12.2152 7.22227 12.2152C7.6643 12.2152 8.08822 12.0396 8.40078 11.727C8.71334 11.4145 8.88893 10.9906 8.88893 10.5485ZM6.66672 10.5485C6.66672 10.4387 6.69931 10.3313 6.76035 10.2399C6.82139 10.1485 6.90816 10.0773 7.00967 10.0353C7.11119 9.99323 7.22289 9.98223 7.33066 10.0037C7.43842 10.0251 7.53741 10.078 7.61511 10.1557C7.6928 10.2334 7.74572 10.3324 7.76715 10.4402C7.78859 10.5479 7.77759 10.6596 7.73554 10.7611C7.69349 10.8627 7.62228 10.9494 7.53092 11.0105C7.43956 11.0715 7.33215 11.1041 7.22227 11.1041C7.07493 11.1041 6.93363 11.0456 6.82944 10.9414C6.72525 10.8372 6.66672 10.6959 6.66672 10.5485ZM10.5556 8.88189C10.8852 8.88189 11.2074 8.78414 11.4815 8.60101C11.7556 8.41787 11.9692 8.15758 12.0954 7.85303C12.2215 7.54849 12.2545 7.21338 12.1902 6.89008C12.1259 6.56678 11.9672 6.26982 11.7341 6.03673C11.501 5.80364 11.204 5.64491 10.8807 5.5806C10.5574 5.51629 10.2223 5.5493 9.91778 5.67544C9.61324 5.80159 9.35295 6.01521 9.16981 6.28929C8.98668 6.56337 8.88893 6.8856 8.88893 7.21523C8.88893 7.65726 9.06452 8.08118 9.37708 8.39374C9.68964 8.70629 10.1136 8.88189 10.5556 8.88189ZM10.5556 6.65968C10.6655 6.65968 10.7729 6.69226 10.8642 6.75331C10.9556 6.81435 11.0268 6.90112 11.0688 7.00263C11.1109 7.10415 11.1219 7.21585 11.1005 7.32362C11.079 7.43138 11.0261 7.53037 10.9484 7.60807C10.8707 7.68576 10.7717 7.73867 10.664 7.76011C10.5562 7.78155 10.4445 7.77054 10.343 7.7285C10.2415 7.68645 10.1547 7.61524 10.0937 7.52388C10.0326 7.43252 10 7.32511 10 7.21523C10 7.06789 10.0586 6.92658 10.1628 6.8224C10.2669 6.71821 10.4082 6.65968 10.5556 6.65968ZM3.88896 5.54858C3.55933 5.54858 3.2371 5.64633 2.96302 5.82946C2.68894 6.01259 2.47532 6.27289 2.34918 6.57743C2.22303 6.88197 2.19002 7.21708 2.25433 7.54038C2.31864 7.86368 2.47737 8.16065 2.71046 8.39374C2.94355 8.62682 3.24052 8.78556 3.56382 8.84986C3.88711 8.91417 4.22222 8.88117 4.52677 8.75502C4.83131 8.62888 5.0916 8.41526 5.27474 8.14118C5.45787 7.8671 5.55562 7.54487 5.55562 7.21523C5.55562 6.77321 5.38003 6.34929 5.06747 6.03673C4.75491 5.72417 4.33099 5.54858 3.88896 5.54858ZM3.88896 7.77078C3.77909 7.77078 3.67168 7.7382 3.58032 7.67716C3.48896 7.61611 3.41775 7.52935 3.3757 7.42783C3.33365 7.32632 3.32265 7.21462 3.34409 7.10685C3.36552 6.99908 3.41843 6.90009 3.49613 6.8224C3.57382 6.7447 3.67281 6.69179 3.78058 6.67036C3.88835 6.64892 4.00005 6.65992 4.10156 6.70197C4.20308 6.74402 4.28984 6.81522 4.35089 6.90658C4.41193 6.99794 4.44452 7.10535 4.44452 7.21523C4.44452 7.36257 4.38598 7.50388 4.2818 7.60807C4.17761 7.71225 4.03631 7.77078 3.88896 7.77078Z");this.items.length||(e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#A0A4A2",e.textAlign="left",e.clip(),e.fillText("Drag and drop media here",32,12),e.translate(8,1),e.fillStyle="#A0A4A2",e.fill(t),e.restore())}}class Db extends Xs{static type="Helper";constructor(e){e.activeGuideFill="#ffffff",super(e)}}class jb{addTrackItem(e){const t=e.id,n=df(e,{tScale:this.tScale,sizesMap:this.sizesMap});this.add(n),this.trackItemIds.push(t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=tn(this.trackItemsMap)}alignItemsToTrack(){this.pauseEventListeners();const e=new Map(this.getObjects("Track").map(n=>[n.id,n])),t=this.getObjects("Image","Video","Text","Audio");this.trackItemIds.forEach(n=>{const i=this.tracks.find(c=>c.items.includes(n));if(!i)return;const s=e.get(i.id);this.duration;const a=this.getObjects().find(c=>c.id===n);a&&s&&(a.isMain=!1,this.trackItemsMap[n].isMain=!1,a.set({top:s.top}),a.setCoords())}),e.forEach(n=>{n.items=t.filter(i=>i.top===n.top).map(i=>i.id)}),this.resumeEventListeners()}updateTrackItemsPosition(){const e=this.getObjects("Image","Text","Video","Audio");e.sort((t,n)=>t.top-n.top),this.trackItemIds=e.map(t=>t.id).reverse()}restoreTrackItemPositions(){}updateTrackItemsState(){this.pauseEventListeners();const e=this.getObjects("Image","Video","Text","Audio"),t={};e.forEach(n=>{const{id:i,left:s,width:a}=n,c=this.trackItemsMap[i],u=Zn(s,this.tScale),h=u+Zn(a,this.tScale),d={from:u,to:h},g={...c,display:d,trim:n instanceof Gi||n instanceof Rn?n.trim:void 0};n.display=d,t[i]=g}),this.trackItemsMap=t,this.resumeEventListeners()}deleteActiveTrackItem(){const e=this.getActiveObjects();if(!e.length)return!1;const t=e.map(i=>i.id),n=So(this.tracks,t);this.trackItemsMap=Object.keys(this.trackItemsMap).reduce((i,s)=>(t.includes(s)||(i[s]=this.trackItemsMap[s]),i),{}),this.trackItemIds=this.trackItemIds.filter(i=>!t.includes(i)),this.tracks=n,this.discardActiveObject(),this.remove(...e),this.setActiveIds([]),this.renderTracks(),this.alignItemsToTrack(),this.updateState({updateHistory:!0,kind:"remove"})}updateTrackItemsToHistory(){this.pauseEventListeners();const e=this.getObjects();this.trackItemIds.forEach(t=>{const n=this.tracks.find(h=>h.items.includes(t)),i=e.find(h=>h.id===n?.id)?.top;if(!i){console.warn(`Track top not found for trackItemId: ${t}`);return}const s=this.trackItemsMap[t],a=e.find(h=>h.id===t);if(!a){console.warn(`Object not found for trackItemId: ${t}`);return}const c=bt(s.display.from,this.tScale),u=bt(s.display.to-s.display.from,this.tScale);a.set({left:c,width:u,top:i}),a.setCoords()}),this.requestRenderAll(),this.resumeEventListeners()}cloneActiveTrackItem(e){const t=e?.trackItemId||this.activeIds[0];if(!t)return!1;const i={...this.trackItemsMap[t],id:kt()},s=this.tracks.find(d=>d.items.includes(t)),a=this.tracks.findIndex(d=>d.id===s?.id)+1;this.findOrCreateTrack(i,{trackIndex:a});const c=df(i,{tScale:this.tScale});c&&this.add(c);const{audioData:u,...h}=i.metadata||{};i.metadata=h,this.trackItemsMap[i.id]=i,this.trackItemIds.push(i.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}splitActiveTrackItem(e){const t=e.trackItemId??this.activeIds[0];if(!t||this.activeIds.length>1)return!1;const n=this.trackItemsMap[t],i=e.time;if(n.display.from>=i||n.display.to<=i)return!1;const s={...n,display:{from:n.display.from,to:i}},a={...n,display:{from:i,to:n.display.to},id:kt()};if(n.type==="video"||n.type==="audio"){const d=i-s.display.from;s.trim={from:n.trim.from,to:n.trim.from+d},a.trim={from:s.trim.to,to:n.trim.to}}const c=this.getObjects().find(d=>d.id===t);c.display=s.display,this.tracks.find(d=>d.items.includes(t))?.items.push(a.id);const h=df(a,{tScale:this.tScale});h&&this.add(h),this.trackItemsMap[a.id]=a,this.trackItemsMap[t]=s,this.trackItemIds.push(a.id),this.updateTrackItemCoords(s.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}updateTrackItemCoords(e){const t=this.getObjects().find(a=>a.id===e),n=this.trackItemsMap[e],i=bt(n.display.from,this.tScale),s=bt(n.display.to-n.display.from,this.tScale);t?.set({left:i,width:s}),t?.setCoords()}updateTrackItemDetails(e,t){const n=t?.trackItemId;if(!n)return!1;const i=this.trackItemsMap[n],s={...i.details,...e.details};("fontSize"in s||"lineHeight"in s)&&(s.height=na(s.text,s)),this.trackItemsMap[n]={...i,...e,details:s},this.updateState()}updateTrackItem(e,t){const n=t.trackItemId;if(!n)return!1;const i=this.trackItemsMap[n],s={...i.details,...e.details};if(i.type==="text"&&e.details.text){const a=this.getObjects("Text").find(c=>c.id===n);a instanceof hf&&(a.text=e.details.text,this.requestRenderAll())}("fontSize"in s||"lineHeight"in s)&&(s.height=na(s.text,s)),this.trackItemsMap[n]={...i,...e,details:s},this.updateState()}updateTrackItemsDetails(e,t){t?.trackItemIds?.forEach((n,i)=>{const s=this.trackItemsMap[n],a={...s.details,...e[i].details};("fontSize"in a||"lineHeight"in a)&&(a.height=na(a.text,a)),this.trackItemsMap[n]={...s,...e[i],details:a}}),this.updateState()}getTrackItems(){return this.getObjects(...m3)}setActiveTrackItemCoords(){this.getActiveObjects().forEach(e=>e.setCoords())}deleteTrackItemById(e){const t=this.getObjects().filter(n=>e.includes(n.id));this.tracks=So(this.tracks,e),this.trackItemsMap=Object.keys(this.trackItemsMap).filter(n=>!e.includes(n)).reduce((n,i)=>(n[i]=this.trackItemsMap[i],n),{}),this.trackItemIds=this.trackItemIds.filter(n=>!e.includes(n)),this.discardActiveObject(),this.remove(...t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=tn(this.trackItemsMap)}selectTrackItemByIds(e){const t=this.getActiveObjects().map(i=>i.id);if(He.isEqual(t,e))return;const n=this.getTrackItems().filter(i=>e.includes(i.id));if(n.length===0)this.discardActiveObject();else if(n.length===1)this.setActiveObject(n[0]);else{const i=new vn(n);this.setActiveObject(i)}this.requestRenderAll()}}const m3=["Image","Text","Video","Audio","Caption","Template"],df=(r,e)=>{const n={text:Eb,video:Tb,image:Cb,audio:Sb}[r.type];return n(r,e)},Gs={text:32,image:40,video:40,audio:32,main:40},Lb=r=>{switch(r){case"text":return Gs.text;case"image":return Gs.image;case"video":return Gs.video;case"audio":return Gs.audio;case"helperTop":return 40;case"helperBottom":return 40;case"helperCenter":return 8;case"main":return Gs.main;default:return Gs.text}};class Fb{findOrCreateTrack(e,{trackId:t,trackIndex:n}){const i=t;if(i){const a=this.tracks.find(c=>c.id===i);if(a)return a.items.push(e.id),i}const s={id:kt(),items:[e.id],type:e.type,accepts:this.acceptsMap?.[e.type]};return n!==void 0?this.tracks.splice(n,0,s):this.tracks.push(s),this.renderTracks(),s.id}removeTracks(){this.getObjects("Track","Helper")?.forEach(e=>this.remove(e))}renderTracks(){this.updateTracksState(),this.removeTracks();const e=this.width,t=this.tracks.flatMap(c=>[c,{id:`after-${c.id}`,type:"helper",items:[],accepts:[]}]).slice(0,-1);let n=0;const i=ie.getClass("Helper")||Xs,s=new i({id:"helperLineTop",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"top",metadata:{}});n+=Lb("helperTop"),this.insertAt(0,s),t.forEach((c,u)=>{if(c.type==="helper"){const h=Lb("helperCenter"),d=new i({id:c.id,top:n,tScale:this.tScale,width:e,height:h,metadata:{order:(u+1)/2},kind:"center"});n+=h,this.insertAt(0,d)}else{const h=ie.getClass("Track")||hi,d=new h({id:c.id,top:n,left:0,fill:"#18181b",height:42,width:e,tScale:this.tScale,accepts:this.acceptsMap?.[c.type]||[],items:c.items});n+=42,this.insertAt(0,d)}});const a=new i({id:"helperLineBottom",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"bottom",metadata:{}});this.insertAt(0,a)}updateTracksState(){const e=this.tracks.filter(n=>n.items.length||n.type==="main"),t=new Map;e.forEach(n=>t.set(n.id,n)),this.tracks=Array.from(t.values())}updateTrackCoords(){const e=this.bounding.width+this.spacing.right;this.getObjects("Track","Helper").forEach(t=>{t.updateCoords(e),t.setCoords()})}}const v3=60,y3=188;function Nb(r,e=1,t=1){const n=y3*e;return r*(v3/1e3)*n/t}class Rb{removeTransitions(){const e=this.getObjects("Transition");this.remove(...e)}renderTransitions(){this.removeTransitions(),this.transitionIds.forEach(e=>{const t=this.transitionsMap[e],n=t.fromId,i=t.toId,s=this.getObjects(),a=s.find(p=>p.id===n),c=s.find(p=>p.id===i);if(!a||!c)return;const u=Nb(t.duration,this.tScale),h=a.left+a.width-u/2,d=a.height,g=new Nr({id:t.id,left:h,top:a.top,height:d,width:u,tScale:this.tScale,duration:t.duration,fromId:a.id,toId:c.id,kind:t.kind});t.kind==="none"&&(g.visible=!1),this.add(g)})}updateTransitionCoordinates(){this.pauseEventListeners(),this.getObjects("Transition").forEach(e=>{e.tScale=this.tScale,e.updateCoords(),e.setCoords()}),this.resumeEventListeners()}alignTransitionsToTrack(){this.pauseEventListeners(),this.transitionIds.forEach(e=>{const t=this.getObjects("Transition").find(n=>n.id===e);if(t instanceof Nr){const n=this.getObjects().find(a=>a.id===t.fromId);if(!n)return;const i=Nb(t.duration,this.tScale),s=n.left+n.width-i/2;t.set({left:s,top:n.top}),t.setCoords()}}),this.resumeEventListeners()}updateTransitions(e=!0){e&&this.pauseEventListeners();const t=this.getObjects("Track"),n=this.getObjects("Video","Image");this.removeTransitions();const i={},s=[];t.forEach(a=>{const c=n.filter(u=>a.items.includes(u.id)).sort((u,h)=>u.left-h.left);for(let u=0;u<c.length-1;u++){const h=c[u],d=c[u+1];if(Math.abs(h.left+h.width-d.left)<=1){const g=`${h.id}-${d.id}`;if(this.transitionIds.includes(g))i[g]=this.transitionsMap[g];else{const p={id:g,duration:1500,fromId:h.id,toId:d.id,kind:"none",trackId:a.id,type:"transition"};i[g]=p}s.push(g)}}}),this.transitionIds=s,this.transitionsMap=i,this.renderTransitions(),e&&this.resumeEventListeners()}}const te={canvas:null,enableGuideRedraw:!0,isPointerOverHelperTrack:!1,draggingOverTrack:null,primaryMovingObjects:[],secondaryMovingObjects:[],placeholderMovingObjects:[],objectInitialPositions:{},originTrack:{},trackToItemsMap:{},activeTrackToItemsMap:{},trackTopToIdMap:{},trackTops:[],activeObjects:[],primaryTracks:{},secondaryTracks:{}},vt={guide:null,object:null,objects:[]},b3=()=>te,w3=r=>{Object.assign(te,r)},x3=r=>{r.on("before:transform",Vb.bind(r))},_3=r=>{r.off("before:transform",Vb.bind(r))};function Vb(r){te.canvas=this,te.activeTrackToItemsMap={},te.primaryTracks={},te.secondaryTracks={},te.trackTops=[],te.trackToItemsMap={},te.activeObjects=[],te.trackTopToIdMap={},te.canvas.trackIdAfterTransform="",te.canvas.positionAfterTransform={};const e=te.canvas.getActiveObject();if(!e)return;te.activeObjects=e instanceof vn?e.getObjects():[e];const t=te.canvas.getScenePoint(r.e),n=te.canvas.getObjects("Track");te.originTrack=n.find(a=>{const c=a.getBoundingRect();return t.x>=c.left&&t.x<=c.left+c.width&&t.y>=c.top&&t.y<=c.top+c.height})??{};const i=te.canvas.getObjects("Video","Image","Audio","Text","Element");n.forEach(a=>{const c=i.filter(u=>a.items.includes(u.id));te.trackToItemsMap[a.id]=c,te.trackTopToIdMap[a.top]=a.id,te.trackTops.push(a.top)}),te.trackTops.sort((a,c)=>a-c),te.activeObjects.forEach(a=>{const c=n?.find(h=>h.items.includes(a.id));if(!c)return;const u=c.id;te.activeTrackToItemsMap[u]?te.activeTrackToItemsMap[u].push(a):te.activeTrackToItemsMap[u]=[a]}),te.primaryMovingObjects=te.activeObjects.filter(a=>{const c=a.getBoundingRect();return t.y>=c.top&&t.y<=c.top+c.height&&!(a instanceof Nr)}),te.primaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=te.trackTopToIdMap[c];if(te.primaryTracks[u])te.primaryTracks[u].objects.push(a);else{const h=ff(te.trackTops,te.originTrack.top,c);if(typeof h!="number")return;te.primaryTracks[u]={objects:[a],index:h}}}),te.primaryMovingObjects=te.primaryMovingObjects.sort((a,c)=>a.left-c.left),te.secondaryMovingObjects=te.activeObjects.filter(a=>!te.primaryMovingObjects.includes(a)&&!(a instanceof Nr)),te.secondaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=te.trackTopToIdMap[a.getBoundingRect().top];if(te.secondaryTracks[u])te.secondaryTracks[u].objects.push(a);else{const h=ff(te.trackTops,te.originTrack.top,c);if(typeof h!="number")return;te.secondaryTracks[u]={objects:[a],index:h}}}),te.originTrack&&(te.canvas.trackOriginBeforeTransform=te.originTrack.id),e&&(te.canvas.positionBeforeTransform={top:e.top,left:e.left}),("transform"in r?r.transform:{}).action==="drag"&&(te.placeholderMovingObjects=te.primaryMovingObjects.map(a=>{const c=a.getBoundingRect();te.objectInitialPositions[a.id]={top:c.top,left:c.left};const u=new Ys({id:`${a.id}-placeholder`,left:c.left,top:c.top,width:c.width,height:c.height,for:S3[a.type]});return u.draggedObject=a,u}),te.canvas.add(...te.placeholderMovingObjects))}function ff(r,e,t){const n=r.indexOf(e),i=r.indexOf(t);return n===-1||i===-1?null:i-n}const S3={trackitemvideo:"video",trackitemimage:"image",trackitemaudio:"audio",trackitemtext:"text"};function Bb(r){if(!vt.guide)return!1;r.e.preventDefault();const e=this,t=e.getViewportPoint(r.e);vt.guide.set({left:t.x-16,top:t.y-vt.guide.height/2});const n=C3(t,vt.objects);n&&(vt.object=n,n.strokeDashArray=[5,1],n.setSelected(!0)),vt.objects.forEach(i=>{i!==n&&i.setSelected(!1)}),e.requestRenderAll()}function C3(r,e){let t=1/0,n=null;const i=new z(r.x,r.y);return e.forEach(s=>{const a=T3(s,i);a<t&&(t=a,n=s)}),n}function T3(r,e){return Math.sqrt(Math.pow(r.left-e.x,2)+Math.pow(r.top-e.y,2))}const E3=["transition","image","video","audio","caption","text"];function zb(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(e),{type:n,duration:i=5e3}=t;if(!E3.includes(n))return;const s=this;s.discardActiveObject();const a=bt(i,s.tScale);vt.guide=k3({width:a,height:48,id:"TransitionGuide",left:0,top:0,type:n}),s.add(vt.guide),n==="transition"&&(vt.objects=s.getObjects("Transition"),vt.objects.forEach(c=>{c.visible=!0})),je.dispatch(Qu)}function k3({width:r,height:e,id:t,left:n,top:i,type:s}){return s==="transition"?new ta({top:0,left:0,height:48,width:48,id:"TransitionGuide"}):new ra({top:i,left:n,height:e,width:r,id:t,name:"Rivers in the mountains"})}function Hb(){if(!vt.guide)return;je.dispatch(xo);const r=this;I3(vt.objects),r.remove(vt.guide)}function I3(r){r.forEach(e=>{e.strokeDashArray=[],e.setSelected(!1),e.kind==="none"&&(e.visible=!1)})}var A3=typeof global=="object"&&global&&global.Object===Object&&global,M3=typeof self=="object"&&self&&self.Object===Object&&self,gf=A3||M3||Function("return this")(),di=gf.Symbol,Wb=Object.prototype,O3=Wb.hasOwnProperty,P3=Wb.toString,ia=di?di.toStringTag:void 0;function D3(r){var e=O3.call(r,ia),t=r[ia];try{r[ia]=void 0;var n=!0}catch{}var i=P3.call(r);return n&&(e?r[ia]=t:delete r[ia]),i}var j3=Object.prototype,L3=j3.toString;function F3(r){return L3.call(r)}var N3="[object Null]",R3="[object Undefined]",Ub=di?di.toStringTag:void 0;function pf(r){return r==null?r===void 0?R3:N3:Ub&&Ub in Object(r)?D3(r):F3(r)}function mf(r){return r!=null&&typeof r=="object"}var V3="[object Symbol]";function vf(r){return typeof r=="symbol"||mf(r)&&pf(r)==V3}function B3(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var sa=Array.isArray,$b=di?di.prototype:void 0,Yb=$b?$b.toString:void 0;function Xb(r){if(typeof r=="string")return r;if(sa(r))return B3(r,Xb)+"";if(vf(r))return Yb?Yb.call(r):"";var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function yl(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function z3(r){return r}var H3="[object AsyncFunction]",W3="[object Function]",U3="[object GeneratorFunction]",$3="[object Proxy]";function Y3(r){if(!yl(r))return!1;var e=pf(r);return e==W3||e==U3||e==H3||e==$3}var yf=gf["__core-js_shared__"],Gb=function(){var r=/[^.]+$/.exec(yf&&yf.keys&&yf.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function X3(r){return!!Gb&&Gb in r}var G3=Function.prototype,q3=G3.toString;function K3(r){if(r!=null){try{return q3.call(r)}catch{}try{return r+""}catch{}}return""}var Z3=/[\\^$.*+?()[\]{}|]/g,J3=/^\[object .+?Constructor\]$/,Q3=Function.prototype,e4=Object.prototype,t4=Q3.toString,r4=e4.hasOwnProperty,n4=RegExp("^"+t4.call(r4).replace(Z3,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function i4(r){if(!yl(r)||X3(r))return!1;var e=Y3(r)?n4:J3;return e.test(K3(r))}function s4(r,e){return r?.[e]}function bf(r,e){var t=s4(r,e);return i4(t)?t:void 0}function o4(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var a4=800,c4=16,l4=Date.now;function u4(r){var e=0,t=0;return function(){var n=l4(),i=c4-(n-t);if(t=n,i>0){if(++e>=a4)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function h4(r){return function(){return r}}var bl=function(){try{var r=bf(Object,"defineProperty");return r({},"",{}),r}catch{}}(),d4=bl?function(r,e){return bl(r,"toString",{configurable:!0,enumerable:!1,value:h4(e),writable:!0})}:z3,f4=u4(d4),g4=9007199254740991,p4=/^(?:0|[1-9]\d*)$/;function qb(r,e){var t=typeof r;return e=e??g4,!!e&&(t=="number"||t!="symbol"&&p4.test(r))&&r>-1&&r%1==0&&r<e}function m4(r,e,t){e=="__proto__"&&bl?bl(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}function Kb(r,e){return r===e||r!==r&&e!==e}var v4=Object.prototype,y4=v4.hasOwnProperty;function b4(r,e,t){var n=r[e];(!(y4.call(r,e)&&Kb(n,t))||t===void 0&&!(e in r))&&m4(r,e,t)}var Zb=Math.max;function w4(r,e,t){return e=Zb(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,s=Zb(n.length-e,0),a=Array(s);++i<s;)a[i]=n[e+i];i=-1;for(var c=Array(e+1);++i<e;)c[i]=n[i];return c[e]=t(a),o4(r,this,c)}}var x4=9007199254740991;function _4(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=x4}var S4="[object Arguments]";function Jb(r){return mf(r)&&pf(r)==S4}var Qb=Object.prototype,C4=Qb.hasOwnProperty,T4=Qb.propertyIsEnumerable,ew=Jb(function(){return arguments}())?Jb:function(r){return mf(r)&&C4.call(r,"callee")&&!T4.call(r,"callee")},E4=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,k4=/^\w*$/;function I4(r,e){if(sa(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||vf(r)?!0:k4.test(r)||!E4.test(r)||e!=null&&r in Object(e)}var oa=bf(Object,"create");function A4(){this.__data__=oa?oa(null):{},this.size=0}function M4(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var O4="__lodash_hash_undefined__",P4=Object.prototype,D4=P4.hasOwnProperty;function j4(r){var e=this.__data__;if(oa){var t=e[r];return t===O4?void 0:t}return D4.call(e,r)?e[r]:void 0}var L4=Object.prototype,F4=L4.hasOwnProperty;function N4(r){var e=this.__data__;return oa?e[r]!==void 0:F4.call(e,r)}var R4="__lodash_hash_undefined__";function V4(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=oa&&e===void 0?R4:e,this}function qi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}qi.prototype.clear=A4,qi.prototype.delete=M4,qi.prototype.get=j4,qi.prototype.has=N4,qi.prototype.set=V4;function B4(){this.__data__=[],this.size=0}function wl(r,e){for(var t=r.length;t--;)if(Kb(r[t][0],e))return t;return-1}var z4=Array.prototype,H4=z4.splice;function W4(r){var e=this.__data__,t=wl(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():H4.call(e,t,1),--this.size,!0}function U4(r){var e=this.__data__,t=wl(e,r);return t<0?void 0:e[t][1]}function $4(r){return wl(this.__data__,r)>-1}function Y4(r,e){var t=this.__data__,n=wl(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}function qs(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}qs.prototype.clear=B4,qs.prototype.delete=W4,qs.prototype.get=U4,qs.prototype.has=$4,qs.prototype.set=Y4;var X4=bf(gf,"Map");function G4(){this.size=0,this.__data__={hash:new qi,map:new(X4||qs),string:new qi}}function q4(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function xl(r,e){var t=r.__data__;return q4(e)?t[typeof e=="string"?"string":"hash"]:t.map}function K4(r){var e=xl(this,r).delete(r);return this.size-=e?1:0,e}function Z4(r){return xl(this,r).get(r)}function J4(r){return xl(this,r).has(r)}function Q4(r,e){var t=xl(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}function Ki(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Ki.prototype.clear=G4,Ki.prototype.delete=K4,Ki.prototype.get=Z4,Ki.prototype.has=J4,Ki.prototype.set=Q4;var eP="Expected a function";function wf(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(eP);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=t.cache;if(s.has(i))return s.get(i);var a=r.apply(this,n);return t.cache=s.set(i,a)||s,a};return t.cache=new(wf.Cache||Ki),t}wf.Cache=Ki;var tP=500;function rP(r){var e=wf(r,function(n){return t.size===tP&&t.clear(),n}),t=e.cache;return e}var nP=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,iP=/\\(\\)?/g,sP=rP(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(nP,function(t,n,i,s){e.push(i?s.replace(iP,"$1"):n||t)}),e});function oP(r){return r==null?"":Xb(r)}function _l(r,e){return sa(r)?r:I4(r,e)?[r]:sP(oP(r))}function xf(r){if(typeof r=="string"||vf(r))return r;var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function aP(r,e){e=_l(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[xf(e[t++])];return t&&t==n?r:void 0}function cP(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var tw=di?di.isConcatSpreadable:void 0;function lP(r){return sa(r)||ew(r)||!!(tw&&r&&r[tw])}function uP(r,e,t,n,i){var s=-1,a=r.length;for(t||(t=lP),i||(i=[]);++s<a;){var c=r[s];t(c)?cP(i,c):i[i.length]=c}return i}function hP(r){var e=r==null?0:r.length;return e?uP(r):[]}function dP(r){return f4(w4(r,void 0,hP),r+"")}function fP(r,e){return r!=null&&e in Object(r)}function gP(r,e,t){e=_l(e,r);for(var n=-1,i=e.length,s=!1;++n<i;){var a=xf(e[n]);if(!(s=r!=null&&t(r,a)))break;r=r[a]}return s||++n!=i?s:(i=r==null?0:r.length,!!i&&_4(i)&&qb(a,i)&&(sa(r)||ew(r)))}function pP(r,e){return r!=null&&gP(r,e,fP)}function mP(r,e,t,n){if(!yl(r))return r;e=_l(e,r);for(var i=-1,s=e.length,a=s-1,c=r;c!=null&&++i<s;){var u=xf(e[i]),h=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(i!=a){var d=c[u];h=void 0,h===void 0&&(h=yl(d)?d:qb(e[i+1])?[]:{})}b4(c,u,h),c=c[u]}return r}function vP(r,e,t){for(var n=-1,i=e.length,s={};++n<i;){var a=e[n],c=aP(r,a);t(c,a)&&mP(s,_l(a,r),c)}return s}function yP(r,e){return vP(r,e,function(t,n){return pP(r,n)})}var bP=dP(function(r,e){return r==null?{}:yP(r,e)});function rw(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(r.e.dataTransfer.getData(e)),n=this;if(t.type!=="transition"){wP(t),n.remove(vt.guide),n.requestRenderAll(),je.dispatch(xo);return}vt.guide&&(vt.object&&xP(t,n),vt.objects.forEach(i=>{i.strokeDashArray=[],i.setSelected(!1),i.kind==="none"&&(i.visible=!1)}),n.remove(vt.guide),n.requestRenderAll(),je.dispatch(xo))}function wP(r){const e={...r,id:kt()};switch(r.type){case"image":je.dispatch(ws,{payload:e});break;case"video":je.dispatch(ys,{payload:e});break;case"audio":je.dispatch(bs,{payload:e});break}}function xP(r,e){const t=vt.object?.id,n=bP(r,["kind","direction"]);Object.entries(n).forEach(([i,s])=>{i==="kind"?vt.object.kind=s:vt.object[i]=s}),e.transitionsMap[t]={...e.transitionsMap[t],...n},e.updateState()}const _P=r=>{r.on("dragover",Bb),r.on("dragenter",zb),r.on("dragleave",Hb),r.on("drop",rw)},SP=r=>{r.off("dragover",Bb),r.off("dragenter",zb),r.off("dragleave",Hb),r.off("drop",rw)},nw=r=>{const e=r.target.canvas,t=r.target;if(r.action==="resizing"&&t instanceof Nr&&e){const n=t.id,i=e.getObjects("Transition").find(s=>s.id===n);if(i&&i instanceof Nr){const s=He.cloneDeep(e.transitionsMap),a={...s,[n]:{...s[n],width:i.width,duration:i.duration}};e.transitionsMap=a,e.updateState()}}e&&(CP(e,e.getObjects()),TP(e.getObjects("Helper")),te.isPointerOverHelperTrack=!1,te.draggingOverTrack=null)},CP=(r,e)=>{e.forEach(t=>{t.isAlignmentAuxiliary&&r.remove(t)})},TP=r=>{r.forEach(e=>e.setSelected(!1))};function iw(r){const e=r.target.canvas;if(!e)return;const t=e.getActiveObject();if(!t||!e.positionBeforeTransform)return;const n=e.getScenePoint(r.e),i=e.getObjects("Track","Helper").find(s=>{const a=s.getBoundingRect();return n.x>=a.left&&n.x<=a.left+a.width&&n.y>=a.top&&n.y<=a.top+a.height});if(r.action==="resizing"){const s=(te.trackToItemsMap[te.originTrack.id]||[]).filter(c=>c!==t);t.setCoords();const a=Sl(s,t.getBoundingRect());return e.fire("track-items:resized",{trackId:te.originTrack.id,trackItemIds:[t.id],isOverlapped:!!a}),!1}if(!i)return t&&(t?.set(e.positionBeforeTransform),t?.setCoords()),!1;if(i instanceof Xs){let s;switch(i.kind){case"top":s=0;break;case"center":s=i.metadata.order||0;break;case"bottom":s=-1;break;default:return}const a={isSecondaryOverlapped:!1,secondaryTracks:te.secondaryTracks,primaryTracks:te.primaryTracks,primaryPositions:{trackIndex:s,trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};AP(a)}else if(i instanceof hi){const s={isSecondaryOverlapped:kP(),secondaryTracks:te.secondaryTracks,primaryTracks:te.primaryTracks,primaryPositions:{trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};EP(s)}}const EP=r=>{te.canvas&&te.canvas.fire("track-items:moved",r)};function kP(){const r=IP();return Object.keys(r).some(e=>{const t=te.trackToItemsMap[e],n=r[e].objects;return t?.length?t.filter(i=>!n.includes(i)).some(i=>Sl(n,i.getBoundingRect())):!0})}function IP(){const[r]=te.primaryMovingObjects,e=r.id,n=te.canvas.positionAfterTransform[e].top-r.getBoundingRect().top,i={};return te.secondaryMovingObjects.forEach(s=>{const a=s.getBoundingRect().top+n,c=te.trackTopToIdMap[a],u=ff(te.trackTops,te.originTrack.top,a);i[c]?i[c].objects.push(s):i[c]={objects:[s],index:u}}),i}const AP=r=>{te.canvas&&te.canvas.fire("track:create",r)};function Sl(r,e){return r.find(t=>{const n=t.getBoundingRect();return e.left<n.left+n.width&&e.left+e.width>n.left&&e.top<n.top+n.height&&e.top+e.height>n.top})}const MP=r=>{r.on("object:modified",nw),r.on("object:modified",iw)},OP=r=>{r.off("object:modified",nw),r.off("object:modified",iw)};function PP(r,e){r.remove(...e),e.length=0}function sw(){PP(this,te.placeholderMovingObjects)}function ow(r){const e=this.height<this.bounding.height,t=this.width<this.bounding.width;if(!e&&!t)return;const n=this.viewportTransform;let i=n[4],s=n[5];const a=2;r.e.shiftKey?i=n[4]-r.e.deltaY*a:(e&&(s=n[5]-r.e.deltaY*a),i=n[4]-r.e.deltaX*a),this.setViewportPos(i,s)}const DP=r=>{r.on("mouse:wheel",ow),r.on("mouse:up",sw.bind(r))},jP=r=>{r.off("mouse:wheel",ow),r.off("mouse:up",sw.bind(r))};function aw(r){const e=this;if(!e)return;const t=e.getScenePoint(r.e),n=e.getObjects("Helper","Track");te.draggingOverTrack=n.find(h=>{const d=h.getBoundingRect();return t.x>=d.left&&t.x<=d.left+d.width&&t.y>=d.top&&t.y<=d.top+d.height})??null,n.forEach(h=>{if(lw(h)){const d=te.draggingOverTrack;h.setSelected(h===d)}}),te.isPointerOverHelperTrack=lw(te.draggingOverTrack),e.getObjects();const i=r.target;i.getBoundingRect(),i.setCoords();const s=[i,...e.getActiveObjects(),...e.getObjects("Track","Helper","Transition","Placeholder")],a=LP(s,e),c=NP(i);FP(a,c).forEach(h=>{h.orientation==="V"?i.left=h.lineGuide+h.offset:i.top=h.lineGuide+h.offset})}const LP=(r,e)=>{const t=[],n=[];return e.getObjects().filter(i=>i.visible).forEach(i=>{if(r.some(c=>c.id===i.id)||i.isAlignmentAuxiliary)return;const a=i.getBoundingRect();t.push(cw(a.left,a.width,a.top,a.height)),n.push(cw(a.top,a.height,a.left,a.width))}),{vertical:t.flat(),horizontal:[]}},cw=(r,e,t,n)=>[r,r+e].map(i=>({val:i,start:t,end:t+n})),FP=(r,e)=>{const t=[],n=[];r.vertical.forEach(u=>{e.vertical.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&t.push({lineGuide:u.val,diff:d,orientation:"V",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})}),r.horizontal.forEach(u=>{e.horizontal.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&n.push({lineGuide:u.val,diff:d,orientation:"H",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})});const s=[],a=t.sort((u,h)=>u.diff-h.diff)[0],c=n.sort((u,h)=>u.diff-h.diff)[0];return a&&s.push({lineGuide:a.lineGuide,offset:a.offset,orientation:"V",snap:a.snap,targetDim:a.targetDim}),c&&s.push({lineGuide:c.lineGuide,offset:c.offset,orientation:"H",snap:c.snap,targetDim:c.targetDim}),s},NP=r=>{const e=r.getBoundingRect();return{vertical:[{guide:Math.round(e.left),offset:Math.round(r.left-e.left),snap:"start"},{guide:Math.round(e.left+e.width),offset:Math.round(r.left-e.left-e.width),snap:"end"}],horizontal:[{guide:Math.round(e.top),offset:Math.round(r.top-e.top),snap:"start"},{guide:Math.round(e.top+e.height),offset:Math.round(r.top-e.top-e.height),snap:"end"}]}},lw=r=>r instanceof Xs;function RP(r){r.opacity=te.isPointerOverHelperTrack?0:1}const uw=$P(r=>{const e=r.target.canvas;if(YP(r),!te.draggingOverTrack)return;const t=te.placeholderMovingObjects.map(s=>s.draggedObject),n=(te.trackToItemsMap[te.draggingOverTrack.id]||[]).filter(s=>!t.includes(s)),i=n.find(s=>Sl(t,s.getBoundingRect()));te.placeholderMovingObjects.forEach(s=>{const a=s.draggedObject;a?.setCoords(),RP(s);const c=VP(a,n,i,te.placeholderMovingObjects.length>1);e.trackIdAfterTransform=te.trackTopToIdMap[c.top],e.positionAfterTransform[a?.id]={top:c.top,left:c.left},s.left=c.left,s.top=c.top})},5),VP=(r,e,t,n)=>!BP(r)||n&&t?hw(r):t?zP(r,t,e):UP(r),BP=r=>te.draggingOverTrack?te.draggingOverTrack.accepts?.includes(r.type)??!1:!1,hw=r=>({top:te.objectInitialPositions[r.id].top,left:te.objectInitialPositions[r.id].left}),zP=(r,e,t)=>{const n=HP(r,e);return!WP(t,r,n)||te.activeObjects.length!==1?hw(r):{left:n,top:e.top}},HP=(r,e)=>{const t=r.left+r.width/2,n=e.left+e.width/2;return t<n?e.left-r.width:e.left+e.width},WP=(r,e,t)=>!(t<0||Sl(r,{...e.getBoundingRect(),left:t})),UP=r=>({left:r.getBoundingRect().left,top:te.draggingOverTrack?.top??0});function $P(r,e){let t=null;return function(...n){const i=Date.now();(t===null||i-t>=e)&&(t=i,r(...n))}}function YP(r){const e=r.target,t=e.canvas,n=e.top,i=-e.height*.75,s=t.height+e.height*.75;e.top=Math.min(Math.max(n,i),s-e.height);const a=e.left;e.left=Math.max(a,0)}const XP=r=>{r.on("object:moving",aw.bind(r)),r.on("object:moving",uw)},GP=r=>{r.off("object:moving",aw.bind(r)),r.off("object:moving",uw)};function dw(){const r=this,e=r.getActiveObject(),t=r.getActiveObjects().map(n=>n.id);e instanceof jr?(e.borderColor="rgba(0, 216, 214, 0.75)",e.hasControls=!1,e.hoverCursor="default",e.borderScaleFactor=1,e.padding=0,e.getObjects().forEach(n=>{n.setSelected(!0)})):e?.setSelected(!0),this.setActiveIds(t)}function fw(r){const e=this,t=e.getActiveObject();t instanceof jr&&(t.borderColor="transparent",t.hasControls=!1,t.hoverCursor="default"),r.selected.forEach(i=>{i.setSelected(!0)}),r.deselected.forEach(i=>{i.setSelected(!1)});const n=e.getActiveObjects().map(i=>i.id);this.setActiveIds(n)}function gw(r){this.getObjects().forEach(t=>{t.isSelected&&(t.isSelected=!1)}),r.deselected.forEach(t=>{t.setSelected(!1)});const e=this.getActiveObjects().map(t=>t.id);this.setActiveIds(e)}const qP=r=>{r.on("selection:created",dw),r.on("selection:updated",fw),r.on("selection:cleared",gw)},KP=r=>{r.off("selection:created",dw),r.off("selection:updated",fw),r.off("selection:cleared",gw)};let pw,mw,vw;const ZP=r=>{const{state:e}=r;pw=e.subscribeToActiveIds(({activeIds:t})=>{if(t.length===1){const n=t[0],{trackItemIds:i,trackItemsMap:s}=e.getState();i.forEach(a=>{s[a].type}),r.selectTrackItemByIds([n])}else r.selectTrackItemByIds(t)}),mw=e.subscribeToHistory(t=>{const{tracks:n,trackItemsMap:i,trackItemIds:s,trackItemDetailsMap:a}=t;r.tracks=n,r.trackItemsMap=i,r.trackItemIds=s,r.trackItemDetailsMap=a,r.renderTracks(),r.updateTrackItemsToHistory(),r.alignItemsToTrack(),r.calcBounding(),r.updateTransitions(),r.duration=tn(r.trackItemsMap)}),vw=e.subscribeToAddOrRemoveItems(()=>{const t=r.getTrackItems().map(c=>c.id),{trackItemIds:n,trackItemsMap:i,trackItemDetailsMap:s}=e.getState(),a=[];t.forEach(c=>{n.includes(c)||a.push(c)}),r.deleteTrackItemById(a),r.tracks=e.getState().tracks,r.trackItemsMap=i,r.trackItemDetailsMap=s,n.forEach(c=>{if(!t.includes(c)){const u={...i[c],details:{...s[c].details}};r.addTrackItem(u)}}),r.renderTracks(),r.alignItemsToTrack(),n.forEach(c=>{r.updateTrackItemCoords(c)}),r.updateTransitions(),r.updateTrackCoords()})},JP=r=>{pw.unsubscribe(),mw.unsubscribe(),vw.unsubscribe()};function yw(r){const{isSecondaryOverlapped:e,secondaryTracks:t,primaryTracks:n,primaryPositions:i}=r,{trackId:s,positions:a}=i,c=this.tracks.findIndex(y=>y.id===s),u=gh(Object.keys(t).map(y=>t[y].objects.map(w=>w.id))),h=So(this.tracks,[...Object.keys(a),...u]);Object.keys(n).forEach(y=>{this.pauseEventListeners();const{objects:w}=n[y];w.forEach(S=>{const T=a[S.id];S.left=T.left}),this.resumeEventListeners();const _=h.find(S=>S.id===s);_&&_.items.push(...Object.keys(a)),this.tracks=h});const d=this.tracks[c],g=[];Object.keys(t).forEach(y=>{const{objects:w,index:_}=t[y],S=w.map(I=>I.id),[T]=S,k=this.trackItemsMap[T];if(e){const I={id:kt(),items:S,type:k.type,accepts:this.acceptsMap?.[k.type],tempIndex:_};g.push(I)}else{const I=h[c+_];I&&I.items.push(...S),this.tracks=h}});const p=ph(d,g);p.length&&h.splice(c,1,...p),this.tracks=h,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}function bw({trackItemIds:r,isOverlapped:e}){const[t]=r;if(t){if(!this.getObjects("Transition").find(n=>n.id===t)){const n=this.tracks.find(i=>i.items.includes(t));if(e){const i=QP(this.tracks,r),s={id:kt(),items:[t],type:n?.type,accepts:n?.accepts},a=this.tracks.findIndex(c=>c.id===n?.id);i.splice(a,0,s),this.tracks=i}}this.renderTracks(),this.alignItemsToTrack(),this.alignTransitionsToTrack(),this.updateTransitions(),this.updateTrackItemsPosition(),this.updateState({updateHistory:!0,kind:"update"})}}function QP(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}function ww(r){const{secondaryTracks:e,primaryTracks:t,primaryPositions:n}=r,{positions:i,trackIndex:s}=n,a=s===-1?this.tracks.length:s,[c]=Object.keys(t),u=this.tracks.find(_=>_.id==c),h=t[c],d={id:kt(),items:h.objects.map(_=>_.id),type:u?.type,accepts:u?.accepts},g=gh(Object.keys(e).map(_=>e[_].objects.map(S=>S.id))),p=So(this.tracks,[...Object.keys(i),...g]),y=[];Object.keys(e).forEach(_=>{const{objects:S,index:T}=e[_],k=this.tracks.find(L=>L.id==_),I=S.map(L=>L.id),M={id:kt(),items:I,type:k?.type,accepts:k?.accepts,tempIndex:T};y.push(M)});const w=ph(d,y);w.length&&p.splice(a,0,...w),this.tracks=p,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}const eD=r=>{r.on("track:create",ww.bind(r)),r.on("track-items:resized",bw.bind(r)),r.on("track-items:moved",yw.bind(r))},tD=r=>{r.off("track:create",ww.bind(r)),r.off("track-items:resized",bw.bind(r)),r.off("track-items:moved",yw.bind(r))},xw=r=>{_P(r),MP(r),DP(r),XP(r),eD(r),qP(r),x3(r),ZP(r)},_w=r=>{SP(r),OP(r),jP(r),GP(r),tD(r),KP(r),_3(r),JP()},rD={video:["*"],image:["*"],audio:["*"],text:["*"]},nD=["video","image","audio","text"];let Cl=class extends Gd{acceptsMap;tracks=[];trackItemsMap={};trackItemIds=[];transitionIds=[];transitionsMap={};trackItemDetailsMap={};bounding;onScroll;tScale;store;state;activeIds=[];spacing;scale;sizesMap;duration;setupFabricDefaults(){Ze.ownDefaults.borderColor="transparent",Ze.ownDefaults.cornerColor="white",Ze.ownDefaults.cornerStrokeColor="transparent",Ze.ownDefaults.strokeWidth=0,Ze.ownDefaults.borderOpacityWhenMoving=1,Ze.ownDefaults.borderScaleFactor=1,Ze.ownDefaults.cornerSize=8,Ze.ownDefaults.cornerStyle="rect",Ze.ownDefaults.centeredScaling=!1,Ze.ownDefaults.centeredRotation=!0,Ze.ownDefaults.transparentCorners=!1}constructor(e,t){super(e,t),this.bounding=t.bounding||{width:t.width||0,height:t.height||0},this.spacing={left:16,right:80,...t.spacing};const n=this.viewportTransform;n[4]=this.spacing.left,this.tScale=t.tScale||1/300,this.store=t.store,this.state=t.state,this.scale=t.scale,this.onScroll=t.onScroll,this.acceptsMap=this.createAcceptsItemMap(t.acceptsMap),this.sizesMap=Ib(t.sizesMap),this.setupFabricDefaults(),this.initEventListeners()}createAcceptsItemMap(e=rD){const t={};return Object.keys(e).forEach(n=>{const i=e[n];t[n]=i.includes("*")?nD:i}),t}setActiveIds(e){this.activeIds=e,this.getObjects("Transition").some(n=>e.includes(n.id))||(this.state?.updateState({activeIds:He.cloneDeep(this.activeIds)}),je.dispatch(qu,{payload:{activeIds:this.activeIds}}))}purge(){_w(this),this.dispose()}static registerItems(e){Object.keys(e).forEach(t=>{ie.setClass(e[t],t)})}initEventListeners(){xw(this)}getUpdatedState(){const e=tn(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,scale:this.scale,duration:e}}getState(){const e=tn(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,trackItemDetailsMap:this.trackItemDetailsMap,scale:this.scale,duration:e}}notify(e={updateHistory:!1}){const t=this.getUpdatedState();this.state.updateState(t,e)}updateState(e){this.updateTracksState(),this.updateTrackItemsState(),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords();const t=this.getUpdatedState();this.state.updateState(t,e)}scrollTo({scrollLeft:e,scrollTop:t}){const n=[...this.viewportTransform];let i=!1;if(typeof e=="number"&&(n[4]=-e+this.spacing.left,i=!0),typeof t=="number"&&(n[5]=-t,i=!0),i){this.viewportTransform=n;const s=this.getActiveObject();s&&s.setCoords(),this.requestRenderAll()}}setBoundingBox(e){this.bounding=e}calcBounding(){const e=this.getTrackItems().reduce((t,n)=>{const{left:i,top:s,width:a,height:c}=n.getBoundingRect();return{left:Math.min(t.left,i),top:Math.min(t.top,s),width:Math.max(t.width,i+a),height:Math.max(t.height,s+c)}},{left:1/0,top:1/0,width:this.width,height:0});this.bounding=e,je.dispatch(eh,{payload:{bounding:e}})}setScale(e){this.pauseEventListeners(),this.tScale=e.zoom,this.scale=e;const t=this.getState();this.getObjects("Video","Image","Text","Audio").forEach(n=>{const i=t.trackItemsMap[n.id],{from:s,to:a}=i.display,c=bt(s,this.tScale),u=bt(a-s,this.tScale,n.playbackRate);n.set({left:c,width:u,tScale:e.zoom}),n.setCoords()}),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords(),this.updateTransitions(!1),this.resumeEventListeners(),this.notify()}setViewportPos(e,t){const n=this.getViewportPos(e,t),i=this.viewportTransform;i[4]=n.x,i[5]=n.y,this.requestRenderAll(),this.setActiveTrackItemCoords();const s=this.onScroll;s&&s.call(this,{scrollTop:n.y,scrollLeft:n.x-this.spacing.left})}getViewportPos(e,t){const n=this.bounding.width-100>=this.width?this.spacing.right:0,i=this.width-this.bounding.width-n,s=this.spacing.left,a=Math.max(i,Math.min(e,s));if(this.bounding.height<this.height)return{x:a,y:0};const c=this.height-this.bounding.height-40,u=Math.max(c,Math.min(t,0));return{x:a,y:u}}};fb(Cl,[ib,jb,Fb,Rb]);function Sw(r){const e=je.subject.pipe(Cn(({key:t})=>t.startsWith(gm))).subscribe(t=>{if(t.key===Ju){const n=t.value;r.setScale(n?.payload.scale??void 0)}});return{unsubscribe:()=>{e.unsubscribe()}}}Cl.registerItems({Text:hf,Image:Ob,Video:Mb,Audio:Ab,Track:Pb,Helper:Db});const Cw=({stateManager:r})=>{const e=v.useRef(!1),[t,n]=v.useState(0),i=v.useRef(null),s=v.useRef(null),a=v.useRef(null),c=v.useRef(null),u=v.useRef(null),[h,d]=v.useState({width:0,height:0}),[g,p]=v.useState({width:0,height:0}),{scale:y,playerRef:w,fps:_,setState:S,timeline:T}=hn(),{setTimeline:k}=hn(),I=Ga(w??void 0),M=R=>{u.current&&c.current&&(c.current.scrollTop=-R.scrollTop,u.current.scrollLeft=-R.scrollLeft,n(-R.scrollLeft))};v.useEffect(()=>{const R=bt(I/_*1e3,y.zoom),X=s.current?.getBoundingClientRect().x+s.current?.clientWidth;if(R-t+40>=X){const K=u.current?.clientWidth,$=u.current?.scrollWidth,G=u.current?.scrollLeft,fe=($-(K+G))/K;fe>=0&&(fe>1?u.current?.scrollTo({left:G+K}):u.current?.scrollTo({left:$-K}))}},[I]),v.useEffect(()=>{const R=s.current,X=i.current;if(!R||!X)return;const U=X.clientWidth,K=X.clientHeight,$=new Cl(R,{width:U,height:K,bounding:{width:U,height:0},selectionColor:"rgba(0, 216, 214,0.1)",selectionBorderColor:"rgba(0, 216, 214,1.0)",onScroll:M,state:r,scale:y,spacing:{left:Xa,right:dh}}),G=Sw($);a.current=$,d({width:U,height:K}),p({width:U,height:0}),k($);const re=r.subscribeToSize(ne=>{S(ne)}),fe=r.subscribeToScale(ne=>{S(ne)}),Q=r.subscribeToTracks(ne=>{S(ne)}),ue=r.subscribeToDuration(ne=>{S(ne)}),oe=r.subscribeToUpdateTrackItem(()=>{const ne=r.getState();S({duration:ne.duration,trackItemsMap:ne.trackItemsMap})}),se=r.subscribeToAddOrRemoveItems(()=>{const ne=r.getState();S({trackItemDetailsMap:ne.trackItemDetailsMap,trackItemsMap:ne.trackItemsMap,trackItemIds:ne.trackItemIds,tracks:ne.tracks})}),de=r.subscribeToUpdateItemDetails(()=>{const ne=r.getState();S({trackItemDetailsMap:ne.trackItemDetailsMap})});return()=>{G.unsubscribe(),$.purge(),fe.unsubscribe(),Q.unsubscribe(),ue.unsubscribe(),se.unsubscribe(),oe.unsubscribe(),de.unsubscribe(),re.unsubscribe()}},[]),v.useEffect(()=>{const X=je.subject.pipe(Cn(({key:U})=>U.startsWith(mm))).subscribe(U=>{if(U.key===eh){const K=U.value?.payload?.bounding;K&&p({width:K.width,height:K.height})}});return()=>{X.unsubscribe()}},[]);const L=R=>{const X=R.currentTarget.scrollLeft;e.current&&a.current.scrollTo({scrollLeft:X}),n(X)},N=R=>{const X=R.currentTarget.scrollTop;e.current&&a.current.scrollTo({scrollTop:X})};v.useEffect(()=>{const R=u.current?.scrollWidth;if(!R||!T)return;const X=T.width;R<X+t&&T.scrollTo({scrollLeft:R-X})},[y]);const H=R=>{if(!a.current)return;const U=Zn(R,y.zoom);w?.current?.seekTo(U*_/1e3)};return b.jsxs("div",{className:"relative overflow-hidden h-80 w-full",children:[b.jsx(e0,{}),b.jsx(zv,{onClick:H,scrollLeft:t}),b.jsx(Bv,{scrollLeft:t}),b.jsxs("div",{className:"flex",children:[b.jsx("div",{className:"relative w-10 flex-none"}),b.jsxs("div",{className:"relative h-[230px] flex-1",children:[b.jsx("div",{ref:i,className:"absolute top-0 h-[230px] w-full text-sm text-white ",children:b.jsx("canvas",{ref:s,id:"designcombo-timeline-canvas"})}),b.jsxs(Va,{type:"always",style:{position:"absolute",width:"calc(100vw - 40px)",height:"10px"},className:"ScrollAreaRootH",children:[b.jsx(Fu,{onScroll:L,className:"ScrollAreaViewport",id:"viewportH",ref:u,children:b.jsx("div",{style:{width:g.width>h.width?g.width+dh:g.width},className:"pointer-events-none h-[10px]"})}),b.jsx(Np,{className:"ScrollAreaScrollbar",orientation:"horizontal",children:b.jsx(Rp,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]}),b.jsxs(Va,{type:"always",style:{position:"absolute",height:"230px",width:"10px"},className:"ScrollAreaRootV",children:[b.jsx(Fu,{onScroll:N,className:"ScrollAreaViewport",ref:c,children:b.jsx("div",{style:{height:g.height>h.height?g.height+40:h.height},className:"pointer-events-none w-[10px]"})}),b.jsx(Np,{className:"ScrollAreaScrollbar",orientation:"vertical",children:b.jsx(Rp,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]})]})]})]})},iD={Date:!0,RegExp:!0,String:!0,Number:!0};function Tw(r,e,t={cyclesFix:!0},n=[]){let i=[];const s=Array.isArray(r);for(const c in r){const u=r[c],h=s?+c:c;if(!(c in e)){i.push({type:"REMOVE",path:[h],oldValue:r[c]});continue}const d=e[c],g=typeof u=="object"&&typeof d=="object"&&Array.isArray(u)===Array.isArray(d);u&&d&&g&&!iD[Object.getPrototypeOf(u)?.constructor?.name]&&(!t.cyclesFix||!n.includes(u))?i.push.apply(i,Tw(u,d,t,t.cyclesFix?n.concat([u]):[]).map(p=>(p.path.unshift(h),p))):u!==d&&!(Number.isNaN(u)&&Number.isNaN(d))&&!(g&&(isNaN(u)?u+""==d+"":+u==+d))&&i.push({path:[h],type:"CHANGE",value:d,oldValue:u})}const a=Array.isArray(e);for(const c in e)c in r||i.push({type:"CREATE",path:[a?+c:c],value:e[c]});return i}var _f=Symbol.for("immer-nothing"),aa=Symbol.for("immer-draftable"),br=Symbol.for("immer-state"),Ew=process.env.NODE_ENV!=="production"?[function(r){return`The plugin for '${r}' has not been loaded into Immer. To enable the plugin, import and call \`enable${r}()\` when initializing your application.`},function(r){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${r}'`},"This object has been frozen and should not be mutated",function(r){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+r},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(r){return`'current' expects a draft, got: ${r}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(r){return`'original' expects a draft, got: ${r}`}]:[];function Mt(r,...e){if(process.env.NODE_ENV!=="production"){const t=Ew[r],n=typeof t=="function"?t.apply(null,e):t;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var Zi=Object.getPrototypeOf;function Ji(r){return!!r&&!!r[br]}function fi(r){return r?kw(r)||Array.isArray(r)||!!r[aa]||!!r.constructor?.[aa]||ua(r)||ha(r):!1}var sD=Object.prototype.constructor.toString();function kw(r){if(!r||typeof r!="object")return!1;const e=Zi(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===sD}function ca(r,e){Qi(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,n)=>e(n,t,r))}function Qi(r){const e=r[br];return e?e.type_:Array.isArray(r)?1:ua(r)?2:ha(r)?3:0}function la(r,e){return Qi(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function Sf(r,e){return Qi(r)===2?r.get(e):r[e]}function Iw(r,e,t){const n=Qi(r);n===2?r.set(e,t):n===3?r.add(t):r[e]=t}function oD(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function ua(r){return r instanceof Map}function ha(r){return r instanceof Set}function es(r){return r.copy_||r.base_}function Cf(r,e){if(ua(r))return new Map(r);if(ha(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=kw(r);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(r);delete n[br];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const a=i[s],c=n[a];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[a]={configurable:!0,writable:!0,enumerable:c.enumerable,value:r[a]})}return Object.create(Zi(r),n)}else{const n=Zi(r);if(n!==null&&t)return{...r};const i=Object.create(n);return Object.assign(i,r)}}function Tf(r,e=!1){return Tl(r)||Ji(r)||!fi(r)||(Qi(r)>1&&(r.set=r.add=r.clear=r.delete=aD),Object.freeze(r),e&&Object.entries(r).forEach(([t,n])=>Tf(n,!0))),r}function aD(){Mt(2)}function Tl(r){return Object.isFrozen(r)}var Ef={};function ts(r){const e=Ef[r];return e||Mt(0,r),e}function cD(r,e){Ef[r]||(Ef[r]=e)}var da;function Aw(){return da}function lD(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Mw(r,e){e&&(ts("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function kf(r){If(r),r.drafts_.forEach(uD),r.drafts_=null}function If(r){r===da&&(da=r.parent_)}function Ow(r){return da=lD(da,r)}function uD(r){const e=r[br];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Pw(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[br].modified_&&(kf(e),Mt(4)),fi(r)&&(r=El(e,r),e.parent_||kl(e,r)),e.patches_&&ts("Patches").generateReplacementPatches_(t[br].base_,r,e.patches_,e.inversePatches_)):r=El(e,t,[]),kf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==_f?r:void 0}function El(r,e,t){if(Tl(e))return e;const n=e[br];if(!n)return ca(e,(i,s)=>Dw(r,n,e,i,s,t)),e;if(n.scope_!==r)return e;if(!n.modified_)return kl(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let s=i,a=!1;n.type_===3&&(s=new Set(i),i.clear(),a=!0),ca(s,(c,u)=>Dw(r,n,i,c,u,t,a)),kl(r,i,!1),t&&r.patches_&&ts("Patches").generatePatches_(n,t,r.patches_,r.inversePatches_)}return n.copy_}function Dw(r,e,t,n,i,s,a){if(process.env.NODE_ENV!=="production"&&i===t&&Mt(5),Ji(i)){const c=s&&e&&e.type_!==3&&!la(e.assigned_,n)?s.concat(n):void 0,u=El(r,i,c);if(Iw(t,n,u),Ji(u))r.canAutoFreeze_=!1;else return}else a&&t.add(i);if(fi(i)&&!Tl(i)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;El(r,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&kl(r,i)}}function kl(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&Tf(e,t)}function hD(r,e){const t=Array.isArray(r),n={type_:t?1:0,scope_:e?e.scope_:Aw(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=Af;t&&(i=[n],s=fa);const{revoke:a,proxy:c}=Proxy.revocable(i,s);return n.draft_=c,n.revoke_=a,c}var Af={get(r,e){if(e===br)return r;const t=es(r);if(!la(t,e))return dD(r,t,e);const n=t[e];return r.finalized_||!fi(n)?n:n===Mf(r.base_,e)?(Pf(r),r.copy_[e]=Df(n,r)):n},has(r,e){return e in es(r)},ownKeys(r){return Reflect.ownKeys(es(r))},set(r,e,t){const n=jw(es(r),e);if(n?.set)return n.set.call(r.draft_,t),!0;if(!r.modified_){const i=Mf(es(r),e),s=i?.[br];if(s&&s.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(oD(t,i)&&(t!==void 0||la(r.base_,e)))return!0;Pf(r),Of(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return Mf(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,Pf(r),Of(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=es(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){Mt(11)},getPrototypeOf(r){return Zi(r.base_)},setPrototypeOf(){Mt(12)}},fa={};ca(Af,(r,e)=>{fa[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),fa.deleteProperty=function(r,e){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(e))&&Mt(13),fa.set.call(this,r,e,void 0)},fa.set=function(r,e,t){return process.env.NODE_ENV!=="production"&&e!=="length"&&isNaN(parseInt(e))&&Mt(14),Af.set.call(this,r[0],e,t,r[0])};function Mf(r,e){const t=r[br];return(t?es(t):r)[e]}function dD(r,e,t){const n=jw(e,t);return n?"value"in n?n.value:n.get?.call(r.draft_):void 0}function jw(r,e){if(!(e in r))return;let t=Zi(r);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=Zi(t)}}function Of(r){r.modified_||(r.modified_=!0,r.parent_&&Of(r.parent_))}function Pf(r){r.copy_||(r.copy_=Cf(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var fD=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(u=s,...h){return a.produce(u,d=>t.call(this,d,...h))}}typeof t!="function"&&Mt(6),n!==void 0&&typeof n!="function"&&Mt(7);let i;if(fi(e)){const s=Ow(this),a=Df(e,void 0);let c=!0;try{i=t(a),c=!1}finally{c?kf(s):If(s)}return Mw(s,n),Pw(i,s)}else if(!e||typeof e!="object"){if(i=t(e),i===void 0&&(i=e),i===_f&&(i=void 0),this.autoFreeze_&&Tf(i,!0),n){const s=[],a=[];ts("Patches").generateReplacementPatches_(e,i,s,a),n(s,a)}return i}else Mt(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...c)=>this.produceWithPatches(a,u=>e(u,...c));let n,i;return[this.produce(e,t,(a,c)=>{n=a,i=c}),n,i]},typeof r?.autoFreeze=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof r?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){fi(r)||Mt(8),Ji(r)&&(r=gD(r));const e=Ow(this),t=Df(r,void 0);return t[br].isManual_=!0,If(e),t}finishDraft(r,e){const t=r&&r[br];(!t||!t.isManual_)&&Mt(9);const{scope_:n}=t;return Mw(n,e),Pw(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const i=e[t];if(i.path.length===0&&i.op==="replace"){r=i.value;break}}t>-1&&(e=e.slice(t+1));const n=ts("Patches").applyPatches_;return Ji(r)?n(r,e):this.produce(r,i=>n(i,e))}};function Df(r,e){const t=ua(r)?ts("MapSet").proxyMap_(r,e):ha(r)?ts("MapSet").proxySet_(r,e):hD(r,e);return(e?e.scope_:Aw()).drafts_.push(t),t}function gD(r){return Ji(r)||Mt(10,r),Lw(r)}function Lw(r){if(!fi(r)||Tl(r))return r;const e=r[br];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Cf(r,e.scope_.immer_.useStrictShallowCopy_)}else t=Cf(r,!0);return ca(t,(n,i)=>{Iw(t,n,Lw(i))}),e&&(e.finalized_=!1),t}function Fw(){process.env.NODE_ENV!=="production"&&Ew.push('Sets cannot have "replace" patches.',function(p){return"Unsupported patch operation: "+p},function(p){return"Cannot apply patch, path doesn't resolve: "+p},"Patching reserved attributes like __proto__, prototype and constructor is not allowed");const e="replace",t="add",n="remove";function i(p,y,w,_){switch(p.type_){case 0:case 2:return a(p,y,w,_);case 1:return s(p,y,w,_);case 3:return c(p,y,w,_)}}function s(p,y,w,_){let{base_:S,assigned_:T}=p,k=p.copy_;k.length<S.length&&([S,k]=[k,S],[w,_]=[_,w]);for(let I=0;I<S.length;I++)if(T[I]&&k[I]!==S[I]){const M=y.concat([I]);w.push({op:e,path:M,value:g(k[I])}),_.push({op:e,path:M,value:g(S[I])})}for(let I=S.length;I<k.length;I++){const M=y.concat([I]);w.push({op:t,path:M,value:g(k[I])})}for(let I=k.length-1;S.length<=I;--I){const M=y.concat([I]);_.push({op:n,path:M})}}function a(p,y,w,_){const{base_:S,copy_:T}=p;ca(p.assigned_,(k,I)=>{const M=Sf(S,k),L=Sf(T,k),N=I?la(S,k)?e:t:n;if(M===L&&N===e)return;const H=y.concat(k);w.push(N===n?{op:N,path:H}:{op:N,path:H,value:L}),_.push(N===t?{op:n,path:H}:N===n?{op:t,path:H,value:g(M)}:{op:e,path:H,value:g(M)})})}function c(p,y,w,_){let{base_:S,copy_:T}=p,k=0;S.forEach(I=>{if(!T.has(I)){const M=y.concat([k]);w.push({op:n,path:M,value:I}),_.unshift({op:t,path:M,value:I})}k++}),k=0,T.forEach(I=>{if(!S.has(I)){const M=y.concat([k]);w.push({op:t,path:M,value:I}),_.unshift({op:n,path:M,value:I})}k++})}function u(p,y,w,_){w.push({op:e,path:[],value:y===_f?void 0:y}),_.push({op:e,path:[],value:p})}function h(p,y){return y.forEach(w=>{const{path:_,op:S}=w;let T=p;for(let L=0;L<_.length-1;L++){const N=Qi(T);let H=_[L];typeof H!="string"&&typeof H!="number"&&(H=""+H),(N===0||N===1)&&(H==="__proto__"||H==="constructor")&&Mt(19),typeof T=="function"&&H==="prototype"&&Mt(19),T=Sf(T,H),typeof T!="object"&&Mt(18,_.join("/"))}const k=Qi(T),I=d(w.value),M=_[_.length-1];switch(S){case e:switch(k){case 2:return T.set(M,I);case 3:Mt(16);default:return T[M]=I}case t:switch(k){case 1:return M==="-"?T.push(I):T.splice(M,0,I);case 2:return T.set(M,I);case 3:return T.add(I);default:return T[M]=I}case n:switch(k){case 1:return T.splice(M,1);case 2:return T.delete(M);case 3:return T.delete(w.value);default:return delete T[M]}default:Mt(17,S)}}),p}function d(p){if(!fi(p))return p;if(Array.isArray(p))return p.map(d);if(ua(p))return new Map(Array.from(p.entries()).map(([w,_])=>[w,d(_)]));if(ha(p))return new Set(Array.from(p).map(d));const y=Object.create(Zi(p));for(const w in p)y[w]=d(p[w]);return la(p,aa)&&(y[aa]=p[aa]),y}function g(p){return Ji(p)?d(p):p}cD("Patches",{applyPatches_:h,generatePatches_:i,generateReplacementPatches_:u})}var wr=new fD,pD=wr.produce;wr.produceWithPatches.bind(wr),wr.setAutoFreeze.bind(wr),wr.setUseStrictShallowCopy.bind(wr);var mD=wr.applyPatches.bind(wr);wr.createDraft.bind(wr),wr.finishDraft.bind(wr);function vD(r){const e=r.value,t=[];if(e?.payload?.trackItemIds){const n=e.payload.trackItemIds;t.push(n),this.updateState({activeIds:t})}if(r.key===Yu){const n=r.value?.payload.trackItemIds,i=He.cloneDeep(this.getState()),s=n?.length?n:i.activeIds,a=i.trackItemIds.filter(g=>!s.includes(g)),c=Object.fromEntries(Object.entries(i.trackItemDetailsMap).filter(([g])=>!s.includes(g))),u=bb(i.tracks,s),h=Object.fromEntries(Object.entries(i.trackItemsMap).filter(([g])=>!s.includes(g))),d=tn(h);this.updateState({trackItemIds:a,trackItemDetailsMap:c,activeIds:[],trackItemsMap:h,tracks:u,duration:d},{updateHistory:!0,kind:"remove"})}if(r.key===Xu){const n=He.cloneDeep(this.getState()),i=[],s=r.value?.payload.trackItemIds||n.activeIds;if(s.length===0)return;s.forEach(c=>{const u=n.trackItemsMap[c],h=n.trackItemDetailsMap[c],d=kt();i.push(d),n.trackItemsMap={...n.trackItemsMap,[d]:{...He.cloneDeep(u),id:d}},n.trackItemDetailsMap={...n.trackItemDetailsMap,[d]:{...He.cloneDeep(h)}},n.trackItemIds.push(d)});const a=n.tracks.map(c=>{const u={...c,id:kt(),items:c.items.filter(h=>s.includes(h)).map(h=>{const d=s.indexOf(h);return i[d]})};return u.items.length?u:null}).filter(Boolean);n.tracks.unshift(...a),this.updateState({trackItemDetailsMap:n.trackItemDetailsMap,tracks:n.tracks,trackItemIds:n.trackItemIds,trackItemsMap:n.trackItemsMap},{updateHistory:!0,kind:"update"})}if(r.key===Gu){const n=He.cloneDeep(this.getState()),i=r.value?.options.time;if(n.activeIds.length!==1)return;const s=n.activeIds[0],a=n.trackItemsMap[s];if(i<=a.display.from||i>=a.display.to)return;const c=kt(),u={...a,id:c,display:{from:i,to:a.display.to},trim:{from:i,to:a.display.to}};n.trackItemsMap[s].display.to=i,n.trackItemsMap[c]=u,n.trackItemDetailsMap[c]=n.trackItemDetailsMap[s],n.trackItemIds.push(c),n.tracks.forEach(h=>{h.items.includes(s)&&h.items.push(c)}),this.updateState({trackItemsMap:n.trackItemsMap,trackItemDetailsMap:n.trackItemDetailsMap,trackItemIds:n.trackItemIds,tracks:n.tracks},{updateHistory:!0,kind:"update"})}}async function yD(r){if(r.key==="scene:load"){const e=r.value?.payload,t=e.size,n=e.trackItemIds,i=e.trackItemsMap,s=e.trackItemDetailsMap;if(!n)return;const a=n?.map(async u=>{try{const h=s[u],d=i[u];if(h.type==="text"){const g=await uf({id:u,details:h.details,...d},{size:t}),{details:p,...y}=g;s[u]={type:"text",details:p},i[u]=y}return!0}catch{return!1}});await Promise.all(a);const c=tn(i);this.updateState({...e,trackItemsMap:i,duration:c})}}async function bD(r){const e=He.cloneDeep(this.getState()),t=r.value?.options?.trackId,n=r.value?.options?.trackIndex;let i=[],s;if(r.key===ys){s="video";const c=await xb(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:s,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),i=[h.id]}if(r.key===ws){s="image";const c=await wb(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:s,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),i=[h.id]}if(r.key===bs){s="audio";const c=await _b(r.value?.payload),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:s,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),i=[h.id]}if(r.key===Wu){s="text";const{details:c,...u}=await uf(r.value?.payload??void 0,{size:e.size});e.trackItemDetailsMap[u.id]={type:s,details:c},e.trackItemsMap[u.id]=u,e.trackItemIds.push(u.id),i.push(u.id)}const a=wD(i,e.tracks,e.trackItemsMap,t,n);if(a.trackId)e.tracks.find(u=>u.id===a.trackId)?.items.push(...i);else if(a.trackIndex!==void 0){const c=Nw(s,i);e.tracks.splice(a.trackIndex,0,c)}else{const c=Nw(s,i);e.tracks.unshift(c)}e.duration=tn(e.trackItemsMap),this.updateState({trackItemIds:e.trackItemIds,trackItemDetailsMap:e.trackItemDetailsMap,trackItemsMap:e.trackItemsMap,tracks:e.tracks,duration:e.duration,structure:e.structure},{updateHistory:!0,kind:"add"})}function Nw(r,e){return{id:kt(),accepts:["text","audio","helper","video","image"],type:r,items:e,magnetic:!1,static:!1}}const wD=(r,e,t,n,i)=>{if(n===void 0&&i===void 0)return{trackId:void 0,trackIndex:void 0};const s=i!==void 0?e[Math.max(0,Math.min(i,e.length-1))]:e.find(u=>u.id===n);if(!s)return{trackId:void 0,trackIndex:i!==void 0?Math.max(0,Math.min(i,e.length-1)):void 0};const a=s.items.map(u=>t[u]),c=r.map(u=>t[u]);for(const u of a){const h=u.display.from,d=u.display.to;for(const g of c){const p=g.display.from;if(!(g.display.to<=h||p>=d))return{trackId:void 0,trackIndex:e.indexOf(s)}}}return{trackId:s.id,trackIndex:e.indexOf(s)}},Rw=["tracks","trackItemsMap","trackItemDetailsMap","transitionIds","transitionsMap","trackItemIds"],xD={size:{width:1080,height:1920},tracks:[],trackItemIds:[],trackItemsMap:{},transitionIds:[],transitionsMap:{},scale:{unit:1,zoom:1,segments:1,index:1},duration:0,activeIds:[],trackItemDetailsMap:{},structure:[]};class Vw{stateSubject;stateHistorySubject;prevState;undos;redos;listener;constructor(e){this.stateSubject=null,this.stateHistorySubject=null,this.prevState=null,this.undos=[],this.redos=[],this.listener=null;const t=e||xD;this.stateSubject=new Tm(t),this.stateHistorySubject=new Tm({handleRedo:!1,handleUndo:!1}),this.prevState=t,this.initListeners()}initListeners(){Bw(this)}destroyListeners(){this.listener&&this.listener.unsubscribe()}purge(){this.destroyListeners()}updateHistory(e,t){const n=He.pick(e,Rw),i=He.pick(this.getState(),Rw),s=Tw(i,n);s.length&&(this.undos.push({undos:s,type:t}),this.redos=[])}getStateHistory(){return this.stateHistorySubject.getValue()}subscribeHistory(e){return this.stateHistorySubject.subscribe(e)}getState(){return this.stateSubject.getValue()}subscribe(e){return this.stateSubject.subscribe(e)}updateState(e,t={updateHistory:!1,kind:void 0}){const n=this.getState(),i={...n,...e};if(!He.isEqual(n,i)){t.updateHistory&&this.updateHistory(i,t.kind);const{duration:s,trackItemsMap:a,...c}=n;this.prevState={...c,duration:this.prevState.duration,trackItemsMap:this.prevState.trackItemsMap},this.stateSubject.next(i)}}subscribeToSize(e){return this.stateSubject.asObservable().subscribe(t=>{He.isEqual(t.size,this.prevState.size)||e({size:t.size})})}subscribeToScale(e){return this.stateSubject.asObservable().subscribe(t=>{He.isEqual(t.scale,this.prevState.scale)||e({scale:t.scale})})}subscribeToUpdateTrackItem(e){return this.stateSubject.asObservable().subscribe(t=>{He.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||e({trackItemsMap:t.trackItemsMap})})}subscribeToUpdateItemDetails(e){return this.stateSubject.asObservable().subscribe(t=>{He.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap)||e({trackItemDetailsMap:t.trackItemDetailsMap})})}subscribeToDuration(e){return this.stateSubject.asObservable().subscribe(t=>{t.duration!==this.prevState.duration&&e({duration:t.duration})})}subscribeToHistory(e){return this.stateHistorySubject.asObservable().subscribe(t=>{if(t.handleRedo){const n=this.undos[this.undos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}if(t.handleUndo){const n=this.redos[this.redos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}})}subscribeToAddOrRemoveItems(e){return this.stateSubject.asObservable().subscribe(t=>{(!t.trackItemIds?.every(n=>this.prevState.trackItemIds?.includes(n))||!He.isEqual(t.tracks,this.prevState.tracks))&&e({trackItemIds:t.trackItemIds})})}subscribeToActiveIds(e){return this.stateSubject.asObservable().subscribe(t=>{He.isEqual(t.activeIds,this.prevState.activeIds)||e({activeIds:t.activeIds})})}subscribeToTracks(e){return this.stateSubject.asObservable().subscribe(t=>{(!He.isEqual(t.tracks,this.prevState.tracks)||!He.isEqual(t.trackItemIds,this.prevState.trackItemIds)||!He.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||!He.isEqual(t.transitionIds,this.prevState.transitionIds)||!He.isEqual(t.transitionsMap,this.prevState.transitionsMap)||!He.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap))&&e({tracks:t.tracks,trackItemIds:t.trackItemIds,trackItemsMap:t.trackItemsMap,transitionIds:t.transitionIds,transitionsMap:t.transitionsMap,trackItemDetailsMap:t.trackItemDetailsMap})})}undo(){const e=this.undos.pop(),t=e?.undos,n=e?.type;if(!t||!n)return;Fw();const{trackItemDetailsMap:i,trackItemIds:s,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}=this.getState(),d=He.cloneDeep({trackItemDetailsMap:i,trackItemIds:s,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}),g=[],p=[],y=[],w=[],_=[],S=[];t.forEach($=>{let G;const re=$.path.slice(1);$.type==="CREATE"?G={path:re,op:"remove",value:$.value}:$.type==="CHANGE"?G={path:re,op:"replace",value:$.oldValue}:G={path:re,op:"add",value:$.oldValue},$.path.includes("trackItemIds")?y.push(G):$.path.includes("transitionIds")?p.push(G):$.path.includes("trackItemsMap")?_.push(G):$.path.includes("transitionsMap")?w.push(G):$.path.includes("tracks")?g.push(G):$.path.includes("trackItemDetailsMap")&&S.push(G)});const T=this.applyPatch(d.tracks,g),k=this.applyPatch(d.transitionIds,p),I=this.applyPatch(d.trackItemIds,y),M=this.applyPatch(d.transitionsMap,w),L=this.applyPatch(d.trackItemsMap,_),N=this.applyPatch(d.trackItemDetailsMap,S),H=He.cloneDeep({tracks:T,transitionIds:k,trackItemIds:I,transitionsMap:M,trackItemsMap:L,trackItemDetailsMap:N}),R=He.cloneDeep(this.getState()),X={...R,...H};this.prevState=R;const U={redos:t,type:n};this.redos.push(U);const K=tn(X.trackItemsMap);this.stateSubject.next({...X,duration:K}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!0})}redo(){const e=this.redos.pop();if(!e?.redos||!e?.type)return;Fw();const t=this.getState(),{trackItemDetailsMap:n,trackItemIds:i,tracks:s,transitionIds:a,transitionsMap:c,trackItemsMap:u}=t,h=He.cloneDeep({trackItemDetailsMap:n,trackItemIds:i,tracks:s,transitionIds:a,transitionsMap:c,trackItemsMap:u}),d=[],g=[],p=[],y=[],w=[],_=[];e.redos.forEach(M=>{const L=M.path.slice(1);let N={};switch(M.type){case"CREATE":N={path:L,op:"add",value:M.value};break;case"CHANGE":N={path:L,op:"replace",value:M.value};break;case"REMOVE":N={path:L,op:"remove",value:M.oldValue};break;default:return null}M.path.includes("trackItemIds")?p.push(N):M.path.includes("transitionIds")?g.push(N):M.path.includes("trackItemsMap")?w.push(N):M.path.includes("transitionsMap")?y.push(N):M.path.includes("trackItemDetailsMap")?_.push(N):d.push(N)});const S={tracks:this.applyPatch(h.tracks,d),transitionIds:this.applyPatch(h.transitionIds,g),trackItemIds:this.applyPatch(h.trackItemIds,p),transitionsMap:this.applyPatch(h.transitionsMap,y),trackItemsMap:this.applyPatch(h.trackItemsMap,w),trackItemDetailsMap:this.applyPatch(h.trackItemDetailsMap,_)},T=He.cloneDeep(S),k={...He.cloneDeep(t),...T};this.prevState=t,this.undos.push({undos:e.redos,type:e.type});const I=tn(k.trackItemsMap);this.stateSubject.next({...k,duration:I}),this.stateHistorySubject.next({handleRedo:!0,handleUndo:!1})}applyPatch(e,t){return t.reverse().reduce((n,i)=>pD(n,s=>{mD(s,[i])}),e)}}function Bw(r){const e=je.subject.pipe(Cn(({key:s})=>s.startsWith(fm))).subscribe(s=>{s.key===Ku&&r.undo(),s.key===Zu&&r.redo()}),t=je.subject.pipe(Cn(({key:s,value:a})=>s.startsWith(om))).subscribe(s=>{bD.bind(r)(s)}),n=je.subject.pipe(Cn(({key:s,value:a})=>s.startsWith("scene"))).subscribe(async s=>{await yD.bind(r)(s)}),i=je.subject.pipe(Cn(({key:s})=>s.startsWith(hm))).subscribe(async s=>{vD.bind(r)(s)});return()=>{e.unsubscribe(),t.unsubscribe(),i.unsubscribe(),n.unsubscribe()}}const zw=()=>{const{playerRef:r,fps:e,timeline:t,setState:n}=hn();v.useEffect(()=>{const s=je.subject.pipe(Cn(({key:a})=>a.startsWith(am))).subscribe(a=>{if(a.key===cm){const{time:c}=a.value?.payload;r?.current?.seekTo(c/1e3*e)}else if(a.key===Uu)r?.current?.play();else if(a.key===$u)r?.current?.pause();else if(a.key===um)r?.current?.isPlaying()?r.current.pause():r?.current?.play();else if(a.key===lm){const{frames:c}=a.value?.payload;r?.current?.seekTo(Math.round(r.current.getCurrentFrame())+c)}});return()=>{s.unsubscribe()}},[r,e]),v.useEffect(()=>{const s=je.subject.pipe(Cn(({key:a})=>a.startsWith(dm))).subscribe(a=>{a.key===qu&&n({activeIds:a.value?.payload.activeIds})});return()=>{s.unsubscribe()}},[t])},_D=new Vw,SD=()=>{const{playerRef:r}=hn();zw();const[e,t]=v.useState([]);return b.jsxs("div",{className:"relative flex h-screen w-screen flex-col bg-background ",children:[b.jsx(o0,{}),b.jsxs("div",{style:{width:"100%",height:"100%",position:"relative",flex:1,overflow:"hidden"},children:[b.jsx(QE,{}),b.jsx(s0,{}),b.jsx(Hv,{})]}),b.jsx("div",{className:"h-70 w-full ",children:r&&b.jsx(Cw,{stateManager:_D})})]})};A.ACTIVE_CLONE=Xu,A.ACTIVE_DELETE=Yu,A.ACTIVE_PASTE=EC,A.ACTIVE_PREFIX=hm,A.ACTIVE_SET=TC,A.ACTIVE_SPLIT=Gu,A.ADD_ANIMATION=yC,A.ADD_AUDIO=bs,A.ADD_IMAGE=ws,A.ADD_MASK=mC,A.ADD_PLACEHOLDER=pC,A.ADD_PREFIX=om,A.ADD_SUFFIX=cC,A.ADD_TEXT=Wu,A.ADD_TRANSITION=vC,A.ADD_VIDEO=ys,A.AUDIOS=t0,A.AppComponent=SD,A.Audio=Ab,A.AudioObject=Rn,A.BASE_TIMELINE_ELEMENT_DURATION_MS=mT,A.Button=st,A.CanvasMixin=ib,A.DEFAULT_AUDIO_BITRATE=wT,A.DEFAULT_AUDIO_SAMPLE_RATE=bT,A.DEFAULT_BLUR=aE,A.DEFAULT_BLUR_STEP=oE,A.DEFAULT_BRIGHTNESS=zT,A.DEFAULT_BRIGHTNESS_STEP=BT,A.DEFAULT_CONTRAST=QT,A.DEFAULT_CONTRAST_STEP=JT,A.DEFAULT_FADE_IN=MT,A.DEFAULT_FADE_OUT=OT,A.DEFAULT_FADE_STEP=AT,A.DEFAULT_FLIP_X=FT,A.DEFAULT_FLIP_Y=NT,A.DEFAULT_FONT=mh,A.DEFAULT_FRAMERATE=jm,A.DEFAULT_MAX_BLUR=sE,A.DEFAULT_MAX_BRIGHTNESS=VT,A.DEFAULT_MAX_CONTRAST=ZT,A.DEFAULT_MAX_FADE=IT,A.DEFAULT_MAX_OPACITY=tE,A.DEFAULT_MAX_ROTATION=DT,A.DEFAULT_MAX_SATURATION=WT,A.DEFAULT_MAX_SPEED=lE,A.DEFAULT_MAX_TEMPERATURE=XT,A.DEFAULT_MAX_VOLUME=fE,A.DEFAULT_MEDIA_PANEL_WIDTH=CT,A.DEFAULT_MIN_BLUR=iE,A.DEFAULT_MIN_BRIGHTNESS=RT,A.DEFAULT_MIN_CONTRAST=KT,A.DEFAULT_MIN_FADE=kT,A.DEFAULT_MIN_OPACITY=eE,A.DEFAULT_MIN_ROTATION=PT,A.DEFAULT_MIN_SATURATION=HT,A.DEFAULT_MIN_SPEED=cE,A.DEFAULT_MIN_TEMPERATURE=YT,A.DEFAULT_MIN_VOLUME=dE,A.DEFAULT_OPACITY=nE,A.DEFAULT_OPACITY_STEP=rE,A.DEFAULT_PREVIEW_HEIGHT=_T,A.DEFAULT_PREVIEW_SCALE=hh,A.DEFAULT_PREVIEW_WIDTH=xT,A.DEFAULT_ROTATION=LT,A.DEFAULT_ROTATION_STEP=jT,A.DEFAULT_SATURATION=$T,A.DEFAULT_SATURATION_STEP=UT,A.DEFAULT_SETTINGS_PANEL_WIDTH=ET,A.DEFAULT_SPEED=hE,A.DEFAULT_SPEED_STEP=uE,A.DEFAULT_TEMPERATURE=qT,A.DEFAULT_TEMPERATURE_STEP=GT,A.DEFAULT_VIDEO_HEIGHT=Dm,A.DEFAULT_VIDEO_MAX_BITRATE=yT,A.DEFAULT_VIDEO_MIN_BITRATE=vT,A.DEFAULT_VIDEO_WIDTH=Pm,A.DEFAULT_VOLUME=pE,A.DEFAULT_VOLUME_STEP=gE,A.DEFAULT_WEIGHT=pT,A.DRAG_END=xo,A.DRAG_PREFIX=pm,A.DRAG_START=Qu,A.Draggable=wo,A.DroppableArea=Am,A.EDIT_OBJECT=wC,A.EDIT_PREFIX=bC,A.EDIT_SHAPE=_C,A.EDIT_TEXT=xC,A.ENTER_EDIT_MODE=SC,A.FRAME_INTERVAL=Lm,A.GIANT_ICON_SIZE=cT,A.HISTORY_PREFIX=fm,A.HISTORY_REDO=Zu,A.HISTORY_RESET=BC,A.HISTORY_UNDO=Ku,A.Header=e0,A.Helper=Db,A.HelperObject=Xs,A.IMAGES=r0,A.Image=Ob,A.ImageObject=ml,A.LARGER_FONT_SIZE=dT,A.LARGE_FONT_SIZE=fT,A.LARGE_ICON_SIZE=lT,A.LAYER_CLONE=FC,A.LAYER_COPY=jC,A.LAYER_CUT=RC,A.LAYER_DELETE=VC,A.LAYER_EDITING_NAME=DC,A.LAYER_HIDDEN=IC,A.LAYER_LOCKED=kC,A.LAYER_MOVE=AC,A.LAYER_PASTE=LC,A.LAYER_PREFIX=dm,A.LAYER_RENAME=PC,A.LAYER_SELECT=MC,A.LAYER_SELECTION=qu,A.LAYER_SEND_TO=OC,A.LAYER_SPLIT=NC,A.MAX_MEDIA_PANEL_WIDTH=TT,A.MIN_MEDIA_PANEL_WIDTH=ST,A.MenuItem=s0,A.NORMAL_FONT_SIZE=gT,A.NORMAL_ICON_SIZE=uT,A.NavbarComponent=o0,A.PLAYER_PAUSE=$u,A.PLAYER_PLAY=Uu,A.PLAYER_PREFIX=am,A.PLAYER_SEEK=cm,A.PLAYER_SEEK_BY=lm,A.PLAYER_SEEK_TO=CC,A.PLAYER_TOGGLE_PLAY=um,A.PREVIEW_FRAME_WIDTH=_o,A.Placeholder=Ys,A.Player=Vv,A.PlayheadComponent=Bv,A.PreviewTrackItem=ra,A.RulerComponent=zv,A.SECONDARY_FONT=Om,A.SMALL_FONT_SIZE=Mm,A.SMALL_ICON_SIZE=hT,A.STATE_CHANGED=gC,A.STATE_PREFIX=fC,A.Scene=Hv,A.SceneBoard=aT,A.ScrollArea=Ci,A.ScrollBar=Nu,A.SequenceItem=Dv,A.Slider=Cp,A.StateManager=Vw,A.TIMELINE_BOUNDING_CHANGED=eh,A.TIMELINE_OFFSET_CANVAS_LEFT=Xa,A.TIMELINE_OFFSET_CANVAS_RIGHT=dh,A.TIMELINE_OFFSET_X=Ya,A.TIMELINE_PREFIX=mm,A.TIMELINE_SCALE_CHANGED=Ju,A.TIMELINE_SCALE_PREFIX=gm,A.TIMELINE_ZOOM_LEVELS=Yr,A.TRACKS_CHANGED=hC,A.TRACK_ITEMS_CHANGED=dC,A.TRACK_ITEMS_PREFIX=uC,A.TRACK_PREFIX=lC,A.TRANSITIONS=i0,A.Tabs=sm,A.TabsContent=Ha,A.TabsList=Hu,A.TabsTrigger=za,A.Text=hf,A.TextObject=Xi,A.Timeline=Cl,A.TimelineComponent=Cw,A.Track=Pb,A.TrackItemsMixin=jb,A.TrackObject=hi,A.TracksMixin=Fb,A.Transition=Nr,A.TransitionGuide=ta,A.TransitionsMixin=Rb,A.UPLOADS=BE,A.VIDEOS=n0,A.Video=Mb,A.VideoObject=Gi,A.addEventListeners=xw,A.applyMixins=fb,A.buttonVariants=cp,A.calculateDisplayRange=yb,A.calculateDuration=tn,A.calculatePosition=vl,A.calculateTimelineWidth=$m,A.calculateTrim=vb,A.cn=Ht,A.createAudioControls=lb,A.createControls=hb,A.createMediaControls=ab,A.createResizeControls=of,A.defaultColor=Qo,A.defaultSizes=kb,A.filterAndCleanTracks=bb,A.findIndex=fh,A.formatBytes=sS,A.formatTimeToHumanReadable=mE,A.formatTimelineUnit=Fm,A.frameToTimeString=Nm,A.getCurrentTime=Vm,A.getFitZoomLevel=vE,A.getMovingState=b3,A.getNextZoom=Hm,A.getNextZoomIndex=Um,A.getNextZoomLevel=Wm,A.getOffset=Pe,A.getPreviousZoom=zm,A.getPreviousZoomIndex=bE,A.getPreviousZoomLevel=Bm,A.getTextHeight=na,A.getZoomByIndex=yE,A.handleEvents=Sw,A.handleResize=Jo,A.loadAudio=gb,A.loadAudioItem=_b,A.loadAudioObject=Sb,A.loadFonts=Ym,A.loadImage=pb,A.loadImageItem=wb,A.loadImageObject=Cb,A.loadTextItem=uf,A.loadTextObject=Eb,A.loadVideo=mb,A.loadVideoItem=xb,A.loadVideoObject=Tb,A.mergeSizes=Ib,A.mergeTrackObjects=gh,A.movingState=te,A.positionOffsets=sb,A.randomInt=wE,A.removeEventListeners=_w,A.removeItemsFromTrack=So,A.renderControl=Nn,A.reorderTracksByIndex=ph,A.setupHistoryListeners=Bw,A.timeMsToUnits=bt,A.timeToString=Rm,A.transitionStore=vt,A.unitsToTimeMs=Zn,A.updateMovingState=w3,A.useCurrentPlayerFrame=Ga,A.useIsDraggingOverTimeline=Co,A.useLayoutStore=qa,A.useStore=hn,A.useTimelineEvents=zw,A.wrapResizeWithAnchorPosition=lf,Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})});
