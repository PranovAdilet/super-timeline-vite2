"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const v=require("react"),ld=require("react-dom");function NI(r){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(r){for(const t in r)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return e.default=r,Object.freeze(e)}const H=NI(v);var Ao=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function VI(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ud={exports:{}},Oo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _v;function BI(){if(_v)return Oo;_v=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var c in s)c!=="key"&&(i[c]=s[c])}else i=s;return s=i.ref,{$$typeof:r,type:n,key:a,ref:s!==void 0?s:null,props:i}}return Oo.Fragment=e,Oo.jsx=t,Oo.jsxs=t,Oo}var Mo={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv;function zI(){return Sv||(Sv=1,process.env.NODE_ENV!=="production"&&function(){function r(M){if(M==null)return null;if(typeof M=="function")return M.$$typeof===ie?null:M.displayName||M.name||null;if(typeof M=="string")return M;switch(M){case L:return"Fragment";case D:return"Portal";case F:return"Profiler";case z:return"StrictMode";case U:return"Suspense";case X:return"SuspenseList"}if(typeof M=="object")switch(typeof M.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),M.$$typeof){case W:return(M.displayName||"Context")+".Provider";case Y:return(M._context.displayName||"Context")+".Consumer";case q:var ce=M.render;return M=M.displayName,M||(M=ce.displayName||ce.name||"",M=M!==""?"ForwardRef("+M+")":"ForwardRef"),M;case te:return ce=M.displayName||null,ce!==null?ce:r(M.type)||"Memo";case de:ce=M._payload,M=M._init;try{return r(M(ce))}catch{}}return null}function e(M){return""+M}function t(M){try{e(M);var ce=!1}catch{ce=!0}if(ce){ce=console;var ae=ce.error,Ae=typeof Symbol=="function"&&Symbol.toStringTag&&M[Symbol.toStringTag]||M.constructor.name||"Object";return ae.call(ce,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",Ae),e(M)}}function n(){}function s(){if(Le===0){we=console.log,Se=console.info,at=console.warn,nr=console.error,jt=console.group,Tt=console.groupCollapsed,sr=console.groupEnd;var M={configurable:!0,enumerable:!0,value:n,writable:!0};Object.defineProperties(console,{info:M,log:M,warn:M,error:M,group:M,groupCollapsed:M,groupEnd:M})}Le++}function i(){if(Le--,Le===0){var M={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:re({},M,{value:we}),info:re({},M,{value:Se}),warn:re({},M,{value:at}),error:re({},M,{value:nr}),group:re({},M,{value:jt}),groupCollapsed:re({},M,{value:Tt}),groupEnd:re({},M,{value:sr})})}0>Le&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function a(M){if(pe===void 0)try{throw Error()}catch(ae){var ce=ae.stack.trim().match(/\n( *(at )?)/);pe=ce&&ce[1]||"",pr=-1<ae.stack.indexOf(`
    at`)?" (<anonymous>)":-1<ae.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pe+M+pr}function c(M,ce){if(!M||Qe)return"";var ae=Dt.get(M);if(ae!==void 0)return ae;Qe=!0,ae=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var Ae=null;Ae=se.H,se.H=null,s();try{var Ge={DetermineComponentFrameRoot:function(){try{if(ce){var or=function(){throw Error()};if(Object.defineProperty(or.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(or,[])}catch(Yt){var an=Yt}Reflect.construct(M,[],or)}else{try{or.call()}catch(Yt){an=Yt}M.call(or.prototype)}}else{try{throw Error()}catch(Yt){an=Yt}(or=M())&&typeof or.catch=="function"&&or.catch(function(){})}}catch(Yt){if(Yt&&an&&typeof Yt.stack=="string")return[Yt.stack,an.stack]}return[null,null]}};Ge.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var We=Object.getOwnPropertyDescriptor(Ge.DetermineComponentFrameRoot,"name");We&&We.configurable&&Object.defineProperty(Ge.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ye=Ge.DetermineComponentFrameRoot(),et=ye[0],ir=ye[1];if(et&&ir){var vt=et.split(`
`),mr=ir.split(`
`);for(ye=We=0;We<vt.length&&!vt[We].includes("DetermineComponentFrameRoot");)We++;for(;ye<mr.length&&!mr[ye].includes("DetermineComponentFrameRoot");)ye++;if(We===vt.length||ye===mr.length)for(We=vt.length-1,ye=mr.length-1;1<=We&&0<=ye&&vt[We]!==mr[ye];)ye--;for(;1<=We&&0<=ye;We--,ye--)if(vt[We]!==mr[ye]){if(We!==1||ye!==1)do if(We--,ye--,0>ye||vt[We]!==mr[ye]){var $r=`
`+vt[We].replace(" at new "," at ");return M.displayName&&$r.includes("<anonymous>")&&($r=$r.replace("<anonymous>",M.displayName)),typeof M=="function"&&Dt.set(M,$r),$r}while(1<=We&&0<=ye);break}}}finally{Qe=!1,se.H=Ae,i(),Error.prepareStackTrace=ae}return vt=(vt=M?M.displayName||M.name:"")?a(vt):"",typeof M=="function"&&Dt.set(M,vt),vt}function u(M){if(M==null)return"";if(typeof M=="function"){var ce=M.prototype;return c(M,!(!ce||!ce.isReactComponent))}if(typeof M=="string")return a(M);switch(M){case U:return a("Suspense");case X:return a("SuspenseList")}if(typeof M=="object")switch(M.$$typeof){case q:return M=c(M.render,!1),M;case te:return u(M.type);case de:ce=M._payload,M=M._init;try{return u(M(ce))}catch{}}return""}function h(){var M=se.A;return M===null?null:M.getOwner()}function d(M){if(he.call(M,"key")){var ce=Object.getOwnPropertyDescriptor(M,"key").get;if(ce&&ce.isReactWarning)return!1}return M.key!==void 0}function p(M,ce){function ae(){Ze||(Ze=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",ce))}ae.isReactWarning=!0,Object.defineProperty(M,"key",{get:ae,configurable:!0})}function g(){var M=r(this.type);return Et[M]||(Et[M]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),M=this.props.ref,M!==void 0?M:null}function y(M,ce,ae,Ae,Ge,We){return ae=We.ref,M={$$typeof:A,type:M,key:ce,props:We,_owner:Ge},(ae!==void 0?ae:null)!==null?Object.defineProperty(M,"ref",{enumerable:!1,get:g}):Object.defineProperty(M,"ref",{enumerable:!1,value:null}),M._store={},Object.defineProperty(M._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(M,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.freeze&&(Object.freeze(M.props),Object.freeze(M)),M}function w(M,ce,ae,Ae,Ge,We){if(typeof M=="string"||typeof M=="function"||M===L||M===F||M===z||M===U||M===X||M===J||typeof M=="object"&&M!==null&&(M.$$typeof===de||M.$$typeof===te||M.$$typeof===W||M.$$typeof===Y||M.$$typeof===q||M.$$typeof===Re||M.getModuleId!==void 0)){var ye=ce.children;if(ye!==void 0)if(Ae)if($e(ye)){for(Ae=0;Ae<ye.length;Ae++)_(ye[Ae],M);Object.freeze&&Object.freeze(ye)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else _(ye,M)}else ye="",(M===void 0||typeof M=="object"&&M!==null&&Object.keys(M).length===0)&&(ye+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),M===null?Ae="null":$e(M)?Ae="array":M!==void 0&&M.$$typeof===A?(Ae="<"+(r(M.type)||"Unknown")+" />",ye=" Did you accidentally export a JSX literal instead of a component?"):Ae=typeof M,console.error("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Ae,ye);if(he.call(ce,"key")){ye=r(M);var et=Object.keys(ce).filter(function(vt){return vt!=="key"});Ae=0<et.length?"{key: someKey, "+et.join(": ..., ")+": ...}":"{key: someKey}",_n[ye+Ae]||(et=0<et.length?"{"+et.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Ae,ye,et,ye),_n[ye+Ae]=!0)}if(ye=null,ae!==void 0&&(t(ae),ye=""+ae),d(ce)&&(t(ce.key),ye=""+ce.key),"key"in ce){ae={};for(var ir in ce)ir!=="key"&&(ae[ir]=ce[ir])}else ae=ce;return ye&&p(ae,typeof M=="function"?M.displayName||M.name||"Unknown":M),y(M,ye,We,Ge,h(),ae)}function _(M,ce){if(typeof M=="object"&&M&&M.$$typeof!==Gn){if($e(M))for(var ae=0;ae<M.length;ae++){var Ae=M[ae];S(Ae)&&T(Ae,ce)}else if(S(M))M._store&&(M._store.validated=1);else if(M===null||typeof M!="object"?ae=null:(ae=le&&M[le]||M["@@iterator"],ae=typeof ae=="function"?ae:null),typeof ae=="function"&&ae!==M.entries&&(ae=ae.call(M),ae!==M))for(;!(M=ae.next()).done;)S(M.value)&&T(M.value,ce)}}function S(M){return typeof M=="object"&&M!==null&&M.$$typeof===A}function T(M,ce){if(M._store&&!M._store.validated&&M.key==null&&(M._store.validated=1,ce=k(ce),!gr[ce])){gr[ce]=!0;var ae="";M&&M._owner!=null&&M._owner!==h()&&(ae=null,typeof M._owner.tag=="number"?ae=r(M._owner.type):typeof M._owner.name=="string"&&(ae=M._owner.name),ae=" It was passed a child from "+ae+".");var Ae=se.getCurrentStack;se.getCurrentStack=function(){var Ge=u(M.type);return Ae&&(Ge+=Ae()||""),Ge},console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',ce,ae),se.getCurrentStack=Ae}}function k(M){var ce="",ae=h();return ae&&(ae=r(ae.type))&&(ce=`

Check the render method of \``+ae+"`."),ce||(M=r(M))&&(ce=`

Check the top-level render call using <`+M+">."),ce}var I=v,A=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),W=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),le=Symbol.iterator,ie=Symbol.for("react.client.reference"),se=I.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=Object.prototype.hasOwnProperty,re=Object.assign,Re=Symbol.for("react.client.reference"),$e=Array.isArray,Le=0,we,Se,at,nr,jt,Tt,sr;n.__reactDisabledLog=!0;var pe,pr,Qe=!1,Dt=new(typeof WeakMap=="function"?WeakMap:Map),Gn=Symbol.for("react.client.reference"),Ze,Et={},_n={},gr={};Mo.Fragment=L,Mo.jsx=function(M,ce,ae,Ae,Ge){return w(M,ce,ae,!1,Ae,Ge)},Mo.jsxs=function(M,ce,ae,Ae,Ge){return w(M,ce,ae,!0,Ae,Ge)}}()),Mo}process.env.NODE_ENV==="production"?ud.exports=BI():ud.exports=zI();var b=ud.exports;function Cv(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function w1(...r){return e=>{let t=!1;const n=r.map(s=>{const i=Cv(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Cv(r[s],null)}}}}function Jt(...r){return H.useCallback(w1(...r),r)}var Ni=H.forwardRef((r,e)=>{const{children:t,...n}=r,s=H.Children.toArray(t),i=s.find(HI);if(i){const a=i.props.children,c=s.map(u=>u===i?H.Children.count(a)>1?H.Children.only(null):H.isValidElement(a)?a.props.children:null:u);return b.jsx(hd,{...n,ref:e,children:H.isValidElement(a)?H.cloneElement(a,void 0,c):null})}return b.jsx(hd,{...n,ref:e,children:t})});Ni.displayName="Slot";var hd=H.forwardRef((r,e)=>{const{children:t,...n}=r;if(H.isValidElement(t)){const s=$I(t),i=UI(n,t.props);return t.type!==H.Fragment&&(i.ref=e?w1(e,s):s),H.cloneElement(t,i)}return H.Children.count(t)>1?H.Children.only(null):null});hd.displayName="SlotClone";var WI=({children:r})=>b.jsx(b.Fragment,{children:r});function HI(r){return H.isValidElement(r)&&r.type===WI}function UI(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...c)=>{i(...c),s(...c)}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function $I(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var YI=Ni;function x1(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=x1(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function _1(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=x1(r))&&(n&&(n+=" "),n+=e);return n}const Tv=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Ev=_1,XI=(r,e)=>t=>{var n;if(e?.variants==null)return Ev(r,t?.class,t?.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(h=>{const d=t?.[h],p=i?.[h];if(d===null)return null;const g=Tv(d)||Tv(p);return s[h][g]}),c=t&&Object.entries(t).reduce((h,d)=>{let[p,g]=d;return g===void 0||(h[p]=g),h},{}),u=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((h,d)=>{let{class:p,className:g,...y}=d;return Object.entries(y).every(w=>{let[_,S]=w;return Array.isArray(S)?S.includes({...i,...c}[_]):{...i,...c}[_]===S})?[...h,p,g]:h},[]);return Ev(r,a,u,t?.class,t?.className)},hf="-",GI=r=>{const e=KI(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:a=>{const c=a.split(hf);return c[0]===""&&c.length!==1&&c.shift(),S1(c,e)||qI(a)},getConflictingClassGroupIds:(a,c)=>{const u=t[a]||[];return c&&n[a]?[...u,...n[a]]:u}}},S1=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?S1(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(hf);return e.validators.find(({validator:a})=>a(i))?.classGroupId},kv=/^\[(.+)\]$/,qI=r=>{if(kv.test(r)){const e=kv.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},KI=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return JI(Object.entries(r.classGroups),t).forEach(([i,a])=>{dd(a,n,i,e)}),n},dd=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Iv(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(ZI(s)){dd(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,a])=>{dd(a,Iv(e,i),t,n)})})},Iv=(r,e)=>{let t=r;return e.split(hf).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},ZI=r=>r.isThemeGetter,JI=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,c])=>[e+a,c])):i);return[t,s]}):r,QI=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,a)=>{t.set(i,a),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let a=t.get(i);if(a!==void 0)return a;if((a=n.get(i))!==void 0)return s(i,a),a},set(i,a){t.has(i)?t.set(i,a):s(i,a)}}},C1="!",eA=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,a=c=>{const u=[];let h=0,d=0,p;for(let S=0;S<c.length;S++){let T=c[S];if(h===0){if(T===s&&(n||c.slice(S,S+i)===e)){u.push(c.slice(d,S)),d=S+i;continue}if(T==="/"){p=S;continue}}T==="["?h++:T==="]"&&h--}const g=u.length===0?c:c.substring(d),y=g.startsWith(C1),w=y?g.substring(1):g,_=p&&p>d?p-d:void 0;return{modifiers:u,hasImportantModifier:y,baseClassName:w,maybePostfixModifierPosition:_}};return t?c=>t({className:c,parseClassName:a}):a},tA=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},rA=r=>({cache:QI(r.cacheSize),parseClassName:eA(r),...GI(r)}),nA=/\s+/,sA=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],a=r.trim().split(nA);let c="";for(let u=a.length-1;u>=0;u-=1){const h=a[u],{modifiers:d,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:y}=t(h);let w=!!y,_=n(w?g.substring(0,y):g);if(!_){if(!w){c=h+(c.length>0?" "+c:c);continue}if(_=n(g),!_){c=h+(c.length>0?" "+c:c);continue}w=!1}const S=tA(d).join(":"),T=p?S+C1:S,k=T+_;if(i.includes(k))continue;i.push(k);const I=s(_,w);for(let A=0;A<I.length;++A){const D=I[A];i.push(T+D)}c=h+(c.length>0?" "+c:c)}return c};function iA(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=T1(e))&&(n&&(n+=" "),n+=t);return n}const T1=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=T1(r[n]))&&(t&&(t+=" "),t+=e);return t};function oA(r,...e){let t,n,s,i=a;function a(u){const h=e.reduce((d,p)=>p(d),r());return t=rA(h),n=t.cache.get,s=t.cache.set,i=c,c(u)}function c(u){const h=n(u);if(h)return h;const d=sA(u,t);return s(u,d),d}return function(){return i(iA.apply(null,arguments))}}const rt=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},E1=/^\[(?:([a-z-]+):)?(.+)\]$/i,aA=/^\d+\/\d+$/,cA=new Set(["px","full","screen"]),lA=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uA=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,hA=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,dA=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fA=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Pn=r=>ji(r)||cA.has(r)||aA.test(r),ss=r=>Ui(r,"length",xA),ji=r=>!!r&&!Number.isNaN(Number(r)),Ph=r=>Ui(r,"number",ji),Po=r=>!!r&&Number.isInteger(Number(r)),pA=r=>r.endsWith("%")&&ji(r.slice(0,-1)),Te=r=>E1.test(r),is=r=>lA.test(r),gA=new Set(["length","size","percentage"]),mA=r=>Ui(r,gA,k1),vA=r=>Ui(r,"position",k1),yA=new Set(["image","url"]),bA=r=>Ui(r,yA,SA),wA=r=>Ui(r,"",_A),Do=()=>!0,Ui=(r,e,t)=>{const n=E1.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},xA=r=>uA.test(r)&&!hA.test(r),k1=()=>!1,_A=r=>dA.test(r),SA=r=>fA.test(r),CA=()=>{const r=rt("colors"),e=rt("spacing"),t=rt("blur"),n=rt("brightness"),s=rt("borderColor"),i=rt("borderRadius"),a=rt("borderSpacing"),c=rt("borderWidth"),u=rt("contrast"),h=rt("grayscale"),d=rt("hueRotate"),p=rt("invert"),g=rt("gap"),y=rt("gradientColorStops"),w=rt("gradientColorStopPositions"),_=rt("inset"),S=rt("margin"),T=rt("opacity"),k=rt("padding"),I=rt("saturate"),A=rt("scale"),D=rt("sepia"),L=rt("skew"),z=rt("space"),F=rt("translate"),Y=()=>["auto","contain","none"],W=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto",Te,e],U=()=>[Te,e],X=()=>["",Pn,ss],te=()=>["auto",ji,Te],de=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],J=()=>["solid","dashed","dotted","double","none"],le=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ie=()=>["start","end","center","between","around","evenly","stretch"],se=()=>["","0",Te],he=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[ji,Te];return{cacheSize:500,separator:":",theme:{colors:[Do],spacing:[Pn,ss],blur:["none","",is,Te],brightness:re(),borderColor:[r],borderRadius:["none","","full",is,Te],borderSpacing:U(),borderWidth:X(),contrast:re(),grayscale:se(),hueRotate:re(),invert:se(),gap:U(),gradientColorStops:[r],gradientColorStopPositions:[pA,ss],inset:q(),margin:q(),opacity:re(),padding:U(),saturate:re(),scale:re(),sepia:se(),skew:re(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",Te]}],container:["container"],columns:[{columns:[is]}],"break-after":[{"break-after":he()}],"break-before":[{"break-before":he()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...de(),Te]}],overflow:[{overflow:W()}],"overflow-x":[{"overflow-x":W()}],"overflow-y":[{"overflow-y":W()}],overscroll:[{overscroll:Y()}],"overscroll-x":[{"overscroll-x":Y()}],"overscroll-y":[{"overscroll-y":Y()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Po,Te]}],basis:[{basis:q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Te]}],grow:[{grow:se()}],shrink:[{shrink:se()}],order:[{order:["first","last","none",Po,Te]}],"grid-cols":[{"grid-cols":[Do]}],"col-start-end":[{col:["auto",{span:["full",Po,Te]},Te]}],"col-start":[{"col-start":te()}],"col-end":[{"col-end":te()}],"grid-rows":[{"grid-rows":[Do]}],"row-start-end":[{row:["auto",{span:[Po,Te]},Te]}],"row-start":[{"row-start":te()}],"row-end":[{"row-end":te()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Te]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Te]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...ie()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ie(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ie(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Te,e]}],"min-w":[{"min-w":[Te,e,"min","max","fit"]}],"max-w":[{"max-w":[Te,e,"none","full","min","max","fit","prose",{screen:[is]},is]}],h:[{h:[Te,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Te,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Te,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Te,e,"auto","min","max","fit"]}],"font-size":[{text:["base",is,ss]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ph]}],"font-family":[{font:[Do]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Te]}],"line-clamp":[{"line-clamp":["none",ji,Ph]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Pn,Te]}],"list-image":[{"list-image":["none",Te]}],"list-style-type":[{list:["none","disc","decimal",Te]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...J(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Pn,ss]}],"underline-offset":[{"underline-offset":["auto",Pn,Te]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Te]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Te]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...de(),vA]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",mA]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},bA]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...J(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:J()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...J()]}],"outline-offset":[{"outline-offset":[Pn,Te]}],"outline-w":[{outline:[Pn,ss]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[Pn,ss]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",is,wA]}],"shadow-color":[{shadow:[Do]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...le(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":le()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",is,Te]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[p]}],saturate:[{saturate:[I]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Te]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",Te]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",Te]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[A]}],"scale-x":[{"scale-x":[A]}],"scale-y":[{"scale-y":[A]}],rotate:[{rotate:[Po,Te]}],"translate-x":[{"translate-x":[F]}],"translate-y":[{"translate-y":[F]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Te]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Te]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Te]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Pn,ss,Ph]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},TA=oA(CA);function Wt(...r){return TA(_1(r))}function EA(r,e={}){const{decimals:t=0,sizeType:n="normal"}=e,s=["Bytes","KB","MB","GB","TB"],i=["Bytes","KiB","MiB","GiB","TiB"];if(r===0)return"0 Byte";const a=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,a)).toFixed(t)} ${n==="accurate"?i[a]??"Bytest":s[a]??"Bytes"}`}const I1=XI("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),st=H.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const a=n?Ni:"button";return b.jsx(a,{className:Wt(I1({variant:e,size:t,className:r})),ref:i,...s})});st.displayName="Button";function df(r,[e,t]){return Math.min(t,Math.max(e,r))}function pt(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r?.(s),t===!1||!s.defaultPrevented)return e?.(s)}}function ga(r,e=[]){let t=[];function n(i,a){const c=H.createContext(a),u=t.length;t=[...t,a];const h=p=>{const{scope:g,children:y,...w}=p,_=g?.[r]?.[u]||c,S=H.useMemo(()=>w,Object.values(w));return b.jsx(_.Provider,{value:S,children:y})};h.displayName=i+"Provider";function d(p,g){const y=g?.[r]?.[u]||c,w=H.useContext(y);if(w)return w;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[h,d]}const s=()=>{const i=t.map(a=>H.createContext(a));return function(c){const u=c?.[r]||i;return H.useMemo(()=>({[`__scope${r}`]:{...c,[r]:u}}),[c,u])}};return s.scopeName=r,[n,kA(s,...e)]}function kA(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((c,{useScope:u,scopeName:h})=>{const p=u(i)[`__scope${h}`];return{...c,...p}},{});return H.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function dn(r){const e=H.useRef(r);return H.useEffect(()=>{e.current=r}),H.useMemo(()=>(...t)=>e.current?.(...t),[])}function ff({prop:r,defaultProp:e,onChange:t=()=>{}}){const[n,s]=IA({defaultProp:e,onChange:t}),i=r!==void 0,a=i?r:n,c=dn(t),u=H.useCallback(h=>{if(i){const p=typeof h=="function"?h(r):h;p!==r&&c(p)}else s(h)},[i,r,s,c]);return[a,u]}function IA({defaultProp:r,onChange:e}){const t=H.useState(r),[n]=t,s=H.useRef(n),i=dn(e);return H.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),t}var AA=H.createContext(void 0);function Al(r){const e=H.useContext(AA);return r||e||"ltr"}function OA(r){const e=H.useRef({value:r,previous:r});return H.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var Jo=globalThis?.document?H.useLayoutEffect:()=>{};function MA(r){const[e,t]=H.useState(void 0);return Jo(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,c;if("borderBoxSize"in i){const u=i.borderBoxSize,h=Array.isArray(u)?u[0]:u;a=h.inlineSize,c=h.blockSize}else a=r.offsetWidth,c=r.offsetHeight;t({width:a,height:c})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var PA=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],tr=PA.reduce((r,e)=>{const t=H.forwardRef((n,s)=>{const{asChild:i,...a}=n,c=i?Ni:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),b.jsx(c,{...a,ref:s})});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{});function A1(r){const e=r+"CollectionProvider",[t,n]=ga(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),a=y=>{const{scope:w,children:_}=y,S=v.useRef(null),T=v.useRef(new Map).current;return b.jsx(s,{scope:w,itemMap:T,collectionRef:S,children:_})};a.displayName=e;const c=r+"CollectionSlot",u=v.forwardRef((y,w)=>{const{scope:_,children:S}=y,T=i(c,_),k=Jt(w,T.collectionRef);return b.jsx(Ni,{ref:k,children:S})});u.displayName=c;const h=r+"CollectionItemSlot",d="data-radix-collection-item",p=v.forwardRef((y,w)=>{const{scope:_,children:S,...T}=y,k=v.useRef(null),I=Jt(w,k),A=i(h,_);return v.useEffect(()=>(A.itemMap.set(k,{ref:k,...T}),()=>void A.itemMap.delete(k))),b.jsx(Ni,{[d]:"",ref:I,children:S})});p.displayName=h;function g(y){const w=i(r+"CollectionConsumer",y);return v.useCallback(()=>{const S=w.collectionRef.current;if(!S)return[];const T=Array.from(S.querySelectorAll(`[${d}]`));return Array.from(w.itemMap.values()).sort((A,D)=>T.indexOf(A.ref.current)-T.indexOf(D.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:a,Slot:u,ItemSlot:p},g,n]}var O1=["PageUp","PageDown"],M1=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],P1={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},$i="Slider",[fd,DA,RA]=A1($i),[D1,G9]=ga($i,[RA]),[jA,Ol]=D1($i),R1=H.forwardRef((r,e)=>{const{name:t,min:n=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:u=0,defaultValue:h=[n],value:d,onValueChange:p=()=>{},onValueCommit:g=()=>{},inverted:y=!1,form:w,..._}=r,S=H.useRef(new Set),T=H.useRef(0),I=a==="horizontal"?LA:FA,[A=[],D]=ff({prop:d,defaultProp:h,onChange:q=>{[...S.current][T.current]?.focus(),p(q)}}),L=H.useRef(A);function z(q){const U=WA(A,q);W(q,U)}function F(q){W(q,T.current)}function Y(){const q=L.current[T.current];A[T.current]!==q&&g(A)}function W(q,U,{commit:X}={commit:!1}){const te=YA(i),de=XA(Math.round((q-n)/i)*i+n,te),J=df(de,[n,s]);D((le=[])=>{const ie=BA(le,J,U);if($A(ie,u*i)){T.current=ie.indexOf(J);const se=String(ie)!==String(le);return se&&X&&g(ie),se?ie:le}else return le})}return b.jsx(jA,{scope:r.__scopeSlider,name:t,disabled:c,min:n,max:s,valueIndexToChangeRef:T,thumbs:S.current,values:A,orientation:a,form:w,children:b.jsx(fd.Provider,{scope:r.__scopeSlider,children:b.jsx(fd.Slot,{scope:r.__scopeSlider,children:b.jsx(I,{"aria-disabled":c,"data-disabled":c?"":void 0,..._,ref:e,onPointerDown:pt(_.onPointerDown,()=>{c||(L.current=A)}),min:n,max:s,inverted:y,onSlideStart:c?void 0:z,onSlideMove:c?void 0:F,onSlideEnd:c?void 0:Y,onHomeKeyDown:()=>!c&&W(n,0,{commit:!0}),onEndKeyDown:()=>!c&&W(s,A.length-1,{commit:!0}),onStepKeyDown:({event:q,direction:U})=>{if(!c){const de=O1.includes(q.key)||q.shiftKey&&M1.includes(q.key)?10:1,J=T.current,le=A[J],ie=i*de*U;W(le+ie,J,{commit:!0})}}})})})})});R1.displayName=$i;var[j1,L1]=D1($i,{startEdge:"left",endEdge:"right",size:"width",direction:1}),LA=H.forwardRef((r,e)=>{const{min:t,max:n,dir:s,inverted:i,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onStepKeyDown:h,...d}=r,[p,g]=H.useState(null),y=Jt(e,I=>g(I)),w=H.useRef(void 0),_=Al(s),S=_==="ltr",T=S&&!i||!S&&i;function k(I){const A=w.current||p.getBoundingClientRect(),D=[0,A.width],z=pf(D,T?[t,n]:[n,t]);return w.current=A,z(I-A.left)}return b.jsx(j1,{scope:r.__scopeSlider,startEdge:T?"left":"right",endEdge:T?"right":"left",direction:T?1:-1,size:"width",children:b.jsx(F1,{dir:_,"data-orientation":"horizontal",...d,ref:y,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const A=k(I.clientX);a?.(A)},onSlideMove:I=>{const A=k(I.clientX);c?.(A)},onSlideEnd:()=>{w.current=void 0,u?.()},onStepKeyDown:I=>{const D=P1[T?"from-left":"from-right"].includes(I.key);h?.({event:I,direction:D?-1:1})}})})}),FA=H.forwardRef((r,e)=>{const{min:t,max:n,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:c,onStepKeyDown:u,...h}=r,d=H.useRef(null),p=Jt(e,d),g=H.useRef(void 0),y=!s;function w(_){const S=g.current||d.current.getBoundingClientRect(),T=[0,S.height],I=pf(T,y?[n,t]:[t,n]);return g.current=S,I(_-S.top)}return b.jsx(j1,{scope:r.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:b.jsx(F1,{"data-orientation":"vertical",...h,ref:p,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:_=>{const S=w(_.clientY);i?.(S)},onSlideMove:_=>{const S=w(_.clientY);a?.(S)},onSlideEnd:()=>{g.current=void 0,c?.()},onStepKeyDown:_=>{const T=P1[y?"from-bottom":"from-top"].includes(_.key);u?.({event:_,direction:T?-1:1})}})})}),F1=H.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:u,...h}=r,d=Ol($i,t);return b.jsx(tr.span,{...h,ref:e,onKeyDown:pt(r.onKeyDown,p=>{p.key==="Home"?(a(p),p.preventDefault()):p.key==="End"?(c(p),p.preventDefault()):O1.concat(M1).includes(p.key)&&(u(p),p.preventDefault())}),onPointerDown:pt(r.onPointerDown,p=>{const g=p.target;g.setPointerCapture(p.pointerId),p.preventDefault(),d.thumbs.has(g)?g.focus():n(p)}),onPointerMove:pt(r.onPointerMove,p=>{p.target.hasPointerCapture(p.pointerId)&&s(p)}),onPointerUp:pt(r.onPointerUp,p=>{const g=p.target;g.hasPointerCapture(p.pointerId)&&(g.releasePointerCapture(p.pointerId),i(p))})})}),N1="SliderTrack",V1=H.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,s=Ol(N1,t);return b.jsx(tr.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:e})});V1.displayName=N1;var pd="SliderRange",B1=H.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,s=Ol(pd,t),i=L1(pd,t),a=H.useRef(null),c=Jt(e,a),u=s.values.length,h=s.values.map(g=>W1(g,s.min,s.max)),d=u>1?Math.min(...h):0,p=100-Math.max(...h);return b.jsx(tr.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...n,ref:c,style:{...r.style,[i.startEdge]:d+"%",[i.endEdge]:p+"%"}})});B1.displayName=pd;var gd="SliderThumb",z1=H.forwardRef((r,e)=>{const t=DA(r.__scopeSlider),[n,s]=H.useState(null),i=Jt(e,c=>s(c)),a=H.useMemo(()=>n?t().findIndex(c=>c.ref.current===n):-1,[t,n]);return b.jsx(NA,{...r,ref:i,index:a})}),NA=H.forwardRef((r,e)=>{const{__scopeSlider:t,index:n,name:s,...i}=r,a=Ol(gd,t),c=L1(gd,t),[u,h]=H.useState(null),d=Jt(e,k=>h(k)),p=u?a.form||!!u.closest("form"):!0,g=MA(u),y=a.values[n],w=y===void 0?0:W1(y,a.min,a.max),_=zA(n,a.values.length),S=g?.[c.size],T=S?HA(S,w,c.direction):0;return H.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),b.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${w}% + ${T}px)`},children:[b.jsx(fd.ItemSlot,{scope:r.__scopeSlider,children:b.jsx(tr.span,{role:"slider","aria-label":r["aria-label"]||_,"aria-valuemin":a.min,"aria-valuenow":y,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:d,style:y===void 0?{display:"none"}:r.style,onFocus:pt(r.onFocus,()=>{a.valueIndexToChangeRef.current=n})})}),p&&b.jsx(VA,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:y},n)]})});z1.displayName=gd;var VA=r=>{const{value:e,...t}=r,n=H.useRef(null),s=OA(e);return H.useEffect(()=>{const i=n.current,a=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==e&&u){const h=new Event("input",{bubbles:!0});u.call(i,e),i.dispatchEvent(h)}},[s,e]),b.jsx("input",{style:{display:"none"},...t,ref:n,defaultValue:e})};function BA(r=[],e,t){const n=[...r];return n[t]=e,n.sort((s,i)=>s-i)}function W1(r,e,t){const i=100/(t-e)*(r-e);return df(i,[0,100])}function zA(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function WA(r,e){if(r.length===1)return 0;const t=r.map(s=>Math.abs(s-e)),n=Math.min(...t);return t.indexOf(n)}function HA(r,e,t){const n=r/2,i=pf([0,50],[0,n]);return(n-i(e)*t)*t}function UA(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function $A(r,e){if(e>0){const t=UA(r);return Math.min(...t)>=e}return!0}function pf(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function YA(r){return(String(r).split(".")[1]||"").length}function XA(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var H1=R1,GA=V1,qA=B1,KA=z1;const U1=H.forwardRef(({className:r,...e},t)=>b.jsxs(H1,{ref:t,className:Wt("relative flex w-full touch-none select-none items-center",r),...e,children:[b.jsx(GA,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:b.jsx(qA,{className:"absolute h-full bg-primary"})}),b.jsx(KA,{className:"block h-4 w-4 cursor-pointer rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));U1.displayName=H1.displayName;function ZA(r,e){return H.useReducer((t,n)=>e[t][n]??t,r)}var Yi=r=>{const{present:e,children:t}=r,n=JA(e),s=typeof t=="function"?t({present:n.isPresent}):H.Children.only(t),i=Jt(n.ref,QA(s));return typeof t=="function"||n.isPresent?H.cloneElement(s,{ref:i}):null};Yi.displayName="Presence";function JA(r){const[e,t]=H.useState(),n=H.useRef({}),s=H.useRef(r),i=H.useRef("none"),a=r?"mounted":"unmounted",[c,u]=ZA(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return H.useEffect(()=>{const h=xc(n.current);i.current=c==="mounted"?h:"none"},[c]),Jo(()=>{const h=n.current,d=s.current;if(d!==r){const g=i.current,y=xc(h);r?u("MOUNT"):y==="none"||h?.display==="none"?u("UNMOUNT"):u(d&&g!==y?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,u]),Jo(()=>{if(e){let h;const d=e.ownerDocument.defaultView??window,p=y=>{const _=xc(n.current).includes(y.animationName);if(y.target===e&&_&&(u("ANIMATION_END"),!s.current)){const S=e.style.animationFillMode;e.style.animationFillMode="forwards",h=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=S)})}},g=y=>{y.target===e&&(i.current=xc(n.current))};return e.addEventListener("animationstart",g),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{d.clearTimeout(h),e.removeEventListener("animationstart",g),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:H.useCallback(h=>{h&&(n.current=getComputedStyle(h)),t(h)},[])}}function xc(r){return r?.animationName||"none"}function QA(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function eO(r,e){return H.useReducer((t,n)=>e[t][n]??t,r)}var gf="ScrollArea",[$1,q9]=ga(gf),[tO,Ur]=$1(gf),Y1=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:s,scrollHideDelay:i=600,...a}=r,[c,u]=H.useState(null),[h,d]=H.useState(null),[p,g]=H.useState(null),[y,w]=H.useState(null),[_,S]=H.useState(null),[T,k]=H.useState(0),[I,A]=H.useState(0),[D,L]=H.useState(!1),[z,F]=H.useState(!1),Y=Jt(e,q=>u(q)),W=Al(s);return b.jsx(tO,{scope:t,type:n,dir:W,scrollHideDelay:i,scrollArea:c,viewport:h,onViewportChange:d,content:p,onContentChange:g,scrollbarX:y,onScrollbarXChange:w,scrollbarXEnabled:D,onScrollbarXEnabledChange:L,scrollbarY:_,onScrollbarYChange:S,scrollbarYEnabled:z,onScrollbarYEnabledChange:F,onCornerWidthChange:k,onCornerHeightChange:A,children:b.jsx(tr.div,{dir:W,...a,ref:Y,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":I+"px",...r.style}})})});Y1.displayName=gf;var X1="ScrollAreaViewport",G1=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,nonce:s,...i}=r,a=Ur(X1,t),c=H.useRef(null),u=Jt(e,c,a.onViewportChange);return b.jsxs(b.Fragment,{children:[b.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),b.jsx(tr.div,{"data-radix-scroll-area-viewport":"",...i,ref:u,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...r.style},children:b.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});G1.displayName=X1;var xn="ScrollAreaScrollbar",Ml=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Ur(xn,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,c=r.orientation==="horizontal";return H.useEffect(()=>(c?i(!0):a(!0),()=>{c?i(!1):a(!1)}),[c,i,a]),s.type==="hover"?b.jsx(rO,{...n,ref:e,forceMount:t}):s.type==="scroll"?b.jsx(nO,{...n,ref:e,forceMount:t}):s.type==="auto"?b.jsx(q1,{...n,ref:e,forceMount:t}):s.type==="always"?b.jsx(mf,{...n,ref:e}):null});Ml.displayName=xn;var rO=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Ur(xn,r.__scopeScrollArea),[i,a]=H.useState(!1);return H.useEffect(()=>{const c=s.scrollArea;let u=0;if(c){const h=()=>{window.clearTimeout(u),a(!0)},d=()=>{u=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",d),()=>{window.clearTimeout(u),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),b.jsx(Yi,{present:t||i,children:b.jsx(q1,{"data-state":i?"visible":"hidden",...n,ref:e})})}),nO=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Ur(xn,r.__scopeScrollArea),i=r.orientation==="horizontal",a=Dl(()=>u("SCROLL_END"),100),[c,u]=eO("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return H.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>u("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,s.scrollHideDelay,u]),H.useEffect(()=>{const h=s.viewport,d=i?"scrollLeft":"scrollTop";if(h){let p=h[d];const g=()=>{const y=h[d];p!==y&&(u("SCROLL"),a()),p=y};return h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[s.viewport,i,u,a]),b.jsx(Yi,{present:t||c!=="hidden",children:b.jsx(mf,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:pt(r.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:pt(r.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),q1=H.forwardRef((r,e)=>{const t=Ur(xn,r.__scopeScrollArea),{forceMount:n,...s}=r,[i,a]=H.useState(!1),c=r.orientation==="horizontal",u=Dl(()=>{if(t.viewport){const h=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;a(c?h:d)}},10);return Vi(t.viewport,u),Vi(t.content,u),b.jsx(Yi,{present:n||i,children:b.jsx(mf,{"data-state":i?"visible":"hidden",...s,ref:e})})}),mf=H.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,s=Ur(xn,r.__scopeScrollArea),i=H.useRef(null),a=H.useRef(0),[c,u]=H.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Q1(c.viewport,c.content),d={...n,sizes:c,onSizesChange:u,hasThumb:h>0&&h<1,onThumbChange:g=>i.current=g,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:g=>a.current=g};function p(g,y){return lO(g,a.current,c,y)}return t==="horizontal"?b.jsx(sO,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const g=s.viewport.scrollLeft,y=Av(g,c,s.dir);i.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollLeft=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollLeft=p(g,s.dir))}}):t==="vertical"?b.jsx(iO,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const g=s.viewport.scrollTop,y=Av(g,c);i.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollTop=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollTop=p(g))}}):null}),sO=H.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...s}=r,i=Ur(xn,r.__scopeScrollArea),[a,c]=H.useState(),u=H.useRef(null),h=Jt(e,u,i.onScrollbarXChange);return H.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),b.jsx(Z1,{"data-orientation":"horizontal",...s,ref:h,sizes:t,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Pl(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.x),onDragScroll:d=>r.onDragScroll(d.x),onWheelScroll:(d,p)=>{if(i.viewport){const g=i.viewport.scrollLeft+d.deltaX;r.onWheelScroll(g),ty(g,p)&&d.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:rl(a.paddingLeft),paddingEnd:rl(a.paddingRight)}})}})}),iO=H.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...s}=r,i=Ur(xn,r.__scopeScrollArea),[a,c]=H.useState(),u=H.useRef(null),h=Jt(e,u,i.onScrollbarYChange);return H.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),b.jsx(Z1,{"data-orientation":"vertical",...s,ref:h,sizes:t,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Pl(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.y),onDragScroll:d=>r.onDragScroll(d.y),onWheelScroll:(d,p)=>{if(i.viewport){const g=i.viewport.scrollTop+d.deltaY;r.onWheelScroll(g),ty(g,p)&&d.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:rl(a.paddingTop),paddingEnd:rl(a.paddingBottom)}})}})}),[oO,K1]=$1(xn),Z1=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:h,onWheelScroll:d,onResize:p,...g}=r,y=Ur(xn,t),[w,_]=H.useState(null),S=Jt(e,Y=>_(Y)),T=H.useRef(null),k=H.useRef(""),I=y.viewport,A=n.content-n.viewport,D=dn(d),L=dn(u),z=Dl(p,10);function F(Y){if(T.current){const W=Y.clientX-T.current.left,q=Y.clientY-T.current.top;h({x:W,y:q})}}return H.useEffect(()=>{const Y=W=>{const q=W.target;w?.contains(q)&&D(W,A)};return document.addEventListener("wheel",Y,{passive:!1}),()=>document.removeEventListener("wheel",Y,{passive:!1})},[I,w,A,D]),H.useEffect(L,[n,L]),Vi(w,z),Vi(y.content,z),b.jsx(oO,{scope:t,scrollbar:w,hasThumb:s,onThumbChange:dn(i),onThumbPointerUp:dn(a),onThumbPositionChange:L,onThumbPointerDown:dn(c),children:b.jsx(tr.div,{...g,ref:S,style:{position:"absolute",...g.style},onPointerDown:pt(r.onPointerDown,Y=>{Y.button===0&&(Y.target.setPointerCapture(Y.pointerId),T.current=w.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),F(Y))}),onPointerMove:pt(r.onPointerMove,F),onPointerUp:pt(r.onPointerUp,Y=>{const W=Y.target;W.hasPointerCapture(Y.pointerId)&&W.releasePointerCapture(Y.pointerId),document.body.style.webkitUserSelect=k.current,y.viewport&&(y.viewport.style.scrollBehavior=""),T.current=null})})})}),tl="ScrollAreaThumb",vf=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=K1(tl,r.__scopeScrollArea);return b.jsx(Yi,{present:t||s.hasThumb,children:b.jsx(aO,{ref:e,...n})})}),aO=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...s}=r,i=Ur(tl,t),a=K1(tl,t),{onThumbPositionChange:c}=a,u=Jt(e,p=>a.onThumbChange(p)),h=H.useRef(void 0),d=Dl(()=>{h.current&&(h.current(),h.current=void 0)},100);return H.useEffect(()=>{const p=i.viewport;if(p){const g=()=>{if(d(),!h.current){const y=uO(p,c);h.current=y,c()}};return c(),p.addEventListener("scroll",g),()=>p.removeEventListener("scroll",g)}},[i.viewport,d,c]),b.jsx(tr.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:pt(r.onPointerDownCapture,p=>{const y=p.target.getBoundingClientRect(),w=p.clientX-y.left,_=p.clientY-y.top;a.onThumbPointerDown({x:w,y:_})}),onPointerUp:pt(r.onPointerUp,a.onThumbPointerUp)})});vf.displayName=tl;var yf="ScrollAreaCorner",J1=H.forwardRef((r,e)=>{const t=Ur(yf,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?b.jsx(cO,{...r,ref:e}):null});J1.displayName=yf;var cO=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,s=Ur(yf,t),[i,a]=H.useState(0),[c,u]=H.useState(0),h=!!(i&&c);return Vi(s.scrollbarX,()=>{const d=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(d),u(d)}),Vi(s.scrollbarY,()=>{const d=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(d),a(d)}),h?b.jsx(tr.div,{...n,ref:e,style:{width:i,height:c,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function rl(r){return r?parseInt(r,10):0}function Q1(r,e){const t=r/e;return isNaN(t)?0:t}function Pl(r){const e=Q1(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function lO(r,e,t,n="ltr"){const s=Pl(t),i=s/2,a=e||i,c=s-a,u=t.scrollbar.paddingStart+a,h=t.scrollbar.size-t.scrollbar.paddingEnd-c,d=t.content-t.viewport,p=n==="ltr"?[0,d]:[d*-1,0];return ey([u,h],p)(r)}function Av(r,e,t="ltr"){const n=Pl(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,a=e.content-e.viewport,c=i-n,u=t==="ltr"?[0,a]:[a*-1,0],h=df(r,u);return ey([0,a],[0,c])(h)}function ey(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function ty(r,e){return r>0&&r<e}var uO=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function s(){const i={left:r.scrollLeft,top:r.scrollTop},a=t.left!==i.left,c=t.top!==i.top;(a||c)&&e(),t=i,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function Dl(r,e){const t=dn(r),n=H.useRef(0);return H.useEffect(()=>()=>window.clearTimeout(n.current),[]),H.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function Vi(r,e){const t=dn(e);Jo(()=>{let n=0;if(r){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return s.observe(r),()=>{window.cancelAnimationFrame(n),s.unobserve(r)}}},[r,t])}var nl=Y1,md=G1,Ov=Ml,Mv=vf,hO=J1;const ti=H.forwardRef(({className:r,children:e,...t},n)=>b.jsxs(nl,{ref:n,className:Wt("relative overflow-hidden",r),...t,children:[b.jsx(md,{className:"h-full w-full rounded-[inherit]",children:e}),b.jsx(bf,{}),b.jsx(hO,{})]}));ti.displayName=nl.displayName;const bf=H.forwardRef(({className:r,orientation:e="vertical",...t},n)=>b.jsx(Ml,{ref:n,orientation:e,className:Wt("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:b.jsx(vf,{className:"relative flex-1 rounded-full bg-border"})}));bf.displayName=Ml.displayName;const ma=({children:r,renderCustomPreview:e,data:t={},shouldDisplayPreview:n=!0})=>{const[s,i]=v.useState(!1),[a,c]=v.useState({x:0,y:0}),u=v.useRef(null),h=y=>{i(!0),y.dataTransfer.setDragImage(new Image,0,0),y.dataTransfer.setData(JSON.stringify(t),JSON.stringify(t)),c({x:y.clientX,y:y.clientY})},d=()=>{i(!1)},p=y=>{s&&c({x:y.clientX,y:y.clientY})},g=v.cloneElement(r,{draggable:!0,onDragStart:h,onDragEnd:d,onDrag:p,style:{...r.props.style}});return b.jsxs(b.Fragment,{children:[g,s&&n&&e?ld.createPortal(b.jsx("div",{ref:u,style:{position:"fixed",left:a.x,top:a.y,pointerEvents:"none",zIndex:9999,transform:"translate(-50%, -50%)"},children:e}),document.body):null]})};var dO=H.useId||(()=>{}),fO=0;function ry(r){const[e,t]=H.useState(dO());return Jo(()=>{t(n=>n??String(fO++))},[r]),e?`radix-${e}`:""}var Dh="rovingFocusGroup.onEntryFocus",pO={bubbles:!1,cancelable:!0},Rl="RovingFocusGroup",[vd,ny,gO]=A1(Rl),[mO,sy]=ga(Rl,[gO]),[vO,yO]=mO(Rl),iy=H.forwardRef((r,e)=>b.jsx(vd.Provider,{scope:r.__scopeRovingFocusGroup,children:b.jsx(vd.Slot,{scope:r.__scopeRovingFocusGroup,children:b.jsx(bO,{...r,ref:e})})}));iy.displayName=Rl;var bO=H.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:h,preventScrollOnEntryFocus:d=!1,...p}=r,g=H.useRef(null),y=Jt(e,g),w=Al(i),[_=null,S]=ff({prop:a,defaultProp:c,onChange:u}),[T,k]=H.useState(!1),I=dn(h),A=ny(t),D=H.useRef(!1),[L,z]=H.useState(0);return H.useEffect(()=>{const F=g.current;if(F)return F.addEventListener(Dh,I),()=>F.removeEventListener(Dh,I)},[I]),b.jsx(vO,{scope:t,orientation:n,dir:w,loop:s,currentTabStopId:_,onItemFocus:H.useCallback(F=>S(F),[S]),onItemShiftTab:H.useCallback(()=>k(!0),[]),onFocusableItemAdd:H.useCallback(()=>z(F=>F+1),[]),onFocusableItemRemove:H.useCallback(()=>z(F=>F-1),[]),children:b.jsx(tr.div,{tabIndex:T||L===0?-1:0,"data-orientation":n,...p,ref:y,style:{outline:"none",...r.style},onMouseDown:pt(r.onMouseDown,()=>{D.current=!0}),onFocus:pt(r.onFocus,F=>{const Y=!D.current;if(F.target===F.currentTarget&&Y&&!T){const W=new CustomEvent(Dh,pO);if(F.currentTarget.dispatchEvent(W),!W.defaultPrevented){const q=A().filter(J=>J.focusable),U=q.find(J=>J.active),X=q.find(J=>J.id===_),de=[U,X,...q].filter(Boolean).map(J=>J.ref.current);cy(de,d)}}D.current=!1}),onBlur:pt(r.onBlur,()=>k(!1))})})}),oy="RovingFocusGroupItem",ay=H.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,...a}=r,c=ry(),u=i||c,h=yO(oy,t),d=h.currentTabStopId===u,p=ny(t),{onFocusableItemAdd:g,onFocusableItemRemove:y}=h;return H.useEffect(()=>{if(n)return g(),()=>y()},[n,g,y]),b.jsx(vd.ItemSlot,{scope:t,id:u,focusable:n,active:s,children:b.jsx(tr.span,{tabIndex:d?0:-1,"data-orientation":h.orientation,...a,ref:e,onMouseDown:pt(r.onMouseDown,w=>{n?h.onItemFocus(u):w.preventDefault()}),onFocus:pt(r.onFocus,()=>h.onItemFocus(u)),onKeyDown:pt(r.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){h.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const _=_O(w,h.orientation,h.dir);if(_!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let T=p().filter(k=>k.focusable).map(k=>k.ref.current);if(_==="last")T.reverse();else if(_==="prev"||_==="next"){_==="prev"&&T.reverse();const k=T.indexOf(w.currentTarget);T=h.loop?SO(T,k+1):T.slice(k+1)}setTimeout(()=>cy(T))}})})})});ay.displayName=oy;var wO={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function xO(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function _O(r,e,t){const n=xO(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return wO[n]}function cy(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function SO(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var CO=iy,TO=ay,wf="Tabs",[EO,K9]=ga(wf,[sy]),ly=sy(),[kO,xf]=EO(wf),uy=H.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:c,activationMode:u="automatic",...h}=r,d=Al(c),[p,g]=ff({prop:n,onChange:s,defaultProp:i});return b.jsx(kO,{scope:t,baseId:ry(),value:p,onValueChange:g,orientation:a,dir:d,activationMode:u,children:b.jsx(tr.div,{dir:d,"data-orientation":a,...h,ref:e})})});uy.displayName=wf;var hy="TabsList",dy=H.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=xf(hy,t),a=ly(t);return b.jsx(CO,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:n,children:b.jsx(tr.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});dy.displayName=hy;var fy="TabsTrigger",py=H.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,a=xf(fy,t),c=ly(t),u=vy(a.baseId,n),h=yy(a.baseId,n),d=n===a.value;return b.jsx(TO,{asChild:!0,...c,focusable:!s,active:d,children:b.jsx(tr.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":h,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u,...i,ref:e,onMouseDown:pt(r.onMouseDown,p=>{!s&&p.button===0&&p.ctrlKey===!1?a.onValueChange(n):p.preventDefault()}),onKeyDown:pt(r.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&a.onValueChange(n)}),onFocus:pt(r.onFocus,()=>{const p=a.activationMode!=="manual";!d&&!s&&p&&a.onValueChange(n)})})})});py.displayName=fy;var gy="TabsContent",my=H.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...a}=r,c=xf(gy,t),u=vy(c.baseId,n),h=yy(c.baseId,n),d=n===c.value,p=H.useRef(d);return H.useEffect(()=>{const g=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(g)},[]),b.jsx(Yi,{present:s||d,children:({present:g})=>b.jsx(tr.div,{"data-state":d?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!g,id:h,tabIndex:0,...a,ref:e,style:{...r.style,animationDuration:p.current?"0s":void 0},children:g&&i})})});my.displayName=gy;function vy(r,e){return`${r}-trigger-${e}`}function yy(r,e){return`${r}-content-${e}`}var IO=uy,by=dy,wy=py,xy=my;const _y=IO,_f=H.forwardRef(({className:r,...e},t)=>b.jsx(by,{ref:t,className:Wt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));_f.displayName=by.displayName;const sl=H.forwardRef(({className:r,...e},t)=>b.jsx(wy,{ref:t,className:Wt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...e}));sl.displayName=wy.displayName;const il=H.forwardRef(({className:r,...e},t)=>b.jsx(xy,{ref:t,className:Wt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));il.displayName=xy.displayName;const AO="add",OO="track",MO="trackItems",PO="track:changed",DO="trackItems:changed",RO="state",jO="state:changed",Sy="add",Sf="add:text",Xi="add:video",Gi="add:audio",LO="add:placeholder",qi="add:image",FO="add:mask",NO="add:transition",VO="add:animation",BO="edit",zO="edit:object",WO="edit:text",HO="edit:shape",UO="enterEditMode",Cy="player",Cf="player:play",Tf="player:pause",Ty="player:seek",$O="player:seekTo",Ey="player:seekBy",ky="player:togglePlay",Iy="active",YO="active:set",Ef="active:delete",XO="active:paste",kf="active:clone",If="active:split",Ay="layer",GO="layer:locked",qO="layer:hidden",KO="layer:move",ZO="layer:select",Af="layer:selection",JO="layer:sendTo",QO="layer:rename",eM="layer:editingName",tM="layer:copy",rM="layer:paste",nM="layer:clone",sM="layer:split",iM="layer:cut",oM="layer:delete",Oy="history",Of="history:undo",Mf="history:redo",aM="history:reset",My="scale",Pf="scale:changed",Py="drag",Df="drag:start",Qo="drag:end",Dy="timeline",Rf="timeline:boundingChanged";var yd=function(r,e){return yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},yd(r,e)};function Ki(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");yd(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function bd(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wd(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return i}function xd(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function vn(r){return typeof r=="function"}function Ry(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Rh=Ry(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,s){return s+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function _d(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var jl=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=bd(a),u=c.next();!u.done;u=c.next()){var h=u.value;h.remove(this)}}catch(_){e={error:_}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(vn(d))try{d()}catch(_){i=_ instanceof Rh?_.errors:[_]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var g=bd(p),y=g.next();!y.done;y=g.next()){var w=y.value;try{Pv(w)}catch(_){i=i??[],_ instanceof Rh?i=xd(xd([],wd(i)),wd(_.errors)):i.push(_)}}}catch(_){n={error:_}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(n)throw n.error}}}if(i)throw new Rh(i)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Pv(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&_d(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&_d(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),jy=jl.EMPTY;function Ly(r){return r instanceof jl||r&&"closed"in r&&vn(r.remove)&&vn(r.add)&&vn(r.unsubscribe)}function Pv(r){vn(r)?r():r.unsubscribe()}var cM={Promise:void 0},lM={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,xd([r,e],wd(t)))},clearTimeout:function(r){return clearTimeout(r)},delegate:void 0};function uM(r){lM.setTimeout(function(){throw r})}function Dv(){}function Kc(r){r()}var jf=function(r){Ki(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Ly(t)&&t.add(n)):n.destination=fM,n}return e.create=function(t,n,s){return new Sd(t,n,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(jl),hM=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){_c(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){_c(n)}else _c(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){_c(t)}},r}(),Sd=function(r){Ki(e,r);function e(t,n,s){var i=r.call(this)||this,a;return vn(t)||!t?a={next:t??void 0,error:n??void 0,complete:s??void 0}:a=t,i.destination=new hM(a),i}return e}(jf);function _c(r){uM(r)}function dM(r){throw r}var fM={closed:!0,next:Dv,error:dM,complete:Dv},pM=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function gM(r){return r}function mM(r){return r.length===0?gM:r.length===1?r[0]:function(t){return r.reduce(function(n,s){return s(n)},t)}}var Rv=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var s=this,i=yM(e)?e:new Sd(e,t,n);return Kc(function(){var a=s,c=a.operator,u=a.source;i.add(c?c.call(i,u):u?s._subscribe(i):s._trySubscribe(i))}),i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=jv(t),new t(function(s,i){var a=new Sd({next:function(c){try{e(c)}catch(u){i(u),a.unsubscribe()}},error:i,complete:s});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[pM]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return mM(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=jv(e),new e(function(n,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return n(i)})})},r.create=function(e){return new r(e)},r}();function jv(r){var e;return(e=r??cM.Promise)!==null&&e!==void 0?e:Promise}function vM(r){return r&&vn(r.next)&&vn(r.error)&&vn(r.complete)}function yM(r){return r&&r instanceof jf||vM(r)&&Ly(r)}function bM(r){return vn(r?.lift)}function wM(r){return function(e){if(bM(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function xM(r,e,t,n,s){return new _M(r,e,t,n,s)}var _M=function(r){Ki(e,r);function e(t,n,s,i,a,c){var u=r.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=c,u._next=n?function(h){try{n(h)}catch(d){t.error(d)}}:r.prototype._next,u._error=i?function(h){try{i(h)}catch(d){t.error(d)}finally{this.unsubscribe()}}:r.prototype._error,u._complete=s?function(){try{s()}catch(h){t.error(h)}finally{this.unsubscribe()}}:r.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(jf),SM=Ry(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Lf=function(r){Ki(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new Lv(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new SM},e.prototype.next=function(t){var n=this;Kc(function(){var s,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=bd(n.currentObservers),c=a.next();!c.done;c=a.next()){var u=c.value;u.next(t)}}catch(h){s={error:h}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var n=this;Kc(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var s=n.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;Kc(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,s=this,i=s.hasError,a=s.isStopped,c=s.observers;return i||a?jy:(this.currentObservers=null,c.push(t),new jl(function(){n.currentObservers=null,_d(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,s=n.hasError,i=n.thrownError,a=n.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new Rv;return t.source=this,t},e.create=function(t,n){return new Lv(t,n)},e}(Rv),Lv=function(r){Ki(e,r);function e(t,n){var s=r.call(this)||this;return s.destination=t,s.source=n,s}return e.prototype.next=function(t){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.next)===null||s===void 0||s.call(n,t)},e.prototype.error=function(t){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.error)===null||s===void 0||s.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,s;return(s=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&s!==void 0?s:jy},e}(Lf),Fv=function(r){Ki(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,s=t.thrownError,i=t._value;if(n)throw s;return this._throwIfClosed(),i},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e}(Lf);function Fn(r,e){return wM(function(t,n){var s=0;t.subscribe(xM(n,function(i){return r.call(e,i,s++)&&n.next(i)}))})}const Fy=new Lf,CM=(r,e)=>{Fy.next({key:r,value:e})},De={subject:Fy,dispatch:CM},Nt=[];for(let r=0;r<256;++r)Nt.push((r+256).toString(16).slice(1));function TM(r,e=0){return(Nt[r[e+0]]+Nt[r[e+1]]+Nt[r[e+2]]+Nt[r[e+3]]+"-"+Nt[r[e+4]]+Nt[r[e+5]]+"-"+Nt[r[e+6]]+Nt[r[e+7]]+"-"+Nt[r[e+8]]+Nt[r[e+9]]+"-"+Nt[r[e+10]]+Nt[r[e+11]]+Nt[r[e+12]]+Nt[r[e+13]]+Nt[r[e+14]]+Nt[r[e+15]]).toLowerCase()}let jh;const EM=new Uint8Array(16);function kM(){if(!jh){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");jh=crypto.getRandomValues.bind(crypto)}return jh(EM)}const IM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Nv={randomUUID:IM};function Ot(r,e,t){if(Nv.randomUUID&&!r)return Nv.randomUUID();r=r||{};const n=r.random??r.rng?.()??kM();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,TM(n)}var Ny=(r=>(r.IMAGE="image",r.VIDEO="video",r.AUDIO="audio",r))(Ny||{});const AM=r=>{const[e,t]=v.useState(!1),[n,s]=v.useState(!1),i=v.useCallback(d=>{const p={...d,id:Ot()};switch(d.type){case"image":De.dispatch(qi,{payload:p});break;case"video":De.dispatch(Xi,{payload:p});break;case"audio":De.dispatch(Gi,{payload:p});break}},[]),a=v.useCallback(d=>{d.preventDefault();try{const p=d.dataTransfer?.types[0],g=JSON.parse(p);if(!Object.values(Ny).includes(g.type))return;s(!0),t(!0),r?.(!0)}catch(p){console.error("Error parsing dragged data:",p)}},[r]),c=v.useCallback(d=>{d.preventDefault(),e&&(s(!0),r?.(!0))},[e,r]),u=v.useCallback(d=>{if(n){d.preventDefault(),s(!1),r?.(!1);try{const p=d.dataTransfer?.types[0],g=JSON.parse(d.dataTransfer.getData(p));i(g)}catch(p){console.error("Error parsing dropped data:",p)}}},[n,r,i]),h=v.useCallback(d=>{d.preventDefault(),d.currentTarget.contains(d.relatedTarget)||(s(!1),t(!1),r?.(!1))},[r]);return{onDragEnter:a,onDragOver:c,onDrop:u,onDragLeave:h,isDraggingOver:n}},Vy=({children:r,className:e,style:t,onDragStateChange:n,id:s})=>{const{onDragEnter:i,onDragOver:a,onDrop:c,onDragLeave:u}=AM(n);return b.jsx("div",{id:s,onDragEnter:i,onDrop:c,onDragOver:a,onDragLeave:u,className:e,style:t,role:"region","aria-label":"Droppable area for images, videos, and audio",children:r})},OM=({size:r,children:e})=>{const[t,n]=v.useState(!1);return b.jsxs(Vy,{id:"artboard",onDragStateChange:n,style:{width:r.width,height:r.height},className:"designcombo_scene pointer-events-auto mt-3.5 bg-black",children:[b.jsx("div",{style:{width:r.width,height:r.height},className:`pointer-events-none absolute z-50 mt-3.5 transition-colors duration-200 ease-in-out ${t?"border-4 border-dashed border-white bg-white/[0.075]":"bg-transparent"} shadow-[0_0_0_5000px_#1D1D1F]`}),e]})},MM=100,PM=30,DM=18,RM=14,jM=30,LM=24,FM=16,By=12,NM="Regular",zy="sans-serif",va=188,ol=40,VM=4e3,Wy=1920,Hy=1080,Uy=60,$y=1e3/Uy,BM=2e6,zM=1e7,WM=48e3,HM=192e3,Ff=2.3,UM=Wy/Ff,$M=Hy/Ff,YM=184,XM=348,GM=512,qM=300,KM=0,ZM=5e3,JM=1,QM=0,eP=0,tP=0,rP=359,nP=1,sP=0,iP=!1,oP=!1,aP=0,cP=2,lP=.01,uP=1,hP=0,dP=3,fP=.01,pP=1,gP=0,mP=1,vP=.01,yP=.5,bP=-1e3,wP=1e3,xP=1,_P=1,SP=0,CP=1,TP=.01,EP=1,kP=0,IP=1,AP=.01,OP=0,MP=.5,PP=10,DP=.01,RP=1,jP=0,LP=1,FP=.01,NP=1,Ll=16,Cd=80;function Yy(r){if(!r)return"0";const e=r/va,t=Math.trunc(e)%60,n=Math.trunc(e/60)%60,s=Math.trunc(e/3600)%60,a=[Math.trunc(e/216e3).toString(),s.toString(),n.toString(),t.toString()];return e<60?`${a[3].padStart(2,"0")}f`:e<3600?`${a[2].padStart(1,"0")}s`:e<216e3?`${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`:`${a[0].padStart(2,"0")}:${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`}function VP(r,e=!1){if(!r)return"00:00";const n=1e3/60;if(r<1e3)return e?`${Math.floor(r/n)}f`:`${(r/1e3).toFixed(1)}s`;const s=Math.floor(r/1e3);if(s<60)return`${s}s`;const i=Math.floor(s/60);if(i<60){const h=s%60;return`${i.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}const a=Math.floor(i/60),c=i%60,u=s%60;return`${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}function ea(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}const Xy=({frame:r},{fps:e})=>{const t=r/e,n=Math.floor(t/3600),s=t%3600,i=Math.floor(s/60),a=Math.floor(s%60),c=Math.floor((s-Math.floor(s))*100);return n>0?`${n}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`:`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},Gy=({time:r})=>{const e=r/1e3,t=Math.floor(e/3600),n=e%3600,s=Math.floor(n/60),i=Math.floor(n%60),a=Math.floor((n-Math.floor(n))*100);return t>0?`${t}:${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},qy=()=>{const r=document.getElementById("video-current-time");return(r?parseFloat(r.getAttribute("data-current-time")??""):0)*1e3},en=[{index:0,unit:18e3,zoom:1/18e3,segments:5},{index:1,unit:10800,zoom:1/10800,segments:3},{index:2,unit:7200,zoom:1/7200,segments:2},{index:3,unit:3600,zoom:1/3600,segments:1},{index:4,unit:1800,zoom:1/1800,segments:2},{index:5,unit:900,zoom:1/900,segments:3},{index:6,unit:600,zoom:1/600,segments:2},{index:7,unit:300,zoom:1/300,segments:5},{index:8,unit:180,zoom:1/180,segments:3},{index:9,unit:120,zoom:1/120,segments:10},{index:10,unit:60,zoom:1/60,segments:5},{index:11,unit:60,zoom:1/60,segments:5},{index:12,unit:30,zoom:1/30,segments:2},{index:13,unit:15,zoom:1/15,segments:3},{index:14,unit:10,zoom:1/10,segments:2},{index:15,unit:5,zoom:1/5,segments:5},{index:16,unit:3,zoom:1/3,segments:3},{index:17,unit:2,zoom:1/2,segments:5},{index:18,unit:1,zoom:1,segments:5},{index:19,unit:1,zoom:2,segments:5},{index:20,unit:1,zoom:4,segments:10}];function Nf(r,e){let t=-1,n=r.length-1;for(;1+t<n;){const s=t+(n-t>>1);e(r[s],s,r)?n=s:t=s}return n}function BP(r,e=1){const t=()=>{const u=Math.max(0,ol),d=document.getElementById("designcombo-timeline-canvas")?.offsetWidth??document.body.offsetWidth;return Math.max(1,d-u)},n=()=>typeof r=="number"?xt(r,e):tb(r,e),s=t()/n(),i=e*s;return{segments:5,index:Nf(en,c=>c.zoom>i),zoom:i,unit:1/i}}function zP(r){return en[r]}function Ky(r){return Zy(r)||en[0]}const Zy=r=>{const e=en.filter(n=>n.zoom<r.zoom);return e.length===0?null:e.reduce((n,s)=>s.zoom>n.zoom?s:n)},Jy=r=>{const e=en.filter(n=>n.zoom>r.zoom);return e.length===0?null:e.reduce((n,s)=>s.zoom<n.zoom?s:n)};function Qy(r){return Jy(r)||en[en.length-1]}function WP(r){const e=en.at(-1),t=r===e,s=eb(r)-(t?1:2);return Math.max(0,s)}function eb(r){const e=Nf(en,t=>t.zoom>r.zoom);return Math.min(en.length-1,e)}function xt(r,e=1,t=1){const n=va*e;return r*(60/1e3)*n/t}function cs(r,e=1){const t=va*e;return r/t*$y}function tb(r,e=1){return xt(r,e)}const HP=Math.floor(Math.random()*1e3)+1;function Vf(r,e=1){const t=[],n=Math.floor(e),s=(i,a)=>{for(const c of i)Array.isArray(c)&&a<n?s(c,a+1):t.push(c)};return s(r,0),t}function Bf(r,e){const t=e.sort((s,i)=>s.tempIndex-i.tempIndex),n=[];for(const s of t)s.tempIndex<0&&n.push(s);n.push(r);for(const s of t)s.tempIndex>=0&&n.push(s);return n}const Td={id:"font_UwdNKSyVq2iiMiuHSRRsUIOu",family:"Roboto",fullName:"Roboto Bold",postScriptName:"Roboto-Bold",preview:"https://ik.imagekit.io/lh/fonts/v2/5zQgS86djScKA0ri67BBCqW7.png",style:"Roboto-Bold",url:"https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmWUlvAx05IsDqlA.ttf",category:"sans-serif",createdAt:"2023-06-20T04:42:55.909Z",updatedAt:"2023-06-20T04:42:55.909Z",userId:null},rb=r=>{const e=r.map(t=>new FontFace(t.fontFamily,`url(${t.fontUrl})`).load());return e.length===0?Promise.resolve(!0):new Promise((t,n)=>{Promise.all(e).then(s=>{s.forEach(i=>{i instanceof FontFace&&i.family&&(document.fonts.add(i),t(!0))})}).catch(s=>{n(s)})})},Vv=r=>{let e;const t=new Set,n=(h,d)=>{const p=typeof h=="function"?h(e):h;if(!Object.is(p,e)){const g=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(y=>y(e,g))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h))},u=e=r(n,s,c);return c},UP=r=>r?Vv(r):Vv,$P=r=>r;function YP(r,e=$P){const t=v.useSyncExternalStore(r.subscribe,()=>e(r.getState()),()=>e(r.getInitialState()));return v.useDebugValue(t),t}const Bv=r=>{const e=UP(r),t=n=>YP(e,n);return Object.assign(t,e),t},nb=r=>r?Bv(r):Bv,bn=nb(r=>({timeline:null,size:{width:1080,height:1920},duration:5e3,fps:30,scale:{index:7,unit:300,zoom:1/300,segments:5},scroll:{left:0,top:0},playerRef:null,activeIds:[],targetIds:[],tracks:[],trackItemIds:[],transitionIds:[],transitionsMap:{},trackItemDetailsMap:{},trackItemsMap:{},setTimeline:e=>{r(()=>({timeline:e}))},setScale:e=>{r(()=>({scale:e}))},setScroll:e=>{r(()=>({scroll:e}))},setState:async e=>{r({...e})},setPlayerRef:e=>{r({playerRef:e})}}));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sb=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var GP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=v.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...c},u)=>v.createElement("svg",{ref:u,...GP,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:sb("lucide",s),...c},[...a.map(([h,d])=>v.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=(r,e)=>{const t=v.forwardRef(({className:n,...s},i)=>v.createElement(qP,{ref:i,iconNode:e,className:sb(`lucide-${XP(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=rr("Captions",[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=rr("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=rr("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=rr("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=rr("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=rr("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=rr("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=rr("SquareSplitHorizontal",[["path",{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3",key:"lubmu8"}],["path",{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3",key:"1ag34g"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=rr("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=rr("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=rr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=rr("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=rr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=rr("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=rr("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Fl=r=>{const e=v.useCallback(n=>{if(!r?.current)return()=>{};const s=()=>{n()};return r.current.addEventListener("frameupdate",s),()=>{r.current&&r.current.removeEventListener("frameupdate",s)}},[r]);return v.useSyncExternalStore(e,()=>r?.current?.getCurrentFrame()??0,()=>0)},ya=()=>{const[r,e]=v.useState(!1);return v.useEffect(()=>{const n=De.subject.pipe(Fn(({key:s})=>s.startsWith(Py))).subscribe(s=>{s.key===Df?e(!0):s.key===Qo&&e(!1)});return()=>n.unsubscribe()},[]),r},ob=()=>{const[r,e]=v.useState(!1),{duration:t,fps:n,scale:s,playerRef:i,activeIds:a}=bn(),c=Fl(i),u=()=>{De.dispatch(Ef)},h=()=>{De.dispatch(If,{payload:{},options:{time:qy()}})},d=y=>{De.dispatch(Pf,{payload:{scale:y}})},p=()=>{De.dispatch(Cf)},g=()=>{De.dispatch(Tf)};return v.useEffect(()=>(i?.current?.addEventListener("play",()=>{e(!0)}),i?.current?.addEventListener("pause",()=>{e(!1)}),()=>{i?.current?.removeEventListener("play",()=>{e(!0)}),i?.current?.removeEventListener("pause",()=>{e(!1)})}),[i]),b.jsx("div",{style:{position:"relative",height:"50px",boxShadow:"inset 0 1px 0 0 #27272a",flex:"none"},className:"bg-background",children:b.jsx("div",{style:{position:"absolute",height:50,width:"100%",display:"flex",alignItems:"center"},children:b.jsxs("div",{style:{height:36,width:"100%",display:"grid",gridTemplateColumns:"1fr 260px 1fr",alignItems:"center"},children:[b.jsxs("div",{className:"flex px-2",children:[b.jsxs(st,{disabled:!a.length,onClick:u,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[b.jsx(r3,{size:14})," Delete"]}),b.jsxs(st,{disabled:!a.length,onClick:h,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[b.jsx(zv,{size:15})," Split"]}),b.jsxs(st,{disabled:!a.length,onClick:()=>{De.dispatch(kf)},variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[b.jsx(zv,{size:15})," Clone"]})]}),b.jsxs("div",{className:"flex items-center justify-center",children:[b.jsxs("div",{children:[b.jsx(st,{onClick:u,variant:"ghost",size:"icon",children:b.jsx(e3,{size:14})}),b.jsx(st,{onClick:()=>{if(r)return g();p()},variant:"ghost",size:"icon",children:r?b.jsx(JP,{size:14}):b.jsx(QP,{size:14})}),b.jsx(st,{onClick:h,variant:"ghost",size:"icon",children:b.jsx(t3,{size:14})})]}),b.jsxs("div",{className:"text-xs font-light",style:{display:"grid",alignItems:"center",gridTemplateColumns:"54px 4px 54px",paddingTop:"2px",justifyContent:"center"},children:[b.jsx("div",{className:"font-medium text-zinc-200",style:{display:"flex",justifyContent:"center"},"data-current-time":c/n,id:"video-current-time",children:Xy({frame:c},{fps:n})}),b.jsx("span",{children:"/"}),b.jsx("div",{className:"text-muted-foreground",style:{display:"flex",justifyContent:"center"},children:Gy({time:t})})]})]}),b.jsx(c3,{scale:s,onChangeTimelineScale:d,duration:t})]})})})},c3=({scale:r,onChangeTimelineScale:e,duration:t})=>{const n=()=>{const i=Ky(r);e(i)},s=()=>{const i=Qy(r);e(i)};return b.jsx("div",{className:"flex items-center justify-end",children:b.jsxs("div",{className:"flex border-l border-border pl-4 pr-2",children:[b.jsx(st,{size:"icon",variant:"ghost",onClick:n,disabled:r.index===0,children:b.jsx(a3,{size:16})}),b.jsx(st,{size:"icon",variant:"ghost",onClick:s,disabled:r.index===20,children:b.jsx(o3,{size:16})})]})})},ab=[{id:"1",details:{src:"https://cdn.designcombo.dev/audio/Dawn%20of%20change.mp3",text:"Voiceover"},name:"Dawn of change",type:"audio",metadata:{author:"Roman Senyk"},display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/audio/Hope.mp3"},name:"Hope",type:"audio",metadata:{author:"Hugo Dujardin"}},{id:"3",details:{src:"https://cdn.designcombo.dev/audio/Tenderness.mp3"},name:"Tenderness",type:"audio",metadata:{author:"Benjamin Tissot"}},{id:"4",details:{src:"https://cdn.designcombo.dev/audio/Piano%20Moment.mp3"},name:"Piano moment",type:"audio",metadata:{author:"Benjamin Tissot"}}],cb=[{id:"1",details:{src:"https://ik.imagekit.io/wombo/images/img1.jpg"},preview:"https://ik.imagekit.io/wombo/images/img1.jpg?tr=w-190",type:"image"},{id:"2",details:{src:"https://ik.imagekit.io/wombo/images/img2.jpg"},preview:"https://ik.imagekit.io/wombo/images/img2.jpg?tr=w-190",type:"image"},{id:"3",details:{src:"https://ik.imagekit.io/wombo/images/img3.jpg"},preview:"https://ik.imagekit.io/wombo/images/img3.jpg?tr=w-190",type:"image"},{id:"4",details:{src:"https://ik.imagekit.io/wombo/images/img4.jpg"},preview:"https://ik.imagekit.io/wombo/images/img4.jpg?tr=w-190",type:"image"},{id:"5",details:{src:"https://ik.imagekit.io/wombo/images/img5.jpg"},preview:"https://ik.imagekit.io/wombo/images/img5.jpg?tr=w-190",type:"image"},,{id:"6",details:{src:"https://ik.imagekit.io/wombo/images/img6.jpg"},preview:"https://ik.imagekit.io/wombo/images/img6.jpg?tr=w-190",type:"image"},{id:"7",details:{src:"https://ik.imagekit.io/wombo/images/img7.jpg"},preview:"https://ik.imagekit.io/wombo/images/img7.jpg?tr=w-190",type:"image"}],lb=[{id:"1",details:{src:"https://cdn.designcombo.dev/videos/demo-video-1.mp4",text:"Scene"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-1.png",duration:17e3,display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/videos/demo-video-2.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-2.png"},{id:"3",details:{src:"https://cdn.designcombo.dev/videos/demo-video-3.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-3.png",duration:2e4},{id:"4",details:{src:"https://cdn.designcombo.dev/videos/demo-video-4.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-4.png",duration:2e4},{id:"5",details:{src:"https://cdn.designcombo.dev/videos/demo-video-5.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-5.png",duration:23e3},{id:"6",details:{src:"https://cdn.designcombo.dev/videos/demo-video-6.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-6.png",duration:1e4},{id:"7",details:{src:"https://cdn.designcombo.dev/videos/demo-video-7.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-7.png",duration:12e3},{id:"8",details:{src:"https://cdn.designcombo.dev/videos/demo-video-8.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-8.png",duration:15e3},{id:"9",details:{src:"https://cdn.designcombo.dev/videos/demo-video-9.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-9.png",duration:15e3},{id:"10",details:{src:"https://cdn.designcombo.dev/videos/demo-video-10.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-10.png",duration:5e3},{id:"11",details:{src:"https://cdn.designcombo.dev/videos/demo-video-11.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-11.png",duration:5e3}],ub=[{id:"1",kind:"none",duration:0,preview:"https://ik.imagekit.io/wombo/transitions-v2/transition-none.png",type:"transition"},{id:"2",kind:"fade",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/fade.webp",type:"transition"},{id:"3",kind:"slide",name:"slide up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-up.webp",type:"transition",direction:"from-bottom"},{id:"4",kind:"slide",name:"slide down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-down.webp",type:"transition",direction:"from-top"},{id:"5",kind:"slide",name:"slide left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-left.webp",type:"transition",direction:"from-right"},{id:"6",kind:"slide",name:"slide right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-right.webp",type:"transition",direction:"from-left"},{id:"7",kind:"wipe",name:"wipe up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-up.webp",type:"transition",direction:"from-bottom"},{id:"8",kind:"wipe",name:"wipe down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-down.webp",type:"transition",direction:"from-top"},{id:"9",kind:"wipe",name:"wipe left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-left.webp",type:"transition",direction:"from-right"},{id:"10",kind:"wipe",name:"wipe right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-right.webp",type:"transition",direction:"from-left"},{id:"11",kind:"flip",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/flip.webp",type:"transition"},{id:"12",kind:"clockWipe",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/clock-wipe.webp",type:"transition"},{id:"13",kind:"star",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/star.webp",type:"transition"},{id:"14",kind:"circle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/circle.webp",type:"transition"},{id:"15",kind:"rectangle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/rectangle.webp",type:"transition"}],l3=[{id:"1",src:"https://ik.imagekit.io/snapmotion/upload-video-1.mp4",type:"video"},{id:"2",src:"https://ik.imagekit.io/snapmotion/upload-video-2.mp4",type:"video"},{id:"3",src:"https://ik.imagekit.io/snapmotion/upload-video-3.mp4",type:"video"}],u3=()=>{const r=ya();return b.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Transitions"}),b.jsx(ti,{children:b.jsx("div",{className:"grid grid-cols-3 gap-2 px-4",children:ub.map((e,t)=>b.jsx(h3,{transition:e,shouldDisplayPreview:!r},t))})})]})},h3=({transition:r,shouldDisplayPreview:e})=>{const t=v.useMemo(()=>({backgroundImage:`url(${r.preview})`,backgroundSize:"cover",width:"70px",height:"70px"}),[r.preview]);return b.jsx(ma,{data:r,renderCustomPreview:b.jsx("div",{style:t}),shouldDisplayPreview:e,children:b.jsxs("div",{children:[b.jsx("div",{children:b.jsx("div",{style:t,draggable:!1})}),b.jsx("div",{className:"flex h-6 items-center overflow-ellipsis text-nowrap text-[12px] capitalize text-muted-foreground",children:r.name||r.type})]})})},d3=()=>{const r=()=>{De.dispatch(Sf,{payload:{id:Ot(),display:{from:0,to:5e3},details:{text:"Heading and some body",fontSize:120,width:600,fontUrl:Td.url,fontFamily:Td.postScriptName,color:"#ffffff",wordWrap:"break-word",textAlign:"center",borderWidth:0,borderColor:"#000000",boxShadow:{color:"#ffffff",x:0,y:0,blur:0}}},options:{}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Text"}),b.jsx("div",{className:"flex flex-col gap-2 px-4",children:b.jsx(st,{draggable:!1,onClick:r,variant:"secondary",className:"w-full",children:"Add text"})})]})},f3=()=>{const r=v.useRef(null),e=n=>{t(n)},t=async n=>{const s=n[0].type;s.includes("audio")&&De.dispatch(Gi,{payload:{id:Ot(),details:{src:URL.createObjectURL(n[0]),volume:50}}}),s.includes("video")&&De.dispatch(Xi,{payload:{id:Ot(),display:{from:2e3,to:7e3},details:{src:URL.createObjectURL(n[0]),name:n[0].name}}}),s.includes("image")&&De.dispatch(qi,{payload:{id:Ot(),details:{src:URL.createObjectURL(n[0])}}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Your media"}),b.jsx("input",{ref:r,id:"file-upload-handle",type:"file",accept:"audio/*,video/*,image/*",onChange:n=>e(Array.from(n.target.files||[])),className:"hidden"}),b.jsx("div",{className:"px-4 py-2",children:b.jsx("div",{children:b.jsxs(_y,{defaultValue:"projects",className:"w-full",children:[b.jsxs(_f,{className:"grid w-full grid-cols-2",children:[b.jsx(sl,{value:"projects",children:"Project"}),b.jsx(sl,{value:"workspace",children:"Workspace"})]}),b.jsxs(il,{value:"projects",children:[b.jsxs(st,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[b.jsx(Wv,{size:16})," Upload"]}),b.jsx("div",{})]}),b.jsx(il,{value:"workspace",children:b.jsxs(st,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[b.jsx(Wv,{size:16})," Upload"]})})]})})}),b.jsx(ti,{children:b.jsx("div",{className:"masonry-sm px-4"})})]})},p3=()=>{const r=ya(),e=t=>{De.dispatch(Gi,{payload:t,options:{}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Audios"}),b.jsx(ti,{children:b.jsx("div",{className:"flex flex-col px-2",children:ab.map((t,n)=>b.jsx(g3,{shouldDisplayPreview:!r,handleAddAudio:e,audio:t},n))})})]})},g3=({handleAddAudio:r,audio:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:"url(https://cdn.designcombo.dev/thumbnails/music-preview.png)",backgroundSize:"cover",width:"70px",height:"70px"}),[]);return b.jsx(ma,{data:e,renderCustomPreview:b.jsx("div",{style:n}),shouldDisplayPreview:t,children:b.jsxs("div",{draggable:!1,onClick:()=>r(e),style:{display:"grid",gridTemplateColumns:"48px 1fr"},className:"flex cursor-pointer gap-4 px-2 py-1 text-sm hover:bg-zinc-800/70",children:[b.jsx("div",{className:"flex h-12 items-center justify-center bg-zinc-800",children:b.jsx(ib,{width:16})}),b.jsxs("div",{className:"flex flex-col justify-center",children:[b.jsx("div",{children:e.name}),b.jsx("div",{className:"text-zinc-400",children:e.metadata?.author})]})]})})},m3=()=>{const r=ya(),e=t=>{De.dispatch(qi,{payload:t,options:{trackId:"main"}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Photos"}),b.jsx(ti,{children:b.jsx("div",{className:"masonry-sm px-4",children:cb.map((t,n)=>b.jsx(v3,{image:t,shouldDisplayPreview:!r,handleAddImage:e},n))})})]})},v3=({handleAddImage:r,image:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return b.jsx(ma,{data:e,renderCustomPreview:b.jsx("div",{style:n}),shouldDisplayPreview:t,children:b.jsx("div",{onClick:()=>r({id:Ot(),details:{src:e.details.src}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:b.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},y3=()=>{const r=ya(),e=t=>{De.dispatch(Xi,{payload:t,options:{resourceId:"main"}})};return b.jsxs("div",{className:"flex flex-1 flex-col",children:[b.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Videos"}),b.jsx(ti,{children:b.jsx("div",{className:"masonry-sm px-4",children:lb.map((t,n)=>b.jsx(b3,{video:t,shouldDisplayPreview:!r,handleAddVideo:e},n))})})]})},b3=({handleAddVideo:r,video:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return b.jsx(ma,{data:e,renderCustomPreview:b.jsx("div",{style:n,className:"draggable"}),shouldDisplayPreview:t,children:b.jsx("div",{onClick:()=>r({...e,id:Ot(),details:{src:e.details.src,...e.details}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:b.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},Nl=nb(r=>({activeMenuItem:null,showMenuItem:!1,cropTarget:null,showControlItem:!1,showToolboxItem:!1,activeToolboxItem:null,setCropTarget:e=>r({cropTarget:e}),setActiveMenuItem:e=>r({activeMenuItem:e}),setShowMenuItem:e=>r({showMenuItem:e}),setShowControlItem:e=>r({showControlItem:e}),setShowToolboxItem:e=>r({showToolboxItem:e}),setActiveToolboxItem:e=>r({activeToolboxItem:e})})),w3=({children:r})=>{const{showMenuItem:e,setShowMenuItem:t}=Nl(),n=()=>{t(!1)};return b.jsxs("div",{style:{left:e?"0":"-100%",transition:"left 0.25s ease-in-out",zIndex:200},className:"absolute top-1/2 mt-6 flex h-[calc(100%-32px-64px)] w-[340px] -translate-y-1/2 rounded-lg shadow-lg",children:[b.jsx("div",{className:"w-[74px]"}),b.jsxs("div",{className:"relative flex flex-1 bg-background/80 backdrop-blur-lg backdrop-filter",children:[b.jsx(st,{variant:"ghost",className:"absolute right-2 top-2 h-8 w-8 text-muted-foreground",size:"icon",children:b.jsx(i3,{width:16,onClick:n})}),r]})]})},x3=()=>{const{activeMenuItem:r}=Nl();return r==="transitions"?b.jsx(u3,{}):r==="texts"?b.jsx(d3,{}):r==="videos"?b.jsx(y3,{}):r==="audios"?b.jsx(p3,{}):r==="images"?b.jsx(m3,{}):r==="uploads"?b.jsx(f3,{}):null},hb=()=>b.jsx(w3,{children:b.jsx(x3,{})}),Rn={audio:ib,captions:KP,image:ZP,redo:({...r})=>b.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2957 4.15721C13.9052 3.76669 13.9052 3.13352 14.2957 2.743C14.6862 2.35247 15.3194 2.35247 15.7099 2.743L20.953 7.98603C21.1387 8.16758 21.2539 8.42087 21.2539 8.70108C21.2539 8.70111 21.2539 8.70114 21.2539 8.70117C21.2539 8.70431 21.2539 8.70744 21.2539 8.71057C21.2518 8.93273 21.1773 9.13757 21.0528 9.30262C21.0249 9.33973 20.9942 9.37505 20.961 9.40828L15.7099 14.6593C15.3194 15.0499 14.6862 15.0499 14.2957 14.6593C13.9052 14.2688 13.9052 13.6357 14.2957 13.2451L17.8398 9.70108H9.22665C8.59943 9.70108 7.97836 9.82462 7.39888 10.0646C6.81941 10.3047 6.29289 10.6565 5.84938 11.1C5.40587 11.5435 5.05406 12.07 4.81403 12.6495C4.57401 13.229 4.45047 13.85 4.45047 14.4773C4.45047 15.1045 4.57401 15.7256 4.81403 16.305C5.05406 16.8845 5.40587 17.411 5.84938 17.8545C6.29289 18.298 6.81941 18.6498 7.39888 18.8899C7.97836 19.1299 8.59943 19.2534 9.22665 19.2534H12.9024C13.4547 19.2534 13.9024 19.7012 13.9024 20.2534C13.9024 20.8057 13.4547 21.2534 12.9024 21.2534H9.22665C8.33679 21.2534 7.45564 21.0782 6.63352 20.7376C5.81139 20.3971 5.06439 19.898 4.43517 19.2687C3.80594 18.6395 3.30681 17.8925 2.96627 17.0704C2.62574 16.2483 2.45047 15.3671 2.45047 14.4773C2.45047 13.5874 2.62574 12.7063 2.96627 11.8841C3.30681 11.062 3.80594 10.315 4.43517 9.68578C5.06439 9.05655 5.81139 8.55742 6.63352 8.21689C7.45564 7.87635 8.33679 7.70108 9.22665 7.70108H17.8396L14.2957 4.15721Z",fill:"currentColor"})}),shapes:({...r})=>b.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:[b.jsx("g",{clipPath:"url(#clip0_2077_2705)",children:b.jsx("path",{d:"M3.75 12H2.25V20.25C2.25 20.6478 2.40804 21.0294 2.68934 21.3107C2.97064 21.592 3.35218 21.75 3.75 21.75H9.75V20.25H3.75V12ZM21 21.75H12.75C12.6197 21.75 12.4916 21.716 12.3784 21.6514C12.2652 21.5868 12.1708 21.4938 12.1045 21.3816C12.0382 21.2694 12.0022 21.1419 12.0002 21.0116C11.9982 20.8813 12.0302 20.7527 12.093 20.6385L16.218 13.1385C16.2821 13.0203 16.377 12.9218 16.4928 12.8534C16.6085 12.7849 16.7406 12.7492 16.875 12.75C17.1322 12.75 17.3895 12.879 17.532 13.1385L21.657 20.6385C21.7198 20.7527 21.7518 20.8813 21.7498 21.0116C21.7478 21.1419 21.7118 21.2694 21.6455 21.3816C21.5792 21.4938 21.4848 21.5868 21.3716 21.6514C21.2584 21.716 21.1303 21.75 21 21.75ZM14.0182 20.25H19.7318L16.875 15.0563L14.0182 20.25ZM20.25 2.25H12V3.75H20.25V14.244H21.75V3.75C21.75 3.35218 21.592 2.97064 21.3107 2.68934C21.0294 2.40804 20.6478 2.25 20.25 2.25ZM8.25 2.25H3.75C3.35218 2.25 2.97064 2.40804 2.68934 2.68934C2.40804 2.97064 2.25 3.35218 2.25 3.75V8.25C2.25 8.64782 2.40804 9.02936 2.68934 9.31066C2.97064 9.59196 3.35218 9.75 3.75 9.75H8.25C8.64782 9.75 9.02936 9.59196 9.31066 9.31066C9.59196 9.02936 9.75 8.64782 9.75 8.25V3.75C9.75 3.35218 9.59196 2.97064 9.31066 2.68934C9.02936 2.40804 8.64782 2.25 8.25 2.25ZM8.25 8.25H3.75V3.75H8.25V8.25Z",fill:"currentColor"})}),b.jsx("defs",{children:b.jsx("clipPath",{id:"clip0_2077_2705",children:b.jsx("rect",{width:"24",height:"24",fill:"white"})})})]}),type:n3,undo:({...r})=>b.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:b.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.60387 4.30711C9.99439 3.91659 9.99439 3.28342 9.60387 2.8929C9.21334 2.50238 8.58018 2.50237 8.18965 2.8929L2.8925 8.19004C2.70497 8.37758 2.59961 8.63193 2.59961 8.89715C2.59961 9.16237 2.70497 9.41672 2.8925 9.60426L8.18965 14.9014C8.58018 15.2919 9.21334 15.2919 9.60387 14.9014C9.99439 14.5109 9.99439 13.8777 9.60387 13.4872L5.86478 9.7481H15.1044C15.7383 9.7481 16.366 9.87295 16.9516 10.1155C17.5372 10.3581 18.0693 10.7136 18.5176 11.1619C18.9658 11.6101 19.3213 12.1422 19.5639 12.7278C19.8065 13.3134 19.9313 13.9411 19.9313 14.575C19.9313 15.2088 19.8065 15.8365 19.5639 16.4221C19.3213 17.0077 18.9658 17.5398 18.5176 17.9881C18.0693 18.4363 17.5372 18.7918 16.9516 19.0344C16.366 19.277 15.7383 19.4018 15.1044 19.4018H11.3964C10.8442 19.4018 10.3964 19.8495 10.3964 20.4018C10.3964 20.9541 10.8442 21.4018 11.3964 21.4018H15.1044C16.001 21.4018 16.8887 21.2252 17.717 20.8822C18.5452 20.5391 19.2978 20.0362 19.9318 19.4023C20.5657 18.7683 21.0686 18.0158 21.4116 17.1875C21.7547 16.3592 21.9313 15.4715 21.9313 14.575C21.9313 13.6784 21.7547 12.7907 21.4116 11.9624C21.0686 11.1342 20.5657 10.3816 19.9318 9.74764C19.2978 9.11371 18.5452 8.61085 17.717 8.26777C16.8887 7.92469 16.001 7.7481 15.1044 7.7481H6.16287L9.60387 4.30711Z",fill:"currentColor"})}),upload:({...r})=>b.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:[b.jsxs("g",{clipPath:"url(#clip0_2077_2699)",children:[b.jsx("path",{d:"M8.25 13.5L9.3075 14.5575L11.25 12.6225V21.75H12.75V12.6225L14.6925 14.5575L15.75 13.5L12 9.75L8.25 13.5Z",fill:"currentColor"}),b.jsx("path",{d:"M17.6249 16.5004H17.2499V15.0004H17.6249C18.52 15.0362 19.3927 14.715 20.0509 14.1074C20.7092 13.4997 21.0991 12.6555 21.1349 11.7604C21.1707 10.8653 20.8495 9.99264 20.2418 9.33438C19.6342 8.67613 18.79 8.28621 17.8949 8.25041H17.2499L17.1749 7.63541C17.0085 6.37275 16.3888 5.21362 15.4312 4.37395C14.4736 3.53428 13.2435 3.07132 11.9699 3.07132C10.6963 3.07132 9.46616 3.53428 8.50857 4.37395C7.55099 5.21362 6.93129 6.37275 6.76489 7.63541L6.74989 8.25041H6.10489C5.20979 8.28621 4.36557 8.67613 3.75795 9.33438C3.15033 9.99264 2.82909 10.8653 2.86489 11.7604C2.9007 12.6555 3.29062 13.4997 3.94887 14.1074C4.60712 14.715 5.47979 15.0362 6.37489 15.0004H6.74989V16.5004H6.37489C5.1722 16.4928 4.01477 16.0409 3.12513 15.2315C2.2355 14.4221 1.67646 13.3124 1.55549 12.1158C1.43453 10.9192 1.76018 9.72009 2.46983 8.74905C3.17949 7.77801 4.22305 7.10357 5.39989 6.85541C5.72367 5.3453 6.55552 3.99189 7.75663 3.02101C8.95774 2.05013 10.4555 1.52051 11.9999 1.52051C13.5443 1.52051 15.042 2.05013 16.2432 3.02101C17.4443 3.99189 18.2761 5.3453 18.5999 6.85541C19.7767 7.10357 20.8203 7.77801 21.53 8.74905C22.2396 9.72009 22.5653 10.9192 22.4443 12.1158C22.3233 13.3124 21.7643 14.4221 20.8747 15.2315C19.985 16.0409 18.8276 16.4928 17.6249 16.5004Z",fill:"currentColor"})]}),b.jsx("defs",{children:b.jsx("clipPath",{id:"clip0_2077_2699",children:b.jsx("rect",{width:"24",height:"24",fill:"white"})})})]}),video:s3};function _3(){const{setActiveMenuItem:r,setShowMenuItem:e,activeMenuItem:t,showMenuItem:n}=Nl();return b.jsxs("div",{style:{zIndex:201},className:"absolute left-2.5 top-1/2 mt-6 flex w-14 -translate-y-1/2 flex-col items-center rounded-lg bg-background/80 py-2 shadow-lg backdrop-blur-lg backdrop-filter",children:[b.jsx(st,{onClick:()=>{r("uploads"),e(!0)},className:Wt(n&&t==="uploads"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.upload,{width:20})}),b.jsx(st,{onClick:()=>{r("texts"),e(!0)},className:Wt(n&&t==="texts"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.type,{width:20})}),b.jsx(st,{onClick:()=>{r("videos"),e(!0)},className:Wt(n&&t==="videos"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.video,{width:20})}),b.jsx(st,{onClick:()=>{r("captions"),e(!0)},className:Wt(n&&t==="captions"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.captions,{width:20})}),b.jsx(st,{onClick:()=>{r("images"),e(!0)},className:Wt(n&&t==="images"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.image,{width:20})}),b.jsx(st,{onClick:()=>{r("shapes"),e(!0)},className:Wt(n&&t==="shapes"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.shapes,{width:20})}),b.jsx(st,{onClick:()=>{r("audios"),e(!0)},className:Wt(n&&t==="audios"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx(Rn.audio,{width:20})}),b.jsx(st,{onClick:()=>{r("transitions"),e(!0)},className:Wt(n&&t==="transitions"?"bg-secondary":"text-muted-foreground"),variant:"ghost",size:"icon",children:b.jsx("svg",{width:20,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("path",{d:"M3 5.30359C3 3.93159 4.659 3.24359 5.629 4.21359L11.997 10.5826L10.583 11.9966L5 6.41359V17.5856L10.586 11.9996L10.583 11.9966L11.997 10.5826L12 10.5856L18.371 4.21459C19.341 3.24459 21 3.93159 21 5.30359V18.6956C21 20.0676 19.341 20.7556 18.371 19.7856L12 13.5L13.414 11.9996L19 17.5866V6.41359L13.414 11.9996L13.421 12.0056L12.006 13.4206L12 13.4136L5.629 19.7846C4.659 20.7546 3 20.0676 3 18.6956V5.30359Z",fill:"currentColor"})})})]})}function db(){const r=()=>{De.dispatch(Of)},e=()=>{De.dispatch(Mf)};return b.jsx("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr 320px"},className:"pointer-events-none absolute left-0 right-0 top-0 z-[205] flex h-[72px] items-center px-2",children:b.jsxs("div",{className:"pointer-events-auto flex h-14 items-center gap-2",children:[b.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-md bg-background"}),b.jsxs("div",{className:"flex h-12 items-center bg-background px-1.5",children:[b.jsx(st,{onClick:r,className:"text-muted-foreground",variant:"ghost",size:"icon",children:b.jsx(Rn.undo,{width:20})}),b.jsx(st,{onClick:e,className:"text-muted-foreground",variant:"ghost",size:"icon",children:b.jsx(Rn.redo,{width:20})})]})]})})}var S3=Object.defineProperty,fb=(r,e)=>{for(var t in e)S3(r,t,{get:e[t],enumerable:!0,configurable:!0,set:n=>e[t]=()=>n})};if(typeof v.createContext!="function"){const r=['Remotion requires React.createContext, but it is "undefined".','If you are in a React Server Component, turn it into a client component by adding "use client" at the top of the file.',"","Before:",'  import {useCurrentFrame} from "remotion";',"","After:",'  "use client";','  import {useCurrentFrame} from "remotion";'];throw new Error(r.join(`
`))}function Hv(){return["NOD","E_EN","V"].join("")}var Uv=()=>["e","nv"].join(""),Ct=()=>{const r=typeof window<"u"&&window.remotion_isPlayer,e=typeof window<"u"&&typeof window.process<"u"&&typeof window.process.env<"u"&&(window.process[Uv()][Hv()]==="test"||window.process[Uv()][Hv()]==="production"&&typeof window<"u"&&typeof window.remotion_puppeteerTimeout<"u");return{isStudio:typeof window<"u"&&window.remotion_isStudio,isRendering:e,isPlayer:r}},C3=v.createElement,pb=[],gb=()=>{if(!Ct().isStudio)return;const r=new Proxy(C3,{apply(e,t,n){if(pb.includes(n[0])){const[s,i,...a]=n,c={...i??{},stack:new Error().stack};return Reflect.apply(e,t,[s,c,...a])}return Reflect.apply(e,t,n)}});v.createElement=r},ba=r=>{pb.push(r),gb()},mb=v.createContext(!1),T3=({children:r})=>b.jsx(mb.Provider,{value:!0,children:r}),zf=()=>v.useContext(mb);function Vl(r){return!!r}var Sc="4.0.229",E3=()=>{if(typeof globalThis>"u")return;const r=globalThis.remotion_imported||typeof window<"u"&&window.remotion_imported;if(r){if(r===Sc)return;throw new TypeError(` Multiple versions of Remotion detected: ${[Sc,typeof r=="string"?r:"an older version"].filter(Vl).join(" and ")}. This will cause things to break in an unexpected way.
Check that all your Remotion packages are on the same version. If your dependencies depend on Remotion, make them peer dependencies. You can also run \`npx remotion versions\` from your terminal to see which versions are mismatching.`)}globalThis.remotion_imported=Sc,typeof window<"u"&&(window.remotion_imported=Sc)},k3=(r,e)=>{const{style:t,...n}=r,s=v.useMemo(()=>({position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",...t}),[t]);return b.jsx("div",{ref:e,style:s,...n})},zo=v.forwardRef(k3),$t=v.createContext(null),Zi=v.createContext({registerSequence:()=>{throw new Error("SequenceManagerContext not initialized")},unregisterSequence:()=>{throw new Error("SequenceManagerContext not initialized")},sequences:[]}),wa=v.createContext({hidden:{},setHidden:()=>{throw new Error("SequenceVisibilityToggle not initialized")}}),I3=({children:r})=>{const[e,t]=v.useState([]),[n,s]=v.useState({}),i=v.useCallback(h=>{t(d=>[...d,h])},[]),a=v.useCallback(h=>{t(d=>d.filter(p=>p.id!==h))},[]),c=v.useMemo(()=>({registerSequence:i,sequences:e,unregisterSequence:a}),[i,e,a]),u=v.useMemo(()=>({hidden:n,setHidden:s}),[n]);return b.jsx(Zi.Provider,{value:c,children:b.jsx(wa.Provider,{value:u,children:r})})},Ji=v.createContext({getNonce:()=>0,fastRefreshes:0}),Wf=()=>{const r=v.useContext(Ji),[e,t]=v.useState(()=>r.getNonce()),n=v.useRef(r);return v.useEffect(()=>{n.current!==r&&(n.current=r,t(r.getNonce))},[r]),e},vb={};fb(vb,{useTimelineSetFrame:()=>Ob,useTimelinePosition:()=>ri,usePlayingState:()=>Yf,persistCurrentFrame:()=>kb,getInitialFrameState:()=>Ib,getFrameForComposition:()=>Ab,TimelineContext:()=>tn,SetTimelineContext:()=>Qi});var vs=v.createContext({compositions:[],registerComposition:()=>{},unregisterComposition:()=>{},registerFolder:()=>{},unregisterFolder:()=>{},setCurrentCompositionMetadata:()=>{},updateCompositionDefaultProps:()=>{},folders:[],currentCompositionMetadata:null,canvasContent:null,setCanvasContent:()=>{}}),Bl=v.createContext({props:{},updateProps:()=>{throw new Error("Not implemented")},resetUnsaved:()=>{throw new Error("Not implemented")}}),yb=v.createRef(),bb=({children:r})=>{const[e,t]=v.useState({}),n=v.useCallback(({defaultProps:a,id:c,newProps:u})=>{t(h=>({...h,[c]:typeof u=="function"?u(h[c]??a):u}))},[]),s=v.useCallback(()=>{t({})},[]);v.useImperativeHandle(yb,()=>({getProps:()=>e,setProps:t}),[e]);const i=v.useMemo(()=>({props:e,updateProps:n,resetUnsaved:s}),[e,s,n]);return b.jsx(Bl.Provider,{value:i,children:r})},A3={"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";"},$v={},O3=r=>{$v[r]||(console.warn(r),$v[r]=!0)},M3=r=>{for(const e of Object.keys(A3))if(r.includes(e))return{containsHex:!0,hexCode:e};return{containsHex:!1}},Ed=r=>r.startsWith("/")?Ed(r.substring(1)):r,P3=r=>{if(typeof window<"u"&&window.remotion_staticBase){if(r.startsWith(window.remotion_staticBase))throw new Error(`The value "${r}" is already prefixed with the static base ${window.remotion_staticBase}. You don't need to call staticFile() on it.`);return`${window.remotion_staticBase}/${Ed(r)}`}return`/${Ed(r)}`},D3=r=>r.split("/").map(s=>encodeURIComponent(s)).join("/"),R3=r=>{if(r===null)throw new TypeError("null was passed to staticFile()");if(typeof r>"u")throw new TypeError("undefined was passed to staticFile()");if(r.startsWith("http://")||r.startsWith("https://"))throw new TypeError(`staticFile() does not support remote URLs - got "${r}". Instead, pass the URL without wrapping it in staticFile(). See: https://remotion.dev/docs/staticfile-remote-urls`);if(r.startsWith("..")||r.startsWith("./"))throw new TypeError(`staticFile() does not support relative paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("/Users")||r.startsWith("/home")||r.startsWith("/tmp")||r.startsWith("/etc")||r.startsWith("/opt")||r.startsWith("/var")||r.startsWith("C:")||r.startsWith("D:")||r.startsWith("E:"))throw new TypeError(`staticFile() does not support absolute paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("public/"))throw new TypeError(`Do not include the public/ prefix when using staticFile() - got "${r}". See: https://remotion.dev/docs/staticfile-relative-paths`);const e=M3(r);e.containsHex&&O3(`WARNING: You seem to pass an already encoded path (path contains ${e.hexCode}). Since Remotion 4.0, the encoding is done by staticFile() itself. You may want to remove a encodeURIComponent() wrapping.`);const t=D3(r),n=P3(t);return n.startsWith("/")?n:`/${n}`},kd="remotion-date:",Id="remotion-file:",j3=({data:r,indent:e,staticBase:t})=>{let n=!1,s=!1,i=!1,a=!1;try{return{serializedString:JSON.stringify(r,function(u,h){const d=this[u];return d instanceof Date?(n=!0,`${kd}${d.toISOString()}`):d instanceof Map?(i=!0,h):d instanceof Set?(a=!0,h):typeof d=="string"&&t!==null&&d.startsWith(t)?(s=!0,`${Id}${d.replace(t+"/","")}`):h},e),customDateUsed:n,customFileUsed:s,mapUsed:i,setUsed:a}}catch(c){throw new Error("Could not serialize the passed input props to JSON: "+c.message)}},wb=r=>JSON.parse(r,(e,t)=>typeof t=="string"&&t.startsWith(kd)?new Date(t.replace(kd,"")):typeof t=="string"&&t.startsWith(Id)?R3(t.replace(Id,"")):t),js=r=>Ct().isStudio?wb(j3({data:r,indent:2,staticBase:window.remotion_staticBase}).serializedString):r,Yv=!1,L3=()=>{Yv||(Yv=!0,console.warn("Called `getInputProps()` on the server. This function is not available server-side and has returned an empty object."),console.warn("To hide this warning, don't call this function on the server:"),console.warn("  typeof window === 'undefined' ? {} : getInputProps()"))},xb=()=>{if(typeof window>"u")return L3(),{};if(Ct().isPlayer)throw new Error("You cannot call `getInputProps()` from a <Player>. Instead, the props are available as React props from component that you passed as `component` prop.");const r=window.remotion_inputProps;return r?wb(r):{}},Xv=["h264","h265","vp8","vp9","mp3","aac","wav","prores","h264-mkv","h264-ts","gif"];function F3(r,e){if(!(typeof r>"u")){if(typeof r!="string")throw new TypeError(`The "defaultCodec" prop ${e} must be a string, but you passed a value of type ${typeof r}.`);if(!Xv.includes(r))throw new Error(`The "defaultCodec" prop ${e} must be one of ${Xv.join(", ")}, but you passed ${r}.`)}}function al(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function Hf(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function _b(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`)}var Gv=({calculated:r,compositionId:e,compositionFps:t,compositionHeight:n,compositionWidth:s,compositionDurationInFrames:i})=>{const a=`calculated by calculateMetadata() for the composition "${e}"`,c=`of the "<Composition />" component with the id "${e}"`,u=r?.width??s??void 0;al(u,"width",r?.width?a:c);const h=r?.height??n??void 0;al(h,"height",r?.height?a:c);const d=r?.fps??t??null;_b(d,r?.fps?a:c);const p=r?.durationInFrames??i??null;Hf(p,{allowFloats:!1,component:`of the "<Composition />" component with the id "${e}"`});const g=r?.defaultCodec;return F3(g,a),{width:u,height:h,fps:d,durationInFrames:p,defaultCodec:g}},Sb=({calculateMetadata:r,signal:e,defaultProps:t,originalProps:n,compositionId:s,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u})=>{const h=r?r({defaultProps:t,props:n,abortSignal:e,compositionId:s}):null;if(h!==null&&typeof h=="object"&&"then"in h)return h.then(p=>{const{height:g,width:y,durationInFrames:w,fps:_,defaultCodec:S}=Gv({calculated:p,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:s});return{width:y,height:g,fps:_,durationInFrames:w,id:s,defaultProps:js(t),props:js(p.props??n),defaultCodec:S??null}});const d=Gv({calculated:h,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:s});return h===null?{...d,id:s,defaultProps:js(t??{}),props:js(n),defaultCodec:null}:{...d,id:s,defaultProps:js(t??{}),props:js(h.props??n),defaultCodec:h.defaultCodec??null}},N3=r=>{try{return{type:"success",result:Sb(r)}}catch(e){return{type:"error",error:e}}},zl=v.createContext(null),Cb=v.createRef(),Tb=r=>!!r.calculateMetadata,V3="remotion.propsUpdatedExternally",Eb=({children:r})=>{const[e,t]=v.useState(null),{compositions:n,canvasContent:s,currentCompositionMetadata:i}=v.useContext(vs),{fastRefreshes:a}=v.useContext(Ji),c=v.useMemo(()=>n.find(F=>s&&s.type==="composition"&&s.compositionId===F.id),[s,n]),u=n.find(F=>F.id===e),{props:h}=v.useContext(Bl),d=v.useMemo(()=>typeof window>"u"||Ct().isPlayer?{}:xb()??{},[]),[p,g]=v.useState({}),y=v.useMemo(()=>c?h[c.id]??{}:{},[h,c]),w=v.useMemo(()=>u?h[u.id]??{}:{},[h,u]),_=!!i,S=v.useCallback(({calculateMetadata:F,combinedProps:Y,compositionDurationInFrames:W,compositionFps:q,compositionHeight:U,compositionId:X,compositionWidth:te,defaultProps:de})=>{const J=new AbortController;if(_)return J;const{signal:le}=J,ie=N3({compositionId:X,calculateMetadata:F,originalProps:Y,signal:le,defaultProps:de,compositionDurationInFrames:W,compositionFps:q,compositionHeight:U,compositionWidth:te});if(ie.type==="error")return g(he=>({...he,[X]:{type:"error",error:ie.error}})),J;const se=ie.result;return typeof se=="object"&&"then"in se?(g(he=>{const re=he[X];return re?.type==="success"||re?.type==="success-and-refreshing"?{...he,[X]:{type:"success-and-refreshing",result:re.result}}:{...he,[X]:{type:"loading"}}}),se.then(he=>{J.signal.aborted||g(re=>({...re,[X]:{type:"success",result:he}}))}).catch(he=>{J.signal.aborted||g(re=>({...re,[X]:{type:"error",error:he}}))})):g(he=>({...he,[X]:{type:"success",result:se}})),J},[_]),T=s?.type==="composition"?s.compositionId:null;v.useImperativeHandle(Cb,()=>({setCurrentRenderModalComposition:F=>{t(F)},reloadCurrentlySelectedComposition:()=>{if(!T)return;const F=n.find(U=>U.id===T);if(!F)throw new Error(`Could not find composition with id ${T}`);const Y=h[T]??{},W={...F.defaultProps??{},...Y??{}},q={...W,...d??{}};S({defaultProps:W,calculateMetadata:F.calculateMetadata,combinedProps:q,compositionDurationInFrames:F.durationInFrames??null,compositionFps:F.fps??null,compositionHeight:F.height??null,compositionWidth:F.width??null,compositionId:F.id})}}),[h,n,T,S,d]);const k=c?.id===u?.id,I=v.useMemo(()=>({...c?.defaultProps??{},...y??{}}),[c?.defaultProps,y]),A=v.useMemo(()=>({...I,...d??{}}),[I,d]),D=c&&Tb(c),L=typeof window<"u"&&window.remotion_ignoreFastRefreshUpdate&&a<=window.remotion_ignoreFastRefreshUpdate;v.useEffect(()=>{if(!L&&D){const F=S({calculateMetadata:c.calculateMetadata,combinedProps:A,compositionDurationInFrames:c.durationInFrames??null,compositionFps:c.fps??null,compositionHeight:c.height??null,compositionWidth:c.width??null,defaultProps:I,compositionId:c.id});return()=>{F.abort()}}},[D,I,S,A,c?.calculateMetadata,c?.durationInFrames,c?.fps,c?.height,c?.id,c?.width,L]),v.useEffect(()=>{L||window.dispatchEvent(new CustomEvent("remotion.propsUpdatedExternally"))},[a]),v.useEffect(()=>{if(u&&!k){const F={...u.defaultProps??{},...w??{},...d??{}},Y=S({calculateMetadata:u.calculateMetadata,compositionDurationInFrames:u.durationInFrames??null,compositionFps:u.fps??null,compositionHeight:u.height??null,compositionId:u.id,compositionWidth:u.width??null,defaultProps:I,combinedProps:F});return()=>{Y.abort()}}},[I,S,d,k,u,w]);const z=v.useMemo(()=>{const F=n.filter(Y=>Y.calculateMetadata===null);return{...p,...F.reduce((Y,W)=>({...Y,[W.id]:{type:"success",result:{...W,defaultProps:W.defaultProps??{}}}}),{})}},[n,p]);return b.jsx(zl.Provider,{value:z,children:r})},Uf=r=>{const e=v.useContext(zl),{props:t}=v.useContext(Bl),{compositions:n,canvasContent:s,currentCompositionMetadata:i}=v.useContext(vs),a=s?.type==="composition"?s.compositionId:null,c=r??a,u=n.find(d=>d.id===c),h=v.useMemo(()=>u?t[u.id]??{}:{},[t,u]);return v.useMemo(()=>u?i?{type:"success",result:{...i,id:u.id,props:i.props,defaultProps:u.defaultProps??{},defaultCodec:i.defaultCodec}}:Tb(u)?e[u.id]?e[u.id]:null:(Hf(u.durationInFrames,{allowFloats:!1,component:`in <Composition id="${u.id}">`}),_b(u.fps,`in <Composition id="${u.id}">`),al(u.width,"width",`in <Composition id="${u.id}">`),al(u.height,"height",`in <Composition id="${u.id}">`),{type:"success",result:{width:u.width,height:u.height,fps:u.fps,id:u.id,durationInFrames:u.durationInFrames,defaultProps:u.defaultProps??{},props:{...u.defaultProps??{},...h??{},...typeof window>"u"||Ct().isPlayer?{}:xb()??{}},defaultCodec:null}}):null,[u,e,i,h])},Wl=()=>{const{canvasContent:r,compositions:e,currentCompositionMetadata:t}=v.useContext(vs),n=e.find(i=>r?.type==="composition"&&i.id===r.compositionId),s=Uf(n?.id??null);return v.useMemo(()=>!s||s.type==="error"||s.type==="loading"||!n?null:{...s.result,defaultProps:n.defaultProps??{},id:n.id,...t??{},component:n.component},[t,s,n])},tn=v.createContext({frame:{},playing:!1,playbackRate:1,rootId:"",imperativePlaying:{current:!1},setPlaybackRate:()=>{throw new Error("default")},audioAndVideoTags:{current:[]}}),Qi=v.createContext({setFrame:()=>{throw new Error("default")},setPlaying:()=>{throw new Error("default")}}),$f=()=>"remotion.time-all",kb=r=>{localStorage.setItem($f(),JSON.stringify(r))},Ib=()=>{const r=localStorage.getItem($f())??"{}";return JSON.parse(r)},Ab=r=>{const e=localStorage.getItem($f())??"{}",t=JSON.parse(e);return t[r]!==void 0?Number(t[r]):typeof window>"u"?0:window.remotion_initialFrame??0},ri=()=>{const r=Wl(),e=v.useContext(tn);if(!r)return typeof window>"u"?0:window.remotion_initialFrame??0;const t=e.frame[r.id]??(Ct().isPlayer?0:Ab(r.id));return Math.min(r.durationInFrames-1,t)},Ob=()=>{const{setFrame:r}=v.useContext(Qi);return r},Yf=()=>{const{playing:r,imperativePlaying:e}=v.useContext(tn),{setPlaying:t}=v.useContext(Qi);return v.useMemo(()=>[r,t,e],[e,r,t])},ni=v.createContext(!1),Ad=({children:r})=>b.jsx(ni.Provider,{value:!0,children:r}),Hl=()=>{const r=v.useContext($t),e=r?.width??null,t=r?.height??null,n=r?.durationInFrames??null,s=Wl();return v.useMemo(()=>{if(!s)return null;const{id:i,durationInFrames:a,fps:c,height:u,width:h,defaultProps:d,props:p,defaultCodec:g}=s;return{id:i,width:e??h,height:t??u,fps:c,durationInFrames:n??a,defaultProps:d,props:p,defaultCodec:g}},[n,t,e,s])},ys=()=>{const r=Hl(),e=v.useContext(ni),t=zf();if(!r)throw typeof window<"u"&&window.remotion_isPlayer||t?new Error(["No video config found. Likely reasons:","- You are probably calling useVideoConfig() from outside the component passed to <Player />. See https://www.remotion.dev/docs/player/examples for how to set up the Player correctly.","- You have multiple versions of Remotion installed which causes the React context to get lost."].join("-")):new Error("No video config found. You are probably calling useVideoConfig() from a component which has not been registered as a <Composition />. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions for more information.");if(!e)throw new Error("Called useVideoConfig() outside a Remotion composition.");return r},bs=()=>{if(!v.useContext(ni))throw Ct().isPlayer?new Error("useCurrentFrame can only be called inside a component that was passed to <Player>. See: https://www.remotion.dev/docs/player/examples"):new Error("useCurrentFrame() can only be called inside a component that was registered as a composition. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions");const e=ri(),t=v.useContext($t),n=t?t.cumulatedFrom+t.relativeFrom:0;return e-n},B3=({frame:r,children:e,active:t=!0})=>{const n=bs(),s=ys();if(typeof r>"u")throw new Error("The <Freeze /> component requires a 'frame' prop, but none was passed.");if(typeof r!="number")throw new Error(`The 'frame' prop of <Freeze /> must be a number, but is of type ${typeof r}`);if(Number.isNaN(r))throw new Error("The 'frame' prop of <Freeze /> must be a real number, but it is NaN.");if(!Number.isFinite(r))throw new Error(`The 'frame' prop of <Freeze /> must be a finite number, but it is ${r}.`);const i=v.useMemo(()=>{if(typeof t=="boolean")return t;if(typeof t=="function")return t(n)},[t,n]),a=v.useContext(tn),u=v.useContext($t)?.relativeFrom??0,h=v.useMemo(()=>i?{...a,playing:!1,imperativePlaying:{current:!1},frame:{[s.id]:r+u}}:a,[i,a,s.id,r,u]);return b.jsx(tn.Provider,{value:h,children:e})},z3=({from:r=0,durationInFrames:e=1/0,children:t,name:n,height:s,width:i,showInTimeline:a=!0,_remotionInternalLoopDisplay:c,_remotionInternalStack:u,_remotionInternalPremountDisplay:h,...d},p)=>{const{layout:g="absolute-fill"}=d,[y]=v.useState(()=>String(Math.random())),w=v.useContext($t),{rootId:_}=v.useContext(tn),S=w?w.cumulatedFrom+w.relativeFrom:0,T=Wf();if(g!=="absolute-fill"&&g!=="none")throw new TypeError(`The layout prop of <Sequence /> expects either "absolute-fill" or "none", but you passed: ${g}`);if(g==="none"&&typeof d.style<"u")throw new TypeError('If layout="none", you may not pass a style.');if(typeof e!="number")throw new TypeError(`You passed to durationInFrames an argument of type ${typeof e}, but it must be a number.`);if(e<=0)throw new TypeError(`durationInFrames must be positive, but got ${e}`);if(typeof r!="number")throw new TypeError(`You passed to the "from" props of your <Sequence> an argument of type ${typeof r}, but it must be a number.`);if(!Number.isFinite(r))throw new TypeError(`The "from" prop of a sequence must be finite, but got ${r}.`);const k=ri(),I=ys(),A=w?Math.min(w.durationInFrames-r,e):e,D=Math.max(0,Math.min(I.durationInFrames-r,A)),{registerSequence:L,unregisterSequence:z}=v.useContext(Zi),{hidden:F}=v.useContext(wa),Y=v.useMemo(()=>w?.premounting??!!d._remotionInternalIsPremounting,[d._remotionInternalIsPremounting,w?.premounting]),W=v.useMemo(()=>({cumulatedFrom:S,relativeFrom:r,durationInFrames:D,parentFrom:w?.relativeFrom??0,id:y,height:s??w?.height??null,width:i??w?.width??null,premounting:Y}),[S,r,D,w,y,s,i,Y]),q=v.useMemo(()=>n??"",[n]);v.useEffect(()=>{if(Ct().isStudio)return L({from:r,duration:D,id:y,displayName:q,parent:w?.id??null,type:"sequence",rootId:_,showInTimeline:a,nonce:T,loopDisplay:c,stack:u??null,premountDisplay:h??null}),()=>{z(y)}},[e,y,n,L,q,z,w?.id,D,_,r,a,T,c,u,h]);const U=Math.ceil(S+r+e-1),X=k<S+r||k>U?null:t,te=d.layout==="none"?void 0:d.style,de=v.useMemo(()=>({flexDirection:void 0,...i?{width:i}:{},...s?{height:s}:{},...te??{}}),[s,te,i]);if(p!==null&&g==="none")throw new TypeError('It is not supported to pass both a `ref` and `layout="none"` to <Sequence />.');return F[y]??!1?null:b.jsx($t.Provider,{value:W,children:X===null?null:d.layout==="none"?X:b.jsx(zo,{ref:p,style:de,className:d.className,children:X})})},W3=v.forwardRef(z3),H3=(r,e)=>{const t=bs();if(r.layout==="none")throw new Error('`<Sequence>` with `premountFor` prop does not support layout="none"');const{style:n,from:s=0,premountFor:i=0,...a}=r,c=t<s&&t>=s-i,u=v.useMemo(()=>({...n,opacity:c?0:1,pointerEvents:c?"none":n?.pointerEvents??void 0}),[c,n]);return b.jsx(B3,{frame:s,active:c,children:b.jsx(pn,{ref:e,from:s,style:u,_remotionInternalPremountDisplay:i,_remotionInternalIsPremounting:c,...a})})},U3=v.forwardRef(H3),$3=(r,e)=>r.layout!=="none"&&r.premountFor&&!Ct().isRendering?b.jsx(U3,{...r,ref:e}):b.jsx(W3,{...r,ref:e}),pn=v.forwardRef($3),Y3=r=>{if(typeof r!="string")throw new TypeError(`The "filename" must be a string, but you passed a value of type ${typeof r}`);if(r.trim()==="")throw new Error("The `filename` must not be empty");if(!r.match(/^([0-9a-zA-Z-!_.*'()/:&$@=;+,?]+)/g))throw new Error('The `filename` must match "/^([0-9a-zA-Z-!_.*\'()/:&$@=;+,?]+)/g". Use forward slashes only, even on Windows.')},X3=r=>{if(typeof r!="string"&&!(r instanceof Uint8Array))throw new TypeError(`The "content" must be a string or Uint8Array, but you passed a value of type ${typeof r}`);if(typeof r=="string"&&r.trim()==="")throw new Error("The `content` must not be empty")},Mb=r=>{r.type==="artifact"&&(Y3(r.filename),X3(r.content))},si=v.createContext({registerRenderAsset:()=>{},unregisterRenderAsset:()=>{},renderAssets:[]}),G3=({children:r})=>{const[e,t]=v.useState([]),n=v.useCallback(a=>{Mb(a),t(c=>[...c,a])},[]),s=v.useCallback(a=>{t(c=>c.filter(u=>u.id!==a))},[]);v.useLayoutEffect(()=>{typeof window<"u"&&(window.remotion_collectAssets=()=>(t([]),e))},[e]);const i=v.useMemo(()=>({registerRenderAsset:n,unregisterRenderAsset:s,renderAssets:e}),[e,n,s]);return b.jsx(si.Provider,{value:i,children:r})},Hn=r=>typeof window>"u"?r:new URL(r,window.origin).href,Pb=({endAt:r,mediaDuration:e,playbackRate:t,startFrom:n})=>{let s=e;typeof r<"u"&&(s=r),typeof n<"u"&&(s-=n);const i=s/t;return Math.floor(i)};function ta(r){let e;throw q3(r)?(e=r,e.stack||(e.stack=new Error(e.message).stack)):typeof r=="string"?e=Error(r):e=Error("Rendering was cancelled"),window.remotion_cancelledError=e.stack,e}var q3=r=>r instanceof Error?!0:!(r===null||typeof r!="object"||!("stack"in r)||typeof r.stack!="string"||!("message"in r)||typeof r.message!="string"),Db=v.createContext(null),K3=()=>v.useContext(Db),Ul=({durationInFrames:r,times:e=1/0,children:t,name:n,...s})=>{const i=bs(),{durationInFrames:a}=ys();if(Hf(r,{component:"of the <Loop /> component",allowFloats:!0}),typeof e!="number")throw new TypeError(`You passed to "times" an argument of type ${typeof e}, but it must be a number.`);if(e!==1/0&&e%1!==0)throw new TypeError(`The "times" prop of a loop must be an integer, but got ${e}.`);if(e<0)throw new TypeError(`The "times" prop of a loop must be at least 0, but got ${e}`);const c=Math.ceil(a/r),u=Math.min(c,e),h=s.layout==="none"?void 0:s.style,d=r*(u-1),g=Math.floor(i/r)*r,y=Math.min(g,d),w=v.useMemo(()=>({numberOfTimes:u,startOffset:-y,durationInFrames:r}),[u,r,y]),_=v.useMemo(()=>({iteration:Math.floor(i/r),durationInFrames:r}),[i,r]);return b.jsx(Db.Provider,{value:_,children:b.jsx(pn,{durationInFrames:r,from:y,name:n??"<Loop>",_remotionInternalLoopDisplay:w,layout:s.layout,style:h,children:t})})};Ul.useLoop=K3;var $l=v.createContext({}),qv={},Lh=[],Rb=({children:r})=>{const[e,t]=v.useState(()=>qv);return v.useEffect(()=>{const n=()=>{t(qv)};return Lh.push(n),()=>{Lh=Lh.filter(s=>s!==n)}},[]),b.jsx($l.Provider,{value:e,children:r})},eo=r=>v.useContext($l)[r]??r,Xf=(r,e)=>{if(typeof r.volume!="number"&&typeof r.volume!="function"&&typeof r.volume<"u")throw new TypeError(`You have passed a volume of type ${typeof r.volume} to your <${e} /> component. Volume must be a number or a function with the signature '(frame: number) => number' undefined.`);if(typeof r.volume=="number"&&r.volume<0)throw new TypeError(`You have passed a volume below 0 to your <${e} /> component. Volume must be between 0 and 1`);if(typeof r.playbackRate!="number"&&typeof r.playbackRate<"u")throw new TypeError(`You have passed a playbackRate of type ${typeof r.playbackRate} to your <${e} /> component. Playback rate must a real number or undefined.`);if(typeof r.playbackRate=="number"&&(isNaN(r.playbackRate)||!Number.isFinite(r.playbackRate)||r.playbackRate<=0))throw new TypeError(`You have passed a playbackRate of ${r.playbackRate} to your <${e} /> component. Playback rate must be a real number above 0.`)},Gf=(r,e)=>{if(typeof r<"u"){if(typeof r!="number")throw new TypeError(`type of startFrom prop must be a number, instead got type ${typeof r}.`);if(isNaN(r)||r===1/0)throw new TypeError("startFrom prop can not be NaN or Infinity.");if(r<0)throw new TypeError(`startFrom must be greater than equal to 0 instead got ${r}.`)}if(typeof e<"u"){if(typeof e!="number")throw new TypeError(`type of endAt prop must be a number, instead got type ${typeof e}.`);if(isNaN(e))throw new TypeError("endAt prop can not be NaN.");if(e<=0)throw new TypeError(`endAt must be a positive number, instead got ${e}.`)}if(e<r)throw new TypeError("endAt prop must be greater than startFrom prop.")},Z3=(r,e)=>{switch(e.type){case"got-duration":{const t=Hn(e.src);return r[t]===e.durationInSeconds?r:{...r,[t]:e.durationInSeconds}}default:return r}},qf=v.createContext({durations:{},setDurations:()=>{throw new Error("context missing")}}),jb=({children:r})=>{const[e,t]=v.useReducer(Z3,{}),n=v.useMemo(()=>({durations:e,setDurations:t}),[e]);return b.jsx(qf.Provider,{value:n,children:r})};function Kv(r){let e=r+1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function J3(r){let e=0,t=0,n=0;for(e=0;e<r.length;e++)t=r.charCodeAt(e),n=(n<<5)-n+t,n|=0;return n}var ii=(r,e)=>{if(r===null)return Math.random();if(typeof r=="string")return Kv(J3(r));if(typeof r=="number")return Kv(r*1e10);throw new Error("random() argument must be a number or a string")},to=()=>{const r=v.useContext($t);return Math.min(0,r?.relativeFrom??0)},xa=r=>{const e=Ul.useLoop(),t=bs(),n=to();return r==="repeat"||e===null?t+n:t+n+e.durationInFrames*e.iteration},Q3=r=>{if(/data:|blob:/.test(r.substring(0,5)))return"Data URL";const e=r.split("/").map(t=>t.split("\\")).flat(1);return e[e.length-1]},cl=(r,e,t)=>{const{current:n}=r;if(!n)return;const s=n.play();s.catch&&s.catch(i=>{if(n&&!i.message.includes("request was interrupted by a call to pause")&&!i.message.includes("The operation was aborted.")&&!i.message.includes("The fetching process for the media resource was aborted by the user agent")&&!i.message.includes("request was interrupted by a new load request")&&!i.message.includes("because the media was removed from the document")&&!(i.message.includes("user didn't interact with the document")&&n.muted)&&(console.log(`Could not play ${e} due to following error: `,i),!n.muted)){if(t){t();return}console.log("The video will be muted and we'll retry playing it."),e==="video"&&Ct().isPlayer&&console.log("Use onAutoPlayError() to handle this error yourself."),n.muted=!0,n.play()}})},ro=({frame:r,volume:e,mediaVolume:t=1,allowAmplificationDuringRender:n})=>{const s=n?1/0:1;if(typeof e=="number")return Math.min(s,e*t);if(typeof e>"u")return Number(t);const i=e(r)*t;if(typeof i!="number")throw new TypeError(`You passed in a a function to the volume prop but it did not return a number but a value of type ${typeof i} for frame ${r}`);if(Number.isNaN(i))throw new TypeError(`You passed in a function to the volume prop but it returned NaN for frame ${r}.`);if(!Number.isFinite(i))throw new TypeError(`You passed in a function to the volume prop but it returned a non-finite number for frame ${r}.`);return Math.max(0,Math.min(s,i))},Zv={},e4=r=>{Zv[r]||(console.warn(r),Zv[r]=!0)},Lb=({volume:r,mediaVolume:e,mediaRef:t,src:n,mediaType:s,playbackRate:i,displayName:a,id:c,stack:u,showInTimeline:h,premountDisplay:d,onAutoPlayError:p})=>{const g=ys(),{rootId:y,audioAndVideoTags:w}=v.useContext(tn),_=v.useContext($t),S=_?_.relativeFrom+_.cumulatedFrom:0,[T]=Yf(),k=to(),{registerSequence:I,unregisterSequence:A}=v.useContext(Zi),[D]=v.useState(()=>r),L=Wf(),z=_?Math.min(_.durationInFrames,g.durationInFrames):g.durationInFrames,F=typeof r=="function",Y=v.useMemo(()=>typeof r=="number"?r:new Array(Math.floor(Math.max(0,z+k))).fill(!0).map((W,q)=>ro({frame:q+k,volume:r,mediaVolume:e,allowAmplificationDuringRender:!1})).join(","),[z,k,r,e]);v.useEffect(()=>{typeof r=="number"&&r!==D&&e4(`Remotion: The ${s} with src ${n} has changed it's volume. Prefer the callback syntax for setting volume to get better timeline display: https://www.remotion.dev/docs/using-audio/#controlling-volume`)},[D,s,n,r]),v.useEffect(()=>{if(t.current){if(!n)throw new Error("No src passed");if(!(!Ct().isStudio&&window.process?.env?.NODE_ENV!=="test")&&h)return I({type:s,src:n,id:c,duration:z,from:0,parent:_?.id??null,displayName:a??Q3(n),rootId:y,volume:Y,showInTimeline:!0,nonce:L,startMediaFrom:0-k,doesVolumeChange:F,loopDisplay:void 0,playbackRate:i,stack:u,premountDisplay:d}),()=>{A(c)}}},[S,z,c,_,n,I,y,A,g,Y,F,L,t,s,k,i,a,u,h,d]),v.useEffect(()=>{const W={id:c,play:()=>{if(T)return cl(t,s,p)}};return w.current.push(W),()=>{w.current=w.current.filter(q=>q.id!==c)}},[w,c,t,s,p,T])},t4=()=>{const[r,e]=v.useState([]),[t,n]=v.useState([]),[s,i]=v.useState([]),a=v.useRef(!1),c=v.useCallback(d=>(e(p=>[...p,d]),{unblock:()=>{e(p=>{const g=p.filter(y=>y!==d);return g.length===p.length?p:g})}}),[]),u=v.useCallback(d=>(n(p=>[...p,d]),{remove:()=>{n(p=>p.filter(g=>g!==d))}}),[]),h=v.useCallback(d=>(i(p=>[...p,d]),{remove:()=>{i(p=>p.filter(g=>g!==d))}}),[]);return v.useEffect(()=>{r.length>0&&t.forEach(d=>d())},[r]),v.useEffect(()=>{r.length===0&&s.forEach(d=>d())},[r]),v.useMemo(()=>({addBlock:c,listenForBuffering:u,listenForResume:h,buffering:a}),[c,a,u,h])},no=v.createContext(null),Fb=({children:r})=>{const e=t4();return b.jsx(no.Provider,{value:e,children:r})},r4=r=>{const[e,t]=v.useState(r.buffering.current);return v.useEffect(()=>{const n=()=>{t(!0)},s=()=>{t(!1)};return r.listenForBuffering(n),r.listenForResume(s),()=>{r.listenForBuffering(()=>{}),r.listenForResume(()=>{})}},[r]),e},Kf=()=>{const r=v.useContext(no),e=r?r.addBlock:null;return v.useMemo(()=>({delayPlayback:()=>{if(!e)throw new Error("Tried to enable the buffering state, but a Remotion context was not found. This API can only be called in a component that was passed to the Remotion Player or a <Composition>. Or you might have experienced a version mismatch - run `npx remotion versions` and ensure all packages have the same version. This error is thrown by the buffer state https://remotion.dev/docs/player/buffer-state");const{unblock:t}=e({id:String(Math.random())});return{unblock:t}}}),[e])},n4=({mediaRef:r,mediaType:e,onVariableFpsVideoDetected:t,pauseWhenBuffering:n})=>{const s=v.useRef(!1),{delayPlayback:i}=Kf(),a=v.useCallback(c=>{if(e!=="video"||!n)return;const u=r.current;if(!u||!u.requestVideoFrameCallback)return;s.current=!0;const h=i(),d=()=>{h.unblock(),u.removeEventListener("ended",d,{once:!0}),u.removeEventListener("pause",d,{once:!0}),s.current=!1},p=()=>{d()};u.requestVideoFrameCallback((g,y)=>{Math.abs(y.mediaTime-c)>.5&&t(),d()}),u.addEventListener("ended",p,{once:!0}),u.addEventListener("pause",p,{once:!0}),u.addEventListener("canplay",p,{once:!0})},[i,r,e,t,n]);return v.useMemo(()=>({isBuffering:()=>s.current,bufferUntilFirstFrame:a}),[a])},s4=({element:r,shouldBuffer:e,isPremounting:t})=>{const n=Kf(),[s,i]=v.useState(!1);return v.useEffect(()=>{let a=[];const{current:c}=r;if(!c||!e||t)return;const u=()=>{a.forEach(p=>p()),a=[],i(!1)},h=()=>{i(!0);const{unblock:p}=n.delayPlayback(),g=()=>{u(),d()},y=()=>{u(),d()};c.addEventListener("canplay",g,{once:!0}),a.push(()=>{c.removeEventListener("canplay",g)}),c.addEventListener("error",y,{once:!0}),a.push(()=>{c.removeEventListener("error",y)}),a.push(()=>{p()})},d=()=>{c.readyState<c.HAVE_FUTURE_DATA?(h(),navigator.userAgent.includes("Firefox/")||c.load()):(c.addEventListener("waiting",h),a.push(()=>{c.removeEventListener("waiting",h)}))};return d(),()=>{u()}},[n,r,t,e]),s},i4=({mediaRef:r,mediaType:e,lastSeek:t,onVariableFpsVideoDetected:n})=>{const s=v.useRef(null);return v.useEffect(()=>{const{current:i}=r;if(i)s.current=i.currentTime;else{s.current=null;return}if(e!=="video"){s.current=null;return}const a=i;if(!a.requestVideoFrameCallback)return;let c=()=>{};const u=()=>{if(!a)return;const h=a.requestVideoFrameCallback((d,p)=>{if(s.current!==null){const g=Math.abs(s.current-p.mediaTime),y=Math.abs(t.current===null?1/0:p.mediaTime-t.current);g>.5&&y>.5&&p.mediaTime>s.current&&n()}s.current=p.mediaTime,u()});c=()=>{a.cancelVideoFrameCallback(h),c=()=>{}}};return u(),()=>{c()}},[t,r,e,n]),s};function o4(r,e,t,n){const{extrapolateLeft:s,extrapolateRight:i,easing:a}=n;let c=r;const[u,h]=e,[d,p]=t;if(c<u){if(s==="identity")return c;if(s==="clamp")c=u;else if(s==="wrap"){const g=h-u;c=((c-u)%g+g)%g+u}}if(c>h){if(i==="identity")return c;if(i==="clamp")c=h;else if(i==="wrap"){const g=h-u;c=((c-u)%g+g)%g+u}}return d===p?d:(c=(c-u)/(h-u),c=a(c),c=c*(p-d)+d,c)}function a4(r,e){let t;for(t=1;t<e.length-1&&!(e[t]>=r);++t);return t-1}function c4(r){for(let e=1;e<r.length;++e)if(!(r[e]>r[e-1]))throw new Error(`inputRange must be strictly monotonically increasing but got [${r.join(",")}]`)}function Jv(r,e){if(e.length<2)throw new Error(r+" must have at least 2 elements");for(const t of e){if(typeof t!="number")throw new Error(`${r} must contain only numbers`);if(!Number.isFinite(t))throw new Error(`${r} must contain only finite numbers, but got [${e.join(",")}]`)}}function Nb(r,e,t,n){if(typeof r>"u")throw new Error("input can not be undefined");if(typeof e>"u")throw new Error("inputRange can not be undefined");if(typeof t>"u")throw new Error("outputRange can not be undefined");if(e.length!==t.length)throw new Error("inputRange ("+e.length+") and outputRange ("+t.length+") must have the same length");Jv("inputRange",e),Jv("outputRange",t),c4(e);const s=n?.easing??(u=>u);let i="extend";n?.extrapolateLeft!==void 0&&(i=n.extrapolateLeft);let a="extend";if(n?.extrapolateRight!==void 0&&(a=n.extrapolateRight),typeof r!="number")throw new TypeError("Cannot interpolate an input which is not a number");const c=a4(r,e);return o4(r,[e[c],e[c+1]],[t[c],t[c+1]],{easing:s,extrapolateLeft:i,extrapolateRight:a})}var Vb=({frame:r,playbackRate:e,startFrom:t})=>Nb(r,[-1,t,t+1],[-1,t,t+e]),Bb=({fps:r,frame:e,playbackRate:t,startFrom:n})=>{const s=Vb({frame:e,playbackRate:t,startFrom:n}),i=1e3/r;return s*i/1e3},zb=(r,e)=>Math.round(r/e*100)/100,Yl=()=>{if(typeof window>"u")return!1;const r=/iP(ad|od|hone)/i.test(window.navigator.userAgent),e=/AppleWebKit/.test(window.navigator.userAgent);return r&&e},l4=r=>Yl()&&r.startsWith("blob:"),Od=({actualFrom:r,fps:e})=>zb(Math.max(0,-r),e),Md=({duration:r,fps:e})=>zb(r,e),u4=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{if(l4(r)||r.startsWith("data:")||!!new URL(r,(typeof window>"u"?null:window.location.href)??"http://localhost:3000").hash||!Number.isFinite(e))return r;const i=`${r}#t=${Od({actualFrom:e,fps:n})}`;return Number.isFinite(t)?`${i},${Md({duration:t,fps:n})}`:i},h4=({prevStartFrom:r,newStartFrom:e,prevDuration:t,newDuration:n,fps:s})=>{const i=Od({actualFrom:r,fps:s}),a=Od({actualFrom:e,fps:s}),c=Md({duration:t,fps:s}),u=Md({duration:n,fps:s});return!(a<i||u>c)},d4=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{const s=v.useRef(e),i=v.useRef(t),a=v.useRef(r);return(!h4({prevStartFrom:s.current,newStartFrom:e,prevDuration:i.current,newDuration:t,fps:n})||r!==a.current)&&(s.current=e,i.current=t,a.current=r),u4({actualSrc:a.current,actualFrom:s.current,duration:i.current,fps:n})},Qv={},f4=(r,e)=>{if(r===null||r.seekable.length===0||r.seekable.length>1||Qv[r.src])return;const t={start:r.seekable.start(0),end:r.seekable.end(0)};if(t.start===0&&t.end===0){const n=[`The media ${r.src} cannot be seeked. This could be one of few reasons:`,"1) The media resource was replaced while the video is playing but it was not loaded yet.","2) The media does not support seeking.","3) The media was loaded with security headers prventing it from being included.","Please see https://remotion.dev/docs/non-seekable-media for assistance."].join(`
`);if(e==="console-error")console.error(n);else if(e==="console-warning")console.warn(`The media ${r.src} does not support seeking. The video will render fine, but may not play correctly in the Remotion Studio and in the <Player>. See https://remotion.dev/docs/non-seekable-media for an explanation.`);else throw new Error(n);Qv[r.src]=!0}},Zf=.45,Fh=(r,e)=>{if(!r.current)return;const t=Yl()?Number(e.toFixed(1)):e;r.current.currentTime=t},Wb=({mediaRef:r,src:e,mediaType:t,playbackRate:n,onlyWarnForMediaSeekingError:s,acceptableTimeshift:i,pauseWhenBuffering:a,isPremounting:c,debugSeeking:u,onAutoPlayError:h})=>{const{playbackRate:d}=v.useContext(tn),p=bs(),g=ri(),[y]=Yf(),w=v.useContext(no),{fps:_}=ys(),S=to(),T=v.useRef(null),k=v.useRef(null);if(!w)throw new Error("useMediaPlayback must be used inside a <BufferingContext>");const I=v.useRef({}),A=v.useCallback(()=>{e&&(u&&console.log(`Detected ${e} as a variable FPS video. Disabling buffering while seeking.`),I.current[e]=!0)},[u,e]),D=i4({mediaRef:r,mediaType:t,lastSeek:k,onVariableFpsVideoDetected:A}),L=Bb({frame:p,playbackRate:n,startFrom:-S,fps:_}),z=s4({element:r,shouldBuffer:a,isPremounting:c}),{bufferUntilFirstFrame:F,isBuffering:Y}=n4({mediaRef:r,mediaType:t,onVariableFpsVideoDetected:A,pauseWhenBuffering:a}),W=n*d,q=r.current?.duration?Math.min(r.current.duration,i??Zf):i,U=r4(w);v.useEffect(()=>{if(!y){r.current?.pause();return}const X=z||Y();U&&!X&&r.current?.pause()},[Y,z,U,r,y]),v.useEffect(()=>{const X=t==="audio"?"<Audio>":"<Video>";if(!r.current)throw new Error(`No ${t} ref found`);if(!e)throw new Error(`No 'src' attribute was passed to the ${X} element.`);const te=Math.max(0,W);r.current.playbackRate!==te&&(r.current.playbackRate=te);const{duration:de}=r.current,J=!Number.isNaN(de)&&Number.isFinite(de)?Math.min(de,L):L,le=r.current.currentTime,ie=D.current??null,se=I.current[e],he=Math.abs(J-le),re=ie?Math.abs(J-ie):null,Re=re&&!se?re:he;if(u&&console.log({mediaTagTime:le,rvcTime:ie,shouldBeTime:J,state:r.current.readyState,playing:!r.current.paused,isVariableFpsVideo:se}),Re>q&&T.current!==J){u&&console.log("Seeking",{shouldBeTime:J,isTime:le,rvcTime:ie,timeShift:Re,isVariableFpsVideo:se}),Fh(r,J),k.current=J,T.current=J,y&&!se&&(W>0&&F(J),r.current.paused&&cl(r,t,h)),s||f4(r.current,s?"console-warning":"console-error");return}const $e=y?.15:1e-5,Le=Math.abs(r.current.currentTime-J)>$e,we=z||Y(),Se=w.buffering.current&&!we;if(!y||Se){Le&&(Fh(r,J),k.current=J);return}(r.current.paused&&!r.current.ended||g===0)&&(Le&&(Fh(r,J),k.current=J),cl(r,t,h),se||W>0&&F(J))},[g,q,F,w.buffering,D,u,L,Y,z,r,t,s,W,y,e,h])},Hb=r=>{const[e,t]=v.useState(1);return v.useEffect(()=>{const n=r.current;if(!n)return;const s=()=>{t(n.volume)};return n.addEventListener("volumechange",s),()=>n.removeEventListener("volumechange",s)},[r]),v.useEffect(()=>{const n=r.current;n&&n.volume!==e&&t(n.volume)},[e,r]),e},p4=1e-5,Jf=(r,e)=>Math.abs(r-e)<p4,Ub=({volumePropFrame:r,actualVolume:e,volume:t,mediaVolume:n,mediaRef:s})=>{v.useEffect(()=>{const i=ro({frame:r,volume:t,mediaVolume:n,allowAmplificationDuringRender:!1});!Jf(i,e)&&s.current&&(s.current.volume=i)},[e,r,s,t,n])},Qf=v.createContext({mediaMuted:!1,mediaVolume:1}),ep=v.createContext({setMediaMuted:()=>{throw new Error("default")},setMediaVolume:()=>{throw new Error("default")}}),tp=()=>{const{mediaVolume:r}=v.useContext(Qf),{setMediaVolume:e}=v.useContext(ep);return v.useMemo(()=>[r,e],[r,e])},rp=()=>{const{mediaMuted:r}=v.useContext(Qf),{setMediaMuted:e}=v.useContext(ep);return v.useMemo(()=>[r,e],[r,e])},e0="data:audio/mp3;base64,/+MYxAAJcAV8AAgAABn//////+/gQ5BAMA+D4Pg+BAQBAEAwD4Pg+D4EBAEAQDAPg++hYBH///hUFQVBUFREDQNHmf///////+MYxBUGkAGIMAAAAP/29Xt6lUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDUAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",g4=(r,e)=>{const t=Object.keys(r).sort(),n=Object.keys(e).sort();if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==n[s]||r[t[s]]!==e[n[s]])return!1;return!0},m4=(r,e,t)=>r==="src"&&!t.startsWith("data:")&&!e.startsWith("data:")?new URL(t,window.origin).toString()!==new URL(e,window.origin).toString():t!==e,Xl=v.createContext(null),$b=({children:r,numberOfAudioTags:e,component:t})=>{const n=v.useRef([]),[s]=v.useState(e);if(e!==s)throw new Error("The number of shared audio tags has changed dynamically. Once you have set this property, you cannot change it afterwards.");const i=v.useMemo(()=>new Array(e).fill(!0).map(()=>({id:Math.random(),ref:v.createRef()})),[e]),a=v.useRef(new Array(e).fill(!1)),c=v.useCallback(()=>{i.forEach(({ref:w,id:_})=>{const S=n.current?.find(k=>k.id===_),{current:T}=w;if(T){if(S===void 0){T.src=e0;return}if(!S)throw new TypeError("Expected audio data to be there");Object.keys(S.props).forEach(k=>{m4(k,S.props[k],T[k])&&(T[k]=S.props[k])})}})},[i]),u=v.useCallback((w,_)=>{const S=n.current?.find(L=>L.audioId===_);if(S)return S;const T=a.current.findIndex(L=>L===!1);if(T===-1)throw new Error(`Tried to simultaneously mount ${e+1} <Audio /> tags at the same time. With the current settings, the maximum amount of <Audio /> tags is limited to ${e} at the same time. Remotion pre-mounts silent audio tags to help avoid browser autoplay restrictions. See https://remotion.dev/docs/player/autoplay#use-the-numberofsharedaudiotags-property for more information on how to increase this limit.`);const{id:k,ref:I}=i[T],A=[...a.current];A[T]=k,a.current=A;const D={props:w,id:k,el:I,audioId:_};return n.current?.push(D),c(),D},[e,i,c]),h=v.useCallback(w=>{const _=[...a.current],S=i.findIndex(T=>T.id===w);if(S===-1)throw new TypeError("Error occured in ");_[S]=!1,a.current=_,n.current=n.current?.filter(T=>T.id!==w),c()},[i,c]),d=v.useCallback(({aud:w,audioId:_,id:S})=>{let T=!1;n.current=n.current?.map(k=>k.id===S?g4(w,k.props)?k:(T=!0,{...k,props:w,audioId:_}):k),T&&c()},[c]),p=v.useCallback(()=>{i.forEach(w=>{cl(w.ref,"audio",null)})},[i]),g=v.useMemo(()=>({registerAudio:u,unregisterAudio:h,updateAudio:d,playAllAudios:p,numberOfAudioTags:e}),[e,p,u,h,d]),y=v.useCallback(()=>{a.current=new Array(e).fill(!1),n.current=[],c()},[e,c]);return v.useEffect(()=>()=>{y()},[t,y]),b.jsxs(Xl.Provider,{value:g,children:[i.map(({id:w,ref:_})=>b.jsx("audio",{ref:_,preload:"metadata",src:e0},w)),r]})},v4=(r,e)=>{const t=v.useContext(Xl),[n]=v.useState(()=>t&&t.numberOfAudioTags>0?t.registerAudio(r,e):{el:v.createRef(),id:Math.random(),props:r,audioId:e}),s=v.useInsertionEffect??v.useLayoutEffect;return typeof document<"u"&&(s(()=>{t&&t.numberOfAudioTags>0&&t.updateAudio({id:n.id,aud:r,audioId:e})},[r,t,n.id,e]),s(()=>()=>{t&&t.numberOfAudioTags>0&&t.unregisterAudio(n.id)},[t,n.id])),n},y4=(r,e)=>{const[t]=v.useState(r.shouldPreMountAudioTags);if(r.shouldPreMountAudioTags!==t)throw new Error("Cannot change the behavior for pre-mounting audio tags dynamically.");const{volume:n,muted:s,playbackRate:i,shouldPreMountAudioTags:a,src:c,onDuration:u,acceptableTimeShiftInSeconds:h,_remotionInternalNeedsDurationCalculation:d,_remotionInternalNativeLoopPassed:p,_remotionInternalStack:g,_remotionDebugSeeking:y,allowAmplificationDuringRender:w,name:_,pauseWhenBuffering:S,showInTimeline:T,loopVolumeCurveBehavior:k,stack:I,...A}=r,[D]=tp(),[L]=rp(),z=xa(k??"repeat"),{hidden:F}=v.useContext(wa);if(!c)throw new TypeError("No 'src' was passed to <Audio>.");const Y=eo(c),W=v.useContext($t),[q]=v.useState(()=>String(Math.random())),U=F[q]??!1,X=ro({frame:z,volume:n,mediaVolume:D,allowAmplificationDuringRender:!1}),te=v.useMemo(()=>({muted:s||L||U||X<=0,src:Y,loop:p,...A}),[p,U,L,s,A,Y,X]),de=v.useMemo(()=>`audio-${ii(c??"")}-${W?.relativeFrom}-${W?.cumulatedFrom}-${W?.durationInFrames}-muted:${r.muted}-loop:${r.loop}`,[c,W?.relativeFrom,W?.cumulatedFrom,W?.durationInFrames,r.muted,r.loop]),J=v4(te,de).el,le=Hb(J);Ub({volumePropFrame:z,actualVolume:le,volume:n,mediaVolume:D,mediaRef:J}),Lb({volume:n,mediaVolume:D,mediaRef:J,src:c,mediaType:"audio",playbackRate:i??1,displayName:_??null,id:q,stack:g,showInTimeline:T,premountDisplay:null,onAutoPlayError:null}),Wb({mediaRef:J,src:c,mediaType:"audio",playbackRate:i??1,onlyWarnForMediaSeekingError:!1,acceptableTimeshift:h??Zf,isPremounting:!!W?.premounting,pauseWhenBuffering:S,debugSeeking:y,onAutoPlayError:null}),v.useImperativeHandle(e,()=>J.current,[J]);const ie=v.useRef();return ie.current=u,v.useEffect(()=>{const{current:se}=J;if(!se)return;if(se.duration){ie.current?.(se.src,se.duration);return}const he=()=>{ie.current?.(se.src,se.duration)};return se.addEventListener("loadedmetadata",he),()=>{se.removeEventListener("loadedmetadata",he)}},[J,c]),t?null:b.jsx("audio",{ref:J,preload:"metadata",...te})},b4=v.forwardRef(y4);typeof window<"u"&&(window.remotion_renderReady=!1);var Zc=[];typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var w4="The delayRender was called:",x4="Retries left: ",_4="- Rendering the frame will be retried.",t0=3e4,ls=(r,e)=>{if(typeof r!="string"&&typeof r<"u")throw new Error("The label parameter of delayRender() must be a string or undefined, got: "+JSON.stringify(r));const t=Math.random();Zc.push(t);const n=Error().stack?.replace(/^Error/g,"")??"";if(Ct().isRendering){const s=(e?.timeoutInMilliseconds??(typeof window>"u"?t0:window.remotion_puppeteerTimeout??t0))-2e3;if(typeof window<"u"){const i=(e?.retries??0)-(window.remotion_attempt-1);window.remotion_delayRenderTimeouts[t]={label:r??null,timeout:setTimeout(()=>{const a=["A delayRender()",r?`"${r}"`:null,`was called but not cleared after ${s}ms. See https://remotion.dev/docs/timeout for help.`,i>0?x4+i:null,i>0?_4:null,w4,n].filter(Vl).join(" ");ta(Error(a))},s)}}}return typeof window<"u"&&(window.remotion_renderReady=!1),t},dt=r=>{if(typeof r>"u")throw new TypeError("The continueRender() method must be called with a parameter that is the return value of delayRender(). No value was passed.");if(typeof r!="number")throw new TypeError("The parameter passed into continueRender() must be the return value of delayRender() which is a number. Got: "+JSON.stringify(r));Zc=Zc.filter(e=>e===r?(Ct().isRendering&&(clearTimeout(window.remotion_delayRenderTimeouts[r].timeout),delete window.remotion_delayRenderTimeouts[r]),!1):!0),Zc.length===0&&typeof window<"u"&&(window.remotion_renderReady=!0)},S4=(r,e)=>{const t=v.useRef(null),{volume:n,playbackRate:s,allowAmplificationDuringRender:i,onDuration:a,toneFrequency:c,_remotionInternalNeedsDurationCalculation:u,_remotionInternalNativeLoopPassed:h,acceptableTimeShiftInSeconds:d,name:p,onError:g,delayRenderRetries:y,delayRenderTimeoutInMilliseconds:w,loopVolumeCurveBehavior:_,pauseWhenBuffering:S,...T}=r,k=ri(),I=xa(_??"repeat"),A=bs(),D=v.useContext($t),{registerRenderAsset:L,unregisterRenderAsset:z}=v.useContext(si),F=v.useMemo(()=>`audio-${ii(r.src??"")}-${D?.relativeFrom}-${D?.cumulatedFrom}-${D?.durationInFrames}`,[r.src,D?.relativeFrom,D?.cumulatedFrom,D?.durationInFrames]),Y=ro({volume:n,frame:I,mediaVolume:1,allowAmplificationDuringRender:i??!1});v.useImperativeHandle(e,()=>t.current,[]),v.useEffect(()=>{if(!r.src)throw new Error("No src passed");if(window.remotion_audioEnabled&&!r.muted&&!(Y<=0))return L({type:"audio",src:Hn(r.src),id:F,frame:k,volume:Y,mediaFrame:A,playbackRate:r.playbackRate??1,allowAmplificationDuringRender:i??!1,toneFrequency:c??null,audioStartFrame:Math.max(0,-(D?.relativeFrom??0))}),()=>z(F)},[r.muted,r.src,L,k,F,z,Y,I,A,s,r.playbackRate,i,c,D?.relativeFrom]);const{src:W}=r,q=e||u;return v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"||!q)return;const U=ls("Loading <Audio> duration with src="+W,{retries:y??void 0,timeoutInMilliseconds:w??void 0}),{current:X}=t,te=()=>{X?.duration&&a(X.src,X.duration),dt(U)};return X?.duration?(a(X.src,X.duration),dt(U)):X?.addEventListener("loadedmetadata",te,{once:!0}),()=>{X?.removeEventListener("loadedmetadata",te),dt(U)}},[W,a,q,y,w]),q?b.jsx("audio",{ref:t,...T}):null},C4=v.forwardRef(S4),T4=(r,e)=>{const t=v.useContext(Xl),{startFrom:n,endAt:s,name:i,stack:a,pauseWhenBuffering:c,showInTimeline:u,_remotionDebugSeeking:h,...d}=r,{loop:p,...g}=r,{fps:y}=ys(),w=Ct(),{durations:_,setDurations:S}=v.useContext(qf);if(typeof r.src!="string")throw new TypeError(`The \`<Audio>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const T=eo(r.src),k=v.useCallback(D=>{console.log(D.currentTarget.error);const L=`Could not play audio with src ${T}: ${D.currentTarget.error}. See https://remotion.dev/docs/media-playback-error for help.`;p?ta(new Error(L)):console.warn(L)},[p,T]),I=v.useCallback((D,L)=>{S({type:"got-duration",durationInSeconds:L,src:D})},[S]),A=_[Hn(T)]??_[Hn(r.src)];if(p&&A!==void 0){if(!Number.isFinite(A))return b.jsx(Wo,{...g,ref:e,_remotionInternalNativeLoopPassed:!0});const D=A*y;return b.jsx(Ul,{layout:"none",durationInFrames:Pb({endAt:s,mediaDuration:D,playbackRate:r.playbackRate??1,startFrom:n}),children:b.jsx(Wo,{...g,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof n<"u"||typeof s<"u"){Gf(n,s);const D=n??0,L=s??1/0;return b.jsx(pn,{layout:"none",from:0-D,showInTimeline:!1,durationInFrames:L,name:i,children:b.jsx(Wo,{_remotionInternalNeedsDurationCalculation:!!p,pauseWhenBuffering:c??!1,...d,ref:e})})}return Xf(r,"Audio"),w.isRendering?b.jsx(C4,{onDuration:I,...r,ref:e,onError:k,_remotionInternalNeedsDurationCalculation:!!p}):b.jsx(b4,{_remotionInternalNativeLoopPassed:r._remotionInternalNativeLoopPassed??!1,_remotionDebugSeeking:h??!1,_remotionInternalStack:a??null,shouldPreMountAudioTags:t!==null&&t.numberOfAudioTags>0,...r,ref:e,onError:k,onDuration:I,pauseWhenBuffering:c??!1,_remotionInternalNeedsDurationCalculation:!!p,showInTimeline:u??!0})},Wo=v.forwardRef(T4);ba(Wo);var E4=v.createContext({folderName:null,parentName:null}),k4={transform:"rotate(90deg)"},r0=40,I4={color:"white",fontSize:14,fontFamily:"sans-serif"},A4={justifyContent:"center",alignItems:"center"},O4=()=>b.jsxs(zo,{style:A4,id:"remotion-comp-loading",children:[b.jsx("style",{type:"text/css",children:`
				@keyframes anim {
					from {
						opacity: 0
					}
					to {
						opacity: 1
					}
				}
				#remotion-comp-loading {
					animation: anim 2s;
					animation-fill-mode: forwards;
				}
			`}),b.jsx("svg",{width:r0,height:r0,viewBox:"-100 -100 400 400",style:k4,children:b.jsx("path",{fill:"#555",stroke:"#555",strokeWidth:"100",strokeLinejoin:"round",d:"M 2 172 a 196 100 0 0 0 195 5 A 196 240 0 0 0 100 2.259 A 196 240 0 0 0 2 172 z"})}),b.jsxs("p",{style:I4,children:["Resolving ","<Suspense>","..."]})]}),Cr=null,Pd=()=>{if(!Cr){if(typeof document>"u")throw new Error("Tried to call an API that only works in the browser from outside the browser");Cr=document.createElement("div"),Cr.style.position="absolute",Cr.style.top="0px",Cr.style.left="0px",Cr.style.right="0px",Cr.style.bottom="0px",Cr.style.width="100%",Cr.style.height="100%",Cr.style.display="flex",Cr.style.flexDirection="column";const r=document.createElement("div");r.style.position="fixed",r.style.top="-999999px",r.appendChild(Cr),document.body.appendChild(r)}return Cr},Yb=r=>v.useMemo(()=>{if("lazyComponent"in r&&typeof r.lazyComponent<"u")return v.lazy(r.lazyComponent);if("component"in r)return typeof document>"u"?r.component:v.lazy(()=>Promise.resolve({default:r.component}));throw new Error("You must pass either 'component' or 'lazyComponent'")},[r.component,r.lazyComponent]),Xb=()=>/^([a-zA-Z0-9-\u4E00-\u9FFF])+$/g,Gb=r=>r.match(Xb()),M4=r=>{if(!Gb(r))throw new Error(`Composition id can only contain a-z, A-Z, 0-9, CJK characters and -. You passed ${r}`)},P4=`Composition ID must match ${String(Xb())}`,D4=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}},R4=()=>(v.useEffect(()=>{const r=ls("Waiting for Root component to unsuspend");return()=>dt(r)},[]),null),n0=({width:r,height:e,fps:t,durationInFrames:n,id:s,defaultProps:i,schema:a,...c})=>{const{registerComposition:u,unregisterComposition:h}=v.useContext(vs),d=Wl(),p=Yb(c),g=Wf(),y=zf(),w=Ct();if(v.useContext(ni))throw y?new Error("<Composition> was mounted inside the `component` that was passed to the <Player>. See https://remotion.dev/docs/wrong-composition-mount for help."):new Error("<Composition> mounted inside another composition. See https://remotion.dev/docs/wrong-composition-mount for help.");const{folderName:S,parentName:T}=v.useContext(E4);v.useEffect(()=>{if(!s)throw new Error("No id for composition passed.");return M4(s),D4(i,"defaultProps",s),u({durationInFrames:n??void 0,fps:t??void 0,height:e??void 0,width:r??void 0,id:s,folderName:S,component:p,defaultProps:js(i??{}),nonce:g,parentFolderName:T,schema:a??null,calculateMetadata:c.calculateMetadata??null}),()=>{h(s)}},[n,t,e,p,s,S,i,u,h,r,g,T,a,c.calculateMetadata]);const k=Uf(s);if(w.isStudio&&d&&d.component===p){const I=p;return k===null||k.type!=="success"?null:ld.createPortal(b.jsx(Ad,{children:b.jsx(v.Suspense,{fallback:b.jsx(O4,{}),children:b.jsx(I,{...k.result.props??{}})})}),Pd())}if(w.isRendering&&d&&d.component===p){const I=p;return k===null||k.type!=="success"?null:ld.createPortal(b.jsx(Ad,{children:b.jsx(v.Suspense,{fallback:b.jsx(R4,{}),children:b.jsx(I,{...k.result.props??{}})})}),Pd())}return null},qb=v.createRef(),j4=({children:r,numberOfAudioTags:e})=>{const[t,n]=v.useState([]),s=v.useRef(t),[i,a]=v.useState([]),[c,u]=v.useState(null),[h,d]=v.useState(null),p=v.useCallback(I=>{n(A=>{const D=I(A);return s.current=D,D})},[]),g=v.useCallback(I=>{p(A=>{if(A.find(L=>L.id===I.id))throw new Error(`Multiple composition with id ${I.id} are registered.`);return[...A,I].slice().sort((L,z)=>L.nonce-z.nonce)})},[p]),y=v.useCallback(I=>{n(A=>A.filter(D=>D.id!==I))},[]),w=v.useCallback((I,A)=>{a(D=>[...D,{name:I,parent:A}])},[]),_=v.useCallback((I,A)=>{a(D=>D.filter(L=>!(L.name===I&&L.parent===A)))},[]);v.useImperativeHandle(qb,()=>({getCompositions:()=>s.current}),[]);const S=t.find(I=>c?.type==="composition"?I.id===c.compositionId:null),T=v.useCallback((I,A)=>{n(D=>D.map(z=>z.id===I?{...z,defaultProps:A}:z))},[]),k=v.useMemo(()=>({compositions:t,registerComposition:g,unregisterComposition:y,folders:i,registerFolder:w,unregisterFolder:_,currentCompositionMetadata:h,setCurrentCompositionMetadata:d,canvasContent:c,setCanvasContent:u,updateCompositionDefaultProps:T}),[t,g,y,i,w,_,h,c,T]);return b.jsx(vs.Provider,{value:k,children:b.jsx(I3,{children:b.jsx(G3,{children:b.jsx(Eb,{children:b.jsx($b,{numberOfAudioTags:e,component:S?.component??null,children:r})})})})})},L4=({onLoad:r,onError:e,delayRenderRetries:t,delayRenderTimeoutInMilliseconds:n,...s},i)=>{const[a]=v.useState(()=>ls(`Loading <IFrame> with source ${s.src}`,{retries:t??void 0,timeoutInMilliseconds:n??void 0})),c=v.useCallback(h=>{dt(a),r?.(h)},[a,r]),u=v.useCallback(h=>{dt(a),e?e(h):console.error("Error loading iframe:",h,"Handle the event using the onError() prop to make this message disappear.")},[a,e]);return b.jsx("iframe",{...s,ref:i,onError:u,onLoad:c})};v.forwardRef(L4);function F4(r){return 1e3*2**(r-1)}var N4=({onError:r,maxRetries:e=2,src:t,pauseWhenLoading:n,delayRenderRetries:s,delayRenderTimeoutInMilliseconds:i,onImageFrame:a,...c},u)=>{const h=v.useRef(null),d=v.useRef({}),{delayPlayback:p}=Kf(),g=v.useContext($t);if(!t)throw new Error('No "src" prop was passed to <Img>.');v.useImperativeHandle(u,()=>h.current,[]);const y=eo(t),w=v.useCallback(S=>{if(!h.current)return;const T=h.current.src;setTimeout(()=>{if(!h.current)return;const k=h.current?.src;k===T&&(h.current.removeAttribute("src"),h.current.setAttribute("src",k))},S)},[]),_=v.useCallback(S=>{if(d.current){if(d.current[h.current?.src]=(d.current[h.current?.src]??0)+1,r&&(d.current[h.current?.src]??0)>e){r(S);return}if((d.current[h.current?.src]??0)<=e){const T=F4(d.current[h.current?.src]??0);console.warn(`Could not load image with source ${h.current?.src}, retrying again in ${T}ms`),w(T);return}ta("Error loading image with src: "+h.current?.src)}},[e,r,w]);if(typeof window<"u"){const S=!!g?.premounting;v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"){h.current&&(h.current.src=y);return}const T=ls("Loading <Img> with src="+y,{retries:s??void 0,timeoutInMilliseconds:i??void 0}),k=n&&!S?p().unblock:()=>{},{current:I}=h;let A=!1;const D=()=>{A||((d.current[h.current?.src]??0)>0&&(delete d.current[h.current?.src],console.info(`Retry successful - ${h.current?.src} is now loaded`)),I&&(I.src=y,a?.(I)),k(),dt(T))},L=new Image;return L.src=y,L.decode().then(D).catch(z=>{console.warn(z),L.complete?D():L.addEventListener("load",D)}),()=>{A=!0,L.removeEventListener("load",D),k(),dt(T)}},[y,p,s,i,n,S,a])}return b.jsx("img",{...c,ref:h,onError:_})},Kb=v.forwardRef(N4),Zb={};fb(Zb,{makeDefaultPreviewCSS:()=>B4,injectCSS:()=>V4,OFFTHREAD_VIDEO_CLASS_NAME:()=>ll});var s0={},V4=r=>{if(typeof document>"u"||s0[r])return;const e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode(r)),e.prepend(t),s0[r]=!0},ll="__remotion_offthreadvideo",B4=(r,e)=>r?`
    ${r} * {
      box-sizing: border-box;
    }
    ${r} *:-webkit-full-screen {
      width: 100%;
      height: 100%;
    }
    ${r} .${ll} {
      object-fit: contain;
    }
  `:`
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
	    background-color: ${e};
    }
    .${ll} {
      object-fit: contain;
    }
    `,Jb="__remotion-studio-container",z4=()=>document.getElementById(Jb),W4=null,Nh=[],H4=()=>W4,U4=r=>(Nh.push(r),()=>{Nh=Nh.filter(e=>e!==r)}),$4=({children:r,numberOfAudioTags:e})=>{const[t]=v.useState(()=>String(ii(null))),[n,s]=v.useState(()=>Ib()),[i,a]=v.useState(!1),c=v.useRef(!1),[u,h]=v.useState(0),[d,p]=v.useState(1),g=v.useRef([]);typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_setFrame=(S,T,k)=>{window.remotion_attempt=k;const I=ls(`Setting the current frame to ${S}`);let A=!0;s(D=>(D[T]??window.remotion_initialFrame)===S?(A=!1,D):{...D,[T]:S}),A?requestAnimationFrame(()=>dt(I)):dt(I)},window.remotion_isPlayer=!1},[]);const y=v.useMemo(()=>({frame:n,playing:i,imperativePlaying:c,rootId:t,playbackRate:d,setPlaybackRate:p,audioAndVideoTags:g}),[n,d,i,t]),w=v.useMemo(()=>({setFrame:s,setPlaying:a}),[]),_=v.useMemo(()=>{let S=0;return{getNonce:()=>S++,fastRefreshes:u}},[u]);return v.useEffect(()=>{typeof __webpack_module__<"u"&&__webpack_module__.hot&&__webpack_module__.hot.addStatusHandler(S=>{S==="idle"&&h(T=>T+1)})},[]),b.jsx(Ji.Provider,{value:_,children:b.jsx(tn.Provider,{value:y,children:b.jsx(Qi.Provider,{value:w,children:b.jsx(bb,{children:b.jsx(Rb,{children:b.jsx(j4,{numberOfAudioTags:e,children:b.jsx(jb,{children:b.jsx(Fb,{children:r})})})})})})})})},Y4=()=>{if(Ct().isRendering){const r=window.remotion_envVariables;return r?{...JSON.parse(r),NODE_ENV:"production"}:{}}return{NODE_ENV:"production"}},X4=()=>{const r=Y4();window.process||(window.process={}),window.process.env||(window.process.env={}),Object.keys(r).forEach(e=>{window.process.env[e]=r[e]})},G4=v.createContext(null),q4=v.createContext({setSize:()=>{},size:{size:"auto",translation:{x:0,y:0}}}),K4=({canvasSize:r,compositionHeight:e,compositionWidth:t,previewSize:n})=>{const s=r.height/e,i=r.width/t,a=Math.min(s,i);return n==="auto"?a:Number(n)},Z4="remotion_staticFilesChanged";function J4(){const r=v.useContext(vs),e=v.useContext(tn),t=v.useContext(Qi),n=v.useContext($t),s=v.useContext(Ji),i=v.useContext(ni),a=v.useContext($l),c=v.useContext(zl),u=v.useContext(si),h=v.useContext(Zi),d=v.useContext(no);return v.useMemo(()=>({compositionManagerCtx:r,timelineContext:e,setTimelineContext:t,sequenceContext:n,nonceContext:s,canUseRemotionHooksContext:i,preloadContext:a,resolveCompositionContext:c,renderAssetManagerContext:u,sequenceManagerContext:h,bufferManagerContext:d}),[r,s,n,t,e,i,a,c,u,h,d])}var Q4=r=>{const{children:e,contexts:t}=r;return b.jsx(ni.Provider,{value:t.canUseRemotionHooksContext,children:b.jsx(Ji.Provider,{value:t.nonceContext,children:b.jsx($l.Provider,{value:t.preloadContext,children:b.jsx(vs.Provider,{value:t.compositionManagerCtx,children:b.jsx(Zi.Provider,{value:t.sequenceManagerContext,children:b.jsx(si.Provider,{value:t.renderAssetManagerContext,children:b.jsx(zl.Provider,{value:t.resolveCompositionContext,children:b.jsx(tn.Provider,{value:t.timelineContext,children:b.jsx(Qi.Provider,{value:t.setTimelineContext,children:b.jsx($t.Provider,{value:t.sequenceContext,children:b.jsx(no.Provider,{value:t.bufferManagerContext,children:e})})})})})})})})})})})},be={useUnsafeVideoConfig:Hl,Timeline:vb,CompositionManager:vs,SequenceManager:Zi,SequenceVisibilityToggleContext:wa,RemotionRoot:$4,useVideo:Wl,getRoot:H4,useMediaVolumeState:tp,useMediaMutedState:rp,useLazyComponent:Yb,truthy:Vl,SequenceContext:$t,useRemotionContexts:J4,RemotionContextProvider:Q4,CSSUtils:Zb,setupEnvVariables:X4,MediaVolumeContext:Qf,SetMediaVolumeContext:ep,getRemotionEnvironment:Ct,SharedAudioContext:Xl,SharedAudioContextProvider:$b,invalidCompositionErrorMessage:P4,isCompositionIdValid:Gb,getPreviewDomElement:z4,compositionsRef:qb,portalNode:Pd,waitForRoot:U4,CanUseRemotionHooksProvider:Ad,CanUseRemotionHooks:ni,PrefetchProvider:Rb,DurationsContextProvider:jb,IsPlayerContextProvider:T3,useIsPlayer:zf,EditorPropsProvider:bb,EditorPropsContext:Bl,usePreload:eo,NonceContext:Ji,resolveVideoConfig:Sb,useResolvedVideoConfig:Uf,resolveCompositionsRef:Cb,ResolveCompositionConfig:Eb,REMOTION_STUDIO_CONTAINER_ELEMENT:Jb,RenderAssetManager:si,persistCurrentFrame:kb,useTimelineSetFrame:Ob,isIosSafari:Yl,WATCH_REMOTION_STATIC_FILES:Z4,addSequenceStackTraces:ba,useMediaStartsAt:to,BufferingProvider:Fb,BufferingContextReact:no,enableSequenceStackTraces:gb,CurrentScaleContext:G4,PreviewSizeContext:q4,calculateScale:K4,editorPropsProviderRef:yb,PROPS_UPDATED_EXTERNALLY:V3,validateRenderAsset:Mb},eD=({src:r,transparent:e,currentTime:t,toneMapped:n})=>`http://localhost:${window.remotion_proxyPort}/proxy?src=${encodeURIComponent(Hn(r))}&time=${encodeURIComponent(t)}&transparent=${String(e)}&toneMapped=${String(n)}`,Qb=v.createContext(!1),tD=({children:r})=>b.jsx(Qb.Provider,{value:!1,children:r}),rD=()=>{if(!v.useContext(Qb))throw new Error("This component must be inside a <Series /> component.")},nD=({children:r},e)=>(rD(),b.jsx(tD,{children:r})),sD=v.forwardRef(nD);ba(sD);var iD=({onError:r,volume:e,playbackRate:t,src:n,muted:s,allowAmplificationDuringRender:i,transparent:a=!1,toneMapped:c=!0,toneFrequency:u,name:h,loopVolumeCurveBehavior:d,delayRenderRetries:p,delayRenderTimeoutInMilliseconds:g,onVideoFrame:y,...w})=>{const _=ri(),S=bs(),T=xa(d??"repeat"),k=Hl(),I=v.useContext($t),A=to(),{registerRenderAsset:D,unregisterRenderAsset:L}=v.useContext(si);if(!n)throw new TypeError("No `src` was passed to <OffthreadVideo>.");const z=v.useMemo(()=>`offthreadvideo-${ii(n??"")}-${I?.cumulatedFrom}-${I?.relativeFrom}-${I?.durationInFrames}`,[n,I?.cumulatedFrom,I?.relativeFrom,I?.durationInFrames]);if(!k)throw new Error("No video config found");const F=ro({volume:e,frame:T,mediaVolume:1,allowAmplificationDuringRender:i??!1});v.useEffect(()=>{if(!n)throw new Error("No src passed");if(window.remotion_audioEnabled&&!s&&!(F<=0))return D({type:"video",src:Hn(n),id:z,frame:_,volume:F,mediaFrame:S,playbackRate:t??1,allowAmplificationDuringRender:i??!1,toneFrequency:u??null,audioStartFrame:Math.max(0,-(I?.relativeFrom??0))}),()=>L(z)},[s,n,D,z,L,F,S,_,t,i,u,I?.relativeFrom]);const Y=v.useMemo(()=>Vb({frame:S,playbackRate:t||1,startFrom:-A})/k.fps,[S,A,t,k.fps]),W=v.useMemo(()=>eD({src:n,currentTime:Y,transparent:a,toneMapped:c}),[c,Y,n,a]),[q,U]=v.useState(null);v.useLayoutEffect(()=>{if(!window.remotion_videoEnabled)return;const J=[];U(null);const le=new AbortController,ie=ls(`Fetching ${W} from server`,{retries:p??void 0,timeoutInMilliseconds:g??void 0});return(async()=>{try{const he=await fetch(W,{signal:le.signal});if(he.status!==200){if(he.status===500){const $e=await he.json();if($e.error){const Le=$e.error.replace(/^Error: /,"");throw new Error(Le)}}throw new Error(`Server returned status ${he.status} while fetching ${W}`)}const re=await he.blob(),Re=URL.createObjectURL(re);J.push(()=>URL.revokeObjectURL(Re)),U({src:Re,handle:ie})}catch(he){if(he.message.includes("aborted")){dt(ie);return}if(le.signal.aborted){dt(ie);return}he.message.includes("Failed to fetch")&&(he=new Error(`Failed to fetch ${W}. This could be caused by Chrome rejecting the request because the disk space is low. Consider increasing the disk size of your environment.`,{cause:he})),r?r(he):ta(he)}})(),J.push(()=>{le.signal.aborted||le.abort()}),()=>{J.forEach(he=>he())}},[W,p,g,r]);const X=v.useCallback(()=>{r?r?.(new Error("Failed to load image with src "+q)):ta("Failed to load image with src "+q)},[q,r]),te=v.useMemo(()=>[ll,w.className].filter(Vl).join(" "),[w.className]),de=v.useCallback(J=>{y&&y(J)},[y]);return!q||!window.remotion_videoEnabled?null:(dt(q.handle),b.jsx(Kb,{src:q.src,className:te,delayRenderRetries:p,delayRenderTimeoutInMilliseconds:g,onImageFrame:de,...w,onError:X}))},oD=({ref:r,onVideoFrame:e})=>{v.useEffect(()=>{const{current:t}=r;if(!t||!e)return;let n=0;const s=()=>{r.current&&(e(r.current),n=r.current.requestVideoFrameCallback(s))};return s(),()=>{t.cancelVideoFrameCallback(n)}},[e,r])},aD=(r,e)=>{const t=v.useRef(null),{volume:n,muted:s,playbackRate:i,onlyWarnForMediaSeekingError:a,src:c,onDuration:u,acceptableTimeShift:h,acceptableTimeShiftInSeconds:d,toneFrequency:p,name:g,_remotionInternalNativeLoopPassed:y,_remotionInternalStack:w,_remotionDebugSeeking:_,style:S,pauseWhenBuffering:T,showInTimeline:k,loopVolumeCurveBehavior:I,onError:A,onAutoPlayError:D,onVideoFrame:L,crossOrigin:z,...F}=r,Y=xa(I??"repeat"),{fps:W,durationInFrames:q}=ys(),U=v.useContext($t),{hidden:X}=v.useContext(wa),[te]=v.useState(()=>String(Math.random())),de=X[te]??!1;if(typeof h<"u")throw new Error("acceptableTimeShift has been removed. Use acceptableTimeShiftInSeconds instead.");const J=Hb(t),[le]=tp(),[ie]=rp();Lb({mediaRef:t,volume:n,mediaVolume:le,mediaType:"video",src:c,playbackRate:r.playbackRate??1,displayName:g??null,id:te,stack:w,showInTimeline:k,premountDisplay:null,onAutoPlayError:D??null}),Ub({volumePropFrame:Y,actualVolume:J,volume:n,mediaVolume:le,mediaRef:t}),Wb({mediaRef:t,src:c,mediaType:"video",playbackRate:r.playbackRate??1,onlyWarnForMediaSeekingError:a,acceptableTimeshift:d??Zf,isPremounting:!!U?.premounting,pauseWhenBuffering:T,debugSeeking:_,onAutoPlayError:D??null});const se=U?U.relativeFrom:0,he=U?Math.min(U.durationInFrames,q):q,re=d4({actualSrc:eo(c),actualFrom:se,duration:he,fps:W});v.useImperativeHandle(e,()=>t.current,[]),v.useEffect(()=>{const{current:we}=t;if(!we)return;const Se=()=>{if(we.error){if(console.error("Error occurred in video",we?.error),A){const at=new Error(`Code ${we.error.code}: ${we.error.message}`);A(at);return}throw new Error(`The browser threw an error while playing the video ${c}: Code ${we.error.code} - ${we?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else{if(A){const at=new Error(`The browser threw an error while playing the video ${c}`);A(at);return}throw new Error("The browser threw an error while playing the video")}};return we.addEventListener("error",Se,{once:!0}),()=>{we.removeEventListener("error",Se)}},[A,c]);const Re=v.useRef();Re.current=u,oD({ref:t,onVideoFrame:L}),v.useEffect(()=>{const{current:we}=t;if(!we)return;if(we.duration){Re.current?.(c,we.duration);return}const Se=()=>{Re.current?.(c,we.duration)};return we.addEventListener("loadedmetadata",Se),()=>{we.removeEventListener("loadedmetadata",Se)}},[c]),v.useEffect(()=>{const{current:we}=t;we&&(Yl()?we.preload="metadata":we.preload="auto")},[]);const $e=v.useMemo(()=>({...S,opacity:de?0:S?.opacity??1}),[de,S]),Le=z??(L?"anonymous":void 0);return b.jsx("video",{ref:t,muted:s||ie,playsInline:!0,src:re,loop:y,style:$e,disableRemotePlayback:!0,crossOrigin:Le,...F})},ew=v.forwardRef(aD),tw=r=>{const{startFrom:e,endAt:t,name:n,pauseWhenBuffering:s,stack:i,showInTimeline:a,...c}=r,u=Ct(),h=v.useCallback(()=>{},[]);if(typeof r.src!="string")throw new TypeError(`The \`<OffthreadVideo>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);if(r.imageFormat)throw new TypeError("The `<OffthreadVideo>` tag does no longer accept `imageFormat`. Use the `transparent` prop if you want to render a transparent video.");if(typeof e<"u"||typeof t<"u"){Gf(e,t);const T=e??0,k=t??1/0;return b.jsx(pn,{layout:"none",from:0-T,showInTimeline:!1,durationInFrames:k,name:n,children:b.jsx(tw,{pauseWhenBuffering:s??!1,...c})})}if(Xf(r,"Video"),u.isRendering)return b.jsx(iD,{...c});const{transparent:d,toneMapped:p,_remotionDebugSeeking:g,onAutoPlayError:y,onVideoFrame:w,crossOrigin:_,...S}=c;return b.jsx(ew,{_remotionInternalStack:i??null,_remotionInternalNativeLoopPassed:!1,_remotionDebugSeeking:g??!1,onDuration:h,onlyWarnForMediaSeekingError:!0,pauseWhenBuffering:s??!1,showInTimeline:a??!0,onAutoPlayError:y??void 0,onVideoFrame:w??null,crossOrigin:_,...S})},i0=r=>Math.round(r*1e5)/1e5,Vh=(r,e)=>{if(Jf(r.currentTime,e))return{wait:Promise.resolve(e),cancel:()=>{}};r.currentTime=e;let t,n=null;const s=new Promise(a=>{t=r.requestVideoFrameCallback((c,u)=>{const h=u.expectedDisplayTime-c;if(h<=0){a(u.mediaTime);return}setTimeout(()=>{a(u.mediaTime)},h+150)})}),i=new Promise(a=>{const c=()=>{a()};r.addEventListener("seeked",c,{once:!0}),n=()=>{r.removeEventListener("seeked",c)}});return{wait:Promise.all([s,i]).then(([a])=>a),cancel:()=>{n?.(),r.cancelVideoFrameCallback(t)}}},cD=(r,e,t)=>{const n=1/t/2;let s=()=>{};return Number.isFinite(r.duration)&&r.currentTime>=r.duration&&e>=r.duration?{prom:Promise.resolve(),cancel:()=>{}}:{prom:new Promise((a,c)=>{const u=Vh(r,e+n);u.wait.then(h=>{if(Math.abs(e-h)<=n)return a();const p=e>h?1:-1,g=Vh(r,h+n*p);s=g.cancel,g.wait.then(y=>{const w=Math.abs(e-y);if(i0(w)<=i0(n))return a();const _=Vh(r,e+n);return s=_.cancel,_.wait.then(()=>{a()}).catch(S=>{c(S)})}).catch(y=>{c(y)})}),s=u.cancel}),cancel:()=>{s()}}},lD=({onError:r,volume:e,allowAmplificationDuringRender:t,playbackRate:n,onDuration:s,toneFrequency:i,name:a,acceptableTimeShiftInSeconds:c,delayRenderRetries:u,delayRenderTimeoutInMilliseconds:h,loopVolumeCurveBehavior:d,...p},g)=>{const y=ri(),w=bs(),_=xa(d??"repeat"),S=Hl(),T=v.useRef(null),k=v.useContext($t),I=to(),A=Ct(),{registerRenderAsset:D,unregisterRenderAsset:L}=v.useContext(si),z=v.useMemo(()=>`video-${ii(p.src??"")}-${k?.cumulatedFrom}-${k?.relativeFrom}-${k?.durationInFrames}`,[p.src,k?.cumulatedFrom,k?.relativeFrom,k?.durationInFrames]);if(!S)throw new Error("No video config found");const F=ro({volume:e,frame:_,mediaVolume:1,allowAmplificationDuringRender:t??!1});v.useEffect(()=>{if(!p.src)throw new Error("No src passed");if(!p.muted&&!(F<=0)&&window.remotion_audioEnabled)return D({type:"video",src:Hn(p.src),id:z,frame:y,volume:F,mediaFrame:w,playbackRate:n??1,allowAmplificationDuringRender:t??!1,toneFrequency:i??null,audioStartFrame:Math.max(0,-(k?.relativeFrom??0))}),()=>L(z)},[p.muted,p.src,D,z,L,F,w,y,n,t,i,k?.relativeFrom]),v.useImperativeHandle(g,()=>T.current,[]),v.useEffect(()=>{if(!window.remotion_videoEnabled)return;const{current:W}=T;if(!W)return;const q=Bb({frame:w,playbackRate:n||1,startFrom:-I,fps:S.fps}),U=ls(`Rendering <Video /> with src="${p.src}" at time ${q}`,{retries:u??void 0,timeoutInMilliseconds:h??void 0});if(window.process?.env?.NODE_ENV==="test"){dt(U);return}if(Jf(W.currentTime,q)){if(W.readyState>=2){dt(U);return}const J=()=>{dt(U)};return W.addEventListener("loadeddata",J,{once:!0}),()=>{W.removeEventListener("loadeddata",J)}}const X=()=>{dt(U)},te=cD(W,q,S.fps);te.prom.then(()=>{dt(U)}),W.addEventListener("ended",X,{once:!0});const de=()=>{if(W?.error){if(console.error("Error occurred in video",W?.error),r)return;throw new Error(`The browser threw an error while playing the video ${p.src}: Code ${W.error.code} - ${W?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else throw new Error("The browser threw an error")};return W.addEventListener("error",de,{once:!0}),()=>{te.cancel(),W.removeEventListener("ended",X),W.removeEventListener("error",de),dt(U)}},[_,p.src,n,S.fps,w,I,r,u,h]);const{src:Y}=p;return A.isRendering&&v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test")return;const W=ls("Loading <Video> duration with src="+Y,{retries:u??void 0,timeoutInMilliseconds:h??void 0}),{current:q}=T,U=()=>{q?.duration&&s(Y,q.duration),dt(W)};return q?.duration?(s(Y,q.duration),dt(W)):q?.addEventListener("loadedmetadata",U,{once:!0}),()=>{q?.removeEventListener("loadedmetadata",U),dt(W)}},[Y,s,u,h]),b.jsx("video",{ref:T,disableRemotePlayback:!0,...p})},uD=v.forwardRef(lD),hD=(r,e)=>{const{startFrom:t,endAt:n,name:s,pauseWhenBuffering:i,stack:a,_remotionInternalNativeLoopPassed:c,showInTimeline:u,onAutoPlayError:h,...d}=r,{loop:p,_remotionDebugSeeking:g,...y}=r,{fps:w}=ys(),_=Ct(),{durations:S,setDurations:T}=v.useContext(qf);if(typeof e=="string")throw new Error("string refs are not supported");if(typeof r.src!="string")throw new TypeError(`The \`<Video>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const k=eo(r.src),I=v.useCallback((L,z)=>{T({type:"got-duration",durationInSeconds:z,src:L})},[T]),A=v.useCallback(()=>{},[]),D=S[Hn(k)]??S[Hn(r.src)];if(p&&D!==void 0){if(!Number.isFinite(D))return b.jsx(Jc,{...y,ref:e,_remotionInternalNativeLoopPassed:!0});const L=D*w;return b.jsx(Ul,{durationInFrames:Pb({endAt:n,mediaDuration:L,playbackRate:r.playbackRate??1,startFrom:t}),layout:"none",name:s,children:b.jsx(Jc,{...y,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof t<"u"||typeof n<"u"){Gf(t,n);const L=t??0,z=n??1/0;return b.jsx(pn,{layout:"none",from:0-L,showInTimeline:!1,durationInFrames:z,name:s,children:b.jsx(Jc,{pauseWhenBuffering:i??!1,...d,ref:e})})}return Xf(r,"Video"),_.isRendering?b.jsx(uD,{onDuration:I,onVideoFrame:A??null,...d,ref:e}):b.jsx(ew,{onlyWarnForMediaSeekingError:!1,...d,ref:e,onVideoFrame:null,pauseWhenBuffering:i??!1,onDuration:I,_remotionInternalStack:a??null,_remotionInternalNativeLoopPassed:c??!1,_remotionDebugSeeking:g??!1,showInTimeline:u??!0,onAutoPlayError:h??void 0})},Jc=v.forwardRef(hD);ba(Jc);E3();var dD={},fD=new Proxy(dD,{get(r,e){return e==="Bundling"||e==="Rendering"||e==="Log"||e==="Puppeteer"||e==="Output"?fD:()=>{console.warn("  The CLI configuration has been extracted from Remotion Core."),console.warn("Update the import from the config file:"),console.warn(),console.warn("- Delete:"),console.warn('import {Config} from "remotion";'),console.warn("+ Replace:"),console.warn('import {Config} from "@remotion/cli/config";'),console.warn(),console.warn("For more information, see https://www.remotion.dev/docs/4-0-migration."),process.exit(1)}}});ba(pn);typeof window<"u"&&(window.remotion_renderReady=!1);typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var pD=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}};function gD(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function mD(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function vD(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`);if(t&&r>50)throw new TypeError("The FPS for a GIF cannot be higher than 50. Use the --every-nth-frame option to lower the FPS: https://remotion.dev/docs/render-as-gif")}var Gl={validateFps:vD,validateDimension:gD,validateDurationInFrames:mD,validateDefaultAndInputProps:pD},Vt=25,Dd=16,yD=()=>b.jsx("svg",{width:Vt,height:Vt,viewBox:"0 0 25 25",fill:"none",children:b.jsx("path",{d:"M8 6.375C7.40904 8.17576 7.06921 10.2486 7.01438 12.3871C6.95955 14.5255 7.19163 16.6547 7.6875 18.5625C9.95364 18.2995 12.116 17.6164 14.009 16.5655C15.902 15.5147 17.4755 14.124 18.6088 12.5C17.5158 10.8949 15.9949 9.51103 14.1585 8.45082C12.3222 7.3906 10.2174 6.68116 8 6.375Z",fill:"white",stroke:"white",strokeWidth:"6.25",strokeLinejoin:"round"})}),bD=()=>b.jsxs("svg",{viewBox:"0 0 100 100",width:Vt,height:Vt,children:[b.jsx("rect",{x:"25",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"}),b.jsx("rect",{x:"55",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"})]}),wD=({isFullscreen:r})=>{const n=r?0:3,s=r?6*1.6:6/2,i=r?6*1.6:6*2;return b.jsxs("svg",{viewBox:"0 0 32 32",height:Dd,width:Dd,children:[b.jsx("path",{d:`
				M ${n} ${i}
				L ${s} ${s}
				L ${i} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),b.jsx("path",{d:`
				M ${32-n} ${i}
				L ${32-s} ${s}
				L ${32-i} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),b.jsx("path",{d:`
				M ${n} ${32-i}
				L ${s} ${32-s}
				L ${i} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),b.jsx("path",{d:`
				M ${32-n} ${32-i}
				L ${32-s} ${32-s}
				L ${32-i} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"})]})},xD=()=>b.jsx("svg",{width:Vt,height:Vt,viewBox:"0 0 24 24",children:b.jsx("path",{d:"M3.63 3.63a.996.996 0 000 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z",fill:"#fff"})}),_D=()=>b.jsx("svg",{width:Vt,height:Vt,viewBox:"0 0 24 24",children:b.jsx("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z",fill:"#fff"})}),o0="__remotion_buffering_indicator",a0="__remotion_buffering_animation",SD={width:Vt,height:Vt,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},CD={width:14,height:14,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},TD=({type:r})=>{const e=r==="player"?SD:CD;return b.jsxs(b.Fragment,{children:[b.jsx("style",{type:"text/css",children:`
				@keyframes ${a0} {
          0% {
            rotate: 0deg;
          }
          100% {
            rotate: 360deg;
          }
        }
        
        .${o0} {
            animation: ${a0} 1s linear infinite;
        }        
			`}),b.jsx("div",{style:e,children:b.jsx("svg",{viewBox:r==="player"?"0 0 22 22":"0 0 18 18",style:e,className:o0,children:b.jsx("path",{d:r==="player"?"M 11 4 A 7 7 0 0 1 15.1145 16.66312":"M 9 2 A 7 7 0 0 1 13.1145 14.66312",stroke:"white",strokeLinecap:"round",fill:"none",strokeWidth:3})})})]})},ED=({currentSize:r,width:e,height:t,compositionWidth:n,compositionHeight:s})=>e!==void 0&&t===void 0?{aspectRatio:[n,s].join("/")}:t!==void 0&&e===void 0?{aspectRatio:[n,s].join("/")}:r?{width:n,height:s}:{width:n,height:s},rw=({previewSize:r,compositionWidth:e,compositionHeight:t,canvasSize:n})=>{const s=be.calculateScale({canvasSize:n,compositionHeight:t,compositionWidth:e,previewSize:r}),i=0-(1-s)/2,a=i*e,c=i*t,u=e*s,h=t*s,d=n.width/2-u/2,p=n.height/2-h/2;return{centerX:d,centerY:p,xCorrection:a,yCorrection:c,scale:s}},nw=({config:r,style:e,canvasSize:t,overflowVisible:n,layout:s})=>r?{position:"relative",overflow:n?"visible":"hidden",...ED({compositionHeight:r.height,compositionWidth:r.width,currentSize:t,height:e?.height,width:e?.width}),opacity:s?1:0,...e}:{},sw=({config:r,canvasSize:e,layout:t,scale:n,overflowVisible:s})=>!r||!e||!t?{}:{position:"absolute",width:r.width,height:r.height,display:"flex",transform:`scale(${n})`,marginLeft:t.xCorrection,marginTop:t.yCorrection,overflow:s?"visible":"hidden"},iw=({layout:r,scale:e,config:t,overflowVisible:n})=>{if(!r||!t)return{};const{centerX:s,centerY:i}=r;return{width:t.width*e,height:t.height*e,display:"flex",flexDirection:"column",position:"absolute",left:s,top:i,overflow:n?"visible":"hidden"}},ow=v.createContext(void 0),aw=v.createContext(void 0);class kD{listeners={ended:[],error:[],pause:[],play:[],ratechange:[],scalechange:[],seeked:[],timeupdate:[],frameupdate:[],fullscreenchange:[],volumechange:[],mutechange:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchSeek(e){this.dispatchEvent("seeked",{frame:e})}dispatchVolumeChange(e){this.dispatchEvent("volumechange",{volume:e})}dispatchPause(){this.dispatchEvent("pause",void 0)}dispatchPlay(){this.dispatchEvent("play",void 0)}dispatchEnded(){this.dispatchEvent("ended",void 0)}dispatchRateChange(e){this.dispatchEvent("ratechange",{playbackRate:e})}dispatchScaleChange(e){this.dispatchEvent("scalechange",{scale:e})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchTimeUpdate(e){this.dispatchEvent("timeupdate",e)}dispatchFrameUpdate(e){this.dispatchEvent("frameupdate",e)}dispatchFullscreenChange(e){this.dispatchEvent("fullscreenchange",e)}dispatchMuteChange(e){this.dispatchEvent("mutechange",e)}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}class ID{listeners={error:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}var cw=r=>{const e=v.useContext(be.BufferingContextReact);if(!e)throw new Error("BufferingContextReact not found");v.useEffect(()=>{const t=e.listenForBuffering(()=>{e.buffering.current=!0,r.dispatchWaiting({})}),n=e.listenForResume(()=>{e.buffering.current=!1,r.dispatchResume({})});return()=>{t.remove(),n.remove()}},[e,r])},AD=({children:r,currentPlaybackRate:e})=>{const[t]=v.useState(()=>new kD);if(!v.useContext(be.BufferingContextReact))throw new Error("BufferingContextReact not found");return v.useEffect(()=>{e&&t.dispatchRateChange(e)},[t,e]),cw(t),b.jsx(ow.Provider,{value:t,children:r})},np=(r,e)=>{const[t,n]=v.useState(!1);return v.useEffect(()=>{const{current:s}=r;if(!s)return;let i;const a=()=>{e&&(clearTimeout(i),i=setTimeout(()=>{n(!1)},e===!0?3e3:e))},c=()=>{n(!0),a()},u=()=>{n(!1),clearTimeout(i)},h=()=>{n(!0),a()};return s.addEventListener("mouseenter",c),s.addEventListener("mouseleave",u),s.addEventListener("mousemove",h),()=>{s.removeEventListener("mouseenter",c),s.removeEventListener("mouseleave",u),s.removeEventListener("mousemove",h),clearTimeout(i)}},[e,r]),t},ql=()=>{const[r,e,t]=be.Timeline.usePlayingState(),[n,s]=v.useState(!1),i=be.Timeline.useTimelinePosition(),a=v.useRef(i),c=be.Timeline.useTimelineSetFrame(),u=be.Timeline.useTimelineSetFrame(),h=v.useContext(be.SharedAudioContext),{audioAndVideoTags:d}=v.useContext(be.Timeline.TimelineContext),p=v.useRef(i);p.current=i;const g=be.useVideo(),y=be.useUnsafeVideoConfig(),w=v.useContext(ow),_=(y?.durationInFrames??1)-1,S=i===_,T=i===0;if(!w)throw new TypeError("Expected Player event emitter context");const k=v.useContext(be.BufferingContextReact);if(!k)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");const{buffering:I}=k,A=v.useCallback(U=>{g?.id&&u(X=>({...X,[g.id]:U})),p.current=U,w.dispatchSeek(U)},[w,u,g?.id]),D=v.useCallback(U=>{t.current||(s(!0),S&&A(0),h&&h.numberOfAudioTags>0&&U&&h.playAllAudios(),d.current.forEach(X=>X.play()),t.current=!0,e(!0),a.current=p.current,w.dispatchPlay())},[t,S,h,e,w,A,d]),L=v.useCallback(()=>{t.current&&(t.current=!1,e(!1),w.dispatchPause())},[w,t,e]),z=v.useCallback(()=>{t.current&&(t.current=!1,p.current=a.current,y&&(u(U=>({...U,[y.id]:a.current})),e(!1),w.dispatchPause()))},[y,w,t,e,u]),F=g?.id,Y=v.useCallback(U=>{if(!F)return null;t.current||c(X=>{const te=X[F]??window.remotion_initialFrame??0;return{...X,[F]:Math.max(0,te-U)}})},[t,c,F]),W=v.useCallback(U=>{if(!F)return null;t.current||c(X=>{const te=X[F]??window.remotion_initialFrame??0;return{...X,[F]:Math.min(_,te+U)}})},[F,t,_,c]);return v.useMemo(()=>({frameBack:Y,frameForward:W,isLastFrame:S,emitter:w,playing:r,play:D,pause:L,seek:A,isFirstFrame:T,getCurrentFrame:()=>p.current,isPlaying:()=>t.current,isBuffering:()=>I.current,pauseAndReturnToPlayStart:z,hasPlayed:n,remotionInternal_currentFrameRef:p}),[Y,W,S,w,r,D,L,A,T,z,n,t,I])},OD=({browserMediaControlsBehavior:r,videoConfig:e,playbackRate:t})=>{const{playing:n,pause:s,play:i,emitter:a,getCurrentFrame:c,seek:u}=ql();v.useEffect(()=>{navigator.mediaSession&&r.mode!=="do-nothing"&&(n?navigator.mediaSession.playbackState="playing":navigator.mediaSession.playbackState="paused")},[r.mode,n]),v.useEffect(()=>{if(!navigator.mediaSession||r.mode==="do-nothing")return;const h=()=>{e&&navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:e.durationInFrames/e.fps,playbackRate:t,position:c()/e.fps})};return a.addEventListener("timeupdate",h),()=>{a.removeEventListener("timeupdate",h)}},[r.mode,a,c,t,e]),v.useEffect(()=>{if(navigator.mediaSession&&r.mode!=="do-nothing")return navigator.mediaSession.setActionHandler("play",()=>{r.mode==="register-media-session"&&i()}),navigator.mediaSession.setActionHandler("pause",()=>{r.mode==="register-media-session"&&s()}),navigator.mediaSession.setActionHandler("seekto",h=>{r.mode==="register-media-session"&&h.seekTime!==void 0&&e&&u(Math.round(h.seekTime*e.fps))}),navigator.mediaSession.setActionHandler("seekbackward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(0,Math.round((c()-10)*e.fps)))}),navigator.mediaSession.setActionHandler("seekforward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(e.durationInFrames-1,Math.round((c()+10)*e.fps)))}),navigator.mediaSession.setActionHandler("previoustrack",()=>{r.mode==="register-media-session"&&u(0)}),()=>{navigator.mediaSession.metadata=null,navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("seekto",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null)}},[r.mode,c,s,i,u,e])},MD=({time:r,currentFrame:e,playbackSpeed:t,fps:n,actualLastFrame:s,actualFirstFrame:i,framesAdvanced:a,shouldLoop:c})=>{const h=(t<0?Math.ceil:Math.floor)(r*t/(1e3/n))-a,d=h+e,p=e>s||e<i,g=d>s||d<i,y=!c&&g&&!p;return t>0?g?{nextFrame:i,framesToAdvance:h,hasEnded:y}:{nextFrame:d,framesToAdvance:h,hasEnded:y}:g?{nextFrame:s,framesToAdvance:h,hasEnded:y}:{nextFrame:d,framesToAdvance:h,hasEnded:y}},c0=()=>typeof document>"u"?!1:document.visibilityState==="hidden",PD=()=>{const r=v.useRef(c0());return v.useEffect(()=>{const e=()=>{r.current=c0()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),r},DD=({loop:r,playbackRate:e,moveToBeginningWhenEnded:t,inFrame:n,outFrame:s,frameRef:i,browserMediaControlsBehavior:a})=>{const c=be.useUnsafeVideoConfig(),u=be.Timeline.useTimelinePosition(),{playing:h,pause:d,emitter:p}=ql(),g=be.Timeline.useTimelineSetFrame(),y=v.useRef(null),w=PD(),_=v.useRef(null),S=v.useContext(be.BufferingContextReact);if(!S)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");OD({browserMediaControlsBehavior:a,playbackRate:e,videoConfig:c}),v.useEffect(()=>{const T=S.listenForBuffering(()=>{y.current=performance.now()}),k=S.listenForResume(()=>{y.current=null});return()=>{T.remove(),k.remove()}},[S]),v.useEffect(()=>{if(!c||!h)return;let T=!1,k=null,I=performance.now(),A=0;const D=()=>{k!==null&&(k.type==="raf"?cancelAnimationFrame(k.id):clearTimeout(k.id))},L=()=>{T=!0,D()},z=()=>{const W=performance.now()-I,q=s??c.durationInFrames-1,U=n??0,X=i.current,{nextFrame:te,framesToAdvance:de,hasEnded:J}=MD({time:W,currentFrame:X,playbackSpeed:e,fps:c.fps,actualFirstFrame:U,actualLastFrame:q,framesAdvanced:A,shouldLoop:r});if(A+=de,te!==i.current&&(!J||t)&&g(le=>({...le,[c.id]:te})),J){L(),d(),p.dispatchEnded();return}T||F()},F=()=>{if(y.current){const W=S.listenForResume(()=>{W.remove(),!T&&(I=performance.now(),A=0,z())});return}w.current?k={type:"timeout",id:setTimeout(z,1e3/c.fps)}:k={type:"raf",id:requestAnimationFrame(z)}};F();const Y=()=>{document.visibilityState!=="visible"&&(D(),z())};return window.addEventListener("visibilitychange",Y),()=>{window.removeEventListener("visibilitychange",Y),L()}},[c,r,d,h,g,p,e,n,s,t,w,i,y,S]),v.useEffect(()=>{const T=setInterval(()=>{_.current!==i.current&&(p.dispatchTimeUpdate({frame:i.current}),_.current=i.current)},250);return()=>clearInterval(T)},[p,i]),v.useEffect(()=>{p.dispatchFrameUpdate({frame:u})},[p,u])},Bh=[],sp=(r,e)=>{const[t,n]=v.useState(()=>{if(!r.current)return null;const a=r.current.getClientRects();return a[0]?{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}}:null}),s=v.useMemo(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(a=>{const{contentRect:c,target:u}=a[0],h=u.getClientRects();if(!h?.[0]){n(null);return}const d=c.width===0?1:h[0].width/c.width,p=e.shouldApplyCssTransforms?h[0].width:h[0].width*(1/d),g=e.shouldApplyCssTransforms?h[0].height:h[0].height*(1/d);n({width:p,height:g,left:h[0].x,top:h[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})}),[e.shouldApplyCssTransforms]),i=v.useCallback(()=>{if(!r.current)return;const a=r.current.getClientRects();if(!a[0]){n(null);return}n(c=>c&&c.width===a[0].width&&c.height===a[0].height&&c.left===a[0].x&&c.top===a[0].y&&c.windowSize.height===window.innerHeight&&c.windowSize.width===window.innerWidth?c:{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})},[r]);return v.useEffect(()=>{if(!s)return;const{current:a}=r;return a&&s.observe(a),()=>{a&&s.unobserve(a)}},[s,r,i]),v.useEffect(()=>{if(e.triggerOnWindowResize)return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[e.triggerOnWindowResize,i]),v.useEffect(()=>(Bh.push(i),()=>{Bh=Bh.filter(a=>a!==i)}),[i]),v.useMemo(()=>t?{...t,refresh:i}:null,[t,i])},l0=({playing:r,buffering:e})=>r&&e?b.jsx(TD,{type:"player"}):r?b.jsx(bD,{}):b.jsx(yD,{}),ki=12,u0=5,RD=({volume:r,isVertical:e,onBlur:t,inputRef:n,setVolume:s})=>{const i=v.useMemo(()=>{const g={paddingLeft:5,height:Vt,width:zs,display:"inline-flex",alignItems:"center"};return e?{...g,position:"absolute",transform:`rotate(-90deg) translateX(${zs/2+Vt/2}px)`}:{...g}},[e]),a=typeof v.useId>"u"?"volume-slider":v.useId(),[c]=v.useState(()=>`__remotion-volume-slider-${ii(a)}`.replace(".","")),u=v.useCallback(p=>{s(parseFloat(p.target.value))},[s]),h=v.useMemo(()=>{const p={WebkitAppearance:"none",backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:u0/2,cursor:"pointer",height:u0,width:zs,backgroundImage:`linear-gradient(
				to right,
				white ${r*100}%, rgba(255, 255, 255, 0) ${r*100}%
			)`};return e?{...p,bottom:Vt+zs/2}:p},[e,r]),d=`
	.${c}::-webkit-slider-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${ki/2}px;
		box-shadow: 0 0 2px black;
		height: ${ki}px;
		width: ${ki}px;
	}

	.${c}::-moz-range-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${ki/2}px;
		box-shadow: 0 0 2px black;
		height: ${ki}px;
		width: ${ki}px;
	}
`;return b.jsxs("div",{style:i,children:[b.jsx("style",{dangerouslySetInnerHTML:{__html:d}}),b.jsx("input",{ref:n,"aria-label":"Change volume",className:c,max:1,min:0,onBlur:t,onChange:u,step:.01,type:"range",value:r,style:h})]})},jD=r=>b.jsx(RD,{...r}),zs=100,LD=({displayVerticalVolumeSlider:r,renderMuteButton:e,renderVolumeSlider:t})=>{const[n,s]=be.useMediaMutedState(),[i,a]=be.useMediaVolumeState(),[c,u]=v.useState(!1),h=v.useRef(null),d=v.useRef(null),p=np(h,!1),g=v.useCallback(()=>{setTimeout(()=>{d.current&&document.activeElement!==d.current&&u(!1)},10)},[]),y=i===0,w=v.useCallback(()=>{if(y){a(1),s(!1);return}s(A=>!A)},[y,s,a]),_=v.useMemo(()=>({display:"inline-flex",background:"none",border:"none",justifyContent:"center",alignItems:"center",touchAction:"none",...r&&{position:"relative"}}),[r]),S=v.useMemo(()=>({display:"inline",width:Vt,height:Vt,cursor:"pointer",appearance:"none",background:"none",border:"none",padding:0}),[]),T=v.useCallback(({muted:A,volume:D})=>{const L=A||D===0;return b.jsx("button",{"aria-label":L?"Unmute sound":"Mute sound",title:L?"Unmute sound":"Mute sound",onClick:w,onBlur:g,onFocus:()=>u(!0),style:S,type:"button",children:L?b.jsx(xD,{}):b.jsx(_D,{})})},[g,w,S]),k=v.useMemo(()=>e?e({muted:n,volume:i}):T({muted:n,volume:i}),[n,i,T,e]),I=v.useMemo(()=>(c||p)&&!n&&!be.isIosSafari()?(t??jD)({isVertical:r,volume:i,onBlur:()=>u(!1),inputRef:d,setVolume:a}):null,[r,c,p,n,i,t,a]);return b.jsxs("div",{ref:h,style:_,children:[k,I]})};function FD(r){const[e,t]=v.useState(r),n=v.useRef(null);return v.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&t(!1)};return document.addEventListener("pointerup",s,!0),()=>{document.removeEventListener("pointerup",s,!0)}},[]),{ref:n,isComponentVisible:e,setIsComponentVisible:t}}var ND=35,VD=70,BD={height:30,paddingRight:15,paddingLeft:12,display:"flex",flexDirection:"row",alignItems:"center"},zD={width:22,display:"flex",alignItems:"center"},WD={width:14,height:14,color:"black"},HD=()=>b.jsx("svg",{viewBox:"0 0 512 512",style:WD,children:b.jsx("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})}),UD=({rate:r,onSelect:e,selectedRate:t,keyboardSelectedRate:n})=>{const s=v.useCallback(p=>{p.stopPropagation(),p.preventDefault(),e(r)},[e,r]),[i,a]=v.useState(!1),c=v.useCallback(()=>{a(!0)},[]),u=v.useCallback(()=>{a(!1)},[]),h=n===r,d=v.useMemo(()=>({...BD,backgroundColor:i||h?"#eee":"transparent"}),[i,h]);return b.jsxs("div",{onMouseEnter:c,onMouseLeave:u,tabIndex:0,style:d,onClick:s,children:[b.jsx("div",{style:zD,children:r===t?b.jsx(HD,{}):null}),r.toFixed(1),"x"]},r)},$D=({setIsComponentVisible:r,playbackRates:e,canvasSize:t})=>{const{setPlaybackRate:n,playbackRate:s}=v.useContext(be.Timeline.TimelineContext),[i,a]=v.useState(s);v.useEffect(()=>{const h=d=>{if(d.preventDefault(),d.key==="ArrowUp"){const p=e.findIndex(g=>g===i);if(p===0)return;a(p===-1?e[0]:e[p-1])}else if(d.key==="ArrowDown"){const p=e.findIndex(g=>g===i);if(p===e.length-1)return;a(p===-1?e[e.length-1]:e[p+1])}else d.key==="Enter"&&(n(i),r(!1))};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[e,i,n,r]);const c=v.useCallback(h=>{n(h),r(!1)},[r,n]),u=v.useMemo(()=>({position:"absolute",right:0,width:125,maxHeight:t.height-VD-ND,bottom:35,background:"#fff",borderRadius:4,overflow:"auto",color:"black",textAlign:"left"}),[t.height]);return b.jsx("div",{style:u,children:e.map(h=>b.jsx(UD,{selectedRate:s,onSelect:c,rate:h,keyboardSelectedRate:i},h))})},YD={fontSize:13,fontWeight:"bold",color:"white",border:"2px solid white",borderRadius:20,paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2},Rd={appearance:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",paddingLeft:0,paddingRight:0,paddingTop:6,paddingBottom:6,height:37,display:"inline-flex",marginBottom:0,marginTop:0,alignItems:"center"},XD={...Rd,position:"relative"},GD=({playbackRates:r,canvasSize:e})=>{const{ref:t,isComponentVisible:n,setIsComponentVisible:s}=FD(!1),{playbackRate:i}=v.useContext(be.Timeline.TimelineContext),a=v.useCallback(c=>{c.stopPropagation(),c.preventDefault(),s(u=>!u)},[s]);return b.jsx("div",{ref:t,children:b.jsxs("button",{type:"button","aria-label":"Change playback rate",style:XD,onClick:a,children:[b.jsxs("div",{style:YD,children:[i,"x"]}),n&&b.jsx($D,{canvasSize:e,playbackRates:r,setIsComponentVisible:s})]})})},h0=(r,e,t)=>Math.round(Nb(r,[0,t],[0,e-1],{extrapolateLeft:"clamp",extrapolateRight:"clamp"})),Mi=5,Ro=12,jd=4,qD={userSelect:"none",WebkitUserSelect:"none",paddingTop:jd,paddingBottom:jd,boxSizing:"border-box",cursor:"pointer",position:"relative",touchAction:"none"},KD={height:Mi,backgroundColor:"rgba(255, 255, 255, 0.25)",width:"100%",borderRadius:Mi/2},ZD=r=>{let e=r;for(;e.parentElement;)e=e.parentElement;return e},JD=({durationInFrames:r,onSeekEnd:e,onSeekStart:t,inFrame:n,outFrame:s})=>{const i=v.useRef(null),a=np(i,!1),c=sp(i,{triggerOnWindowResize:!0,shouldApplyCssTransforms:!0}),{seek:u,play:h,pause:d,playing:p}=ql(),g=be.Timeline.useTimelinePosition(),[y,w]=v.useState({dragging:!1}),_=c?.width??0,S=v.useCallback(L=>{if(L.button!==0)return;const z=i.current?.getBoundingClientRect().left,F=h0(L.clientX-z,r,_);d(),u(F),w({dragging:!0,wasPlaying:p}),t()},[r,_,d,u,p,t]),T=v.useCallback(L=>{if(!c)throw new Error("Player has no size");if(!y.dragging)return;const z=i.current?.getBoundingClientRect().left,F=h0(L.clientX-z,r,c.width);u(F)},[y.dragging,r,u,c]),k=v.useCallback(()=>{w({dragging:!1}),y.dragging&&(y.wasPlaying?h():d(),e())},[y,e,d,h]);v.useEffect(()=>{if(!y.dragging)return;const L=ZD(i.current);return L.addEventListener("pointermove",T),L.addEventListener("pointerup",k),()=>{L.removeEventListener("pointermove",T),L.removeEventListener("pointerup",k)}},[y.dragging,T,k]);const I=v.useMemo(()=>({height:Ro,width:Ro,borderRadius:Ro/2,position:"absolute",top:jd-Ro/2+5/2,backgroundColor:"white",left:Math.max(0,g/Math.max(1,r-1)*_-Ro/2),boxShadow:"0 0 2px black",opacity:Number(a)}),[a,r,g,_]),A=v.useMemo(()=>({height:Mi,backgroundColor:"rgba(255, 255, 255, 1)",width:(g-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:Mi/2}),[r,g,n]),D=v.useMemo(()=>({height:Mi,backgroundColor:"rgba(255, 255, 255, 0.25)",width:((s??r-1)-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:Mi/2,position:"absolute"}),[r,n,s]);return b.jsxs("div",{ref:i,onPointerDown:S,style:qD,children:[b.jsxs("div",{style:KD,children:[b.jsx("div",{style:D}),b.jsx("div",{style:A})]}),b.jsx("div",{style:I})]})},d0=r=>{const e=Math.floor(r/60),t=Math.floor(r-e*60);return`${String(e)}:${String(t).padStart(2,"0")}`},QD=10,Ld=12,eR=({allowFullscreen:r,playerWidth:e})=>v.useMemo(()=>{const n=Vt,s=Vt,i=r?Dd:0,a=s+n+i+Ld*2+QD*2,c=e-a,u=Math.max(c,0),h=u-zs,p=(h<zs?u:h)+a+zs,g=e<p;return{maxTimeLabelWidth:u===0?null:u,displayVerticalVolumeSlider:g}},[r,e]),tR=[0,.013,.049,.104,.175,.259,.352,.45,.55,.648,.741,.825,.896,.951,.987],rR=[0,8.1,15.5,22.5,29,35.3,41.2,47.1,52.9,58.8,64.7,71,77.5,84.5,91.9],nR=1/.7,sR={boxSizing:"border-box",position:"absolute",bottom:0,width:"100%",paddingTop:40,paddingBottom:10,backgroundImage:`linear-gradient(to bottom,${tR.map((r,e)=>`hsla(0, 0%, 0%, ${r}) ${rR[e]*nR}%`).join(", ")}, hsl(0, 0%, 0%) 100%)`,backgroundSize:"auto 145px",display:"flex",paddingRight:Ld,paddingLeft:Ld,flexDirection:"column",transition:"opacity 0.3s"},iR={display:"flex",flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none"},oR={display:"flex",flexDirection:"row",userSelect:"none",WebkitUserSelect:"none",alignItems:"center"},Cc={width:12},aR={height:8},cR={flex:1},lR={},uR=({durationInFrames:r,isFullscreen:e,fps:t,player:n,showVolumeControls:s,onFullscreenButtonClick:i,allowFullscreen:a,onExitFullscreenButtonClick:c,spaceKeyToPlayOrPause:u,onSeekEnd:h,onSeekStart:d,inFrame:p,outFrame:g,initiallyShowControls:y,canvasSize:w,renderPlayPauseButton:_,renderFullscreenButton:S,alwaysShowControls:T,showPlaybackRateControl:k,containerRef:I,buffering:A,hideControlsWhenPointerDoesntMove:D,onPointerDown:L,onDoubleClick:z,renderMuteButton:F,renderVolumeSlider:Y})=>{const W=v.useRef(null),q=be.Timeline.useTimelinePosition(),[U,X]=v.useState(!1),te=np(I,D),{maxTimeLabelWidth:de,displayVerticalVolumeSlider:J}=eR({allowFullscreen:a,playerWidth:w?.width??0}),[le,ie]=v.useState(()=>{if(typeof y=="boolean")return y;if(typeof y=="number"){if(y%1!==0)throw new Error("initiallyShowControls must be an integer or a boolean");if(Number.isNaN(y))throw new Error("initiallyShowControls must not be NaN");if(!Number.isFinite(y))throw new Error("initiallyShowControls must be finite");if(y<=0)throw new Error("initiallyShowControls must be a positive integer");return y}throw new TypeError("initiallyShowControls must be a number or a boolean")}),se=v.useMemo(()=>{const Se=te||!n.playing||le||T;return{...sR,opacity:Number(Se)}},[te,le,n.playing,T]);v.useEffect(()=>{W.current&&u&&W.current.focus({preventScroll:!0})},[n.playing,u]),v.useEffect(()=>{X((typeof document<"u"&&(document.fullscreenEnabled||document.webkitFullscreenEnabled))??!1)},[]),v.useEffect(()=>{if(le===!1)return;const at=setTimeout(()=>{ie(!1)},le===!0?2e3:le);return()=>{clearInterval(at)}},[le]);const he=v.useMemo(()=>({color:"white",fontFamily:"sans-serif",fontSize:14,maxWidth:de===null?void 0:de,overflow:"hidden",textOverflow:"ellipsis"}),[de]),re=v.useMemo(()=>{if(k===!0)return[.5,.8,1,1.2,1.5,1.8,2,2.5,3];if(Array.isArray(k)){for(const Se of k){if(typeof Se!="number")throw new Error("Every item in showPlaybackRateControl must be a number");if(Se<=0)throw new Error("Every item in showPlaybackRateControl must be positive")}return k}return null},[k]),Re=v.useRef(null),$e=v.useRef(null),Le=v.useCallback(Se=>{(Se.target===Re.current||Se.target===$e.current)&&L?.(Se)},[L]),we=v.useCallback(Se=>{(Se.target===Re.current||Se.target===$e.current)&&z?.(Se)},[z]);return b.jsxs("div",{ref:Re,style:se,onPointerDown:Le,onDoubleClick:we,children:[b.jsxs("div",{ref:$e,style:iR,children:[b.jsxs("div",{style:oR,children:[b.jsx("button",{ref:W,type:"button",style:Rd,onClick:n.playing?n.pause:n.play,"aria-label":n.playing?"Pause video":"Play video",title:n.playing?"Pause video":"Play video",children:_===null?b.jsx(l0,{buffering:A,playing:n.playing}):_({playing:n.playing,isBuffering:A})??b.jsx(l0,{buffering:A,playing:n.playing})}),s?b.jsxs(b.Fragment,{children:[b.jsx("div",{style:Cc}),b.jsx(LD,{renderMuteButton:F,renderVolumeSlider:Y,displayVerticalVolumeSlider:J})]}):null,b.jsx("div",{style:Cc}),b.jsxs("div",{style:he,children:[d0(q/t)," / ",d0(r/t)]}),b.jsx("div",{style:Cc})]}),b.jsx("div",{style:cR}),re&&w&&b.jsx(GD,{canvasSize:w,playbackRates:re}),re&&U&&a?b.jsx("div",{style:Cc}):null,b.jsx("div",{style:lR,children:U&&a?b.jsx("button",{type:"button","aria-label":e?"Exit fullscreen":"Enter Fullscreen",title:e?"Exit fullscreen":"Enter Fullscreen",style:Rd,onClick:e?c:i,children:S===null?b.jsx(wD,{isFullscreen:e}):S({isFullscreen:e})}):null})]}),b.jsx("div",{style:aR}),b.jsx(JD,{onSeekEnd:h,onSeekStart:d,durationInFrames:r,inFrame:p,outFrame:g})]})},hR={display:"flex",justifyContent:"center",alignItems:"center",flex:1,height:"100%",width:"100%"};class lw extends v.Component{state={hasError:null};static getDerivedStateFromError(e){return{hasError:e}}componentDidCatch(e){this.props.onError(e)}render(){return this.state.hasError?b.jsx("div",{style:hR,children:this.props.errorFallback({error:this.state.hasError})}):this.props.children}}var ip="__remotion-player",uw=typeof document>"u",dR=r=>{let e=!1;return{promise:new Promise((n,s)=>{r.then(i=>{if(e){s({isCanceled:e,value:i});return}n(i)}).catch(i=>{s({isCanceled:e,error:i})})}),cancel:()=>{e=!0}}},fR=r=>new Promise(e=>setTimeout(e,r)),pR=()=>{const r=v.useRef([]),e=v.useCallback(i=>{r.current=[...r.current,i]},[]),t=v.useCallback(i=>{r.current=r.current.filter(a=>a!==i)},[]),n=v.useCallback(()=>r.current.map(i=>i.cancel()),[]);return v.useMemo(()=>({appendPendingPromise:e,removePendingPromise:t,clearPendingPromises:n}),[e,n,t])},gR=(r,e,t)=>{const n=pR(),s=v.useCallback(async u=>{if(u instanceof PointerEvent?u.pointerType==="touch":u.nativeEvent.pointerType==="touch"){r(u);return}n.clearPendingPromises();const h=dR(fR(200));n.appendPendingPromise(h);try{await h.promise,n.removePendingPromise(h),r(u)}catch(d){const p=d;if(n.removePendingPromise(h),!p.isCanceled)throw p.error}},[n,r]),i=v.useCallback(()=>{document.addEventListener("pointerup",u=>{s(u)},{once:!0})},[s]),a=v.useCallback(()=>{n.clearPendingPromises(),e()},[n,e]);return v.useMemo(()=>t?{handlePointerDown:i,handleDoubleClick:a}:{handlePointerDown:r,handleDoubleClick:()=>{}},[t,a,i,r])},Fd=v.version.split(".")[0];if(Fd==="0")throw new Error(`Version ${Fd} of "react" is not supported by Remotion`);var mR=parseInt(Fd,10)>=18,vR=({controls:r,style:e,loop:t,autoPlay:n,allowFullscreen:s,inputProps:i,clickToPlay:a,showVolumeControls:c,doubleClickToFullscreen:u,spaceKeyToPlayOrPause:h,errorFallback:d,playbackRate:p,renderLoading:g,renderPoster:y,className:w,moveToBeginningWhenEnded:_,showPosterWhenUnplayed:S,showPosterWhenEnded:T,showPosterWhenPaused:k,showPosterWhenBuffering:I,inFrame:A,outFrame:D,initiallyShowControls:L,renderFullscreen:z,renderPlayPauseButton:F,renderMuteButton:Y,renderVolumeSlider:W,alwaysShowControls:q,showPlaybackRateControl:U,posterFillMode:X,bufferStateDelayInMilliseconds:te,hideControlsWhenPointerDoesntMove:de,overflowVisible:J,browserMediaControlsBehavior:le},ie)=>{const se=be.useUnsafeVideoConfig(),he=be.useVideo(),re=v.useRef(null),Re=sp(re,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),[$e,Le]=v.useState(!1),[we,Se]=v.useState(n),[at,nr]=v.useState(()=>!1),[jt,Tt]=v.useState(!1),sr=v.useMemo(()=>typeof document>"u"?!1:!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),[]),pe=ql();DD({loop:t,playbackRate:p,moveToBeginningWhenEnded:_,inFrame:A,outFrame:D,frameRef:pe.remotionInternal_currentFrameRef,browserMediaControlsBehavior:le}),v.useEffect(()=>{$e&&!pe.playing&&(Le(!1),pe.play())},[$e,pe]),v.useEffect(()=>{const{current:Ve}=re;if(!Ve)return;const Fe=()=>{const vr=document.fullscreenElement===Ve||document.webkitFullscreenElement===Ve;nr(vr)};return document.addEventListener("fullscreenchange",Fe),document.addEventListener("webkitfullscreenchange",Fe),()=>{document.removeEventListener("fullscreenchange",Fe),document.removeEventListener("webkitfullscreenchange",Fe)}},[]);const pr=v.useCallback(Ve=>{pe.isPlaying()?pe.pause():pe.play(Ve)},[pe]),Qe=v.useCallback(()=>{if(!s)throw new Error("allowFullscreen is false");if(!sr)throw new Error("Browser doesnt support fullscreen");if(!re.current)throw new Error("No player ref found");re.current.webkitRequestFullScreen?re.current.webkitRequestFullScreen():re.current.requestFullscreen()},[s,sr]),Dt=v.useCallback(()=>{document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen()},[]);v.useEffect(()=>{const{current:Ve}=re;if(!Ve)return;const Fe=()=>{const vr=document.webkitFullscreenElement??document.fullscreenElement;vr&&vr===re.current?pe.emitter.dispatchFullscreenChange({isFullscreen:!0}):pe.emitter.dispatchFullscreenChange({isFullscreen:!1})};return Ve.addEventListener("webkitfullscreenchange",Fe),Ve.addEventListener("fullscreenchange",Fe),()=>{Ve.removeEventListener("webkitfullscreenchange",Fe),Ve.removeEventListener("fullscreenchange",Fe)}},[pe.emitter]);const Gn=se?.durationInFrames??1,Ze=v.useMemo(()=>!se||!Re?null:rw({canvasSize:Re,compositionHeight:se.height,compositionWidth:se.width,previewSize:"auto"}),[Re,se]),Et=Ze?.scale??1,_n=v.useRef(!1);v.useEffect(()=>{if(!_n.current){_n.current=!0;return}pe.emitter.dispatchScaleChange(Et)},[pe.emitter,Et]);const{setMediaVolume:gr,setMediaMuted:M}=v.useContext(be.SetMediaVolumeContext),{mediaMuted:ce,mediaVolume:ae}=v.useContext(be.MediaVolumeContext);v.useEffect(()=>{pe.emitter.dispatchVolumeChange(ae)},[pe.emitter,ae]);const Ae=ce||ae===0;v.useEffect(()=>{pe.emitter.dispatchMuteChange({isMuted:Ae})},[pe.emitter,Ae]);const[Ge,We]=v.useState(!1);v.useEffect(()=>{let Ve=null,Fe=!1;const vr=()=>{Fe=!1,requestAnimationFrame(()=>{te===0?We(!0):Ve=setTimeout(()=>{Fe||We(!0)},te)})},cn=()=>{requestAnimationFrame(()=>{Fe=!0,We(!1),Ve&&clearTimeout(Ve)})};return pe.emitter.addEventListener("waiting",vr),pe.emitter.addEventListener("resume",cn),()=>{pe.emitter.removeEventListener("waiting",vr),pe.emitter.removeEventListener("resume",cn),We(!1),Ve&&clearTimeout(Ve),Fe=!0}},[te,pe.emitter]),v.useImperativeHandle(ie,()=>{const Ve={play:pe.play,pause:()=>{Le(!1),pe.pause()},toggle:pr,getContainerNode:()=>re.current,getCurrentFrame:pe.getCurrentFrame,isPlaying:pe.isPlaying,seekTo:Fe=>{const vr=Gn-1,cn=Math.max(0,Math.min(vr,Fe));pe.isPlaying()&&(Le(cn!==vr||t),pe.pause()),cn===vr&&!t&&pe.emitter.dispatchEnded(),pe.seek(cn)},isFullscreen:()=>{const{current:Fe}=re;return Fe?document.fullscreenElement===Fe||document.webkitFullscreenElement===Fe:!1},requestFullscreen:Qe,exitFullscreen:Dt,getVolume:()=>ce?0:ae,setVolume:Fe=>{if(typeof Fe!="number")throw new TypeError(`setVolume() takes a number, got value of type ${typeof Fe}`);if(isNaN(Fe))throw new TypeError("setVolume() got a number that is NaN. Volume must be between 0 and 1.");if(Fe<0||Fe>1)throw new TypeError(`setVolume() got a number that is out of range. Must be between 0 and 1, got ${typeof Fe}`);gr(Fe)},isMuted:()=>Ae,mute:()=>{M(!0)},unmute:()=>{M(!1)},getScale:()=>Et,pauseAndReturnToPlayStart:()=>{pe.pauseAndReturnToPlayStart()}};return Object.assign(pe.emitter,Ve)},[Gn,Dt,t,ce,Ae,ae,pe,Qe,M,gr,pr,Et]);const ye=he?he.component:null,et=v.useMemo(()=>nw({canvasSize:Re,config:se,style:e,overflowVisible:J,layout:Ze}),[Re,se,Ze,J,e]),ir=v.useMemo(()=>iw({config:se,layout:Ze,scale:Et,overflowVisible:J}),[se,Ze,J,Et]),vt=v.useMemo(()=>sw({canvasSize:Re,config:se,layout:Ze,scale:Et,overflowVisible:J}),[Re,se,Ze,J,Et]),mr=v.useCallback(Ve=>{pe.pause(),pe.emitter.dispatchError(Ve)},[pe]),$r=v.useCallback(Ve=>{Ve.stopPropagation(),Qe()},[Qe]),or=v.useCallback(Ve=>{Ve.stopPropagation(),Dt()},[Dt]),an=v.useCallback(Ve=>{(Ve instanceof MouseEvent?Ve.button===2:Ve.nativeEvent.button)||pr(Ve)},[pr]),Yt=v.useCallback(()=>{Tt(!0)},[]),ho=v.useCallback(()=>{Tt(!1)},[]),fo=v.useCallback(()=>{at?Dt():Qe()},[Dt,at,Qe]),{handlePointerDown:hi,handleDoubleClick:di}=gR(an,fo,u&&s&&sr);v.useEffect(()=>{we&&(pe.play(),Se(!1))},[we,pe]);const bu=v.useMemo(()=>g?g({height:et.height,width:et.width,isBuffering:Ge}):null,[et.height,et.width,g,Ge]),Oa=v.useMemo(()=>({type:"scale",scale:Et}),[Et]);if(!se)return null;const Ss=y?y({height:X==="player-size"?et.height:se.height,width:X==="player-size"?et.width:se.width,isBuffering:Ge}):null;if(Ss===void 0)throw new TypeError("renderPoster() must return a React element, but undefined was returned");const Ma=Ss&&[k&&!pe.isPlaying()&&!jt,T&&pe.isLastFrame&&!pe.isPlaying(),S&&!pe.hasPlayed&&!pe.isPlaying(),I&&Ge&&pe.isPlaying()].some(Boolean),{left:Yp,top:Xp,width:Gp,height:wu,...xu}=ir,Pa=b.jsxs(b.Fragment,{children:[b.jsx("div",{style:ir,onPointerDown:a?hi:void 0,onDoubleClick:u?di:void 0,children:b.jsxs("div",{style:vt,className:ip,children:[ye?b.jsx(lw,{onError:mr,errorFallback:d,children:b.jsx(be.CurrentScaleContext.Provider,{value:Oa,children:b.jsx(ye,{...he?.props??{},...i??{}})})}):null,Ma&&X==="composition-size"?b.jsx("div",{style:{...xu,width:se.width,height:se.height},onPointerDown:a?hi:void 0,onDoubleClick:u?di:void 0,children:Ss}):null]})}),Ma&&X==="player-size"?b.jsx("div",{style:ir,onPointerDown:a?hi:void 0,onDoubleClick:u?di:void 0,children:Ss}):null,r?b.jsx(uR,{fps:se.fps,durationInFrames:se.durationInFrames,player:pe,containerRef:re,onFullscreenButtonClick:$r,isFullscreen:at,allowFullscreen:s,showVolumeControls:c,onExitFullscreenButtonClick:or,spaceKeyToPlayOrPause:h,onSeekEnd:ho,onSeekStart:Yt,inFrame:A,outFrame:D,initiallyShowControls:L,canvasSize:Re,renderFullscreenButton:z,renderPlayPauseButton:F,alwaysShowControls:q,showPlaybackRateControl:U,buffering:Ge,hideControlsWhenPointerDoesntMove:de,onDoubleClick:u?di:void 0,onPointerDown:a?hi:void 0,renderMuteButton:Y,renderVolumeSlider:W}):null]});return uw&&!mR?b.jsx("div",{ref:re,style:et,className:w,children:Pa}):b.jsx("div",{ref:re,style:et,className:w,children:b.jsx(v.Suspense,{fallback:bu,children:Pa})})},yR=v.forwardRef(vR),hw="remotion.volumePreference",bR=r=>{if(!(typeof window>"u"))try{window.localStorage.setItem(hw,String(r))}catch(e){console.log("Could not persist volume",e)}},wR=()=>{if(typeof window>"u")return 1;try{const r=window.localStorage.getItem(hw);return r?Number(r):1}catch{return 1}},op="player-comp",dw=({children:r,timelineContext:e,fps:t,compositionHeight:n,compositionWidth:s,durationInFrames:i,component:a,numberOfSharedAudioTags:c,initiallyMuted:u})=>{const h=v.useMemo(()=>({compositions:[{component:a,durationInFrames:i,height:n,width:s,fps:t,id:op,nonce:777,folderName:null,parentFolderName:null,schema:null,calculateMetadata:null}],folders:[],registerFolder:()=>{},unregisterFolder:()=>{},registerComposition:()=>{},unregisterComposition:()=>{},currentCompositionMetadata:null,setCurrentCompositionMetadata:()=>{},canvasContent:{type:"composition",compositionId:"player-comp"},setCanvasContent:()=>{},updateCompositionDefaultProps:()=>{}}),[a,i,n,s,t]),[d,p]=v.useState(()=>u),[g,y]=v.useState(()=>wR()),w=v.useMemo(()=>({mediaMuted:d,mediaVolume:g}),[d,g]),_=v.useCallback(T=>{y(T),bR(T)},[]),S=v.useMemo(()=>({setMediaMuted:p,setMediaVolume:_}),[_]);return b.jsx(be.CanUseRemotionHooksProvider,{children:b.jsx(be.Timeline.TimelineContext.Provider,{value:e,children:b.jsx(be.CompositionManager.Provider,{value:h,children:b.jsx(be.ResolveCompositionConfig,{children:b.jsx(be.PrefetchProvider,{children:b.jsx(be.DurationsContextProvider,{children:b.jsx(be.MediaVolumeContext.Provider,{value:w,children:b.jsx(be.SetMediaVolumeContext.Provider,{value:S,children:b.jsx(be.SharedAudioContextProvider,{numberOfAudioTags:c,component:a,children:b.jsx(be.BufferingProvider,{children:r})})})})})})})})})})},f0=(r,e)=>{if(typeof r>"u"||r===null)return r??null;if(typeof r!="number")throw new TypeError(`"${e}" must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new TypeError(`"${e}" must not be NaN, but is ${JSON.stringify(r)}`);if(!Number.isFinite(r))throw new TypeError(`"${e}" must be finite, but is ${JSON.stringify(r)}`);if(r%1!==0)throw new TypeError(`"${e}" must be an integer, but is ${JSON.stringify(r)}`);return r},xR=({inFrame:r,durationInFrames:e,outFrame:t})=>{const n=f0(r,"inFrame"),s=f0(t,"outFrame");if(!(n===null&&s===null)){if(n!==null&&n>e-1)throw new Error("inFrame must be less than (durationInFrames - 1), but is "+n);if(s!==null&&s>e-1)throw new Error("outFrame must be less than (durationInFrames - 1), but is "+s);if(n!==null&&n<0)throw new Error("inFrame must be greater than 0, but is "+n);if(s!==null&&s<=0)throw new Error(`outFrame must be greater than 0, but is ${s}. If you want to render a single frame, use <Thumbnail /> instead.`);if(s!==null&&n!==null&&s<=n)throw new Error("outFrame must be greater than inFrame, but is "+s+" <= "+n)}},_R=({initialFrame:r,durationInFrames:e})=>{if(typeof e!="number")throw new Error(`\`durationInFrames\` must be a number, but is ${JSON.stringify(e)}`);if(!(typeof r>"u")){if(typeof r!="number")throw new Error(`\`initialFrame\` must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new Error("`initialFrame` must be a number, but is NaN");if(!Number.isFinite(r))throw new Error("`initialFrame` must be a number, but is Infinity");if(r%1!==0)throw new Error(`\`initialFrame\` must be an integer, but is ${JSON.stringify(r)}`);if(r>e-1)throw new Error(`\`initialFrame\` must be less or equal than \`durationInFrames - 1\`, but is ${JSON.stringify(r)}`)}},SR=r=>{if(r!==void 0){if(r>4)throw new Error(`The highest possible playback rate is 4. You passed: ${r}`);if(r<-4)throw new Error(`The lowest possible playback rate is -4. You passed: ${r}`);if(r===0)throw new Error("A playback rate of 0 is not supported.")}},CR=Gl.validateFps,p0=Gl.validateDimension,TR=Gl.validateDurationInFrames,ER=Gl.validateDefaultAndInputProps,kR=r=>"component"in r?r.component:null,IR=({durationInFrames:r,compositionHeight:e,compositionWidth:t,fps:n,inputProps:s,style:i,controls:a=!1,loop:c=!1,autoPlay:u=!1,showVolumeControls:h=!0,allowFullscreen:d=!0,clickToPlay:p,doubleClickToFullscreen:g=!1,spaceKeyToPlayOrPause:y=!0,moveToBeginningWhenEnded:w=!0,numberOfSharedAudioTags:_=5,errorFallback:S=()=>"",playbackRate:T=1,renderLoading:k,className:I,showPosterWhenUnplayed:A,showPosterWhenEnded:D,showPosterWhenPaused:L,showPosterWhenBuffering:z,initialFrame:F,renderPoster:Y,inFrame:W,outFrame:q,initiallyShowControls:U,renderFullscreenButton:X,renderPlayPauseButton:te,renderVolumeSlider:de,alwaysShowControls:J=!1,initiallyMuted:le=!1,showPlaybackRateControl:ie=!1,posterFillMode:se="player-size",bufferStateDelayInMilliseconds:he,hideControlsWhenPointerDoesntMove:re=!0,overflowVisible:Re=!1,renderMuteButton:$e,browserMediaControlsBehavior:Le,...we},Se)=>{if(typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]),we.defaultProps!==void 0)throw new Error("The <Player /> component does not accept `defaultProps`, but some were passed. Use `inputProps` instead.");const at=kR(we);if(at?.type===n0)throw new TypeError("'component' should not be an instance of <Composition/>. Pass the React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");if(at===n0)throw new TypeError("'component' must not be the 'Composition' component. Pass your own React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");const nr=be.useLazyComponent(we);_R({initialFrame:F,durationInFrames:r});const[jt,Tt]=v.useState(()=>({[op]:F??0})),[sr,pe]=v.useState(!1),[pr]=v.useState("player-comp"),Qe=v.useRef(null),Dt=v.useRef([]),Gn=v.useRef(!1),[Ze,Et]=v.useState(T);if(typeof e!="number")throw new TypeError(`'compositionHeight' must be a number but got '${typeof e}' instead`);if(typeof t!="number")throw new TypeError(`'compositionWidth' must be a number but got '${typeof t}' instead`);if(p0(e,"compositionHeight","of the <Player /> component"),p0(t,"compositionWidth","of the <Player /> component"),TR(r,{component:"of the <Player/> component",allowFloats:!1}),CR(n,"as a prop of the <Player/> component",!1),ER(s,"inputProps",null),xR({durationInFrames:r,inFrame:W,outFrame:q}),typeof a!="boolean"&&typeof a<"u")throw new TypeError(`'controls' must be a boolean or undefined but got '${typeof a}' instead`);if(typeof u!="boolean"&&typeof u<"u")throw new TypeError(`'autoPlay' must be a boolean or undefined but got '${typeof u}' instead`);if(typeof c!="boolean"&&typeof c<"u")throw new TypeError(`'loop' must be a boolean or undefined but got '${typeof c}' instead`);if(typeof g!="boolean"&&typeof g<"u")throw new TypeError(`'doubleClickToFullscreen' must be a boolean or undefined but got '${typeof g}' instead`);if(typeof h!="boolean"&&typeof h<"u")throw new TypeError(`'showVolumeControls' must be a boolean or undefined but got '${typeof h}' instead`);if(typeof d!="boolean"&&typeof d<"u")throw new TypeError(`'allowFullscreen' must be a boolean or undefined but got '${typeof d}' instead`);if(typeof p!="boolean"&&typeof p<"u")throw new TypeError(`'clickToPlay' must be a boolean or undefined but got '${typeof p}' instead`);if(typeof y!="boolean"&&typeof y<"u")throw new TypeError(`'spaceKeyToPlayOrPause' must be a boolean or undefined but got '${typeof y}' instead`);if(typeof _!="number"||_%1!==0||!Number.isFinite(_)||Number.isNaN(_)||_<0)throw new TypeError(`'numberOfSharedAudioTags' must be an integer but got '${_}' instead`);SR(Ze),v.useEffect(()=>{Et(T)},[T]),v.useImperativeHandle(Se,()=>Qe.current,[]);const _n=v.useMemo(()=>({frame:jt,playing:sr,rootId:pr,playbackRate:Ze,imperativePlaying:Gn,setPlaybackRate:ae=>{Et(ae)},audioAndVideoTags:Dt}),[jt,Ze,sr,pr]),gr=v.useMemo(()=>({setFrame:Tt,setPlaying:pe}),[Tt]);typeof window<"u"&&v.useLayoutEffect(()=>{be.CSSUtils.injectCSS(be.CSSUtils.makeDefaultPreviewCSS(`.${ip}`,"#fff"))},[]);const M=v.useMemo(()=>s??{},[s]),ce=v.useMemo(()=>Le??{mode:"prevent-media-session"},[Le]);return b.jsx(be.IsPlayerContextProvider,{children:b.jsx(dw,{timelineContext:_n,component:nr,compositionHeight:e,compositionWidth:t,durationInFrames:r,fps:n,numberOfSharedAudioTags:_,initiallyMuted:le,children:b.jsx(be.Timeline.SetTimelineContext.Provider,{value:gr,children:b.jsx(AD,{currentPlaybackRate:Ze,children:b.jsx(yR,{ref:Qe,posterFillMode:se,renderLoading:k,autoPlay:!!u,loop:!!c,controls:!!a,errorFallback:S,style:i,inputProps:M,allowFullscreen:!!d,moveToBeginningWhenEnded:!!w,clickToPlay:typeof p=="boolean"?p:!!a,showVolumeControls:!!h,doubleClickToFullscreen:!!g,spaceKeyToPlayOrPause:!!y,playbackRate:Ze,className:I??void 0,showPosterWhenUnplayed:!!A,showPosterWhenEnded:!!D,showPosterWhenPaused:!!L,showPosterWhenBuffering:!!z,renderPoster:Y,inFrame:W??null,outFrame:q??null,initiallyShowControls:U??!0,renderFullscreen:X??null,renderPlayPauseButton:te??null,renderMuteButton:$e??null,renderVolumeSlider:de??null,alwaysShowControls:J,showPlaybackRateControl:ie,bufferStateDelayInMilliseconds:he??300,hideControlsWhenPointerDoesntMove:re,overflowVisible:Re,browserMediaControlsBehavior:ce})})})})})},AR=v.forwardRef,OR=AR(IR),MR=()=>{const r=v.useContext(aw);if(!r)throw new TypeError("Expected Player event emitter context");return v.useMemo(()=>({emitter:r}),[r])},Nd=v.version.split(".")[0];if(Nd==="0")throw new Error(`Version ${Nd} of "react" is not supported by Remotion`);var PR=parseInt(Nd,10)>=18,DR=({style:r,inputProps:e,errorFallback:t,renderLoading:n,className:s,overflowVisible:i},a)=>{const c=be.useUnsafeVideoConfig(),u=be.useVideo(),h=v.useRef(null),d=sp(h,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),p=v.useMemo(()=>!c||!d?null:rw({canvasSize:d,compositionHeight:c.height,compositionWidth:c.width,previewSize:"auto"}),[d,c]),g=p?.scale??1,y=MR();cw(y.emitter),v.useImperativeHandle(a,()=>{const L={getContainerNode:()=>h.current,getScale:()=>g};return Object.assign(y.emitter,L)},[g,y.emitter]);const w=u?u.component:null,_=v.useMemo(()=>nw({config:c,style:r,canvasSize:d,overflowVisible:i,layout:p}),[d,c,p,i,r]),S=v.useMemo(()=>iw({config:c,layout:p,scale:g,overflowVisible:i}),[c,p,i,g]),T=v.useMemo(()=>sw({canvasSize:d,config:c,layout:p,scale:g,overflowVisible:i}),[d,c,p,i,g]),k=v.useCallback(L=>{y.emitter.dispatchError(L)},[y.emitter]),I=v.useMemo(()=>n?n({height:_.height,width:_.width,isBuffering:!1}):null,[_.height,_.width,n]),A=v.useMemo(()=>({type:"scale",scale:g}),[g]);if(!c)return null;const D=b.jsx("div",{style:S,children:b.jsx("div",{style:T,className:ip,children:w?b.jsx(lw,{onError:k,errorFallback:t,children:b.jsx(be.CurrentScaleContext.Provider,{value:A,children:b.jsx(w,{...u?.props??{},...e??{}})})}):null})});return uw&&!PR?b.jsx("div",{ref:h,style:_,className:s,children:D}):b.jsx("div",{ref:h,style:_,className:s,children:b.jsx(v.Suspense,{fallback:I,children:D})})},RR=v.forwardRef(DR),jR=({frameToDisplay:r,style:e,inputProps:t,compositionHeight:n,compositionWidth:s,durationInFrames:i,fps:a,className:c,errorFallback:u=()=>"",renderLoading:h,overflowVisible:d=!1,...p},g)=>{typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]);const[y]=v.useState(()=>String(ii(null))),w=v.useRef(null),_=v.useMemo(()=>({playing:!1,frame:{[op]:r},rootId:y,imperativePlaying:{current:!1},playbackRate:1,setPlaybackRate:()=>{throw new Error("thumbnail")},audioAndVideoTags:{current:[]}}),[r,y]);v.useImperativeHandle(g,()=>w.current,[]);const S=be.useLazyComponent(p),[T]=v.useState(()=>new ID),k=v.useMemo(()=>t??{},[t]);return b.jsx(be.IsPlayerContextProvider,{children:b.jsx(dw,{timelineContext:_,component:S,compositionHeight:n,compositionWidth:s,durationInFrames:i,fps:a,numberOfSharedAudioTags:0,initiallyMuted:!0,children:b.jsx(aw.Provider,{value:T,children:b.jsx(RR,{ref:w,className:c,errorFallback:u,inputProps:k,renderLoading:h,style:e,overflowVisible:d})})})})},LR=v.forwardRef;LR(jR);const Tc=(r,e)=>{const t=r.from/1e3*e,n=r.to/1e3*e-t;return{from:t,durationInFrames:n}},fw={text:(r,e)=>{const{fps:t,height:n,width:s}=e,{from:i,durationInFrames:a}=Tc(r.display,t);return b.jsx(pn,{from:i,durationInFrames:a,"data-track-item":"transition-element",style:{position:"absolute",width:r.details.width??300,height:r.details.height??400,transform:r.details.transform??"none",fontSize:r.details.fontSize||"16px",textAlign:r.details.textAlign||"left",top:r.details.top??300,left:r.details.left??600,color:r.details.color||"#000000",backgroundColor:r.details.backgroundColor||"transparent",border:r.details.border??"none",opacity:r.details.opacity??100/100,fontFamily:r.details.fontFamily||"Arial",textDecoration:r.details.textDecoration||"none",fontWeight:r.details.fontWeight||"normal",lineHeight:r.details.lineHeight||"normal",letterSpacing:r.details.letterSpacing||"normal",wordSpacing:r.details.wordSpacing||"normal",wordWrap:r.details.wordWrap||"normal",wordBreak:r.details.wordBreak||"normal",pointerEvents:"auto"},children:b.jsx("div",{children:r.details.text})},r.id)},image:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Tc(r.display,t);return b.jsx(pn,{from:n,durationInFrames:s,style:{width:r.details.width??"100%",height:r.details.height??"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",filter:r.details.filter||"none",top:r.details.top??0,left:r.details.left??0},children:b.jsx(zo,{style:{pointerEvents:"none"},children:b.jsx(Kb,{style:{pointerEvents:"none"},"data-id":r.id,src:r.details.src})})},r.id)},video:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Tc(r.display,t),i=r.trim,a=r.details.crop||{x:0,y:0,width:r.details.width,height:r.details.height};return i?b.jsx(pn,{premountFor:30*5,from:n,durationInFrames:s,style:{width:a.width||"100%",height:a.height||"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",top:r.details.top??0,left:r.details.left??0,overflow:"hidden"},children:b.jsx(zo,{style:{pointerEvents:"none",width:r.details.width,height:r.details.height,top:-a.y,left:-a.x},children:b.jsx(tw,{startFrom:i.from/1e3*t,endAt:i.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100,style:{pointerEvents:"none",width:r.details.width,height:r.details.height}})})},r.id):b.jsx(b.Fragment,{})},audio:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Tc(r.display,t),i=r.trim;return i?b.jsx(pn,{className:`moonshine-scene-item id-${r.id} moonshine-scene-item-type-${r.type}`,from:n,durationInFrames:s,style:{userSelect:"none",pointerEvents:"none"},children:b.jsx(zo,{children:b.jsx(Wo,{startFrom:i.from/1e3*t,endAt:i.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100})})},r.id):b.jsx(b.Fragment,{})}};var ul={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */ul.exports;(function(r,e){(function(){var t,n="4.17.21",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",p=1,g=2,y=4,w=1,_=2,S=1,T=2,k=4,I=8,A=16,D=32,L=64,z=128,F=256,Y=512,W=30,q="...",U=800,X=16,te=1,de=2,J=3,le=1/0,ie=9007199254740991,se=17976931348623157e292,he=NaN,re=4294967295,Re=re-1,$e=re>>>1,Le=[["ary",z],["bind",S],["bindKey",T],["curry",I],["curryRight",A],["flip",Y],["partial",D],["partialRight",L],["rearg",F]],we="[object Arguments]",Se="[object Array]",at="[object AsyncFunction]",nr="[object Boolean]",jt="[object Date]",Tt="[object DOMException]",sr="[object Error]",pe="[object Function]",pr="[object GeneratorFunction]",Qe="[object Map]",Dt="[object Number]",Gn="[object Null]",Ze="[object Object]",Et="[object Promise]",_n="[object Proxy]",gr="[object RegExp]",M="[object Set]",ce="[object String]",ae="[object Symbol]",Ae="[object Undefined]",Ge="[object WeakMap]",We="[object WeakSet]",ye="[object ArrayBuffer]",et="[object DataView]",ir="[object Float32Array]",vt="[object Float64Array]",mr="[object Int8Array]",$r="[object Int16Array]",or="[object Int32Array]",an="[object Uint8Array]",Yt="[object Uint8ClampedArray]",ho="[object Uint16Array]",fo="[object Uint32Array]",hi=/\b__p \+= '';/g,di=/\b(__p \+=) '' \+/g,bu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Oa=/&(?:amp|lt|gt|quot|#39);/g,Ss=/[&<>"']/g,Ma=RegExp(Oa.source),Yp=RegExp(Ss.source),Xp=/<%-([\s\S]+?)%>/g,Gp=/<%([\s\S]+?)%>/g,wu=/<%=([\s\S]+?)%>/g,xu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pa=/^\w*$/,Ve=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fe=/[\\^$.*+?()[\]{}|]/g,vr=RegExp(Fe.source),cn=/^\s+/,qp=/\s/,vS=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,yS=/\{\n\/\* \[wrapped with (.+)\] \*/,bS=/,? & /,wS=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xS=/[()=,{}\[\]\/\s]/,_S=/\\(\\)?/g,SS=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Kp=/\w*$/,CS=/^[-+]0x[0-9a-f]+$/i,TS=/^0b[01]+$/i,ES=/^\[object .+?Constructor\]$/,kS=/^0o[0-7]+$/i,IS=/^(?:0|[1-9]\d*)$/,AS=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Da=/($^)/,OS=/['\n\r\u2028\u2029\\]/g,Ra="\\ud800-\\udfff",MS="\\u0300-\\u036f",PS="\\ufe20-\\ufe2f",DS="\\u20d0-\\u20ff",Zp=MS+PS+DS,Jp="\\u2700-\\u27bf",Qp="a-z\\xdf-\\xf6\\xf8-\\xff",RS="\\xac\\xb1\\xd7\\xf7",jS="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",LS="\\u2000-\\u206f",FS=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",eg="A-Z\\xc0-\\xd6\\xd8-\\xde",tg="\\ufe0e\\ufe0f",rg=RS+jS+LS+FS,_u="[']",NS="["+Ra+"]",ng="["+rg+"]",ja="["+Zp+"]",sg="\\d+",VS="["+Jp+"]",ig="["+Qp+"]",og="[^"+Ra+rg+sg+Jp+Qp+eg+"]",Su="\\ud83c[\\udffb-\\udfff]",BS="(?:"+ja+"|"+Su+")",ag="[^"+Ra+"]",Cu="(?:\\ud83c[\\udde6-\\uddff]){2}",Tu="[\\ud800-\\udbff][\\udc00-\\udfff]",fi="["+eg+"]",cg="\\u200d",lg="(?:"+ig+"|"+og+")",zS="(?:"+fi+"|"+og+")",ug="(?:"+_u+"(?:d|ll|m|re|s|t|ve))?",hg="(?:"+_u+"(?:D|LL|M|RE|S|T|VE))?",dg=BS+"?",fg="["+tg+"]?",WS="(?:"+cg+"(?:"+[ag,Cu,Tu].join("|")+")"+fg+dg+")*",HS="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",US="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",pg=fg+dg+WS,$S="(?:"+[VS,Cu,Tu].join("|")+")"+pg,YS="(?:"+[ag+ja+"?",ja,Cu,Tu,NS].join("|")+")",XS=RegExp(_u,"g"),GS=RegExp(ja,"g"),Eu=RegExp(Su+"(?="+Su+")|"+YS+pg,"g"),qS=RegExp([fi+"?"+ig+"+"+ug+"(?="+[ng,fi,"$"].join("|")+")",zS+"+"+hg+"(?="+[ng,fi+lg,"$"].join("|")+")",fi+"?"+lg+"+"+ug,fi+"+"+hg,US,HS,sg,$S].join("|"),"g"),KS=RegExp("["+cg+Ra+Zp+tg+"]"),ZS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,JS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],QS=-1,tt={};tt[ir]=tt[vt]=tt[mr]=tt[$r]=tt[or]=tt[an]=tt[Yt]=tt[ho]=tt[fo]=!0,tt[we]=tt[Se]=tt[ye]=tt[nr]=tt[et]=tt[jt]=tt[sr]=tt[pe]=tt[Qe]=tt[Dt]=tt[Ze]=tt[gr]=tt[M]=tt[ce]=tt[Ge]=!1;var Je={};Je[we]=Je[Se]=Je[ye]=Je[et]=Je[nr]=Je[jt]=Je[ir]=Je[vt]=Je[mr]=Je[$r]=Je[or]=Je[Qe]=Je[Dt]=Je[Ze]=Je[gr]=Je[M]=Je[ce]=Je[ae]=Je[an]=Je[Yt]=Je[ho]=Je[fo]=!0,Je[sr]=Je[pe]=Je[Ge]=!1;var eC={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},tC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rC={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},nC={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},sC=parseFloat,iC=parseInt,gg=typeof Ao=="object"&&Ao&&Ao.Object===Object&&Ao,oC=typeof self=="object"&&self&&self.Object===Object&&self,Lt=gg||oC||Function("return this")(),ku=e&&!e.nodeType&&e,Cs=ku&&!0&&r&&!r.nodeType&&r,mg=Cs&&Cs.exports===ku,Iu=mg&&gg.process,Or=function(){try{var N=Cs&&Cs.require&&Cs.require("util").types;return N||Iu&&Iu.binding&&Iu.binding("util")}catch{}}(),vg=Or&&Or.isArrayBuffer,yg=Or&&Or.isDate,bg=Or&&Or.isMap,wg=Or&&Or.isRegExp,xg=Or&&Or.isSet,_g=Or&&Or.isTypedArray;function yr(N,G,$){switch($.length){case 0:return N.call(G);case 1:return N.call(G,$[0]);case 2:return N.call(G,$[0],$[1]);case 3:return N.call(G,$[0],$[1],$[2])}return N.apply(G,$)}function aC(N,G,$,ue){for(var xe=-1,Be=N==null?0:N.length;++xe<Be;){var kt=N[xe];G(ue,kt,$(kt),N)}return ue}function Mr(N,G){for(var $=-1,ue=N==null?0:N.length;++$<ue&&G(N[$],$,N)!==!1;);return N}function cC(N,G){for(var $=N==null?0:N.length;$--&&G(N[$],$,N)!==!1;);return N}function Sg(N,G){for(var $=-1,ue=N==null?0:N.length;++$<ue;)if(!G(N[$],$,N))return!1;return!0}function qn(N,G){for(var $=-1,ue=N==null?0:N.length,xe=0,Be=[];++$<ue;){var kt=N[$];G(kt,$,N)&&(Be[xe++]=kt)}return Be}function La(N,G){var $=N==null?0:N.length;return!!$&&pi(N,G,0)>-1}function Au(N,G,$){for(var ue=-1,xe=N==null?0:N.length;++ue<xe;)if($(G,N[ue]))return!0;return!1}function nt(N,G){for(var $=-1,ue=N==null?0:N.length,xe=Array(ue);++$<ue;)xe[$]=G(N[$],$,N);return xe}function Kn(N,G){for(var $=-1,ue=G.length,xe=N.length;++$<ue;)N[xe+$]=G[$];return N}function Ou(N,G,$,ue){var xe=-1,Be=N==null?0:N.length;for(ue&&Be&&($=N[++xe]);++xe<Be;)$=G($,N[xe],xe,N);return $}function lC(N,G,$,ue){var xe=N==null?0:N.length;for(ue&&xe&&($=N[--xe]);xe--;)$=G($,N[xe],xe,N);return $}function Mu(N,G){for(var $=-1,ue=N==null?0:N.length;++$<ue;)if(G(N[$],$,N))return!0;return!1}var uC=Pu("length");function hC(N){return N.split("")}function dC(N){return N.match(wS)||[]}function Cg(N,G,$){var ue;return $(N,function(xe,Be,kt){if(G(xe,Be,kt))return ue=Be,!1}),ue}function Fa(N,G,$,ue){for(var xe=N.length,Be=$+(ue?1:-1);ue?Be--:++Be<xe;)if(G(N[Be],Be,N))return Be;return-1}function pi(N,G,$){return G===G?CC(N,G,$):Fa(N,Tg,$)}function fC(N,G,$,ue){for(var xe=$-1,Be=N.length;++xe<Be;)if(ue(N[xe],G))return xe;return-1}function Tg(N){return N!==N}function Eg(N,G){var $=N==null?0:N.length;return $?Ru(N,G)/$:he}function Pu(N){return function(G){return G==null?t:G[N]}}function Du(N){return function(G){return N==null?t:N[G]}}function kg(N,G,$,ue,xe){return xe(N,function(Be,kt,qe){$=ue?(ue=!1,Be):G($,Be,kt,qe)}),$}function pC(N,G){var $=N.length;for(N.sort(G);$--;)N[$]=N[$].value;return N}function Ru(N,G){for(var $,ue=-1,xe=N.length;++ue<xe;){var Be=G(N[ue]);Be!==t&&($=$===t?Be:$+Be)}return $}function ju(N,G){for(var $=-1,ue=Array(N);++$<N;)ue[$]=G($);return ue}function gC(N,G){return nt(G,function($){return[$,N[$]]})}function Ig(N){return N&&N.slice(0,Pg(N)+1).replace(cn,"")}function br(N){return function(G){return N(G)}}function Lu(N,G){return nt(G,function($){return N[$]})}function po(N,G){return N.has(G)}function Ag(N,G){for(var $=-1,ue=N.length;++$<ue&&pi(G,N[$],0)>-1;);return $}function Og(N,G){for(var $=N.length;$--&&pi(G,N[$],0)>-1;);return $}function mC(N,G){for(var $=N.length,ue=0;$--;)N[$]===G&&++ue;return ue}var vC=Du(eC),yC=Du(tC);function bC(N){return"\\"+nC[N]}function wC(N,G){return N==null?t:N[G]}function gi(N){return KS.test(N)}function xC(N){return ZS.test(N)}function _C(N){for(var G,$=[];!(G=N.next()).done;)$.push(G.value);return $}function Fu(N){var G=-1,$=Array(N.size);return N.forEach(function(ue,xe){$[++G]=[xe,ue]}),$}function Mg(N,G){return function($){return N(G($))}}function Zn(N,G){for(var $=-1,ue=N.length,xe=0,Be=[];++$<ue;){var kt=N[$];(kt===G||kt===d)&&(N[$]=d,Be[xe++]=$)}return Be}function Na(N){var G=-1,$=Array(N.size);return N.forEach(function(ue){$[++G]=ue}),$}function SC(N){var G=-1,$=Array(N.size);return N.forEach(function(ue){$[++G]=[ue,ue]}),$}function CC(N,G,$){for(var ue=$-1,xe=N.length;++ue<xe;)if(N[ue]===G)return ue;return-1}function TC(N,G,$){for(var ue=$+1;ue--;)if(N[ue]===G)return ue;return ue}function mi(N){return gi(N)?kC(N):uC(N)}function Yr(N){return gi(N)?IC(N):hC(N)}function Pg(N){for(var G=N.length;G--&&qp.test(N.charAt(G)););return G}var EC=Du(rC);function kC(N){for(var G=Eu.lastIndex=0;Eu.test(N);)++G;return G}function IC(N){return N.match(Eu)||[]}function AC(N){return N.match(qS)||[]}var OC=function N(G){G=G==null?Lt:vi.defaults(Lt.Object(),G,vi.pick(Lt,JS));var $=G.Array,ue=G.Date,xe=G.Error,Be=G.Function,kt=G.Math,qe=G.Object,Nu=G.RegExp,MC=G.String,Pr=G.TypeError,Va=$.prototype,PC=Be.prototype,yi=qe.prototype,Ba=G["__core-js_shared__"],za=PC.toString,Ye=yi.hasOwnProperty,DC=0,Dg=function(){var o=/[^.]+$/.exec(Ba&&Ba.keys&&Ba.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Wa=yi.toString,RC=za.call(qe),jC=Lt._,LC=Nu("^"+za.call(Ye).replace(Fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ha=mg?G.Buffer:t,Jn=G.Symbol,Ua=G.Uint8Array,Rg=Ha?Ha.allocUnsafe:t,$a=Mg(qe.getPrototypeOf,qe),jg=qe.create,Lg=yi.propertyIsEnumerable,Ya=Va.splice,Fg=Jn?Jn.isConcatSpreadable:t,go=Jn?Jn.iterator:t,Ts=Jn?Jn.toStringTag:t,Xa=function(){try{var o=Os(qe,"defineProperty");return o({},"",{}),o}catch{}}(),FC=G.clearTimeout!==Lt.clearTimeout&&G.clearTimeout,NC=ue&&ue.now!==Lt.Date.now&&ue.now,VC=G.setTimeout!==Lt.setTimeout&&G.setTimeout,Ga=kt.ceil,qa=kt.floor,Vu=qe.getOwnPropertySymbols,BC=Ha?Ha.isBuffer:t,Ng=G.isFinite,zC=Va.join,WC=Mg(qe.keys,qe),It=kt.max,Bt=kt.min,HC=ue.now,UC=G.parseInt,Vg=kt.random,$C=Va.reverse,Bu=Os(G,"DataView"),mo=Os(G,"Map"),zu=Os(G,"Promise"),bi=Os(G,"Set"),vo=Os(G,"WeakMap"),yo=Os(qe,"create"),Ka=vo&&new vo,wi={},YC=Ms(Bu),XC=Ms(mo),GC=Ms(zu),qC=Ms(bi),KC=Ms(vo),Za=Jn?Jn.prototype:t,bo=Za?Za.valueOf:t,Bg=Za?Za.toString:t;function C(o){if(ht(o)&&!_e(o)&&!(o instanceof Pe)){if(o instanceof Dr)return o;if(Ye.call(o,"__wrapped__"))return zm(o)}return new Dr(o)}var xi=function(){function o(){}return function(l){if(!ct(l))return{};if(jg)return jg(l);o.prototype=l;var f=new o;return o.prototype=t,f}}();function Ja(){}function Dr(o,l){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=t}C.templateSettings={escape:Xp,evaluate:Gp,interpolate:wu,variable:"",imports:{_:C}},C.prototype=Ja.prototype,C.prototype.constructor=C,Dr.prototype=xi(Ja.prototype),Dr.prototype.constructor=Dr;function Pe(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function ZC(){var o=new Pe(this.__wrapped__);return o.__actions__=ar(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=ar(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=ar(this.__views__),o}function JC(){if(this.__filtered__){var o=new Pe(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function QC(){var o=this.__wrapped__.value(),l=this.__dir__,f=_e(o),m=l<0,x=f?o.length:0,E=hT(0,x,this.__views__),O=E.start,P=E.end,V=P-O,K=m?P:O-1,Z=this.__iteratees__,Q=Z.length,oe=0,fe=Bt(V,this.__takeCount__);if(!f||!m&&x==V&&fe==V)return um(o,this.__actions__);var me=[];e:for(;V--&&oe<fe;){K+=l;for(var ke=-1,ve=o[K];++ke<Q;){var Oe=Z[ke],je=Oe.iteratee,_r=Oe.type,qt=je(ve);if(_r==de)ve=qt;else if(!qt){if(_r==te)continue e;break e}}me[oe++]=ve}return me}Pe.prototype=xi(Ja.prototype),Pe.prototype.constructor=Pe;function Es(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function e2(){this.__data__=yo?yo(null):{},this.size=0}function t2(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}function r2(o){var l=this.__data__;if(yo){var f=l[o];return f===u?t:f}return Ye.call(l,o)?l[o]:t}function n2(o){var l=this.__data__;return yo?l[o]!==t:Ye.call(l,o)}function s2(o,l){var f=this.__data__;return this.size+=this.has(o)?0:1,f[o]=yo&&l===t?u:l,this}Es.prototype.clear=e2,Es.prototype.delete=t2,Es.prototype.get=r2,Es.prototype.has=n2,Es.prototype.set=s2;function Sn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function i2(){this.__data__=[],this.size=0}function o2(o){var l=this.__data__,f=Qa(l,o);if(f<0)return!1;var m=l.length-1;return f==m?l.pop():Ya.call(l,f,1),--this.size,!0}function a2(o){var l=this.__data__,f=Qa(l,o);return f<0?t:l[f][1]}function c2(o){return Qa(this.__data__,o)>-1}function l2(o,l){var f=this.__data__,m=Qa(f,o);return m<0?(++this.size,f.push([o,l])):f[m][1]=l,this}Sn.prototype.clear=i2,Sn.prototype.delete=o2,Sn.prototype.get=a2,Sn.prototype.has=c2,Sn.prototype.set=l2;function Cn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function u2(){this.size=0,this.__data__={hash:new Es,map:new(mo||Sn),string:new Es}}function h2(o){var l=hc(this,o).delete(o);return this.size-=l?1:0,l}function d2(o){return hc(this,o).get(o)}function f2(o){return hc(this,o).has(o)}function p2(o,l){var f=hc(this,o),m=f.size;return f.set(o,l),this.size+=f.size==m?0:1,this}Cn.prototype.clear=u2,Cn.prototype.delete=h2,Cn.prototype.get=d2,Cn.prototype.has=f2,Cn.prototype.set=p2;function ks(o){var l=-1,f=o==null?0:o.length;for(this.__data__=new Cn;++l<f;)this.add(o[l])}function g2(o){return this.__data__.set(o,u),this}function m2(o){return this.__data__.has(o)}ks.prototype.add=ks.prototype.push=g2,ks.prototype.has=m2;function Xr(o){var l=this.__data__=new Sn(o);this.size=l.size}function v2(){this.__data__=new Sn,this.size=0}function y2(o){var l=this.__data__,f=l.delete(o);return this.size=l.size,f}function b2(o){return this.__data__.get(o)}function w2(o){return this.__data__.has(o)}function x2(o,l){var f=this.__data__;if(f instanceof Sn){var m=f.__data__;if(!mo||m.length<s-1)return m.push([o,l]),this.size=++f.size,this;f=this.__data__=new Cn(m)}return f.set(o,l),this.size=f.size,this}Xr.prototype.clear=v2,Xr.prototype.delete=y2,Xr.prototype.get=b2,Xr.prototype.has=w2,Xr.prototype.set=x2;function zg(o,l){var f=_e(o),m=!f&&Ps(o),x=!f&&!m&&ns(o),E=!f&&!m&&!x&&Ti(o),O=f||m||x||E,P=O?ju(o.length,MC):[],V=P.length;for(var K in o)(l||Ye.call(o,K))&&!(O&&(K=="length"||x&&(K=="offset"||K=="parent")||E&&(K=="buffer"||K=="byteLength"||K=="byteOffset")||In(K,V)))&&P.push(K);return P}function Wg(o){var l=o.length;return l?o[Ju(0,l-1)]:t}function _2(o,l){return dc(ar(o),Is(l,0,o.length))}function S2(o){return dc(ar(o))}function Wu(o,l,f){(f!==t&&!Gr(o[l],f)||f===t&&!(l in o))&&Tn(o,l,f)}function wo(o,l,f){var m=o[l];(!(Ye.call(o,l)&&Gr(m,f))||f===t&&!(l in o))&&Tn(o,l,f)}function Qa(o,l){for(var f=o.length;f--;)if(Gr(o[f][0],l))return f;return-1}function C2(o,l,f,m){return Qn(o,function(x,E,O){l(m,x,f(x),O)}),m}function Hg(o,l){return o&&un(l,Rt(l),o)}function T2(o,l){return o&&un(l,lr(l),o)}function Tn(o,l,f){l=="__proto__"&&Xa?Xa(o,l,{configurable:!0,enumerable:!0,value:f,writable:!0}):o[l]=f}function Hu(o,l){for(var f=-1,m=l.length,x=$(m),E=o==null;++f<m;)x[f]=E?t:Sh(o,l[f]);return x}function Is(o,l,f){return o===o&&(f!==t&&(o=o<=f?o:f),l!==t&&(o=o>=l?o:l)),o}function Rr(o,l,f,m,x,E){var O,P=l&p,V=l&g,K=l&y;if(f&&(O=x?f(o,m,x,E):f(o)),O!==t)return O;if(!ct(o))return o;var Z=_e(o);if(Z){if(O=fT(o),!P)return ar(o,O)}else{var Q=zt(o),oe=Q==pe||Q==pr;if(ns(o))return fm(o,P);if(Q==Ze||Q==we||oe&&!x){if(O=V||oe?{}:Pm(o),!P)return V?rT(o,T2(O,o)):tT(o,Hg(O,o))}else{if(!Je[Q])return x?o:{};O=pT(o,Q,P)}}E||(E=new Xr);var fe=E.get(o);if(fe)return fe;E.set(o,O),av(o)?o.forEach(function(ve){O.add(Rr(ve,l,f,ve,o,E))}):iv(o)&&o.forEach(function(ve,Oe){O.set(Oe,Rr(ve,l,f,Oe,o,E))});var me=K?V?lh:ch:V?lr:Rt,ke=Z?t:me(o);return Mr(ke||o,function(ve,Oe){ke&&(Oe=ve,ve=o[Oe]),wo(O,Oe,Rr(ve,l,f,Oe,o,E))}),O}function E2(o){var l=Rt(o);return function(f){return Ug(f,o,l)}}function Ug(o,l,f){var m=f.length;if(o==null)return!m;for(o=qe(o);m--;){var x=f[m],E=l[x],O=o[x];if(O===t&&!(x in o)||!E(O))return!1}return!0}function $g(o,l,f){if(typeof o!="function")throw new Pr(a);return ko(function(){o.apply(t,f)},l)}function xo(o,l,f,m){var x=-1,E=La,O=!0,P=o.length,V=[],K=l.length;if(!P)return V;f&&(l=nt(l,br(f))),m?(E=Au,O=!1):l.length>=s&&(E=po,O=!1,l=new ks(l));e:for(;++x<P;){var Z=o[x],Q=f==null?Z:f(Z);if(Z=m||Z!==0?Z:0,O&&Q===Q){for(var oe=K;oe--;)if(l[oe]===Q)continue e;V.push(Z)}else E(l,Q,m)||V.push(Z)}return V}var Qn=ym(ln),Yg=ym($u,!0);function k2(o,l){var f=!0;return Qn(o,function(m,x,E){return f=!!l(m,x,E),f}),f}function ec(o,l,f){for(var m=-1,x=o.length;++m<x;){var E=o[m],O=l(E);if(O!=null&&(P===t?O===O&&!xr(O):f(O,P)))var P=O,V=E}return V}function I2(o,l,f,m){var x=o.length;for(f=Ce(f),f<0&&(f=-f>x?0:x+f),m=m===t||m>x?x:Ce(m),m<0&&(m+=x),m=f>m?0:lv(m);f<m;)o[f++]=l;return o}function Xg(o,l){var f=[];return Qn(o,function(m,x,E){l(m,x,E)&&f.push(m)}),f}function Ft(o,l,f,m,x){var E=-1,O=o.length;for(f||(f=mT),x||(x=[]);++E<O;){var P=o[E];l>0&&f(P)?l>1?Ft(P,l-1,f,m,x):Kn(x,P):m||(x[x.length]=P)}return x}var Uu=bm(),Gg=bm(!0);function ln(o,l){return o&&Uu(o,l,Rt)}function $u(o,l){return o&&Gg(o,l,Rt)}function tc(o,l){return qn(l,function(f){return An(o[f])})}function As(o,l){l=ts(l,o);for(var f=0,m=l.length;o!=null&&f<m;)o=o[hn(l[f++])];return f&&f==m?o:t}function qg(o,l,f){var m=l(o);return _e(o)?m:Kn(m,f(o))}function Xt(o){return o==null?o===t?Ae:Gn:Ts&&Ts in qe(o)?uT(o):ST(o)}function Yu(o,l){return o>l}function A2(o,l){return o!=null&&Ye.call(o,l)}function O2(o,l){return o!=null&&l in qe(o)}function M2(o,l,f){return o>=Bt(l,f)&&o<It(l,f)}function Xu(o,l,f){for(var m=f?Au:La,x=o[0].length,E=o.length,O=E,P=$(E),V=1/0,K=[];O--;){var Z=o[O];O&&l&&(Z=nt(Z,br(l))),V=Bt(Z.length,V),P[O]=!f&&(l||x>=120&&Z.length>=120)?new ks(O&&Z):t}Z=o[0];var Q=-1,oe=P[0];e:for(;++Q<x&&K.length<V;){var fe=Z[Q],me=l?l(fe):fe;if(fe=f||fe!==0?fe:0,!(oe?po(oe,me):m(K,me,f))){for(O=E;--O;){var ke=P[O];if(!(ke?po(ke,me):m(o[O],me,f)))continue e}oe&&oe.push(me),K.push(fe)}}return K}function P2(o,l,f,m){return ln(o,function(x,E,O){l(m,f(x),E,O)}),m}function _o(o,l,f){l=ts(l,o),o=Lm(o,l);var m=o==null?o:o[hn(Lr(l))];return m==null?t:yr(m,o,f)}function Kg(o){return ht(o)&&Xt(o)==we}function D2(o){return ht(o)&&Xt(o)==ye}function R2(o){return ht(o)&&Xt(o)==jt}function So(o,l,f,m,x){return o===l?!0:o==null||l==null||!ht(o)&&!ht(l)?o!==o&&l!==l:j2(o,l,f,m,So,x)}function j2(o,l,f,m,x,E){var O=_e(o),P=_e(l),V=O?Se:zt(o),K=P?Se:zt(l);V=V==we?Ze:V,K=K==we?Ze:K;var Z=V==Ze,Q=K==Ze,oe=V==K;if(oe&&ns(o)){if(!ns(l))return!1;O=!0,Z=!1}if(oe&&!Z)return E||(E=new Xr),O||Ti(o)?Am(o,l,f,m,x,E):cT(o,l,V,f,m,x,E);if(!(f&w)){var fe=Z&&Ye.call(o,"__wrapped__"),me=Q&&Ye.call(l,"__wrapped__");if(fe||me){var ke=fe?o.value():o,ve=me?l.value():l;return E||(E=new Xr),x(ke,ve,f,m,E)}}return oe?(E||(E=new Xr),lT(o,l,f,m,x,E)):!1}function L2(o){return ht(o)&&zt(o)==Qe}function Gu(o,l,f,m){var x=f.length,E=x,O=!m;if(o==null)return!E;for(o=qe(o);x--;){var P=f[x];if(O&&P[2]?P[1]!==o[P[0]]:!(P[0]in o))return!1}for(;++x<E;){P=f[x];var V=P[0],K=o[V],Z=P[1];if(O&&P[2]){if(K===t&&!(V in o))return!1}else{var Q=new Xr;if(m)var oe=m(K,Z,V,o,l,Q);if(!(oe===t?So(Z,K,w|_,m,Q):oe))return!1}}return!0}function Zg(o){if(!ct(o)||yT(o))return!1;var l=An(o)?LC:ES;return l.test(Ms(o))}function F2(o){return ht(o)&&Xt(o)==gr}function N2(o){return ht(o)&&zt(o)==M}function V2(o){return ht(o)&&yc(o.length)&&!!tt[Xt(o)]}function Jg(o){return typeof o=="function"?o:o==null?ur:typeof o=="object"?_e(o)?tm(o[0],o[1]):em(o):wv(o)}function qu(o){if(!Eo(o))return WC(o);var l=[];for(var f in qe(o))Ye.call(o,f)&&f!="constructor"&&l.push(f);return l}function B2(o){if(!ct(o))return _T(o);var l=Eo(o),f=[];for(var m in o)m=="constructor"&&(l||!Ye.call(o,m))||f.push(m);return f}function Ku(o,l){return o<l}function Qg(o,l){var f=-1,m=cr(o)?$(o.length):[];return Qn(o,function(x,E,O){m[++f]=l(x,E,O)}),m}function em(o){var l=hh(o);return l.length==1&&l[0][2]?Rm(l[0][0],l[0][1]):function(f){return f===o||Gu(f,o,l)}}function tm(o,l){return fh(o)&&Dm(l)?Rm(hn(o),l):function(f){var m=Sh(f,o);return m===t&&m===l?Ch(f,o):So(l,m,w|_)}}function rc(o,l,f,m,x){o!==l&&Uu(l,function(E,O){if(x||(x=new Xr),ct(E))z2(o,l,O,f,rc,m,x);else{var P=m?m(gh(o,O),E,O+"",o,l,x):t;P===t&&(P=E),Wu(o,O,P)}},lr)}function z2(o,l,f,m,x,E,O){var P=gh(o,f),V=gh(l,f),K=O.get(V);if(K){Wu(o,f,K);return}var Z=E?E(P,V,f+"",o,l,O):t,Q=Z===t;if(Q){var oe=_e(V),fe=!oe&&ns(V),me=!oe&&!fe&&Ti(V);Z=V,oe||fe||me?_e(P)?Z=P:yt(P)?Z=ar(P):fe?(Q=!1,Z=fm(V,!0)):me?(Q=!1,Z=pm(V,!0)):Z=[]:Io(V)||Ps(V)?(Z=P,Ps(P)?Z=uv(P):(!ct(P)||An(P))&&(Z=Pm(V))):Q=!1}Q&&(O.set(V,Z),x(Z,V,m,E,O),O.delete(V)),Wu(o,f,Z)}function rm(o,l){var f=o.length;if(f)return l+=l<0?f:0,In(l,f)?o[l]:t}function nm(o,l,f){l.length?l=nt(l,function(E){return _e(E)?function(O){return As(O,E.length===1?E[0]:E)}:E}):l=[ur];var m=-1;l=nt(l,br(ge()));var x=Qg(o,function(E,O,P){var V=nt(l,function(K){return K(E)});return{criteria:V,index:++m,value:E}});return pC(x,function(E,O){return eT(E,O,f)})}function W2(o,l){return sm(o,l,function(f,m){return Ch(o,m)})}function sm(o,l,f){for(var m=-1,x=l.length,E={};++m<x;){var O=l[m],P=As(o,O);f(P,O)&&Co(E,ts(O,o),P)}return E}function H2(o){return function(l){return As(l,o)}}function Zu(o,l,f,m){var x=m?fC:pi,E=-1,O=l.length,P=o;for(o===l&&(l=ar(l)),f&&(P=nt(o,br(f)));++E<O;)for(var V=0,K=l[E],Z=f?f(K):K;(V=x(P,Z,V,m))>-1;)P!==o&&Ya.call(P,V,1),Ya.call(o,V,1);return o}function im(o,l){for(var f=o?l.length:0,m=f-1;f--;){var x=l[f];if(f==m||x!==E){var E=x;In(x)?Ya.call(o,x,1):th(o,x)}}return o}function Ju(o,l){return o+qa(Vg()*(l-o+1))}function U2(o,l,f,m){for(var x=-1,E=It(Ga((l-o)/(f||1)),0),O=$(E);E--;)O[m?E:++x]=o,o+=f;return O}function Qu(o,l){var f="";if(!o||l<1||l>ie)return f;do l%2&&(f+=o),l=qa(l/2),l&&(o+=o);while(l);return f}function Ie(o,l){return mh(jm(o,l,ur),o+"")}function $2(o){return Wg(Ei(o))}function Y2(o,l){var f=Ei(o);return dc(f,Is(l,0,f.length))}function Co(o,l,f,m){if(!ct(o))return o;l=ts(l,o);for(var x=-1,E=l.length,O=E-1,P=o;P!=null&&++x<E;){var V=hn(l[x]),K=f;if(V==="__proto__"||V==="constructor"||V==="prototype")return o;if(x!=O){var Z=P[V];K=m?m(Z,V,P):t,K===t&&(K=ct(Z)?Z:In(l[x+1])?[]:{})}wo(P,V,K),P=P[V]}return o}var om=Ka?function(o,l){return Ka.set(o,l),o}:ur,X2=Xa?function(o,l){return Xa(o,"toString",{configurable:!0,enumerable:!1,value:Eh(l),writable:!0})}:ur;function G2(o){return dc(Ei(o))}function jr(o,l,f){var m=-1,x=o.length;l<0&&(l=-l>x?0:x+l),f=f>x?x:f,f<0&&(f+=x),x=l>f?0:f-l>>>0,l>>>=0;for(var E=$(x);++m<x;)E[m]=o[m+l];return E}function q2(o,l){var f;return Qn(o,function(m,x,E){return f=l(m,x,E),!f}),!!f}function nc(o,l,f){var m=0,x=o==null?m:o.length;if(typeof l=="number"&&l===l&&x<=$e){for(;m<x;){var E=m+x>>>1,O=o[E];O!==null&&!xr(O)&&(f?O<=l:O<l)?m=E+1:x=E}return x}return eh(o,l,ur,f)}function eh(o,l,f,m){var x=0,E=o==null?0:o.length;if(E===0)return 0;l=f(l);for(var O=l!==l,P=l===null,V=xr(l),K=l===t;x<E;){var Z=qa((x+E)/2),Q=f(o[Z]),oe=Q!==t,fe=Q===null,me=Q===Q,ke=xr(Q);if(O)var ve=m||me;else K?ve=me&&(m||oe):P?ve=me&&oe&&(m||!fe):V?ve=me&&oe&&!fe&&(m||!ke):fe||ke?ve=!1:ve=m?Q<=l:Q<l;ve?x=Z+1:E=Z}return Bt(E,Re)}function am(o,l){for(var f=-1,m=o.length,x=0,E=[];++f<m;){var O=o[f],P=l?l(O):O;if(!f||!Gr(P,V)){var V=P;E[x++]=O===0?0:O}}return E}function cm(o){return typeof o=="number"?o:xr(o)?he:+o}function wr(o){if(typeof o=="string")return o;if(_e(o))return nt(o,wr)+"";if(xr(o))return Bg?Bg.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function es(o,l,f){var m=-1,x=La,E=o.length,O=!0,P=[],V=P;if(f)O=!1,x=Au;else if(E>=s){var K=l?null:oT(o);if(K)return Na(K);O=!1,x=po,V=new ks}else V=l?[]:P;e:for(;++m<E;){var Z=o[m],Q=l?l(Z):Z;if(Z=f||Z!==0?Z:0,O&&Q===Q){for(var oe=V.length;oe--;)if(V[oe]===Q)continue e;l&&V.push(Q),P.push(Z)}else x(V,Q,f)||(V!==P&&V.push(Q),P.push(Z))}return P}function th(o,l){return l=ts(l,o),o=Lm(o,l),o==null||delete o[hn(Lr(l))]}function lm(o,l,f,m){return Co(o,l,f(As(o,l)),m)}function sc(o,l,f,m){for(var x=o.length,E=m?x:-1;(m?E--:++E<x)&&l(o[E],E,o););return f?jr(o,m?0:E,m?E+1:x):jr(o,m?E+1:0,m?x:E)}function um(o,l){var f=o;return f instanceof Pe&&(f=f.value()),Ou(l,function(m,x){return x.func.apply(x.thisArg,Kn([m],x.args))},f)}function rh(o,l,f){var m=o.length;if(m<2)return m?es(o[0]):[];for(var x=-1,E=$(m);++x<m;)for(var O=o[x],P=-1;++P<m;)P!=x&&(E[x]=xo(E[x]||O,o[P],l,f));return es(Ft(E,1),l,f)}function hm(o,l,f){for(var m=-1,x=o.length,E=l.length,O={};++m<x;){var P=m<E?l[m]:t;f(O,o[m],P)}return O}function nh(o){return yt(o)?o:[]}function sh(o){return typeof o=="function"?o:ur}function ts(o,l){return _e(o)?o:fh(o,l)?[o]:Bm(He(o))}var K2=Ie;function rs(o,l,f){var m=o.length;return f=f===t?m:f,!l&&f>=m?o:jr(o,l,f)}var dm=FC||function(o){return Lt.clearTimeout(o)};function fm(o,l){if(l)return o.slice();var f=o.length,m=Rg?Rg(f):new o.constructor(f);return o.copy(m),m}function ih(o){var l=new o.constructor(o.byteLength);return new Ua(l).set(new Ua(o)),l}function Z2(o,l){var f=l?ih(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.byteLength)}function J2(o){var l=new o.constructor(o.source,Kp.exec(o));return l.lastIndex=o.lastIndex,l}function Q2(o){return bo?qe(bo.call(o)):{}}function pm(o,l){var f=l?ih(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.length)}function gm(o,l){if(o!==l){var f=o!==t,m=o===null,x=o===o,E=xr(o),O=l!==t,P=l===null,V=l===l,K=xr(l);if(!P&&!K&&!E&&o>l||E&&O&&V&&!P&&!K||m&&O&&V||!f&&V||!x)return 1;if(!m&&!E&&!K&&o<l||K&&f&&x&&!m&&!E||P&&f&&x||!O&&x||!V)return-1}return 0}function eT(o,l,f){for(var m=-1,x=o.criteria,E=l.criteria,O=x.length,P=f.length;++m<O;){var V=gm(x[m],E[m]);if(V){if(m>=P)return V;var K=f[m];return V*(K=="desc"?-1:1)}}return o.index-l.index}function mm(o,l,f,m){for(var x=-1,E=o.length,O=f.length,P=-1,V=l.length,K=It(E-O,0),Z=$(V+K),Q=!m;++P<V;)Z[P]=l[P];for(;++x<O;)(Q||x<E)&&(Z[f[x]]=o[x]);for(;K--;)Z[P++]=o[x++];return Z}function vm(o,l,f,m){for(var x=-1,E=o.length,O=-1,P=f.length,V=-1,K=l.length,Z=It(E-P,0),Q=$(Z+K),oe=!m;++x<Z;)Q[x]=o[x];for(var fe=x;++V<K;)Q[fe+V]=l[V];for(;++O<P;)(oe||x<E)&&(Q[fe+f[O]]=o[x++]);return Q}function ar(o,l){var f=-1,m=o.length;for(l||(l=$(m));++f<m;)l[f]=o[f];return l}function un(o,l,f,m){var x=!f;f||(f={});for(var E=-1,O=l.length;++E<O;){var P=l[E],V=m?m(f[P],o[P],P,f,o):t;V===t&&(V=o[P]),x?Tn(f,P,V):wo(f,P,V)}return f}function tT(o,l){return un(o,dh(o),l)}function rT(o,l){return un(o,Om(o),l)}function ic(o,l){return function(f,m){var x=_e(f)?aC:C2,E=l?l():{};return x(f,o,ge(m,2),E)}}function _i(o){return Ie(function(l,f){var m=-1,x=f.length,E=x>1?f[x-1]:t,O=x>2?f[2]:t;for(E=o.length>3&&typeof E=="function"?(x--,E):t,O&&Gt(f[0],f[1],O)&&(E=x<3?t:E,x=1),l=qe(l);++m<x;){var P=f[m];P&&o(l,P,m,E)}return l})}function ym(o,l){return function(f,m){if(f==null)return f;if(!cr(f))return o(f,m);for(var x=f.length,E=l?x:-1,O=qe(f);(l?E--:++E<x)&&m(O[E],E,O)!==!1;);return f}}function bm(o){return function(l,f,m){for(var x=-1,E=qe(l),O=m(l),P=O.length;P--;){var V=O[o?P:++x];if(f(E[V],V,E)===!1)break}return l}}function nT(o,l,f){var m=l&S,x=To(o);function E(){var O=this&&this!==Lt&&this instanceof E?x:o;return O.apply(m?f:this,arguments)}return E}function wm(o){return function(l){l=He(l);var f=gi(l)?Yr(l):t,m=f?f[0]:l.charAt(0),x=f?rs(f,1).join(""):l.slice(1);return m[o]()+x}}function Si(o){return function(l){return Ou(yv(vv(l).replace(XS,"")),o,"")}}function To(o){return function(){var l=arguments;switch(l.length){case 0:return new o;case 1:return new o(l[0]);case 2:return new o(l[0],l[1]);case 3:return new o(l[0],l[1],l[2]);case 4:return new o(l[0],l[1],l[2],l[3]);case 5:return new o(l[0],l[1],l[2],l[3],l[4]);case 6:return new o(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new o(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var f=xi(o.prototype),m=o.apply(f,l);return ct(m)?m:f}}function sT(o,l,f){var m=To(o);function x(){for(var E=arguments.length,O=$(E),P=E,V=Ci(x);P--;)O[P]=arguments[P];var K=E<3&&O[0]!==V&&O[E-1]!==V?[]:Zn(O,V);if(E-=K.length,E<f)return Tm(o,l,oc,x.placeholder,t,O,K,t,t,f-E);var Z=this&&this!==Lt&&this instanceof x?m:o;return yr(Z,this,O)}return x}function xm(o){return function(l,f,m){var x=qe(l);if(!cr(l)){var E=ge(f,3);l=Rt(l),f=function(P){return E(x[P],P,x)}}var O=o(l,f,m);return O>-1?x[E?l[O]:O]:t}}function _m(o){return kn(function(l){var f=l.length,m=f,x=Dr.prototype.thru;for(o&&l.reverse();m--;){var E=l[m];if(typeof E!="function")throw new Pr(a);if(x&&!O&&uc(E)=="wrapper")var O=new Dr([],!0)}for(m=O?m:f;++m<f;){E=l[m];var P=uc(E),V=P=="wrapper"?uh(E):t;V&&ph(V[0])&&V[1]==(z|I|D|F)&&!V[4].length&&V[9]==1?O=O[uc(V[0])].apply(O,V[3]):O=E.length==1&&ph(E)?O[P]():O.thru(E)}return function(){var K=arguments,Z=K[0];if(O&&K.length==1&&_e(Z))return O.plant(Z).value();for(var Q=0,oe=f?l[Q].apply(this,K):Z;++Q<f;)oe=l[Q].call(this,oe);return oe}})}function oc(o,l,f,m,x,E,O,P,V,K){var Z=l&z,Q=l&S,oe=l&T,fe=l&(I|A),me=l&Y,ke=oe?t:To(o);function ve(){for(var Oe=arguments.length,je=$(Oe),_r=Oe;_r--;)je[_r]=arguments[_r];if(fe)var qt=Ci(ve),Sr=mC(je,qt);if(m&&(je=mm(je,m,x,fe)),E&&(je=vm(je,E,O,fe)),Oe-=Sr,fe&&Oe<K){var bt=Zn(je,qt);return Tm(o,l,oc,ve.placeholder,f,je,bt,P,V,K-Oe)}var qr=Q?f:this,Mn=oe?qr[o]:o;return Oe=je.length,P?je=CT(je,P):me&&Oe>1&&je.reverse(),Z&&V<Oe&&(je.length=V),this&&this!==Lt&&this instanceof ve&&(Mn=ke||To(Mn)),Mn.apply(qr,je)}return ve}function Sm(o,l){return function(f,m){return P2(f,o,l(m),{})}}function ac(o,l){return function(f,m){var x;if(f===t&&m===t)return l;if(f!==t&&(x=f),m!==t){if(x===t)return m;typeof f=="string"||typeof m=="string"?(f=wr(f),m=wr(m)):(f=cm(f),m=cm(m)),x=o(f,m)}return x}}function oh(o){return kn(function(l){return l=nt(l,br(ge())),Ie(function(f){var m=this;return o(l,function(x){return yr(x,m,f)})})})}function cc(o,l){l=l===t?" ":wr(l);var f=l.length;if(f<2)return f?Qu(l,o):l;var m=Qu(l,Ga(o/mi(l)));return gi(l)?rs(Yr(m),0,o).join(""):m.slice(0,o)}function iT(o,l,f,m){var x=l&S,E=To(o);function O(){for(var P=-1,V=arguments.length,K=-1,Z=m.length,Q=$(Z+V),oe=this&&this!==Lt&&this instanceof O?E:o;++K<Z;)Q[K]=m[K];for(;V--;)Q[K++]=arguments[++P];return yr(oe,x?f:this,Q)}return O}function Cm(o){return function(l,f,m){return m&&typeof m!="number"&&Gt(l,f,m)&&(f=m=t),l=On(l),f===t?(f=l,l=0):f=On(f),m=m===t?l<f?1:-1:On(m),U2(l,f,m,o)}}function lc(o){return function(l,f){return typeof l=="string"&&typeof f=="string"||(l=Fr(l),f=Fr(f)),o(l,f)}}function Tm(o,l,f,m,x,E,O,P,V,K){var Z=l&I,Q=Z?O:t,oe=Z?t:O,fe=Z?E:t,me=Z?t:E;l|=Z?D:L,l&=~(Z?L:D),l&k||(l&=-4);var ke=[o,l,x,fe,Q,me,oe,P,V,K],ve=f.apply(t,ke);return ph(o)&&Fm(ve,ke),ve.placeholder=m,Nm(ve,o,l)}function ah(o){var l=kt[o];return function(f,m){if(f=Fr(f),m=m==null?0:Bt(Ce(m),292),m&&Ng(f)){var x=(He(f)+"e").split("e"),E=l(x[0]+"e"+(+x[1]+m));return x=(He(E)+"e").split("e"),+(x[0]+"e"+(+x[1]-m))}return l(f)}}var oT=bi&&1/Na(new bi([,-0]))[1]==le?function(o){return new bi(o)}:Ah;function Em(o){return function(l){var f=zt(l);return f==Qe?Fu(l):f==M?SC(l):gC(l,o(l))}}function En(o,l,f,m,x,E,O,P){var V=l&T;if(!V&&typeof o!="function")throw new Pr(a);var K=m?m.length:0;if(K||(l&=-97,m=x=t),O=O===t?O:It(Ce(O),0),P=P===t?P:Ce(P),K-=x?x.length:0,l&L){var Z=m,Q=x;m=x=t}var oe=V?t:uh(o),fe=[o,l,f,m,x,Z,Q,E,O,P];if(oe&&xT(fe,oe),o=fe[0],l=fe[1],f=fe[2],m=fe[3],x=fe[4],P=fe[9]=fe[9]===t?V?0:o.length:It(fe[9]-K,0),!P&&l&(I|A)&&(l&=-25),!l||l==S)var me=nT(o,l,f);else l==I||l==A?me=sT(o,l,P):(l==D||l==(S|D))&&!x.length?me=iT(o,l,f,m):me=oc.apply(t,fe);var ke=oe?om:Fm;return Nm(ke(me,fe),o,l)}function km(o,l,f,m){return o===t||Gr(o,yi[f])&&!Ye.call(m,f)?l:o}function Im(o,l,f,m,x,E){return ct(o)&&ct(l)&&(E.set(l,o),rc(o,l,t,Im,E),E.delete(l)),o}function aT(o){return Io(o)?t:o}function Am(o,l,f,m,x,E){var O=f&w,P=o.length,V=l.length;if(P!=V&&!(O&&V>P))return!1;var K=E.get(o),Z=E.get(l);if(K&&Z)return K==l&&Z==o;var Q=-1,oe=!0,fe=f&_?new ks:t;for(E.set(o,l),E.set(l,o);++Q<P;){var me=o[Q],ke=l[Q];if(m)var ve=O?m(ke,me,Q,l,o,E):m(me,ke,Q,o,l,E);if(ve!==t){if(ve)continue;oe=!1;break}if(fe){if(!Mu(l,function(Oe,je){if(!po(fe,je)&&(me===Oe||x(me,Oe,f,m,E)))return fe.push(je)})){oe=!1;break}}else if(!(me===ke||x(me,ke,f,m,E))){oe=!1;break}}return E.delete(o),E.delete(l),oe}function cT(o,l,f,m,x,E,O){switch(f){case et:if(o.byteLength!=l.byteLength||o.byteOffset!=l.byteOffset)return!1;o=o.buffer,l=l.buffer;case ye:return!(o.byteLength!=l.byteLength||!E(new Ua(o),new Ua(l)));case nr:case jt:case Dt:return Gr(+o,+l);case sr:return o.name==l.name&&o.message==l.message;case gr:case ce:return o==l+"";case Qe:var P=Fu;case M:var V=m&w;if(P||(P=Na),o.size!=l.size&&!V)return!1;var K=O.get(o);if(K)return K==l;m|=_,O.set(o,l);var Z=Am(P(o),P(l),m,x,E,O);return O.delete(o),Z;case ae:if(bo)return bo.call(o)==bo.call(l)}return!1}function lT(o,l,f,m,x,E){var O=f&w,P=ch(o),V=P.length,K=ch(l),Z=K.length;if(V!=Z&&!O)return!1;for(var Q=V;Q--;){var oe=P[Q];if(!(O?oe in l:Ye.call(l,oe)))return!1}var fe=E.get(o),me=E.get(l);if(fe&&me)return fe==l&&me==o;var ke=!0;E.set(o,l),E.set(l,o);for(var ve=O;++Q<V;){oe=P[Q];var Oe=o[oe],je=l[oe];if(m)var _r=O?m(je,Oe,oe,l,o,E):m(Oe,je,oe,o,l,E);if(!(_r===t?Oe===je||x(Oe,je,f,m,E):_r)){ke=!1;break}ve||(ve=oe=="constructor")}if(ke&&!ve){var qt=o.constructor,Sr=l.constructor;qt!=Sr&&"constructor"in o&&"constructor"in l&&!(typeof qt=="function"&&qt instanceof qt&&typeof Sr=="function"&&Sr instanceof Sr)&&(ke=!1)}return E.delete(o),E.delete(l),ke}function kn(o){return mh(jm(o,t,Um),o+"")}function ch(o){return qg(o,Rt,dh)}function lh(o){return qg(o,lr,Om)}var uh=Ka?function(o){return Ka.get(o)}:Ah;function uc(o){for(var l=o.name+"",f=wi[l],m=Ye.call(wi,l)?f.length:0;m--;){var x=f[m],E=x.func;if(E==null||E==o)return x.name}return l}function Ci(o){var l=Ye.call(C,"placeholder")?C:o;return l.placeholder}function ge(){var o=C.iteratee||kh;return o=o===kh?Jg:o,arguments.length?o(arguments[0],arguments[1]):o}function hc(o,l){var f=o.__data__;return vT(l)?f[typeof l=="string"?"string":"hash"]:f.map}function hh(o){for(var l=Rt(o),f=l.length;f--;){var m=l[f],x=o[m];l[f]=[m,x,Dm(x)]}return l}function Os(o,l){var f=wC(o,l);return Zg(f)?f:t}function uT(o){var l=Ye.call(o,Ts),f=o[Ts];try{o[Ts]=t;var m=!0}catch{}var x=Wa.call(o);return m&&(l?o[Ts]=f:delete o[Ts]),x}var dh=Vu?function(o){return o==null?[]:(o=qe(o),qn(Vu(o),function(l){return Lg.call(o,l)}))}:Oh,Om=Vu?function(o){for(var l=[];o;)Kn(l,dh(o)),o=$a(o);return l}:Oh,zt=Xt;(Bu&&zt(new Bu(new ArrayBuffer(1)))!=et||mo&&zt(new mo)!=Qe||zu&&zt(zu.resolve())!=Et||bi&&zt(new bi)!=M||vo&&zt(new vo)!=Ge)&&(zt=function(o){var l=Xt(o),f=l==Ze?o.constructor:t,m=f?Ms(f):"";if(m)switch(m){case YC:return et;case XC:return Qe;case GC:return Et;case qC:return M;case KC:return Ge}return l});function hT(o,l,f){for(var m=-1,x=f.length;++m<x;){var E=f[m],O=E.size;switch(E.type){case"drop":o+=O;break;case"dropRight":l-=O;break;case"take":l=Bt(l,o+O);break;case"takeRight":o=It(o,l-O);break}}return{start:o,end:l}}function dT(o){var l=o.match(yS);return l?l[1].split(bS):[]}function Mm(o,l,f){l=ts(l,o);for(var m=-1,x=l.length,E=!1;++m<x;){var O=hn(l[m]);if(!(E=o!=null&&f(o,O)))break;o=o[O]}return E||++m!=x?E:(x=o==null?0:o.length,!!x&&yc(x)&&In(O,x)&&(_e(o)||Ps(o)))}function fT(o){var l=o.length,f=new o.constructor(l);return l&&typeof o[0]=="string"&&Ye.call(o,"index")&&(f.index=o.index,f.input=o.input),f}function Pm(o){return typeof o.constructor=="function"&&!Eo(o)?xi($a(o)):{}}function pT(o,l,f){var m=o.constructor;switch(l){case ye:return ih(o);case nr:case jt:return new m(+o);case et:return Z2(o,f);case ir:case vt:case mr:case $r:case or:case an:case Yt:case ho:case fo:return pm(o,f);case Qe:return new m;case Dt:case ce:return new m(o);case gr:return J2(o);case M:return new m;case ae:return Q2(o)}}function gT(o,l){var f=l.length;if(!f)return o;var m=f-1;return l[m]=(f>1?"& ":"")+l[m],l=l.join(f>2?", ":" "),o.replace(vS,`{
/* [wrapped with `+l+`] */
`)}function mT(o){return _e(o)||Ps(o)||!!(Fg&&o&&o[Fg])}function In(o,l){var f=typeof o;return l=l??ie,!!l&&(f=="number"||f!="symbol"&&IS.test(o))&&o>-1&&o%1==0&&o<l}function Gt(o,l,f){if(!ct(f))return!1;var m=typeof l;return(m=="number"?cr(f)&&In(l,f.length):m=="string"&&l in f)?Gr(f[l],o):!1}function fh(o,l){if(_e(o))return!1;var f=typeof o;return f=="number"||f=="symbol"||f=="boolean"||o==null||xr(o)?!0:Pa.test(o)||!xu.test(o)||l!=null&&o in qe(l)}function vT(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}function ph(o){var l=uc(o),f=C[l];if(typeof f!="function"||!(l in Pe.prototype))return!1;if(o===f)return!0;var m=uh(f);return!!m&&o===m[0]}function yT(o){return!!Dg&&Dg in o}var bT=Ba?An:Mh;function Eo(o){var l=o&&o.constructor,f=typeof l=="function"&&l.prototype||yi;return o===f}function Dm(o){return o===o&&!ct(o)}function Rm(o,l){return function(f){return f==null?!1:f[o]===l&&(l!==t||o in qe(f))}}function wT(o){var l=mc(o,function(m){return f.size===h&&f.clear(),m}),f=l.cache;return l}function xT(o,l){var f=o[1],m=l[1],x=f|m,E=x<(S|T|z),O=m==z&&f==I||m==z&&f==F&&o[7].length<=l[8]||m==(z|F)&&l[7].length<=l[8]&&f==I;if(!(E||O))return o;m&S&&(o[2]=l[2],x|=f&S?0:k);var P=l[3];if(P){var V=o[3];o[3]=V?mm(V,P,l[4]):P,o[4]=V?Zn(o[3],d):l[4]}return P=l[5],P&&(V=o[5],o[5]=V?vm(V,P,l[6]):P,o[6]=V?Zn(o[5],d):l[6]),P=l[7],P&&(o[7]=P),m&z&&(o[8]=o[8]==null?l[8]:Bt(o[8],l[8])),o[9]==null&&(o[9]=l[9]),o[0]=l[0],o[1]=x,o}function _T(o){var l=[];if(o!=null)for(var f in qe(o))l.push(f);return l}function ST(o){return Wa.call(o)}function jm(o,l,f){return l=It(l===t?o.length-1:l,0),function(){for(var m=arguments,x=-1,E=It(m.length-l,0),O=$(E);++x<E;)O[x]=m[l+x];x=-1;for(var P=$(l+1);++x<l;)P[x]=m[x];return P[l]=f(O),yr(o,this,P)}}function Lm(o,l){return l.length<2?o:As(o,jr(l,0,-1))}function CT(o,l){for(var f=o.length,m=Bt(l.length,f),x=ar(o);m--;){var E=l[m];o[m]=In(E,f)?x[E]:t}return o}function gh(o,l){if(!(l==="constructor"&&typeof o[l]=="function")&&l!="__proto__")return o[l]}var Fm=Vm(om),ko=VC||function(o,l){return Lt.setTimeout(o,l)},mh=Vm(X2);function Nm(o,l,f){var m=l+"";return mh(o,gT(m,TT(dT(m),f)))}function Vm(o){var l=0,f=0;return function(){var m=HC(),x=X-(m-f);if(f=m,x>0){if(++l>=U)return arguments[0]}else l=0;return o.apply(t,arguments)}}function dc(o,l){var f=-1,m=o.length,x=m-1;for(l=l===t?m:l;++f<l;){var E=Ju(f,x),O=o[E];o[E]=o[f],o[f]=O}return o.length=l,o}var Bm=wT(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(Ve,function(f,m,x,E){l.push(x?E.replace(_S,"$1"):m||f)}),l});function hn(o){if(typeof o=="string"||xr(o))return o;var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function Ms(o){if(o!=null){try{return za.call(o)}catch{}try{return o+""}catch{}}return""}function TT(o,l){return Mr(Le,function(f){var m="_."+f[0];l&f[1]&&!La(o,m)&&o.push(m)}),o.sort()}function zm(o){if(o instanceof Pe)return o.clone();var l=new Dr(o.__wrapped__,o.__chain__);return l.__actions__=ar(o.__actions__),l.__index__=o.__index__,l.__values__=o.__values__,l}function ET(o,l,f){(f?Gt(o,l,f):l===t)?l=1:l=It(Ce(l),0);var m=o==null?0:o.length;if(!m||l<1)return[];for(var x=0,E=0,O=$(Ga(m/l));x<m;)O[E++]=jr(o,x,x+=l);return O}function kT(o){for(var l=-1,f=o==null?0:o.length,m=0,x=[];++l<f;){var E=o[l];E&&(x[m++]=E)}return x}function IT(){var o=arguments.length;if(!o)return[];for(var l=$(o-1),f=arguments[0],m=o;m--;)l[m-1]=arguments[m];return Kn(_e(f)?ar(f):[f],Ft(l,1))}var AT=Ie(function(o,l){return yt(o)?xo(o,Ft(l,1,yt,!0)):[]}),OT=Ie(function(o,l){var f=Lr(l);return yt(f)&&(f=t),yt(o)?xo(o,Ft(l,1,yt,!0),ge(f,2)):[]}),MT=Ie(function(o,l){var f=Lr(l);return yt(f)&&(f=t),yt(o)?xo(o,Ft(l,1,yt,!0),t,f):[]});function PT(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ce(l),jr(o,l<0?0:l,m)):[]}function DT(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ce(l),l=m-l,jr(o,0,l<0?0:l)):[]}function RT(o,l){return o&&o.length?sc(o,ge(l,3),!0,!0):[]}function jT(o,l){return o&&o.length?sc(o,ge(l,3),!0):[]}function LT(o,l,f,m){var x=o==null?0:o.length;return x?(f&&typeof f!="number"&&Gt(o,l,f)&&(f=0,m=x),I2(o,l,f,m)):[]}function Wm(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=f==null?0:Ce(f);return x<0&&(x=It(m+x,0)),Fa(o,ge(l,3),x)}function Hm(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=m-1;return f!==t&&(x=Ce(f),x=f<0?It(m+x,0):Bt(x,m-1)),Fa(o,ge(l,3),x,!0)}function Um(o){var l=o==null?0:o.length;return l?Ft(o,1):[]}function FT(o){var l=o==null?0:o.length;return l?Ft(o,le):[]}function NT(o,l){var f=o==null?0:o.length;return f?(l=l===t?1:Ce(l),Ft(o,l)):[]}function VT(o){for(var l=-1,f=o==null?0:o.length,m={};++l<f;){var x=o[l];m[x[0]]=x[1]}return m}function $m(o){return o&&o.length?o[0]:t}function BT(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=f==null?0:Ce(f);return x<0&&(x=It(m+x,0)),pi(o,l,x)}function zT(o){var l=o==null?0:o.length;return l?jr(o,0,-1):[]}var WT=Ie(function(o){var l=nt(o,nh);return l.length&&l[0]===o[0]?Xu(l):[]}),HT=Ie(function(o){var l=Lr(o),f=nt(o,nh);return l===Lr(f)?l=t:f.pop(),f.length&&f[0]===o[0]?Xu(f,ge(l,2)):[]}),UT=Ie(function(o){var l=Lr(o),f=nt(o,nh);return l=typeof l=="function"?l:t,l&&f.pop(),f.length&&f[0]===o[0]?Xu(f,t,l):[]});function $T(o,l){return o==null?"":zC.call(o,l)}function Lr(o){var l=o==null?0:o.length;return l?o[l-1]:t}function YT(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=m;return f!==t&&(x=Ce(f),x=x<0?It(m+x,0):Bt(x,m-1)),l===l?TC(o,l,x):Fa(o,Tg,x,!0)}function XT(o,l){return o&&o.length?rm(o,Ce(l)):t}var GT=Ie(Ym);function Ym(o,l){return o&&o.length&&l&&l.length?Zu(o,l):o}function qT(o,l,f){return o&&o.length&&l&&l.length?Zu(o,l,ge(f,2)):o}function KT(o,l,f){return o&&o.length&&l&&l.length?Zu(o,l,t,f):o}var ZT=kn(function(o,l){var f=o==null?0:o.length,m=Hu(o,l);return im(o,nt(l,function(x){return In(x,f)?+x:x}).sort(gm)),m});function JT(o,l){var f=[];if(!(o&&o.length))return f;var m=-1,x=[],E=o.length;for(l=ge(l,3);++m<E;){var O=o[m];l(O,m,o)&&(f.push(O),x.push(m))}return im(o,x),f}function vh(o){return o==null?o:$C.call(o)}function QT(o,l,f){var m=o==null?0:o.length;return m?(f&&typeof f!="number"&&Gt(o,l,f)?(l=0,f=m):(l=l==null?0:Ce(l),f=f===t?m:Ce(f)),jr(o,l,f)):[]}function eE(o,l){return nc(o,l)}function tE(o,l,f){return eh(o,l,ge(f,2))}function rE(o,l){var f=o==null?0:o.length;if(f){var m=nc(o,l);if(m<f&&Gr(o[m],l))return m}return-1}function nE(o,l){return nc(o,l,!0)}function sE(o,l,f){return eh(o,l,ge(f,2),!0)}function iE(o,l){var f=o==null?0:o.length;if(f){var m=nc(o,l,!0)-1;if(Gr(o[m],l))return m}return-1}function oE(o){return o&&o.length?am(o):[]}function aE(o,l){return o&&o.length?am(o,ge(l,2)):[]}function cE(o){var l=o==null?0:o.length;return l?jr(o,1,l):[]}function lE(o,l,f){return o&&o.length?(l=f||l===t?1:Ce(l),jr(o,0,l<0?0:l)):[]}function uE(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ce(l),l=m-l,jr(o,l<0?0:l,m)):[]}function hE(o,l){return o&&o.length?sc(o,ge(l,3),!1,!0):[]}function dE(o,l){return o&&o.length?sc(o,ge(l,3)):[]}var fE=Ie(function(o){return es(Ft(o,1,yt,!0))}),pE=Ie(function(o){var l=Lr(o);return yt(l)&&(l=t),es(Ft(o,1,yt,!0),ge(l,2))}),gE=Ie(function(o){var l=Lr(o);return l=typeof l=="function"?l:t,es(Ft(o,1,yt,!0),t,l)});function mE(o){return o&&o.length?es(o):[]}function vE(o,l){return o&&o.length?es(o,ge(l,2)):[]}function yE(o,l){return l=typeof l=="function"?l:t,o&&o.length?es(o,t,l):[]}function yh(o){if(!(o&&o.length))return[];var l=0;return o=qn(o,function(f){if(yt(f))return l=It(f.length,l),!0}),ju(l,function(f){return nt(o,Pu(f))})}function Xm(o,l){if(!(o&&o.length))return[];var f=yh(o);return l==null?f:nt(f,function(m){return yr(l,t,m)})}var bE=Ie(function(o,l){return yt(o)?xo(o,l):[]}),wE=Ie(function(o){return rh(qn(o,yt))}),xE=Ie(function(o){var l=Lr(o);return yt(l)&&(l=t),rh(qn(o,yt),ge(l,2))}),_E=Ie(function(o){var l=Lr(o);return l=typeof l=="function"?l:t,rh(qn(o,yt),t,l)}),SE=Ie(yh);function CE(o,l){return hm(o||[],l||[],wo)}function TE(o,l){return hm(o||[],l||[],Co)}var EE=Ie(function(o){var l=o.length,f=l>1?o[l-1]:t;return f=typeof f=="function"?(o.pop(),f):t,Xm(o,f)});function Gm(o){var l=C(o);return l.__chain__=!0,l}function kE(o,l){return l(o),o}function fc(o,l){return l(o)}var IE=kn(function(o){var l=o.length,f=l?o[0]:0,m=this.__wrapped__,x=function(E){return Hu(E,o)};return l>1||this.__actions__.length||!(m instanceof Pe)||!In(f)?this.thru(x):(m=m.slice(f,+f+(l?1:0)),m.__actions__.push({func:fc,args:[x],thisArg:t}),new Dr(m,this.__chain__).thru(function(E){return l&&!E.length&&E.push(t),E}))});function AE(){return Gm(this)}function OE(){return new Dr(this.value(),this.__chain__)}function ME(){this.__values__===t&&(this.__values__=cv(this.value()));var o=this.__index__>=this.__values__.length,l=o?t:this.__values__[this.__index__++];return{done:o,value:l}}function PE(){return this}function DE(o){for(var l,f=this;f instanceof Ja;){var m=zm(f);m.__index__=0,m.__values__=t,l?x.__wrapped__=m:l=m;var x=m;f=f.__wrapped__}return x.__wrapped__=o,l}function RE(){var o=this.__wrapped__;if(o instanceof Pe){var l=o;return this.__actions__.length&&(l=new Pe(this)),l=l.reverse(),l.__actions__.push({func:fc,args:[vh],thisArg:t}),new Dr(l,this.__chain__)}return this.thru(vh)}function jE(){return um(this.__wrapped__,this.__actions__)}var LE=ic(function(o,l,f){Ye.call(o,f)?++o[f]:Tn(o,f,1)});function FE(o,l,f){var m=_e(o)?Sg:k2;return f&&Gt(o,l,f)&&(l=t),m(o,ge(l,3))}function NE(o,l){var f=_e(o)?qn:Xg;return f(o,ge(l,3))}var VE=xm(Wm),BE=xm(Hm);function zE(o,l){return Ft(pc(o,l),1)}function WE(o,l){return Ft(pc(o,l),le)}function HE(o,l,f){return f=f===t?1:Ce(f),Ft(pc(o,l),f)}function qm(o,l){var f=_e(o)?Mr:Qn;return f(o,ge(l,3))}function Km(o,l){var f=_e(o)?cC:Yg;return f(o,ge(l,3))}var UE=ic(function(o,l,f){Ye.call(o,f)?o[f].push(l):Tn(o,f,[l])});function $E(o,l,f,m){o=cr(o)?o:Ei(o),f=f&&!m?Ce(f):0;var x=o.length;return f<0&&(f=It(x+f,0)),bc(o)?f<=x&&o.indexOf(l,f)>-1:!!x&&pi(o,l,f)>-1}var YE=Ie(function(o,l,f){var m=-1,x=typeof l=="function",E=cr(o)?$(o.length):[];return Qn(o,function(O){E[++m]=x?yr(l,O,f):_o(O,l,f)}),E}),XE=ic(function(o,l,f){Tn(o,f,l)});function pc(o,l){var f=_e(o)?nt:Qg;return f(o,ge(l,3))}function GE(o,l,f,m){return o==null?[]:(_e(l)||(l=l==null?[]:[l]),f=m?t:f,_e(f)||(f=f==null?[]:[f]),nm(o,l,f))}var qE=ic(function(o,l,f){o[f?0:1].push(l)},function(){return[[],[]]});function KE(o,l,f){var m=_e(o)?Ou:kg,x=arguments.length<3;return m(o,ge(l,4),f,x,Qn)}function ZE(o,l,f){var m=_e(o)?lC:kg,x=arguments.length<3;return m(o,ge(l,4),f,x,Yg)}function JE(o,l){var f=_e(o)?qn:Xg;return f(o,vc(ge(l,3)))}function QE(o){var l=_e(o)?Wg:$2;return l(o)}function ek(o,l,f){(f?Gt(o,l,f):l===t)?l=1:l=Ce(l);var m=_e(o)?_2:Y2;return m(o,l)}function tk(o){var l=_e(o)?S2:G2;return l(o)}function rk(o){if(o==null)return 0;if(cr(o))return bc(o)?mi(o):o.length;var l=zt(o);return l==Qe||l==M?o.size:qu(o).length}function nk(o,l,f){var m=_e(o)?Mu:q2;return f&&Gt(o,l,f)&&(l=t),m(o,ge(l,3))}var sk=Ie(function(o,l){if(o==null)return[];var f=l.length;return f>1&&Gt(o,l[0],l[1])?l=[]:f>2&&Gt(l[0],l[1],l[2])&&(l=[l[0]]),nm(o,Ft(l,1),[])}),gc=NC||function(){return Lt.Date.now()};function ik(o,l){if(typeof l!="function")throw new Pr(a);return o=Ce(o),function(){if(--o<1)return l.apply(this,arguments)}}function Zm(o,l,f){return l=f?t:l,l=o&&l==null?o.length:l,En(o,z,t,t,t,t,l)}function Jm(o,l){var f;if(typeof l!="function")throw new Pr(a);return o=Ce(o),function(){return--o>0&&(f=l.apply(this,arguments)),o<=1&&(l=t),f}}var bh=Ie(function(o,l,f){var m=S;if(f.length){var x=Zn(f,Ci(bh));m|=D}return En(o,m,l,f,x)}),Qm=Ie(function(o,l,f){var m=S|T;if(f.length){var x=Zn(f,Ci(Qm));m|=D}return En(l,m,o,f,x)});function ev(o,l,f){l=f?t:l;var m=En(o,I,t,t,t,t,t,l);return m.placeholder=ev.placeholder,m}function tv(o,l,f){l=f?t:l;var m=En(o,A,t,t,t,t,t,l);return m.placeholder=tv.placeholder,m}function rv(o,l,f){var m,x,E,O,P,V,K=0,Z=!1,Q=!1,oe=!0;if(typeof o!="function")throw new Pr(a);l=Fr(l)||0,ct(f)&&(Z=!!f.leading,Q="maxWait"in f,E=Q?It(Fr(f.maxWait)||0,l):E,oe="trailing"in f?!!f.trailing:oe);function fe(bt){var qr=m,Mn=x;return m=x=t,K=bt,O=o.apply(Mn,qr),O}function me(bt){return K=bt,P=ko(Oe,l),Z?fe(bt):O}function ke(bt){var qr=bt-V,Mn=bt-K,xv=l-qr;return Q?Bt(xv,E-Mn):xv}function ve(bt){var qr=bt-V,Mn=bt-K;return V===t||qr>=l||qr<0||Q&&Mn>=E}function Oe(){var bt=gc();if(ve(bt))return je(bt);P=ko(Oe,ke(bt))}function je(bt){return P=t,oe&&m?fe(bt):(m=x=t,O)}function _r(){P!==t&&dm(P),K=0,m=V=x=P=t}function qt(){return P===t?O:je(gc())}function Sr(){var bt=gc(),qr=ve(bt);if(m=arguments,x=this,V=bt,qr){if(P===t)return me(V);if(Q)return dm(P),P=ko(Oe,l),fe(V)}return P===t&&(P=ko(Oe,l)),O}return Sr.cancel=_r,Sr.flush=qt,Sr}var ok=Ie(function(o,l){return $g(o,1,l)}),ak=Ie(function(o,l,f){return $g(o,Fr(l)||0,f)});function ck(o){return En(o,Y)}function mc(o,l){if(typeof o!="function"||l!=null&&typeof l!="function")throw new Pr(a);var f=function(){var m=arguments,x=l?l.apply(this,m):m[0],E=f.cache;if(E.has(x))return E.get(x);var O=o.apply(this,m);return f.cache=E.set(x,O)||E,O};return f.cache=new(mc.Cache||Cn),f}mc.Cache=Cn;function vc(o){if(typeof o!="function")throw new Pr(a);return function(){var l=arguments;switch(l.length){case 0:return!o.call(this);case 1:return!o.call(this,l[0]);case 2:return!o.call(this,l[0],l[1]);case 3:return!o.call(this,l[0],l[1],l[2])}return!o.apply(this,l)}}function lk(o){return Jm(2,o)}var uk=K2(function(o,l){l=l.length==1&&_e(l[0])?nt(l[0],br(ge())):nt(Ft(l,1),br(ge()));var f=l.length;return Ie(function(m){for(var x=-1,E=Bt(m.length,f);++x<E;)m[x]=l[x].call(this,m[x]);return yr(o,this,m)})}),wh=Ie(function(o,l){var f=Zn(l,Ci(wh));return En(o,D,t,l,f)}),nv=Ie(function(o,l){var f=Zn(l,Ci(nv));return En(o,L,t,l,f)}),hk=kn(function(o,l){return En(o,F,t,t,t,l)});function dk(o,l){if(typeof o!="function")throw new Pr(a);return l=l===t?l:Ce(l),Ie(o,l)}function fk(o,l){if(typeof o!="function")throw new Pr(a);return l=l==null?0:It(Ce(l),0),Ie(function(f){var m=f[l],x=rs(f,0,l);return m&&Kn(x,m),yr(o,this,x)})}function pk(o,l,f){var m=!0,x=!0;if(typeof o!="function")throw new Pr(a);return ct(f)&&(m="leading"in f?!!f.leading:m,x="trailing"in f?!!f.trailing:x),rv(o,l,{leading:m,maxWait:l,trailing:x})}function gk(o){return Zm(o,1)}function mk(o,l){return wh(sh(l),o)}function vk(){if(!arguments.length)return[];var o=arguments[0];return _e(o)?o:[o]}function yk(o){return Rr(o,y)}function bk(o,l){return l=typeof l=="function"?l:t,Rr(o,y,l)}function wk(o){return Rr(o,p|y)}function xk(o,l){return l=typeof l=="function"?l:t,Rr(o,p|y,l)}function _k(o,l){return l==null||Ug(o,l,Rt(l))}function Gr(o,l){return o===l||o!==o&&l!==l}var Sk=lc(Yu),Ck=lc(function(o,l){return o>=l}),Ps=Kg(function(){return arguments}())?Kg:function(o){return ht(o)&&Ye.call(o,"callee")&&!Lg.call(o,"callee")},_e=$.isArray,Tk=vg?br(vg):D2;function cr(o){return o!=null&&yc(o.length)&&!An(o)}function yt(o){return ht(o)&&cr(o)}function Ek(o){return o===!0||o===!1||ht(o)&&Xt(o)==nr}var ns=BC||Mh,kk=yg?br(yg):R2;function Ik(o){return ht(o)&&o.nodeType===1&&!Io(o)}function Ak(o){if(o==null)return!0;if(cr(o)&&(_e(o)||typeof o=="string"||typeof o.splice=="function"||ns(o)||Ti(o)||Ps(o)))return!o.length;var l=zt(o);if(l==Qe||l==M)return!o.size;if(Eo(o))return!qu(o).length;for(var f in o)if(Ye.call(o,f))return!1;return!0}function Ok(o,l){return So(o,l)}function Mk(o,l,f){f=typeof f=="function"?f:t;var m=f?f(o,l):t;return m===t?So(o,l,t,f):!!m}function xh(o){if(!ht(o))return!1;var l=Xt(o);return l==sr||l==Tt||typeof o.message=="string"&&typeof o.name=="string"&&!Io(o)}function Pk(o){return typeof o=="number"&&Ng(o)}function An(o){if(!ct(o))return!1;var l=Xt(o);return l==pe||l==pr||l==at||l==_n}function sv(o){return typeof o=="number"&&o==Ce(o)}function yc(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=ie}function ct(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}function ht(o){return o!=null&&typeof o=="object"}var iv=bg?br(bg):L2;function Dk(o,l){return o===l||Gu(o,l,hh(l))}function Rk(o,l,f){return f=typeof f=="function"?f:t,Gu(o,l,hh(l),f)}function jk(o){return ov(o)&&o!=+o}function Lk(o){if(bT(o))throw new xe(i);return Zg(o)}function Fk(o){return o===null}function Nk(o){return o==null}function ov(o){return typeof o=="number"||ht(o)&&Xt(o)==Dt}function Io(o){if(!ht(o)||Xt(o)!=Ze)return!1;var l=$a(o);if(l===null)return!0;var f=Ye.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&za.call(f)==RC}var _h=wg?br(wg):F2;function Vk(o){return sv(o)&&o>=-9007199254740991&&o<=ie}var av=xg?br(xg):N2;function bc(o){return typeof o=="string"||!_e(o)&&ht(o)&&Xt(o)==ce}function xr(o){return typeof o=="symbol"||ht(o)&&Xt(o)==ae}var Ti=_g?br(_g):V2;function Bk(o){return o===t}function zk(o){return ht(o)&&zt(o)==Ge}function Wk(o){return ht(o)&&Xt(o)==We}var Hk=lc(Ku),Uk=lc(function(o,l){return o<=l});function cv(o){if(!o)return[];if(cr(o))return bc(o)?Yr(o):ar(o);if(go&&o[go])return _C(o[go]());var l=zt(o),f=l==Qe?Fu:l==M?Na:Ei;return f(o)}function On(o){if(!o)return o===0?o:0;if(o=Fr(o),o===le||o===-1/0){var l=o<0?-1:1;return l*se}return o===o?o:0}function Ce(o){var l=On(o),f=l%1;return l===l?f?l-f:l:0}function lv(o){return o?Is(Ce(o),0,re):0}function Fr(o){if(typeof o=="number")return o;if(xr(o))return he;if(ct(o)){var l=typeof o.valueOf=="function"?o.valueOf():o;o=ct(l)?l+"":l}if(typeof o!="string")return o===0?o:+o;o=Ig(o);var f=TS.test(o);return f||kS.test(o)?iC(o.slice(2),f?2:8):CS.test(o)?he:+o}function uv(o){return un(o,lr(o))}function $k(o){return o?Is(Ce(o),-9007199254740991,ie):o===0?o:0}function He(o){return o==null?"":wr(o)}var Yk=_i(function(o,l){if(Eo(l)||cr(l)){un(l,Rt(l),o);return}for(var f in l)Ye.call(l,f)&&wo(o,f,l[f])}),hv=_i(function(o,l){un(l,lr(l),o)}),wc=_i(function(o,l,f,m){un(l,lr(l),o,m)}),Xk=_i(function(o,l,f,m){un(l,Rt(l),o,m)}),Gk=kn(Hu);function qk(o,l){var f=xi(o);return l==null?f:Hg(f,l)}var Kk=Ie(function(o,l){o=qe(o);var f=-1,m=l.length,x=m>2?l[2]:t;for(x&&Gt(l[0],l[1],x)&&(m=1);++f<m;)for(var E=l[f],O=lr(E),P=-1,V=O.length;++P<V;){var K=O[P],Z=o[K];(Z===t||Gr(Z,yi[K])&&!Ye.call(o,K))&&(o[K]=E[K])}return o}),Zk=Ie(function(o){return o.push(t,Im),yr(dv,t,o)});function Jk(o,l){return Cg(o,ge(l,3),ln)}function Qk(o,l){return Cg(o,ge(l,3),$u)}function e5(o,l){return o==null?o:Uu(o,ge(l,3),lr)}function t5(o,l){return o==null?o:Gg(o,ge(l,3),lr)}function r5(o,l){return o&&ln(o,ge(l,3))}function n5(o,l){return o&&$u(o,ge(l,3))}function s5(o){return o==null?[]:tc(o,Rt(o))}function i5(o){return o==null?[]:tc(o,lr(o))}function Sh(o,l,f){var m=o==null?t:As(o,l);return m===t?f:m}function o5(o,l){return o!=null&&Mm(o,l,A2)}function Ch(o,l){return o!=null&&Mm(o,l,O2)}var a5=Sm(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=Wa.call(l)),o[l]=f},Eh(ur)),c5=Sm(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=Wa.call(l)),Ye.call(o,l)?o[l].push(f):o[l]=[f]},ge),l5=Ie(_o);function Rt(o){return cr(o)?zg(o):qu(o)}function lr(o){return cr(o)?zg(o,!0):B2(o)}function u5(o,l){var f={};return l=ge(l,3),ln(o,function(m,x,E){Tn(f,l(m,x,E),m)}),f}function h5(o,l){var f={};return l=ge(l,3),ln(o,function(m,x,E){Tn(f,x,l(m,x,E))}),f}var d5=_i(function(o,l,f){rc(o,l,f)}),dv=_i(function(o,l,f,m){rc(o,l,f,m)}),f5=kn(function(o,l){var f={};if(o==null)return f;var m=!1;l=nt(l,function(E){return E=ts(E,o),m||(m=E.length>1),E}),un(o,lh(o),f),m&&(f=Rr(f,p|g|y,aT));for(var x=l.length;x--;)th(f,l[x]);return f});function p5(o,l){return fv(o,vc(ge(l)))}var g5=kn(function(o,l){return o==null?{}:W2(o,l)});function fv(o,l){if(o==null)return{};var f=nt(lh(o),function(m){return[m]});return l=ge(l),sm(o,f,function(m,x){return l(m,x[0])})}function m5(o,l,f){l=ts(l,o);var m=-1,x=l.length;for(x||(x=1,o=t);++m<x;){var E=o==null?t:o[hn(l[m])];E===t&&(m=x,E=f),o=An(E)?E.call(o):E}return o}function v5(o,l,f){return o==null?o:Co(o,l,f)}function y5(o,l,f,m){return m=typeof m=="function"?m:t,o==null?o:Co(o,l,f,m)}var pv=Em(Rt),gv=Em(lr);function b5(o,l,f){var m=_e(o),x=m||ns(o)||Ti(o);if(l=ge(l,4),f==null){var E=o&&o.constructor;x?f=m?new E:[]:ct(o)?f=An(E)?xi($a(o)):{}:f={}}return(x?Mr:ln)(o,function(O,P,V){return l(f,O,P,V)}),f}function w5(o,l){return o==null?!0:th(o,l)}function x5(o,l,f){return o==null?o:lm(o,l,sh(f))}function _5(o,l,f,m){return m=typeof m=="function"?m:t,o==null?o:lm(o,l,sh(f),m)}function Ei(o){return o==null?[]:Lu(o,Rt(o))}function S5(o){return o==null?[]:Lu(o,lr(o))}function C5(o,l,f){return f===t&&(f=l,l=t),f!==t&&(f=Fr(f),f=f===f?f:0),l!==t&&(l=Fr(l),l=l===l?l:0),Is(Fr(o),l,f)}function T5(o,l,f){return l=On(l),f===t?(f=l,l=0):f=On(f),o=Fr(o),M2(o,l,f)}function E5(o,l,f){if(f&&typeof f!="boolean"&&Gt(o,l,f)&&(l=f=t),f===t&&(typeof l=="boolean"?(f=l,l=t):typeof o=="boolean"&&(f=o,o=t)),o===t&&l===t?(o=0,l=1):(o=On(o),l===t?(l=o,o=0):l=On(l)),o>l){var m=o;o=l,l=m}if(f||o%1||l%1){var x=Vg();return Bt(o+x*(l-o+sC("1e-"+((x+"").length-1))),l)}return Ju(o,l)}var k5=Si(function(o,l,f){return l=l.toLowerCase(),o+(f?mv(l):l)});function mv(o){return Th(He(o).toLowerCase())}function vv(o){return o=He(o),o&&o.replace(AS,vC).replace(GS,"")}function I5(o,l,f){o=He(o),l=wr(l);var m=o.length;f=f===t?m:Is(Ce(f),0,m);var x=f;return f-=l.length,f>=0&&o.slice(f,x)==l}function A5(o){return o=He(o),o&&Yp.test(o)?o.replace(Ss,yC):o}function O5(o){return o=He(o),o&&vr.test(o)?o.replace(Fe,"\\$&"):o}var M5=Si(function(o,l,f){return o+(f?"-":"")+l.toLowerCase()}),P5=Si(function(o,l,f){return o+(f?" ":"")+l.toLowerCase()}),D5=wm("toLowerCase");function R5(o,l,f){o=He(o),l=Ce(l);var m=l?mi(o):0;if(!l||m>=l)return o;var x=(l-m)/2;return cc(qa(x),f)+o+cc(Ga(x),f)}function j5(o,l,f){o=He(o),l=Ce(l);var m=l?mi(o):0;return l&&m<l?o+cc(l-m,f):o}function L5(o,l,f){o=He(o),l=Ce(l);var m=l?mi(o):0;return l&&m<l?cc(l-m,f)+o:o}function F5(o,l,f){return f||l==null?l=0:l&&(l=+l),UC(He(o).replace(cn,""),l||0)}function N5(o,l,f){return(f?Gt(o,l,f):l===t)?l=1:l=Ce(l),Qu(He(o),l)}function V5(){var o=arguments,l=He(o[0]);return o.length<3?l:l.replace(o[1],o[2])}var B5=Si(function(o,l,f){return o+(f?"_":"")+l.toLowerCase()});function z5(o,l,f){return f&&typeof f!="number"&&Gt(o,l,f)&&(l=f=t),f=f===t?re:f>>>0,f?(o=He(o),o&&(typeof l=="string"||l!=null&&!_h(l))&&(l=wr(l),!l&&gi(o))?rs(Yr(o),0,f):o.split(l,f)):[]}var W5=Si(function(o,l,f){return o+(f?" ":"")+Th(l)});function H5(o,l,f){return o=He(o),f=f==null?0:Is(Ce(f),0,o.length),l=wr(l),o.slice(f,f+l.length)==l}function U5(o,l,f){var m=C.templateSettings;f&&Gt(o,l,f)&&(l=t),o=He(o),l=wc({},l,m,km);var x=wc({},l.imports,m.imports,km),E=Rt(x),O=Lu(x,E),P,V,K=0,Z=l.interpolate||Da,Q="__p += '",oe=Nu((l.escape||Da).source+"|"+Z.source+"|"+(Z===wu?SS:Da).source+"|"+(l.evaluate||Da).source+"|$","g"),fe="//# sourceURL="+(Ye.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++QS+"]")+`
`;o.replace(oe,function(ve,Oe,je,_r,qt,Sr){return je||(je=_r),Q+=o.slice(K,Sr).replace(OS,bC),Oe&&(P=!0,Q+=`' +
__e(`+Oe+`) +
'`),qt&&(V=!0,Q+=`';
`+qt+`;
__p += '`),je&&(Q+=`' +
((__t = (`+je+`)) == null ? '' : __t) +
'`),K=Sr+ve.length,ve}),Q+=`';
`;var me=Ye.call(l,"variable")&&l.variable;if(!me)Q=`with (obj) {
`+Q+`
}
`;else if(xS.test(me))throw new xe(c);Q=(V?Q.replace(hi,""):Q).replace(di,"$1").replace(bu,"$1;"),Q="function("+(me||"obj")+`) {
`+(me?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(P?", __e = _.escape":"")+(V?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var ke=bv(function(){return Be(E,fe+"return "+Q).apply(t,O)});if(ke.source=Q,xh(ke))throw ke;return ke}function $5(o){return He(o).toLowerCase()}function Y5(o){return He(o).toUpperCase()}function X5(o,l,f){if(o=He(o),o&&(f||l===t))return Ig(o);if(!o||!(l=wr(l)))return o;var m=Yr(o),x=Yr(l),E=Ag(m,x),O=Og(m,x)+1;return rs(m,E,O).join("")}function G5(o,l,f){if(o=He(o),o&&(f||l===t))return o.slice(0,Pg(o)+1);if(!o||!(l=wr(l)))return o;var m=Yr(o),x=Og(m,Yr(l))+1;return rs(m,0,x).join("")}function q5(o,l,f){if(o=He(o),o&&(f||l===t))return o.replace(cn,"");if(!o||!(l=wr(l)))return o;var m=Yr(o),x=Ag(m,Yr(l));return rs(m,x).join("")}function K5(o,l){var f=W,m=q;if(ct(l)){var x="separator"in l?l.separator:x;f="length"in l?Ce(l.length):f,m="omission"in l?wr(l.omission):m}o=He(o);var E=o.length;if(gi(o)){var O=Yr(o);E=O.length}if(f>=E)return o;var P=f-mi(m);if(P<1)return m;var V=O?rs(O,0,P).join(""):o.slice(0,P);if(x===t)return V+m;if(O&&(P+=V.length-P),_h(x)){if(o.slice(P).search(x)){var K,Z=V;for(x.global||(x=Nu(x.source,He(Kp.exec(x))+"g")),x.lastIndex=0;K=x.exec(Z);)var Q=K.index;V=V.slice(0,Q===t?P:Q)}}else if(o.indexOf(wr(x),P)!=P){var oe=V.lastIndexOf(x);oe>-1&&(V=V.slice(0,oe))}return V+m}function Z5(o){return o=He(o),o&&Ma.test(o)?o.replace(Oa,EC):o}var J5=Si(function(o,l,f){return o+(f?" ":"")+l.toUpperCase()}),Th=wm("toUpperCase");function yv(o,l,f){return o=He(o),l=f?t:l,l===t?xC(o)?AC(o):dC(o):o.match(l)||[]}var bv=Ie(function(o,l){try{return yr(o,t,l)}catch(f){return xh(f)?f:new xe(f)}}),Q5=kn(function(o,l){return Mr(l,function(f){f=hn(f),Tn(o,f,bh(o[f],o))}),o});function eI(o){var l=o==null?0:o.length,f=ge();return o=l?nt(o,function(m){if(typeof m[1]!="function")throw new Pr(a);return[f(m[0]),m[1]]}):[],Ie(function(m){for(var x=-1;++x<l;){var E=o[x];if(yr(E[0],this,m))return yr(E[1],this,m)}})}function tI(o){return E2(Rr(o,p))}function Eh(o){return function(){return o}}function rI(o,l){return o==null||o!==o?l:o}var nI=_m(),sI=_m(!0);function ur(o){return o}function kh(o){return Jg(typeof o=="function"?o:Rr(o,p))}function iI(o){return em(Rr(o,p))}function oI(o,l){return tm(o,Rr(l,p))}var aI=Ie(function(o,l){return function(f){return _o(f,o,l)}}),cI=Ie(function(o,l){return function(f){return _o(o,f,l)}});function Ih(o,l,f){var m=Rt(l),x=tc(l,m);f==null&&!(ct(l)&&(x.length||!m.length))&&(f=l,l=o,o=this,x=tc(l,Rt(l)));var E=!(ct(f)&&"chain"in f)||!!f.chain,O=An(o);return Mr(x,function(P){var V=l[P];o[P]=V,O&&(o.prototype[P]=function(){var K=this.__chain__;if(E||K){var Z=o(this.__wrapped__),Q=Z.__actions__=ar(this.__actions__);return Q.push({func:V,args:arguments,thisArg:o}),Z.__chain__=K,Z}return V.apply(o,Kn([this.value()],arguments))})}),o}function lI(){return Lt._===this&&(Lt._=jC),this}function Ah(){}function uI(o){return o=Ce(o),Ie(function(l){return rm(l,o)})}var hI=oh(nt),dI=oh(Sg),fI=oh(Mu);function wv(o){return fh(o)?Pu(hn(o)):H2(o)}function pI(o){return function(l){return o==null?t:As(o,l)}}var gI=Cm(),mI=Cm(!0);function Oh(){return[]}function Mh(){return!1}function vI(){return{}}function yI(){return""}function bI(){return!0}function wI(o,l){if(o=Ce(o),o<1||o>ie)return[];var f=re,m=Bt(o,re);l=ge(l),o-=re;for(var x=ju(m,l);++f<o;)l(f);return x}function xI(o){return _e(o)?nt(o,hn):xr(o)?[o]:ar(Bm(He(o)))}function _I(o){var l=++DC;return He(o)+l}var SI=ac(function(o,l){return o+l},0),CI=ah("ceil"),TI=ac(function(o,l){return o/l},1),EI=ah("floor");function kI(o){return o&&o.length?ec(o,ur,Yu):t}function II(o,l){return o&&o.length?ec(o,ge(l,2),Yu):t}function AI(o){return Eg(o,ur)}function OI(o,l){return Eg(o,ge(l,2))}function MI(o){return o&&o.length?ec(o,ur,Ku):t}function PI(o,l){return o&&o.length?ec(o,ge(l,2),Ku):t}var DI=ac(function(o,l){return o*l},1),RI=ah("round"),jI=ac(function(o,l){return o-l},0);function LI(o){return o&&o.length?Ru(o,ur):0}function FI(o,l){return o&&o.length?Ru(o,ge(l,2)):0}return C.after=ik,C.ary=Zm,C.assign=Yk,C.assignIn=hv,C.assignInWith=wc,C.assignWith=Xk,C.at=Gk,C.before=Jm,C.bind=bh,C.bindAll=Q5,C.bindKey=Qm,C.castArray=vk,C.chain=Gm,C.chunk=ET,C.compact=kT,C.concat=IT,C.cond=eI,C.conforms=tI,C.constant=Eh,C.countBy=LE,C.create=qk,C.curry=ev,C.curryRight=tv,C.debounce=rv,C.defaults=Kk,C.defaultsDeep=Zk,C.defer=ok,C.delay=ak,C.difference=AT,C.differenceBy=OT,C.differenceWith=MT,C.drop=PT,C.dropRight=DT,C.dropRightWhile=RT,C.dropWhile=jT,C.fill=LT,C.filter=NE,C.flatMap=zE,C.flatMapDeep=WE,C.flatMapDepth=HE,C.flatten=Um,C.flattenDeep=FT,C.flattenDepth=NT,C.flip=ck,C.flow=nI,C.flowRight=sI,C.fromPairs=VT,C.functions=s5,C.functionsIn=i5,C.groupBy=UE,C.initial=zT,C.intersection=WT,C.intersectionBy=HT,C.intersectionWith=UT,C.invert=a5,C.invertBy=c5,C.invokeMap=YE,C.iteratee=kh,C.keyBy=XE,C.keys=Rt,C.keysIn=lr,C.map=pc,C.mapKeys=u5,C.mapValues=h5,C.matches=iI,C.matchesProperty=oI,C.memoize=mc,C.merge=d5,C.mergeWith=dv,C.method=aI,C.methodOf=cI,C.mixin=Ih,C.negate=vc,C.nthArg=uI,C.omit=f5,C.omitBy=p5,C.once=lk,C.orderBy=GE,C.over=hI,C.overArgs=uk,C.overEvery=dI,C.overSome=fI,C.partial=wh,C.partialRight=nv,C.partition=qE,C.pick=g5,C.pickBy=fv,C.property=wv,C.propertyOf=pI,C.pull=GT,C.pullAll=Ym,C.pullAllBy=qT,C.pullAllWith=KT,C.pullAt=ZT,C.range=gI,C.rangeRight=mI,C.rearg=hk,C.reject=JE,C.remove=JT,C.rest=dk,C.reverse=vh,C.sampleSize=ek,C.set=v5,C.setWith=y5,C.shuffle=tk,C.slice=QT,C.sortBy=sk,C.sortedUniq=oE,C.sortedUniqBy=aE,C.split=z5,C.spread=fk,C.tail=cE,C.take=lE,C.takeRight=uE,C.takeRightWhile=hE,C.takeWhile=dE,C.tap=kE,C.throttle=pk,C.thru=fc,C.toArray=cv,C.toPairs=pv,C.toPairsIn=gv,C.toPath=xI,C.toPlainObject=uv,C.transform=b5,C.unary=gk,C.union=fE,C.unionBy=pE,C.unionWith=gE,C.uniq=mE,C.uniqBy=vE,C.uniqWith=yE,C.unset=w5,C.unzip=yh,C.unzipWith=Xm,C.update=x5,C.updateWith=_5,C.values=Ei,C.valuesIn=S5,C.without=bE,C.words=yv,C.wrap=mk,C.xor=wE,C.xorBy=xE,C.xorWith=_E,C.zip=SE,C.zipObject=CE,C.zipObjectDeep=TE,C.zipWith=EE,C.entries=pv,C.entriesIn=gv,C.extend=hv,C.extendWith=wc,Ih(C,C),C.add=SI,C.attempt=bv,C.camelCase=k5,C.capitalize=mv,C.ceil=CI,C.clamp=C5,C.clone=yk,C.cloneDeep=wk,C.cloneDeepWith=xk,C.cloneWith=bk,C.conformsTo=_k,C.deburr=vv,C.defaultTo=rI,C.divide=TI,C.endsWith=I5,C.eq=Gr,C.escape=A5,C.escapeRegExp=O5,C.every=FE,C.find=VE,C.findIndex=Wm,C.findKey=Jk,C.findLast=BE,C.findLastIndex=Hm,C.findLastKey=Qk,C.floor=EI,C.forEach=qm,C.forEachRight=Km,C.forIn=e5,C.forInRight=t5,C.forOwn=r5,C.forOwnRight=n5,C.get=Sh,C.gt=Sk,C.gte=Ck,C.has=o5,C.hasIn=Ch,C.head=$m,C.identity=ur,C.includes=$E,C.indexOf=BT,C.inRange=T5,C.invoke=l5,C.isArguments=Ps,C.isArray=_e,C.isArrayBuffer=Tk,C.isArrayLike=cr,C.isArrayLikeObject=yt,C.isBoolean=Ek,C.isBuffer=ns,C.isDate=kk,C.isElement=Ik,C.isEmpty=Ak,C.isEqual=Ok,C.isEqualWith=Mk,C.isError=xh,C.isFinite=Pk,C.isFunction=An,C.isInteger=sv,C.isLength=yc,C.isMap=iv,C.isMatch=Dk,C.isMatchWith=Rk,C.isNaN=jk,C.isNative=Lk,C.isNil=Nk,C.isNull=Fk,C.isNumber=ov,C.isObject=ct,C.isObjectLike=ht,C.isPlainObject=Io,C.isRegExp=_h,C.isSafeInteger=Vk,C.isSet=av,C.isString=bc,C.isSymbol=xr,C.isTypedArray=Ti,C.isUndefined=Bk,C.isWeakMap=zk,C.isWeakSet=Wk,C.join=$T,C.kebabCase=M5,C.last=Lr,C.lastIndexOf=YT,C.lowerCase=P5,C.lowerFirst=D5,C.lt=Hk,C.lte=Uk,C.max=kI,C.maxBy=II,C.mean=AI,C.meanBy=OI,C.min=MI,C.minBy=PI,C.stubArray=Oh,C.stubFalse=Mh,C.stubObject=vI,C.stubString=yI,C.stubTrue=bI,C.multiply=DI,C.nth=XT,C.noConflict=lI,C.noop=Ah,C.now=gc,C.pad=R5,C.padEnd=j5,C.padStart=L5,C.parseInt=F5,C.random=E5,C.reduce=KE,C.reduceRight=ZE,C.repeat=N5,C.replace=V5,C.result=m5,C.round=RI,C.runInContext=N,C.sample=QE,C.size=rk,C.snakeCase=B5,C.some=nk,C.sortedIndex=eE,C.sortedIndexBy=tE,C.sortedIndexOf=rE,C.sortedLastIndex=nE,C.sortedLastIndexBy=sE,C.sortedLastIndexOf=iE,C.startCase=W5,C.startsWith=H5,C.subtract=jI,C.sum=LI,C.sumBy=FI,C.template=U5,C.times=wI,C.toFinite=On,C.toInteger=Ce,C.toLength=lv,C.toLower=$5,C.toNumber=Fr,C.toSafeInteger=$k,C.toString=He,C.toUpper=Y5,C.trim=X5,C.trimEnd=G5,C.trimStart=q5,C.truncate=K5,C.unescape=Z5,C.uniqueId=_I,C.upperCase=J5,C.upperFirst=Th,C.each=qm,C.eachRight=Km,C.first=$m,Ih(C,function(){var o={};return ln(C,function(l,f){Ye.call(C.prototype,f)||(o[f]=l)}),o}(),{chain:!1}),C.VERSION=n,Mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){C[o].placeholder=C}),Mr(["drop","take"],function(o,l){Pe.prototype[o]=function(f){f=f===t?1:It(Ce(f),0);var m=this.__filtered__&&!l?new Pe(this):this.clone();return m.__filtered__?m.__takeCount__=Bt(f,m.__takeCount__):m.__views__.push({size:Bt(f,re),type:o+(m.__dir__<0?"Right":"")}),m},Pe.prototype[o+"Right"]=function(f){return this.reverse()[o](f).reverse()}}),Mr(["filter","map","takeWhile"],function(o,l){var f=l+1,m=f==te||f==J;Pe.prototype[o]=function(x){var E=this.clone();return E.__iteratees__.push({iteratee:ge(x,3),type:f}),E.__filtered__=E.__filtered__||m,E}}),Mr(["head","last"],function(o,l){var f="take"+(l?"Right":"");Pe.prototype[o]=function(){return this[f](1).value()[0]}}),Mr(["initial","tail"],function(o,l){var f="drop"+(l?"":"Right");Pe.prototype[o]=function(){return this.__filtered__?new Pe(this):this[f](1)}}),Pe.prototype.compact=function(){return this.filter(ur)},Pe.prototype.find=function(o){return this.filter(o).head()},Pe.prototype.findLast=function(o){return this.reverse().find(o)},Pe.prototype.invokeMap=Ie(function(o,l){return typeof o=="function"?new Pe(this):this.map(function(f){return _o(f,o,l)})}),Pe.prototype.reject=function(o){return this.filter(vc(ge(o)))},Pe.prototype.slice=function(o,l){o=Ce(o);var f=this;return f.__filtered__&&(o>0||l<0)?new Pe(f):(o<0?f=f.takeRight(-o):o&&(f=f.drop(o)),l!==t&&(l=Ce(l),f=l<0?f.dropRight(-l):f.take(l-o)),f)},Pe.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},Pe.prototype.toArray=function(){return this.take(re)},ln(Pe.prototype,function(o,l){var f=/^(?:filter|find|map|reject)|While$/.test(l),m=/^(?:head|last)$/.test(l),x=C[m?"take"+(l=="last"?"Right":""):l],E=m||/^find/.test(l);x&&(C.prototype[l]=function(){var O=this.__wrapped__,P=m?[1]:arguments,V=O instanceof Pe,K=P[0],Z=V||_e(O),Q=function(Oe){var je=x.apply(C,Kn([Oe],P));return m&&oe?je[0]:je};Z&&f&&typeof K=="function"&&K.length!=1&&(V=Z=!1);var oe=this.__chain__,fe=!!this.__actions__.length,me=E&&!oe,ke=V&&!fe;if(!E&&Z){O=ke?O:new Pe(this);var ve=o.apply(O,P);return ve.__actions__.push({func:fc,args:[Q],thisArg:t}),new Dr(ve,oe)}return me&&ke?o.apply(this,P):(ve=this.thru(Q),me?m?ve.value()[0]:ve.value():ve)})}),Mr(["pop","push","shift","sort","splice","unshift"],function(o){var l=Va[o],f=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",m=/^(?:pop|shift)$/.test(o);C.prototype[o]=function(){var x=arguments;if(m&&!this.__chain__){var E=this.value();return l.apply(_e(E)?E:[],x)}return this[f](function(O){return l.apply(_e(O)?O:[],x)})}}),ln(Pe.prototype,function(o,l){var f=C[l];if(f){var m=f.name+"";Ye.call(wi,m)||(wi[m]=[]),wi[m].push({name:l,func:f})}}),wi[oc(t,T).name]=[{name:"wrapper",func:t}],Pe.prototype.clone=ZC,Pe.prototype.reverse=JC,Pe.prototype.value=QC,C.prototype.at=IE,C.prototype.chain=AE,C.prototype.commit=OE,C.prototype.next=ME,C.prototype.plant=DE,C.prototype.reverse=RE,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=jE,C.prototype.first=C.prototype.head,go&&(C.prototype[go]=PE),C},vi=OC();Cs?((Cs.exports=vi)._=vi,ku._=vi):Lt._=vi}).call(Ao)})(ul,ul.exports);var ze=ul.exports;const FR=()=>{const{trackItemIds:r,trackItemsMap:e,fps:t,trackItemDetailsMap:n}=bn(),s=ze.merge(e,n);return b.jsx(b.Fragment,{children:r.map(i=>{const a=s[i];return fw[a.type](a,{fps:t})})})};var pw={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var i="",a=0;a<arguments.length;a++){var c=arguments[a];c&&(i=s(i,n(c)))}return i}function n(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var c in i)e.call(i,c)&&i[c]&&(a=s(a,c));return a}function s(i,a){return a?i?i+" "+a:i+a:i}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(pw);var NR=pw.exports;const No=VI(NR),VR={asChild:{type:"boolean"}},BR={width:{type:"string",className:"rt-r-w",customProperties:["--width"],responsive:!0},minWidth:{type:"string",className:"rt-r-min-w",customProperties:["--min-width"],responsive:!0},maxWidth:{type:"string",className:"rt-r-max-w",customProperties:["--max-width"],responsive:!0}},zR={height:{type:"string",className:"rt-r-h",customProperties:["--height"],responsive:!0},minHeight:{type:"string",className:"rt-r-min-h",customProperties:["--min-height"],responsive:!0},maxHeight:{type:"string",className:"rt-r-max-h",customProperties:["--max-height"],responsive:!0}},ap=["initial","xs","sm","md","lg","xl"];function gw(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Ho(r){return typeof r=="object"&&Object.keys(r).some(e=>ap.includes(e))}function WR({className:r,customProperties:e,...t}){const n=mw({allowArbitraryValues:!0,className:r,...t}),s=HR({customProperties:e,...t});return[n,s]}function mw({allowArbitraryValues:r,value:e,className:t,propValues:n,parseValue:s=i=>i}){const i=[];if(e){if(typeof e=="string"&&n.includes(e))return g0(t,e,s);if(Ho(e)){const a=e;for(const c in a){if(!gw(a,c)||!ap.includes(c))continue;const u=a[c];if(u!==void 0){if(n.includes(u)){const h=g0(t,u,s),d=c==="initial"?h:`${c}:${h}`;i.push(d)}else if(r){const h=c==="initial"?t:`${c}:${t}`;i.push(h)}}}return i.join(" ")}if(r)return t}}function g0(r,e,t){const n=r?"-":"",s=t(e),i=s?.startsWith("-"),a=i?"-":"",c=i?s?.substring(1):s;return`${a}${r}${n}${c}`}function HR({customProperties:r,value:e,propValues:t,parseValue:n=s=>s}){let s={};if(!(!e||typeof e=="string"&&t.includes(e))){if(typeof e=="string"&&(s=Object.fromEntries(r.map(i=>[i,e]))),Ho(e)){const i=e;for(const a in i){if(!gw(i,a)||!ap.includes(a))continue;const c=i[a];if(!t.includes(c))for(const u of r)s={[a==="initial"?u:`${u}-${a}`]:c,...s}}}for(const i in s){const a=s[i];a!==void 0&&(s[i]=n(a))}return s}}function m0(...r){let e={};for(const t of r)t&&(e={...e,...t});return Object.keys(e).length?e:void 0}function UR(...r){return Object.assign({},...r)}function $R(r,...e){let t,n;const s={...r},i=UR(...e);for(const a in i){let c=s[a];const u=i[a];if(u.default!==void 0&&c===void 0&&(c=u.default),u.type==="enum"&&![u.default,...u.values].includes(c)&&!Ho(c)&&(c=u.default),s[a]=c,"className"in u&&u.className){delete s[a];const h="responsive"in u;if(!c||Ho(c)&&!h)continue;if(Ho(c)&&(u.default!==void 0&&c.initial===void 0&&(c.initial=u.default),u.type==="enum"&&([u.default,...u.values].includes(c.initial)||(c.initial=u.default))),u.type==="enum"){const d=mw({allowArbitraryValues:!1,value:c,className:u.className,propValues:u.values,parseValue:u.parseValue});t=No(t,d);continue}if(u.type==="string"||u.type==="enum | string"){const d=u.type==="string"?[]:u.values,[p,g]=WR({className:u.className,customProperties:u.customProperties,propValues:d,parseValue:u.parseValue,value:c});n=m0(n,g),t=No(t,p);continue}if(u.type==="boolean"&&c){t=No(t,u.className);continue}}}return s.className=No(t,r.className),s.style=m0(n,r.style),s}const Ds=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],YR={m:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-m",customProperties:["--m"]},mx:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-mx",customProperties:["--ml","--mr"]},my:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-my",customProperties:["--mt","--mb"]},mt:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-mt",customProperties:["--mt"]},mr:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-mr",customProperties:["--mr"]},mb:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-mb",customProperties:["--mb"]},ml:{type:"enum | string",values:Ds,responsive:!0,className:"rt-r-ml",customProperties:["--ml"]}},XR=YI,Rs=["0","1","2","3","4","5","6","7","8","9"],GR={p:{type:"enum | string",className:"rt-r-p",customProperties:["--p"],values:Rs,responsive:!0},px:{type:"enum | string",className:"rt-r-px",customProperties:["--pl","--pr"],values:Rs,responsive:!0},py:{type:"enum | string",className:"rt-r-py",customProperties:["--pt","--pb"],values:Rs,responsive:!0},pt:{type:"enum | string",className:"rt-r-pt",customProperties:["--pt"],values:Rs,responsive:!0},pr:{type:"enum | string",className:"rt-r-pr",customProperties:["--pr"],values:Rs,responsive:!0},pb:{type:"enum | string",className:"rt-r-pb",customProperties:["--pb"],values:Rs,responsive:!0},pl:{type:"enum | string",className:"rt-r-pl",customProperties:["--pl"],values:Rs,responsive:!0}},zh=["visible","hidden","clip","scroll","auto"],qR=["static","relative","absolute","fixed","sticky"],jo=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],KR=["0","1"],ZR=["0","1"],JR={...GR,...BR,...zR,position:{type:"enum",className:"rt-r-position",values:qR,responsive:!0},inset:{type:"enum | string",className:"rt-r-inset",customProperties:["--inset"],values:jo,responsive:!0},top:{type:"enum | string",className:"rt-r-top",customProperties:["--top"],values:jo,responsive:!0},right:{type:"enum | string",className:"rt-r-right",customProperties:["--right"],values:jo,responsive:!0},bottom:{type:"enum | string",className:"rt-r-bottom",customProperties:["--bottom"],values:jo,responsive:!0},left:{type:"enum | string",className:"rt-r-left",customProperties:["--left"],values:jo,responsive:!0},overflow:{type:"enum",className:"rt-r-overflow",values:zh,responsive:!0},overflowX:{type:"enum",className:"rt-r-ox",values:zh,responsive:!0},overflowY:{type:"enum",className:"rt-r-oy",values:zh,responsive:!0},flexBasis:{type:"string",className:"rt-r-fb",customProperties:["--flex-basis"],responsive:!0},flexShrink:{type:"enum | string",className:"rt-r-fs",customProperties:["--flex-shrink"],values:KR,responsive:!0},flexGrow:{type:"enum | string",className:"rt-r-fg",customProperties:["--flex-grow"],values:ZR,responsive:!0},gridArea:{type:"string",className:"rt-r-ga",customProperties:["--grid-area"],responsive:!0},gridColumn:{type:"string",className:"rt-r-gc",customProperties:["--grid-column"],responsive:!0},gridColumnStart:{type:"string",className:"rt-r-gcs",customProperties:["--grid-column-start"],responsive:!0},gridColumnEnd:{type:"string",className:"rt-r-gce",customProperties:["--grid-column-end"],responsive:!0},gridRow:{type:"string",className:"rt-r-gr",customProperties:["--grid-row"],responsive:!0},gridRowStart:{type:"string",className:"rt-r-grs",customProperties:["--grid-row-start"],responsive:!0},gridRowEnd:{type:"string",className:"rt-r-gre",customProperties:["--grid-row-end"],responsive:!0}},Wh=["0","1","2","3","4","5","6","7","8","9"],QR={gap:{type:"enum | string",className:"rt-r-gap",customProperties:["--gap"],values:Wh,responsive:!0},gapX:{type:"enum | string",className:"rt-r-cg",customProperties:["--column-gap"],values:Wh,responsive:!0},gapY:{type:"enum | string",className:"rt-r-rg",customProperties:["--row-gap"],values:Wh,responsive:!0}},e6=["div","span"],t6=["none","inline-flex","flex"],r6=["row","column","row-reverse","column-reverse"],n6=["start","center","end","baseline","stretch"],s6=["start","center","end","between"],i6=["nowrap","wrap","wrap-reverse"],o6={as:{type:"enum",values:e6,default:"div"},...VR,display:{type:"enum",className:"rt-r-display",values:t6,responsive:!0},direction:{type:"enum",className:"rt-r-fd",values:r6,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:n6,responsive:!0},justify:{type:"enum",className:"rt-r-jc",values:s6,parseValue:a6,responsive:!0},wrap:{type:"enum",className:"rt-r-fw",values:i6,responsive:!0},...QR};function a6(r){return r==="between"?"space-between":r}const cp=H.forwardRef((r,e)=>{const{className:t,asChild:n,as:s="div",...i}=$R(r,o6,JR,YR);return H.createElement(n?XR:s,{...i,ref:e,className:No("rt-Flex",t)})});cp.displayName="Flex";const vw=()=>{const r=v.useRef(null),{setPlayerRef:e,duration:t,fps:n,size:s}=bn();return v.useEffect(()=>{e(r)},[]),b.jsx(cp,{className:"size-full",children:b.jsx(OR,{ref:r,component:FR,durationInFrames:Math.round(t/1e3*n)||5*30,compositionWidth:1920,compositionHeight:1080,style:{width:"100%",height:"100%"},inputProps:{},fps:n,controls:!0})})},yw=({scrollLeft:r})=>{const e=v.useRef(null),{playerRef:t,fps:n,scale:s}=bn(),i=Fl(t??void 0),a=xt(i/n*1e3,s.zoom)-r,[c,u]=v.useState(!1),[h,d]=v.useState(0),[p,g]=v.useState(a),y=()=>{u(!1)},w=S=>{u(!0);const T="touches"in S?S.touches[0].clientX:S.clientX;d(T),g(a)},_=S=>{if(c){const k=("touches"in S?S.touches[0].clientX:S.clientX)-h,I=p+k,A=cs(I,s.zoom);t?.current?.seekTo(A*n/1e3)}};return v.useEffect(()=>{const S=T=>{T.preventDefault()};return c?(document.addEventListener("mousemove",_),document.addEventListener("mouseup",y),document.addEventListener("touchmove",_),document.addEventListener("touchend",y),document.addEventListener("dragstart",S)):(document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",y)),()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",y),document.removeEventListener("dragstart",S)}},[c,_,y]),b.jsx("div",{ref:e,role:"button",tabIndex:0,onMouseDown:S=>{w(S)},onTouchStart:S=>{w(S)},onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&w(S)},style:{position:"absolute",left:40+Ll+a,top:80,width:1,height:"calc(100% - 80px)",background:"#d4d4d8",zIndex:10,cursor:"pointer"},children:b.jsxs("div",{className:"relative h-full",children:[b.jsx("div",{className:"absolute top-0  h-full w-3 -translate-x-1/2"}),b.jsx("div",{className:"absolute top-0  h-full w-0.5 -translate-x-1/2 bg-white/50"}),b.jsx("div",{style:{borderRadius:"0 0 20px 20px"},className:"absolute h-3 -translate-x-1/2 px-1.5",children:b.jsx("svg",{height:"12",viewBox:"0 0 12 12",fill:"none",children:b.jsx("path",{fill:"currentColor",d:"M11.6585 7.04881L6.6585 11.4238C6.28148 11.7537 5.71852 11.7537 5.3415 11.4238L0.341495 7.04881C0.12448 6.85892 0 6.58459 0 6.29623V1C0 0.447715 0.447715 0 1 0H11C11.5523 0 12 0.447715 12 1V6.29623C12 6.58459 11.8755 6.85892 11.6585 7.04881Z"})})})]})})},bw=r=>{const{height:e=40,longLineSize:t=8,shortLineSize:n=6,offsetX:s=ol+Ll,textOffsetY:i=12,textFormat:a=Yy,scrollLeft:c=0,onClick:u}=r,{scale:h}=bn(),d=v.useRef(null),[p,g]=v.useState(null),[y,w]=v.useState({width:0,height:e});v.useEffect(()=>{const k=d.current;if(k){const I=k.getContext("2d");g(I),_(k,I,c)}},[]),v.useEffect(()=>{p&&_(d.current,p,c)},[p,c,h]);const _=(k,I,A)=>{if(!k||!I)return;const L=k.offsetParent.offsetWidth??k.offsetWidth,z=y.height;k.width=L,k.height=z,S(I,A,L,z),w({width:L,height:z})},S=(k,I,A,D)=>{const L=h.zoom,z=h.unit,F=h.segments;k.clearRect(0,0,A,D),k.save(),k.strokeStyle="#71717a",k.fillStyle="#71717a",k.lineWidth=1,k.font=`${By}px ${zy}`,k.textBaseline="top",k.translate(.5,0),k.beginPath();const Y=z*L*va,W=Math.floor(I/Y),U=Math.ceil((I+A)/Y)-W;for(let X=0;X<=U;++X){const te=X+W;if(te<0)continue;const de=te*Y/L,J=(de-I/L)*L;if(J<-Y||J>=A+Y)continue;const le=a(de),se=-k.measureText(le).width/2;k.fillText(le,J+se+s,i)}for(let X=0;X<=U;++X){const te=X+W;if(te<0)continue;const J=te*Y-I+s;for(let le=0;le<F;++le){const ie=J+le/F*Y;if(ie<0||ie>=A)continue;const se=le%F?n:t;se===n?k.strokeStyle="#a1a1aa":k.strokeStyle="#d4d4d8";const he=32,[re,Re]=[ie,he],[$e,Le]=[re,Re+se];k.beginPath(),k.moveTo(re,Re),k.lineTo($e,Le),k.stroke()}}k.restore()},T=k=>{const I=d.current;if(!I)return;const A=I.getBoundingClientRect(),L=k.clientX-A.left+c-ol;u?.(L)};return b.jsx("div",{className:"border-border border-t",style:{position:"relative",width:"100%",height:`${y.height}px`,backgroundColor:"transparent"},children:b.jsx("canvas",{onClick:T,ref:d,height:y.height})})},ww=()=>b.jsx(cp,{flexGrow:"1",justify:"center",width:"100%",height:"100%",className:"bg-scene py-3",children:b.jsx("div",{className:"max-w-3xl flex-1  w-full h-full flex relative",children:b.jsx(vw,{})})});function j(r,e,t){return(e=function(n){var s=function(i,a){if(typeof i!="object"||!i)return i;var c=i[Symbol.toPrimitive];if(c!==void 0){var u=c.call(i,a);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}(n,"string");return typeof s=="symbol"?s:s+""}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function v0(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function R(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?v0(Object(t),!0).forEach(function(n){j(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):v0(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function ot(r,e){if(r==null)return{};var t,n,s=function(a,c){if(a==null)return{};var u={};for(var h in a)if({}.hasOwnProperty.call(a,h)){if(c.indexOf(h)>=0)continue;u[h]=a[h]}return u}(r,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)t=i[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(r,t)&&(s[t]=r[t])}return s}function ws(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}class y0{constructor(){j(this,"browserShadowBlurConstant",1),j(this,"DPI",96),j(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),j(this,"perfLimitSizeTotal",2097152),j(this,"maxCacheSideLimit",4096),j(this,"minCacheSideLimit",256),j(this,"disableStyleCopyPaste",!1),j(this,"enableGLFiltering",!0),j(this,"textureSize",4096),j(this,"forceGLPutImageData",!1),j(this,"cachesBoundsOfCurve",!1),j(this,"fontPaths",{}),j(this,"NUM_FRACTION_DIGITS",4)}}const Ne=new class extends y0{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=R(R({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){const e=new y0,t=r?.reduce((n,s)=>(n[s]=e[s],n),{})||e;this.configure(t)}},us=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[r]("fabric",...t)};class gn extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class xw extends gn{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class c6{}class l6 extends c6{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),us("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const u6={};let b0;const wn=()=>b0||(b0={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new l6,dispose(){},copyPasteData:u6}),so=()=>wn().document,Kl=()=>wn().window,_w=()=>{var r;return Math.max((r=Ne.devicePixelRatio)!==null&&r!==void 0?r:Kl().devicePixelRatio,1)},Uo=new class{constructor(){j(this,"charWidthsCache",{}),j(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:e,fontStyle:t,fontWeight:n}=r;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){const{perfLimitSizeTotal:e}=Ne,t=Math.sqrt(e*r);return[Math.floor(t),Math.floor(e/t)]}},Vd="6.5.4";function $s(){}const hs=Math.PI/2,Un=2*Math.PI,lp=Math.PI/180,Qt=Object.freeze([1,0,0,1,0,0]),up=16,os=.4477152502,Ee="center",Ue="left",hr="top",Bd="bottom",wt="right",dr="none",hp=/\r?\n/,Sw="moving",Zl="scaling",Cw="rotating",dp="rotate",Tw="skewing",ra="resizing",Ew="modifyPoly",h6="modifyPath",hl="changed",Jl="scale",er="scaleX",kr="scaleY",io="skewX",oo="skewY",Mt="fill",fr="stroke",dl="modified",Ii="json",Hh="svg",ne=new class{constructor(){this[Ii]=new Map,this[Hh]=new Map}has(r){return this[Ii].has(r)}getClass(r){const e=this[Ii].get(r);if(!e)throw new gn("No class registered for ".concat(r));return e}setClass(r,e){e?this[Ii].set(e,r):(this[Ii].set(r.type,r),this[Ii].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[Hh].get(r)}setSVGClass(r,e){this[Hh].set(e??r.type.toLowerCase(),r)}},fl=new class extends Array{remove(r){const e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){const r=this.splice(0);return r.forEach(e=>e.abort()),r}cancelByCanvas(r){if(!r)return[];const e=this.filter(t=>{var n;return t.target===r||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===r});return e.forEach(t=>t.abort()),e}cancelByTarget(r){if(!r)return[];const e=this.filter(t=>t.target===r);return e.forEach(t=>t.abort()),e}};class d6{constructor(){j(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[s,i]=n;this.on(s,i)}),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(s=>{let[i,a]=s;n.push(this.once(i,a))}),()=>n.forEach(s=>s())}if(t){const n=this.on(e,function(){for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];t.call(this,...i),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],s=n.indexOf(t);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[s,i]=n;this._removeEventListener(s,i)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,t||{})}}const Fs=(r,e)=>{const t=r.indexOf(e);return t!==-1&&r.splice(t,1),r},rn=r=>{if(r===0)return 1;switch(Math.abs(r)/hs){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},nn=r=>{if(r===0)return 0;const e=r/hs,t=Math.sign(r);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(r)};class B{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new B(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new B(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new B(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new B(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new B(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new B(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new B(this.x/e.x,this.y/e.y)}scalarDivide(e){return new B(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new B(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new B(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new B(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new B(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fp;const n=nn(e),s=rn(e),i=this.subtract(t);return new B(i.x*s-i.y*n,i.x*n+i.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new B(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const fp=new B(0,0),Qc=r=>!!r&&Array.isArray(r._objects);function kw(r){class e extends r{constructor(){super(...arguments),j(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];const a=this._objects.push(...s);return s.forEach(c=>this._onObjectAdded(c)),a}insertAt(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];return this._objects.splice(n,0,...i),i.forEach(c=>this._onObjectAdded(c)),this._objects.length}remove(){const n=this._objects,s=[];for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return a.forEach(u=>{const h=n.indexOf(u);h!==-1&&(n.splice(h,1),s.push(u),this._onObjectRemoved(u))}),s}forEachObject(n){this.getObjects().forEach((s,i,a)=>n(s,i,a))}getObjects(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(a=>a.isType(...s))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(n,!0))}complexity(){return this._objects.reduce((n,s)=>n+=s.complexity?s.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Fs(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Fs(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==0){const a=this.findNewLowerIndex(n,i,s);return Fs(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==this._objects.length-1){const a=this.findNewUpperIndex(n,i,s);return Fs(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(Fs(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,i){let a;if(i){a=s;for(let c=s-1;c>=0;--c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=s-1;return a}findNewUpperIndex(n,s,i){let a;if(i){a=s;for(let c=s+1;c<this._objects.length;++c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=s+1;return a}collectObjects(n){let{left:s,top:i,width:a,height:c}=n,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],d=new B(s,i),p=d.add(new B(a,c));for(let g=this._objects.length-1;g>=0;g--){const y=this._objects[g];y.selectable&&y.visible&&(u&&y.intersectsWithRect(d,p)||y.isContainedWithinRect(d,p)||u&&y.containsPoint(d)||u&&y.containsPoint(p))&&h.push(y)}return h}}return e}class Iw extends d6{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function $o(r){return Kl().requestAnimationFrame(r)}function Aw(r){return Kl().cancelAnimationFrame(r)}let f6=0;const ds=()=>f6++,Wr=()=>{const r=so().createElement("canvas");if(!r||r.getContext===void 0)throw new gn("Failed to create `canvas` element");return r},Ow=()=>so().createElement("img"),sn=r=>{const e=Wr();return e.width=r.width,e.height=r.height,e},pp=(r,e,t)=>r.toDataURL("image/".concat(e),t),gt=r=>r*lp,fs=r=>r/lp,Mw=r=>r.every((e,t)=>e===Qt[t]),Ht=(r,e,t)=>new B(r).transform(e,t),Er=r=>{const e=1/(r[0]*r[3]-r[1]*r[2]),t=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:n,y:s}=new B(r[4],r[5]).transform(t,!0);return t[4]=-n,t[5]=-s,t},mt=(r,e,t)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],t?0:r[0]*e[4]+r[2]*e[5]+r[4],t?0:r[1]*e[4]+r[3]*e[5]+r[5]],Ql=(r,e)=>r.reduceRight((t,n)=>n&&t?mt(n,t,e):n||t,void 0)||Qt.concat(),Pw=r=>{let[e,t]=r;return Math.atan2(t,e)},Bi=r=>{const e=Pw(r),t=Math.pow(r[0],2)+Math.pow(r[1],2),n=Math.sqrt(t),s=(r[0]*r[3]-r[2]*r[1])/n,i=Math.atan2(r[0]*r[2]+r[1]*r[3],t);return{angle:fs(e),scaleX:n,scaleY:s,skewX:fs(i),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},ao=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function co(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=gt(r),s=rn(n),i=nn(n);return[s,i,-i,s,e?e-(s*e-i*t):0,t?t-(i*e+s*t):0]}const eu=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},Dw=r=>Math.tan(gt(r)),gp=r=>[1,0,Dw(r),1,0,0],mp=r=>[1,Dw(r),0,1,0,0],_a=r=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:a=0}=r,c=eu(n?-e:e,s?-t:t);return i&&(c=mt(c,gp(i),!0)),a&&(c=mt(c,mp(a),!0)),c},Rw=r=>{const{translateX:e=0,translateY:t=0,angle:n=0}=r;let s=ao(e,t);n&&(s=mt(s,co({angle:n})));const i=_a(r);return Mw(i)||(s=mt(s,i)),s},Yo=function(r){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,s){if(e&&e.aborted)return s(new xw("loadImage"));const i=Ow();let a;e&&(a=function(u){i.src="",s(u)},e.addEventListener("abort",a,{once:!0}));const c=function(){i.onload=i.onerror=null,a&&e?.removeEventListener("abort",a),n(i)};r?(i.onload=c,i.onerror=function(){a&&e?.removeEventListener("abort",a),s(new gn("Error loading ".concat(i.src)))},t&&(i.crossOrigin=t),i.src=r):c()})},zi=function(r){let{signal:e,reviver:t=$s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(r.map(a=>ne.getClass(a.type).fromObject(a,{signal:e}).then(c=>(t(a,c),i.push(c),c)))).then(n).catch(a=>{i.forEach(c=>{c.dispose&&c.dispose()}),s(a)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},Sa=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const i=Object.values(r).map(c=>c&&c.type&&ne.has(c.type)?zi([c],{signal:e}).then(u=>{let[h]=u;return s.push(h),h}):c),a=Object.keys(r);Promise.all(i).then(c=>c.reduce((u,h,d)=>(u[a[d]]=h,u),{})).then(t).catch(c=>{s.forEach(u=>{u.dispose&&u.dispose()}),n(c)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},oi=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in r&&(e[t]=r[t]),e),{})},vp=(r,e)=>Object.keys(r).reduce((t,n)=>(e(r[n],n,r)&&(t[n]=r[n]),t),{}),w0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Uh=(r,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+(e-r)*(2/3-t)*6:r),x0=(r,e,t,n)=>{r/=255,e/=255,t/=255;const s=Math.max(r,e,t),i=Math.min(r,e,t);let a,c;const u=(s+i)/2;if(s===i)a=c=0;else{const h=s-i;switch(c=u>.5?h/(2-s-i):h/(s+i),s){case r:a=(e-t)/h+(e<t?6:0);break;case e:a=(t-r)/h+2;break;case t:a=(r-e)/h+4}a/=6}return[Math.round(360*a),Math.round(100*c),Math.round(100*u),n]},_0=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Ec=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),S0=r=>{let[e,t,n,s=1]=r;const i=Math.round(.3*e+.59*t+.11*n);return[i,i,i,s]};class Xe{constructor(e){if(j(this,"isUnrecognised",!1),e)if(e instanceof Xe)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,s,i=1]=e;this.setSource([t,n,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in w0&&(e=w0[e]),e==="transparent"?[255,255,255,0]:Xe.sourceFromHex(e)||Xe.sourceFromRgb(e)||Xe.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=x0(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,s]=x0(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,s]=this.getSource();return"".concat(Ec(e)).concat(Ec(t)).concat(Ec(n)).concat(Ec(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(S0(this.getSource())),this}toBlackWhite(e){const[t,,,n]=S0(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof Xe||(e=new Xe(e));const t=this.getSource(),n=e.getSource(),[s,i,a]=t.map((c,u)=>Math.round(.5*c+.5*n[u]));return this.setSource([s,i,a,t[3]]),this}static fromRgb(e){return Xe.fromRgba(e)}static fromRgba(e){return new Xe(Xe.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[n,s,i]=t.slice(1,4).map(a=>{const c=parseFloat(a);return a.endsWith("%")?Math.round(2.55*c):c});return[n,s,i,_0(t[4])]}}static fromHsl(e){return Xe.fromHsla(e)}static fromHsla(e){return new Xe(Xe.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const n=(Xe.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,i=parseFloat(t[3])/100;let a,c,u;if(s===0)a=c=u=i;else{const h=i<=.5?i*(s+1):i+s-i*s,d=2*i-h;a=Uh(d,h,n+1/3),c=Uh(d,h,n),u=Uh(d,h,n-1/3)}return[Math.round(255*a),Math.round(255*c),Math.round(255*u),_0(t[4])]}static fromHex(e){return new Xe(Xe.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map(u=>u+u):t.match(/.{2}/g);const[s,i,a,c=255]=n.map(u=>parseInt(u,16));return[s,i,a,c/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?fs(n):t.includes("turn")?360*n:n}}const it=(r,e)=>parseFloat(Number(r).toFixed(e)),Ys=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:up;const t=/\D{0,2}$/.exec(r),n=parseFloat(r),s=Ne.DPI;switch(t?.[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},jw=r=>{const[e,t]=r.trim().split(" "),[n,s]=(i=e)&&i!==dr?[i.slice(1,4),i.slice(5,8)]:i===dr?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:t||"meet",alignX:n,alignY:s}},na=r=>"matrix("+r.map(e=>it(e,Ne.NUM_FRACTION_DIGITS)).join(" ")+")",sa=function(r,e){let t,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const i=new Xe(e),a=i.getAlpha();t=i.toRgb(),a!==1&&(n=a.toString())}else t="none";return s?"".concat(r,": ").concat(t,"; ").concat(n?"".concat(r,"-opacity: ").concat(n,"; "):""):"".concat(r,'="').concat(t,'" ').concat(n?"".concat(r,'-opacity="').concat(n,'" '):"")},Br=r=>!!r&&r.toLive!==void 0,C0=r=>!!r&&typeof r.toObject=="function",T0=r=>!!r&&r.offsetX!==void 0&&"source"in r,Ns=r=>!!r&&"multiSelectionStacking"in r;function Lw(r){const e=r&&Jr(r);let t=0,n=0;if(!r||!e)return{left:t,top:n};let s=r;const i=e.documentElement,a=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=a.scrollLeft||i.scrollLeft||0,n=a.scrollTop||i.scrollTop||0):(t+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:n}}const Jr=r=>r.ownerDocument||null,Fw=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},Nw=function(r,e,t){let{width:n,height:s}=t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=n,r.height=s,i>1&&(r.setAttribute("width",(n*i).toString()),r.setAttribute("height",(s*i).toString()),e.scale(i,i))},zd=(r,e)=>{let{width:t,height:n}=e;t&&(r.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(r.style.height=typeof n=="number"?"".concat(n,"px"):n)};function E0(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=dr,r}class Vw{constructor(e){j(this,"_originalCanvasStyle",void 0),j(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&so().getElementById(e)||Wr();var n;if(t.hasAttribute("data-fabric"))throw new gn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:s}=this.lower;Nw(n,s,e,t)}setCSSDimensions(e){zd(this.lower.el,e)}calcOffset(){return function(e){var t;const n=e&&Jr(e),s={left:0,top:0};if(!n)return s;const i=((t=Fw(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let a={left:0,top:0};const c=n.documentElement;e.getBoundingClientRect!==void 0&&(a=e.getBoundingClientRect());const u=Lw(e);return{left:a.left+u.left-(c.clientLeft||0)+s.left,top:a.top+u.top-(c.clientTop||0)+s.top}}(this.lower.el)}dispose(){wn().dispose(this.lower.el),delete this.lower}}const p6={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Qt]};class Ca extends kw(Iw){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Ca.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new Vw(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(us("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?_w():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=R({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,s=[...this.viewportTransform],i=Ht(e,Er(s));s[0]=t,s[3]=t;const a=Ht(i,s);s[4]+=n.x-a.x,s[5]+=n.y-a.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new B(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new B(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=$o(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,n=Er(this.viewportTransform),s=Ht({x:0,y:0},n),i=Ht({x:e,y:t},n),a=s.min(i),c=s.max(i);return this.vptCoords={tl:a,tr:new B(c.x,a.y),bl:new B(a.x,c.y),br:c}}cancelRequestedRender(){this.nextRenderHandle&&(Aw(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,s=t.length;n<s;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],s=this["".concat(t,"Image")],i=this.viewportTransform,a=this["".concat(t,"Vpt")];if(!n&&!s)return;const c=Br(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=c?n.toLive(e):n,a&&e.transform(...i),c){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const u=n.gradientTransform||n.patternTransform;u&&e.transform(...u)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:u}=this;this.skipOffscreen=a,a&&e.transform(...i),s.render(e),this.skipOffscreen=u,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new B(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new B(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new B(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new B(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new B(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Ht(this.getCenterPoint(),Er(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Ee,Ee),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return R(R(R({version:Vd},oi(this,t)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,t))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,t){const n={},s=this.backgroundImage,i=this.overlayImage,a=this.backgroundColor,c=this.overlayColor;return Br(a)?a.excludeFromExport||(n.background=a.toObject(t)):a&&(n.background=a),Br(c)?c.excludeFromExport||(n.overlay=c.toObject(t)):c&&(n.overlay=c),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,t)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),s=t.height||"".concat(this.height),i=Ne.NUM_FRACTION_DIGITS,a=t.viewBox;let c;if(a)c='viewBox="'.concat(a.x," ").concat(a.y," ").concat(a.width," ").concat(a.height,'" ');else if(this.svgViewportTransformation){const u=this.viewportTransform;c='viewBox="'.concat(it(-u[4]/u[0],i)," ").concat(it(-u[5]/u[3],i)," ").concat(it(this.width/u[0],i)," ").concat(it(this.height/u[3],i),'" ')}else c='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',c,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Vd,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(ds()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Br(t)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return t.toSVG(i,{additionalTransform:n?na(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=Ne.fontPaths;this._objects.forEach(function i(a){e.push(a),Qc(a)&&a._objects.forEach(i)}),e.forEach(i=>{if(!(a=i)||typeof a._renderText!="function")return;var a;const{styles:c,fontFamily:u}=i;!t[u]&&n[u]&&(t[u]=!0,c&&Object.values(c).forEach(h=>{Object.values(h).forEach(d=>{let{fontFamily:p=""}=d;!t[p]&&n[p]&&(t[p]=!0)})}))});const s=Object.keys(t).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(n[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(Br(n)){const s=n.repeat||"",i=this.width,a=this.height,c=this["".concat(t,"Vpt")]?na(Er(this.viewportTransform)):"";e.push('<rect transform="'.concat(c," translate(").concat(i/2,",").concat(a/2,')" x="').concat(n.offsetX-i/2,'" y="').concat(n.offsetY-a/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!T0(n)?i:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!T0(n)?a:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new gn("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:a,background:c,overlayImage:u,overlay:h,clipPath:d}=s,p=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([zi(i,{reviver:t,signal:n}),Sa({backgroundImage:a,backgroundColor:c,overlayImage:u,overlayColor:h,clipPath:d},{signal:n})]).then(g=>{let[y,w]=g;return this.clear(),this.add(...y),this.set(s),this.set(w),this.renderOnAddRemove=p,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=sn(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,a=s*(i?this.getRetinaScaling():1);return pp(this.toCanvasElement(a,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:s,top:i,filter:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=(t||this.width)*e,u=(n||this.height)*e,h=this.getZoom(),d=this.width,p=this.height,g=this.skipControlsDrawing,y=h*e,w=this.viewportTransform,_=[y,0,0,y,(w[4]-(s||0))*e,(w[5]-(i||0))*e],S=this.enableRetinaScaling,T=sn({width:c,height:u}),k=a?this._objects.filter(I=>a(I)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=_,this.width=c,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(T.getContext("2d"),k),this.viewportTransform=w,this.width=d,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=S,this.skipControlsDrawing=g,T}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),fl.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}j(Ca,"ownDefaults",p6);const g6=["touchstart","touchmove","touchend"],Bw=r=>{const e=Lw(r.target),t=function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n}(r);return new B(t.clientX+e.left,t.clientY+e.top)},pl=r=>g6.includes(r.type)||r.pointerType==="touch",Wd=r=>{r.preventDefault(),r.stopPropagation()},yn=r=>{let e=0,t=0,n=0,s=0;for(let i=0,a=r.length;i<a;i++){const{x:c,y:u}=r[i];(c>n||!i)&&(n=c),(c<e||!i)&&(e=c),(u>s||!i)&&(s=u),(u<t||!i)&&(t=u)}return{left:e,top:t,width:n-e,height:s-t}},m6=["translateX","translateY","scaleX","scaleY"],zw=(r,e)=>Wi(r,mt(e,r.calcOwnMatrix())),Wi=(r,e)=>{const t=Bi(e),{translateX:n,translateY:s,scaleX:i,scaleY:a}=t,c=ot(t,m6),u=new B(n,s);r.flipX=!1,r.flipY=!1,Object.assign(r,c),r.set({scaleX:i,scaleY:a}),r.setPositionByOrigin(u,Ee,Ee)},Ww=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},yp=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),tu=(r,e,t)=>{const n=r/2,s=e/2,i=[new B(-n,-s),new B(n,-s),new B(-n,s),new B(n,s)].map(c=>c.transform(t)),a=yn(i);return new B(a.width,a.height)},Ta=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Qt;return mt(Er(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt),r)},Bn=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qt;return r.transform(Ta(e,t))},Hw=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qt;return r.transform(Ta(e,t),!0)},Hd=(r,e,t)=>{const n=Ta(e,t);return Wi(r,mt(n,r.calcOwnMatrix())),n},bp=(r,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(r),R(R({},e),{},{target:n})),n.fire(r,e)},v6={left:-.5,top:-.5,center:0,bottom:.5,right:.5},_t=r=>typeof r=="string"?v6[r]:r-.5,gl="not-allowed";function Uw(r){return _t(r.originX)===_t(Ee)&&_t(r.originY)===_t(Ee)}function k0(r){return .5-_t(r)}const Qr=(r,e)=>r[e],wp=(r,e,t,n)=>({e:r,transform:e,pointer:new B(t,n)});function $w(r,e){const t=r.getTotalAngle()+fs(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function ru(r,e,t,n,s){var i;let{target:a,corner:c}=r;const u=a.controls[c],h=((i=a.canvas)===null||i===void 0?void 0:i.getZoom())||1,d=a.padding/h,p=function(g,y,w,_){const S=g.getRelativeCenterPoint(),T=w!==void 0&&_!==void 0?g.translateToGivenOrigin(S,Ee,Ee,w,_):new B(g.left,g.top);return(g.angle?y.rotate(-gt(g.angle),S):y).subtract(T)}(a,new B(n,s),e,t);return p.x>=d&&(p.x-=d),p.x<=-d&&(p.x+=d),p.y>=d&&(p.y-=d),p.y<=d&&(p.y+=d),p.x-=u.offsetX,p.y-=u.offsetY,p}const Yw=(r,e,t,n)=>{const{target:s,offsetX:i,offsetY:a}=e,c=t-i,u=n-a,h=!Qr(s,"lockMovementX")&&s.left!==c,d=!Qr(s,"lockMovementY")&&s.top!==u;return h&&s.set(Ue,c),d&&s.set(hr,u),(h||d)&&bp(Sw,wp(r,e,t,n)),h||d};class Xw{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):dr,i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",p=e?"":this.getSvgFilter(),g=sa(Mt,this.fill);return[sa(fr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",t,"; ","opacity: ",h,";",p,d].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(na(n));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=t?"":'style="'.concat(this.getSvgStyles(),'" '),c=s?'style="'.concat(this.getSvgFilter(),'" '):"",u=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,p=this.stroke,g=this.fill,y=this.shadow,w=[],_=e.indexOf("COMMON_PARTS");let S;u&&(u.clipPathId="CLIPPATH_".concat(ds()),S='<clipPath id="'.concat(u.clipPathId,`" >
`).concat(u.toClipPathSVG(n),`</clipPath>
`)),d&&w.push("<g ",c,this.getSvgCommons(),` >
`),w.push("<g ",this.getSvgTransform(!1),d?"":c+this.getSvgCommons(),` >
`);const T=[a,h,t?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[_]=T,Br(g)&&w.push(g.toSVG(this)),Br(p)&&w.push(p.toSVG(this)),y&&w.push(y.toSVG(this)),u&&w.push(S),w.push(e.join("")),w.push(`</g>
`),d&&w.push(`</g>
`),n?n(w.join("")):w.join("")}addPaintOrder(){return this.paintFirst!==Mt?' paint-order="'.concat(this.paintFirst,'" '):""}}function nu(r){return new RegExp("^("+r.join("|")+")\\b","i")}var I0;const Xs=String.raw(I0||(I0=ws(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),y6=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Xs+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Xs+"))?\\s+(.*)"),b6={cx:Ue,x:Ue,r:"radius",cy:hr,y:hr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},$h="font-size",Yh="clip-path";nu(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);nu(["symbol","image","marker","pattern","view","svg"]);const A0=nu(["symbol","g","a","svg","clipPath","defs"]),w6=new B(1,0),Gw=new B,xp=(r,e)=>r.rotate(e),ml=(r,e)=>new B(e).subtract(r),vl=r=>r.distanceFrom(Gw),yl=(r,e)=>Math.atan2(Li(r,e),Kw(r,e)),qw=r=>yl(w6,r),su=r=>r.eq(Gw)?r:r.scalarDivide(vl(r)),_p=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return su(new B(-r.y,r.x).scalarMultiply(e?1:-1))},Li=(r,e)=>r.x*e.y-r.y*e.x,Kw=(r,e)=>r.x*e.x+r.y*e.y,Ud=(r,e,t)=>{if(r.eq(e)||r.eq(t))return!0;const n=Li(e,t),s=Li(e,r),i=Li(t,r);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},O0="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",M0=new RegExp("(?:\\s|^)"+O0+O0+"("+Xs+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class zn{constructor(e){const t=typeof e=="string"?zn.parseShadow(e):e;Object.assign(this,zn.ownDefaults,t),this.id=ds()}static parseShadow(e){const t=e.trim(),[,n=0,s=0,i=0]=(M0.exec(t)||[]).map(a=>parseFloat(a)||0);return{color:(t.replace(M0,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=xp(new B(this.offsetX,this.offsetY),gt(-e.angle)),n=new Xe(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*it((Math.abs(t.x)+this.blur)/e.width,Ne.NUM_FRACTION_DIGITS)+20,i=100*it((Math.abs(t.y)+this.blur)/e.height,Ne.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(it(this.blur?this.blur/2:0,Ne.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(it(t.x,Ne.NUM_FRACTION_DIGITS),'" dy="').concat(it(t.y,Ne.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=zn.ownDefaults;return this.includeDefaultValues?e:vp(e,(n,s)=>n!==t[s])}static async fromObject(e){return new this(e)}}j(zn,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),j(zn,"type","shadow"),ne.setClass(zn,"shadow");const Gs=(r,e,t)=>Math.max(r,Math.min(e,t)),x6=[hr,Ue,er,kr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",io,oo],Yn=[Mt,fr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],_6={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Ue,originY:hr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Mt,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Xh=(r,e,t,n)=>(r<Math.abs(e)?(r=e,n=t/4):n=e===0&&r===0?t/Un*Math.asin(1):t/Un*Math.asin(e/r),{a:r,c:e,p:t,s:n}),P0=(r,e,t,n,s)=>r*Math.pow(2,10*(n-=1))*Math.sin((n*s-e)*Un/t),Zw=(r,e,t,n)=>-t*Math.cos(r/n*hs)+t+e,$d=(r,e,t,n)=>(r/=n)<1/2.75?t*(7.5625*r*r)+e:r<2/2.75?t*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?t*(7.5625*(r-=2.25/2.75)*r+.9375)+e:t*(7.5625*(r-=2.625/2.75)*r+.984375)+e,D0=(r,e,t,n)=>t-$d(n-r,0,t,n)+e;var S6=Object.freeze({__proto__:null,defaultEasing:Zw,easeInBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(r/=n)*r*((s+1)*r-s)+e},easeInBounce:D0,easeInCirc:(r,e,t,n)=>-t*(Math.sqrt(1-(r/=n)*r)-1)+e,easeInCubic:(r,e,t,n)=>t*(r/n)**3+e,easeInElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n)===1)return e+t;i||(i=.3*n);const{a,s:c,p:u}=Xh(s,t,i,1.70158);return-P0(a,c,u,r,n)+e},easeInExpo:(r,e,t,n)=>r===0?e:t*2**(10*(r/n-1))+e,easeInOutBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=n/2)<1?t/2*(r*r*((1+(s*=1.525))*r-s))+e:t/2*((r-=2)*r*((1+(s*=1.525))*r+s)+2)+e},easeInOutBounce:(r,e,t,n)=>r<n/2?.5*D0(2*r,0,t,n)+e:.5*$d(2*r-n,0,t,n)+.5*t+e,easeInOutCirc:(r,e,t,n)=>(r/=n/2)<1?-t/2*(Math.sqrt(1-r**2)-1)+e:t/2*(Math.sqrt(1-(r-=2)*r)+1)+e,easeInOutCubic:(r,e,t,n)=>(r/=n/2)<1?t/2*r**3+e:t/2*((r-2)**3+2)+e,easeInOutElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n/2)===2)return e+t;i||(i=n*(.3*1.5));const{a,s:c,p:u,c:h}=Xh(s,t,i,1.70158);return r<1?-.5*P0(a,c,u,r,n)+e:a*Math.pow(2,-10*(r-=1))*Math.sin((r*n-c)*Un/u)*.5+h+e},easeInOutExpo:(r,e,t,n)=>r===0?e:r===n?e+t:(r/=n/2)<1?t/2*2**(10*(r-1))+e:t/2*-(2**(-10*--r)+2)+e,easeInOutQuad:(r,e,t,n)=>(r/=n/2)<1?t/2*r**2+e:-t/2*(--r*(r-2)-1)+e,easeInOutQuart:(r,e,t,n)=>(r/=n/2)<1?t/2*r**4+e:-t/2*((r-=2)*r**3-2)+e,easeInOutQuint:(r,e,t,n)=>(r/=n/2)<1?t/2*r**5+e:t/2*((r-2)**5+2)+e,easeInOutSine:(r,e,t,n)=>-t/2*(Math.cos(Math.PI*r/n)-1)+e,easeInQuad:(r,e,t,n)=>t*(r/=n)*r+e,easeInQuart:(r,e,t,n)=>t*(r/=n)*r**3+e,easeInQuint:(r,e,t,n)=>t*(r/n)**5+e,easeInSine:(r,e,t,n)=>-t*Math.cos(r/n*hs)+t+e,easeOutBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((r=r/n-1)*r*((s+1)*r+s)+1)+e},easeOutBounce:$d,easeOutCirc:(r,e,t,n)=>t*Math.sqrt(1-(r=r/n-1)*r)+e,easeOutCubic:(r,e,t,n)=>t*((r/n-1)**3+1)+e,easeOutElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n)===1)return e+t;i||(i=.3*n);const{a,s:c,p:u,c:h}=Xh(s,t,i,1.70158);return a*2**(-10*r)*Math.sin((r*n-c)*Un/u)+h+e},easeOutExpo:(r,e,t,n)=>r===n?e+t:t*-(2**(-10*r/n)+1)+e,easeOutQuad:(r,e,t,n)=>-t*(r/=n)*(r-2)+e,easeOutQuart:(r,e,t,n)=>-t*((r=r/n-1)*r**3-1)+e,easeOutQuint:(r,e,t,n)=>t*((r/n-1)**5+1)+e,easeOutSine:(r,e,t,n)=>t*Math.sin(r/n*hs)+e});const C6=()=>!1;class Sp{constructor(e){let{startValue:t,byValue:n,duration:s=500,delay:i=0,easing:a=Zw,onStart:c=$s,onChange:u=$s,onComplete:h=$s,abort:d=C6,target:p}=e;j(this,"_state","pending"),j(this,"durationProgress",0),j(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=a,this._onStart=c,this._onChange=u,this._onComplete=h,this._abort=d,this.target=p,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>$o(e),this.delay):$o(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:i}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),$o(this.tick)))}register(){fl.push(this)}unregister(){fl.remove(this)}abort(){this._state="aborted",this.unregister()}}const T6=["startValue","endValue"];class E6 extends Sp{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(R(R({},ot(e,T6)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const k6=["startValue","endValue"];class I6 extends Sp{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(R(R({},ot(e,k6)),{},{startValue:t,byValue:n.map((s,i)=>s-t[i])}))}calculate(e){const t=this.startValue.map((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const A6=["startValue","endValue","easing","onChange","onComplete","abort"],O6=(r,e,t,n)=>e+t*(1-Math.cos(r/n*hs)),Gh=r=>r&&((e,t,n)=>r(new Xe(e).toRgba(),t,n));class M6 extends Sp{constructor(e){let{startValue:t,endValue:n,easing:s=O6,onChange:i,onComplete:a,abort:c}=e,u=ot(e,A6);const h=new Xe(t).getSource(),d=new Xe(n).getSource();super(R(R({},u),{},{startValue:h,byValue:d.map((p,g)=>p-h[g]),easing:s,onChange:Gh(i),onComplete:Gh(a),abort:Gh(c)}))}calculate(e){const[t,n,s,i]=this.startValue.map((c,u)=>this.easing(e,c,this.byValue[u],this.duration,u)),a=[...[t,n,s].map(Math.round),Gs(0,i,1)];return{value:a,valueProgress:a.map((c,u)=>this.byValue[u]!==0?Math.abs((c-this.startValue[u])/this.byValue[u]):0).find(c=>c!==0)||0}}}function Cp(r){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(r)?new I6(r):new E6(r);return e.start(),e}function Jw(r){const e=new M6(r);return e.start(),e}class lt{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(s=>!this.includes(s))),this}static isPointContained(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const i=ml(t,n),a=ml(t,e).divide(i);return s?Math.abs(a.x)===Math.abs(a.y):a.x===a.y&&a.x>=0&&a.x<=1}}static isPointInPolygon(e,t){const n=new B(e).setX(Math.min(e.x-1,...t.map(i=>i.x)));let s=0;for(let i=0;i<t.length;i++){const a=this.intersectSegmentSegment(t[i],t[(i+1)%t.length],e,n);if(a.includes(e))return!0;s+=+(a.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,n,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],a=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const c=t.x-e.x,u=t.y-e.y,h=s.x-n.x,d=s.y-n.y,p=e.x-n.x,g=e.y-n.y,y=h*g-d*p,w=c*g-u*p,_=d*c-h*u;if(_!==0){const S=y/_,T=w/_;return(i||0<=S&&S<=1)&&(a||0<=T&&T<=1)?new lt("Intersection").append(new B(e.x+S*c,e.y+S*u)):new lt}if(y===0||w===0){const S=i||a||lt.isPointContained(e,n,s)||lt.isPointContained(t,n,s)||lt.isPointContained(n,e,t)||lt.isPointContained(s,e,t);return new lt(S?"Coincident":void 0)}return new lt("Parallel")}static intersectSegmentLine(e,t,n,s){return lt.intersectLineLine(e,t,n,s,!1,!0)}static intersectSegmentSegment(e,t,n,s){return lt.intersectLineLine(e,t,n,s,!1,!1)}static intersectLinePolygon(e,t,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new lt,a=n.length;for(let c,u,h,d=0;d<a;d++){if(c=n[d],u=n[(d+1)%a],h=lt.intersectLineLine(e,t,c,u,s,!1),h.status==="Coincident")return h;i.append(...h.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,t,n){return lt.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new lt,s=e.length,i=[];for(let a=0;a<s;a++){const c=e[a],u=e[(a+1)%s],h=lt.intersectSegmentPolygon(c,u,t);h.status==="Coincident"?(i.push(h),n.append(c,u)):n.append(...h.points)}return i.length>0&&i.length===e.length?new lt("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const s=t.min(n),i=t.max(n),a=new B(i.x,s.y),c=new B(s.x,i.y);return lt.intersectPolygonPolygon(e,[s,a,i,c])}}class P6 extends Iw{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Ht(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=Ht(e,Er(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new B(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,t,n,s];if(this.group){const a=this.group.calcTransformMatrix();return i.map(c=>Ht(c,a))}return i}intersectsWithRect(e,t){return lt.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=lt.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:n,top:s,width:i,height:a}=this.getBoundingRect();return n>=e.x&&n+i<=t.x&&s>=e.y&&s+a<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return lt.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return yn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(er,e),this._set(kr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?fs(Pw(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Qt.concat()}calcACoords(){const e=co({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),s=ao(t,n),i=mt(s,e),a=this._getTransformedDimensions(),c=a.x/2,u=a.y/2;return{tl:Ht({x:-c,y:-u},i),tr:Ht({x:c,y:-u},i),bl:Ht({x:-c,y:u},i),br:Ht({x:c,y:u},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,_t(this.originX),_t(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,a)=>i===n[a])?s.value:(this.group&&(t=mt(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=Rw(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new B(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=R({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let s=n,i=0;this.strokeUniform&&(s=0,i=n);const a=t.width+s,c=t.height+s;let u;return u=t.skewX===0&&t.skewY===0?new B(a*t.scaleX,c*t.scaleY):tu(a,c,_a(t)),u.scalarAdd(i)}translateToGivenOrigin(e,t,n,s,i){let a=e.x,c=e.y;const u=_t(s)-_t(t),h=_t(i)-_t(n);if(u||h){const d=this._getTransformedDimensions();a+=u*d.x,c+=h*d.y}return new B(a,c)}translateToCenterPoint(e,t,n){if(t===Ee&&n===Ee)return e;const s=this.translateToGivenOrigin(e,t,n,Ee,Ee);return this.angle?s.rotate(gt(this.angle),e):s}translateToOriginPoint(e,t,n){const s=this.translateToGivenOrigin(e,Ee,Ee,t,n);return this.angle?s.rotate(gt(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Ht(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new B(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const s=this.translateToCenterPoint(e,t,n),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Ue,hr)}}const D6=["type"],R6=["extraParam"];let Dn=class el extends P6{static getDefaults(){return el.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){us("warn","Setting type has no effect",e)}constructor(e){super(),j(this,"_cacheContext",null),Object.assign(this,el.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Wr(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,s=Ne.maxCacheSideLimit,i=Ne.minCacheSideLimit;if(t<=s&&n<=s&&t*n<=Ne.perfLimitSizeTotal)return t<i&&(e.width=i),n<i&&(e.height=i),e;const a=t/n,[c,u]=Uo.limitDimsByArea(a),h=Gs(i,c,s),d=Gs(i,u,s);return t>h&&(e.zoomX/=t/h,e.width=h,e.capped=!0),n>d&&(e.zoomY/=n/d,e.height=d,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:s,zoomX:i,zoomY:a,x:c,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=n!==e.width||s!==e.height,d=this.zoomX!==i||this.zoomY!==a;if(!e||!t)return!1;if(h||d){n!==e.width||s!==e.height?(e.width=n,e.height=s):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const p=c/2,g=u/2;return this.cacheTranslationX=Math.round(e.width/2-p)+p,this.cacheTranslationY=Math.round(e.height/2-g)+g,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(i,a),this.zoomX=i,this.zoomY=a,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new B(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Bi(this.calcTransformMatrix());return new B(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==er&&e!==kr||(t=this._constrainScale(t)),e===er&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof zn||(t=new zn(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i}=this,{width:a,height:c}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i,width:a,height:c,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===fr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const s=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=i}createClipPathLayer(e,t){const n=sn(t),s=n.getContext("2d");if(s.translate(t.cacheTranslationX,t.cacheTranslationY),s.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach(i=>{i.transform(s)}),t.parentClipPaths.push(e),e.absolutePositioned){const i=Er(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const s=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Br(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(Br(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,a]=n?.viewportTransform||Qt,c=i*s,u=a*s,h=t.nonScaling?new B(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Ne.browserShadowBlurConstant*(c+u)*(h.x+h.y)/4,e.shadowOffsetX=t.offsetX*c*h.x,e.shadowOffsetY=t.offsetY*u*h.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Br(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,i=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===fr?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),a=s.x/this.scaleX/i,c=s.y/this.scaleY/i,u=sn({width:Math.ceil(a),height:Math.ceil(c)}),h=u.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(a,0),h.lineTo(a,c),h.lineTo(0,c),h.closePath(),h.translate(a/2,c/2),h.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(h,t),h.fillStyle=t.toLive(e),h.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(n=h.createPattern(u,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new B(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(ne.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=yp(this),n=this.group,s=this.shadow,i=Math.abs,a=e.enableRetinaScaling?_w():1,c=(e.multiplier||1)*a,u=e.canvasProvider||(k=>new Ca(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&Ww(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&Hd(this,this.getViewportTransform()),this.setCoords();const h=Wr(),d=this.getBoundingRect(),p=this.shadow,g=new B;if(p){const k=p.blur,I=p.nonScaling?new B(1,1):this.getObjectScaling();g.x=2*Math.round(i(p.offsetX)+k)*i(I.x),g.y=2*Math.round(i(p.offsetY)+k)*i(I.y)}const y=d.width+g.x,w=d.height+g.y;h.width=Math.ceil(y),h.height=Math.ceil(w);const _=u(h);e.format==="jpeg"&&(_.backgroundColor="#fff"),this.setPositionByOrigin(new B(_.width/2,_.height/2),Ee,Ee);const S=this.canvas;_._objects=[this],this.set("canvas",_),this.setCoords();const T=_.toCanvasElement(c||1,e);return this.set("canvas",S),this.shadow=s,n&&(this.group=n),this.set(t),this.setCoords(),_._objects=[],_.destroy(),T}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return pp(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:s}=this;if(t){const{x:i,y:a}=this.getRelativeCenterPoint();this.originX=Ee,this.originY=Ee,this.left=i,this.top=a}if(this.set("angle",e),t){const{x:i,y:a}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=i,this.top=a,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){fl.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&wn().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((n,s)=>{let[i,a]=s;return n[i]=this._animate(i,a,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:a,startValue:c,onChange:u,onComplete:h}=n,d=R(R({},n),{},{target:this,startValue:c??s.reduce((p,g)=>p[g],this),endValue:t,abort:a?.bind(this),onChange:(p,g,y)=>{s.reduce((w,_,S)=>(S===s.length-1&&(w[_]=p),w[_]),this),u&&u(p,g,y)},onComplete:(p,g,y)=>{this.setCoords(),h&&h(p,g,y)}});return i?Jw(d):Cp(d)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,i=0;i<t.length;i++){if(s=t[i],s===e)return{fork:[this,...t.slice(0,i)],otherFork:[],common:t.slice(i)};for(let a=0;a<n.length;a++){if(this===n[a])return{fork:[],otherFork:[e,...n.slice(0,a)],common:[this,...t]};if(s===n[a])return{fork:[this,...t.slice(0,i)],otherFork:[e,...n.slice(0,a)],common:t.slice(i)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const s=t.fork.pop(),i=t.otherFork.pop(),a=n._objects.indexOf(s),c=n._objects.indexOf(i);return a>-1&&a>c}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(el.customProperties,this.constructor.customProperties||[]);let t;const n=Ne.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:a,shadow:c,strokeDashArray:u,left:h,top:d,originX:p,originY:g,width:y,height:w,strokeWidth:_,strokeLineCap:S,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:A,scaleX:D,scaleY:L,angle:z,flipX:F,flipY:Y,opacity:W,visible:q,backgroundColor:U,fillRule:X,paintFirst:te,globalCompositeOperation:de,skewX:J,skewY:le}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const ie=he=>it(he,n),se=R(R({},oi(this,e)),{},{type:this.constructor.type,version:Vd,originX:p,originY:g,left:ie(h),top:ie(d),width:ie(y),height:ie(w),fill:C0(i)?i.toObject():i,stroke:C0(a)?a.toObject():a,strokeWidth:ie(_),strokeDashArray:u&&u.concat(),strokeLineCap:S,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:ie(A),scaleX:ie(D),scaleY:ie(L),angle:ie(z),flipX:F,flipY:Y,opacity:ie(W),shadow:c&&c.toObject(),visible:q,backgroundColor:U,fillRule:X,paintFirst:te,globalCompositeOperation:de,skewX:ie(J),skewY:ie(le)},t?{clipPath:t}:null);return this.includeDefaultValues?se:this._removeDefaultValues(se)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return vp(e,(s,i)=>{if(i===Ue||i===hr||i==="type")return!0;const a=n[i];return s!==a&&!(Array.isArray(s)&&Array.isArray(a)&&s.length===0&&a.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=ot(e,D6),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,i=ot(n,R6);return Sa(t,i).then(a=>s?(delete a[s],new this(t[s],a)):new this(a))}static fromObject(e,t){return this._fromObject(e,t)}};j(Dn,"stateProperties",x6),j(Dn,"cacheProperties",Yn),j(Dn,"ownDefaults",_6),j(Dn,"type","FabricObject"),j(Dn,"colorProperties",[Mt,fr,"backgroundColor"]),j(Dn,"customProperties",[]),ne.setClass(Dn),ne.setClass(Dn,"object");const xs=(r,e,t)=>(n,s,i,a)=>{const c=e(n,s,i,a);return c&&bp(r,R(R({},wp(n,s,i,a)),t)),c};function ai(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,t.originX,t.originY),d}}const Yd=xs(ra,ai((r,e,t,n)=>{const s=ru(e,e.originX,e.originY,t,n);if(_t(e.originX)===_t(Ee)||_t(e.originX)===_t(wt)&&s.x<0||_t(e.originX)===_t(Ue)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=Uw(e)?2:1,u=i.width,h=Math.abs(s.x*c/i.scaleX)-a;return i.set("width",Math.max(h,1)),u!==i.width}return!1}));function Qw(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,u=c?fr:Mt,h=!c&&(n.cornerStrokeColor||s.cornerStrokeColor);let d,p=e,g=t;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i>a?(d=i,r.scale(1,a/i),g=t*i/a):a>i?(d=a,r.scale(i/a,1),p=e*a/i):d=i,r.beginPath(),r.arc(p,g,d/2,0,Un,!1),r[u](),h&&r.stroke(),r.restore()}function ex(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,u=c?fr:Mt,h=!c&&(n.cornerStrokeColor||s.cornerStrokeColor),d=i/2,p=a/2;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",r.translate(e,t);const g=s.getTotalAngle();r.rotate(gt(g)),r["".concat(u,"Rect")](-d,-p,i,a),h&&r.strokeRect(-d,-p,i,a),r.restore()}class ut{constructor(e){j(this,"visible",!0),j(this,"actionName",Jl),j(this,"angle",0),j(this,"x",0),j(this,"y",0),j(this,"offsetX",0),j(this,"offsetY",0),j(this,"sizeX",0),j(this,"sizeY",0),j(this,"touchSizeX",0),j(this,"touchSizeY",0),j(this,"cursorStyle","crosshair"),j(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,s){var i;let{tl:a,tr:c,br:u,bl:h}=s;return((i=t.canvas)===null||i===void 0?void 0:i.getActiveObject())===t&&t.isControlVisible(e)&&lt.isPointInPolygon(n,[a,c,u,h])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,s){return new B(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,s,i,a){const c=Ql([ao(n,s),co({angle:e}),eu((i?this.touchSizeX:this.sizeX)||t,(i?this.touchSizeY:this.sizeY)||t)]);return{tl:new B(-.5,-.5).transform(c),tr:new B(.5,-.5).transform(c),br:new B(.5,.5).transform(c),bl:new B(-.5,.5).transform(c)}}render(e,t,n,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?Qw.call(this,e,t,n,s,i):ex.call(this,e,t,n,s,i)}}const tx=(r,e,t)=>t.lockRotation?gl:e.cursorStyle,rx=xs(Cw,ai((r,e,t,n)=>{let{target:s,ex:i,ey:a,theta:c,originX:u,originY:h}=e;const d=s.translateToOriginPoint(s.getRelativeCenterPoint(),u,h);if(Qr(s,"lockRotation"))return!1;const p=Math.atan2(a-d.y,i-d.x),g=Math.atan2(n-d.y,t-d.x);let y=fs(g-p+c);if(s.snapAngle&&s.snapAngle>0){const _=s.snapAngle,S=s.snapThreshold||_,T=Math.ceil(y/_)*_,k=Math.floor(y/_)*_;Math.abs(y-k)<S?y=k:Math.abs(y-T)<S&&(y=T)}y<0&&(y=360+y),y%=360;const w=s.angle!==y;return s.angle=y,w}));function nx(r,e){const t=e.canvas,n=r[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function sx(r,e,t){const n=Qr(r,"lockScalingX"),s=Qr(r,"lockScalingY");if(n&&s||!e&&(n||s)&&t||n&&e==="x"||s&&e==="y")return!0;const{width:i,height:a,strokeWidth:c}=r;return i===0&&c===0&&e!=="y"||a===0&&c===0&&e!=="x"}const j6=["e","se","s","sw","w","nw","n","ne","e"],Pi=(r,e,t)=>{const n=nx(r,t);if(sx(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return gl;const s=$w(t,e);return"".concat(j6[s],"-resize")};function Tp(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,a=s.by,c=nx(r,i);let u,h,d,p,g,y;if(sx(i,a,c))return!1;if(e.gestureScale)h=e.scaleX*e.gestureScale,d=e.scaleY*e.gestureScale;else{if(u=ru(e,e.originX,e.originY,t,n),g=a!=="y"?Math.sign(u.x||e.signX||1):1,y=a!=="x"?Math.sign(u.y||e.signY||1):1,e.signX||(e.signX=g),e.signY||(e.signY=y),Qr(i,"lockScalingFlip")&&(e.signX!==g||e.signY!==y))return!1;if(p=i._getTransformedDimensions(),c&&!a){const S=Math.abs(u.x)+Math.abs(u.y),{original:T}=e,k=S/(Math.abs(p.x*T.scaleX/i.scaleX)+Math.abs(p.y*T.scaleY/i.scaleY));h=T.scaleX*k,d=T.scaleY*k}else h=Math.abs(u.x*i.scaleX/p.x),d=Math.abs(u.y*i.scaleY/p.y);Uw(e)&&(h*=2,d*=2),e.signX!==g&&a!=="y"&&(e.originX=k0(e.originX),h*=-1,e.signX=g),e.signY!==y&&a!=="x"&&(e.originY=k0(e.originY),d*=-1,e.signY=y)}const w=i.scaleX,_=i.scaleY;return a?(a==="x"&&i.set(er,h),a==="y"&&i.set(kr,d)):(!Qr(i,"lockScalingX")&&i.set(er,h),!Qr(i,"lockScalingY")&&i.set(kr,d)),w!==i.scaleX||_!==i.scaleY}const Vo=xs(Zl,ai((r,e,t,n)=>Tp(r,e,t,n))),ix=xs(Zl,ai((r,e,t,n)=>Tp(r,e,t,n,{by:"x"}))),ox=xs(Zl,ai((r,e,t,n)=>Tp(r,e,t,n,{by:"y"}))),L6=["target","ex","ey","skewingSide"],qh={x:{counterAxis:"y",scale:er,skew:io,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:kr,skew:oo,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},F6=["ns","nesw","ew","nwse"],ax=(r,e,t)=>{if(e.x!==0&&Qr(t,"lockSkewingY")||e.y!==0&&Qr(t,"lockSkewingX"))return gl;const n=$w(t,e)%4;return"".concat(F6[n],"-resize")};function cx(r,e,t,n,s){const{target:i}=t,{counterAxis:a,origin:c,lockSkewing:u,skew:h,flip:d}=qh[r];if(Qr(i,u))return!1;const{origin:p,flip:g}=qh[a],y=_t(t[p])*(i[g]?-1:1),w=-Math.sign(y)*(i[d]?-1:1),_=.5*-((i[h]===0&&ru(t,Ee,Ee,n,s)[r]>0||i[h]>0?1:-1)*w)+.5;return xs(Tw,ai((T,k,I,A)=>function(D,L,z){let{target:F,ex:Y,ey:W,skewingSide:q}=L,U=ot(L,L6);const{skew:X}=qh[D],te=z.subtract(new B(Y,W)).divide(new B(F.scaleX,F.scaleY))[D],de=F[X],J=U[X],le=Math.tan(gt(J)),ie=D==="y"?F._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:F._getTransformedDimensions({scaleX:1,scaleY:1}).y,se=2*te*q/Math.max(ie,1)+le,he=fs(Math.atan(se));F.set(X,he);const re=de!==F[X];if(re&&D==="y"){const{skewX:Re,scaleX:$e}=F,Le=F._getTransformedDimensions({skewY:de}),we=F._getTransformedDimensions(),Se=Re!==0?Le.x/we.x:1;Se!==1&&F.set(er,Se*$e)}return re}(r,k,new B(I,A))))(e,R(R({},t),{},{[c]:_,skewingSide:w}),n,s)}const lx=(r,e,t,n)=>cx("x",r,e,t,n),ux=(r,e,t,n)=>cx("y",r,e,t,n);function iu(r,e){return r[e.canvas.altActionKey]}const Bo=(r,e,t)=>{const n=iu(r,t);return e.x===0?n?io:kr:e.y===0?n?oo:er:""},Ws=(r,e,t)=>iu(r,t)?ax(0,e,t):Pi(r,e,t),Xd=(r,e,t,n)=>iu(r,e.target)?ux(r,e,t,n):ix(r,e,t,n),Gd=(r,e,t,n)=>iu(r,e.target)?lx(r,e,t,n):ox(r,e,t,n),Ep=()=>({ml:new ut({x:-.5,y:0,cursorStyleHandler:Ws,actionHandler:Xd,getActionName:Bo}),mr:new ut({x:.5,y:0,cursorStyleHandler:Ws,actionHandler:Xd,getActionName:Bo}),mb:new ut({x:0,y:.5,cursorStyleHandler:Ws,actionHandler:Gd,getActionName:Bo}),mt:new ut({x:0,y:-.5,cursorStyleHandler:Ws,actionHandler:Gd,getActionName:Bo}),tl:new ut({x:-.5,y:-.5,cursorStyleHandler:Pi,actionHandler:Vo}),tr:new ut({x:.5,y:-.5,cursorStyleHandler:Pi,actionHandler:Vo}),bl:new ut({x:-.5,y:.5,cursorStyleHandler:Pi,actionHandler:Vo}),br:new ut({x:.5,y:.5,cursorStyleHandler:Pi,actionHandler:Vo}),mtr:new ut({x:0,y:-.5,actionHandler:rx,cursorStyleHandler:tx,offsetY:-40,withConnection:!0,actionName:dp})}),hx=()=>({mr:new ut({x:.5,y:0,actionHandler:Yd,cursorStyleHandler:Ws,actionName:ra}),ml:new ut({x:-.5,y:0,actionHandler:Yd,cursorStyleHandler:Ws,actionName:ra})}),dx=()=>R(R({},Ep()),hx());class ia extends Dn{static getDefaults(){return R(R({},super.getDefaults()),ia.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),ia.ownDefaults),this.setOptions(e)}static createControls(){return{controls:Ep()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,s=t.action;if(this===n&&s&&s.startsWith(Jl))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[i,a]=n[s],c=this.controls[i];if(c.shouldActivate(i,this,e,t?a.touchCorner:a.corner))return this.__corner=i,{key:i,control:c,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=ao(t.x,t.y),s=co({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=mt(n,s),a=mt(e,i),c=mt(a,[1/e[0],0,0,1/e[3],0,0]),u=this.group?Bi(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const h=this._calculateCurrentDimensions(u),d={};return this.forEachControl((p,g)=>{const y=p.positionHandler(h,c,this,p);d[g]=Object.assign(y,this._calcCornerCoords(p,y))}),d}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(gt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=R({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,i=R({hasBorders:n,hasControls:s},t),a=this.getViewportTransform(),c=i.hasBorders,u=i.hasControls,h=mt(a,this.calcTransformMatrix()),d=Bi(h);e.save(),e.translate(d.translateX,d.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),e.rotate(gt(this.group?d.angle:this.angle)),c&&this.drawBorders(e,d,t),u&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let s;if(n&&n.forActiveSelection||this.group){const i=tu(this.width,this.height,_a(t)),a=this.isStrokeAccountedForInDimensions()?fp:(this.strokeUniform?new B().scalarAdd(this.canvas?this.canvas.getZoom():1):new B(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(a).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(n=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:a}=this,c=R({cornerStrokeColor:s,cornerDashArray:i,cornerColor:a},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=c.cornerColor,this.transparentCorners||(e.strokeStyle=c.cornerStrokeColor),this._setLineDash(e,c.cornerDashArray),this.forEachControl((u,h)=>{if(u.getVisibility(this,h)){const d=this.oCoords[h];u.render(e,d.x,d.y,c,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,s]=t;return this.setControlVisible(n,s)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const s=this.width+4,i=this.height+4;return t.clearRect(-s/2,-i/2,s,i),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function fx(r,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),r}j(ia,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Ke extends ia{}fx(Ke,[Xw]),ne.setClass(Ke),ne.setClass(Ke,"object");const px=(r,e,t,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=r.getImageData(e-n,t-n,s,s);for(let a=3;a<i.length;a+=4)if(i[a]>0)return!1;return!0};class gx{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new B(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new B(1/this.options.scaleX,1/this.options.scaleY):new B(1,1)}createSideVector(e,t){const n=ml(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new B(e);return t.y+=t.x*Math.tan(gt(this.options.skewY)),t.x+=t.y*Math.tan(gt(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const N6=new B;class Fi extends gx{static getOrthogonalRotationFactor(e,t){const n=t?yl(e,t):qw(e);return Math.abs(n)<hs?-1:1}constructor(e,t,n,s){super(s),j(this,"AB",void 0),j(this,"AC",void 0),j(this,"alpha",void 0),j(this,"bisector",void 0),this.A=new B(e),this.B=new B(t),this.C=new B(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=yl(this.AB,this.AC),this.bisector=su(xp(this.AB.eq(N6)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),i=_p(s),a=Fi.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,n*a)}projectBevel(){const e=[];return(this.alpha%Un==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),i=this.options.strokeUniform?vl(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return vl(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],s=new B(Fi.getOrthogonalRotationFactor(this.bisector),Fi.getOrthogonalRotationFactor(new B(this.bisector.y,this.bisector.x)));return[new B(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new B(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{Ud(i,e,t)&&n.push(this.A.add(i))}),n}projectRoundWithSkew(e,t){const n=[],{skewX:s,skewY:i,scaleX:a,scaleY:c,strokeUniform:u}=this.options,h=new B(Math.tan(gt(s)),Math.tan(gt(i))),d=this.strokeProjectionMagnitude,p=u?d/c/Math.sqrt(1/c**2+1/a**2*h.y**2):d/Math.sqrt(1+h.y**2),g=new B(Math.sqrt(Math.max(d**2-p**2,0)),p),y=u?d/Math.sqrt(1+h.x**2*(1/c)**2/(1/a+1/a*h.x*h.y)**2):d/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),w=new B(y,Math.sqrt(Math.max(d**2-y**2,0)));return[w,w.scalarMultiply(-1),g,g.scalarMultiply(-1)].map(_=>this.applySkew(u?_.multiply(this.strokeUniformScalar):_)).forEach(_=>{Ud(_,e,t)&&n.push(this.applySkew(this.A).add(_))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Un==0,n=this.applySkew(this.A),s=e[t?0:2].subtract(n),i=e[t?1:0].subtract(n),a=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),c=Li(s,a)>0,u=c?s:i,h=c?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(u,h)):e.push(...this.projectRoundNoSkew(u,h)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class R0 extends gx{constructor(e,t,n){super(n),this.A=new B(e),this.T=new B(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(_p(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new B(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Fi(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new B(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(su(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(t),s.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const mx=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(r.length===0)return n;const s=r.reduce((i,a)=>(i[i.length-1].eq(a)||i.push(new B(a)),i),[new B(r[0])]);if(s.length===1)t=!0;else if(!t){const i=s[0],a=((c,u)=>{for(let h=c.length-1;h>=0;h--)if(u(c[h],h,c))return h;return-1})(s,c=>!c.eq(i));s.splice(a+1)}return s.forEach((i,a,c)=>{let u,h;a===0?(h=c[1],u=t?i:c[c.length-1]):a===c.length-1?(u=c[a-1],h=t?i:c[0]):(u=c[a-1],h=c[a+1]),t&&c.length===1?n.push(...new R0(i,i,e).project()):!t||a!==0&&a!==c.length-1?n.push(...new Fi(i,u,h,e).project()):n.push(...new R0(i,a===0?h:u,e).project())}),n},kp=r=>{const e={};return Object.keys(r).forEach(t=>{e[t]={},Object.keys(r[t]).forEach(n=>{e[t][n]=R({},r[t][n])})}),e},vx=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ou=r=>{const e=[];for(let t,n=0;n<r.length;n++)(t=V6(r,n))!==!1&&e.push(t);return e},V6=(r,e)=>{const t=r.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return r.charAt(e);if(55296<=t&&t<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";const s=r.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=r.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var B6=Object.freeze({__proto__:null,capitalize:function(r){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(e?r.slice(1):r.slice(1).toLowerCase())},escapeXml:vx,graphemeSplit:ou});const au=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||t&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},yx=(r,e)=>{const t=e.split(`
`),n=[];let s=-1,i={};r=kp(r);for(let a=0;a<t.length;a++){const c=ou(t[a]);if(r[a])for(let u=0;u<c.length;u++){s++;const h=r[a][u];h&&Object.keys(h).length>0&&(au(i,h,!0)?n.push({start:s,end:s+1,style:h}):n[n.length-1].end++),i=h||{}}else s+=c.length,i={}}return n},bx=(r,e)=>{if(!Array.isArray(r))return kp(r);const t=e.split(hp),n={};let s=-1,i=0;for(let a=0;a<t.length;a++){const c=ou(t[a]);for(let u=0;u<c.length;u++)s++,r[i]&&r[i].start<=s&&s<r[i].end&&(n[a]=n[a]||{},n[a][u]=R({},r[i].style),s===r[i].end-1&&i++)}return n},_s=["display","transform",Mt,"fill-opacity","fill-rule","opacity",fr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function j0(r,e){const t=r.nodeName,n=r.getAttribute("class"),s=r.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let a;if(a=new RegExp("^"+t,"i"),e=e.replace(a,""),s&&e.length&&(a=new RegExp("#"+s+i,"i"),e=e.replace(a,"")),n&&e.length){const c=n.split(" ");for(let u=c.length;u--;)a=new RegExp("\\."+c[u]+i,"i"),e=e.replace(a,"")}return e.length===0}function z6(r,e){let t=!0;const n=j0(r,e.pop());return n&&e.length&&(t=function(s,i){let a,c=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)c&&(a=i.pop()),c=j0(s=s.parentElement,a);return i.length===0}(r,e)),n&&t&&e.length===0}const W6=r=>{var e;return(e=b6[r])!==null&&e!==void 0?e:r},H6=new RegExp("(".concat(Xs,")"),"gi"),U6=r=>r.replace(H6," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var L0,F0,N0,V0,B0,z0,W0;const Zt="(".concat(Xs,")"),$6=String.raw(L0||(L0=ws(["(skewX)(",")"],["(skewX)\\(","\\)"])),Zt),Y6=String.raw(F0||(F0=ws(["(skewY)(",")"],["(skewY)\\(","\\)"])),Zt),X6=String.raw(N0||(N0=ws(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Zt,Zt,Zt),G6=String.raw(V0||(V0=ws(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Zt,Zt),q6=String.raw(B0||(B0=ws(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Zt,Zt),K6=String.raw(z0||(z0=ws(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Zt,Zt,Zt,Zt,Zt,Zt),Ip="(?:".concat(K6,"|").concat(q6,"|").concat(X6,"|").concat(G6,"|").concat($6,"|").concat(Y6,")"),Z6="(?:".concat(Ip,"*)"),J6=String.raw(W0||(W0=ws(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),Z6),Q6=new RegExp(J6),e8=new RegExp(Ip),t8=new RegExp(Ip,"g");function qd(r){const e=[];if(!(r=U6(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!Q6.test(r))return[...Qt];for(const t of r.matchAll(t8)){const n=e8.exec(t[0]);if(!n)continue;let s=Qt;const i=n.filter(w=>!!w),[,a,...c]=i,[u,h,d,p,g,y]=c.map(w=>parseFloat(w));switch(a){case"translate":s=ao(u,h);break;case dp:s=co({angle:u},{x:h,y:d});break;case Jl:s=eu(u,h);break;case io:s=gp(u);break;case oo:s=mp(u);break;case"matrix":s=[u,h,d,p,g,y]}e.push(s)}return Ql(e)}function r8(r,e,t,n){const s=Array.isArray(e);let i,a=e;if(r!==Mt&&r!==fr||e!==dr){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")a=e===dr?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")a=t&&t.transformMatrix?mt(t.transformMatrix,qd(e)):qd(e);else if(r==="visible")a=e!==dr&&e!=="hidden",t&&t.visible===!1&&(a=!1);else if(r==="opacity")a=parseFloat(e),t&&t.opacity!==void 0&&(a*=t.opacity);else if(r==="textAnchor")a=e==="start"?Ue:e==="end"?wt:Ee;else if(r==="charSpacing")i=Ys(e,n)/n*1e3;else if(r==="paintFirst"){const c=e.indexOf(Mt),u=e.indexOf(fr);a=Mt,(c>-1&&u>-1&&u<c||c===-1&&u>-1)&&(a=fr)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(Ys):Ys(e,n)}}else a="";return!s&&isNaN(i)?a:i}function n8(r,e){const t=r.match(y6);if(!t)return;const n=t[1],s=t[3],i=t[4],a=t[5],c=t[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=Ys(i)),c&&(e.fontFamily=c),a&&(e.lineHeight=a==="normal"?1:a)}function s8(r,e){r.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[n,s]=t.split(":");e[n.trim().toLowerCase()]=s.trim()})}function i8(r){const e={},t=r.getAttribute("style");return t&&(typeof t=="string"?s8(t,e):function(n,s){Object.entries(n).forEach(i=>{let[a,c]=i;c!==void 0&&(s[a.toLowerCase()]=c)})}(t,e)),e}const o8={stroke:"strokeOpacity",fill:"fillOpacity"};function Xn(r,e,t){if(!r)return{};let n,s={},i=up;r.parentNode&&A0.test(r.parentNode.nodeName)&&(s=Xn(r.parentElement,e,t),s.fontSize&&(n=i=Ys(s.fontSize)));const a=R(R(R({},e.reduce((h,d)=>{const p=r.getAttribute(d);return p&&(h[d]=p),h},{})),function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={};for(const g in d)z6(h,g.split(" "))&&(p=R(R({},p),d[g]));return p}(r,t)),i8(r));a[Yh]&&r.setAttribute(Yh,a[Yh]),a[$h]&&(n=Ys(a[$h],i),a[$h]="".concat(n));const c={};for(const h in a){const d=W6(h),p=r8(d,a[h],s,n);c[d]=p}c&&c.font&&n8(c.font,c);const u=R(R({},s),c);return A0.test(r.nodeName)?u:function(h){const d=Ke.getDefaults();return Object.entries(o8).forEach(p=>{let[g,y]=p;if(h[y]===void 0||h[g]==="")return;if(h[g]===void 0){if(!d[g])return;h[g]=d[g]}if(h[g].indexOf("url(")===0)return;const w=new Xe(h[g]);h[g]=w.setAlpha(it(w.getAlpha()*h[y],2)).toRgba()}),h}(u)}const a8=["left","top","width","height","visible"],wx=["rx","ry"];class St extends Ke{static getDefaults(){return R(R({},super.getDefaults()),St.ownDefaults)}constructor(e){super(),Object.assign(this,St.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,s=-t/2,i=-n/2,a=this.rx?Math.min(this.rx,t/2):0,c=this.ry?Math.min(this.ry,n/2):0,u=a!==0||c!==0;e.beginPath(),e.moveTo(s+a,i),e.lineTo(s+t-a,i),u&&e.bezierCurveTo(s+t-os*a,i,s+t,i+os*c,s+t,i+c),e.lineTo(s+t,i+n-c),u&&e.bezierCurveTo(s+t,i+n-os*c,s+t-os*a,i+n,s+t-a,i+n),e.lineTo(s+a,i+n),u&&e.bezierCurveTo(s+os*a,i+n,s,i+n-os*c,s,i+n-c),e.lineTo(s,i+c),u&&e.bezierCurveTo(s,i+os*c,s+os*a,i,s+a,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...wx,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const s=Xn(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,width:c=0,height:u=0,visible:h=!0}=s,d=ot(s,a8);return new this(R(R(R({},t),d),{},{left:i,top:a,width:c,height:u,visible:!!(h&&c&&u)}))}}j(St,"type","Rect"),j(St,"cacheProperties",[...Yn,...wx]),j(St,"ownDefaults",{rx:0,ry:0}),j(St,"ATTRIBUTE_NAMES",[..._s,"x","y","rx","ry","width","height"]),ne.setClass(St),ne.setSVGClass(St);const Nn="initialization",bl="added",Ap="removed",wl="imperative",xx=(r,e)=>{const{strokeUniform:t,strokeWidth:n,width:s,height:i,group:a}=e,c=a&&a!==r?Ta(a.calcTransformMatrix(),r.calcTransformMatrix()):null,u=c?e.getRelativeCenterPoint().transform(c):e.getRelativeCenterPoint(),h=!e.isStrokeAccountedForInDimensions(),d=t&&h?Hw(new B(n,n),void 0,r.calcTransformMatrix()):fp,p=!t&&h?n:0,g=tu(s+p,i+p,Ql([c,e.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[u.subtract(g),u.add(g)]};class cu{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:s}=e;return t===Nn||t===wl||!!n&&s!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==Nn&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:s}=t;if(n===wl&&t.overrides)return t.overrides;if(e.length===0)return;const{left:i,top:a,width:c,height:u}=yn(e.map(p=>xx(s,p)).reduce((p,g)=>p.concat(g),[])),h=new B(c,u),d=new B(i,a).add(h.scalarDivide(2));if(n===Nn){const p=this.getInitialSize(t,{size:h,center:d});return{center:d,relativeCorrection:new B(0,0),size:p}}return{center:d.transform(s.calcOwnMatrix()),size:h}}}j(cu,"type","strategy");class Kd extends cu{shouldPerformLayout(e){return!0}}j(Kd,"type","fit-content"),ne.setClass(Kd);const c8=["strategy"],l8=["target","strategy","bubbles","prevStrategy"],_x="layoutManager";class oa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Kd;j(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=R(R({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[dl,Sw,ra,Cw,Zl,Tw,hl,Ew,h6].map(s=>e.on(s,i=>this.performLayout(s===dl?{type:"object_modified",trigger:s,e:i,target:n}:{type:"object_modifying",trigger:s,e:i,target:n})))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:s}=t;if(n===Nn||n===bl?this.subscribeTargets(e):n===Ap&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),n===wl&&e.deep){const i=ot(e,c8);t.forEachObject(a=>a.layoutManager&&a.layoutManager.performLayout(R(R({},i),{},{bubbles:!1,target:a})))}}getLayoutResult(e){const{target:t,strategy:n,type:s}=e,i=n.calcLayoutResult(e,t.getObjects());if(!i)return;const a=s===Nn?new B:t.getRelativeCenterPoint(),{center:c,correction:u=new B,relativeCorrection:h=new B}=i,d=a.subtract(c).add(u).transform(s===Nn?Qt:Er(t.calcOwnMatrix()),!0).add(h);return{result:i,prevCenter:a,nextCenter:c,offset:d}}commitLayout(e,t){const{target:n}=e,{result:{size:s},nextCenter:i}=t;var a,c;n.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===Nn?n.set({left:(a=e.x)!==null&&a!==void 0?a:i.x+s.x*_t(n.originX),top:(c=e.y)!==null&&c!==void 0?c:i.y+s.y*_t(n.originY)}):(n.setPositionByOrigin(i,Ee,Ee),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject(s=>{s.group===n&&this.layoutObject(e,t,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:s}=t;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,t){const{target:n,strategy:s,bubbles:i,prevStrategy:a}=e,c=ot(e,l8),{canvas:u}=n;n.fire("layout:after",{context:e,result:t}),u&&u.fire("object:layout:after",{context:e,result:t,target:n});const h=n.parent;i&&h!=null&&h.layoutManager&&((c.path||(c.path=[])).push(n),h.layoutManager.performLayout(R(R({},c),{},{target:h}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(n=>n())),e.clear()}toObject(){return{type:_x,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ne.setClass(oa,_x);const u8=["type","objects","layoutManager"];class h8 extends oa{performLayout(){}}class zr extends kw(Ke){static getDefaults(){return R(R({},super.getDefaults()),zr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),j(this,"_activeObjects",[]),j(this,"__objectSelectionTracker",void 0),j(this,"__objectSelectionDisposer",void 0),Object.assign(this,zr.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new oa,this.layoutManager.performLayout({type:Nn,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(us("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(us("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,s)=>this.canEnterGroup(t)&&s.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(t),i=super.add(...s);return this._onAfterObjectsChange(bl,s),i}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(n),a=super.insertAt(e,...i);return this._onAfterObjectsChange(bl,i),a}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(Ap,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(s=>{s._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(n);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&Wi(e,mt(Er(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(Wi(e,mt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Ke.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const a=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&a.group!==this?(e.save(),e.transform(...Er(this.calcTransformMatrix())),a.render(e),e.restore()):a.group===this&&a.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(R({target:this,type:wl},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=n;const a=s[e||"toObject"](t);return s.includeDefaultValues=i,a})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return R(R(R({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=St.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:s=[],layoutManager:i}=e,a=ot(e,u8);return Promise.all([zi(s,t),Sa(a,t)]).then(c=>{let[u,h]=c;const d=new this(u,R(R(R({},a),h),{},{layoutManager:new h8}));if(i){const p=ne.getClass(i.type),g=ne.getClass(i.strategy);d.layoutManager=new p(new g)}else d.layoutManager=new oa;return d.layoutManager.subscribeTargets({type:Nn,target:d,targets:d.getObjects()}),d.setCoords(),d})}}j(zr,"type","Group"),j(zr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ne.setClass(zr);const Sx=(r,e)=>Math.min(e.width/r.width,e.height/r.height),Cx=(r,e)=>Math.max(e.width/r.width,e.height/r.height),Zd="\\s*,?\\s*",Lo="".concat(Zd,"(").concat(Xs,")"),d8="".concat(Lo).concat(Lo).concat(Lo).concat(Zd,"([01])").concat(Zd,"([01])").concat(Lo).concat(Lo),f8={m:"l",M:"L"},p8=(r,e,t,n,s,i,a,c,u,h,d)=>{const p=rn(r),g=nn(r),y=rn(e),w=nn(e),_=t*s*y-n*i*w+a,S=n*s*y+t*i*w+c;return["C",h+u*(-t*s*g-n*i*p),d+u*(-n*s*g+t*i*p),_+u*(t*s*w+n*i*y),S+u*(n*s*w-t*i*y),_,S]},H0=(r,e,t,n)=>{const s=Math.atan2(e,r),i=Math.atan2(n,t);return i>=s?i-s:2*Math.PI-(s-i)};function Jd(r,e,t,n,s,i,a,c){let u;if(Ne.cachesBoundsOfCurve&&(u=[...arguments].join(),Uo.boundsOfCurveCache[u]))return Uo.boundsOfCurveCache[u];const h=Math.sqrt,d=Math.abs,p=[],g=[[0,0],[0,0]];let y=6*r-12*t+6*s,w=-3*r+9*t-9*s+3*a,_=3*t-3*r;for(let A=0;A<2;++A){if(A>0&&(y=6*e-12*n+6*i,w=-3*e+9*n-9*i+3*c,_=3*n-3*e),d(w)<1e-12){if(d(y)<1e-12)continue;const Y=-_/y;0<Y&&Y<1&&p.push(Y);continue}const D=y*y-4*_*w;if(D<0)continue;const L=h(D),z=(-y+L)/(2*w);0<z&&z<1&&p.push(z);const F=(-y-L)/(2*w);0<F&&F<1&&p.push(F)}let S=p.length;const T=S,k=Ex(r,e,t,n,s,i,a,c);for(;S--;){const{x:A,y:D}=k(p[S]);g[0][S]=A,g[1][S]=D}g[0][T]=r,g[1][T]=e,g[0][T+1]=a,g[1][T+1]=c;const I=[new B(Math.min(...g[0]),Math.min(...g[1])),new B(Math.max(...g[0]),Math.max(...g[1]))];return Ne.cachesBoundsOfCurve&&(Uo.boundsOfCurveCache[u]=I),I}const g8=(r,e,t)=>{let[n,s,i,a,c,u,h,d]=t;const p=((g,y,w,_,S,T,k)=>{if(w===0||_===0)return[];let I=0,A=0,D=0;const L=Math.PI,z=k*lp,F=nn(z),Y=rn(z),W=.5*(-Y*g-F*y),q=.5*(-Y*y+F*g),U=w**2,X=_**2,te=q**2,de=W**2,J=U*X-U*te-X*de;let le=Math.abs(w),ie=Math.abs(_);if(J<0){const Tt=Math.sqrt(1-J/(U*X));le*=Tt,ie*=Tt}else D=(S===T?-1:1)*Math.sqrt(J/(U*te+X*de));const se=D*le*q/ie,he=-D*ie*W/le,re=Y*se-F*he+.5*g,Re=F*se+Y*he+.5*y;let $e=H0(1,0,(W-se)/le,(q-he)/ie),Le=H0((W-se)/le,(q-he)/ie,(-W-se)/le,(-q-he)/ie);T===0&&Le>0?Le-=2*L:T===1&&Le<0&&(Le+=2*L);const we=Math.ceil(Math.abs(Le/L*2)),Se=[],at=Le/we,nr=8/3*Math.sin(at/4)*Math.sin(at/4)/Math.sin(at/2);let jt=$e+at;for(let Tt=0;Tt<we;Tt++)Se[Tt]=p8($e,jt,Y,F,le,ie,re,Re,nr,I,A),I=Se[Tt][5],A=Se[Tt][6],$e=jt,jt+=at;return Se})(h-r,d-e,s,i,c,u,a);for(let g=0,y=p.length;g<y;g++)p[g][1]+=r,p[g][2]+=e,p[g][3]+=r,p[g][4]+=e,p[g][5]+=r,p[g][6]+=e;return p},Tx=r=>{let e=0,t=0,n=0,s=0;const i=[];let a,c=0,u=0;for(const h of r){const d=[...h];let p;switch(d[0]){case"l":d[1]+=e,d[2]+=t;case"L":e=d[1],t=d[2],p=["L",e,t];break;case"h":d[1]+=e;case"H":e=d[1],p=["L",e,t];break;case"v":d[1]+=t;case"V":t=d[1],p=["L",e,t];break;case"m":d[1]+=e,d[2]+=t;case"M":e=d[1],t=d[2],n=d[1],s=d[2],p=["M",e,t];break;case"c":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t,d[5]+=e,d[6]+=t;case"C":c=d[3],u=d[4],e=d[5],t=d[6],p=["C",d[1],d[2],c,u,e,t];break;case"s":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"S":a==="C"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[3],t=d[4],p=["C",c,u,d[1],d[2],e,t],c=p[3],u=p[4];break;case"q":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"Q":c=d[1],u=d[2],e=d[3],t=d[4],p=["Q",c,u,e,t];break;case"t":d[1]+=e,d[2]+=t;case"T":a==="Q"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[1],t=d[2],p=["Q",c,u,e,t];break;case"a":d[6]+=e,d[7]+=t;case"A":g8(e,t,d).forEach(g=>i.push(g)),e=d[6],t=d[7];break;case"z":case"Z":e=n,t=s,p=["Z"]}p?(i.push(p),a=p[0]):a=""}return i},xl=(r,e,t,n)=>Math.sqrt((t-r)**2+(n-e)**2),Ex=(r,e,t,n,s,i,a,c)=>u=>{const h=u**3,d=(y=>3*y**2*(1-y))(u),p=(y=>3*y*(1-y)**2)(u),g=(y=>(1-y)**3)(u);return new B(a*h+s*d+t*p+r*g,c*h+i*d+n*p+e*g)},kx=r=>r**2,Ix=r=>2*r*(1-r),Ax=r=>(1-r)**2,m8=(r,e,t,n,s,i,a,c)=>u=>{const h=kx(u),d=Ix(u),p=Ax(u),g=3*(p*(t-r)+d*(s-t)+h*(a-s)),y=3*(p*(n-e)+d*(i-n)+h*(c-i));return Math.atan2(y,g)},v8=(r,e,t,n,s,i)=>a=>{const c=kx(a),u=Ix(a),h=Ax(a);return new B(s*c+t*u+r*h,i*c+n*u+e*h)},y8=(r,e,t,n,s,i)=>a=>{const c=1-a,u=2*(c*(t-r)+a*(s-t)),h=2*(c*(n-e)+a*(i-n));return Math.atan2(h,u)},U0=(r,e,t)=>{let n=new B(e,t),s=0;for(let i=1;i<=100;i+=1){const a=r(i/100);s+=xl(n.x,n.y,a.x,a.y),n=a}return s},b8=(r,e)=>{let t,n=0,s=0,i={x:r.x,y:r.y},a=R({},i),c=.01,u=0;const h=r.iterator,d=r.angleFinder;for(;s<e&&c>1e-4;)a=h(n),u=n,t=xl(i.x,i.y,a.x,a.y),t+s>e?(n-=c,c/=2):(i=a,n+=c,s+=t);return R(R({},a),{},{angle:d(u)})},Op=r=>{let e,t,n=0,s=0,i=0,a=0,c=0;const u=[];for(const h of r){const d={x:s,y:i,command:h[0],length:0};switch(h[0]){case"M":t=d,t.x=a=s=h[1],t.y=c=i=h[2];break;case"L":t=d,t.length=xl(s,i,h[1],h[2]),s=h[1],i=h[2];break;case"C":e=Ex(s,i,h[1],h[2],h[3],h[4],h[5],h[6]),t=d,t.iterator=e,t.angleFinder=m8(s,i,h[1],h[2],h[3],h[4],h[5],h[6]),t.length=U0(e,s,i),s=h[5],i=h[6];break;case"Q":e=v8(s,i,h[1],h[2],h[3],h[4]),t=d,t.iterator=e,t.angleFinder=y8(s,i,h[1],h[2],h[3],h[4]),t.length=U0(e,s,i),s=h[3],i=h[4];break;case"Z":t=d,t.destX=a,t.destY=c,t.length=xl(s,i,a,c),s=a,i=c}n+=t.length,u.push(t)}return u.push({length:n,x:s,y:i}),u},Ox=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Op(r),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const s=t[n],i=e/s.length,a=r[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return R(R({},new B(s.x,s.y).lerp(new B(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return R(R({},new B(s.x,s.y).lerp(new B(a[1],a[2]),i)),{},{angle:Math.atan2(a[2]-s.y,a[1]-s.x)});case"C":case"Q":return b8(s,e)}},w8=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),$0=new RegExp(d8,"g"),x8=new RegExp(Xs,"gi"),_8={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Mx=r=>{var e;const t=[],n=(e=r.match(w8))!==null&&e!==void 0?e:[];for(const s of n){const i=s[0];if(i==="z"||i==="Z"){t.push([i]);continue}const a=_8[i.toLowerCase()];let c=[];if(i==="a"||i==="A"){$0.lastIndex=0;for(let u=null;u=$0.exec(s);)c.push(...u.slice(1))}else c=s.match(x8)||[];for(let u=0;u<c.length;u+=a){const h=new Array(a),d=f8[i];h[0]=u>0&&d?d:i;for(let p=0;p<a;p++)h[p+1]=parseFloat(c[u+p]);t.push(h)}}return t},S8=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new B(r[0]),n=new B(r[1]),s=1,i=0;const a=[],c=r.length,u=c>2;let h;for(u&&(s=r[2].x<n.x?-1:r[2].x===n.x?0:1,i=r[2].y<n.y?-1:r[2].y===n.y?0:1),a.push(["M",t.x-s*e,t.y-i*e]),h=1;h<c;h++){if(!t.eq(n)){const d=t.midPointFrom(n);a.push(["Q",t.x,t.y,d.x,d.y])}t=r[h],h+1<r.length&&(n=r[h+1])}return u&&(s=t.x>r[h-2].x?1:t.x===r[h-2].x?0:-1,i=t.y>r[h-2].y?1:t.y===r[h-2].y?0:-1),a.push(["L",t.x+s*e,t.y+i*e]),a},Px=(r,e)=>r.map(t=>t.map((n,s)=>s===0||e===void 0?n:it(n,e)).join(" ")).join(" ");function _l(r,e){const t=r.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(n=>{let[s,i]=n;return t.setProperty(s,i)}))}const C8=(r,e)=>Math.floor(Math.random()*(e-r+1))+r;function T8(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||$s,n=new(Kl()).XMLHttpRequest,s=e.signal,i=function(){n.abort()},a=function(){s&&s.removeEventListener("abort",i),n.onerror=n.ontimeout=$s};if(s&&s.aborted)throw new xw("request");return s&&s.addEventListener("abort",i,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(a(),t(n),n.onreadystatechange=$s)},n.onerror=n.ontimeout=a,n.open("get",r,!0),n.send(),n}const E8=(r,e)=>{let t=r._findCenterFromElement();r.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:s,scaleY:i,angle:a,skewX:c}=Bi(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(er,s),n.set(kr,i),n.angle=a,n.skewX=c,n.skewY=0}})(r),t=t.transform(r.transformMatrix)),delete r.transformMatrix,e&&(r.scaleX*=e.scaleX,r.scaleY*=e.scaleY,r.cropX=e.cropX,r.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,r.width=e.width,r.height=e.height),r.setPositionByOrigin(t,Ee,Ee)};var Dx=Object.freeze({__proto__:null,addTransformToObject:zw,animate:Cp,animateColor:Jw,applyTransformToObject:Wi,calcAngleBetweenVectors:yl,calcDimensionsMatrix:_a,calcPlaneChangeMatrix:Ta,calcVectorRotation:qw,cancelAnimFrame:Aw,capValue:Gs,composeMatrix:Rw,copyCanvasElement:r=>{var e;const t=sn(r);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(r,0,0),t},cos:rn,createCanvasElement:Wr,createImage:Ow,createRotateMatrix:co,createScaleMatrix:eu,createSkewXMatrix:gp,createSkewYMatrix:mp,createTranslateMatrix:ao,createVector:ml,crossProduct:Li,degreesToRadians:gt,dotProduct:Kw,ease:S6,enlivenObjectEnlivables:Sa,enlivenObjects:zi,findScaleToCover:Cx,findScaleToFit:Sx,getBoundsOfCurve:Jd,getOrthonormalVector:_p,getPathSegmentsInfo:Op,getPointOnPath:Ox,getPointer:Bw,getRandomInt:C8,getRegularPolygonPath:(r,e)=>{const t=2*Math.PI/r;let n=-hs;r%2==0&&(n+=t/2);const s=new Array(r+1);for(let i=0;i<r;i++){const a=i*t+n,{x:c,y:u}=new B(rn(a),nn(a)).scalarMultiply(e);s[i]=[i===0?"M":"L",c,u]}return s[r]=["Z"],s},getSmoothPathFromPoints:S8,getSvgAttributes:r=>{const e=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:su,groupSVGElements:(r,e)=>r&&r.length===1?r[0]:new zr(r,e),hasStyleChanged:au,invertTransform:Er,isBetweenVectors:Ud,isIdentityMatrix:Mw,isTouchEvent:pl,isTransparent:px,joinPath:Px,loadImage:Yo,magnitude:vl,makeBoundingBoxFromPoints:yn,makePathSimpler:Tx,matrixToSVG:na,mergeClipPaths:(r,e)=>{var t;let n=r,s=e;n.inverted&&!s.inverted&&(n=e,s=r),Hd(s,(t=s.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());const i=n.inverted&&s.inverted;return i&&(n.inverted=s.inverted=!1),new zr([n],{clipPath:s,inverted:i})},multiplyTransformMatrices:mt,multiplyTransformMatrixArray:Ql,parsePath:Mx,parsePreserveAspectRatioAttribute:jw,parseUnit:Ys,pick:oi,projectStrokeOnPoints:mx,qrDecompose:Bi,radiansToDegrees:fs,removeFromArray:Fs,removeTransformFromObject:(r,e)=>{const t=Er(e),n=mt(t,r.calcOwnMatrix());Wi(r,n)},removeTransformMatrixForSvgParsing:E8,request:T8,requestAnimFrame:$o,resetObjectTransform:Ww,rotatePoint:(r,e,t)=>r.rotate(t,e),rotateVector:xp,saveObjectTransform:yp,sendObjectToPlane:Hd,sendPointToPlane:Bn,sendVectorToPlane:Hw,setStyle:_l,sin:nn,sizeAfterTransform:tu,string:B6,stylesFromArray:bx,stylesToArray:yx,toDataURL:pp,toFixed:it,transformPath:(r,e,t)=>(t&&(e=mt(e,[1,0,0,1,-t.x,-t.y])),r.map(n=>{const s=[...n];for(let i=1;i<n.length-1;i+=2){const{x:a,y:c}=Ht({x:n[i],y:n[i+1]},e);s[i]=a,s[i+1]=c}return s})),transformPoint:Ht});class k8 extends Vw{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),j(this,"upper",void 0),j(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(i,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const a=this.createContainerElement();a.classList.add(n),s.parentNode&&s.parentNode.replaceChild(a,s),a.append(s,i),this.container=a}createUpperCanvas(){const{el:e}=this.lower,t=Wr();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=so().createElement("div");return e.setAttribute("data-fabric","wrapper"),_l(e,{position:"relative"}),E0(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:s}=t;_l(e,R(R({},n),{},{"touch-action":s?"manipulation":dr})),E0(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:s}=this.upper;Nw(n,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),zd(this.upper.el,e),zd(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),wn().dispose(this.upper.el),delete this.upper,delete this.container}}class lu extends Ca{constructor(){super(...arguments),j(this,"targets",[]),j(this,"_hoveredTargets",[]),j(this,"_objectsToRender",void 0),j(this,"_currentTransform",null),j(this,"_groupSelector",null),j(this,"contextTopDirty",!1)}static getDefaults(){return R(R({},super.getDefaults()),lu.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new k8(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-t+s,-n+s),i.transform(...this.viewportTransform);const a=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=a,i.restore();const c=Math.round(s*this.getRetinaScaling());return px(i,c,c,c)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&n.length>1&&n.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let s;return t===Jl||t===er||t===kr||t===ra?s=this.centeredScaling||e.centeredScaling:t===dp&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=wt:["mr","tr","br"].includes(t)&&(n.x=Ue),["tl","mt","tr"].includes(t)?n.y=Bd:["bl","mb","br"].includes(t)&&(n.y=hr)),n}_setupCurrentTransform(e,t,n){var s;const i=t.group?Bn(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:a="",control:c}=t.getActiveControl()||{},u=n&&c?(s=c.getActionHandler(e,t,c))===null||s===void 0?void 0:s.bind(c):Yw,h=((y,w,_,S)=>{if(!w||!y)return"drag";const T=S.controls[w];return T.getActionName(_,T,S)})(n,a,e,t),d=e[this.centeredKey],p=this._shouldCenterTransform(t,h,d)?{x:Ee,y:Ee}:this._getOriginFromCorner(t,a),g={target:t,action:h,actionHandler:u,actionPerformed:!1,corner:a,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:i.x-t.left,offsetY:i.y-t.top,originX:p.x,originY:p.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:gt(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:d,original:R(R({},yp(t)),{},{originX:p.x,originY:p.y})};this._currentTransform=g,this.fire("before:transform",{e,transform:g})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new B(t,n).transform(this.viewportTransform),c=new B(t+s,n+i).transform(this.viewportTransform),u=this.selectionLineWidth/2;let h=Math.min(a.x,c.x),d=Math.min(a.y,c.y),p=Math.max(a.x,c.x),g=Math.max(a.y,c.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(h,d,p-h,g-d)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,h+=u,d+=u,p-=u,g-=u,Ke.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(h,d,p-h,g-d))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(t,pl(e))||s.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const a=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&a&&a!==n?(this.targets=i,n):a}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[a,c,u,h]=n,d=Math.atan2(c.y-a.y,c.x-a.x),p=rn(d)*i,g=nn(d)*i,y=p+g,w=p-g;n=[new B(a.x-w,a.y-y),new B(c.x+y,c.y-w),new B(u.x+w,u.y+y),new B(h.x-y,h.y+w)]}return lt.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,Bn(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,t)){if(Qc(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,t);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&Qc(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const a=s[i];if(!Qc(a)||!a.interactive)return a}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let i=Bw(e),a=s.width||0,c=s.height||0;a&&c||(hr in s&&Bd in s&&(c=Math.abs(s.top-s.bottom)),wt in s&&Ue in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,t||(i=Bn(i,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(i.x/=u,i.y/=u);const h=a===0||c===0?new B(1,1):new B(n.width/a,n.height/c);return i.multiply(h)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Wr(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Ns(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,s=!1;const i=this.getActiveObjects(),a=[],c=[];e.forEach(u=>{i.includes(u)||(n=!0,u.fire("deselected",{e:t,target:u}),c.push(u))}),i.forEach(u=>{e.includes(u)||(n=!0,u.fire("selected",{e:t,target:u}),a.push(u))}),e.length>0&&i.length>0?(s=!0,n&&this.fire("selection:updated",{e:t,selected:a,deselected:c})):i.length>0?(s=!0,this.fire("selection:created",{e:t,selected:a})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:c})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),s}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Ns(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Ns(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,s={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),n.fire(dl,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Ns(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,t,n);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Ns(t)&&this._activeObject===t){const n=oi(e,["angle","flipX","flipY",Ue,er,kr,io,oo,hr]);return zw(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(s)}}j(lu,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class I8{constructor(e){j(this,"targets",[]),j(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Fs(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const A8=["target","oldTarget","fireCanvas","e"],Tr={passive:!1},Ai=(r,e)=>{const t=r.getViewportPoint(e),n=r.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},as=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.addEventListener(...t)},Nr=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.removeEventListener(...t)},O8={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Qd extends lu{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),j(this,"_isClick",void 0),j(this,"textEditingManager",new I8(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(as,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,s=this._getEventPrefix();e(Fw(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,Tr),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Tr)}removeListeners(){this.addOrRemove(Nr,"remove");const e=this._getEventPrefix(),t=Jr(this.upperCanvasEl);Nr(t,"".concat(e,"up"),this._onMouseUp),Nr(t,"touchend",this._onTouchEnd,Tr),Nr(t,"".concat(e,"move"),this._onMouseMove,Tr),Nr(t,"touchmove",this._onMouseMove,Tr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=R({e},Ai(this,e));this.fire("mouse:out",R(R({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",R({},n)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",R(R({},n),{},{target:s})),s&&s.fire("mouseout",R({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",R({e},Ai(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void as(this.upperCanvasEl,"drag",this._onDragProgress)}Wd(e)}_renderDragEffects(e,t,n){let s=!1;const i=this._dropTarget;i&&i!==t&&i!==n&&(i.clearContextTop(),s=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();const a=this.contextTop;a.save(),a.transform(...this.viewportTransform),t&&(a.save(),t.transform(a),t.renderDragSourceEffect(e),a.restore(),s=!0),n&&(a.save(),n.transform(a),n.renderDropTargetEffect(e),a.restore(),s=!0),a.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==dr,n=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};Nr(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:s}=this.findDragTargets(e),i=this._dragSource,a={e,target:n,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let c;this.fire(t,a),this._fireEnterLeaveEvents(n,a),n&&(n.canDrop(e)&&(c=n),n.fire(t,a));for(let u=0;u<s.length;u++){const h=s[u];h.canDrop(e)&&(c=h),h.fire(t,a)}this._renderDragEffects(e,i,c),this._dropTarget=c}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),s={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",R({e,target:t,subTargets:n,dragSource:this._dragSource},Ai(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&Wd(e),this._basicEventHandler("contextmenu",s),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),a=Jr(s);as(a,"touchend",this._onTouchEnd,Tr),t&&as(a,"touchmove",this._onMouseMove,Tr),Nr(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();Nr(t,"".concat(n,"move"),this._onMouseMove,Tr);const s=Jr(t);as(s,"".concat(n,"up"),this._onMouseUp),as(s,"".concat(n,"move"),this._onMouseMove,Tr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=Jr(this.upperCanvasEl);Nr(n,"touchend",this._onTouchEnd,Tr),Nr(n,"touchmove",this._onMouseMove,Tr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{as(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=Jr(this.upperCanvasEl);Nr(s,"".concat(n,"up"),this._onMouseUp),Nr(s,"".concat(n,"move"),this._onMouseMove,Tr),as(t,"".concat(n,"move"),this._onMouseMove,Tr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,i=this._target,{button:a}=e;if(a)return(this.fireMiddleClick&&a===1||this.fireRightClick&&a===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let c,u,h=!1;if(n&&(this._finalizeCurrentTransform(e),h=n.actionPerformed),!s){const d=i===this._activeObject;this.handleSelection(e),h||(h=this._shouldRender(i)||!d&&i===this._activeObject)}if(i){const d=i.findControl(this.getViewportPoint(e),pl(e)),{key:p,control:g}=d||{};if(u=p,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),h=!0;else if(g){const y=g.getMouseUpHandler(e,i,g);y&&(c=this.getScenePoint(e),y.call(g,e,n,c.x,c.y))}i.isMoving=!1}if(n&&(n.target!==i||n.corner!==u)){const d=n.target&&n.target.controls[n.corner],p=d&&d.getMouseUpHandler(e,n.target,d);c=c||this.getScenePoint(e),p&&p.call(d,e,n,c.x,c.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),h?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:s=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let i=0;i<s.length;i++)s[i]!==n&&s[i].fire(e,t);return t}_handleEvent(e,t){const n=this._target,s=this.targets||[],i=R(R({e,target:n,subTargets:s},Ai(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),i),n&&n.fire("mouse".concat(t),i);for(let a=0;a<s.length;a++)s[a]!==n&&s[a].fire("mouse".concat(t),i)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:n}=e;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),i=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,i=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(t){const a=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const c=t.findControl(this.getViewportPoint(e),pl(e));if(t===this._activeObject&&(c||!i)){this._setupCurrentTransform(e,t,a);const u=c?c.control:void 0,h=this.getScenePoint(e),d=u&&u.getMouseDownHandler(e,t,u);d&&d.call(u,e,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=Bn(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("mouse",{e,target:i[c],oldTarget:s[c]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",R(R({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("drag",R(R({},t),{},{target:i[c],oldTarget:s[c]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:s,fireCanvas:i,e:a}=t,c=ot(t,A8);const{targetIn:u,targetOut:h,canvasIn:d,canvasOut:p}=O8[e],g=s!==n;if(s&&g){const y=R(R({},c),{},{e:a,target:s,nextTarget:n},Ai(this,a));i&&this.fire(p,y),s.fire(h,y)}if(n&&g){const y=R(R({},c),{},{e:a,target:n,previousTarget:s},Ai(this,a));i&&this.fire(d,y),n.fire(u,y)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,s=n.target,i=s.group?Bn(t,void 0,s.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,i),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:s,actionHandler:i,target:a}=t,c=!!i&&i(e,t,n.x,n.y);c&&a.setCoords(),s==="drag"&&c&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||c}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const s=Ns(this._activeObject)?this._activeObject:null,i=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(i){const a=i.control;this.setCursor(a.cursorStyleHandler(e,a,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(a=>{n=a.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,s=Ns(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||s)&&(s||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(s){const i=n.getObjects();if(t===n){const a=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(i,a)||this.searchPossibleTargets(this._objects,a))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{n.isEditing&&n.exitEditing();const i=new(ne.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(n,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new B(t,n),c=a.add(new B(s,i)),u=a.min(c),h=a.max(c).subtract(u),d=this.collectObjects({left:u.x,top:u.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),p=a.eq(c)?d[0]?[d[0]]:[]:d.length>1?d.filter(g=>!g.onSelect({e})).reverse():d;if(p.length===1)this.setActiveObject(p[0],e);else if(p.length>1){const g=ne.getClass("ActiveSelection");this.setActiveObject(new g(p,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Rx={x1:0,y1:0,x2:0,y2:0},M8=R(R({},Rx),{},{r1:0,r2:0}),Di=(r,e)=>isNaN(r)&&typeof e=="number"?e:r,P8=/^(\d+\.\d+)%|(\d+)%$/;function jx(r){return r&&P8.test(r)}function Lx(r,e){const t=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(jx(r)?100:1):NaN;return Gs(0,Di(t,e),1)}const D8=/\s*;\s*/,R8=/\s*:\s*/;function j8(r,e){let t,n;const s=r.getAttribute("style");if(s){const a=s.split(D8);a[a.length-1]===""&&a.pop();for(let c=a.length;c--;){const[u,h]=a[c].split(R8).map(d=>d.trim());u==="stop-color"?t=h:u==="stop-opacity"&&(n=h)}}const i=new Xe(t||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:Lx(r.getAttribute("offset"),0),color:i.toRgb(),opacity:Di(parseFloat(n||r.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function L8(r,e){const t=[],n=r.getElementsByTagName("stop"),s=Lx(e,1);for(let i=n.length;i--;)t.push(j8(n[i],s));return t}function Fx(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function Nx(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Kr(r,e){return r.getAttribute(e)}function F8(r,e){return function(t,n){let s,{width:i,height:a,gradientUnits:c}=n;return Object.keys(t).reduce((u,h)=>{const d=t[h];return d==="Infinity"?s=1:d==="-Infinity"?s=0:(s=typeof d=="string"?parseFloat(d):d,typeof d=="string"&&jx(d)&&(s*=.01,c==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(s*=i),h!=="y1"&&h!=="y2"||(s*=a)))),u[h]=s,u},{})}(Fx(r)==="linear"?function(t){return{x1:Kr(t,"x1")||0,y1:Kr(t,"y1")||0,x2:Kr(t,"x2")||"100%",y2:Kr(t,"y2")||0}}(r):function(t){return{x1:Kr(t,"fx")||Kr(t,"cx")||"50%",y1:Kr(t,"fy")||Kr(t,"cy")||"50%",r1:0,x2:Kr(t,"cx")||"50%",y2:Kr(t,"cy")||"50%",r2:Kr(t,"r")||"50%"}}(r),R(R({},e),{},{gradientUnits:Nx(r)}))}class kc{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:s={},colorStops:i=[],offsetX:a=0,offsetY:c=0,gradientTransform:u,id:h}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:R(R({},t==="radial"?M8:Rx),s),colorStops:i,offsetX:a,offsetY:c,gradientTransform:u,id:h?"".concat(h,"_").concat(ds()):ds()})}addColorStop(e){for(const t in e){const n=new Xe(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return R(R({},oi(this,e)),{},{type:this.type,coords:R({},this.coords),colorStops:this.colorStops.map(t=>R({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():Qt.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",a=this.colorStops.map(p=>R({},p)).sort((p,g)=>p.offset-g.offset);let c=-this.offsetX,u=-this.offsetY;var h;i==="objectBoundingBox"?(c/=e.width,u/=e.height):(c+=e.width/2,u+=e.height/2),(h=e)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(c-=e.pathOffset.x,u-=e.pathOffset.y),s[4]-=c,s[5]-=u;const d=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(na(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:p,y1:g,x2:y,y2:w}=this.coords;n.push("<linearGradient ",d,' x1="',p,'" y1="',g,'" x2="',y,'" y2="',w,`">
`)}else if(this.type==="radial"){const{x1:p,y1:g,x2:y,y2:w,r1:_,r2:S}=this.coords,T=_>S;n.push("<radialGradient ",d,' cx="',T?p:y,'" cy="',T?g:w,'" r="',T?_:S,'" fx="',T?y:p,'" fy="',T?w:g,`">
`),T&&(a.reverse(),a.forEach(I=>{I.offset=1-I.offset}));const k=Math.min(_,S);if(k>0){const I=k/Math.max(_,S);a.forEach(A=>{A.offset+=I*(1-A.offset)})}}return a.forEach(p=>{let{color:g,offset:y,opacity:w}=p;n.push("<stop ",'offset="',100*y+"%",'" style="stop-color:',g,w!==void 0?";stop-opacity: "+w:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:s,y2:i,r1:a,r2:c}=this.coords,u=this.type==="linear"?e.createLinearGradient(t,n,s,i):e.createRadialGradient(t,n,a,s,i,c);return this.colorStops.forEach(h=>{let{color:d,opacity:p,offset:g}=h;u.addColorStop(g,p!==void 0?new Xe(d).setAlpha(p).toRgba():d)}),u}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(R(R({},e),{},{colorStops:t?t.map(s=>R({},s)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const s=Nx(e),i=t._findCenterFromElement();return new this(R({id:e.getAttribute("id")||void 0,type:Fx(e),coords:F8(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:L8(e,n.opacity),gradientUnits:s,gradientTransform:qd(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-i.x,offsetY:t.height/2-i.y}:{offsetX:0,offsetY:0}))}}j(kc,"type","Gradient"),ne.setClass(kc,"gradient"),ne.setClass(kc,"linear"),ne.setClass(kc,"radial");const N8=["type","source","patternTransform"];class Kh{get type(){return"pattern"}set type(e){us("warn","Setting type has no effect",e)}constructor(e){j(this,"repeat","repeat"),j(this,"offsetX",0),j(this,"offsetY",0),j(this,"crossOrigin",""),this.id=ds(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return R(R({},oi(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:it(this.offsetX,Ne.NUM_FRACTION_DIGITS),offsetY:it(this.offsetY,Ne.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:s,repeat:i,id:a}=this,c=Di(this.offsetX/t,0),u=Di(this.offsetY/n,0),h=i==="repeat-y"||i==="no-repeat"?1+Math.abs(c||0):Di(s.width/t,0),d=i==="repeat-x"||i==="no-repeat"?1+Math.abs(u||0):Di(s.height/n,0);return['<pattern id="SVGID_'.concat(a,'" x="').concat(c,'" y="').concat(u,'" width="').concat(h,'" height="').concat(d,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:s,patternTransform:i}=e,a=ot(e,N8);const c=await Yo(s,R(R({},t),{},{crossOrigin:a.crossOrigin}));return new this(R(R({},a),{},{patternTransform:i&&i.slice(0),source:c}))}}j(Kh,"type","Pattern"),ne.setClass(Kh),ne.setClass(Kh,"pattern");const V8=["path","left","top"],B8=["d"];class Vs extends Ke{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:i}=t,a=ot(t,V8);super(),Object.assign(this,Vs.ownDefaults),this.setOptions(a),this._setPath(e||[],!0),typeof s=="number"&&this.set(Ue,s),typeof i=="number"&&this.set(hr,i)}_setPath(e,t){this.path=Tx(Array.isArray(e)?e:Mx(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new B(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+n);break;case"M":e.moveTo(s[1]+t,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n,s[5]+t,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=Px(this.path,Ne.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Ne.NUM_FRACTION_DIGITS;return" translate(".concat(it(-this.pathOffset.x,e),", ").concat(it(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:s}=this._calcDimensions();this.set({width:t,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,Ee,Ee)}_calcBoundsFromPath(){const e=[];let t=0,n=0,s=0,i=0;for(const a of this.path)switch(a[0]){case"L":s=a[1],i=a[2],e.push({x:t,y:n},{x:s,y:i});break;case"M":s=a[1],i=a[2],t=s,n=i;break;case"C":e.push(...Jd(s,i,a[1],a[2],a[3],a[4],a[5],a[6])),s=a[5],i=a[6];break;case"Q":e.push(...Jd(s,i,a[1],a[2],a[1],a[2],a[3],a[4])),s=a[3],i=a[4];break;case"Z":s=t,i=n}return yn(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return R(R({},e),{},{pathOffset:new B(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const s=Xn(e,this.ATTRIBUTE_NAMES,n),{d:i}=s;return new this(i,R(R(R({},ot(s,B8)),t),{},{left:void 0,top:void 0}))}}j(Vs,"type","Path"),j(Vs,"cacheProperties",[...Yn,"path","fillRule"]),j(Vs,"ATTRIBUTE_NAMES",[..._s,"d"]),ne.setClass(Vs),ne.setSVGClass(Vs);const z8=["left","top","radius"],Vx=["radius","startAngle","endAngle","counterClockwise"];class jn extends Ke{static getDefaults(){return R(R({},super.getDefaults()),jn.ownDefaults)}constructor(e){super(),Object.assign(this,jn.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,gt(this.startAngle),gt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(er)}getRadiusY(){return this.get("radius")*this.get(kr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Vx,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=gt(this.startAngle),s=gt(this.endAngle),i=rn(n)*t,a=nn(n)*t,c=rn(s)*t,u=nn(s)*t,h=e>180?1:0,d=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(a," A ").concat(t," ").concat(t," 0 ").concat(h," ").concat(d," ").concat(c," ").concat(u,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const s=Xn(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,radius:c=0}=s;return new this(R(R({},ot(s,z8)),{},{radius:c,left:i-c,top:a-c}))}static fromObject(e){return super._fromObject(e)}}j(jn,"type","Circle"),j(jn,"cacheProperties",[...Yn,...Vx]),j(jn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),j(jn,"ATTRIBUTE_NAMES",["cx","cy","r",..._s]),ne.setClass(jn),ne.setSVGClass(jn);const W8=["x1","y1","x2","y2"],H8=["x1","y1","x2","y2"],ef=["x1","x2","y1","y2"];class Bs extends Ke{constructor(){let[e,t,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Bs.ownDefaults),this.setOptions(i),this.x1=e,this.x2=n,this.y1=t,this.y2=s,this._setWidthHeight();const{left:a,top:c}=i;typeof a=="number"&&this.set(Ue,a),typeof c=="number"&&this.set(hr,c)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-t);const{left:i,top:a,width:c,height:u}=yn([{x:e,y:t},{x:n,y:s}]),h=new B(i+c/2,a+u/2);this.setPositionByOrigin(h,Ee,Ee)}_set(e,t){return super._set(e,t),ef.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;Br(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new B((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:s,width:i,height:a}=this,c=e<=t?-1:1,u=n<=s?-1:1;return{x1:c*i/2,x2:c*-i/2,y1:u*a/2,y2:u*-a/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,n){const s=Xn(e,this.ATTRIBUTE_NAMES,n),{x1:i=0,y1:a=0,x2:c=0,y2:u=0}=s;return new this([i,a,c,u],ot(s,W8))}static fromObject(e){let{x1:t,y1:n,x2:s,y2:i}=e,a=ot(e,H8);return this._fromObject(R(R({},a),{},{points:[t,n,s,i]}),{extraParam:"points"})}}j(Bs,"type","Line"),j(Bs,"cacheProperties",[...Yn,...ef]),j(Bs,"ATTRIBUTE_NAMES",_s.concat(ef)),ne.setClass(Bs),ne.setSVGClass(Bs);class Hs extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Hs.ownDefaults)}constructor(e){super(),Object.assign(this,Hs.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}j(Hs,"type","Triangle"),j(Hs,"ownDefaults",{width:100,height:100}),ne.setClass(Hs),ne.setSVGClass(Hs);const Bx=["rx","ry"];class Ln extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Ln.ownDefaults)}constructor(e){super(),Object.assign(this,Ln.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(er)}getRy(){return this.get("ry")*this.get(kr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Bx,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Un,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const s=Xn(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function U8(r){if(!r)return[];const e=r.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}j(Ln,"type","Ellipse"),j(Ln,"cacheProperties",[...Yn,...Bx]),j(Ln,"ownDefaults",{rx:0,ry:0}),j(Ln,"ATTRIBUTE_NAMES",[..._s,"cx","cy","rx","ry"]),ne.setClass(Ln),ne.setSVGClass(Ln);const $8=["left","top"],zx={exactBoundingBox:!1};class Zr extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Zr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),j(this,"strokeDiff",void 0),Object.assign(this,Zr.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(Ue,n),typeof s=="number"&&this.set(hr,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return mx(this.points,e,this.isOpen())}_calcDimensions(e){e=R({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(h=>h.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new B,strokeOffset:new B,strokeDiff:new B};const n=yn(t),s=_a(R(R({},e),{},{scaleX:1,scaleY:1})),i=yn(this.points.map(h=>Ht(h,s,!0))),a=new B(this.scaleX,this.scaleY);let c=n.left+n.width/2,u=n.top+n.height/2;return this.exactBoundingBox&&(c-=u*Math.tan(gt(this.skewX)),u-=c*Math.tan(gt(this.skewY))),R(R({},n),{},{pathOffset:new B(c,u),strokeOffset:new B(i.left,i.top).subtract(new B(n.left,n.top)).multiply(a),strokeDiff:new B(n.width,n.height).subtract(new B(i.width,i.height)).multiply(a)})}_findCenterFromElement(){const e=yn(this.points);return new B(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:s,height:i,pathOffset:a,strokeOffset:c,strokeDiff:u}=this._calcDimensions();this.set({width:s,height:i,pathOffset:a,strokeOffset:c,strokeDiff:u}),e&&this.setPositionByOrigin(new B(t+s/2,n+i/2),Ee,Ee)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new B(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let a;if(Object.keys(e).some(c=>this.strokeUniform||this.constructor.layoutProperties.includes(c))){var t,n;const{width:c,height:u}=this._calcDimensions(e);a=new B((t=e.width)!==null&&t!==void 0?t:c,(n=e.height)!==null&&n!==void 0?n:u)}else{var s,i;a=new B((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return a.multiply(new B(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&n&&((e===er||e===kr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:n,y:s}=t;return{x:n,y:s}})})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,s=Ne.NUM_FRACTION_DIGITS;for(let i=0,a=this.points.length;i<a;i++)e.push(it(this.points[i].x-t,s),",",it(this.points[i].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let i=0;i<t;i++){const a=this.points[i];e.lineTo(a.x-n,a.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(U8(e.getAttribute("points")),R(R({},ot(Xn(e,this.ATTRIBUTE_NAMES,n),$8)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}j(Zr,"ownDefaults",zx),j(Zr,"type","Polyline"),j(Zr,"layoutProperties",[io,oo,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),j(Zr,"cacheProperties",[...Yn,"points"]),j(Zr,"ATTRIBUTE_NAMES",[..._s]),ne.setClass(Zr),ne.setSVGClass(Zr);class Ic extends Zr{isOpen(){return!1}}j(Ic,"ownDefaults",zx),j(Ic,"type","Polygon"),ne.setClass(Ic),ne.setSVGClass(Ic);const Wx=["fontSize","fontWeight","fontFamily","fontStyle"],Hx=["underline","overline","linethrough"],Ux=[...Wx,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],$x=[...Ux,...Hx,"textBackgroundColor","direction"],Y8=[...Wx,...Hx,fr,"strokeWidth",Mt,"deltaY","textBackgroundColor"],X8={_reNewline:hp,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Ue,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Ue,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},fn="justify",Sl="justify-left",Xo="justify-right",Go="justify-center";class Yx extends Ke{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const s in t[n])for(const i in t[n][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const s in n)for(const i in n[s])if(n[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,s,i=0,a=!0,c=0;for(const u in t){n=0;for(const h in t[u]){const d=t[u][h]||{};i++,d[e]!==void 0?(s?d[e]!==s&&(a=!1):s=d[e],d[e]===this[e]&&delete d[e]):a=!1,Object.keys(d).length!==0?n++:delete t[u][h]}n===0&&delete t[u]}for(let u=0;u<this._textLines.length;u++)c+=this._textLines[u].length;a&&i===c&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,s,i;for(s in t){for(i in n=t[s],n)delete n[i][e],Object.keys(n[i]).length===0&&delete n[i];Object.keys(n).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const i=vp(R(R({},this._getStyleDeclaration(n,s)),t),a=>a!==void 0);this._setStyleDeclaration(n,s,i)}getSelectionStyles(e,t,n){const s=[];for(let i=e;i<(t||e);i++)s.push(this.getStyleAtPosition(i,n));return s}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,t,n){for(let s=t;s<(n||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const s=this.styles&&this.styles[e];return s&&(n=s[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return R(R({},oi(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}j(Yx,"_styleProperties",Y8);const G8=/  +/g,q8=/"/g;function Zh(r,e,t,n,s){return"		".concat(function(i,a){let{left:c,top:u,width:h,height:d}=a,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ne.NUM_FRACTION_DIGITS;const g=sa(Mt,i,!1),[y,w,_,S]=[c,u,h,d].map(T=>it(T,p));return"<rect ".concat(g,' x="').concat(y,'" y="').concat(w,'" width="').concat(_,'" height="').concat(S,'"></rect>')}(r,{left:e,top:t,width:n,height:s}),`
`)}const K8=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Jh;class Kt extends Yx{static getDefaults(){return R(R({},super.getDefaults()),Kt.ownDefaults)}constructor(e,t){super(),j(this,"__charBounds",[]),Object.assign(this,Kt.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Op(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(fn)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,s,i,a,c;for(let u=0,h=this._textLines.length;u<h;u++)if((this.textAlign===fn||u!==h-1&&!this.isEndOfWrapping(u))&&(s=0,i=this._textLines[u],t=this.getLineWidth(u),t<this.width&&(c=this.textLines[u].match(this._reSpacesAndTabs)))){n=c.length,e=(this.width-t)/n;for(let d=0;d<=i.length;d++)a=this.__charBounds[u][d],this._reSpaceAndTab.test(i[d])?(a.width+=e,a.kernedWidth+=e,a.left+=s,s+=e):a.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===fr?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Ee:e.textBaseline="middle";break;case"ascender":e.textBaseline=hr;break;case"descender":e.textBaseline=Bd}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,n,s,i,a){this._renderChars(e,t,n,s,i,a)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,a=this._textLines.length;i<a;i++){const c=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=c;continue}const u=this._textLines[i].length,h=this._getLineLeftOffset(i);let d,p,g=0,y=0,w=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let _=0;_<u;_++){const S=this.__charBounds[i][_];p=this.getValueOfPropertyAt(i,_,"textBackgroundColor"),this.path?(e.save(),e.translate(S.renderLeft,S.renderTop),e.rotate(S.angle),e.fillStyle=p,p&&e.fillRect(-S.width/2,-c/this.lineHeight*(1-this._fontSizeFraction),S.width,c/this.lineHeight),e.restore()):p!==w?(d=n+h+y,this.direction==="rtl"&&(d=this.width-d-g),e.fillStyle=w,w&&e.fillRect(d,s,g,c/this.lineHeight),y=S.left,g=S.width,w=p):g+=S.kernedWidth}p&&!this.path&&(d=n+h+y,this.direction==="rtl"&&(d=this.width-d-g),e.fillStyle=p,e.fillRect(d,s,g,c/this.lineHeight)),s+=c}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,s){const i=Uo.getFontCache(t),a=this._getFontDeclaration(t),c=n+e,u=n&&a===this._getFontDeclaration(s),h=t.fontSize/this.CACHE_FONT_SIZE;let d,p,g,y;if(n&&i[n]!==void 0&&(g=i[n]),i[e]!==void 0&&(y=d=i[e]),u&&i[c]!==void 0&&(p=i[c],y=p-g),d===void 0||g===void 0||p===void 0){const w=function(){return Jh||(Jh=sn({width:0,height:0}).getContext("2d")),Jh}();this._setTextStyles(w,t,!0),d===void 0&&(y=d=w.measureText(e).width,i[e]=d),g===void 0&&u&&n&&(g=w.measureText(n).width,i[n]=g),u&&p===void 0&&(p=w.measureText(c).width,i[c]=p,y=p-g)}return{width:d*h,kernedWidth:y*h}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,s=0;const i=this.pathSide===wt,a=this.path,c=this._textLines[e],u=c.length,h=new Array(u);this.__charBounds[e]=h;for(let d=0;d<u;d++){const p=c[d];n=this._getGraphemeBox(p,e,d,t),h[d]=n,s+=n.kernedWidth,t=p}if(h[u]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},a&&a.segmentsInfo){let d=0;const p=a.segmentsInfo[a.segmentsInfo.length-1].length;switch(this.textAlign){case Ue:d=i?p-s:0;break;case Ee:d=(p-s)/2;break;case wt:d=i?0:p-s}d+=this.pathStartOffset*(i?-1:1);for(let g=i?u-1:0;i?g>=0:g<u;i?g--:g++)n=h[g],d>p?d%=p:d<0&&(d+=p),this._setGraphemeOnPath(d,n),d+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,s=this.path,i=Ox(s.path,n,s.segmentsInfo);t.renderLeft=i.x-s.pathOffset.x,t.renderTop=i.y-s.pathOffset.y,t.angle=i.angle+(this.pathSide===wt?Math.PI:0)}_getGraphemeBox(e,t,n,s,i){const a=this.getCompleteStyleDeclaration(t,n),c=s?this.getCompleteStyleDeclaration(t,n-1):{},u=this._measureChar(e,a,s,c);let h,d=u.kernedWidth,p=u.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),p+=h,d+=h);const g={width:p,left:0,height:a.fontSize,kernedWidth:d,deltaY:a.deltaY};if(n>0&&!i){const y=this.__charBounds[t][n-1];g.left=y.left+y.width+u.kernedWidth-u.width}return g}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,s=this._textLines.length;n<s;n++)e=this.getHeightOfLine(n),t+=n===s-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let a=0,c=this._textLines.length;a<c;a++){const u=this.getHeightOfLine(a),h=u/this.lineHeight,d=this._getLineLeftOffset(a);this._renderTextLine(t,e,this._textLines[a],s+d,i+n+h,a),n+=u}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Mt))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,s,i,a){const c=this.getHeightOfLine(a),u=this.textAlign.includes(fn),h=this.path,d=!u&&this.charSpacing===0&&this.isEmptyStyles(a)&&!h,p=this.direction==="ltr",g=this.direction==="ltr"?1:-1,y=t.direction;let w,_,S,T,k,I="",A=0;if(t.save(),y!==this.direction&&(t.canvas.setAttribute("dir",p?"ltr":"rtl"),t.direction=p?"ltr":"rtl",t.textAlign=p?Ue:wt),i-=c*this._fontSizeFraction/this.lineHeight,d)return this._renderChar(e,t,a,0,n.join(""),s,i),void t.restore();for(let D=0,L=n.length-1;D<=L;D++)T=D===L||this.charSpacing||h,I+=n[D],S=this.__charBounds[a][D],A===0?(s+=g*(S.kernedWidth-S.width),A+=S.width):A+=S.kernedWidth,u&&!T&&this._reSpaceAndTab.test(n[D])&&(T=!0),T||(w=w||this.getCompleteStyleDeclaration(a,D),_=this.getCompleteStyleDeclaration(a,D+1),T=au(w,_,!1)),T&&(h?(t.save(),t.translate(S.renderLeft,S.renderTop),t.rotate(S.angle),this._renderChar(e,t,a,D,I,-A/2,0),t.restore()):(k=s,this._renderChar(e,t,a,D,I,k,i)),I="",w=_,s+=g*A,A=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=sn({width:t,height:n}),i=s.getContext("2d");return s.width=t,s.height=n,i.beginPath(),i.moveTo(0,0),i.lineTo(t,0),i.lineTo(t,n),i.lineTo(0,n),i.closePath(),i.translate(t/2,n/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,t,n){let s,i;return Br(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[t]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:i}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,s,i,a,c){const u=this._getStyleDeclaration(n,s),h=this.getCompleteStyleDeclaration(n,s),d=e==="fillText"&&h.fill,p=e==="strokeText"&&h.stroke&&h.strokeWidth;if(p||d){if(t.save(),t.font=this._getFontDeclaration(h),u.textBackgroundColor&&this._removeShadow(t),u.deltaY&&(c+=u.deltaY),d){const g=this._setFillStyles(t,h);t.fillText(i,a-g.offsetX,c-g.offsetY)}if(p){const g=this._setStrokeStyles(t,h);t.strokeText(i,a-g.offsetX,c-g.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),a=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),c={fontSize:i*n.size,deltaY:a+i*n.baseline};this.setSelectionStyles(c,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,s=this.textAlign,i=this.direction,a=this.isEndOfWrapping(e);let c=0;return s===fn||s===Go&&!a||s===Xo&&!a||s===Sl&&!a?0:(s===Ee&&(c=n/2),s===wt&&(c=n),s===Go&&(c=n/2),s===Xo&&(c=n),i==="rtl"&&(s===wt||s===fn||s===Xo?c=0:s===Ue||s===Sl?c=-n:s!==Ee&&s!==Go||(c=-n/2)),c)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var s;return(s=this._getStyleDeclaration(e,t)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,a=this._getWidthOfCharSpacing(),c=this.offsets[t];for(let u=0,h=this._textLines.length;u<h;u++){const d=this.getHeightOfLine(u);if(!this[t]&&!this.styleHas(t,u)){n+=d;continue}const p=this._textLines[u],g=d/this.lineHeight,y=this._getLineLeftOffset(u);let w,_,S=0,T=0,k=this.getValueOfPropertyAt(u,0,t),I=this.getValueOfPropertyAt(u,0,Mt);const A=n+g*(1-this._fontSizeFraction);let D=this.getHeightOfChar(u,0),L=this.getValueOfPropertyAt(u,0,"deltaY");for(let F=0,Y=p.length;F<Y;F++){const W=this.__charBounds[u][F];w=this.getValueOfPropertyAt(u,F,t),_=this.getValueOfPropertyAt(u,F,Mt);const q=this.getHeightOfChar(u,F),U=this.getValueOfPropertyAt(u,F,"deltaY");if(i&&w&&_)e.save(),e.fillStyle=I,e.translate(W.renderLeft,W.renderTop),e.rotate(W.angle),e.fillRect(-W.kernedWidth/2,c*q+U,W.kernedWidth,this.fontSize/15),e.restore();else if((w!==k||_!==I||q!==D||U!==L)&&T>0){let X=s+y+S;this.direction==="rtl"&&(X=this.width-X-T),k&&I&&(e.fillStyle=I,e.fillRect(X,A+c*D+L,T,this.fontSize/15)),S=W.left,T=W.width,k=w,I=_,D=q,L=U}else T+=W.kernedWidth}let z=s+y+S;this.direction==="rtl"&&(z=this.width-z-T),e.fillStyle=_,w&&_&&e.fillRect(z,A+c*D+L,T-a,this.fontSize/15),n+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const a=e.includes("'")||e.includes('"')||e.includes(",")||Kt.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),a].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return ou(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),s=[`
`];let i=[];for(let a=0;a<t.length;a++)n[a]=this.graphemeSplit(t[a]),i=i.concat(n[a],s);return i.pop(),{_unwrappedLines:n,lines:t,graphemeText:i,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject([...$x,...e])),{},{styles:yx(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let s=!1,i=!1;if(typeof e=="object")for(const a in e)a==="path"&&this.setPathInfo(),s=s||n.includes(a),i=i||a==="path";else s=n.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const s=Xn(e,Kt.ATTRIBUTE_NAMES,n),i=R(R({},t),s),{textAnchor:a=Ue,textDecoration:c="",dx:u=0,dy:h=0,top:d=0,left:p=0,fontSize:g=up,strokeWidth:y=1}=i,w=ot(i,K8),_=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),R({left:p+u,top:d+h,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:g},w)),S=_.getScaledHeight()/_.height,T=((_.height+_.strokeWidth)*_.lineHeight-_.height)*S,k=_.getScaledHeight()+T;let I=0;return a===Ee&&(I=_.getScaledWidth()/2),a===wt&&(I=_.getScaledWidth()),_.set({left:_.left-I,top:_.top-(k-_.fontSize*(.07+_._fontSizeFraction))/_.lineHeight,strokeWidth:y}),_}static fromObject(e){return this._fromObject(R(R({},e),{},{styles:bx(e.styles||{},e.text)}),{extraParam:"text"})}}j(Kt,"textLayoutProperties",Ux),j(Kt,"cacheProperties",[...Yn,...$x]),j(Kt,"ownDefaults",X8),j(Kt,"type","Text"),j(Kt,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),j(Kt,"ATTRIBUTE_NAMES",_s.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),fx(Kt,[class extends Xw{_toSVG(){const r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:t}=r;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(q8,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(r,e){const t=[],n=[];let s,i=r;this.backgroundColor&&n.push(...Zh(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let a=0,c=this._textLines.length;a<c;a++)s=this._getLineLeftOffset(a),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(n,a,e+s,i),this._setSVGTextLineText(t,a,e+s,i),i+=this.getHeightOfLine(a);return{textSpans:t,textBgRects:n}}_createTextCharSpan(r,e,t,n){const s=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(G8)),i=s?'style="'.concat(s,'"'):"",a=e.deltaY,c=a?' dy="'.concat(it(a,Ne.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(it(t,Ne.NUM_FRACTION_DIGITS),'" y="').concat(it(n,Ne.NUM_FRACTION_DIGITS),'" ').concat(c).concat(i,">").concat(vx(r),"</tspan>")}_setSVGTextLineText(r,e,t,n){const s=this.getHeightOfLine(e),i=this.textAlign.includes(fn),a=this._textLines[e];let c,u,h,d,p,g="",y=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let w=0,_=a.length-1;w<=_;w++)p=w===_||this.charSpacing,g+=a[w],h=this.__charBounds[e][w],y===0?(t+=h.kernedWidth-h.width,y+=h.width):y+=h.kernedWidth,i&&!p&&this._reSpaceAndTab.test(a[w])&&(p=!0),p||(c=c||this.getCompleteStyleDeclaration(e,w),u=this.getCompleteStyleDeclaration(e,w+1),p=au(c,u,!0)),p&&(d=this._getStyleDeclaration(e,w),r.push(this._createTextCharSpan(g,d,t,n)),g="",c=u,this.direction==="rtl"?t-=y:t+=y,y=0)}_setSVGTextLineBg(r,e,t,n){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let a,c=0,u=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let d=0;d<s.length;d++){const{left:p,width:g,kernedWidth:y}=this.__charBounds[e][d];a=this.getValueOfPropertyAt(e,d,"textBackgroundColor"),a!==h?(h&&r.push(...Zh(h,t+u,n,c,i)),u=p,c=g,h=a):c+=y}a&&r.push(...Zh(h,t+u,n,c,i))}_getSVGLineTopOffset(r){let e,t=0;for(e=0;e<r;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," white-space: pre;")}getSvgSpanStyles(r,e){const{fontFamily:t,strokeWidth:n,stroke:s,fill:i,fontSize:a,fontStyle:c,fontWeight:u,deltaY:h}=r,d=this.getSvgTextDecoration(r);return[s?sa(fr,s):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",a?"font-size: ".concat(a,"px; "):"",c?"font-style: ".concat(c,"; "):"",u?"font-weight: ".concat(u,"; "):"",d&&"text-decoration: ".concat(d,"; "),i?sa(Mt,i):"",h?"baseline-shift: ".concat(-h,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(e=>r[e.replace("-","")]).join(" ")}}]),ne.setClass(Kt),ne.setSVGClass(Kt);class Z8{constructor(e){j(this,"target",void 0),j(this,"__mouseDownInPlace",!1),j(this,"__dragStartFired",!1),j(this,"__isDraggingOver",!1),j(this,"__dragStartSelection",void 0),j(this,"__dragImageDisposer",void 0),j(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:s,selectionEnd:i}=t;const a=this.target,c=a.canvas,u=new B(a.flipX?-1:1,a.flipY?-1:1),h=a._getCursorBoundaries(s),d=new B(h.left+h.leftOffset,h.top+h.topOffset).multiply(u).transform(a.calcTransformMatrix()),p=c.getScenePoint(e).subtract(d),g=a.getCanvasRetinaScaling(),y=a.getBoundingRect(),w=d.subtract(new B(y.left,y.top)),_=c.viewportTransform,S=w.add(p).transform(_,!0),T=a.backgroundColor,k=kp(a.styles);a.backgroundColor="";const I={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};a.setSelectionStyles(I,0,s),a.setSelectionStyles(I,i,a.text.length),a.dirty=!0;const A=a.toCanvasElement({enableRetinaScaling:c.enableRetinaScaling,viewportTransform:!0});a.backgroundColor=T,a.styles=k,a.dirty=!0,_l(A,{position:"fixed",left:"".concat(-A.width,"px"),border:dr,width:"".concat(A.width/g,"px"),height:"".concat(A.height/g,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{A.remove()},Jr(e.target||this.target.hiddenTextarea).body.appendChild(A),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(A,S.x,S.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(s.selectionStart,s.selectionEnd).join(""),a=R({text:t.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,a)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let i=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(i&&!s){const a=this.target,c=a.canvas;let u=a.getSelectionStartFromPointer(n);const{styles:h}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},d=i[Math.max(0,i.length-1)],p=0;if(this.__dragStartSelection){const g=this.__dragStartSelection.selectionStart,y=this.__dragStartSelection.selectionEnd;u>g&&u<=y?u=g:u>y&&(u-=y-g),a.removeChars(g,y),delete this.__dragStartSelection}a._reNewline.test(d)&&(a._reNewline.test(a._text[u])||u===a._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=a,a.insertChars(i,h,u),c.setActiveObject(a),a.enterEditing(n),a.selectionStart=Math.min(u+p,a._text.length),a.selectionEnd=Math.min(a.selectionStart+i.length,a._text.length),a.hiddenTextarea.value=a.text,a._updateTextarea(),a.hiddenTextarea.focus(),a.fire(hl,{index:u+p,action:"drop"}),c.fire("text:changed",{target:a}),c.contextTopDirty=!0,c.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,i=this.target.canvas,{selectionStart:a,selectionEnd:c}=this.__dragStartSelection,u=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||dr;u===dr?(s.selectionStart=a,s.selectionEnd=c,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),u==="move"&&(s.removeChars(a,c),s.selectionStart=s.selectionEnd=a,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(hl,{index:a,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Y0=/[ \n\.,;!\?\-]/;class J8 extends Kt{constructor(){super(...arguments),j(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:s,onComplete:i}=e;return Cp({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:a=>{this._currentCursorOpacity=a,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(t===-1||!hp.test(n[e-1]))?e-1:e,i=n[s];for(;s>0&&s<n.length&&!Y0.test(i);)s+=t,i=n[s];return t===-1&&Y0.test(i)&&s++,s}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Jr(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==i||s!==n&&i!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const s=n.slice(0,e),i=this.graphemeSplit(s).length;if(e===t)return{selectionStart:i,selectionEnd:i};const a=n.slice(e,t);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(a).length}}fromGraphemeToStringSelection(e,t,n){const s=n.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex,a=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,c=t.leftOffset,u=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,p=h.height/u,g=d-a,y=p-a,w=new B(t.left+c,t.top+t.topOffset+a).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new B(h.clientWidth/d,h.clientHeight/p));return w.x<0&&(w.x=0),w.x>g&&(w.x=g),w.y<0&&(w.y=0),w.y>y&&(w.y=y),w.x+=this.canvas._offset.left,w.y+=this.canvas._offset.top,{left:"".concat(w.x,"px"),top:"".concat(w.y,"px"),fontSize:"".concat(a,"px"),charHeight:a}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(dl),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:a}=this.get2DCursorLocation(t,!0);if(n!==i){if(this.styles[n])for(let c=s;c<this._unwrappedTextLines[n].length;c++)delete this.styles[n][c];if(this.styles[i])for(let c=a;c<this._unwrappedTextLines[i].length;c++){const u=this.styles[i][c];u&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+c-a]=u)}for(let c=n+1;c<=i;c++)delete this.styles[c];this.shiftLineStyles(i,n-i)}else if(this.styles[n]){const c=this.styles[n],u=a-s;for(let h=s;h<a;h++)delete c[h];for(const h in this.styles[n]){const d=parseInt(h,10);d>=a&&(c[d-u]=c[h],delete c[h])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+t]=n[i],n[i-t]||delete this.styles[i])}}insertNewlineStyleObject(e,t,n,s){const i={},a=this._unwrappedTextLines[e].length,c=a===t;let u=!1;n||(n=1),this.shiftLineStyles(e,n);const h=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const p in this.styles[e]){const g=parseInt(p,10);g>=t&&(u=!0,i[g-t]=this.styles[e][p],c&&t===0||delete this.styles[e][p])}let d=!1;for(u&&!c&&(this.styles[e+n]=i,d=!0),(d||a>t)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:R({},s[n-1])}:h?this.styles[e+n]={0:R({},h)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,s){this.styles||(this.styles={});const i=this.styles[e],a=i?R({},i):{};n||(n=1);for(const u in a){const h=parseInt(u,10);h>=t&&(i[h+n]=a[h],a[h-n]||delete i[h])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=R({},s[n]));return}if(!i)return;const c=i[t?t-1:1];for(;c&&n--;)this.styles[e][t+n]=R({},c)}insertNewStyleBlock(e,t,n){const s=this.get2DCursorLocation(t,!0),i=[0];let a,c=0;for(let u=0;u<e.length;u++)e[u]===`
`?(c++,i[c]=0):i[c]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),c&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],c),a=1;a<c;a++)i[a]>0?this.insertCharStyleObject(s.lineIndex+a,0,i[a],n):n&&this.styles[s.lineIndex+a]&&n[0]&&(this.styles[s.lineIndex+a][0]=n[0]),n=n&&n.slice(i[a]+1);i[a]>0&&this.insertCharStyleObject(s.lineIndex+a,0,i[a],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,n,t),this._text=[...this._text.slice(0,n),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Ue:this._selectionDirection===wt&&(this._selectionDirection=Ue,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===wt?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=wt:this._selectionDirection===Ue&&(this._selectionDirection=wt,this.selectionStart=t),this.selectionEnd=n)}}class Q8 extends J8{initHiddenTextarea(){const e=this.canvas&&Jr(this.canvas.getElement())||so(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(a=>{let[c,u]=a;return t.setAttribute(c,u)});const{top:n,left:s,fontSize:i}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(a=>{let[c,u]=a;return t.addEventListener(c,this[u].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const n=()=>{this.updateFromTextArea(),this.fire(hl),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void n();const s=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,i=this._text.length,a=s.length,c=this.selectionStart,u=this.selectionEnd,h=c!==u;let d,p,g,y,w=a-i;const _=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),S=c>_.selectionStart;h?(p=this._text.slice(c,u),w+=u-c):a<i&&(p=S?this._text.slice(u+w,u):this._text.slice(c,c-w));const T=s.slice(_.selectionEnd-w,_.selectionEnd);if(p&&p.length&&(T.length&&(d=this.getSelectionStyles(c,c+1,!1),d=T.map(()=>d[0])),h?(g=c,y=u):S?(g=u-p.length,y=u):(g=u,y=u+p.length),this.removeStyleFromTo(g,y)),T.length){const{copyPasteData:k}=wn();t&&T.join("")===k.copiedText&&!Ne.disableStyleCopyPaste&&(d=k.copiedTextStyle),this.insertNewStyleBlock(T,c,d)}n()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:s}=t;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=wn();e.copiedText=this.getSelectedText(),Ne.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,s=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],s+=n.left+n.width),s}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const a=s.charIndex,c=this._getWidthBeforeCursor(i,a),u=this._getIndexOnLine(i+1,c);return this._textLines[i].slice(a).length+u+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-n;const a=s.charIndex,c=this._getWidthBeforeCursor(i,a),u=this._getIndexOnLine(i-1,c),h=this._textLines[i].slice(0,a),d=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+u-h.length+(1-d)}_getIndexOnLine(e,t){const n=this._textLines[e];let s,i,a=this._getLineLeftOffset(e),c=0;for(let u=0,h=n.length;u<h;u++)if(s=this.__charBounds[e][u].width,a+=s,a>t){i=!0;const d=a-s,p=a,g=Math.abs(d-t);c=Math.abs(p-t)<g?u:u-1;break}return i||(c=n.length-1),c}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===wt);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=Gs(0,this.selectionStart,s),this.selectionEnd=Gs(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Ue?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Ue,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===wt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Ue,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Ue&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=wt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=wt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Qh=r=>!!r.button;class ej extends Q8{constructor(){super(...arguments),j(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new Z8(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),Wd(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!Qh(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!Qh(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:n}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Qh(t)||s||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Er(this.calcTransformMatrix())).add(new B(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,i=0;for(let h=0;h<this._textLines.length&&n<=t.y;h++)n+=this.getHeightOfLine(h),i=h,h>0&&(s+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let a=Math.abs(this._getLineLeftOffset(i));const c=this._textLines[i].length,u=this.__charBounds[i];for(let h=0;h<c;h++){const d=a+u[h].kernedWidth;if(t.x<=d){Math.abs(t.x-d)<=Math.abs(t.x-a)&&s++;break}a=d,s++}return Math.min(this.flipX?c-s:s,this._text.length)}}const Ac="moveCursorUp",Oc="moveCursorDown",Mc="moveCursorLeft",Pc="moveCursorRight",Dc="exitEditing",tj=R({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Dc,27:Dc,33:Ac,34:Oc,35:Pc,36:Mc,37:Mc,38:Ac,39:Pc,40:Oc},keysMapRtl:{9:Dc,27:Dc,33:Ac,34:Oc,35:Mc,36:Pc,37:Pc,38:Ac,39:Mc,40:Oc},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Vn extends ej{static getDefaults(){return R(R({},super.getDefaults()),Vn.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,R(R({},Vn.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Qd&&this.canvas.textEditingManager.remove(this),t instanceof Qd&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,t);return{left:n,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let h=0;h<i;h++)t+=this.getHeightOfLine(h);const a=this._getLineLeftOffset(i),c=this.__charBounds[i][s];c&&(n=c.left),this.charSpacing!==0&&s===this._textLines[i].length&&(n-=this._getWidthOfCharSpacing());const u={top:t,left:a+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===wt||this.textAlign===fn||this.textAlign===Xo?u.left*=-1:this.textAlign===Ue||this.textAlign===Sl?u.left=a-(n>0?n:0):this.textAlign!==Ee&&this.textAlign!==Go||(u.left=a-(n>0?n:0))),u}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,a=this.getValueOfPropertyAt(s,i,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/c,h=this.getValueOfPropertyAt(s,i,"deltaY"),d=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-a*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-u/2,top:d+t.top+h,width:u,height:a}}_renderCursor(e,t,n){const{color:s,opacity:i,left:a,top:c,width:u,height:h}=this.getCursorRenderingData(n,t);e.fillStyle=s,e.globalAlpha=i,e.fillRect(a,c,u,h)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const s=t.selectionStart,i=t.selectionEnd,a=this.textAlign.includes(fn),c=this.get2DCursorLocation(s),u=this.get2DCursorLocation(i),h=c.lineIndex,d=u.lineIndex,p=c.charIndex<0?0:c.charIndex,g=u.charIndex<0?0:u.charIndex;for(let y=h;y<=d;y++){const w=this._getLineLeftOffset(y)||0;let _=this.getHeightOfLine(y),S=0,T=0,k=0;if(y===h&&(T=this.__charBounds[h][p].left),y>=h&&y<d)k=a&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===d)if(g===0)k=this.__charBounds[d][g].left;else{const z=this._getWidthOfCharSpacing();k=this.__charBounds[d][g-1].left+this.__charBounds[d][g-1].width-z}S=_,(this.lineHeight<1||y===d&&this.lineHeight>1)&&(_/=this.lineHeight);let I=n.left+w+T,A=_,D=0;const L=k-T;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",A=1,D=_):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===wt||this.textAlign===fn||this.textAlign===Xo?I=this.width-I-L:this.textAlign===Ue||this.textAlign===Sl?I=n.left+w-k:this.textAlign!==Ee&&this.textAlign!==Go||(I=n.left+w-k)),e.fillRect(I,n.top+n.topOffset+D,L,A),n.topOffset+=S}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Mt)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}j(Vn,"ownDefaults",tj),j(Vn,"type","IText"),ne.setClass(Vn),ne.setClass(Vn,"i-text");class Us extends Vn{static getDefaults(){return R(R({},super.getDefaults()),Us.ownDefaults)}constructor(e,t){super(e,R(R({},Us.ownDefaults),t))}static createControls(){return{controls:dx()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(fn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,s=0;const i={};for(let a=0;a<e.graphemeLines.length;a++)e.graphemeText[s]===`
`&&a>0?(n=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&a>0&&(n++,s++),i[a]={line:t,offset:n},s+=e.graphemeLines[a].length,n+=e.graphemeLines[a].length;return i}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,s=e+1,i=!1;const a=this._styleMap[e],c=this._styleMap[e+1];a&&(e=a.line,n=a.offset),c&&(s=c.line,i=s===e,t=c.offset);const u=e===void 0?this.styles:{line:this.styles[e]};for(const h in u)for(const d in u[h]){const p=parseInt(d,10);if(p>=n&&(!i||p<t))for(const g in u[h][d])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<n.wordsData.length;i++)s.push(...this._wrapLine(i,t,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let s=0;return{wordsData:e.map((i,a)=>{let c=0;const u=t?this.graphemeSplit(i):this.wordSplit(i);return u.length===0?[{word:[],width:0}]:u.map(h=>{const d=t?[h]:this.graphemeSplit(h),p=this._measureWord(d,a,c);return s=Math.max(p,s),c+=d.length+n.length,{word:d,width:p}})}),largestWordWidth:s}}_measureWord(e,t){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let a=0,c=e.length;a<c;a++)i+=this._getGraphemeBox(e[a],t,a+s,n,!0).kernedWidth,n=e[a];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:s,wordsData:i}=n,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,h=[],d=u?"":" ";let p=0,g=[],y=0,w=0,_=!0;t-=a;const S=Math.max(t,s,this.dynamicMinWidth),T=i[e];let k;for(y=0,k=0;k<T.length;k++){const{word:I,width:A}=T[k];y+=I.length,p+=w+A-c,p>S&&!_?(h.push(g),g=[],p=A,_=!0):p+=c,_||u||g.push(d),g=g.concat(I),w=u?0:this._measureWord([d],e,y),y++,_=!1}return k&&h.push(g),s+a>this.dynamicMinWidth&&(this.dynamicMinWidth=s-c+a),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),s=new Array(n.length);for(let i=0;i<n.length;i++)s[i]=n[i].join("");return t.lines=s,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}j(Us,"type","Textbox"),j(Us,"textLayoutProperties",[...Vn.textLayoutProperties,"width"]),j(Us,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ne.setClass(Us);class X0 extends cu{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:s,group:i}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:a,height:c}=yn(xx(n,s)),u=new B(a,c);if(s.absolutePositioned)return{center:Bn(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:u};{const h=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:d=new B,correction:p=new B}=this.calcBoundingBox(t,e)||{};return{center:d.add(h),correction:p.subtract(h),size:u}}return{center:n.getRelativeCenterPoint().add(h),size:u}}}}j(X0,"type","clip-path"),ne.setClass(X0);class G0 extends cu{getInitialSize(e,t){let{target:n}=e,{size:s}=t;return new B(n.width||s.x,n.height||s.y)}}j(G0,"type","fixed"),ne.setClass(G0);class rj extends oa{subscribeTargets(e){const t=e.target;e.targets.reduce((n,s)=>(s.parent&&n.add(s.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!n.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})})}}class mn extends zr{static getDefaults(){return R(R({},super.getDefaults()),mn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,mn.ownDefaults),this.setOptions(t);const{left:n,top:s,layoutManager:i}=t;this.groupInit(e,{left:n,top:s,layoutManager:i??new rj})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(s=>{const i=this._objects.findIndex(c=>c.isInFrontOf(s)),a=i===-1?this.size():i;this.insertAt(a,s)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(us("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach(s=>{const{parent:i}=s;i&&n.add(i)}),e===Ap?n.forEach(s=>{s._onAfterObjectsChange(bl,t)}):n.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=R(R({hasControls:!1},n),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,t),e.restore()}}j(mn,"type","ActiveSelection"),j(mn,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ne.setClass(mn),ne.setClass(mn,"activeSelection");class nj{constructor(){j(this,"resources",{})}applyFilters(e,t,n,s,i){const a=i.getContext("2d");if(!a)return;a.drawImage(t,0,0,n,s);const c={sourceWidth:n,sourceHeight:s,imageData:a.getImageData(0,0,n,s),originalEl:t,originalImageData:a.getImageData(0,0,n,s),canvasEl:i,ctx:a,filterBackend:this};e.forEach(h=>{h.applyTo(c)});const{imageData:u}=c;return u.width===n&&u.height===s||(i.width=u.width,i.height=u.height),a.putImageData(u,0,0),c}}class Xx{constructor(){let{tileSize:e=Ne.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),j(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=sn({width:e,height:t}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,t,n,s,i,a){const c=this.gl,u=i.getContext("2d");if(!c||!u)return;let h;a&&(h=this.getCachedTexture(a,t));const d={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:c,sourceTexture:this.createTexture(c,n,s,h?void 0:t),targetTexture:this.createTexture(c,n,s),originalTexture:h||this.createTexture(c,n,s,h?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},p=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,p),e.forEach(g=>{g&&g.applyTo(d)}),function(g){const y=g.targetCanvas,w=y.width,_=y.height,S=g.destinationWidth,T=g.destinationHeight;w===S&&_===T||(y.width=S,y.height=T)}(d),this.copyGLTo2D(c,d),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(d.sourceTexture),c.deleteTexture(d.targetTexture),c.deleteFramebuffer(p),u.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,s,i){const{NEAREST:a,TEXTURE_2D:c,RGBA:u,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:g,TEXTURE_WRAP_S:y,TEXTURE_WRAP_T:w}=e,_=e.createTexture();return e.bindTexture(c,_),e.texParameteri(c,p,i||a),e.texParameteri(c,g,i||a),e.texParameteri(c,y,d),e.texParameteri(c,w,d),s?e.texImage2D(c,0,u,u,h,s):e.texImage2D(c,0,u,t,n,0,u,h,null),_}getCachedTexture(e,t,n){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,t.width,t.height,t,n);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,s=t.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const a=n.height-s.height;i.drawImage(n,0,a,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),s=t.destinationWidth,i=t.destinationHeight,a=s*i*4;if(!n)return;const c=new Uint8Array(this.imageBuffer,0,a),u=new Uint8ClampedArray(this.imageBuffer,0,a);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,c);const h=new ImageData(u,s,i);n.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),i=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),i&&(t.vendor=i.toLowerCase())}return this.gpuInfo=t,t}}let ed;function sj(){const{WebGLProbe:r}=wn();return r.queryWebGL(Wr()),Ne.enableGLFiltering&&r.isSupported(Ne.textureSize)?new Xx({tileSize:Ne.textureSize}):new nj}function td(){return!ed&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(ed=sj()),ed}const ij=["filters","resizeFilter","src","crossOrigin","type"],Gx=["cropX","cropY"];class Vr extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Vr.ownDefaults)}constructor(e,t){super(),j(this,"_lastScaleX",1),j(this,"_lastScaleY",1),j(this,"_filterScalingX",1),j(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Vr.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(ds()),this.setElement(typeof e=="string"?(this.canvas&&Jr(this.canvas.getElement())||so()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(Vr.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=td(!1);t instanceof Xx&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&wn().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),R(R({},super.toObject([...Gx,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,s=-this.height/2;let i=[],a=[],c="",u="";if(!t)return[];if(this.hasCrop()){const h=ds();i.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(u).concat(c,`></image>
`)),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,a=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=h}return i=this.paintFirst!==Mt?i.concat(a,e):i.concat(e,a),i}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yo(e,{crossOrigin:t,signal:n}).then(s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,i=n.y,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&i>t)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const c=sn(a),{width:u,height:h}=a;this._element=c,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,td().applyFilters([e],a,u,h,this._element),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const i=sn({width:n,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);td().applyFilters(e,this._originalElement,n,s,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,s=this._filterScalingY,i=this.width,a=this.height,c=Math.max(this.cropX,0),u=Math.max(this.cropY,0),h=t.naturalWidth||t.width,d=t.naturalHeight||t.height,p=c*n,g=u*s,y=Math.min(i*n,h-p),w=Math.min(a*s,d-g),_=-i/2,S=-a/2,T=Math.min(i,h/n-c),k=Math.min(a,d/s-u);t&&e.drawImage(t,p,g,y,w,_,S,T,k)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=jw(this.preserveAspectRatio||""),t=this.width,n=this.height,s={width:t,height:n};let i,a=this._element.width,c=this._element.height,u=1,h=1,d=0,p=0,g=0,y=0;return!e||e.alignX===dr&&e.alignY===dr?(u=t/a,h=n/c):(e.meetOrSlice==="meet"&&(u=h=Sx(this._element,s),i=(t-a*u)/2,e.alignX==="Min"&&(d=-i),e.alignX==="Max"&&(d=i),i=(n-c*h)/2,e.alignY==="Min"&&(p=-i),e.alignY==="Max"&&(p=i)),e.meetOrSlice==="slice"&&(u=h=Cx(this._element,s),i=a-t/u,e.alignX==="Mid"&&(g=i/2),e.alignX==="Max"&&(g=i),i=c-n/h,e.alignY==="Mid"&&(y=i/2),e.alignY==="Max"&&(y=i),a=t/u,c=n/h)),{width:a,height:c,scaleX:u,scaleY:h,offsetLeft:d,offsetTop:p,cropX:g,cropY:y}}static fromObject(e,t){let{filters:n,resizeFilter:s,src:i,crossOrigin:a,type:c}=e,u=ot(e,ij);return Promise.all([Yo(i,R(R({},t),{},{crossOrigin:a})),n&&zi(n,t),s&&zi([s],t),Sa(u,t)]).then(h=>{let[d,p=[],[g]=[],y={}]=h;return new this(d,R(R({},u),{},{src:i,filters:p,resizeFilter:g},y))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return Yo(e,{crossOrigin:t,signal:n}).then(i=>new this(i,s))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=Xn(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"],t,s).catch(i=>(us("log","Unable to parse Image",i),null))}}j(Vr,"type","Image"),j(Vr,"cacheProperties",[...Yn,...Gx]),j(Vr,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),j(Vr,"CSS_CANVAS","canvas-img"),j(Vr,"ATTRIBUTE_NAMES",[..._s,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),ne.setClass(Vr),ne.setSVGClass(Vr);nu(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const qx=Ew,q0=r=>function(e,t,n){const{points:s,pathOffset:i}=n;return new B(s[r]).subtract(i).transform(mt(n.getViewportTransform(),n.calcTransformMatrix()))},Kx=(r,e,t,n)=>{const{target:s,pointIndex:i}=e,a=s,c=Bn(new B(t,n),void 0,a.calcOwnMatrix());return a.points[i]=c.add(a.pathOffset),a.setDimensions(),!0},Zx=(r,e)=>function(t,n,s,i){const a=n.target,c=new B(a.points[(r>0?r:a.points.length)-1]),u=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()),h=e(t,R(R({},n),{},{pointIndex:r}),s,i),d=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()).subtract(u);return a.left-=d.x,a.top-=d.y,h},K0=r=>xs(qx,Zx(r,Kx)),tf=(r,e,t)=>{const{path:n,pathOffset:s}=r,i=n[e];return new B(i[t]-s.x,i[t+1]-s.y).transform(mt(r.getViewportTransform(),r.calcTransformMatrix()))};function oj(r,e,t){const{commandIndex:n,pointIndex:s}=this;return tf(t,n,s)}function aj(r,e,t,n){const{target:s}=e,{commandIndex:i,pointIndex:a}=this,c=((u,h,d,p,g)=>{const{path:y,pathOffset:w}=u,_=y[(p>0?p:y.length)-1],S=new B(_[g],_[g+1]),T=S.subtract(w).transform(u.calcOwnMatrix()),k=Bn(new B(h,d),void 0,u.calcOwnMatrix());y[p][g]=k.x+w.x,y[p][g+1]=k.y+w.y,u.setDimensions();const I=S.subtract(u.pathOffset).transform(u.calcOwnMatrix()).subtract(T);return u.left-=I.x,u.top-=I.y,u.set("dirty",!0),!0})(s,t,n,i,a);return bp(this.actionName,R(R({},wp(r,e,t,n)),{},{commandIndex:i,pointIndex:a})),c}class Jx extends ut{constructor(e){super(e)}render(e,t,n,s,i){const a=R(R({},s),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,a,i)}}class cj extends Jx{constructor(e){super(e)}render(e,t,n,s,i){const{path:a}=i,{commandIndex:c,pointIndex:u,connectToCommandIndex:h,connectToPointIndex:d}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);const[p]=a[c],g=tf(i,h,d);if(p==="Q"){const y=tf(i,c,u+2);e.moveTo(y.x,y.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(g.x,g.y),e.stroke(),e.restore(),super.render(e,t,n,s,i)}}const Rc=(r,e,t,n,s,i)=>new(t?cj:Jx)(R(R({commandIndex:r,pointIndex:e,actionName:"modifyPath",positionHandler:oj,actionHandler:aj,connectToCommandIndex:s,connectToPointIndex:i},n),t?n.controlPointStyle:n.pointStyle));var Ut=Object.freeze({__proto__:null,changeWidth:Yd,createObjectDefaultControls:Ep,createPathControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};let n="M";return r.path.forEach((s,i)=>{const a=s[0];switch(a!=="Z"&&(t["c_".concat(i,"_").concat(a)]=Rc(i,s.length-2,!1,e)),a){case"C":t["c_".concat(i,"_C_CP_1")]=Rc(i,1,!0,e,i-1,(c=>c==="C"?5:c==="Q"?3:1)(n)),t["c_".concat(i,"_C_CP_2")]=Rc(i,3,!0,e,i,5);break;case"Q":t["c_".concat(i,"_Q_CP_1")]=Rc(i,1,!0,e,i,3)}n=a}),t},createPolyActionHandler:K0,createPolyControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};for(let n=0;n<(typeof r=="number"?r:r.points.length);n++)t["p".concat(n)]=new ut(R({actionName:qx,positionHandler:q0(n),actionHandler:K0(n)},e));return t},createPolyPositionHandler:q0,createResizeControls:hx,createTextboxDefaultControls:dx,dragHandler:Yw,factoryPolyActionHandler:Zx,getLocalPoint:ru,polyActionHandler:Kx,renderCircleControl:Qw,renderSquareControl:ex,rotationStyleHandler:tx,rotationWithSnapping:rx,scaleCursorStyleHandler:Pi,scaleOrSkewActionName:Bo,scaleSkewCursorStyleHandler:Ws,scalingEqually:Vo,scalingX:ix,scalingXOrSkewingY:Xd,scalingY:ox,scalingYOrSkewingX:Gd,skewCursorStyleHandler:ax,skewHandlerX:lx,skewHandlerY:ux,wrapWithFireEvent:xs,wrapWithFixedAnchor:ai});const uu=r=>r.webgl!==void 0,Mp="precision highp float",lj=`
    `.concat(Mp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),uj=["type"],hj=["type"],dj=new RegExp(Mp,"g");class Pt{get type(){return this.constructor.type}constructor(){let e=ot(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},uj);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return lj}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=wn();s!=="highp"&&(t=t.replace(dj,Mp.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER),c=e.createProgram();if(!i||!a||!c)throw new gn("Vertex, fragment shader or program creation error");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new gn("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new gn("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.attachShader(c,i),e.attachShader(c,a),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new gn('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(c)));const u=this.getUniformLocations(e,c)||{};return u.uStepW=e.getUniformLocation(c,"uStepW"),u.uStepH=e.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:this.getAttributeLocations(e,c),uniformLocations:u}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,s={};for(let i=0;i<n.length;i++)s[n[i]]=e.getUniformLocation(t,n[i]);return s}sendAttributeData(e,t,n){const s=t.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){uu(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,s=sn({width:t,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return R({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(ot(e,hj))}}j(Pt,"type","BaseFilter"),j(Pt,"uniformLocations",[]);const fj={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class jc extends Pt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(fj[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new Xe(this.color).getSource(),s=this.alpha,i=n[0]*s,a=n[1]*s,c=n[2]*s,u=1-s;for(let h=0;h<t.length;h+=4){const d=t[h],p=t[h+1],g=t[h+2];let y,w,_;switch(this.mode){case"multiply":y=d*i/255,w=p*a/255,_=g*c/255;break;case"screen":y=255-(255-d)*(255-i)/255,w=255-(255-p)*(255-a)/255,_=255-(255-g)*(255-c)/255;break;case"add":y=d+i,w=p+a,_=g+c;break;case"difference":y=Math.abs(d-i),w=Math.abs(p-a),_=Math.abs(g-c);break;case"subtract":y=d-i,w=p-a,_=g-c;break;case"darken":y=Math.min(d,i),w=Math.min(p,a),_=Math.min(g,c);break;case"lighten":y=Math.max(d,i),w=Math.max(p,a),_=Math.max(g,c);break;case"overlay":y=i<128?2*d*i/255:255-2*(255-d)*(255-i)/255,w=a<128?2*p*a/255:255-2*(255-p)*(255-a)/255,_=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":y=i+d-2*i*d/255,w=a+p-2*a*p/255,_=c+g-2*c*g/255;break;case"tint":y=i+d*u,w=a+p*u,_=c+g*u}t[h]=y,t[h+1]=w,t[h+2]=_}}sendUniformData(e,t){const n=new Xe(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}j(jc,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),j(jc,"type","BlendColor"),j(jc,"uniformLocations",["uColor"]),ne.setClass(jc);const pj={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},gj=["type","image"];class Lc extends Pt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return pj[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:s},filterBackend:{resources:i}}=e;const a=this.image;i.blendImage||(i.blendImage=Wr());const c=i.blendImage,u=c.getContext("2d");c.width!==n||c.height!==s?(c.width=n,c.height=s):u.clearRect(0,0,n,s),u.setTransform(a.scaleX,0,0,a.scaleY,a.left,a.top),u.drawImage(a.getElement(),0,0,n,s);const h=u.getImageData(0,0,n,s).data;for(let d=0;d<t.length;d+=4){const p=t[d],g=t[d+1],y=t[d+2],w=t[d+3],_=h[d],S=h[d+1],T=h[d+2],k=h[d+3];switch(this.mode){case"multiply":t[d]=p*_/255,t[d+1]=g*S/255,t[d+2]=y*T/255,t[d+3]=w*k/255;break;case"mask":t[d+3]=k}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return R(R({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:s}=e,i=ot(e,gj);return Vr.fromObject(s,t).then(a=>new this(R(R({},i),{},{image:a})))}}j(Lc,"type","BlendImage"),j(Lc,"defaults",{mode:"multiply",alpha:1}),j(Lc,"uniformLocations",["uTransformMatrix","uImage"]),ne.setClass(Lc);class Fc extends Pt{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){uu(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:n,filterBackend:{resources:s}}=e;const{width:i,height:a}=n;s.blurLayer1||(s.blurLayer1=Wr(),s.blurLayer2=Wr());const c=s.blurLayer1,u=s.blurLayer2;c.width===i&&c.height===a||(u.width=c.width=i,u.height=c.height=a);const h=c.getContext("2d"),d=u.getContext("2d"),p=15,g=.06*this.blur*.5;let y,w,_,S;for(h.putImageData(n,0,0),d.clearRect(0,0,i,a),S=-15;S<=p;S++)y=(Math.random()-.5)/4,w=S/p,_=g*w*i+y,d.globalAlpha=1-Math.abs(w),d.drawImage(c,_,y),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);for(S=-15;S<=p;S++)y=(Math.random()-.5)/4,w=S/p,_=g*w*a+y,d.globalAlpha=1-Math.abs(w),d.drawImage(c,y,_),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);t.drawImage(c,0,0);const T=t.getImageData(0,0,c.width,c.height);return h.globalAlpha=1,h.clearRect(0,0,c.width,c.height),T}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const n=e*this.blur*.12;return this.horizontal?t[0]=n:t[1]=n,t}}j(Fc,"type","Blur"),j(Fc,"defaults",{blur:0}),j(Fc,"uniformLocations",["uDelta"]),ne.setClass(Fc);class Nc extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]+=n,t[s+1]+=n,t[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}j(Nc,"type","Brightness"),j(Nc,"defaults",{brightness:0}),j(Nc,"uniformLocations",["uBrightness"]),ne.setClass(Nc);const Qx={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Ri extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let i=0;i<t.length;i+=4){const a=t[i],c=t[i+1],u=t[i+2];if(t[i]=a*n[0]+c*n[1]+u*n[2]+255*n[4],t[i+1]=a*n[5]+c*n[6]+u*n[7]+255*n[9],t[i+2]=a*n[10]+c*n[11]+u*n[12]+255*n[14],!s){const h=t[i+3];t[i]+=h*n[3],t[i+1]+=h*n[8],t[i+2]+=h*n[13],t[i+3]=a*n[15]+c*n[16]+u*n[17]+h*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,i)}toObject(){return R(R({},super.toObject()),{},{matrix:[...this.matrix]})}}function ci(r,e){var t;const n=(j(t=class extends Ri{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),j(t,"defaults",{colorsOnly:!1,matrix:e}),t);return ne.setClass(n,r),n}j(Ri,"type","ColorMatrix"),j(Ri,"defaults",Qx),j(Ri,"uniformLocations",["uColorMatrix","uConstants"]),ne.setClass(Ri);ci("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);ci("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);ci("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);ci("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);ci("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);ci("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);ci("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Z0 extends Pt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){uu(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>ne.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}}j(Z0,"type","Composed"),ne.setClass(Z0);class Vc extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let i=0;i<t.length;i+=4)t[i]=s*(t[i]-128)+128,t[i+1]=s*(t[i+1]-128)+128,t[i+2]=s*(t[i+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}j(Vc,"type","Contrast"),j(Vc,"defaults",{contrast:0}),j(Vc,"uniformLocations",["uContrast"]),ne.setClass(Vc);const mj={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Bc extends Pt{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return mj[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),a=Math.floor(i/2),c=t.width,u=t.height,h=e.ctx.createImageData(c,u),d=h.data,p=this.opaque?1:0;let g,y,w,_,S,T,k,I,A,D,L,z,F;for(L=0;L<u;L++)for(D=0;D<c;D++){for(S=4*(L*c+D),g=0,y=0,w=0,_=0,F=0;F<i;F++)for(z=0;z<i;z++)k=L+F-a,T=D+z-a,k<0||k>=u||T<0||T>=c||(I=4*(k*c+T),A=s[F*i+z],g+=n[I]*A,y+=n[I+1]*A,w+=n[I+2]*A,p||(_+=n[I+3]*A));d[S]=g,d[S+1]=y,d[S+2]=w,d[S+3]=p?n[S+3]:_}e.imageData=h}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return R(R({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}j(Bc,"type","Convolute"),j(Bc,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),j(Bc,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ne.setClass(Bc);const e_="Gamma";class zc extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,s=1/n[0],i=1/n[1],a=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const c=this.rgbValues;for(let u=0;u<256;u++)c.r[u]=255*Math.pow(u/255,s),c.g[u]=255*Math.pow(u/255,i),c.b[u]=255*Math.pow(u/255,a);for(let u=0;u<t.length;u+=4)t[u]=c.r[t[u]],t[u+1]=c.g[t[u+1]],t[u+2]=c.b[t[u+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:e_,gamma:this.gamma.concat()}}}j(zc,"type",e_),j(zc,"defaults",{gamma:[1,1,1]}),j(zc,"uniformLocations",["uGamma"]),ne.setClass(zc);const vj={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Wc extends Pt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2];switch(this.mode){case"average":n=(i+a+c)/3;break;case"lightness":n=(Math.min(i,a,c)+Math.max(i,a,c))/2;break;case"luminosity":n=.21*i+.72*a+.07*c}t[s+2]=t[s+1]=t[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return vj[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}j(Wc,"type","Grayscale"),j(Wc,"defaults",{mode:"average"}),j(Wc,"uniformLocations",["uMode"]),ne.setClass(Wc);const yj=R(R({},Qx),{},{rotation:0});class rd extends Ri{calculateMatrix(){const e=this.rotation*Math.PI,t=rn(e),n=nn(e),s=1/3,i=Math.sqrt(s)*n,a=1-t;this.matrix=[t+a/3,s*a-i,s*a+i,0,0,s*a+i,t+s*a,s*a-i,0,0,s*a-i,s*a+i,t+s*a,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}j(rd,"type","HueRotation"),j(rd,"defaults",yj),ne.setClass(rd);class Hc extends Pt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}j(Hc,"type","Invert"),j(Hc,"defaults",{alpha:!1,invert:!0}),j(Hc,"uniformLocations",["uInvert","uAlpha"]),ne.setClass(Hc);class Uc extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let s=0;s<t.length;s+=4){const i=(.5-Math.random())*n;t[s]+=i,t[s+1]+=i,t[s+2]+=i}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}j(Uc,"type","Noise"),j(Uc,"defaults",{noise:0}),j(Uc,"uniformLocations",["uNoise","uSeed"]),ne.setClass(Uc);class $c extends Pt{applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let a=0;a<n;a+=this.blocksize){const c=4*i*n+4*a,u=t[c],h=t[c+1],d=t[c+2],p=t[c+3];for(let g=i;g<Math.min(i+this.blocksize,s);g++)for(let y=a;y<Math.min(a+this.blocksize,n);y++){const w=4*g*n+4*y;t[w]=u,t[w+1]=h,t[w+2]=d,t[w+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}j($c,"type","Pixelate"),j($c,"defaults",{blocksize:4}),j($c,"uniformLocations",["uBlocksize"]),ne.setClass($c);class Yc extends Pt{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,s=new Xe(this.color).getSource(),i=[s[0]-n,s[1]-n,s[2]-n],a=[s[0]+n,s[1]+n,s[2]+n];for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],d=t[c+2];u>i[0]&&h>i[1]&&d>i[2]&&u<a[0]&&h<a[1]&&d<a[2]&&(t[c+3]=0)}}sendUniformData(e,t){const n=new Xe(this.color).getSource(),s=this.distance,i=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],a=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(t.uLow,i),e.uniform4fv(t.uHigh,a)}}j(Yc,"type","RemoveColor"),j(Yc,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),j(Yc,"uniformLocations",["uLow","uHigh"]),ne.setClass(Yc);class Xc extends Pt{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let i=1;i<=n;i++)s[i-1]=e(i*t);return s}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){uu(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const i=t.width,a=t.height,c=Math.round(i*n),u=Math.round(a*s);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,a,c,u):this.resizeType==="hermite"?this.hermiteFastResize(e,i,a,c,u):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,a,c,u):this.resizeType==="lanczos"?this.lanczosResize(e,i,a,c,u):new ImageData(c,u),e.imageData=h}sliceByTwo(e,t,n,s,i){const a=e.imageData,c=.5;let u=!1,h=!1,d=t*c,p=n*c;const g=e.filterBackend.resources;let y=0,w=0;const _=t;let S=0;g.sliceByTwo||(g.sliceByTwo=Wr());const T=g.sliceByTwo;(T.width<1.5*t||T.height<n)&&(T.width=1.5*t,T.height=n);const k=T.getContext("2d");for(k.clearRect(0,0,1.5*t,n),k.putImageData(a,0,0),s=Math.floor(s),i=Math.floor(i);!u||!h;)t=d,n=p,s<Math.floor(d*c)?d=Math.floor(d*c):(d=s,u=!0),i<Math.floor(p*c)?p=Math.floor(p*c):(p=i,h=!0),k.drawImage(T,y,w,t,n,_,S,d,p),y=_,w=S,S+=p;return k.getImageData(y,w,s,i)}lanczosResize(e,t,n,s,i){const a=e.imageData.data,c=e.ctx.createImageData(s,i),u=c.data,h=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,p=this.rcpScaleY,g=2/this.rcpScaleX,y=2/this.rcpScaleY,w=Math.ceil(d*this.lanczosLobes/2),_=Math.ceil(p*this.lanczosLobes/2),S={},T={x:0,y:0},k={x:0,y:0};return function I(A){let D,L,z,F,Y,W,q,U,X,te,de;for(T.x=(A+.5)*d,k.x=Math.floor(T.x),D=0;D<i;D++){for(T.y=(D+.5)*p,k.y=Math.floor(T.y),Y=0,W=0,q=0,U=0,X=0,L=k.x-w;L<=k.x+w;L++)if(!(L<0||L>=t)){te=Math.floor(1e3*Math.abs(L-T.x)),S[te]||(S[te]={});for(let J=k.y-_;J<=k.y+_;J++)J<0||J>=n||(de=Math.floor(1e3*Math.abs(J-T.y)),S[te][de]||(S[te][de]=h(Math.sqrt(Math.pow(te*g,2)+Math.pow(de*y,2))/1e3)),z=S[te][de],z>0&&(F=4*(J*t+L),Y+=z,W+=z*a[F],q+=z*a[F+1],U+=z*a[F+2],X+=z*a[F+3]))}F=4*(D*s+A),u[F]=W/Y,u[F+1]=q/Y,u[F+2]=U/Y,u[F+3]=X/Y}return++A<s?I(A):c}(0)}bilinearFiltering(e,t,n,s,i){let a,c,u,h,d,p,g,y,w,_,S,T,k,I=0;const A=this.rcpScaleX,D=this.rcpScaleY,L=4*(t-1),z=e.imageData.data,F=e.ctx.createImageData(s,i),Y=F.data;for(g=0;g<i;g++)for(y=0;y<s;y++)for(d=Math.floor(A*y),p=Math.floor(D*g),w=A*y-d,_=D*g-p,k=4*(p*t+d),S=0;S<4;S++)a=z[k+S],c=z[k+4+S],u=z[k+L+S],h=z[k+L+4+S],T=a*(1-w)*(1-_)+c*w*(1-_)+u*_*(1-w)+h*w*_,Y[I++]=T;return F}hermiteFastResize(e,t,n,s,i){const a=this.rcpScaleX,c=this.rcpScaleY,u=Math.ceil(a/2),h=Math.ceil(c/2),d=e.imageData.data,p=e.ctx.createImageData(s,i),g=p.data;for(let y=0;y<i;y++)for(let w=0;w<s;w++){const _=4*(w+y*s);let S=0,T=0,k=0,I=0,A=0,D=0,L=0;const z=(y+.5)*c;for(let F=Math.floor(y*c);F<(y+1)*c;F++){const Y=Math.abs(z-(F+.5))/h,W=(w+.5)*a,q=Y*Y;for(let U=Math.floor(w*a);U<(w+1)*a;U++){let X=Math.abs(W-(U+.5))/u;const te=Math.sqrt(q+X*X);te>1&&te<-1||(S=2*te*te*te-3*te*te+1,S>0&&(X=4*(U+F*t),L+=S*d[X+3],k+=S,d[X+3]<255&&(S=S*d[X+3]/250),I+=S*d[X],A+=S*d[X+1],D+=S*d[X+2],T+=S))}}g[_]=I/T,g[_+1]=A/T,g[_+2]=D/T,g[_+3]=L/k}return p}}j(Xc,"type","Resize"),j(Xc,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),j(Xc,"uniformLocations",["uDelta","uTaps"]),ne.setClass(Xc);class Gc extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2],u=Math.max(i,a,c);t[s]+=u!==i?(u-i)*n:0,t[s+1]+=u!==a?(u-a)*n:0,t[s+2]+=u!==c?(u-c)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}j(Gc,"type","Saturation"),j(Gc,"defaults",{saturation:0}),j(Gc,"uniformLocations",["uSaturation"]),ne.setClass(Gc);class qc extends Pt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2],u=Math.max(i,a,c),h=(i+a+c)/3,d=2*Math.abs(u-h)/255*n;t[s]+=u!==i?(u-i)*d:0,t[s+1]+=u!==a?(u-a)*d:0,t[s+2]+=u!==c?(u-c)*d:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}j(qc,"type","Vibrance"),j(qc,"defaults",{vibrance:0}),j(qc,"uniformLocations",["uVibrance"]),ne.setClass(qc);class t_{___eventListeners;___activeObjects;constructor(){this.___activeObjects=[],this.___eventListeners={}}pauseEventListeners(){this.___eventListeners=this.__eventListeners,this.__eventListeners={};const e=this.getActiveObjects();this.discardActiveObject(),this.___activeObjects=e}resumeEventListeners(){this.__eventListeners=this.___eventListeners,this.___eventListeners={};const e=this.___activeObjects;if(!e.length)return this.requestRenderAll(),!1;if(e.length===1)this.setActiveObject(e[0]);else{const t=new mn(e);this.setActiveObject(t)}this.requestRenderAll()}}class qs extends St{isSelected=!1;text;tScale;display;id;backgroundColor;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default",fontSize:16,fontFamily:"Arial",fontColor:"#ffffff",textAlign:"center"};static type="Text";constructor(e){super(e),Object.assign(this,qs.ownDefaults),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.text=e.text||"",this.backgroundColor=e.backgroundColor||"transparent"}static createControls(){return{controls:Pp()}}static getDefaults(){return{...super.getDefaults(),...qs.ownDefaults}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,6),e.lineWidth=2,e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore())}}function $n(r,e,t,n,s){r.save(),r.translate(e,t),r.rotate(Dx.degreesToRadians(90+s.angle)),r.beginPath(),r.lineWidth=4,r.lineCap="round",r.strokeStyle="#dfe2e8",r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}function Pp(){return{mr:new ut({x:.5,y:0,actionHandler:aa,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing",render:$n}),ml:new ut({x:-.5,y:0,actionHandler:aa,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing",render:$n})}}const aa=Ut.wrapWithFireEvent("resizing",Ut.wrapWithFixedAnchor((r,e,t,n)=>{const s=Ut.getLocalPoint(e,e.originX,e.originY,t,n);if(bj(e.originX)||xj(e.originX)&&s.x<0||wj(e.originX)&&s.x>0){const i=e.target,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=_j(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a);if(e.corner==="ml"){const p=u-h;if(i.left+p<0)return i.set("width",i.width+i.left),!0}return i.set("width",Math.max(h,0)),u!==i.width}return!1})),r_={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Me=r=>typeof r=="string"?r_[r]:r-.5,bj=r=>Me(r)===Me("center"),wj=r=>Me(r)===Me("left"),xj=r=>Me(r)===Me("right");function _j(r){return Me(r.originX)===Me("center")&&Me(r.originY)===Me("center")}ne.setClass(qs,"Text");class Hr extends St{static type="Transition";id;duration;fromId;toId;static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0, 0, 0, 0.5)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};isSelected=!1;constructor(e){super(e),this.id=e.id,this.fromId=e.fromId,this.toId=e.toId,Object.assign(this,{duration:e.duration,fromId:e.fromId,toId:e.toId,kind:e.kind,tScale:e.tScale,strokeDashArray:e.strokeDashArray||[],isSelected:!1,centeredScaling:!0,strokeWidth:0}),Object.assign(this,Hr.ownDefaults)}static createControls(){return{controls:Sj()}}static getDefaults(){return{...super.getDefaults(),...Hr.ownDefaults}}updateCoords(){}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle=this.isSelected?"rgba(255, 255, 255,1.0)":"rgba(255, 255, 255,0.15)",e.stroke(),e.restore()}}ne.setClass(Hr,"Transition");const Sj=()=>({mr:new ut({x:.5,y:0,actionHandler:J0,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing",render:$n}),ml:new ut({x:-.5,y:0,actionHandler:J0,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing",render:$n})});ne.setClass(Hr,"Transition");const{wrapWithFireEvent:Cj,getLocalPoint:Tj}=Ut,rf="center",Ej="left",kj="right";function Ij(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,a,c),d}}const Aj=(r,e,t,n)=>{const s=Tj(e,e.originX,e.originY,t,n);if(Me(e.originX)===Me(rf)||Me(e.originX)===Me(kj)&&s.x<0||Me(e.originX)===Me(Ej)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=Oj(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a),d=cs(h,i.tScale);return d>=1500||d<500?!1:(i.set("width",Math.max(h,0)),i.set("duration",d),i.setCoords(),i.canvas&&i.canvas.renderAll(),u!==i.width)}return!1};function Oj(r){return Me(r.originX)===Me(rf)&&Me(r.originY)===Me(rf)}const J0=Cj("resizing",Ij(Aj));class Hi extends St{static type="Placeholder";guideItemId;distXToActCenter;trackItemType;defaultPos;draggedObject=null;for;id;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",strokeWidth:0,fill:"rgba(255, 211, 42, 0.1)",stroke:"rgba(255, 211, 42, 1.0)",selectable:!1,borderOpacityWhenMoving:1,hoverCursor:"default",strokeDashArray:[5,1],evented:!1};constructor(e){super(e),this.id=e.id,this.for=e.for,Object.assign(this,Hi.ownDefaults)}static getDefaults(){return{...super.getDefaults(),...Hi.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore()}}ne.setClass(Hi,"Placeholder");const Mj={top:{top:35,guideHeight:2,bottom:3},center:{top:3,guideHeight:2,bottom:3},bottom:{top:3,guideHeight:2,bottom:35}},Ea="rgba(0, 216, 214, 1.0)",nd=(r,e,t)=>new St({top:r,left:0,strokeWidth:0,fill:"transparent",selectable:!0,height:t,width:e});class qo extends zr{static type="Helper";static defaultSettings={selectable:!1,evented:!1};static ownDefaults={...qo.defaultSettings};guide;topGuide;bottomGuide;id;metadata={};tScale;kind;constructor(e){const t=Mj[e.kind],n=nd(0,e.width,t.top),s=nd(t.top,e.width,t.guideHeight),i=nd(t.top+t.guideHeight,e.width,t.bottom);super([n,s,i],{...qo.defaultSettings,...e}),this.topGuide=n,this.guide=s,this.bottomGuide=i,this.id=e.id,this.metadata=e.metadata??{},this.tScale=e.tScale,this.kind=e.kind}static getDefaults(){return{...super.getDefaults(),...qo.defaultSettings}}updateCoords(e){this.scaleToWidth(e),this.set("scaleY",1)}setSelected(e){this.guide.set("fill",e?Ea:"transparent")}}const lo=qo;ne.setClass(lo,"Helper");class ps extends St{static ownDefaults={selectable:!1,evented:!1,strokeWidth:0,stroke:"transparent"};static type="Track";id;accepts;metadata;items;borderColor="transparent";stroke="transparent";strokeWidth=0;constructor(e){super(e),Object.assign(this,ps.ownDefaults),this.id=e.id,this.accepts=e.accepts||["audio","video","image","text"],this.items=e.items||[],this.metadata=e.metadata}static getDefaults(){return{...super.getDefaults(),...ps.ownDefaults}}updateCoords(e){this.width=e}}ne.setClass(ps,"Track");class Cl extends St{isSelected;tScale;display;id;src;itemType;static ownDefaults={rx:8,ry:8,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",fill:"#27272a"};static type="Image";constructor(e){super(e),this.itemType="image",this.isSelected=!1,Object.assign(this,Cl.ownDefaults),this.id=e.id,this.src=e.src,this.display=e.display,this.tScale=e.tScale}static createControls(){return{controls:Pp()}}static getDefaults(){return{...super.getDefaults(),...Cl.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=Ea,e.stroke(),e.restore())}}const hu=Cl;ne.setClass(hu,"Image");class li extends St{id;tScale;isSelected=!1;display;trim;static type="Video";static defaultProps={objectCaching:!1,rx:8,ry:8,fill:"#27272a"};constructor(e){super(Object.assign({},li.defaultProps,e)),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim}static createControls(){return{controls:n_()}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=Ea,e.stroke(),e.restore())}}ne.setClass(li,"Video");const n_=()=>({mr:new ut({x:.5,y:0,render:$n,actionHandler:Q0,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new ut({x:-.5,y:0,render:$n,actionHandler:Q0,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:Pj,getLocalPoint:Dj}=Ut,Rj=(r,e,t,n)=>{const s=Dj(e,e.originX,e.originY,t,n);if(Me(e.originX)===Me("center")||Me(e.originX)===Me("right")&&s.x<0||Me(e.originX)===Me("left")&&s.x>0){const{target:i}=e;return i.width!==i.width}return!1};function Dp(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,a,c),d}}const Q0=Pj("resizing",Dp(Rj));class Wn extends St{id;itemType="audio";isSelected=!1;trim;src;tScale;display;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default"};static type="Audio";constructor(e){super({...Wn.getDefaults(),...e}),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim,this.src=e.src}static getDefaults(){return{...super.getDefaults(),...Wn.ownDefaults}}static createControls(){return{controls:s_()}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,Wn.ownDefaults.rx),e.lineWidth=2,e.strokeStyle=Ea,e.stroke(),e.restore())}}ne.setClass(Wn,"Audio");const s_=()=>({mr:new ut({x:.5,y:0,render:$n,actionHandler:e1,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new ut({x:-.5,y:0,render:$n,actionHandler:e1,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:jj,getLocalPoint:Lj}=Ut,Fj=(r,e,t,n)=>{const s=Lj(e,e.originX,e.originY,t,n);if(Me(e.originX)===Me("center")||Me(e.originX)===Me("right")&&s.x<0||Me(e.originX)===Me("left")&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=Nj(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a);if(e.corner==="mr"){const d=i.trim.to,p=h-u,g=cs(p,i.tScale),y=d+g;if(y>i.duration)return!1;i.set("width",Math.max(h,0)),i.trim.to=y}else{if(i.left<0)return!1;const d=u-h;if(i.left+d<0)return i.set("width",i.width+i.left),!0;const p=h-u,g=i.trim.from,y=cs(p,i.tScale),w=g-y;if(w<0)return!1;i.set("width",Math.max(h,0)),i.trim.from=w}return u!==i.width}return!1};function Nj(r){return Me(r.originX)===Me("center")&&Me(r.originY)===Me("center")}const e1=jj("resizing",Dp(Fj));class ca extends St{static type="TransitionGuide";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0,0,0,0.85)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};tScale;duration=0;fromId;toId;itemType="none";isSelected=!1;id;constructor(e){super(e),Object.assign(this,ca.ownDefaults),this.id=e.id}static createControls(){return{controls:i_()}}static getDefaults(){return{...super.getDefaults(),...ca.ownDefaults}}updateCoords(){const e=this.canvas;if(!e)return;const t=e.getObjects().find(i=>i.id===this.fromId);if(!t)return;const n=xt(this.duration,this.tScale),s=t.left+t.width-n/2;this.set({width:n,left:s})}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M3 5.30359C3 3.93159 4.659 3.24359 5.629 4.21359L11.997 10.5826L10.583 11.9966L5 6.41359V17.5856L10.586 11.9996L10.583 11.9966L11.997 10.5826L12 10.5856L18.371 4.21459C19.341 3.24459 21 3.93159 21 5.30359V18.6956C21 20.0676 19.341 20.7556 18.371 19.7856L12 13.5L13.414 11.9996L19 17.5866V6.41359L13.414 11.9996L13.421 12.0056L12.006 13.4206L12 13.4136L5.629 19.7846C4.659 20.7546 3 20.0676 3 18.6956V5.30359Z");e.save(),e.translate(-12,-12),e.fillStyle="#ffffff",e.fill(t),e.restore()}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=1,e.strokeStyle="rgba(255, 255, 255,1.0)",e.stroke(),e.restore())}}function i_(){return{mr:new ut({x:.5,y:0,actionHandler:aa,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing",render:t1}),ml:new ut({x:-.5,y:0,actionHandler:aa,cursorStyleHandler:Ut.scaleSkewCursorStyleHandler,actionName:"resizing",render:t1})}}function t1(r,e,t,n,s){r.save(),r.translate(e,t),r.rotate(Dx.degreesToRadians(90+s.angle)),r.lineWidth=6,r.lineCap="round",r.strokeStyle="white",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.lineWidth=4,r.strokeStyle="black",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}class la extends St{static type="PreviewTrackItem";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",rx:4,ry:4};duration=0;fromId="";toId="";isSelected=!1;name;durationString;id;constructor(e){super(e),Object.assign(this,la.ownDefaults),this.id=e.id,this.name=e.name||"item",this.durationString="00:05",this.fill="#27272a"}static getDefaults(){return{...super.getDefaults(),...la.ownDefaults}}_render(e){e.save(),super._render(e),e.beginPath(),e.rect(-this.width/2,-this.height/2,this.width,this.height),e.clip(),this.drawTextIdentity(e),e.restore()}drawTextIdentity(e){e.font="600 12px 'Geist variable'",e.textAlign="left";const u=e.measureText(this.name).width,h=e.measureText(this.durationString).width,d=-this.height/2+4,p=-this.width/2,g=p+u+8*2+4,y=u+8*2;this.drawRoundedRect(e,p,d,y,20,4),e.fillStyle="#f4f4f5",e.fillText(this.name,p+8,d+12+2);const w=h+8*2;this.drawRoundedRect(e,g,d,w,20,4),e.fillStyle="#f4f4f5",e.fillText(this.durationString,g+8,d+12+2)}drawRoundedRect(e,t,n,s,i,a){e.fillStyle="rgba(0, 0, 0, 0.5)",e.roundRect?(e.beginPath(),e.roundRect(t,n,s,i,a),e.fill()):e.fillRect(t,n,s,i)}}function o_(r,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{if(n!=="constructor"){const s=Object.getOwnPropertyDescriptor(t.prototype,n);s&&Object.defineProperty(r.prototype,n,s)}})})}const du=(r,e)=>{const t={x:r.size.width/2,y:r.size.height/2},n={x:e.width/2,y:e.height/2},s=t.x-n.x,i=t.y-n.y,a=Math.min(r.size.width/e.width,r.size.height/e.height);return{top:`${i}px`,left:`${s}px`,transform:`scale(${a})`}},a_=r=>new Promise((e,t)=>{const n=new Audio;n.preload="auto",n.addEventListener("loadedmetadata",()=>{const s=n.duration*1e3;e({duration:s})}),n.addEventListener("error",s=>{t(s)}),n.src=r,n.crossOrigin="anonymous",n.load()}),c_=r=>new Promise((e,t)=>{const n=new Image;console.warn("Consider updating CDN config for CORS issues?"),n.onload=()=>{const s=n.width,i=n.height;e({width:s,height:i})},n.onerror=s=>{t(s)},n.crossOrigin="anonymous",n.src=r}),l_=r=>new Promise((e,t)=>{const n=document.createElement("video");n.preload="auto",n.addEventListener("loadedmetadata",()=>{const s=n.duration*1e3,i=n.videoWidth,a=n.videoHeight;e({duration:s,width:i,height:a})}),n.addEventListener("error",s=>{t(s)}),n.src=r,n.load()}),Ko=(r,e)=>{const t=document.createElement("div");Object.keys(e).forEach(s=>{s!=="height"&&(t.style[s]=e[s])}),document.body.appendChild(t),t.textContent=r,t.style.width=`${e.width}px`,t.style.fontSize=`${e.fontSize}px`;const n=getComputedStyle(t).height;return document.body.removeChild(t),parseFloat(n)},on=r=>Object.keys(r).reduce((e,t)=>{const{display:{to:n}}=r[t];return Math.max(e,n)},0),u_=(r,e)=>{if(!r)return{from:0,to:e.duration};const{from:t,to:n}=r;return{from:t??0,to:n??e.duration}},h_=(r,e)=>{const{duration:t,trim:n}=e,s=n?n.to-n.from:t||5e3,i={from:0,to:s};if(!r)return i;if(r.from!==void 0&&r.from<0)return console.error("'from' must be a non-negative number. Returning default display."),i;if(r.from!==void 0&&r.to===void 0)return{from:r.from,to:r.from+s};if(r.to!==void 0){if(r.to<0)return console.error("'to' must be a non-negative number. Returning default display."),i;if(r.to<r.from)return console.error("'to' must be greater than or equal to 'from'. Returning default display."),i}return r};function d_(r,e){return r.map(t=>{const n=t.items.filter(s=>!e.includes(s));return{...t,items:n}}).filter(t=>t.items.length>0)}const f_=async(r,e)=>{const t=r.details,n=await c_(t.src),s=du(e,n);return{id:r.id,type:"image",name:"",display:{from:e.origin||0,to:(e.origin||5e3)+5e3},details:{src:t.src||"",width:t.width||n.width||100,height:t.height||n.height||100,opacity:t.opacity??100,transform:s.transform,border:t.border||"none",borderRadius:t.borderRadius||"0",boxShadow:t.boxShadow||"none",top:s.top||"0px",left:s.left||"0px"},metadata:r.metadata||{}}},p_=async(r,e)=>{const t=r.details.src,n=await l_(t),s=du(e,{...n}),i=u_(r.trim,{duration:n.duration}),a={width:n.width,height:n.height,duration:n.duration,src:t,volume:r.details.volume??100,top:r.details.top||s.top||"0px",left:r.details.left||s.left||"0px",text:r.details.text};return{...r,trim:i,type:"video",details:a,display:h_(r?.display,{duration:n.duration,trim:i})}},g_=async r=>{const e=r.details,t=(await a_(e.src)).duration,n=r?.display?.from??0;return{id:r.id,name:"",type:"audio",display:{from:n,to:n+t},trim:{from:0,to:t},details:{src:e.src,duration:t,volume:e.volume??100,text:e.text},metadata:{...r.metadata}}},Vj=5e3,Rp=async(r,e)=>{const t=r.id;await rb([{fontFamily:r.details.fontFamily??"",fontUrl:r.details.fontUrl??""}]);const n={fontFamily:r.details.fontFamily??"Arial",fontSize:r.details.fontSize??"16px",fontWeight:r.details.fontWeight??"normal",fontStyle:r.details.fontStyle??"normal",textDecoration:r.details.textDecoration??"none",textAlign:r.details.textAlign??"left",lineHeight:r.details.lineHeight??"normal",letterSpacing:r.details.letterSpacing??"normal",wordSpacing:r.details.wordSpacing??"normal",color:r.details.color??"#ffffff",backgroundColor:r.details.backgroundColor??"transparent",border:r.details.border??"none",textShadow:r.details.textShadow??"none",text:r.details.text??"",opacity:r.details.opacity??100,width:r.details.width??300,wordWrap:r.details.wordWrap??"normal",wordBreak:r.details.wordBreak??"normal",WebkitTextStrokeColor:r.details.WebkitTextStrokeColor??"#ffffff",WebkitTextStrokeWidth:r.details.WebkitTextStrokeWidth??"0px",top:r.details.top??"0px",left:r.details.left??"0px"},s=Ko(r.details.text??"",n),i=du(e,{width:n.width??0,height:s});return{id:t,name:"",type:"text",display:{from:0,to:Vj},details:{...n,height:s,top:i.top,left:i.left,fontUrl:r.details.fontUrl,text:r.details.text??""},metadata:{}}},m_=(r,e)=>{const t=r.display,n=xt(t.from,e.tScale),s=xt(t.to-t.from,e.tScale),i=ne.getClass("Audio")||Wn;return new i({width:s,height:42,top:10,left:n,id:r.id,display:t,text:r.details.text,trim:r.trim||{from:0,to:r.details.duration},duration:r.details.duration,src:r.details.src,tScale:e.tScale})},v_=(r,e)=>{const t=xt(r.display.from,e.tScale),n=xt(r.details.duration||5e3,e.tScale),s=ne.getClass("Image")||hu;return new s({width:n,height:42,id:r.id,src:r.details.src,tScale:e.tScale,top:10,left:t,display:r.display})},y_=(r,e)=>{const t=xt(r.trim.from,e.tScale),n=xt(r.trim.to-r.trim.from,e.tScale),s=ne.getClass("Video")||li;return new s({width:n,height:42,id:r.id,tScale:e.tScale,fill:"#333333",top:10,left:t,display:r.trim,trim:r.trim,text:r.details.text})},b_=(r,e)=>{const t=r.display,n=xt(t.from,e.tScale),s=xt(t.to-t.from,e.tScale),i=ne.getClass("Text")||qs;return new i({width:s,height:42,id:r.id,display:t,top:10,left:n,text:r.details.text,tScale:e.tScale})},w_={video:42,image:42,audio:42,text:42,caption:42,template:42},x_=(r={})=>{const e={...w_,...r};return Object.fromEntries(Object.entries(e).filter(([,t])=>typeof t=="number"))};let __=class extends Wn{static type="Audio";text;constructor(e){super(e),this.text=e.text??"Audio"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M8.24092 0C8.24092 2.51565 10.2795 4.55419 12.7951 4.55419C12.9677 4.55419 13.1331 4.62274 13.2552 4.74475C13.3772 4.86676 13.4457 5.03224 13.4457 5.20479C13.4457 5.37734 13.3772 5.54282 13.2552 5.66483C13.1331 5.78685 12.9677 5.85539 12.7951 5.85539C11.9218 5.85605 11.0594 5.66105 10.2713 5.28471C9.48319 4.90838 8.78942 4.36027 8.24092 3.68066V13.8794C8.24094 14.8271 7.91431 15.7458 7.31606 16.4808C6.71781 17.2157 5.88451 17.722 4.95657 17.9143C4.02863 18.1066 3.06276 17.9731 2.22172 17.5364C1.38067 17.0997 0.715856 16.3865 0.339286 15.5169C-0.0372842 14.6473 -0.10259 13.6744 0.154372 12.7622C0.411334 11.8501 0.974857 11.0544 1.74999 10.5092C2.52512 9.96403 3.46449 9.7027 4.40981 9.76924C5.35512 9.83579 6.24861 10.2261 6.93972 10.8745V0H8.24092ZM6.93972 13.8794C6.93972 13.1317 6.6427 12.4146 6.11398 11.8859C5.58527 11.3572 4.86818 11.0602 4.12046 11.0602C3.37275 11.0602 2.65566 11.3572 2.12694 11.8859C1.59823 12.4146 1.3012 13.1317 1.3012 13.8794C1.3012 14.6272 1.59823 15.3443 2.12694 15.873C2.65566 16.4017 3.37275 16.6987 4.12046 16.6987C4.86818 16.6987 5.58527 16.4017 6.11398 15.873C6.6427 15.3443 6.93972 14.6272 6.93972 13.8794Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,10),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,14),e.translate(10,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class S_ extends li{static type="Video";text;constructor(e){super(e),this.text=e.text??"Video"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M16.5625 0.925L12.5 3.275V0.625L11.875 0H0.625L0 0.625V9.375L0.625 10H11.875L12.5 9.375V6.875L16.5625 9.2125L17.5 8.625V1.475L16.5625 0.925ZM11.25 8.75H1.25V1.25H11.25V8.75ZM16.25 7.5L12.5 5.375V4.725L16.25 2.5V7.5Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,14),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,10),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}class jp extends qs{static type="Text";constructor(e){super(e),this.fill="#303030"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M6.23982 0.361968C6.18894 0.253743 6.10832 0.162234 6.00736 0.0981357C5.9064 0.034038 5.78929 0 5.6697 0C5.55012 0 5.433 0.034038 5.33204 0.0981357C5.23109 0.162234 5.15046 0.253743 5.09959 0.361968L0.0599035 11.0713C0.0246926 11.1462 0.00457285 11.2272 0.000693114 11.3099C-0.00318662 11.3925 0.00924959 11.4751 0.0372917 11.553C0.0939253 11.7102 0.210687 11.8384 0.361891 11.9095C0.513095 11.9806 0.686354 11.9888 0.843555 11.9322C1.00076 11.8755 1.12902 11.7588 1.20013 11.6075L2.51202 8.81998H8.82738L10.1393 11.6075C10.1745 11.6824 10.2241 11.7496 10.2853 11.8053C10.3465 11.861 10.418 11.9041 10.4958 11.9322C10.5737 11.9602 10.6563 11.9726 10.7389 11.9687C10.8216 11.9649 10.9026 11.9447 10.9775 11.9095C11.0524 11.8743 11.1196 11.8247 11.1753 11.7635C11.231 11.7023 11.2741 11.6308 11.3021 11.553C11.3302 11.4751 11.3426 11.3925 11.3387 11.3099C11.3348 11.2272 11.3147 11.1462 11.2795 11.0713L6.23982 0.361968ZM3.10498 7.56005L5.6697 2.11011L8.23443 7.56005H3.10498ZM15.1191 3.78029C14.1143 3.78029 13.3292 4.05354 12.7859 4.59294C12.6721 4.71153 12.6092 4.86987 12.6106 5.03419C12.6119 5.19851 12.6774 5.3558 12.7931 5.4725C12.9088 5.58921 13.0655 5.6561 13.2298 5.6589C13.3941 5.6617 13.553 5.60018 13.6726 5.48748C13.9718 5.19062 14.46 5.04021 15.1191 5.04021C16.1609 5.04021 17.009 5.74892 17.009 6.61511V6.86867C16.45 6.49465 15.7917 6.29663 15.1191 6.30013C13.382 6.30013 11.9693 7.57187 11.9693 9.13495C11.9693 10.698 13.382 11.9698 15.1191 11.9698C15.792 11.9727 16.4503 11.7739 17.009 11.3989C17.0168 11.566 17.0907 11.7231 17.2144 11.8357C17.3381 11.9483 17.5014 12.0071 17.6685 11.9993C17.8356 11.9915 17.9927 11.9176 18.1053 11.7939C18.2179 11.6702 18.2767 11.5069 18.2689 11.3398V6.61511C18.2689 5.05202 16.8562 3.78029 15.1191 3.78029ZM15.1191 10.7099C14.0773 10.7099 13.2292 10.0012 13.2292 9.13495C13.2292 8.26876 14.0773 7.56005 15.1191 7.56005C16.1609 7.56005 17.009 8.26876 17.009 9.13495C17.009 10.0012 16.1609 10.7099 15.1191 10.7099Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}let C_=class extends hu{static type="Image";text;constructor(e){super(e),this.text=e.text??"Image"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M1.55556 0H14.4444C15.3031 0 16 0.696889 16 1.55556V14.4444C16 14.857 15.8361 15.2527 15.5444 15.5444C15.2527 15.8361 14.857 16 14.4444 16H1.55556C1.143 16 0.747335 15.8361 0.455612 15.5444C0.163889 15.2527 0 14.857 0 14.4444V1.55556C0 0.696889 0.696889 0 1.55556 0ZM14.4444 1.33333H1.55556C1.49662 1.33333 1.4401 1.35675 1.39842 1.39842C1.35675 1.4401 1.33333 1.49662 1.33333 1.55556V14.4444C1.33333 14.5671 1.43289 14.6667 1.55556 14.6667H1.72444L10.456 5.93511C10.6004 5.79065 10.7719 5.67605 10.9607 5.59787C11.1494 5.51968 11.3517 5.47944 11.556 5.47944C11.7603 5.47944 11.9626 5.51968 12.1513 5.59787C12.3401 5.67605 12.5116 5.79065 12.656 5.93511L14.6667 7.94578V1.55556C14.6667 1.49662 14.6433 1.4401 14.6016 1.39842C14.5599 1.35675 14.5034 1.33333 14.4444 1.33333ZM14.6667 9.83111L11.7129 6.87733C11.6922 6.85664 11.6677 6.84022 11.6407 6.82902C11.6137 6.81781 11.5848 6.81205 11.5556 6.81205C11.5263 6.81205 11.4974 6.81781 11.4704 6.82902C11.4434 6.84022 11.4189 6.85664 11.3982 6.87733L3.60978 14.6667H14.4444C14.5034 14.6667 14.5599 14.6433 14.6016 14.6016C14.6433 14.5599 14.6667 14.5034 14.6667 14.4444V9.83111ZM4.88889 7.11111C4.29952 7.11111 3.73429 6.87699 3.31754 6.46024C2.90079 6.04349 2.66667 5.47826 2.66667 4.88889C2.66667 4.29952 2.90079 3.73429 3.31754 3.31754C3.73429 2.90079 4.29952 2.66667 4.88889 2.66667C5.47826 2.66667 6.04349 2.90079 6.46024 3.31754C6.87699 3.73429 7.11111 4.29952 7.11111 4.88889C7.11111 5.47826 6.87699 6.04349 6.46024 6.46024C6.04349 6.87699 5.47826 7.11111 4.88889 7.11111ZM4.88889 5.77778C5.12464 5.77778 5.35073 5.68413 5.51743 5.51743C5.68413 5.35073 5.77778 5.12464 5.77778 4.88889C5.77778 4.65314 5.68413 4.42705 5.51743 4.26035C5.35073 4.09365 5.12464 4 4.88889 4C4.65314 4 4.42705 4.09365 4.26035 4.26035C4.09365 4.42705 4 4.65314 4 4.88889C4 5.12464 4.09365 5.35073 4.26035 5.51743C4.42705 5.68413 4.65314 5.77778 4.88889 5.77778Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class T_ extends ps{static type="Track";constructor(e){super(e),this.fill="#18181b"}_render(e){super._render(e);const t=new Path2D("M14.4444 13.3263H11.0667C12.5384 12.3991 13.6259 10.9716 14.1289 9.30644C14.632 7.64131 14.5169 5.85051 13.8048 4.26348C13.0927 2.67645 11.8314 1.39993 10.2531 0.668736C8.67478 -0.0624548 6.8855 -0.199136 5.21442 0.283835C3.54334 0.766806 2.10285 1.83695 1.15794 3.2974C0.213035 4.75785 -0.172743 6.51038 0.0715766 8.23261C0.315896 9.95484 1.17388 11.5309 2.4877 12.671C3.80151 13.811 5.4828 14.4383 7.22227 14.4374H14.4444C14.5918 14.4374 14.7331 14.3789 14.8373 14.2747C14.9415 14.1705 15 14.0292 15 13.8819C15 13.7345 14.9415 13.5932 14.8373 13.489C14.7331 13.3848 14.5918 13.3263 14.4444 13.3263ZM1.1112 7.21523C1.1112 6.00658 1.46961 4.82506 2.14111 3.8201C2.8126 2.81514 3.76702 2.03187 4.88367 1.56934C6.00032 1.10681 7.22905 0.985789 8.41449 1.22159C9.59992 1.45738 10.6888 2.03941 11.5435 2.89405C12.3981 3.7487 12.9801 4.83759 13.2159 6.02302C13.4517 7.20845 13.3307 8.43719 12.8682 9.55384C12.4056 10.6705 11.6224 11.6249 10.6174 12.2964C9.61244 12.9679 8.43093 13.3263 7.22227 13.3263C5.60208 13.3245 4.04878 12.68 2.90313 11.5344C1.75748 10.3887 1.11304 8.83542 1.1112 7.21523ZM7.22227 5.54858C7.55191 5.54858 7.87414 5.45083 8.14822 5.2677C8.4223 5.08456 8.63592 4.82426 8.76206 4.51972C8.88821 4.21518 8.92121 3.88007 8.85691 3.55677C8.7926 3.23347 8.63386 2.9365 8.40078 2.70342C8.16769 2.47033 7.87072 2.3116 7.54742 2.24729C7.22412 2.18298 6.88901 2.21599 6.58447 2.34213C6.27993 2.46828 6.01964 2.6819 5.8365 2.95598C5.65337 3.23006 5.55562 3.55229 5.55562 3.88192C5.55562 4.32395 5.73121 4.74787 6.04377 5.06043C6.35633 5.37298 6.78025 5.54858 7.22227 5.54858ZM7.22227 3.32637C7.33215 3.32637 7.43956 3.35895 7.53092 3.42C7.62228 3.48104 7.69349 3.56781 7.73554 3.66932C7.77759 3.77084 7.78859 3.88254 7.76715 3.9903C7.74572 4.09807 7.6928 4.19706 7.61511 4.27476C7.53741 4.35245 7.43842 4.40536 7.33066 4.4268C7.22289 4.44824 7.11119 4.43723 7.00967 4.39519C6.90816 4.35314 6.82139 4.28193 6.76035 4.19057C6.69931 4.09921 6.66672 3.9918 6.66672 3.88192C6.66672 3.73458 6.72525 3.59327 6.82944 3.48909C6.93363 3.3849 7.07493 3.32637 7.22227 3.32637ZM8.88893 10.5485C8.88893 10.2189 8.79118 9.89668 8.60805 9.6226C8.42491 9.34852 8.16462 9.1349 7.86008 9.00875C7.55553 8.88261 7.22043 8.8496 6.89713 8.91391C6.57383 8.97822 6.27686 9.13695 6.04377 9.37004C5.81069 9.60313 5.65195 9.9001 5.58764 10.2234C5.52334 10.5467 5.55634 10.8818 5.68249 11.1863C5.80863 11.4909 6.02225 11.7512 6.29633 11.9343C6.57041 12.1175 6.89264 12.2152 7.22227 12.2152C7.6643 12.2152 8.08822 12.0396 8.40078 11.727C8.71334 11.4145 8.88893 10.9906 8.88893 10.5485ZM6.66672 10.5485C6.66672 10.4387 6.69931 10.3313 6.76035 10.2399C6.82139 10.1485 6.90816 10.0773 7.00967 10.0353C7.11119 9.99323 7.22289 9.98223 7.33066 10.0037C7.43842 10.0251 7.53741 10.078 7.61511 10.1557C7.6928 10.2334 7.74572 10.3324 7.76715 10.4402C7.78859 10.5479 7.77759 10.6596 7.73554 10.7611C7.69349 10.8627 7.62228 10.9494 7.53092 11.0105C7.43956 11.0715 7.33215 11.1041 7.22227 11.1041C7.07493 11.1041 6.93363 11.0456 6.82944 10.9414C6.72525 10.8372 6.66672 10.6959 6.66672 10.5485ZM10.5556 8.88189C10.8852 8.88189 11.2074 8.78414 11.4815 8.60101C11.7556 8.41787 11.9692 8.15758 12.0954 7.85303C12.2215 7.54849 12.2545 7.21338 12.1902 6.89008C12.1259 6.56678 11.9672 6.26982 11.7341 6.03673C11.501 5.80364 11.204 5.64491 10.8807 5.5806C10.5574 5.51629 10.2223 5.5493 9.91778 5.67544C9.61324 5.80159 9.35295 6.01521 9.16981 6.28929C8.98668 6.56337 8.88893 6.8856 8.88893 7.21523C8.88893 7.65726 9.06452 8.08118 9.37708 8.39374C9.68964 8.70629 10.1136 8.88189 10.5556 8.88189ZM10.5556 6.65968C10.6655 6.65968 10.7729 6.69226 10.8642 6.75331C10.9556 6.81435 11.0268 6.90112 11.0688 7.00263C11.1109 7.10415 11.1219 7.21585 11.1005 7.32362C11.079 7.43138 11.0261 7.53037 10.9484 7.60807C10.8707 7.68576 10.7717 7.73867 10.664 7.76011C10.5562 7.78155 10.4445 7.77054 10.343 7.7285C10.2415 7.68645 10.1547 7.61524 10.0937 7.52388C10.0326 7.43252 10 7.32511 10 7.21523C10 7.06789 10.0586 6.92658 10.1628 6.8224C10.2669 6.71821 10.4082 6.65968 10.5556 6.65968ZM3.88896 5.54858C3.55933 5.54858 3.2371 5.64633 2.96302 5.82946C2.68894 6.01259 2.47532 6.27289 2.34918 6.57743C2.22303 6.88197 2.19002 7.21708 2.25433 7.54038C2.31864 7.86368 2.47737 8.16065 2.71046 8.39374C2.94355 8.62682 3.24052 8.78556 3.56382 8.84986C3.88711 8.91417 4.22222 8.88117 4.52677 8.75502C4.83131 8.62888 5.0916 8.41526 5.27474 8.14118C5.45787 7.8671 5.55562 7.54487 5.55562 7.21523C5.55562 6.77321 5.38003 6.34929 5.06747 6.03673C4.75491 5.72417 4.33099 5.54858 3.88896 5.54858ZM3.88896 7.77078C3.77909 7.77078 3.67168 7.7382 3.58032 7.67716C3.48896 7.61611 3.41775 7.52935 3.3757 7.42783C3.33365 7.32632 3.32265 7.21462 3.34409 7.10685C3.36552 6.99908 3.41843 6.90009 3.49613 6.8224C3.57382 6.7447 3.67281 6.69179 3.78058 6.67036C3.88835 6.64892 4.00005 6.65992 4.10156 6.70197C4.20308 6.74402 4.28984 6.81522 4.35089 6.90658C4.41193 6.99794 4.44452 7.10535 4.44452 7.21523C4.44452 7.36257 4.38598 7.50388 4.2818 7.60807C4.17761 7.71225 4.03631 7.77078 3.88896 7.77078Z");this.items.length||(e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#A0A4A2",e.textAlign="left",e.clip(),e.fillText("Drag and drop media here",32,12),e.translate(8,1),e.fillStyle="#A0A4A2",e.fill(t),e.restore())}}class E_ extends lo{static type="Helper";constructor(e){e.activeGuideFill="#ffffff",super(e)}}class k_{addTrackItem(e){const t=e.id,n=sd(e,{tScale:this.tScale,sizesMap:this.sizesMap});this.add(n),this.trackItemIds.push(t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=on(this.trackItemsMap)}alignItemsToTrack(){this.pauseEventListeners();const e=new Map(this.getObjects("Track").map(n=>[n.id,n])),t=this.getObjects("Image","Video","Text","Audio");this.trackItemIds.forEach(n=>{const s=this.tracks.find(c=>c.items.includes(n));if(!s)return;const i=e.get(s.id);this.duration;const a=this.getObjects().find(c=>c.id===n);a&&i&&(a.isMain=!1,this.trackItemsMap[n].isMain=!1,a.set({top:i.top}),a.setCoords())}),e.forEach(n=>{n.items=t.filter(s=>s.top===n.top).map(s=>s.id)}),this.resumeEventListeners()}updateTrackItemsPosition(){const e=this.getObjects("Image","Text","Video","Audio");e.sort((t,n)=>t.top-n.top),this.trackItemIds=e.map(t=>t.id).reverse()}restoreTrackItemPositions(){}updateTrackItemsState(){this.pauseEventListeners();const e=this.getObjects("Image","Video","Text","Audio"),t={};e.forEach(n=>{const{id:s,left:i,width:a}=n,c=this.trackItemsMap[s],u=cs(i,this.tScale),h=u+cs(a,this.tScale),d={from:u,to:h},p={...c,display:d,trim:n instanceof li||n instanceof Wn?n.trim:void 0};n.display=d,t[s]=p}),this.trackItemsMap=t,this.resumeEventListeners()}deleteActiveTrackItem(){const e=this.getActiveObjects();if(!e.length)return!1;const t=e.map(s=>s.id),n=ea(this.tracks,t);this.trackItemsMap=Object.keys(this.trackItemsMap).reduce((s,i)=>(t.includes(i)||(s[i]=this.trackItemsMap[i]),s),{}),this.trackItemIds=this.trackItemIds.filter(s=>!t.includes(s)),this.tracks=n,this.discardActiveObject(),this.remove(...e),this.setActiveIds([]),this.renderTracks(),this.alignItemsToTrack(),this.updateState({updateHistory:!0,kind:"remove"})}updateTrackItemsToHistory(){this.pauseEventListeners();const e=this.getObjects();this.trackItemIds.forEach(t=>{const n=this.tracks.find(h=>h.items.includes(t)),s=e.find(h=>h.id===n?.id)?.top;if(!s){console.warn(`Track top not found for trackItemId: ${t}`);return}const i=this.trackItemsMap[t],a=e.find(h=>h.id===t);if(!a){console.warn(`Object not found for trackItemId: ${t}`);return}const c=xt(i.display.from,this.tScale),u=xt(i.display.to-i.display.from,this.tScale);a.set({left:c,width:u,top:s}),a.setCoords()}),this.requestRenderAll(),this.resumeEventListeners()}cloneActiveTrackItem(e){const t=e?.trackItemId||this.activeIds[0];if(!t)return!1;const s={...this.trackItemsMap[t],id:Ot()},i=this.tracks.find(d=>d.items.includes(t)),a=this.tracks.findIndex(d=>d.id===i?.id)+1;this.findOrCreateTrack(s,{trackIndex:a});const c=sd(s,{tScale:this.tScale});c&&this.add(c);const{audioData:u,...h}=s.metadata||{};s.metadata=h,this.trackItemsMap[s.id]=s,this.trackItemIds.push(s.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}splitActiveTrackItem(e){const t=e.trackItemId??this.activeIds[0];if(!t||this.activeIds.length>1)return!1;const n=this.trackItemsMap[t],s=e.time;if(n.display.from>=s||n.display.to<=s)return!1;const i={...n,display:{from:n.display.from,to:s}},a={...n,display:{from:s,to:n.display.to},id:Ot()};if(n.type==="video"||n.type==="audio"){const d=s-i.display.from;i.trim={from:n.trim.from,to:n.trim.from+d},a.trim={from:i.trim.to,to:n.trim.to}}const c=this.getObjects().find(d=>d.id===t);c.display=i.display,this.tracks.find(d=>d.items.includes(t))?.items.push(a.id);const h=sd(a,{tScale:this.tScale});h&&this.add(h),this.trackItemsMap[a.id]=a,this.trackItemsMap[t]=i,this.trackItemIds.push(a.id),this.updateTrackItemCoords(i.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}updateTrackItemCoords(e){const t=this.getObjects().find(a=>a.id===e),n=this.trackItemsMap[e],s=xt(n.display.from,this.tScale),i=xt(n.display.to-n.display.from,this.tScale);t?.set({left:s,width:i}),t?.setCoords()}updateTrackItemDetails(e,t){const n=t?.trackItemId;if(!n)return!1;const s=this.trackItemsMap[n],i={...s.details,...e.details};("fontSize"in i||"lineHeight"in i)&&(i.height=Ko(i.text,i)),this.trackItemsMap[n]={...s,...e,details:i},this.updateState()}updateTrackItem(e,t){const n=t.trackItemId;if(!n)return!1;const s=this.trackItemsMap[n],i={...s.details,...e.details};if(s.type==="text"&&e.details.text){const a=this.getObjects("Text").find(c=>c.id===n);a instanceof jp&&(a.text=e.details.text,this.requestRenderAll())}("fontSize"in i||"lineHeight"in i)&&(i.height=Ko(i.text,i)),this.trackItemsMap[n]={...s,...e,details:i},this.updateState()}updateTrackItemsDetails(e,t){t?.trackItemIds?.forEach((n,s)=>{const i=this.trackItemsMap[n],a={...i.details,...e[s].details};("fontSize"in a||"lineHeight"in a)&&(a.height=Ko(a.text,a)),this.trackItemsMap[n]={...i,...e[s],details:a}}),this.updateState()}getTrackItems(){return this.getObjects(...Bj)}setActiveTrackItemCoords(){this.getActiveObjects().forEach(e=>e.setCoords())}deleteTrackItemById(e){const t=this.getObjects().filter(n=>e.includes(n.id));this.tracks=ea(this.tracks,e),this.trackItemsMap=Object.keys(this.trackItemsMap).filter(n=>!e.includes(n)).reduce((n,s)=>(n[s]=this.trackItemsMap[s],n),{}),this.trackItemIds=this.trackItemIds.filter(n=>!e.includes(n)),this.discardActiveObject(),this.remove(...t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=on(this.trackItemsMap)}selectTrackItemByIds(e){const t=this.getActiveObjects().map(s=>s.id);if(ze.isEqual(t,e))return;const n=this.getTrackItems().filter(s=>e.includes(s.id));if(n.length===0)this.discardActiveObject();else if(n.length===1)this.setActiveObject(n[0]);else{const s=new mn(n);this.setActiveObject(s)}this.requestRenderAll()}}const Bj=["Image","Text","Video","Audio","Caption","Template"],sd=(r,e)=>{const n={text:b_,video:y_,image:v_,audio:m_}[r.type];return n(r,e)},Oi={text:32,image:40,video:40,audio:32,main:40},r1=r=>{switch(r){case"text":return Oi.text;case"image":return Oi.image;case"video":return Oi.video;case"audio":return Oi.audio;case"helperTop":return 40;case"helperBottom":return 40;case"helperCenter":return 8;case"main":return Oi.main;default:return Oi.text}};class I_{findOrCreateTrack(e,{trackId:t,trackIndex:n}){const s=t;if(s){const a=this.tracks.find(c=>c.id===s);if(a)return a.items.push(e.id),s}const i={id:Ot(),items:[e.id],type:e.type,accepts:this.acceptsMap?.[e.type]};return n!==void 0?this.tracks.splice(n,0,i):this.tracks.push(i),this.renderTracks(),i.id}removeTracks(){this.getObjects("Track","Helper")?.forEach(e=>this.remove(e))}renderTracks(){this.updateTracksState(),this.removeTracks();const e=this.width,t=this.tracks.flatMap(c=>[c,{id:`after-${c.id}`,type:"helper",items:[],accepts:[]}]).slice(0,-1);let n=0;const s=ne.getClass("Helper")||lo,i=new s({id:"helperLineTop",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"top",metadata:{}});n+=r1("helperTop"),this.insertAt(0,i),t.forEach((c,u)=>{if(c.type==="helper"){const h=r1("helperCenter"),d=new s({id:c.id,top:n,tScale:this.tScale,width:e,height:h,metadata:{order:(u+1)/2},kind:"center"});n+=h,this.insertAt(0,d)}else{const h=ne.getClass("Track")||ps,d=new h({id:c.id,top:n,left:0,fill:"#18181b",height:42,width:e,tScale:this.tScale,accepts:this.acceptsMap?.[c.type]||[],items:c.items});n+=42,this.insertAt(0,d)}});const a=new s({id:"helperLineBottom",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"bottom",metadata:{}});this.insertAt(0,a)}updateTracksState(){const e=this.tracks.filter(n=>n.items.length||n.type==="main"),t=new Map;e.forEach(n=>t.set(n.id,n)),this.tracks=Array.from(t.values())}updateTrackCoords(){const e=this.bounding.width+this.spacing.right;this.getObjects("Track","Helper").forEach(t=>{t.updateCoords(e),t.setCoords()})}}const zj=60,Wj=188;function n1(r,e=1,t=1){const n=Wj*e;return r*(zj/1e3)*n/t}class A_{removeTransitions(){const e=this.getObjects("Transition");this.remove(...e)}renderTransitions(){this.removeTransitions(),this.transitionIds.forEach(e=>{const t=this.transitionsMap[e],n=t.fromId,s=t.toId,i=this.getObjects(),a=i.find(g=>g.id===n),c=i.find(g=>g.id===s);if(!a||!c)return;const u=n1(t.duration,this.tScale),h=a.left+a.width-u/2,d=a.height,p=new Hr({id:t.id,left:h,top:a.top,height:d,width:u,tScale:this.tScale,duration:t.duration,fromId:a.id,toId:c.id,kind:t.kind});t.kind==="none"&&(p.visible=!1),this.add(p)})}updateTransitionCoordinates(){this.pauseEventListeners(),this.getObjects("Transition").forEach(e=>{e.tScale=this.tScale,e.updateCoords(),e.setCoords()}),this.resumeEventListeners()}alignTransitionsToTrack(){this.pauseEventListeners(),this.transitionIds.forEach(e=>{const t=this.getObjects("Transition").find(n=>n.id===e);if(t instanceof Hr){const n=this.getObjects().find(a=>a.id===t.fromId);if(!n)return;const s=n1(t.duration,this.tScale),i=n.left+n.width-s/2;t.set({left:i,top:n.top}),t.setCoords()}}),this.resumeEventListeners()}updateTransitions(e=!0){e&&this.pauseEventListeners();const t=this.getObjects("Track"),n=this.getObjects("Video","Image");this.removeTransitions();const s={},i=[];t.forEach(a=>{const c=n.filter(u=>a.items.includes(u.id)).sort((u,h)=>u.left-h.left);for(let u=0;u<c.length-1;u++){const h=c[u],d=c[u+1];if(Math.abs(h.left+h.width-d.left)<=1){const p=`${h.id}-${d.id}`;if(this.transitionIds.includes(p))s[p]=this.transitionsMap[p];else{const g={id:p,duration:1500,fromId:h.id,toId:d.id,kind:"none",trackId:a.id,type:"transition"};s[p]=g}i.push(p)}}}),this.transitionIds=i,this.transitionsMap=s,this.renderTransitions(),e&&this.resumeEventListeners()}}const ee={canvas:null,enableGuideRedraw:!0,isPointerOverHelperTrack:!1,draggingOverTrack:null,primaryMovingObjects:[],secondaryMovingObjects:[],placeholderMovingObjects:[],objectInitialPositions:{},originTrack:{},trackToItemsMap:{},activeTrackToItemsMap:{},trackTopToIdMap:{},trackTops:[],activeObjects:[],primaryTracks:{},secondaryTracks:{}},ft={guide:null,object:null,objects:[]},Hj=()=>ee,Uj=r=>{Object.assign(ee,r)},$j=r=>{r.on("before:transform",O_.bind(r))},Yj=r=>{r.off("before:transform",O_.bind(r))};function O_(r){ee.canvas=this,ee.activeTrackToItemsMap={},ee.primaryTracks={},ee.secondaryTracks={},ee.trackTops=[],ee.trackToItemsMap={},ee.activeObjects=[],ee.trackTopToIdMap={},ee.canvas.trackIdAfterTransform="",ee.canvas.positionAfterTransform={};const e=ee.canvas.getActiveObject();if(!e)return;ee.activeObjects=e instanceof mn?e.getObjects():[e];const t=ee.canvas.getScenePoint(r.e),n=ee.canvas.getObjects("Track");ee.originTrack=n.find(a=>{const c=a.getBoundingRect();return t.x>=c.left&&t.x<=c.left+c.width&&t.y>=c.top&&t.y<=c.top+c.height})??{};const s=ee.canvas.getObjects("Video","Image","Audio","Text","Element");n.forEach(a=>{const c=s.filter(u=>a.items.includes(u.id));ee.trackToItemsMap[a.id]=c,ee.trackTopToIdMap[a.top]=a.id,ee.trackTops.push(a.top)}),ee.trackTops.sort((a,c)=>a-c),ee.activeObjects.forEach(a=>{const c=n?.find(h=>h.items.includes(a.id));if(!c)return;const u=c.id;ee.activeTrackToItemsMap[u]?ee.activeTrackToItemsMap[u].push(a):ee.activeTrackToItemsMap[u]=[a]}),ee.primaryMovingObjects=ee.activeObjects.filter(a=>{const c=a.getBoundingRect();return t.y>=c.top&&t.y<=c.top+c.height&&!(a instanceof Hr)}),ee.primaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=ee.trackTopToIdMap[c];if(ee.primaryTracks[u])ee.primaryTracks[u].objects.push(a);else{const h=nf(ee.trackTops,ee.originTrack.top,c);if(typeof h!="number")return;ee.primaryTracks[u]={objects:[a],index:h}}}),ee.primaryMovingObjects=ee.primaryMovingObjects.sort((a,c)=>a.left-c.left),ee.secondaryMovingObjects=ee.activeObjects.filter(a=>!ee.primaryMovingObjects.includes(a)&&!(a instanceof Hr)),ee.secondaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=ee.trackTopToIdMap[a.getBoundingRect().top];if(ee.secondaryTracks[u])ee.secondaryTracks[u].objects.push(a);else{const h=nf(ee.trackTops,ee.originTrack.top,c);if(typeof h!="number")return;ee.secondaryTracks[u]={objects:[a],index:h}}}),ee.originTrack&&(ee.canvas.trackOriginBeforeTransform=ee.originTrack.id),e&&(ee.canvas.positionBeforeTransform={top:e.top,left:e.left}),("transform"in r?r.transform:{}).action==="drag"&&(ee.placeholderMovingObjects=ee.primaryMovingObjects.map(a=>{const c=a.getBoundingRect();ee.objectInitialPositions[a.id]={top:c.top,left:c.left};const u=new Hi({id:`${a.id}-placeholder`,left:c.left,top:c.top,width:c.width,height:c.height,for:Xj[a.type]});return u.draggedObject=a,u}),ee.canvas.add(...ee.placeholderMovingObjects))}function nf(r,e,t){const n=r.indexOf(e),s=r.indexOf(t);return n===-1||s===-1?null:s-n}const Xj={trackitemvideo:"video",trackitemimage:"image",trackitemaudio:"audio",trackitemtext:"text"};function M_(r){if(!ft.guide)return!1;r.e.preventDefault();const e=this,t=e.getViewportPoint(r.e);ft.guide.set({left:t.x-16,top:t.y-ft.guide.height/2});const n=Gj(t,ft.objects);n&&(ft.object=n,n.strokeDashArray=[5,1],n.setSelected(!0)),ft.objects.forEach(s=>{s!==n&&s.setSelected(!1)}),e.requestRenderAll()}function Gj(r,e){let t=1/0,n=null;const s=new B(r.x,r.y);return e.forEach(i=>{const a=qj(i,s);a<t&&(t=a,n=i)}),n}function qj(r,e){return Math.sqrt(Math.pow(r.left-e.x,2)+Math.pow(r.top-e.y,2))}const Kj=["transition","image","video","audio","caption","text"];function P_(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(e),{type:n,duration:s=5e3}=t;if(!Kj.includes(n))return;const i=this;i.discardActiveObject();const a=xt(s,i.tScale);ft.guide=Zj({width:a,height:48,id:"TransitionGuide",left:0,top:0,type:n}),i.add(ft.guide),n==="transition"&&(ft.objects=i.getObjects("Transition"),ft.objects.forEach(c=>{c.visible=!0})),De.dispatch(Df)}function Zj({width:r,height:e,id:t,left:n,top:s,type:i}){return i==="transition"?new ca({top:0,left:0,height:48,width:48,id:"TransitionGuide"}):new la({top:s,left:n,height:e,width:r,id:t,name:"Rivers in the mountains"})}function D_(){if(!ft.guide)return;De.dispatch(Qo);const r=this;Jj(ft.objects),r.remove(ft.guide)}function Jj(r){r.forEach(e=>{e.strokeDashArray=[],e.setSelected(!1),e.kind==="none"&&(e.visible=!1)})}var Qj=typeof global=="object"&&global&&global.Object===Object&&global,e7=typeof self=="object"&&self&&self.Object===Object&&self,Lp=Qj||e7||Function("return this")(),gs=Lp.Symbol,R_=Object.prototype,t7=R_.hasOwnProperty,r7=R_.toString,Fo=gs?gs.toStringTag:void 0;function n7(r){var e=t7.call(r,Fo),t=r[Fo];try{r[Fo]=void 0;var n=!0}catch{}var s=r7.call(r);return n&&(e?r[Fo]=t:delete r[Fo]),s}var s7=Object.prototype,i7=s7.toString;function o7(r){return i7.call(r)}var a7="[object Null]",c7="[object Undefined]",s1=gs?gs.toStringTag:void 0;function Fp(r){return r==null?r===void 0?c7:a7:s1&&s1 in Object(r)?n7(r):o7(r)}function Np(r){return r!=null&&typeof r=="object"}var l7="[object Symbol]";function Vp(r){return typeof r=="symbol"||Np(r)&&Fp(r)==l7}function u7(r,e){for(var t=-1,n=r==null?0:r.length,s=Array(n);++t<n;)s[t]=e(r[t],t,r);return s}var ka=Array.isArray,i1=gs?gs.prototype:void 0,o1=i1?i1.toString:void 0;function j_(r){if(typeof r=="string")return r;if(ka(r))return u7(r,j_)+"";if(Vp(r))return o1?o1.call(r):"";var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function Tl(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function h7(r){return r}var d7="[object AsyncFunction]",f7="[object Function]",p7="[object GeneratorFunction]",g7="[object Proxy]";function m7(r){if(!Tl(r))return!1;var e=Fp(r);return e==f7||e==p7||e==d7||e==g7}var id=Lp["__core-js_shared__"],a1=function(){var r=/[^.]+$/.exec(id&&id.keys&&id.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function v7(r){return!!a1&&a1 in r}var y7=Function.prototype,b7=y7.toString;function w7(r){if(r!=null){try{return b7.call(r)}catch{}try{return r+""}catch{}}return""}var x7=/[\\^$.*+?()[\]{}|]/g,_7=/^\[object .+?Constructor\]$/,S7=Function.prototype,C7=Object.prototype,T7=S7.toString,E7=C7.hasOwnProperty,k7=RegExp("^"+T7.call(E7).replace(x7,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function I7(r){if(!Tl(r)||v7(r))return!1;var e=m7(r)?k7:_7;return e.test(w7(r))}function A7(r,e){return r?.[e]}function Bp(r,e){var t=A7(r,e);return I7(t)?t:void 0}function O7(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var M7=800,P7=16,D7=Date.now;function R7(r){var e=0,t=0;return function(){var n=D7(),s=P7-(n-t);if(t=n,s>0){if(++e>=M7)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function j7(r){return function(){return r}}var El=function(){try{var r=Bp(Object,"defineProperty");return r({},"",{}),r}catch{}}(),L7=El?function(r,e){return El(r,"toString",{configurable:!0,enumerable:!1,value:j7(e),writable:!0})}:h7,F7=R7(L7),N7=9007199254740991,V7=/^(?:0|[1-9]\d*)$/;function L_(r,e){var t=typeof r;return e=e??N7,!!e&&(t=="number"||t!="symbol"&&V7.test(r))&&r>-1&&r%1==0&&r<e}function B7(r,e,t){e=="__proto__"&&El?El(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}function F_(r,e){return r===e||r!==r&&e!==e}var z7=Object.prototype,W7=z7.hasOwnProperty;function H7(r,e,t){var n=r[e];(!(W7.call(r,e)&&F_(n,t))||t===void 0&&!(e in r))&&B7(r,e,t)}var c1=Math.max;function U7(r,e,t){return e=c1(e===void 0?r.length-1:e,0),function(){for(var n=arguments,s=-1,i=c1(n.length-e,0),a=Array(i);++s<i;)a[s]=n[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=n[s];return c[e]=t(a),O7(r,this,c)}}var $7=9007199254740991;function Y7(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=$7}var X7="[object Arguments]";function l1(r){return Np(r)&&Fp(r)==X7}var N_=Object.prototype,G7=N_.hasOwnProperty,q7=N_.propertyIsEnumerable,V_=l1(function(){return arguments}())?l1:function(r){return Np(r)&&G7.call(r,"callee")&&!q7.call(r,"callee")},K7=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z7=/^\w*$/;function J7(r,e){if(ka(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||Vp(r)?!0:Z7.test(r)||!K7.test(r)||e!=null&&r in Object(e)}var ua=Bp(Object,"create");function Q7(){this.__data__=ua?ua(null):{},this.size=0}function eL(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var tL="__lodash_hash_undefined__",rL=Object.prototype,nL=rL.hasOwnProperty;function sL(r){var e=this.__data__;if(ua){var t=e[r];return t===tL?void 0:t}return nL.call(e,r)?e[r]:void 0}var iL=Object.prototype,oL=iL.hasOwnProperty;function aL(r){var e=this.__data__;return ua?e[r]!==void 0:oL.call(e,r)}var cL="__lodash_hash_undefined__";function lL(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=ua&&e===void 0?cL:e,this}function Ks(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Ks.prototype.clear=Q7;Ks.prototype.delete=eL;Ks.prototype.get=sL;Ks.prototype.has=aL;Ks.prototype.set=lL;function uL(){this.__data__=[],this.size=0}function fu(r,e){for(var t=r.length;t--;)if(F_(r[t][0],e))return t;return-1}var hL=Array.prototype,dL=hL.splice;function fL(r){var e=this.__data__,t=fu(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():dL.call(e,t,1),--this.size,!0}function pL(r){var e=this.__data__,t=fu(e,r);return t<0?void 0:e[t][1]}function gL(r){return fu(this.__data__,r)>-1}function mL(r,e){var t=this.__data__,n=fu(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}function uo(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}uo.prototype.clear=uL;uo.prototype.delete=fL;uo.prototype.get=pL;uo.prototype.has=gL;uo.prototype.set=mL;var vL=Bp(Lp,"Map");function yL(){this.size=0,this.__data__={hash:new Ks,map:new(vL||uo),string:new Ks}}function bL(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function pu(r,e){var t=r.__data__;return bL(e)?t[typeof e=="string"?"string":"hash"]:t.map}function wL(r){var e=pu(this,r).delete(r);return this.size-=e?1:0,e}function xL(r){return pu(this,r).get(r)}function _L(r){return pu(this,r).has(r)}function SL(r,e){var t=pu(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}function ui(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}ui.prototype.clear=yL;ui.prototype.delete=wL;ui.prototype.get=xL;ui.prototype.has=_L;ui.prototype.set=SL;var CL="Expected a function";function zp(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(CL);var t=function(){var n=arguments,s=e?e.apply(this,n):n[0],i=t.cache;if(i.has(s))return i.get(s);var a=r.apply(this,n);return t.cache=i.set(s,a)||i,a};return t.cache=new(zp.Cache||ui),t}zp.Cache=ui;var TL=500;function EL(r){var e=zp(r,function(n){return t.size===TL&&t.clear(),n}),t=e.cache;return e}var kL=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,IL=/\\(\\)?/g,AL=EL(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(kL,function(t,n,s,i){e.push(s?i.replace(IL,"$1"):n||t)}),e});function OL(r){return r==null?"":j_(r)}function gu(r,e){return ka(r)?r:J7(r,e)?[r]:AL(OL(r))}function Wp(r){if(typeof r=="string"||Vp(r))return r;var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function ML(r,e){e=gu(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Wp(e[t++])];return t&&t==n?r:void 0}function PL(r,e){for(var t=-1,n=e.length,s=r.length;++t<n;)r[s+t]=e[t];return r}var u1=gs?gs.isConcatSpreadable:void 0;function DL(r){return ka(r)||V_(r)||!!(u1&&r&&r[u1])}function RL(r,e,t,n,s){var i=-1,a=r.length;for(t||(t=DL),s||(s=[]);++i<a;){var c=r[i];t(c)?PL(s,c):s[s.length]=c}return s}function jL(r){var e=r==null?0:r.length;return e?RL(r):[]}function LL(r){return F7(U7(r,void 0,jL),r+"")}function FL(r,e){return r!=null&&e in Object(r)}function NL(r,e,t){e=gu(e,r);for(var n=-1,s=e.length,i=!1;++n<s;){var a=Wp(e[n]);if(!(i=r!=null&&t(r,a)))break;r=r[a]}return i||++n!=s?i:(s=r==null?0:r.length,!!s&&Y7(s)&&L_(a,s)&&(ka(r)||V_(r)))}function VL(r,e){return r!=null&&NL(r,e,FL)}function BL(r,e,t,n){if(!Tl(r))return r;e=gu(e,r);for(var s=-1,i=e.length,a=i-1,c=r;c!=null&&++s<i;){var u=Wp(e[s]),h=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(s!=a){var d=c[u];h=void 0,h===void 0&&(h=Tl(d)?d:L_(e[s+1])?[]:{})}H7(c,u,h),c=c[u]}return r}function zL(r,e,t){for(var n=-1,s=e.length,i={};++n<s;){var a=e[n],c=ML(r,a);t(c,a)&&BL(i,gu(a,r),c)}return i}function WL(r,e){return zL(r,e,function(t,n){return VL(r,n)})}var HL=LL(function(r,e){return r==null?{}:WL(r,e)});function B_(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(r.e.dataTransfer.getData(e)),n=this;if(t.type!=="transition"){UL(t),n.remove(ft.guide),n.requestRenderAll(),De.dispatch(Qo);return}ft.guide&&(ft.object&&$L(t,n),ft.objects.forEach(s=>{s.strokeDashArray=[],s.setSelected(!1),s.kind==="none"&&(s.visible=!1)}),n.remove(ft.guide),n.requestRenderAll(),De.dispatch(Qo))}function UL(r){const e={...r,id:Ot()};switch(r.type){case"image":De.dispatch(qi,{payload:e});break;case"video":De.dispatch(Xi,{payload:e});break;case"audio":De.dispatch(Gi,{payload:e});break}}function $L(r,e){const t=ft.object?.id,n=HL(r,["kind","direction"]);Object.entries(n).forEach(([s,i])=>{s==="kind"?ft.object.kind=i:ft.object[s]=i}),e.transitionsMap[t]={...e.transitionsMap[t],...n},e.updateState()}const YL=r=>{r.on("dragover",M_),r.on("dragenter",P_),r.on("dragleave",D_),r.on("drop",B_)},XL=r=>{r.off("dragover",M_),r.off("dragenter",P_),r.off("dragleave",D_),r.off("drop",B_)},z_=r=>{const e=r.target.canvas,t=r.target;if(r.action==="resizing"&&t instanceof Hr&&e){const n=t.id,s=e.getObjects("Transition").find(i=>i.id===n);if(s&&s instanceof Hr){const i=ze.cloneDeep(e.transitionsMap),a={...i,[n]:{...i[n],width:s.width,duration:s.duration}};e.transitionsMap=a,e.updateState()}}e&&(GL(e,e.getObjects()),qL(e.getObjects("Helper")),ee.isPointerOverHelperTrack=!1,ee.draggingOverTrack=null)},GL=(r,e)=>{e.forEach(t=>{t.isAlignmentAuxiliary&&r.remove(t)})},qL=r=>{r.forEach(e=>e.setSelected(!1))};function W_(r){const e=r.target.canvas;if(!e)return;const t=e.getActiveObject();if(!t||!e.positionBeforeTransform)return;const n=e.getScenePoint(r.e),s=e.getObjects("Track","Helper").find(i=>{const a=i.getBoundingRect();return n.x>=a.left&&n.x<=a.left+a.width&&n.y>=a.top&&n.y<=a.top+a.height});if(r.action==="resizing"){const i=(ee.trackToItemsMap[ee.originTrack.id]||[]).filter(c=>c!==t);t.setCoords();const a=mu(i,t.getBoundingRect());return e.fire("track-items:resized",{trackId:ee.originTrack.id,trackItemIds:[t.id],isOverlapped:!!a}),!1}if(!s)return t&&(t?.set(e.positionBeforeTransform),t?.setCoords()),!1;if(s instanceof lo){let i;switch(s.kind){case"top":i=0;break;case"center":i=s.metadata.order||0;break;case"bottom":i=-1;break;default:return}const a={isSecondaryOverlapped:!1,secondaryTracks:ee.secondaryTracks,primaryTracks:ee.primaryTracks,primaryPositions:{trackIndex:i,trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};QL(a)}else if(s instanceof ps){const i={isSecondaryOverlapped:ZL(),secondaryTracks:ee.secondaryTracks,primaryTracks:ee.primaryTracks,primaryPositions:{trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};KL(i)}}const KL=r=>{ee.canvas&&ee.canvas.fire("track-items:moved",r)};function ZL(){const r=JL();return Object.keys(r).some(e=>{const t=ee.trackToItemsMap[e],n=r[e].objects;return t?.length?t.filter(s=>!n.includes(s)).some(s=>mu(n,s.getBoundingRect())):!0})}function JL(){const[r]=ee.primaryMovingObjects,e=r.id,n=ee.canvas.positionAfterTransform[e].top-r.getBoundingRect().top,s={};return ee.secondaryMovingObjects.forEach(i=>{const a=i.getBoundingRect().top+n,c=ee.trackTopToIdMap[a],u=nf(ee.trackTops,ee.originTrack.top,a);s[c]?s[c].objects.push(i):s[c]={objects:[i],index:u}}),s}const QL=r=>{ee.canvas&&ee.canvas.fire("track:create",r)};function mu(r,e){return r.find(t=>{const n=t.getBoundingRect();return e.left<n.left+n.width&&e.left+e.width>n.left&&e.top<n.top+n.height&&e.top+e.height>n.top})}const e9=r=>{r.on("object:modified",z_),r.on("object:modified",W_)},t9=r=>{r.off("object:modified",z_),r.off("object:modified",W_)};function r9(r,e){r.remove(...e),e.length=0}function H_(){r9(this,ee.placeholderMovingObjects)}function U_(r){const e=this.height<this.bounding.height,t=this.width<this.bounding.width;if(!e&&!t)return;const n=this.viewportTransform;let s=n[4],i=n[5];const a=2;r.e.shiftKey?s=n[4]-r.e.deltaY*a:(e&&(i=n[5]-r.e.deltaY*a),s=n[4]-r.e.deltaX*a),this.setViewportPos(s,i)}const n9=r=>{r.on("mouse:wheel",U_),r.on("mouse:up",H_.bind(r))},s9=r=>{r.off("mouse:wheel",U_),r.off("mouse:up",H_.bind(r))};function $_(r){const e=this;if(!e)return;const t=e.getScenePoint(r.e),n=e.getObjects("Helper","Track");ee.draggingOverTrack=n.find(h=>{const d=h.getBoundingRect();return t.x>=d.left&&t.x<=d.left+d.width&&t.y>=d.top&&t.y<=d.top+d.height})??null,n.forEach(h=>{if(d1(h)){const d=ee.draggingOverTrack;h.setSelected(h===d)}}),ee.isPointerOverHelperTrack=d1(ee.draggingOverTrack),e.getObjects();const s=r.target;s.getBoundingRect(),s.setCoords();const i=[s,...e.getActiveObjects(),...e.getObjects("Track","Helper","Transition","Placeholder")],a=i9(i,e),c=a9(s);o9(a,c).forEach(h=>{h.orientation==="V"?s.left=h.lineGuide+h.offset:s.top=h.lineGuide+h.offset})}const i9=(r,e)=>{const t=[],n=[];return e.getObjects().filter(s=>s.visible).forEach(s=>{if(r.some(c=>c.id===s.id)||s.isAlignmentAuxiliary)return;const a=s.getBoundingRect();t.push(h1(a.left,a.width,a.top,a.height)),n.push(h1(a.top,a.height,a.left,a.width))}),{vertical:t.flat(),horizontal:[]}},h1=(r,e,t,n)=>[r,r+e].map(s=>({val:s,start:t,end:t+n})),o9=(r,e)=>{const t=[],n=[];r.vertical.forEach(u=>{e.vertical.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&t.push({lineGuide:u.val,diff:d,orientation:"V",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})}),r.horizontal.forEach(u=>{e.horizontal.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&n.push({lineGuide:u.val,diff:d,orientation:"H",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})});const i=[],a=t.sort((u,h)=>u.diff-h.diff)[0],c=n.sort((u,h)=>u.diff-h.diff)[0];return a&&i.push({lineGuide:a.lineGuide,offset:a.offset,orientation:"V",snap:a.snap,targetDim:a.targetDim}),c&&i.push({lineGuide:c.lineGuide,offset:c.offset,orientation:"H",snap:c.snap,targetDim:c.targetDim}),i},a9=r=>{const e=r.getBoundingRect();return{vertical:[{guide:Math.round(e.left),offset:Math.round(r.left-e.left),snap:"start"},{guide:Math.round(e.left+e.width),offset:Math.round(r.left-e.left-e.width),snap:"end"}],horizontal:[{guide:Math.round(e.top),offset:Math.round(r.top-e.top),snap:"start"},{guide:Math.round(e.top+e.height),offset:Math.round(r.top-e.top-e.height),snap:"end"}]}},d1=r=>r instanceof lo;function c9(r){r.opacity=ee.isPointerOverHelperTrack?0:1}const Y_=g9(r=>{const e=r.target.canvas;if(m9(r),!ee.draggingOverTrack)return;const t=ee.placeholderMovingObjects.map(i=>i.draggedObject),n=(ee.trackToItemsMap[ee.draggingOverTrack.id]||[]).filter(i=>!t.includes(i)),s=n.find(i=>mu(t,i.getBoundingRect()));ee.placeholderMovingObjects.forEach(i=>{const a=i.draggedObject;a?.setCoords(),c9(i);const c=l9(a,n,s,ee.placeholderMovingObjects.length>1);e.trackIdAfterTransform=ee.trackTopToIdMap[c.top],e.positionAfterTransform[a?.id]={top:c.top,left:c.left},i.left=c.left,i.top=c.top})},5),l9=(r,e,t,n)=>!u9(r)||n&&t?X_(r):t?h9(r,t,e):p9(r),u9=r=>ee.draggingOverTrack?ee.draggingOverTrack.accepts?.includes(r.type)??!1:!1,X_=r=>({top:ee.objectInitialPositions[r.id].top,left:ee.objectInitialPositions[r.id].left}),h9=(r,e,t)=>{const n=d9(r,e);return!f9(t,r,n)||ee.activeObjects.length!==1?X_(r):{left:n,top:e.top}},d9=(r,e)=>{const t=r.left+r.width/2,n=e.left+e.width/2;return t<n?e.left-r.width:e.left+e.width},f9=(r,e,t)=>!(t<0||mu(r,{...e.getBoundingRect(),left:t})),p9=r=>({left:r.getBoundingRect().left,top:ee.draggingOverTrack?.top??0});function g9(r,e){let t=null;return function(...n){const s=Date.now();(t===null||s-t>=e)&&(t=s,r(...n))}}function m9(r){const e=r.target,t=e.canvas,n=e.top,s=-e.height*.75,i=t.height+e.height*.75;e.top=Math.min(Math.max(n,s),i-e.height);const a=e.left;e.left=Math.max(a,0)}const v9=r=>{r.on("object:moving",$_.bind(r)),r.on("object:moving",Y_)},y9=r=>{r.off("object:moving",$_.bind(r)),r.off("object:moving",Y_)};function G_(){const r=this,e=r.getActiveObject(),t=r.getActiveObjects().map(n=>n.id);e instanceof zr?(e.borderColor="rgba(0, 216, 214, 0.75)",e.hasControls=!1,e.hoverCursor="default",e.borderScaleFactor=1,e.padding=0,e.getObjects().forEach(n=>{n.setSelected(!0)})):e?.setSelected(!0),this.setActiveIds(t)}function q_(r){const e=this,t=e.getActiveObject();t instanceof zr&&(t.borderColor="transparent",t.hasControls=!1,t.hoverCursor="default"),r.selected.forEach(s=>{s.setSelected(!0)}),r.deselected.forEach(s=>{s.setSelected(!1)});const n=e.getActiveObjects().map(s=>s.id);this.setActiveIds(n)}function K_(r){this.getObjects().forEach(t=>{t.isSelected&&(t.isSelected=!1)}),r.deselected.forEach(t=>{t.setSelected(!1)});const e=this.getActiveObjects().map(t=>t.id);this.setActiveIds(e)}const b9=r=>{r.on("selection:created",G_),r.on("selection:updated",q_),r.on("selection:cleared",K_)},w9=r=>{r.off("selection:created",G_),r.off("selection:updated",q_),r.off("selection:cleared",K_)};let Z_,J_,Q_;const x9=r=>{const{state:e}=r;Z_=e.subscribeToActiveIds(({activeIds:t})=>{if(t.length===1){const n=t[0],{trackItemIds:s,trackItemsMap:i}=e.getState();s.forEach(a=>{i[a].type}),r.selectTrackItemByIds([n])}else r.selectTrackItemByIds(t)}),J_=e.subscribeToHistory(t=>{const{tracks:n,trackItemsMap:s,trackItemIds:i,trackItemDetailsMap:a}=t;r.tracks=n,r.trackItemsMap=s,r.trackItemIds=i,r.trackItemDetailsMap=a,r.renderTracks(),r.updateTrackItemsToHistory(),r.alignItemsToTrack(),r.calcBounding(),r.updateTransitions(),r.duration=on(r.trackItemsMap)}),Q_=e.subscribeToAddOrRemoveItems(()=>{const t=r.getTrackItems().map(c=>c.id),{trackItemIds:n,trackItemsMap:s,trackItemDetailsMap:i}=e.getState(),a=[];t.forEach(c=>{n.includes(c)||a.push(c)}),r.deleteTrackItemById(a),r.tracks=e.getState().tracks,r.trackItemsMap=s,r.trackItemDetailsMap=i,n.forEach(c=>{if(!t.includes(c)){const u={...s[c],details:{...i[c].details}};r.addTrackItem(u)}}),r.renderTracks(),r.alignItemsToTrack(),n.forEach(c=>{r.updateTrackItemCoords(c)}),r.updateTransitions(),r.updateTrackCoords()})},_9=r=>{Z_.unsubscribe(),J_.unsubscribe(),Q_.unsubscribe()};function eS(r){const{isSecondaryOverlapped:e,secondaryTracks:t,primaryTracks:n,primaryPositions:s}=r,{trackId:i,positions:a}=s,c=this.tracks.findIndex(y=>y.id===i),u=Vf(Object.keys(t).map(y=>t[y].objects.map(w=>w.id))),h=ea(this.tracks,[...Object.keys(a),...u]);Object.keys(n).forEach(y=>{this.pauseEventListeners();const{objects:w}=n[y];w.forEach(S=>{const T=a[S.id];S.left=T.left}),this.resumeEventListeners();const _=h.find(S=>S.id===i);_&&_.items.push(...Object.keys(a)),this.tracks=h});const d=this.tracks[c],p=[];Object.keys(t).forEach(y=>{const{objects:w,index:_}=t[y],S=w.map(I=>I.id),[T]=S,k=this.trackItemsMap[T];if(e){const I={id:Ot(),items:S,type:k.type,accepts:this.acceptsMap?.[k.type],tempIndex:_};p.push(I)}else{const I=h[c+_];I&&I.items.push(...S),this.tracks=h}});const g=Bf(d,p);g.length&&h.splice(c,1,...g),this.tracks=h,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}function tS({trackItemIds:r,isOverlapped:e}){const[t]=r;if(t){if(!this.getObjects("Transition").find(n=>n.id===t)){const n=this.tracks.find(s=>s.items.includes(t));if(e){const s=S9(this.tracks,r),i={id:Ot(),items:[t],type:n?.type,accepts:n?.accepts},a=this.tracks.findIndex(c=>c.id===n?.id);s.splice(a,0,i),this.tracks=s}}this.renderTracks(),this.alignItemsToTrack(),this.alignTransitionsToTrack(),this.updateTransitions(),this.updateTrackItemsPosition(),this.updateState({updateHistory:!0,kind:"update"})}}function S9(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}function rS(r){const{secondaryTracks:e,primaryTracks:t,primaryPositions:n}=r,{positions:s,trackIndex:i}=n,a=i===-1?this.tracks.length:i,[c]=Object.keys(t),u=this.tracks.find(_=>_.id==c),h=t[c],d={id:Ot(),items:h.objects.map(_=>_.id),type:u?.type,accepts:u?.accepts},p=Vf(Object.keys(e).map(_=>e[_].objects.map(S=>S.id))),g=ea(this.tracks,[...Object.keys(s),...p]),y=[];Object.keys(e).forEach(_=>{const{objects:S,index:T}=e[_],k=this.tracks.find(D=>D.id==_),I=S.map(D=>D.id),A={id:Ot(),items:I,type:k?.type,accepts:k?.accepts,tempIndex:T};y.push(A)});const w=Bf(d,y);w.length&&g.splice(a,0,...w),this.tracks=g,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}const C9=r=>{r.on("track:create",rS.bind(r)),r.on("track-items:resized",tS.bind(r)),r.on("track-items:moved",eS.bind(r))},T9=r=>{r.off("track:create",rS.bind(r)),r.off("track-items:resized",tS.bind(r)),r.off("track-items:moved",eS.bind(r))},nS=r=>{YL(r),e9(r),n9(r),v9(r),C9(r),b9(r),$j(r),x9(r)},sS=r=>{XL(r),t9(r),s9(r),y9(r),T9(r),w9(r),Yj(r),_9()},E9={video:["*"],image:["*"],audio:["*"],text:["*"]},k9=["video","image","audio","text"];let vu=class extends Qd{acceptsMap;tracks=[];trackItemsMap={};trackItemIds=[];transitionIds=[];transitionsMap={};trackItemDetailsMap={};bounding;onScroll;tScale;store;state;activeIds=[];spacing;scale;sizesMap;duration;setupFabricDefaults(){Ke.ownDefaults.borderColor="transparent",Ke.ownDefaults.cornerColor="white",Ke.ownDefaults.cornerStrokeColor="transparent",Ke.ownDefaults.strokeWidth=0,Ke.ownDefaults.borderOpacityWhenMoving=1,Ke.ownDefaults.borderScaleFactor=1,Ke.ownDefaults.cornerSize=8,Ke.ownDefaults.cornerStyle="rect",Ke.ownDefaults.centeredScaling=!1,Ke.ownDefaults.centeredRotation=!0,Ke.ownDefaults.transparentCorners=!1}constructor(e,t){super(e,t),this.bounding=t.bounding||{width:t.width||0,height:t.height||0},this.spacing={left:16,right:80,...t.spacing};const n=this.viewportTransform;n[4]=this.spacing.left,this.tScale=t.tScale||1/300,this.store=t.store,this.state=t.state,this.scale=t.scale,this.onScroll=t.onScroll,this.acceptsMap=this.createAcceptsItemMap(t.acceptsMap),this.sizesMap=x_(t.sizesMap),this.setupFabricDefaults(),this.initEventListeners()}createAcceptsItemMap(e=E9){const t={};return Object.keys(e).forEach(n=>{const s=e[n];t[n]=s.includes("*")?k9:s}),t}setActiveIds(e){this.activeIds=e,this.getObjects("Transition").some(n=>e.includes(n.id))||(this.state?.updateState({activeIds:ze.cloneDeep(this.activeIds)}),De.dispatch(Af,{payload:{activeIds:this.activeIds}}))}purge(){sS(this),this.dispose()}static registerItems(e){Object.keys(e).forEach(t=>{ne.setClass(e[t],t)})}initEventListeners(){nS(this)}getUpdatedState(){const e=on(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,scale:this.scale,duration:e}}getState(){const e=on(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,trackItemDetailsMap:this.trackItemDetailsMap,scale:this.scale,duration:e}}notify(e={updateHistory:!1}){const t=this.getUpdatedState();this.state.updateState(t,e)}updateState(e){this.updateTracksState(),this.updateTrackItemsState(),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords();const t=this.getUpdatedState();this.state.updateState(t,e)}scrollTo({scrollLeft:e,scrollTop:t}){const n=[...this.viewportTransform];let s=!1;if(typeof e=="number"&&(n[4]=-e+this.spacing.left,s=!0),typeof t=="number"&&(n[5]=-t,s=!0),s){this.viewportTransform=n;const i=this.getActiveObject();i&&i.setCoords(),this.requestRenderAll()}}setBoundingBox(e){this.bounding=e}calcBounding(){const e=this.getTrackItems().reduce((t,n)=>{const{left:s,top:i,width:a,height:c}=n.getBoundingRect();return{left:Math.min(t.left,s),top:Math.min(t.top,i),width:Math.max(t.width,s+a),height:Math.max(t.height,i+c)}},{left:1/0,top:1/0,width:this.width,height:0});this.bounding=e,De.dispatch(Rf,{payload:{bounding:e}})}setScale(e){this.pauseEventListeners(),this.tScale=e.zoom,this.scale=e;const t=this.getState();this.getObjects("Video","Image","Text","Audio").forEach(n=>{const s=t.trackItemsMap[n.id],{from:i,to:a}=s.display,c=xt(i,this.tScale),u=xt(a-i,this.tScale,n.playbackRate);n.set({left:c,width:u,tScale:e.zoom}),n.setCoords()}),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords(),this.updateTransitions(!1),this.resumeEventListeners(),this.notify()}setViewportPos(e,t){const n=this.getViewportPos(e,t),s=this.viewportTransform;s[4]=n.x,s[5]=n.y,this.requestRenderAll(),this.setActiveTrackItemCoords();const i=this.onScroll;i&&i.call(this,{scrollTop:n.y,scrollLeft:n.x-this.spacing.left})}getViewportPos(e,t){const n=this.bounding.width-100>=this.width?this.spacing.right:0,s=this.width-this.bounding.width-n,i=this.spacing.left,a=Math.max(s,Math.min(e,i));if(this.bounding.height<this.height)return{x:a,y:0};const c=this.height-this.bounding.height-40,u=Math.max(c,Math.min(t,0));return{x:a,y:u}}};o_(vu,[t_,k_,I_,A_]);function iS(r){const e=De.subject.pipe(Fn(({key:t})=>t.startsWith(My))).subscribe(t=>{if(t.key===Pf){const n=t.value;r.setScale(n?.payload.scale??void 0)}});return{unsubscribe:()=>{e.unsubscribe()}}}vu.registerItems({Text:jp,Image:C_,Video:S_,Audio:__,Track:T_,Helper:E_});const oS=({stateManager:r})=>{const e=v.useRef(!1),[t,n]=v.useState(0),s=v.useRef(null),i=v.useRef(null),a=v.useRef(null),c=v.useRef(null),u=v.useRef(null),[h,d]=v.useState({width:0,height:0}),[p,g]=v.useState({width:0,height:0}),{scale:y,playerRef:w,fps:_,setState:S,timeline:T}=bn(),{setTimeline:k}=bn(),I=Fl(w??void 0),A=F=>{u.current&&c.current&&(c.current.scrollTop=-F.scrollTop,u.current.scrollLeft=-F.scrollLeft,n(-F.scrollLeft))};v.useEffect(()=>{const F=xt(I/_*1e3,y.zoom),Y=i.current?.getBoundingClientRect().x+i.current?.clientWidth;if(F-t+40>=Y){const q=u.current?.clientWidth,U=u.current?.scrollWidth,X=u.current?.scrollLeft,de=(U-(q+X))/q;de>=0&&(de>1?u.current?.scrollTo({left:X+q}):u.current?.scrollTo({left:U-q}))}},[I]),v.useEffect(()=>{const F=i.current,Y=s.current;if(!F||!Y)return;const W=Y.clientWidth,q=Y.clientHeight,U=new vu(F,{width:W,height:q,bounding:{width:W,height:0},selectionColor:"rgba(0, 216, 214,0.1)",selectionBorderColor:"rgba(0, 216, 214,1.0)",onScroll:A,state:r,scale:y,spacing:{left:Ll,right:Cd}}),X=iS(U);a.current=U,d({width:W,height:q}),g({width:W,height:0}),k(U);const te=r.subscribeToSize(re=>{S(re)}),de=r.subscribeToScale(re=>{S(re)}),J=r.subscribeToTracks(re=>{S(re)}),le=r.subscribeToDuration(re=>{S(re)}),ie=r.subscribeToUpdateTrackItem(()=>{const re=r.getState();S({duration:re.duration,trackItemsMap:re.trackItemsMap})}),se=r.subscribeToAddOrRemoveItems(()=>{const re=r.getState();S({trackItemDetailsMap:re.trackItemDetailsMap,trackItemsMap:re.trackItemsMap,trackItemIds:re.trackItemIds,tracks:re.tracks})}),he=r.subscribeToUpdateItemDetails(()=>{const re=r.getState();S({trackItemDetailsMap:re.trackItemDetailsMap})});return()=>{X.unsubscribe(),U.purge(),de.unsubscribe(),J.unsubscribe(),le.unsubscribe(),se.unsubscribe(),ie.unsubscribe(),he.unsubscribe(),te.unsubscribe()}},[]),v.useEffect(()=>{const Y=De.subject.pipe(Fn(({key:W})=>W.startsWith(Dy))).subscribe(W=>{if(W.key===Rf){const q=W.value?.payload?.bounding;q&&g({width:q.width,height:q.height})}});return()=>{Y.unsubscribe()}},[]);const D=F=>{const Y=F.currentTarget.scrollLeft;e.current&&a.current.scrollTo({scrollLeft:Y}),n(Y)},L=F=>{const Y=F.currentTarget.scrollTop;e.current&&a.current.scrollTo({scrollTop:Y})};v.useEffect(()=>{const F=u.current?.scrollWidth;if(!F||!T)return;const Y=T.width;F<Y+t&&T.scrollTo({scrollLeft:F-Y})},[y]);const z=F=>{if(!a.current)return;const W=cs(F,y.zoom);w?.current?.seekTo(W*_/1e3)};return b.jsxs("div",{className:"relative overflow-hidden h-80 w-full",children:[b.jsx(ob,{}),b.jsx(bw,{onClick:z,scrollLeft:t}),b.jsx(yw,{scrollLeft:t}),b.jsxs("div",{className:"flex",children:[b.jsx("div",{className:"relative w-10 flex-none"}),b.jsxs("div",{className:"relative h-[230px] flex-1",children:[b.jsx("div",{ref:s,className:"absolute top-0 h-[230px] w-full text-sm text-white ",children:b.jsx("canvas",{ref:i,id:"designcombo-timeline-canvas"})}),b.jsxs(nl,{type:"always",style:{position:"absolute",width:"calc(100vw - 40px)",height:"10px"},className:"ScrollAreaRootH",children:[b.jsx(md,{onScroll:D,className:"ScrollAreaViewport",id:"viewportH",ref:u,children:b.jsx("div",{style:{width:p.width>h.width?p.width+Cd:p.width},className:"pointer-events-none h-[10px]"})}),b.jsx(Ov,{className:"ScrollAreaScrollbar",orientation:"horizontal",children:b.jsx(Mv,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]}),b.jsxs(nl,{type:"always",style:{position:"absolute",height:"230px",width:"10px"},className:"ScrollAreaRootV",children:[b.jsx(md,{onScroll:L,className:"ScrollAreaViewport",ref:c,children:b.jsx("div",{style:{height:p.height>h.height?p.height+40:h.height},className:"pointer-events-none w-[10px]"})}),b.jsx(Ov,{className:"ScrollAreaScrollbar",orientation:"vertical",children:b.jsx(Mv,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]})]})]})]})},I9={Date:!0,RegExp:!0,String:!0,Number:!0};function aS(r,e,t={cyclesFix:!0},n=[]){let s=[];const i=Array.isArray(r);for(const c in r){const u=r[c],h=i?+c:c;if(!(c in e)){s.push({type:"REMOVE",path:[h],oldValue:r[c]});continue}const d=e[c],p=typeof u=="object"&&typeof d=="object"&&Array.isArray(u)===Array.isArray(d);u&&d&&p&&!I9[Object.getPrototypeOf(u)?.constructor?.name]&&(!t.cyclesFix||!n.includes(u))?s.push.apply(s,aS(u,d,t,t.cyclesFix?n.concat([u]):[]).map(g=>(g.path.unshift(h),g))):u!==d&&!(Number.isNaN(u)&&Number.isNaN(d))&&!(p&&(isNaN(u)?u+""==d+"":+u==+d))&&s.push({path:[h],type:"CHANGE",value:d,oldValue:u})}const a=Array.isArray(e);for(const c in e)c in r||s.push({type:"CREATE",path:[a?+c:c],value:e[c]});return s}var Hp=Symbol.for("immer-nothing"),Zo=Symbol.for("immer-draftable"),Ir=Symbol.for("immer-state"),cS=process.env.NODE_ENV!=="production"?[function(r){return`The plugin for '${r}' has not been loaded into Immer. To enable the plugin, import and call \`enable${r}()\` when initializing your application.`},function(r){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${r}'`},"This object has been frozen and should not be mutated",function(r){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+r},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(r){return`'current' expects a draft, got: ${r}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(r){return`'original' expects a draft, got: ${r}`}]:[];function At(r,...e){if(process.env.NODE_ENV!=="production"){const t=cS[r],n=typeof t=="function"?t.apply(null,e):t;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var Zs=Object.getPrototypeOf;function Js(r){return!!r&&!!r[Ir]}function ms(r){return r?lS(r)||Array.isArray(r)||!!r[Zo]||!!r.constructor?.[Zo]||Ia(r)||Aa(r):!1}var A9=Object.prototype.constructor.toString();function lS(r){if(!r||typeof r!="object")return!1;const e=Zs(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===A9}function ha(r,e){Qs(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,n)=>e(n,t,r))}function Qs(r){const e=r[Ir];return e?e.type_:Array.isArray(r)?1:Ia(r)?2:Aa(r)?3:0}function da(r,e){return Qs(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function od(r,e){return Qs(r)===2?r.get(e):r[e]}function uS(r,e,t){const n=Qs(r);n===2?r.set(e,t):n===3?r.add(t):r[e]=t}function O9(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function Ia(r){return r instanceof Map}function Aa(r){return r instanceof Set}function Ls(r){return r.copy_||r.base_}function sf(r,e){if(Ia(r))return new Map(r);if(Aa(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=lS(r);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(r);delete n[Ir];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const a=s[i],c=n[a];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[a]={configurable:!0,writable:!0,enumerable:c.enumerable,value:r[a]})}return Object.create(Zs(r),n)}else{const n=Zs(r);if(n!==null&&t)return{...r};const s=Object.create(n);return Object.assign(s,r)}}function Up(r,e=!1){return yu(r)||Js(r)||!ms(r)||(Qs(r)>1&&(r.set=r.add=r.clear=r.delete=M9),Object.freeze(r),e&&Object.entries(r).forEach(([t,n])=>Up(n,!0))),r}function M9(){At(2)}function yu(r){return Object.isFrozen(r)}var of={};function ei(r){const e=of[r];return e||At(0,r),e}function P9(r,e){of[r]||(of[r]=e)}var fa;function hS(){return fa}function D9(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function f1(r,e){e&&(ei("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function af(r){cf(r),r.drafts_.forEach(R9),r.drafts_=null}function cf(r){r===fa&&(fa=r.parent_)}function p1(r){return fa=D9(fa,r)}function R9(r){const e=r[Ir];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function g1(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[Ir].modified_&&(af(e),At(4)),ms(r)&&(r=kl(e,r),e.parent_||Il(e,r)),e.patches_&&ei("Patches").generateReplacementPatches_(t[Ir].base_,r,e.patches_,e.inversePatches_)):r=kl(e,t,[]),af(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==Hp?r:void 0}function kl(r,e,t){if(yu(e))return e;const n=e[Ir];if(!n)return ha(e,(s,i)=>m1(r,n,e,s,i,t)),e;if(n.scope_!==r)return e;if(!n.modified_)return Il(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,a=!1;n.type_===3&&(i=new Set(s),s.clear(),a=!0),ha(i,(c,u)=>m1(r,n,s,c,u,t,a)),Il(r,s,!1),t&&r.patches_&&ei("Patches").generatePatches_(n,t,r.patches_,r.inversePatches_)}return n.copy_}function m1(r,e,t,n,s,i,a){if(process.env.NODE_ENV!=="production"&&s===t&&At(5),Js(s)){const c=i&&e&&e.type_!==3&&!da(e.assigned_,n)?i.concat(n):void 0,u=kl(r,s,c);if(uS(t,n,u),Js(u))r.canAutoFreeze_=!1;else return}else a&&t.add(s);if(ms(s)&&!yu(s)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;kl(r,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&Il(r,s)}}function Il(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&Up(e,t)}function j9(r,e){const t=Array.isArray(r),n={type_:t?1:0,scope_:e?e.scope_:hS(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=$p;t&&(s=[n],i=pa);const{revoke:a,proxy:c}=Proxy.revocable(s,i);return n.draft_=c,n.revoke_=a,c}var $p={get(r,e){if(e===Ir)return r;const t=Ls(r);if(!da(t,e))return L9(r,t,e);const n=t[e];return r.finalized_||!ms(n)?n:n===ad(r.base_,e)?(cd(r),r.copy_[e]=uf(n,r)):n},has(r,e){return e in Ls(r)},ownKeys(r){return Reflect.ownKeys(Ls(r))},set(r,e,t){const n=dS(Ls(r),e);if(n?.set)return n.set.call(r.draft_,t),!0;if(!r.modified_){const s=ad(Ls(r),e),i=s?.[Ir];if(i&&i.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(O9(t,s)&&(t!==void 0||da(r.base_,e)))return!0;cd(r),lf(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return ad(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,cd(r),lf(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=Ls(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){At(11)},getPrototypeOf(r){return Zs(r.base_)},setPrototypeOf(){At(12)}},pa={};ha($p,(r,e)=>{pa[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});pa.deleteProperty=function(r,e){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(e))&&At(13),pa.set.call(this,r,e,void 0)};pa.set=function(r,e,t){return process.env.NODE_ENV!=="production"&&e!=="length"&&isNaN(parseInt(e))&&At(14),$p.set.call(this,r[0],e,t,r[0])};function ad(r,e){const t=r[Ir];return(t?Ls(t):r)[e]}function L9(r,e,t){const n=dS(e,t);return n?"value"in n?n.value:n.get?.call(r.draft_):void 0}function dS(r,e){if(!(e in r))return;let t=Zs(r);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=Zs(t)}}function lf(r){r.modified_||(r.modified_=!0,r.parent_&&lf(r.parent_))}function cd(r){r.copy_||(r.copy_=sf(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var F9=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const a=this;return function(u=i,...h){return a.produce(u,d=>t.call(this,d,...h))}}typeof t!="function"&&At(6),n!==void 0&&typeof n!="function"&&At(7);let s;if(ms(e)){const i=p1(this),a=uf(e,void 0);let c=!0;try{s=t(a),c=!1}finally{c?af(i):cf(i)}return f1(i,n),g1(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===Hp&&(s=void 0),this.autoFreeze_&&Up(s,!0),n){const i=[],a=[];ei("Patches").generateReplacementPatches_(e,s,i,a),n(i,a)}return s}else At(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...c)=>this.produceWithPatches(a,u=>e(u,...c));let n,s;return[this.produce(e,t,(a,c)=>{n=a,s=c}),n,s]},typeof r?.autoFreeze=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof r?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){ms(r)||At(8),Js(r)&&(r=N9(r));const e=p1(this),t=uf(r,void 0);return t[Ir].isManual_=!0,cf(e),t}finishDraft(r,e){const t=r&&r[Ir];(!t||!t.isManual_)&&At(9);const{scope_:n}=t;return f1(n,e),g1(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){r=s.value;break}}t>-1&&(e=e.slice(t+1));const n=ei("Patches").applyPatches_;return Js(r)?n(r,e):this.produce(r,s=>n(s,e))}};function uf(r,e){const t=Ia(r)?ei("MapSet").proxyMap_(r,e):Aa(r)?ei("MapSet").proxySet_(r,e):j9(r,e);return(e?e.scope_:hS()).drafts_.push(t),t}function N9(r){return Js(r)||At(10,r),fS(r)}function fS(r){if(!ms(r)||yu(r))return r;const e=r[Ir];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=sf(r,e.scope_.immer_.useStrictShallowCopy_)}else t=sf(r,!0);return ha(t,(n,s)=>{uS(t,n,fS(s))}),e&&(e.finalized_=!1),t}function v1(){process.env.NODE_ENV!=="production"&&cS.push('Sets cannot have "replace" patches.',function(g){return"Unsupported patch operation: "+g},function(g){return"Cannot apply patch, path doesn't resolve: "+g},"Patching reserved attributes like __proto__, prototype and constructor is not allowed");const e="replace",t="add",n="remove";function s(g,y,w,_){switch(g.type_){case 0:case 2:return a(g,y,w,_);case 1:return i(g,y,w,_);case 3:return c(g,y,w,_)}}function i(g,y,w,_){let{base_:S,assigned_:T}=g,k=g.copy_;k.length<S.length&&([S,k]=[k,S],[w,_]=[_,w]);for(let I=0;I<S.length;I++)if(T[I]&&k[I]!==S[I]){const A=y.concat([I]);w.push({op:e,path:A,value:p(k[I])}),_.push({op:e,path:A,value:p(S[I])})}for(let I=S.length;I<k.length;I++){const A=y.concat([I]);w.push({op:t,path:A,value:p(k[I])})}for(let I=k.length-1;S.length<=I;--I){const A=y.concat([I]);_.push({op:n,path:A})}}function a(g,y,w,_){const{base_:S,copy_:T}=g;ha(g.assigned_,(k,I)=>{const A=od(S,k),D=od(T,k),L=I?da(S,k)?e:t:n;if(A===D&&L===e)return;const z=y.concat(k);w.push(L===n?{op:L,path:z}:{op:L,path:z,value:D}),_.push(L===t?{op:n,path:z}:L===n?{op:t,path:z,value:p(A)}:{op:e,path:z,value:p(A)})})}function c(g,y,w,_){let{base_:S,copy_:T}=g,k=0;S.forEach(I=>{if(!T.has(I)){const A=y.concat([k]);w.push({op:n,path:A,value:I}),_.unshift({op:t,path:A,value:I})}k++}),k=0,T.forEach(I=>{if(!S.has(I)){const A=y.concat([k]);w.push({op:t,path:A,value:I}),_.unshift({op:n,path:A,value:I})}k++})}function u(g,y,w,_){w.push({op:e,path:[],value:y===Hp?void 0:y}),_.push({op:e,path:[],value:g})}function h(g,y){return y.forEach(w=>{const{path:_,op:S}=w;let T=g;for(let D=0;D<_.length-1;D++){const L=Qs(T);let z=_[D];typeof z!="string"&&typeof z!="number"&&(z=""+z),(L===0||L===1)&&(z==="__proto__"||z==="constructor")&&At(19),typeof T=="function"&&z==="prototype"&&At(19),T=od(T,z),typeof T!="object"&&At(18,_.join("/"))}const k=Qs(T),I=d(w.value),A=_[_.length-1];switch(S){case e:switch(k){case 2:return T.set(A,I);case 3:At(16);default:return T[A]=I}case t:switch(k){case 1:return A==="-"?T.push(I):T.splice(A,0,I);case 2:return T.set(A,I);case 3:return T.add(I);default:return T[A]=I}case n:switch(k){case 1:return T.splice(A,1);case 2:return T.delete(A);case 3:return T.delete(w.value);default:return delete T[A]}default:At(17,S)}}),g}function d(g){if(!ms(g))return g;if(Array.isArray(g))return g.map(d);if(Ia(g))return new Map(Array.from(g.entries()).map(([w,_])=>[w,d(_)]));if(Aa(g))return new Set(Array.from(g).map(d));const y=Object.create(Zs(g));for(const w in g)y[w]=d(g[w]);return da(g,Zo)&&(y[Zo]=g[Zo]),y}function p(g){return Js(g)?d(g):g}P9("Patches",{applyPatches_:h,generatePatches_:s,generateReplacementPatches_:u})}var Ar=new F9,V9=Ar.produce;Ar.produceWithPatches.bind(Ar);Ar.setAutoFreeze.bind(Ar);Ar.setUseStrictShallowCopy.bind(Ar);var B9=Ar.applyPatches.bind(Ar);Ar.createDraft.bind(Ar);Ar.finishDraft.bind(Ar);function z9(r){const e=r.value,t=[];if(e?.payload?.trackItemIds){const n=e.payload.trackItemIds;t.push(n),this.updateState({activeIds:t})}if(r.key===Ef){const n=r.value?.payload.trackItemIds,s=ze.cloneDeep(this.getState()),i=n?.length?n:s.activeIds,a=s.trackItemIds.filter(p=>!i.includes(p)),c=Object.fromEntries(Object.entries(s.trackItemDetailsMap).filter(([p])=>!i.includes(p))),u=d_(s.tracks,i),h=Object.fromEntries(Object.entries(s.trackItemsMap).filter(([p])=>!i.includes(p))),d=on(h);this.updateState({trackItemIds:a,trackItemDetailsMap:c,activeIds:[],trackItemsMap:h,tracks:u,duration:d},{updateHistory:!0,kind:"remove"})}if(r.key===kf){const n=ze.cloneDeep(this.getState()),s=[],i=r.value?.payload.trackItemIds||n.activeIds;if(i.length===0)return;i.forEach(c=>{const u=n.trackItemsMap[c],h=n.trackItemDetailsMap[c],d=Ot();s.push(d),n.trackItemsMap={...n.trackItemsMap,[d]:{...ze.cloneDeep(u),id:d}},n.trackItemDetailsMap={...n.trackItemDetailsMap,[d]:{...ze.cloneDeep(h)}},n.trackItemIds.push(d)});const a=n.tracks.map(c=>{const u={...c,id:Ot(),items:c.items.filter(h=>i.includes(h)).map(h=>{const d=i.indexOf(h);return s[d]})};return u.items.length?u:null}).filter(Boolean);n.tracks.unshift(...a),this.updateState({trackItemDetailsMap:n.trackItemDetailsMap,tracks:n.tracks,trackItemIds:n.trackItemIds,trackItemsMap:n.trackItemsMap},{updateHistory:!0,kind:"update"})}if(r.key===If){const n=ze.cloneDeep(this.getState()),s=r.value?.options.time;if(n.activeIds.length!==1)return;const i=n.activeIds[0],a=n.trackItemsMap[i];if(s<=a.display.from||s>=a.display.to)return;const c=Ot(),u={...a,id:c,display:{from:s,to:a.display.to},trim:{from:s,to:a.display.to}};n.trackItemsMap[i].display.to=s,n.trackItemsMap[c]=u,n.trackItemDetailsMap[c]=n.trackItemDetailsMap[i],n.trackItemIds.push(c),n.tracks.forEach(h=>{h.items.includes(i)&&h.items.push(c)}),this.updateState({trackItemsMap:n.trackItemsMap,trackItemDetailsMap:n.trackItemDetailsMap,trackItemIds:n.trackItemIds,tracks:n.tracks},{updateHistory:!0,kind:"update"})}}async function W9(r){if(r.key==="scene:load"){const e=r.value?.payload,t=e.size,n=e.trackItemIds,s=e.trackItemsMap,i=e.trackItemDetailsMap;if(!n)return;const a=n?.map(async u=>{try{const h=i[u],d=s[u];if(h.type==="text"){const p=await Rp({id:u,details:h.details,...d},{size:t}),{details:g,...y}=p;i[u]={type:"text",details:g},s[u]=y}return!0}catch{return!1}});await Promise.all(a);const c=on(s);this.updateState({...e,trackItemsMap:s,duration:c})}}async function H9(r){const e=ze.cloneDeep(this.getState()),t=r.value?.options?.trackId,n=r.value?.options?.trackIndex;let s=[],i;if(r.key===Xi){i="video";const c=await p_(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===qi){i="image";const c=await f_(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===Gi){i="audio";const c=await g_(r.value?.payload),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===Sf){i="text";const{details:c,...u}=await Rp(r.value?.payload??void 0,{size:e.size});e.trackItemDetailsMap[u.id]={type:i,details:c},e.trackItemsMap[u.id]=u,e.trackItemIds.push(u.id),s.push(u.id)}const a=U9(s,e.tracks,e.trackItemsMap,t,n);if(a.trackId)e.tracks.find(u=>u.id===a.trackId)?.items.push(...s);else if(a.trackIndex!==void 0){const c=y1(i,s);e.tracks.splice(a.trackIndex,0,c)}else{const c=y1(i,s);e.tracks.unshift(c)}e.duration=on(e.trackItemsMap),this.updateState({trackItemIds:e.trackItemIds,trackItemDetailsMap:e.trackItemDetailsMap,trackItemsMap:e.trackItemsMap,tracks:e.tracks,duration:e.duration,structure:e.structure},{updateHistory:!0,kind:"add"})}function y1(r,e){return{id:Ot(),accepts:["text","audio","helper","video","image"],type:r,items:e,magnetic:!1,static:!1}}const U9=(r,e,t,n,s)=>{if(n===void 0&&s===void 0)return{trackId:void 0,trackIndex:void 0};const i=s!==void 0?e[Math.max(0,Math.min(s,e.length-1))]:e.find(u=>u.id===n);if(!i)return{trackId:void 0,trackIndex:s!==void 0?Math.max(0,Math.min(s,e.length-1)):void 0};const a=i.items.map(u=>t[u]),c=r.map(u=>t[u]);for(const u of a){const h=u.display.from,d=u.display.to;for(const p of c){const g=p.display.from;if(!(p.display.to<=h||g>=d))return{trackId:void 0,trackIndex:e.indexOf(i)}}}return{trackId:i.id,trackIndex:e.indexOf(i)}},b1=["tracks","trackItemsMap","trackItemDetailsMap","transitionIds","transitionsMap","trackItemIds"],$9={size:{width:1080,height:1920},tracks:[],trackItemIds:[],trackItemsMap:{},transitionIds:[],transitionsMap:{},scale:{unit:1,zoom:1,segments:1,index:1},duration:0,activeIds:[],trackItemDetailsMap:{},structure:[]};class pS{stateSubject;stateHistorySubject;prevState;undos;redos;listener;constructor(e){this.stateSubject=null,this.stateHistorySubject=null,this.prevState=null,this.undos=[],this.redos=[],this.listener=null;const t=e||$9;this.stateSubject=new Fv(t),this.stateHistorySubject=new Fv({handleRedo:!1,handleUndo:!1}),this.prevState=t,this.initListeners()}initListeners(){gS(this)}destroyListeners(){this.listener&&this.listener.unsubscribe()}purge(){this.destroyListeners()}updateHistory(e,t){const n=ze.pick(e,b1),s=ze.pick(this.getState(),b1),i=aS(s,n);i.length&&(this.undos.push({undos:i,type:t}),this.redos=[])}getStateHistory(){return this.stateHistorySubject.getValue()}subscribeHistory(e){return this.stateHistorySubject.subscribe(e)}getState(){return this.stateSubject.getValue()}subscribe(e){return this.stateSubject.subscribe(e)}updateState(e,t={updateHistory:!1,kind:void 0}){const n=this.getState(),s={...n,...e};if(!ze.isEqual(n,s)){t.updateHistory&&this.updateHistory(s,t.kind);const{duration:i,trackItemsMap:a,...c}=n;this.prevState={...c,duration:this.prevState.duration,trackItemsMap:this.prevState.trackItemsMap},this.stateSubject.next(s)}}subscribeToSize(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.size,this.prevState.size)||e({size:t.size})})}subscribeToScale(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.scale,this.prevState.scale)||e({scale:t.scale})})}subscribeToUpdateTrackItem(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||e({trackItemsMap:t.trackItemsMap})})}subscribeToUpdateItemDetails(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap)||e({trackItemDetailsMap:t.trackItemDetailsMap})})}subscribeToDuration(e){return this.stateSubject.asObservable().subscribe(t=>{t.duration!==this.prevState.duration&&e({duration:t.duration})})}subscribeToHistory(e){return this.stateHistorySubject.asObservable().subscribe(t=>{if(t.handleRedo){const n=this.undos[this.undos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}if(t.handleUndo){const n=this.redos[this.redos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}})}subscribeToAddOrRemoveItems(e){return this.stateSubject.asObservable().subscribe(t=>{(!t.trackItemIds?.every(n=>this.prevState.trackItemIds?.includes(n))||!ze.isEqual(t.tracks,this.prevState.tracks))&&e({trackItemIds:t.trackItemIds})})}subscribeToActiveIds(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.activeIds,this.prevState.activeIds)||e({activeIds:t.activeIds})})}subscribeToTracks(e){return this.stateSubject.asObservable().subscribe(t=>{(!ze.isEqual(t.tracks,this.prevState.tracks)||!ze.isEqual(t.trackItemIds,this.prevState.trackItemIds)||!ze.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||!ze.isEqual(t.transitionIds,this.prevState.transitionIds)||!ze.isEqual(t.transitionsMap,this.prevState.transitionsMap)||!ze.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap))&&e({tracks:t.tracks,trackItemIds:t.trackItemIds,trackItemsMap:t.trackItemsMap,transitionIds:t.transitionIds,transitionsMap:t.transitionsMap,trackItemDetailsMap:t.trackItemDetailsMap})})}undo(){const e=this.undos.pop(),t=e?.undos,n=e?.type;if(!t||!n)return;v1();const{trackItemDetailsMap:s,trackItemIds:i,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}=this.getState(),d=ze.cloneDeep({trackItemDetailsMap:s,trackItemIds:i,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}),p=[],g=[],y=[],w=[],_=[],S=[];t.forEach(U=>{let X;const te=U.path.slice(1);U.type==="CREATE"?X={path:te,op:"remove",value:U.value}:U.type==="CHANGE"?X={path:te,op:"replace",value:U.oldValue}:X={path:te,op:"add",value:U.oldValue},U.path.includes("trackItemIds")?y.push(X):U.path.includes("transitionIds")?g.push(X):U.path.includes("trackItemsMap")?_.push(X):U.path.includes("transitionsMap")?w.push(X):U.path.includes("tracks")?p.push(X):U.path.includes("trackItemDetailsMap")&&S.push(X)});const T=this.applyPatch(d.tracks,p),k=this.applyPatch(d.transitionIds,g),I=this.applyPatch(d.trackItemIds,y),A=this.applyPatch(d.transitionsMap,w),D=this.applyPatch(d.trackItemsMap,_),L=this.applyPatch(d.trackItemDetailsMap,S),z=ze.cloneDeep({tracks:T,transitionIds:k,trackItemIds:I,transitionsMap:A,trackItemsMap:D,trackItemDetailsMap:L}),F=ze.cloneDeep(this.getState()),Y={...F,...z};this.prevState=F;const W={redos:t,type:n};this.redos.push(W);const q=on(Y.trackItemsMap);this.stateSubject.next({...Y,duration:q}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!0})}redo(){const e=this.redos.pop();if(!e?.redos||!e?.type)return;v1();const t=this.getState(),{trackItemDetailsMap:n,trackItemIds:s,tracks:i,transitionIds:a,transitionsMap:c,trackItemsMap:u}=t,h=ze.cloneDeep({trackItemDetailsMap:n,trackItemIds:s,tracks:i,transitionIds:a,transitionsMap:c,trackItemsMap:u}),d=[],p=[],g=[],y=[],w=[],_=[];e.redos.forEach(A=>{const D=A.path.slice(1);let L={};switch(A.type){case"CREATE":L={path:D,op:"add",value:A.value};break;case"CHANGE":L={path:D,op:"replace",value:A.value};break;case"REMOVE":L={path:D,op:"remove",value:A.oldValue};break;default:return null}A.path.includes("trackItemIds")?g.push(L):A.path.includes("transitionIds")?p.push(L):A.path.includes("trackItemsMap")?w.push(L):A.path.includes("transitionsMap")?y.push(L):A.path.includes("trackItemDetailsMap")?_.push(L):d.push(L)});const S={tracks:this.applyPatch(h.tracks,d),transitionIds:this.applyPatch(h.transitionIds,p),trackItemIds:this.applyPatch(h.trackItemIds,g),transitionsMap:this.applyPatch(h.transitionsMap,y),trackItemsMap:this.applyPatch(h.trackItemsMap,w),trackItemDetailsMap:this.applyPatch(h.trackItemDetailsMap,_)},T=ze.cloneDeep(S),k={...ze.cloneDeep(t),...T};this.prevState=t,this.undos.push({undos:e.redos,type:e.type});const I=on(k.trackItemsMap);this.stateSubject.next({...k,duration:I}),this.stateHistorySubject.next({handleRedo:!0,handleUndo:!1})}applyPatch(e,t){return t.reverse().reduce((n,s)=>V9(n,i=>{B9(i,[s])}),e)}}function gS(r){const e=De.subject.pipe(Fn(({key:i})=>i.startsWith(Oy))).subscribe(i=>{i.key===Of&&r.undo(),i.key===Mf&&r.redo()}),t=De.subject.pipe(Fn(({key:i,value:a})=>i.startsWith(Sy))).subscribe(i=>{H9.bind(r)(i)}),n=De.subject.pipe(Fn(({key:i,value:a})=>i.startsWith("scene"))).subscribe(async i=>{await W9.bind(r)(i)}),s=De.subject.pipe(Fn(({key:i})=>i.startsWith(Iy))).subscribe(async i=>{z9.bind(r)(i)});return()=>{e.unsubscribe(),t.unsubscribe(),s.unsubscribe(),n.unsubscribe()}}const mS=()=>{const{playerRef:r,fps:e,timeline:t,setState:n}=bn();v.useEffect(()=>{const i=De.subject.pipe(Fn(({key:a})=>a.startsWith(Cy))).subscribe(a=>{if(a.key===Ty){const{time:c}=a.value?.payload;r?.current?.seekTo(c/1e3*e)}else if(a.key===Cf)r?.current?.play();else if(a.key===Tf)r?.current?.pause();else if(a.key===ky)r?.current?.isPlaying()?r.current.pause():r?.current?.play();else if(a.key===Ey){const{frames:c}=a.value?.payload;r?.current?.seekTo(Math.round(r.current.getCurrentFrame())+c)}});return()=>{i.unsubscribe()}},[r,e]),v.useEffect(()=>{const i=De.subject.pipe(Fn(({key:a})=>a.startsWith(Ay))).subscribe(a=>{a.key===Af&&n({activeIds:a.value?.payload.activeIds})});return()=>{i.unsubscribe()}},[t])},Y9=new pS,X9=()=>{const{playerRef:r}=bn();mS();const[e,t]=v.useState([]);return b.jsxs("div",{className:"relative flex h-screen w-screen flex-col bg-background ",children:[b.jsx(db,{}),b.jsxs("div",{style:{width:"100%",height:"100%",position:"relative",flex:1,overflow:"hidden"},children:[b.jsx(_3,{}),b.jsx(hb,{}),b.jsx(ww,{})]}),b.jsx("div",{className:"h-70 w-full ",children:r&&b.jsx(oS,{stateManager:Y9})})]})};exports.ACTIVE_CLONE=kf;exports.ACTIVE_DELETE=Ef;exports.ACTIVE_PASTE=XO;exports.ACTIVE_PREFIX=Iy;exports.ACTIVE_SET=YO;exports.ACTIVE_SPLIT=If;exports.ADD_ANIMATION=VO;exports.ADD_AUDIO=Gi;exports.ADD_IMAGE=qi;exports.ADD_MASK=FO;exports.ADD_PLACEHOLDER=LO;exports.ADD_PREFIX=Sy;exports.ADD_SUFFIX=AO;exports.ADD_TEXT=Sf;exports.ADD_TRANSITION=NO;exports.ADD_VIDEO=Xi;exports.AUDIOS=ab;exports.AppComponent=X9;exports.Audio=__;exports.AudioObject=Wn;exports.BASE_TIMELINE_ELEMENT_DURATION_MS=VM;exports.Button=st;exports.CanvasMixin=t_;exports.DEFAULT_AUDIO_BITRATE=HM;exports.DEFAULT_AUDIO_SAMPLE_RATE=WM;exports.DEFAULT_BLUR=OP;exports.DEFAULT_BLUR_STEP=AP;exports.DEFAULT_BRIGHTNESS=uP;exports.DEFAULT_BRIGHTNESS_STEP=lP;exports.DEFAULT_CONTRAST=_P;exports.DEFAULT_CONTRAST_STEP=xP;exports.DEFAULT_FADE_IN=QM;exports.DEFAULT_FADE_OUT=eP;exports.DEFAULT_FADE_STEP=JM;exports.DEFAULT_FLIP_X=iP;exports.DEFAULT_FLIP_Y=oP;exports.DEFAULT_FONT=Td;exports.DEFAULT_FRAMERATE=Uy;exports.DEFAULT_MAX_BLUR=IP;exports.DEFAULT_MAX_BRIGHTNESS=cP;exports.DEFAULT_MAX_CONTRAST=wP;exports.DEFAULT_MAX_FADE=ZM;exports.DEFAULT_MAX_OPACITY=CP;exports.DEFAULT_MAX_ROTATION=rP;exports.DEFAULT_MAX_SATURATION=dP;exports.DEFAULT_MAX_SPEED=PP;exports.DEFAULT_MAX_TEMPERATURE=mP;exports.DEFAULT_MAX_VOLUME=LP;exports.DEFAULT_MEDIA_PANEL_WIDTH=XM;exports.DEFAULT_MIN_BLUR=kP;exports.DEFAULT_MIN_BRIGHTNESS=aP;exports.DEFAULT_MIN_CONTRAST=bP;exports.DEFAULT_MIN_FADE=KM;exports.DEFAULT_MIN_OPACITY=SP;exports.DEFAULT_MIN_ROTATION=tP;exports.DEFAULT_MIN_SATURATION=hP;exports.DEFAULT_MIN_SPEED=MP;exports.DEFAULT_MIN_TEMPERATURE=gP;exports.DEFAULT_MIN_VOLUME=jP;exports.DEFAULT_OPACITY=EP;exports.DEFAULT_OPACITY_STEP=TP;exports.DEFAULT_PREVIEW_HEIGHT=$M;exports.DEFAULT_PREVIEW_SCALE=Ff;exports.DEFAULT_PREVIEW_WIDTH=UM;exports.DEFAULT_ROTATION=sP;exports.DEFAULT_ROTATION_STEP=nP;exports.DEFAULT_SATURATION=pP;exports.DEFAULT_SATURATION_STEP=fP;exports.DEFAULT_SETTINGS_PANEL_WIDTH=qM;exports.DEFAULT_SPEED=RP;exports.DEFAULT_SPEED_STEP=DP;exports.DEFAULT_TEMPERATURE=yP;exports.DEFAULT_TEMPERATURE_STEP=vP;exports.DEFAULT_VIDEO_HEIGHT=Hy;exports.DEFAULT_VIDEO_MAX_BITRATE=zM;exports.DEFAULT_VIDEO_MIN_BITRATE=BM;exports.DEFAULT_VIDEO_WIDTH=Wy;exports.DEFAULT_VOLUME=NP;exports.DEFAULT_VOLUME_STEP=FP;exports.DEFAULT_WEIGHT=NM;exports.DRAG_END=Qo;exports.DRAG_PREFIX=Py;exports.DRAG_START=Df;exports.Draggable=ma;exports.DroppableArea=Vy;exports.EDIT_OBJECT=zO;exports.EDIT_PREFIX=BO;exports.EDIT_SHAPE=HO;exports.EDIT_TEXT=WO;exports.ENTER_EDIT_MODE=UO;exports.FRAME_INTERVAL=$y;exports.GIANT_ICON_SIZE=MM;exports.HISTORY_PREFIX=Oy;exports.HISTORY_REDO=Mf;exports.HISTORY_RESET=aM;exports.HISTORY_UNDO=Of;exports.Header=ob;exports.Helper=E_;exports.HelperObject=lo;exports.IMAGES=cb;exports.Image=C_;exports.ImageObject=hu;exports.LARGER_FONT_SIZE=jM;exports.LARGE_FONT_SIZE=LM;exports.LARGE_ICON_SIZE=PM;exports.LAYER_CLONE=nM;exports.LAYER_COPY=tM;exports.LAYER_CUT=iM;exports.LAYER_DELETE=oM;exports.LAYER_EDITING_NAME=eM;exports.LAYER_HIDDEN=qO;exports.LAYER_LOCKED=GO;exports.LAYER_MOVE=KO;exports.LAYER_PASTE=rM;exports.LAYER_PREFIX=Ay;exports.LAYER_RENAME=QO;exports.LAYER_SELECT=ZO;exports.LAYER_SELECTION=Af;exports.LAYER_SEND_TO=JO;exports.LAYER_SPLIT=sM;exports.MAX_MEDIA_PANEL_WIDTH=GM;exports.MIN_MEDIA_PANEL_WIDTH=YM;exports.MenuItem=hb;exports.NORMAL_FONT_SIZE=FM;exports.NORMAL_ICON_SIZE=DM;exports.NavbarComponent=db;exports.PLAYER_PAUSE=Tf;exports.PLAYER_PLAY=Cf;exports.PLAYER_PREFIX=Cy;exports.PLAYER_SEEK=Ty;exports.PLAYER_SEEK_BY=Ey;exports.PLAYER_SEEK_TO=$O;exports.PLAYER_TOGGLE_PLAY=ky;exports.PREVIEW_FRAME_WIDTH=va;exports.Placeholder=Hi;exports.Player=vw;exports.PlayheadComponent=yw;exports.PreviewTrackItem=la;exports.RulerComponent=bw;exports.SECONDARY_FONT=zy;exports.SMALL_FONT_SIZE=By;exports.SMALL_ICON_SIZE=RM;exports.STATE_CHANGED=jO;exports.STATE_PREFIX=RO;exports.Scene=ww;exports.SceneBoard=OM;exports.ScrollArea=ti;exports.ScrollBar=bf;exports.SequenceItem=fw;exports.Slider=U1;exports.StateManager=pS;exports.TIMELINE_BOUNDING_CHANGED=Rf;exports.TIMELINE_OFFSET_CANVAS_LEFT=Ll;exports.TIMELINE_OFFSET_CANVAS_RIGHT=Cd;exports.TIMELINE_OFFSET_X=ol;exports.TIMELINE_PREFIX=Dy;exports.TIMELINE_SCALE_CHANGED=Pf;exports.TIMELINE_SCALE_PREFIX=My;exports.TIMELINE_ZOOM_LEVELS=en;exports.TRACKS_CHANGED=PO;exports.TRACK_ITEMS_CHANGED=DO;exports.TRACK_ITEMS_PREFIX=MO;exports.TRACK_PREFIX=OO;exports.TRANSITIONS=ub;exports.Tabs=_y;exports.TabsContent=il;exports.TabsList=_f;exports.TabsTrigger=sl;exports.Text=jp;exports.TextObject=qs;exports.Timeline=vu;exports.TimelineComponent=oS;exports.Track=T_;exports.TrackItemsMixin=k_;exports.TrackObject=ps;exports.TracksMixin=I_;exports.Transition=Hr;exports.TransitionGuide=ca;exports.TransitionsMixin=A_;exports.UPLOADS=l3;exports.VIDEOS=lb;exports.Video=S_;exports.VideoObject=li;exports.addEventListeners=nS;exports.applyMixins=o_;exports.buttonVariants=I1;exports.calculateDisplayRange=h_;exports.calculateDuration=on;exports.calculatePosition=du;exports.calculateTimelineWidth=tb;exports.calculateTrim=u_;exports.cn=Wt;exports.createAudioControls=s_;exports.createControls=i_;exports.createMediaControls=n_;exports.createResizeControls=Pp;exports.defaultColor=Ea;exports.defaultSizes=w_;exports.filterAndCleanTracks=d_;exports.findIndex=Nf;exports.formatBytes=EA;exports.formatTimeToHumanReadable=VP;exports.formatTimelineUnit=Yy;exports.frameToTimeString=Xy;exports.getCurrentTime=qy;exports.getFitZoomLevel=BP;exports.getMovingState=Hj;exports.getNextZoom=Jy;exports.getNextZoomIndex=eb;exports.getNextZoomLevel=Qy;exports.getOffset=Me;exports.getPreviousZoom=Zy;exports.getPreviousZoomIndex=WP;exports.getPreviousZoomLevel=Ky;exports.getTextHeight=Ko;exports.getZoomByIndex=zP;exports.handleEvents=iS;exports.handleResize=aa;exports.loadAudio=a_;exports.loadAudioItem=g_;exports.loadAudioObject=m_;exports.loadFonts=rb;exports.loadImage=c_;exports.loadImageItem=f_;exports.loadImageObject=v_;exports.loadTextItem=Rp;exports.loadTextObject=b_;exports.loadVideo=l_;exports.loadVideoItem=p_;exports.loadVideoObject=y_;exports.mergeSizes=x_;exports.mergeTrackObjects=Vf;exports.movingState=ee;exports.positionOffsets=r_;exports.randomInt=HP;exports.removeEventListeners=sS;exports.removeItemsFromTrack=ea;exports.renderControl=$n;exports.reorderTracksByIndex=Bf;exports.setupHistoryListeners=gS;exports.timeMsToUnits=xt;exports.timeToString=Gy;exports.transitionStore=ft;exports.unitsToTimeMs=cs;exports.updateMovingState=Uj;exports.useCurrentPlayerFrame=Fl;exports.useIsDraggingOverTimeline=ya;exports.useLayoutStore=Nl;exports.useStore=bn;exports.useTimelineEvents=mS;exports.wrapResizeWithAnchorPosition=Dp;
