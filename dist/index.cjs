"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function NA(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hy(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Id={exports:{}},sa={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function BA(){if(Nv)return sa;Nv=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var c in s)c!=="key"&&(i[c]=s[c])}else i=s;return s=i.ref,{$$typeof:r,type:n,key:a,ref:s!==void 0?s:null,props:i}}return sa.Fragment=e,sa.jsx=t,sa.jsxs=t,sa}var ia={},Md={exports:{}},Fe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bv;function VA(){if(Bv)return Fe;Bv=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function g(M){return M===null||typeof M!="object"?null:(M=p&&M[p]||M["@@iterator"],typeof M=="function"?M:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function C(M,z,ce){this.props=M,this.context=z,this.refs=x,this.updater=ce||v}C.prototype.isReactComponent={},C.prototype.setState=function(M,z){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,z,"setState")},C.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function T(){}T.prototype=C.prototype;function k(M,z,ce){this.props=M,this.context=z,this.refs=x,this.updater=ce||v}var A=k.prototype=new T;A.constructor=k,b(A,C.prototype),A.isPureReactComponent=!0;var I=Array.isArray,D={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function U(M,z,ce,fe,be,ye){return ce=ye.ref,{$$typeof:r,type:M,key:z,ref:ce!==void 0?ce:null,props:ye}}function B(M,z){return U(M.type,z,void 0,void 0,void 0,M.props)}function X(M){return typeof M=="object"&&M!==null&&M.$$typeof===r}function Y(M){var z={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(ce){return z[ce]})}var Z=/\/+/g;function G(M,z){return typeof M=="object"&&M!==null&&M.key!=null?Y(""+M.key):z.toString(36)}function K(){}function oe(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(K,K):(M.status="pending",M.then(function(z){M.status==="pending"&&(M.status="fulfilled",M.value=z)},function(z){M.status==="pending"&&(M.status="rejected",M.reason=z)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function ve(M,z,ce,fe,be){var ye=typeof M;(ye==="undefined"||ye==="boolean")&&(M=null);var ue=!1;if(M===null)ue=!0;else switch(ye){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(M.$$typeof){case r:case e:ue=!0;break;case d:return ue=M._init,ve(ue(M._payload),z,ce,fe,be)}}if(ue)return be=be(M),ue=fe===""?"."+G(M,0):fe,I(be)?(ce="",ue!=null&&(ce=ue.replace(Z,"$&/")+"/"),ve(be,z,ce,"",function(bt){return bt})):be!=null&&(X(be)&&(be=B(be,ce+(be.key==null||M&&M.key===be.key?"":(""+be.key).replace(Z,"$&/")+"/")+ue)),z.push(be)),1;ue=0;var Xe=fe===""?".":fe+":";if(I(M))for(var ze=0;ze<M.length;ze++)fe=M[ze],ye=Xe+G(fe,ze),ue+=ve(fe,z,ce,ye,be);else if(ze=g(M),typeof ze=="function")for(M=ze.call(M),ze=0;!(fe=M.next()).done;)fe=fe.value,ye=Xe+G(fe,ze++),ue+=ve(fe,z,ce,ye,be);else if(ye==="object"){if(typeof M.then=="function")return ve(oe(M),z,ce,fe,be);throw z=String(M),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return ue}function Q(M,z,ce){if(M==null)return M;var fe=[],be=0;return ve(M,fe,"","",function(ye){return z.call(ce,ye,be++)}),fe}function ge(M){if(M._status===-1){var z=M._result;z=z(),z.then(function(ce){(M._status===0||M._status===-1)&&(M._status=1,M._result=ce)},function(ce){(M._status===0||M._status===-1)&&(M._status=2,M._result=ce)}),M._status===-1&&(M._status=0,M._result=z)}if(M._status===1)return M._result.default;throw M._result}var de=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)};function ne(){}return Fe.Children={map:Q,forEach:function(M,z,ce){Q(M,function(){z.apply(this,arguments)},ce)},count:function(M){var z=0;return Q(M,function(){z++}),z},toArray:function(M){return Q(M,function(z){return z})||[]},only:function(M){if(!X(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},Fe.Component=C,Fe.Fragment=t,Fe.Profiler=s,Fe.PureComponent=k,Fe.StrictMode=n,Fe.Suspense=u,Fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Fe.act=function(){throw Error("act(...) is not supported in production builds of React.")},Fe.cache=function(M){return function(){return M.apply(null,arguments)}},Fe.cloneElement=function(M,z,ce){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var fe=b({},M.props),be=M.key,ye=void 0;if(z!=null)for(ue in z.ref!==void 0&&(ye=void 0),z.key!==void 0&&(be=""+z.key),z)!F.call(z,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&z.ref===void 0||(fe[ue]=z[ue]);var ue=arguments.length-2;if(ue===1)fe.children=ce;else if(1<ue){for(var Xe=Array(ue),ze=0;ze<ue;ze++)Xe[ze]=arguments[ze+2];fe.children=Xe}return U(M.type,be,void 0,void 0,ye,fe)},Fe.createContext=function(M){return M={$$typeof:a,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:i,_context:M},M},Fe.createElement=function(M,z,ce){var fe,be={},ye=null;if(z!=null)for(fe in z.key!==void 0&&(ye=""+z.key),z)F.call(z,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(be[fe]=z[fe]);var ue=arguments.length-2;if(ue===1)be.children=ce;else if(1<ue){for(var Xe=Array(ue),ze=0;ze<ue;ze++)Xe[ze]=arguments[ze+2];be.children=Xe}if(M&&M.defaultProps)for(fe in ue=M.defaultProps,ue)be[fe]===void 0&&(be[fe]=ue[fe]);return U(M,ye,void 0,void 0,null,be)},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(M){return{$$typeof:c,render:M}},Fe.isValidElement=X,Fe.lazy=function(M){return{$$typeof:d,_payload:{_status:-1,_result:M},_init:ge}},Fe.memo=function(M,z){return{$$typeof:h,type:M,compare:z===void 0?null:z}},Fe.startTransition=function(M){var z=D.T,ce={};D.T=ce;try{var fe=M(),be=D.S;be!==null&&be(ce,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(ne,de)}catch(ye){de(ye)}finally{D.T=z}},Fe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Fe.use=function(M){return D.H.use(M)},Fe.useActionState=function(M,z,ce){return D.H.useActionState(M,z,ce)},Fe.useCallback=function(M,z){return D.H.useCallback(M,z)},Fe.useContext=function(M){return D.H.useContext(M)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(M,z){return D.H.useDeferredValue(M,z)},Fe.useEffect=function(M,z){return D.H.useEffect(M,z)},Fe.useId=function(){return D.H.useId()},Fe.useImperativeHandle=function(M,z,ce){return D.H.useImperativeHandle(M,z,ce)},Fe.useInsertionEffect=function(M,z){return D.H.useInsertionEffect(M,z)},Fe.useLayoutEffect=function(M,z){return D.H.useLayoutEffect(M,z)},Fe.useMemo=function(M,z){return D.H.useMemo(M,z)},Fe.useOptimistic=function(M,z){return D.H.useOptimistic(M,z)},Fe.useReducer=function(M,z,ce){return D.H.useReducer(M,z,ce)},Fe.useRef=function(M){return D.H.useRef(M)},Fe.useState=function(M){return D.H.useState(M)},Fe.useSyncExternalStore=function(M,z,ce){return D.H.useSyncExternalStore(M,z,ce)},Fe.useTransition=function(){return D.H.useTransition()},Fe.version="19.0.0",Fe}var da={exports:{}};/**
 * @license React
 * react.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */da.exports;var Vv;function HA(){return Vv||(Vv=1,function(r,e){process.env.NODE_ENV!=="production"&&function(){function t(_,V){Object.defineProperty(i.prototype,_,{get:function(){console.warn("%s(...) is deprecated in plain JavaScript React classes. %s",V[0],V[1])}})}function n(_){return _===null||typeof _!="object"?null:(_=Gr&&_[Gr]||_["@@iterator"],typeof _=="function"?_:null)}function s(_,V){_=(_=_.constructor)&&(_.displayName||_.name)||"ReactClass";var te=_+"."+V;sr[te]||(console.error("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",V,_),sr[te]=!0)}function i(_,V,te){this.props=_,this.context=V,this.refs=pe,this.updater=te||R}function a(){}function c(_,V,te){this.props=_,this.context=V,this.refs=pe,this.updater=te||R}function u(_){return""+_}function h(_){try{u(_);var V=!1}catch{V=!0}if(V){V=console;var te=V.error,ae=typeof Symbol=="function"&&Symbol.toStringTag&&_[Symbol.toStringTag]||_.constructor.name||"Object";return te.call(V,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",ae),u(_)}}function d(_){if(_==null)return null;if(typeof _=="function")return _.$$typeof===ke?null:_.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case ze:return"Fragment";case Xe:return"Portal";case wt:return"Profiler";case bt:return"StrictMode";case it:return"Suspense";case Tt:return"SuspenseList"}if(typeof _=="object")switch(typeof _.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),_.$$typeof){case Ce:return(_.displayName||"Context")+".Provider";case Vt:return(_._context.displayName||"Context")+".Consumer";case qt:var V=_.render;return _=_.displayName,_||(_=V.displayName||V.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Tr:return V=_.displayName||null,V!==null?V:d(_.type)||"Memo";case tt:V=_._payload,_=_._init;try{return d(_(V))}catch{}}return null}function p(_){return typeof _=="string"||typeof _=="function"||_===ze||_===wt||_===bt||_===it||_===Tt||_===Pt||typeof _=="object"&&_!==null&&(_.$$typeof===tt||_.$$typeof===Tr||_.$$typeof===Ce||_.$$typeof===Vt||_.$$typeof===qt||_.$$typeof===_t||_.getModuleId!==void 0)}function g(){}function v(){if(zt===0){Er=console.log,Qt=console.info,jr=console.warn,Kt=console.error,hs=console.group,ds=console.groupCollapsed,Vn=console.groupEnd;var _={configurable:!0,enumerable:!0,value:g,writable:!0};Object.defineProperties(console,{info:_,log:_,warn:_,error:_,group:_,groupCollapsed:_,groupEnd:_})}zt++}function b(){if(zt--,zt===0){var _={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:he({},_,{value:Er}),info:he({},_,{value:Qt}),warn:he({},_,{value:jr}),error:he({},_,{value:Kt}),group:he({},_,{value:hs}),groupCollapsed:he({},_,{value:ds}),groupEnd:he({},_,{value:Vn})})}0>zt&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function x(_){if(kn===void 0)try{throw Error()}catch(te){var V=te.stack.trim().match(/\n( *(at )?)/);kn=V&&V[1]||"",Ri=-1<te.stack.indexOf(`
    at`)?" (<anonymous>)":-1<te.stack.indexOf("@")?"@unknown:0:0":""}return`
`+kn+_+Ri}function C(_,V){if(!_||fs)return"";var te=hn.get(_);if(te!==void 0)return te;fs=!0,te=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var ae=null;ae=_e.H,_e.H=null,v();try{var xe={DetermineComponentFrameRoot:function(){try{if(V){var gr=function(){throw Error()};if(Object.defineProperty(gr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(gr,[])}catch(kr){var Ni=kr}Reflect.construct(_,[],gr)}else{try{gr.call()}catch(kr){Ni=kr}_.call(gr.prototype)}}else{try{throw Error()}catch(kr){Ni=kr}(gr=_())&&typeof gr.catch=="function"&&gr.catch(function(){})}}catch(kr){if(kr&&Ni&&typeof kr.stack=="string")return[kr.stack,Ni.stack]}return[null,null]}};xe.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Ee=Object.getOwnPropertyDescriptor(xe.DetermineComponentFrameRoot,"name");Ee&&Ee.configurable&&Object.defineProperty(xe.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Se=xe.DetermineComponentFrameRoot(),rt=Se[0],Qe=Se[1];if(rt&&Qe){var gt=rt.split(`
`),ir=Qe.split(`
`);for(Se=Ee=0;Ee<gt.length&&!gt[Ee].includes("DetermineComponentFrameRoot");)Ee++;for(;Se<ir.length&&!ir[Se].includes("DetermineComponentFrameRoot");)Se++;if(Ee===gt.length||Se===ir.length)for(Ee=gt.length-1,Se=ir.length-1;1<=Ee&&0<=Se&&gt[Ee]!==ir[Se];)Se--;for(;1<=Ee&&0<=Se;Ee--,Se--)if(gt[Ee]!==ir[Se]){if(Ee!==1||Se!==1)do if(Ee--,Se--,0>Se||gt[Ee]!==ir[Se]){var Hn=`
`+gt[Ee].replace(" at new "," at ");return _.displayName&&Hn.includes("<anonymous>")&&(Hn=Hn.replace("<anonymous>",_.displayName)),typeof _=="function"&&hn.set(_,Hn),Hn}while(1<=Ee&&0<=Se);break}}}finally{fs=!1,_e.H=ae,b(),Error.prepareStackTrace=te}return gt=(gt=_?_.displayName||_.name:"")?x(gt):"",typeof _=="function"&&hn.set(_,gt),gt}function T(_){if(_==null)return"";if(typeof _=="function"){var V=_.prototype;return C(_,!(!V||!V.isReactComponent))}if(typeof _=="string")return x(_);switch(_){case it:return x("Suspense");case Tt:return x("SuspenseList")}if(typeof _=="object")switch(_.$$typeof){case qt:return _=C(_.render,!1),_;case Tr:return T(_.type);case tt:V=_._payload,_=_._init;try{return T(_(V))}catch{}}return""}function k(){var _=_e.A;return _===null?null:_.getOwner()}function A(_){if(Ht.call(_,"key")){var V=Object.getOwnPropertyDescriptor(_,"key").get;if(V&&V.isReactWarning)return!1}return _.key!==void 0}function I(_,V){function te(){No||(No=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",V))}te.isReactWarning=!0,Object.defineProperty(_,"key",{get:te,configurable:!0})}function D(){var _=d(this.type);return Vo[_]||(Vo[_]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),_=this.props.ref,_!==void 0?_:null}function F(_,V,te,ae,xe,Ee){return te=Ee.ref,_={$$typeof:ue,type:_,key:V,props:Ee,_owner:xe},(te!==void 0?te:null)!==null?Object.defineProperty(_,"ref",{enumerable:!1,get:D}):Object.defineProperty(_,"ref",{enumerable:!1,value:null}),_._store={},Object.defineProperty(_._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(_,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.freeze&&(Object.freeze(_.props),Object.freeze(_)),_}function U(_,V){return V=F(_.type,V,void 0,void 0,_._owner,_.props),V._store.validated=_._store.validated,V}function B(_,V){if(typeof _=="object"&&_&&_.$$typeof!==ji){if(Ge(_))for(var te=0;te<_.length;te++){var ae=_[te];X(ae)&&Y(ae,V)}else if(X(_))_._store&&(_._store.validated=1);else if(te=n(_),typeof te=="function"&&te!==_.entries&&(te=te.call(_),te!==_))for(;!(_=te.next()).done;)X(_.value)&&Y(_.value,V)}}function X(_){return typeof _=="object"&&_!==null&&_.$$typeof===ue}function Y(_,V){if(_._store&&!_._store.validated&&_.key==null&&(_._store.validated=1,V=Z(V),!Li[V])){Li[V]=!0;var te="";_&&_._owner!=null&&_._owner!==k()&&(te=null,typeof _._owner.tag=="number"?te=d(_._owner.type):typeof _._owner.name=="string"&&(te=_._owner.name),te=" It was passed a child from "+te+".");var ae=_e.getCurrentStack;_e.getCurrentStack=function(){var xe=T(_.type);return ae&&(xe+=ae()||""),xe},console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',V,te),_e.getCurrentStack=ae}}function Z(_){var V="",te=k();return te&&(te=d(te.type))&&(V=`

Check the render method of \``+te+"`."),V||(_=d(_))&&(V=`

Check the top-level render call using <`+_+">."),V}function G(_){var V={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function(te){return V[te]})}function K(_,V){return typeof _=="object"&&_!==null&&_.key!=null?(h(_.key),G(""+_.key)):V.toString(36)}function oe(){}function ve(_){switch(_.status){case"fulfilled":return _.value;case"rejected":throw _.reason;default:switch(typeof _.status=="string"?_.then(oe,oe):(_.status="pending",_.then(function(V){_.status==="pending"&&(_.status="fulfilled",_.value=V)},function(V){_.status==="pending"&&(_.status="rejected",_.reason=V)})),_.status){case"fulfilled":return _.value;case"rejected":throw _.reason}}throw _}function Q(_,V,te,ae,xe){var Ee=typeof _;(Ee==="undefined"||Ee==="boolean")&&(_=null);var Se=!1;if(_===null)Se=!0;else switch(Ee){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(_.$$typeof){case ue:case Xe:Se=!0;break;case tt:return Se=_._init,Q(Se(_._payload),V,te,ae,xe)}}if(Se){Se=_,xe=xe(Se);var rt=ae===""?"."+K(Se,0):ae;return Ge(xe)?(te="",rt!=null&&(te=rt.replace(Us,"$&/")+"/"),Q(xe,V,te,"",function(gt){return gt})):xe!=null&&(X(xe)&&(xe.key!=null&&(Se&&Se.key===xe.key||h(xe.key)),te=U(xe,te+(xe.key==null||Se&&Se.key===xe.key?"":(""+xe.key).replace(Us,"$&/")+"/")+rt),ae!==""&&Se!=null&&X(Se)&&Se.key==null&&Se._store&&!Se._store.validated&&(te._store.validated=2),xe=te),V.push(xe)),1}if(Se=0,rt=ae===""?".":ae+":",Ge(_))for(var Qe=0;Qe<_.length;Qe++)ae=_[Qe],Ee=rt+K(ae,Qe),Se+=Q(ae,V,te,Ee,xe);else if(Qe=n(_),typeof Qe=="function")for(Qe===_.entries&&(Fi||console.warn("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),Fi=!0),_=Qe.call(_),Qe=0;!(ae=_.next()).done;)ae=ae.value,Ee=rt+K(ae,Qe++),Se+=Q(ae,V,te,Ee,xe);else if(Ee==="object"){if(typeof _.then=="function")return Q(ve(_),V,te,ae,xe);throw V=String(_),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return Se}function ge(_,V,te){if(_==null)return _;var ae=[],xe=0;return Q(_,ae,"","",function(Ee){return V.call(te,Ee,xe++)}),ae}function de(_){if(_._status===-1){var V=_._result;V=V(),V.then(function(te){(_._status===0||_._status===-1)&&(_._status=1,_._result=te)},function(te){(_._status===0||_._status===-1)&&(_._status=2,_._result=te)}),_._status===-1&&(_._status=0,_._result=V)}if(_._status===1)return V=_._result,V===void 0&&console.error(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))

Did you accidentally put curly braces around the import?`,V),"default"in V||console.error(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))`,V),V.default;throw _._result}function ne(){var _=_e.H;return _===null&&console.error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.`),_}function M(){}function z(_){if(Zt===null)try{var V=("require"+Math.random()).slice(0,7);Zt=(r&&r[V]).call(r,"timers").setImmediate}catch{Zt=function(ae){$e===!1&&($e=!0,typeof MessageChannel>"u"&&console.error("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var xe=new MessageChannel;xe.port1.onmessage=ae,xe.port2.postMessage(void 0)}}return Zt(_)}function ce(_){return 1<_.length&&typeof AggregateError=="function"?new AggregateError(_):_[0]}function fe(_,V){V!==pr-1&&console.error("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. "),pr=V}function be(_,V,te){var ae=_e.actQueue;if(ae!==null)if(ae.length!==0)try{ye(ae),z(function(){return be(_,V,te)});return}catch(xe){_e.thrownErrors.push(xe)}else _e.actQueue=null;0<_e.thrownErrors.length?(ae=ce(_e.thrownErrors),_e.thrownErrors.length=0,te(ae)):V(_)}function ye(_){if(!Ho){Ho=!0;var V=0;try{for(;V<_.length;V++){var te=_[V];do{_e.didUsePromise=!1;var ae=te(!1);if(ae!==null){if(_e.didUsePromise){_[V]=te,_.splice(0,V);return}te=ae}else break}while(!0)}_.length=0}catch(xe){_.splice(0,V+1),_e.thrownErrors.push(xe)}finally{Ho=!1}}}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var ue=Symbol.for("react.transitional.element"),Xe=Symbol.for("react.portal"),ze=Symbol.for("react.fragment"),bt=Symbol.for("react.strict_mode"),wt=Symbol.for("react.profiler"),Vt=Symbol.for("react.consumer"),Ce=Symbol.for("react.context"),qt=Symbol.for("react.forward_ref"),it=Symbol.for("react.suspense"),Tt=Symbol.for("react.suspense_list"),Tr=Symbol.for("react.memo"),tt=Symbol.for("react.lazy"),Pt=Symbol.for("react.offscreen"),Gr=Symbol.iterator,sr={},R={isMounted:function(){return!1},enqueueForceUpdate:function(_){s(_,"forceUpdate")},enqueueReplaceState:function(_){s(_,"replaceState")},enqueueSetState:function(_){s(_,"setState")}},he=Object.assign,pe={};Object.freeze(pe),i.prototype.isReactComponent={},i.prototype.setState=function(_,V){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,V,"setState")},i.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};var De={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]},Je;for(Je in De)De.hasOwnProperty(Je)&&t(Je,De[Je]);a.prototype=i.prototype,De=c.prototype=new a,De.constructor=c,he(De,i.prototype),De.isPureReactComponent=!0;var Ge=Array.isArray,ke=Symbol.for("react.client.reference"),_e={H:null,A:null,T:null,S:null,actQueue:null,isBatchingLegacy:!1,didScheduleLegacyUpdate:!1,didUsePromise:!1,thrownErrors:[],getCurrentStack:null},Ht=Object.prototype.hasOwnProperty,_t=Symbol.for("react.client.reference"),zt=0,Er,Qt,jr,Kt,hs,ds,Vn;g.__reactDisabledLog=!0;var kn,Ri,fs=!1,hn=new(typeof WeakMap=="function"?WeakMap:Map),ji=Symbol.for("react.client.reference"),No,Bo,Vo={},Li={},Fi=!1,Us=/\/+/g,qe=typeof reportError=="function"?reportError:function(_){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof _=="object"&&_!==null&&typeof _.message=="string"?String(_.message):String(_),error:_});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",_);return}console.error(_)},$e=!1,Zt=null,pr=0,$s=!1,Ho=!1,ic=typeof queueMicrotask=="function"?function(_){queueMicrotask(function(){return queueMicrotask(_)})}:z;e.Children={map:ge,forEach:function(_,V,te){ge(_,function(){V.apply(this,arguments)},te)},count:function(_){var V=0;return ge(_,function(){V++}),V},toArray:function(_){return ge(_,function(V){return V})||[]},only:function(_){if(!X(_))throw Error("React.Children.only expected to receive a single React element child.");return _}},e.Component=i,e.Fragment=ze,e.Profiler=wt,e.PureComponent=c,e.StrictMode=bt,e.Suspense=it,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_e,e.act=function(_){var V=_e.actQueue,te=pr;pr++;var ae=_e.actQueue=V!==null?V:[],xe=!1;try{var Ee=_()}catch(Qe){_e.thrownErrors.push(Qe)}if(0<_e.thrownErrors.length)throw fe(V,te),_=ce(_e.thrownErrors),_e.thrownErrors.length=0,_;if(Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var Se=Ee;return ic(function(){xe||$s||($s=!0,console.error("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);"))}),{then:function(Qe,gt){xe=!0,Se.then(function(ir){if(fe(V,te),te===0){try{ye(ae),z(function(){return be(ir,Qe,gt)})}catch(gr){_e.thrownErrors.push(gr)}if(0<_e.thrownErrors.length){var Hn=ce(_e.thrownErrors);_e.thrownErrors.length=0,gt(Hn)}}else Qe(ir)},function(ir){fe(V,te),0<_e.thrownErrors.length&&(ir=ce(_e.thrownErrors),_e.thrownErrors.length=0),gt(ir)})}}}var rt=Ee;if(fe(V,te),te===0&&(ye(ae),ae.length!==0&&ic(function(){xe||$s||($s=!0,console.error("A component suspended inside an `act` scope, but the `act` call was not awaited. When testing React components that depend on asynchronous data, you must await the result:\n\nawait act(() => ...)"))}),_e.actQueue=null),0<_e.thrownErrors.length)throw _=ce(_e.thrownErrors),_e.thrownErrors.length=0,_;return{then:function(Qe,gt){xe=!0,te===0?(_e.actQueue=ae,z(function(){return be(rt,Qe,gt)})):Qe(rt)}}},e.cache=function(_){return function(){return _.apply(null,arguments)}},e.cloneElement=function(_,V,te){if(_==null)throw Error("The argument must be a React element, but you passed "+_+".");var ae=he({},_.props),xe=_.key,Ee=_._owner;if(V!=null){var Se;e:{if(Ht.call(V,"ref")&&(Se=Object.getOwnPropertyDescriptor(V,"ref").get)&&Se.isReactWarning){Se=!1;break e}Se=V.ref!==void 0}Se&&(Ee=k()),A(V)&&(h(V.key),xe=""+V.key);for(rt in V)!Ht.call(V,rt)||rt==="key"||rt==="__self"||rt==="__source"||rt==="ref"&&V.ref===void 0||(ae[rt]=V[rt])}var rt=arguments.length-2;if(rt===1)ae.children=te;else if(1<rt){Se=Array(rt);for(var Qe=0;Qe<rt;Qe++)Se[Qe]=arguments[Qe+2];ae.children=Se}for(ae=F(_.type,xe,void 0,void 0,Ee,ae),xe=2;xe<arguments.length;xe++)B(arguments[xe],ae.type);return ae},e.createContext=function(_){return _={$$typeof:Ce,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null},_.Provider=_,_.Consumer={$$typeof:Vt,_context:_},_._currentRenderer=null,_._currentRenderer2=null,_},e.createElement=function(_,V,te){if(p(_))for(var ae=2;ae<arguments.length;ae++)B(arguments[ae],_);else{if(ae="",(_===void 0||typeof _=="object"&&_!==null&&Object.keys(_).length===0)&&(ae+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),_===null)var xe="null";else Ge(_)?xe="array":_!==void 0&&_.$$typeof===ue?(xe="<"+(d(_.type)||"Unknown")+" />",ae=" Did you accidentally export a JSX literal instead of a component?"):xe=typeof _;console.error("React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",xe,ae)}var Ee;if(ae={},xe=null,V!=null)for(Ee in Bo||!("__self"in V)||"key"in V||(Bo=!0,console.warn("Your app (or one of its dependencies) is using an outdated JSX transform. Update to the modern JSX transform for faster performance: https://react.dev/link/new-jsx-transform")),A(V)&&(h(V.key),xe=""+V.key),V)Ht.call(V,Ee)&&Ee!=="key"&&Ee!=="__self"&&Ee!=="__source"&&(ae[Ee]=V[Ee]);var Se=arguments.length-2;if(Se===1)ae.children=te;else if(1<Se){for(var rt=Array(Se),Qe=0;Qe<Se;Qe++)rt[Qe]=arguments[Qe+2];Object.freeze&&Object.freeze(rt),ae.children=rt}if(_&&_.defaultProps)for(Ee in Se=_.defaultProps,Se)ae[Ee]===void 0&&(ae[Ee]=Se[Ee]);return xe&&I(ae,typeof _=="function"?_.displayName||_.name||"Unknown":_),F(_,xe,void 0,void 0,k(),ae)},e.createRef=function(){var _={current:null};return Object.seal(_),_},e.forwardRef=function(_){_!=null&&_.$$typeof===Tr?console.error("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):typeof _!="function"?console.error("forwardRef requires a render function but was given %s.",_===null?"null":typeof _):_.length!==0&&_.length!==2&&console.error("forwardRef render functions accept exactly two parameters: props and ref. %s",_.length===1?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),_!=null&&_.defaultProps!=null&&console.error("forwardRef render functions do not support defaultProps. Did you accidentally pass a React component?");var V={$$typeof:qt,render:_},te;return Object.defineProperty(V,"displayName",{enumerable:!1,configurable:!0,get:function(){return te},set:function(ae){te=ae,_.name||_.displayName||(Object.defineProperty(_,"name",{value:ae}),_.displayName=ae)}}),V},e.isValidElement=X,e.lazy=function(_){return{$$typeof:tt,_payload:{_status:-1,_result:_},_init:de}},e.memo=function(_,V){p(_)||console.error("memo: The first argument must be a component. Instead received: %s",_===null?"null":typeof _),V={$$typeof:Tr,type:_,compare:V===void 0?null:V};var te;return Object.defineProperty(V,"displayName",{enumerable:!1,configurable:!0,get:function(){return te},set:function(ae){te=ae,_.name||_.displayName||(Object.defineProperty(_,"name",{value:ae}),_.displayName=ae)}}),V},e.startTransition=function(_){var V=_e.T,te={};_e.T=te,te._updatedFibers=new Set;try{var ae=_(),xe=_e.S;xe!==null&&xe(te,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(M,qe)}catch(Ee){qe(Ee)}finally{V===null&&te._updatedFibers&&(_=te._updatedFibers.size,te._updatedFibers.clear(),10<_&&console.warn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table.")),_e.T=V}},e.unstable_useCacheRefresh=function(){return ne().useCacheRefresh()},e.use=function(_){return ne().use(_)},e.useActionState=function(_,V,te){return ne().useActionState(_,V,te)},e.useCallback=function(_,V){return ne().useCallback(_,V)},e.useContext=function(_){var V=ne();return _.$$typeof===Vt&&console.error("Calling useContext(Context.Consumer) is not supported and will cause bugs. Did you mean to call useContext(Context) instead?"),V.useContext(_)},e.useDebugValue=function(_,V){return ne().useDebugValue(_,V)},e.useDeferredValue=function(_,V){return ne().useDeferredValue(_,V)},e.useEffect=function(_,V){return ne().useEffect(_,V)},e.useId=function(){return ne().useId()},e.useImperativeHandle=function(_,V,te){return ne().useImperativeHandle(_,V,te)},e.useInsertionEffect=function(_,V){return ne().useInsertionEffect(_,V)},e.useLayoutEffect=function(_,V){return ne().useLayoutEffect(_,V)},e.useMemo=function(_,V){return ne().useMemo(_,V)},e.useOptimistic=function(_,V){return ne().useOptimistic(_,V)},e.useReducer=function(_,V,te){return ne().useReducer(_,V,te)},e.useRef=function(_){return ne().useRef(_)},e.useState=function(_){return ne().useState(_)},e.useSyncExternalStore=function(_,V,te){return ne().useSyncExternalStore(_,V,te)},e.useTransition=function(){return ne().useTransition()},e.version="19.0.0",typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()}(da,da.exports)),da.exports}process.env.NODE_ENV==="production"?Md.exports=VA():Md.exports=HA();var m=Md.exports;const Me=Hy(m),zA=NA({__proto__:null,default:Me},[m]);/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hv;function WA(){return Hv||(Hv=1,process.env.NODE_ENV!=="production"&&function(){function r(R){if(R==null)return null;if(typeof R=="function")return R.$$typeof===de?null:R.displayName||R.name||null;if(typeof R=="string")return R;switch(R){case F:return"Fragment";case D:return"Portal";case B:return"Profiler";case U:return"StrictMode";case G:return"Suspense";case K:return"SuspenseList"}if(typeof R=="object")switch(typeof R.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),R.$$typeof){case Y:return(R.displayName||"Context")+".Provider";case X:return(R._context.displayName||"Context")+".Consumer";case Z:var he=R.render;return R=R.displayName,R||(R=he.displayName||he.name||"",R=R!==""?"ForwardRef("+R+")":"ForwardRef"),R;case oe:return he=R.displayName||null,he!==null?he:r(R.type)||"Memo";case ve:he=R._payload,R=R._init;try{return r(R(he))}catch{}}return null}function e(R){return""+R}function t(R){try{e(R);var he=!1}catch{he=!0}if(he){he=console;var pe=he.error,De=typeof Symbol=="function"&&Symbol.toStringTag&&R[Symbol.toStringTag]||R.constructor.name||"Object";return pe.call(he,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",De),e(R)}}function n(){}function s(){if(be===0){ye=console.log,ue=console.info,Xe=console.warn,ze=console.error,bt=console.group,wt=console.groupCollapsed,Vt=console.groupEnd;var R={configurable:!0,enumerable:!0,value:n,writable:!0};Object.defineProperties(console,{info:R,log:R,warn:R,error:R,group:R,groupCollapsed:R,groupEnd:R})}be++}function i(){if(be--,be===0){var R={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:z({},R,{value:ye}),info:z({},R,{value:ue}),warn:z({},R,{value:Xe}),error:z({},R,{value:ze}),group:z({},R,{value:bt}),groupCollapsed:z({},R,{value:wt}),groupEnd:z({},R,{value:Vt})})}0>be&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function a(R){if(Ce===void 0)try{throw Error()}catch(pe){var he=pe.stack.trim().match(/\n( *(at )?)/);Ce=he&&he[1]||"",qt=-1<pe.stack.indexOf(`
    at`)?" (<anonymous>)":-1<pe.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ce+R+qt}function c(R,he){if(!R||it)return"";var pe=Tt.get(R);if(pe!==void 0)return pe;it=!0,pe=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var De=null;De=ne.H,ne.H=null,s();try{var Je={DetermineComponentFrameRoot:function(){try{if(he){var Qt=function(){throw Error()};if(Object.defineProperty(Qt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qt,[])}catch(Kt){var jr=Kt}Reflect.construct(R,[],Qt)}else{try{Qt.call()}catch(Kt){jr=Kt}R.call(Qt.prototype)}}else{try{throw Error()}catch(Kt){jr=Kt}(Qt=R())&&typeof Qt.catch=="function"&&Qt.catch(function(){})}}catch(Kt){if(Kt&&jr&&typeof Kt.stack=="string")return[Kt.stack,jr.stack]}return[null,null]}};Je.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Ge=Object.getOwnPropertyDescriptor(Je.DetermineComponentFrameRoot,"name");Ge&&Ge.configurable&&Object.defineProperty(Je.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ke=Je.DetermineComponentFrameRoot(),_e=ke[0],Ht=ke[1];if(_e&&Ht){var _t=_e.split(`
`),zt=Ht.split(`
`);for(ke=Ge=0;Ge<_t.length&&!_t[Ge].includes("DetermineComponentFrameRoot");)Ge++;for(;ke<zt.length&&!zt[ke].includes("DetermineComponentFrameRoot");)ke++;if(Ge===_t.length||ke===zt.length)for(Ge=_t.length-1,ke=zt.length-1;1<=Ge&&0<=ke&&_t[Ge]!==zt[ke];)ke--;for(;1<=Ge&&0<=ke;Ge--,ke--)if(_t[Ge]!==zt[ke]){if(Ge!==1||ke!==1)do if(Ge--,ke--,0>ke||_t[Ge]!==zt[ke]){var Er=`
`+_t[Ge].replace(" at new "," at ");return R.displayName&&Er.includes("<anonymous>")&&(Er=Er.replace("<anonymous>",R.displayName)),typeof R=="function"&&Tt.set(R,Er),Er}while(1<=Ge&&0<=ke);break}}}finally{it=!1,ne.H=De,i(),Error.prepareStackTrace=pe}return _t=(_t=R?R.displayName||R.name:"")?a(_t):"",typeof R=="function"&&Tt.set(R,_t),_t}function u(R){if(R==null)return"";if(typeof R=="function"){var he=R.prototype;return c(R,!(!he||!he.isReactComponent))}if(typeof R=="string")return a(R);switch(R){case G:return a("Suspense");case K:return a("SuspenseList")}if(typeof R=="object")switch(R.$$typeof){case Z:return R=c(R.render,!1),R;case oe:return u(R.type);case ve:he=R._payload,R=R._init;try{return u(R(he))}catch{}}return""}function h(){var R=ne.A;return R===null?null:R.getOwner()}function d(R){if(M.call(R,"key")){var he=Object.getOwnPropertyDescriptor(R,"key").get;if(he&&he.isReactWarning)return!1}return R.key!==void 0}function p(R,he){function pe(){tt||(tt=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",he))}pe.isReactWarning=!0,Object.defineProperty(R,"key",{get:pe,configurable:!0})}function g(){var R=r(this.type);return Pt[R]||(Pt[R]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),R=this.props.ref,R!==void 0?R:null}function v(R,he,pe,De,Je,Ge){return pe=Ge.ref,R={$$typeof:I,type:R,key:he,props:Ge,_owner:Je},(pe!==void 0?pe:null)!==null?Object.defineProperty(R,"ref",{enumerable:!1,get:g}):Object.defineProperty(R,"ref",{enumerable:!1,value:null}),R._store={},Object.defineProperty(R._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(R,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.freeze&&(Object.freeze(R.props),Object.freeze(R)),R}function b(R,he,pe,De,Je,Ge){if(typeof R=="string"||typeof R=="function"||R===F||R===B||R===U||R===G||R===K||R===Q||typeof R=="object"&&R!==null&&(R.$$typeof===ve||R.$$typeof===oe||R.$$typeof===Y||R.$$typeof===X||R.$$typeof===Z||R.$$typeof===ce||R.getModuleId!==void 0)){var ke=he.children;if(ke!==void 0)if(De)if(fe(ke)){for(De=0;De<ke.length;De++)x(ke[De],R);Object.freeze&&Object.freeze(ke)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else x(ke,R)}else ke="",(R===void 0||typeof R=="object"&&R!==null&&Object.keys(R).length===0)&&(ke+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),R===null?De="null":fe(R)?De="array":R!==void 0&&R.$$typeof===I?(De="<"+(r(R.type)||"Unknown")+" />",ke=" Did you accidentally export a JSX literal instead of a component?"):De=typeof R,console.error("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",De,ke);if(M.call(he,"key")){ke=r(R);var _e=Object.keys(he).filter(function(_t){return _t!=="key"});De=0<_e.length?"{key: someKey, "+_e.join(": ..., ")+": ...}":"{key: someKey}",Gr[ke+De]||(_e=0<_e.length?"{"+_e.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,De,ke,_e,ke),Gr[ke+De]=!0)}if(ke=null,pe!==void 0&&(t(pe),ke=""+pe),d(he)&&(t(he.key),ke=""+he.key),"key"in he){pe={};for(var Ht in he)Ht!=="key"&&(pe[Ht]=he[Ht])}else pe=he;return ke&&p(pe,typeof R=="function"?R.displayName||R.name||"Unknown":R),v(R,ke,Ge,Je,h(),pe)}function x(R,he){if(typeof R=="object"&&R&&R.$$typeof!==Tr){if(fe(R))for(var pe=0;pe<R.length;pe++){var De=R[pe];C(De)&&T(De,he)}else if(C(R))R._store&&(R._store.validated=1);else if(R===null||typeof R!="object"?pe=null:(pe=ge&&R[ge]||R["@@iterator"],pe=typeof pe=="function"?pe:null),typeof pe=="function"&&pe!==R.entries&&(pe=pe.call(R),pe!==R))for(;!(R=pe.next()).done;)C(R.value)&&T(R.value,he)}}function C(R){return typeof R=="object"&&R!==null&&R.$$typeof===I}function T(R,he){if(R._store&&!R._store.validated&&R.key==null&&(R._store.validated=1,he=k(he),!sr[he])){sr[he]=!0;var pe="";R&&R._owner!=null&&R._owner!==h()&&(pe=null,typeof R._owner.tag=="number"?pe=r(R._owner.type):typeof R._owner.name=="string"&&(pe=R._owner.name),pe=" It was passed a child from "+pe+".");var De=ne.getCurrentStack;ne.getCurrentStack=function(){var Je=u(R.type);return De&&(Je+=De()||""),Je},console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',he,pe),ne.getCurrentStack=De}}function k(R){var he="",pe=h();return pe&&(pe=r(pe.type))&&(he=`

Check the render method of \``+pe+"`."),he||(R=r(R))&&(he=`

Check the top-level render call using <`+R+">."),he}var A=m,I=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Q=Symbol.for("react.offscreen"),ge=Symbol.iterator,de=Symbol.for("react.client.reference"),ne=A.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=Object.prototype.hasOwnProperty,z=Object.assign,ce=Symbol.for("react.client.reference"),fe=Array.isArray,be=0,ye,ue,Xe,ze,bt,wt,Vt;n.__reactDisabledLog=!0;var Ce,qt,it=!1,Tt=new(typeof WeakMap=="function"?WeakMap:Map),Tr=Symbol.for("react.client.reference"),tt,Pt={},Gr={},sr={};ia.Fragment=F,ia.jsx=function(R,he,pe,De,Je){return b(R,he,pe,!1,De,Je)},ia.jsxs=function(R,he,pe,De,Je){return b(R,he,pe,!0,De,Je)}}()),ia}process.env.NODE_ENV==="production"?Id.exports=BA():Id.exports=WA();var w=Id.exports;function zv(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function zy(...r){return e=>{let t=!1;const n=r.map(s=>{const i=zv(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():zv(r[s],null)}}}}function _r(...r){return m.useCallback(zy(...r),r)}var uo=m.forwardRef((r,e)=>{const{children:t,...n}=r,s=m.Children.toArray(t),i=s.find($A);if(i){const a=i.props.children,c=s.map(u=>u===i?m.Children.count(a)>1?m.Children.only(null):m.isValidElement(a)?a.props.children:null:u);return w.jsx(Pd,{...n,ref:e,children:m.isValidElement(a)?m.cloneElement(a,void 0,c):null})}return w.jsx(Pd,{...n,ref:e,children:t})});uo.displayName="Slot";var Pd=m.forwardRef((r,e)=>{const{children:t,...n}=r;if(m.isValidElement(t)){const s=XA(t),i=YA(n,t.props);return t.type!==m.Fragment&&(i.ref=e?zy(e,s):s),m.cloneElement(t,i)}return m.Children.count(t)>1?m.Children.only(null):null});Pd.displayName="SlotClone";var UA=({children:r})=>w.jsx(w.Fragment,{children:r});function $A(r){return m.isValidElement(r)&&r.type===UA}function YA(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...c)=>{i(...c),s(...c)}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function XA(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var GA=uo;function Wy(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=Wy(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Uy(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=Wy(r))&&(n&&(n+=" "),n+=e);return n}const Wv=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Uv=Uy,qA=(r,e)=>t=>{var n;if(e?.variants==null)return Uv(r,t?.class,t?.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(h=>{const d=t?.[h],p=i?.[h];if(d===null)return null;const g=Wv(d)||Wv(p);return s[h][g]}),c=t&&Object.entries(t).reduce((h,d)=>{let[p,g]=d;return g===void 0||(h[p]=g),h},{}),u=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((h,d)=>{let{class:p,className:g,...v}=d;return Object.entries(v).every(b=>{let[x,C]=b;return Array.isArray(C)?C.includes({...i,...c}[x]):{...i,...c}[x]===C})?[...h,p,g]:h},[]);return Uv(r,a,u,t?.class,t?.className)},Rf="-",KA=r=>{const e=JA(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:a=>{const c=a.split(Rf);return c[0]===""&&c.length!==1&&c.shift(),$y(c,e)||ZA(a)},getConflictingClassGroupIds:(a,c)=>{const u=t[a]||[];return c&&n[a]?[...u,...n[a]]:u}}},$y=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?$y(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(Rf);return e.validators.find(({validator:a})=>a(i))?.classGroupId},$v=/^\[(.+)\]$/,ZA=r=>{if($v.test(r)){const e=$v.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},JA=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return eI(Object.entries(r.classGroups),t).forEach(([i,a])=>{Dd(a,n,i,e)}),n},Dd=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Yv(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(QA(s)){Dd(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,a])=>{Dd(a,Yv(e,i),t,n)})})},Yv=(r,e)=>{let t=r;return e.split(Rf).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},QA=r=>r.isThemeGetter,eI=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,c])=>[e+a,c])):i);return[t,s]}):r,tI=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,a)=>{t.set(i,a),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let a=t.get(i);if(a!==void 0)return a;if((a=n.get(i))!==void 0)return s(i,a),a},set(i,a){t.has(i)?t.set(i,a):s(i,a)}}},Yy="!",rI=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,a=c=>{const u=[];let h=0,d=0,p;for(let C=0;C<c.length;C++){let T=c[C];if(h===0){if(T===s&&(n||c.slice(C,C+i)===e)){u.push(c.slice(d,C)),d=C+i;continue}if(T==="/"){p=C;continue}}T==="["?h++:T==="]"&&h--}const g=u.length===0?c:c.substring(d),v=g.startsWith(Yy),b=v?g.substring(1):g,x=p&&p>d?p-d:void 0;return{modifiers:u,hasImportantModifier:v,baseClassName:b,maybePostfixModifierPosition:x}};return t?c=>t({className:c,parseClassName:a}):a},nI=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},sI=r=>({cache:tI(r.cacheSize),parseClassName:rI(r),...KA(r)}),iI=/\s+/,oI=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],a=r.trim().split(iI);let c="";for(let u=a.length-1;u>=0;u-=1){const h=a[u],{modifiers:d,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:v}=t(h);let b=!!v,x=n(b?g.substring(0,v):g);if(!x){if(!b){c=h+(c.length>0?" "+c:c);continue}if(x=n(g),!x){c=h+(c.length>0?" "+c:c);continue}b=!1}const C=nI(d).join(":"),T=p?C+Yy:C,k=T+x;if(i.includes(k))continue;i.push(k);const A=s(x,b);for(let I=0;I<A.length;++I){const D=A[I];i.push(T+D)}c=h+(c.length>0?" "+c:c)}return c};function aI(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=Xy(e))&&(n&&(n+=" "),n+=t);return n}const Xy=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=Xy(r[n]))&&(t&&(t+=" "),t+=e);return t};function cI(r,...e){let t,n,s,i=a;function a(u){const h=e.reduce((d,p)=>p(d),r());return t=sI(h),n=t.cache.get,s=t.cache.set,i=c,c(u)}function c(u){const h=n(u);if(h)return h;const d=oI(u,t);return s(u,d),d}return function(){return i(aI.apply(null,arguments))}}const pt=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},Gy=/^\[(?:([a-z-]+):)?(.+)\]$/i,lI=/^\d+\/\d+$/,uI=new Set(["px","full","screen"]),hI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,dI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,pI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zn=r=>ao(r)||uI.has(r)||lI.test(r),Ss=r=>vo(r,"length",SI),ao=r=>!!r&&!Number.isNaN(Number(r)),Qh=r=>vo(r,"number",ao),oa=r=>!!r&&Number.isInteger(Number(r)),mI=r=>r.endsWith("%")&&ao(r.slice(0,-1)),Ne=r=>Gy.test(r),Cs=r=>hI.test(r),vI=new Set(["length","size","percentage"]),yI=r=>vo(r,vI,qy),bI=r=>vo(r,"position",qy),wI=new Set(["image","url"]),_I=r=>vo(r,wI,TI),xI=r=>vo(r,"",CI),aa=()=>!0,vo=(r,e,t)=>{const n=Gy.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},SI=r=>dI.test(r)&&!fI.test(r),qy=()=>!1,CI=r=>pI.test(r),TI=r=>gI.test(r),EI=()=>{const r=pt("colors"),e=pt("spacing"),t=pt("blur"),n=pt("brightness"),s=pt("borderColor"),i=pt("borderRadius"),a=pt("borderSpacing"),c=pt("borderWidth"),u=pt("contrast"),h=pt("grayscale"),d=pt("hueRotate"),p=pt("invert"),g=pt("gap"),v=pt("gradientColorStops"),b=pt("gradientColorStopPositions"),x=pt("inset"),C=pt("margin"),T=pt("opacity"),k=pt("padding"),A=pt("saturate"),I=pt("scale"),D=pt("sepia"),F=pt("skew"),U=pt("space"),B=pt("translate"),X=()=>["auto","contain","none"],Y=()=>["auto","hidden","clip","visible","scroll"],Z=()=>["auto",Ne,e],G=()=>[Ne,e],K=()=>["",Zn,Ss],oe=()=>["auto",ao,Ne],ve=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Q=()=>["solid","dashed","dotted","double","none"],ge=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],de=()=>["start","end","center","between","around","evenly","stretch"],ne=()=>["","0",Ne],M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],z=()=>[ao,Ne];return{cacheSize:500,separator:":",theme:{colors:[aa],spacing:[Zn,Ss],blur:["none","",Cs,Ne],brightness:z(),borderColor:[r],borderRadius:["none","","full",Cs,Ne],borderSpacing:G(),borderWidth:K(),contrast:z(),grayscale:ne(),hueRotate:z(),invert:ne(),gap:G(),gradientColorStops:[r],gradientColorStopPositions:[mI,Ss],inset:Z(),margin:Z(),opacity:z(),padding:G(),saturate:z(),scale:z(),sepia:ne(),skew:z(),space:G(),translate:G()},classGroups:{aspect:[{aspect:["auto","square","video",Ne]}],container:["container"],columns:[{columns:[Cs]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ve(),Ne]}],overflow:[{overflow:Y()}],"overflow-x":[{"overflow-x":Y()}],"overflow-y":[{"overflow-y":Y()}],overscroll:[{overscroll:X()}],"overscroll-x":[{"overscroll-x":X()}],"overscroll-y":[{"overscroll-y":X()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",oa,Ne]}],basis:[{basis:Z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ne]}],grow:[{grow:ne()}],shrink:[{shrink:ne()}],order:[{order:["first","last","none",oa,Ne]}],"grid-cols":[{"grid-cols":[aa]}],"col-start-end":[{col:["auto",{span:["full",oa,Ne]},Ne]}],"col-start":[{"col-start":oe()}],"col-end":[{"col-end":oe()}],"grid-rows":[{"grid-rows":[aa]}],"row-start-end":[{row:["auto",{span:[oa,Ne]},Ne]}],"row-start":[{"row-start":oe()}],"row-end":[{"row-end":oe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ne]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ne]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...de()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...de(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...de(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[U]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[U]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ne,e]}],"min-w":[{"min-w":[Ne,e,"min","max","fit"]}],"max-w":[{"max-w":[Ne,e,"none","full","min","max","fit","prose",{screen:[Cs]},Cs]}],h:[{h:[Ne,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ne,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ne,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ne,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Cs,Ss]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Qh]}],"font-family":[{font:[aa]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ne]}],"line-clamp":[{"line-clamp":["none",ao,Qh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zn,Ne]}],"list-image":[{"list-image":["none",Ne]}],"list-style-type":[{list:["none","disc","decimal",Ne]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Zn,Ss]}],"underline-offset":[{"underline-offset":["auto",Zn,Ne]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:G()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ne]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ne]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ve(),bI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",yI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},_I]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...Q(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:Q()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Q()]}],"outline-offset":[{"outline-offset":[Zn,Ne]}],"outline-w":[{outline:[Zn,Ss]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[Zn,Ss]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Cs,xI]}],"shadow-color":[{shadow:[aa]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...ge(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ge()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Cs,Ne]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[p]}],saturate:[{saturate:[A]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[A]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ne]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",Ne]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ne]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[I]}],"scale-x":[{"scale-x":[I]}],"scale-y":[{"scale-y":[I]}],rotate:[{rotate:[oa,Ne]}],"translate-x":[{"translate-x":[B]}],"translate-y":[{"translate-y":[B]}],"skew-x":[{"skew-x":[F]}],"skew-y":[{"skew-y":[F]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ne]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ne]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":G()}],"scroll-mx":[{"scroll-mx":G()}],"scroll-my":[{"scroll-my":G()}],"scroll-ms":[{"scroll-ms":G()}],"scroll-me":[{"scroll-me":G()}],"scroll-mt":[{"scroll-mt":G()}],"scroll-mr":[{"scroll-mr":G()}],"scroll-mb":[{"scroll-mb":G()}],"scroll-ml":[{"scroll-ml":G()}],"scroll-p":[{"scroll-p":G()}],"scroll-px":[{"scroll-px":G()}],"scroll-py":[{"scroll-py":G()}],"scroll-ps":[{"scroll-ps":G()}],"scroll-pe":[{"scroll-pe":G()}],"scroll-pt":[{"scroll-pt":G()}],"scroll-pr":[{"scroll-pr":G()}],"scroll-pb":[{"scroll-pb":G()}],"scroll-pl":[{"scroll-pl":G()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ne]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Zn,Ss,Qh]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},kI=cI(EI);function Fs(...r){return kI(Uy(r))}function OI(r,e={}){const{decimals:t=0,sizeType:n="normal"}=e,s=["Bytes","KB","MB","GB","TB"],i=["Bytes","KiB","MiB","GiB","TiB"];if(r===0)return"0 Byte";const a=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,a)).toFixed(t)} ${n==="accurate"?i[a]??"Bytest":s[a]??"Bytes"}`}const Ky=qA("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),hr=m.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const a=n?uo:"button";return w.jsx(a,{className:Fs(Ky({variant:e,size:t,className:r})),ref:i,...s})});hr.displayName="Button";function jf(r,[e,t]){return Math.min(t,Math.max(e,r))}function At(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r?.(s),t===!1||!s.defaultPrevented)return e?.(s)}}function Ua(r,e=[]){let t=[];function n(i,a){const c=m.createContext(a),u=t.length;t=[...t,a];const h=p=>{const{scope:g,children:v,...b}=p,x=g?.[r]?.[u]||c,C=m.useMemo(()=>b,Object.values(b));return w.jsx(x.Provider,{value:C,children:v})};h.displayName=i+"Provider";function d(p,g){const v=g?.[r]?.[u]||c,b=m.useContext(v);if(b)return b;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[h,d]}const s=()=>{const i=t.map(a=>m.createContext(a));return function(c){const u=c?.[r]||i;return m.useMemo(()=>({[`__scope${r}`]:{...c,[r]:u}}),[c,u])}};return s.scopeName=r,[n,AI(s,...e)]}function AI(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((c,{useScope:u,scopeName:h})=>{const p=u(i)[`__scope${h}`];return{...c,...p}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function Mn(r){const e=m.useRef(r);return m.useEffect(()=>{e.current=r}),m.useMemo(()=>(...t)=>e.current?.(...t),[])}function Lf({prop:r,defaultProp:e,onChange:t=()=>{}}){const[n,s]=II({defaultProp:e,onChange:t}),i=r!==void 0,a=i?r:n,c=Mn(t),u=m.useCallback(h=>{if(i){const p=typeof h=="function"?h(r):h;p!==r&&c(p)}else s(h)},[i,r,s,c]);return[a,u]}function II({defaultProp:r,onChange:e}){const t=m.useState(r),[n]=t,s=m.useRef(n),i=Mn(e);return m.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),t}var MI=m.createContext(void 0);function eu(r){const e=m.useContext(MI);return r||e||"ltr"}function PI(r){const e=m.useRef({value:r,previous:r});return m.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var ka=globalThis?.document?m.useLayoutEffect:()=>{};function DI(r){const[e,t]=m.useState(void 0);return ka(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,c;if("borderBoxSize"in i){const u=i.borderBoxSize,h=Array.isArray(u)?u[0]:u;a=h.inlineSize,c=h.blockSize}else a=r.offsetWidth,c=r.offsetHeight;t({width:a,height:c})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var Rd={exports:{}},cr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function RI(){if(Xv)return cr;Xv=1;var r=m;function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(u,h,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:u,containerInfo:h,implementation:d}}var a=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return cr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,cr.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return i(u,h,null,d)},cr.flushSync=function(u){var h=a.T,d=n.p;try{if(a.T=null,n.p=2,u)return u()}finally{a.T=h,n.p=d,n.d.f()}},cr.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(u,h))},cr.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},cr.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,p=c(d,h.crossOrigin),g=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?n.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):d==="script"&&n.d.X(u,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},cr.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=c(h.as,h.crossOrigin);n.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(u)},cr.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,p=c(d,h.crossOrigin);n.d.L(u,d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},cr.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=c(h.as,h.crossOrigin);n.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(u)},cr.requestFormReset=function(u){n.d.r(u)},cr.unstable_batchedUpdates=function(u,h){return u(h)},cr.useFormState=function(u,h,d){return a.H.useFormState(u,h,d)},cr.useFormStatus=function(){return a.H.useHostTransitionStatus()},cr.version="19.0.0",cr}var lr={};/**
 * @license React
 * react-dom.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function jI(){return Gv||(Gv=1,process.env.NODE_ENV!=="production"&&function(){function r(){}function e(p){return""+p}function t(p,g,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;try{e(b);var x=!1}catch{x=!0}return x&&(console.error("The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",typeof Symbol=="function"&&Symbol.toStringTag&&b[Symbol.toStringTag]||b.constructor.name||"Object"),e(b)),{$$typeof:h,key:b==null?null:""+b,children:p,containerInfo:g,implementation:v}}function n(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}function s(p){return p===null?"`null`":p===void 0?"`undefined`":p===""?"an empty string":'something with type "'+typeof p+'"'}function i(p){return p===null?"`null`":p===void 0?"`undefined`":p===""?"an empty string":typeof p=="string"?JSON.stringify(p):typeof p=="number"?"`"+p+"`":'something with type "'+typeof p+'"'}function a(){var p=d.H;return p===null&&console.error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.`),p}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var c=m,u={d:{f:r,r:function(){throw Error("Invalid form element. requestFormReset must be passed a form that was rendered by React.")},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},h=Symbol.for("react.portal"),d=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;typeof Map=="function"&&Map.prototype!=null&&typeof Map.prototype.forEach=="function"&&typeof Set=="function"&&Set.prototype!=null&&typeof Set.prototype.clear=="function"&&typeof Set.prototype.forEach=="function"||console.error("React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),lr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=u,lr.createPortal=function(p,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error("Target container is not a DOM element.");return t(p,g,null,v)},lr.flushSync=function(p){var g=d.T,v=u.p;try{if(d.T=null,u.p=2,p)return p()}finally{d.T=g,u.p=v,u.d.f()&&console.error("flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task.")}},lr.preconnect=function(p,g){typeof p=="string"&&p?g!=null&&typeof g!="object"?console.error("ReactDOM.preconnect(): Expected the `options` argument (second) to be an object but encountered %s instead. The only supported option at this time is `crossOrigin` which accepts a string.",i(g)):g!=null&&typeof g.crossOrigin!="string"&&console.error("ReactDOM.preconnect(): Expected the `crossOrigin` option (second argument) to be a string but encountered %s instead. Try removing this option or passing a string value instead.",s(g.crossOrigin)):console.error("ReactDOM.preconnect(): Expected the `href` argument (first) to be a non-empty string but encountered %s instead.",s(p)),typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,u.d.C(p,g))},lr.prefetchDNS=function(p){if(typeof p!="string"||!p)console.error("ReactDOM.prefetchDNS(): Expected the `href` argument (first) to be a non-empty string but encountered %s instead.",s(p));else if(1<arguments.length){var g=arguments[1];typeof g=="object"&&g.hasOwnProperty("crossOrigin")?console.error("ReactDOM.prefetchDNS(): Expected only one argument, `href`, but encountered %s as a second argument instead. This argument is reserved for future options and is currently disallowed. It looks like the you are attempting to set a crossOrigin property for this DNS lookup hint. Browsers do not perform DNS queries using CORS and setting this attribute on the resource hint has no effect. Try calling ReactDOM.prefetchDNS() with just a single string argument, `href`.",i(g)):console.error("ReactDOM.prefetchDNS(): Expected only one argument, `href`, but encountered %s as a second argument instead. This argument is reserved for future options and is currently disallowed. Try calling ReactDOM.prefetchDNS() with just a single string argument, `href`.",i(g))}typeof p=="string"&&u.d.D(p)},lr.preinit=function(p,g){if(typeof p=="string"&&p?g==null||typeof g!="object"?console.error("ReactDOM.preinit(): Expected the `options` argument (second) to be an object with an `as` property describing the type of resource to be preinitialized but encountered %s instead.",i(g)):g.as!=="style"&&g.as!=="script"&&console.error('ReactDOM.preinit(): Expected the `as` property in the `options` argument (second) to contain a valid value describing the type of resource to be preinitialized but encountered %s instead. Valid values for `as` are "style" and "script".',i(g.as)):console.error("ReactDOM.preinit(): Expected the `href` argument (first) to be a non-empty string but encountered %s instead.",s(p)),typeof p=="string"&&g&&typeof g.as=="string"){var v=g.as,b=n(v,g.crossOrigin),x=typeof g.integrity=="string"?g.integrity:void 0,C=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;v==="style"?u.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:b,integrity:x,fetchPriority:C}):v==="script"&&u.d.X(p,{crossOrigin:b,integrity:x,fetchPriority:C,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},lr.preinitModule=function(p,g){var v="";if(typeof p=="string"&&p||(v+=" The `href` argument encountered was "+s(p)+"."),g!==void 0&&typeof g!="object"?v+=" The `options` argument encountered was "+s(g)+".":g&&"as"in g&&g.as!=="script"&&(v+=" The `as` option encountered was "+i(g.as)+"."),v)console.error("ReactDOM.preinitModule(): Expected up to two arguments, a non-empty `href` string and, optionally, an `options` object with a valid `as` property.%s",v);else switch(v=g&&typeof g.as=="string"?g.as:"script",v){case"script":break;default:v=i(v),console.error('ReactDOM.preinitModule(): Currently the only supported "as" type for this function is "script" but received "%s" instead. This warning was generated for `href` "%s". In the future other module types will be supported, aligning with the import-attributes proposal. Learn more here: (https://github.com/tc39/proposal-import-attributes)',v,p)}typeof p=="string"&&(typeof g=="object"&&g!==null?(g.as==null||g.as==="script")&&(v=n(g.as,g.crossOrigin),u.d.M(p,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})):g==null&&u.d.M(p))},lr.preload=function(p,g){var v="";if(typeof p=="string"&&p||(v+=" The `href` argument encountered was "+s(p)+"."),g==null||typeof g!="object"?v+=" The `options` argument encountered was "+s(g)+".":typeof g.as=="string"&&g.as||(v+=" The `as` option encountered was "+s(g.as)+"."),v&&console.error('ReactDOM.preload(): Expected two arguments, a non-empty `href` string and an `options` object with an `as` property valid for a `<link rel="preload" as="..." />` tag.%s',v),typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){v=g.as;var b=n(v,g.crossOrigin);u.d.L(p,v,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},lr.preloadModule=function(p,g){var v="";typeof p=="string"&&p||(v+=" The `href` argument encountered was "+s(p)+"."),g!==void 0&&typeof g!="object"?v+=" The `options` argument encountered was "+s(g)+".":g&&"as"in g&&typeof g.as!="string"&&(v+=" The `as` option encountered was "+s(g.as)+"."),v&&console.error('ReactDOM.preloadModule(): Expected two arguments, a non-empty `href` string and, optionally, an `options` object with an `as` property valid for a `<link rel="modulepreload" as="..." />` tag.%s',v),typeof p=="string"&&(g?(v=n(g.as,g.crossOrigin),u.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0})):u.d.m(p))},lr.requestFormReset=function(p){u.d.r(p)},lr.unstable_batchedUpdates=function(p,g){return p(g)},lr.useFormState=function(p,g,v){return a().useFormState(p,g,v)},lr.useFormStatus=function(){return a().useHostTransitionStatus()},lr.version="19.0.0",typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),lr}function Zy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function")){if(process.env.NODE_ENV!=="production")throw new Error("^_^");try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zy)}catch(r){console.error(r)}}}process.env.NODE_ENV==="production"?(Zy(),Rd.exports=RI()):Rd.exports=jI();var jd=Rd.exports,LI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Cr=LI.reduce((r,e)=>{const t=m.forwardRef((n,s)=>{const{asChild:i,...a}=n,c=i?uo:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(c,{...a,ref:s})});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{});function Jy(r){const e=r+"CollectionProvider",[t,n]=Ua(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),a=v=>{const{scope:b,children:x}=v,C=Me.useRef(null),T=Me.useRef(new Map).current;return w.jsx(s,{scope:b,itemMap:T,collectionRef:C,children:x})};a.displayName=e;const c=r+"CollectionSlot",u=Me.forwardRef((v,b)=>{const{scope:x,children:C}=v,T=i(c,x),k=_r(b,T.collectionRef);return w.jsx(uo,{ref:k,children:C})});u.displayName=c;const h=r+"CollectionItemSlot",d="data-radix-collection-item",p=Me.forwardRef((v,b)=>{const{scope:x,children:C,...T}=v,k=Me.useRef(null),A=_r(b,k),I=i(h,x);return Me.useEffect(()=>(I.itemMap.set(k,{ref:k,...T}),()=>void I.itemMap.delete(k))),w.jsx(uo,{[d]:"",ref:A,children:C})});p.displayName=h;function g(v){const b=i(r+"CollectionConsumer",v);return Me.useCallback(()=>{const C=b.collectionRef.current;if(!C)return[];const T=Array.from(C.querySelectorAll(`[${d}]`));return Array.from(b.itemMap.values()).sort((I,D)=>T.indexOf(I.ref.current)-T.indexOf(D.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:a,Slot:u,ItemSlot:p},g,n]}var Qy=["PageUp","PageDown"],e1=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],t1={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},yo="Slider",[Ld,FI,NI]=Jy(yo),[r1,rN]=Ua(yo,[NI]),[BI,tu]=r1(yo),n1=m.forwardRef((r,e)=>{const{name:t,min:n=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:u=0,defaultValue:h=[n],value:d,onValueChange:p=()=>{},onValueCommit:g=()=>{},inverted:v=!1,form:b,...x}=r,C=m.useRef(new Set),T=m.useRef(0),A=a==="horizontal"?VI:HI,[I=[],D]=Lf({prop:d,defaultProp:h,onChange:Z=>{[...C.current][T.current]?.focus(),p(Z)}}),F=m.useRef(I);function U(Z){const G=YI(I,Z);Y(Z,G)}function B(Z){Y(Z,T.current)}function X(){const Z=F.current[T.current];I[T.current]!==Z&&g(I)}function Y(Z,G,{commit:K}={commit:!1}){const oe=KI(i),ve=ZI(Math.round((Z-n)/i)*i+n,oe),Q=jf(ve,[n,s]);D((ge=[])=>{const de=UI(ge,Q,G);if(qI(de,u*i)){T.current=de.indexOf(Q);const ne=String(de)!==String(ge);return ne&&K&&g(de),ne?de:ge}else return ge})}return w.jsx(BI,{scope:r.__scopeSlider,name:t,disabled:c,min:n,max:s,valueIndexToChangeRef:T,thumbs:C.current,values:I,orientation:a,form:b,children:w.jsx(Ld.Provider,{scope:r.__scopeSlider,children:w.jsx(Ld.Slot,{scope:r.__scopeSlider,children:w.jsx(A,{"aria-disabled":c,"data-disabled":c?"":void 0,...x,ref:e,onPointerDown:At(x.onPointerDown,()=>{c||(F.current=I)}),min:n,max:s,inverted:v,onSlideStart:c?void 0:U,onSlideMove:c?void 0:B,onSlideEnd:c?void 0:X,onHomeKeyDown:()=>!c&&Y(n,0,{commit:!0}),onEndKeyDown:()=>!c&&Y(s,I.length-1,{commit:!0}),onStepKeyDown:({event:Z,direction:G})=>{if(!c){const ve=Qy.includes(Z.key)||Z.shiftKey&&e1.includes(Z.key)?10:1,Q=T.current,ge=I[Q],de=i*ve*G;Y(ge+de,Q,{commit:!0})}}})})})})});n1.displayName=yo;var[s1,i1]=r1(yo,{startEdge:"left",endEdge:"right",size:"width",direction:1}),VI=m.forwardRef((r,e)=>{const{min:t,max:n,dir:s,inverted:i,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onStepKeyDown:h,...d}=r,[p,g]=m.useState(null),v=_r(e,A=>g(A)),b=m.useRef(void 0),x=eu(s),C=x==="ltr",T=C&&!i||!C&&i;function k(A){const I=b.current||p.getBoundingClientRect(),D=[0,I.width],U=Ff(D,T?[t,n]:[n,t]);return b.current=I,U(A-I.left)}return w.jsx(s1,{scope:r.__scopeSlider,startEdge:T?"left":"right",endEdge:T?"right":"left",direction:T?1:-1,size:"width",children:w.jsx(o1,{dir:x,"data-orientation":"horizontal",...d,ref:v,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:A=>{const I=k(A.clientX);a?.(I)},onSlideMove:A=>{const I=k(A.clientX);c?.(I)},onSlideEnd:()=>{b.current=void 0,u?.()},onStepKeyDown:A=>{const D=t1[T?"from-left":"from-right"].includes(A.key);h?.({event:A,direction:D?-1:1})}})})}),HI=m.forwardRef((r,e)=>{const{min:t,max:n,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:c,onStepKeyDown:u,...h}=r,d=m.useRef(null),p=_r(e,d),g=m.useRef(void 0),v=!s;function b(x){const C=g.current||d.current.getBoundingClientRect(),T=[0,C.height],A=Ff(T,v?[n,t]:[t,n]);return g.current=C,A(x-C.top)}return w.jsx(s1,{scope:r.__scopeSlider,startEdge:v?"bottom":"top",endEdge:v?"top":"bottom",size:"height",direction:v?1:-1,children:w.jsx(o1,{"data-orientation":"vertical",...h,ref:p,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:x=>{const C=b(x.clientY);i?.(C)},onSlideMove:x=>{const C=b(x.clientY);a?.(C)},onSlideEnd:()=>{g.current=void 0,c?.()},onStepKeyDown:x=>{const T=t1[v?"from-bottom":"from-top"].includes(x.key);u?.({event:x,direction:T?-1:1})}})})}),o1=m.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:u,...h}=r,d=tu(yo,t);return w.jsx(Cr.span,{...h,ref:e,onKeyDown:At(r.onKeyDown,p=>{p.key==="Home"?(a(p),p.preventDefault()):p.key==="End"?(c(p),p.preventDefault()):Qy.concat(e1).includes(p.key)&&(u(p),p.preventDefault())}),onPointerDown:At(r.onPointerDown,p=>{const g=p.target;g.setPointerCapture(p.pointerId),p.preventDefault(),d.thumbs.has(g)?g.focus():n(p)}),onPointerMove:At(r.onPointerMove,p=>{p.target.hasPointerCapture(p.pointerId)&&s(p)}),onPointerUp:At(r.onPointerUp,p=>{const g=p.target;g.hasPointerCapture(p.pointerId)&&(g.releasePointerCapture(p.pointerId),i(p))})})}),a1="SliderTrack",c1=m.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,s=tu(a1,t);return w.jsx(Cr.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:e})});c1.displayName=a1;var Fd="SliderRange",l1=m.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,s=tu(Fd,t),i=i1(Fd,t),a=m.useRef(null),c=_r(e,a),u=s.values.length,h=s.values.map(g=>h1(g,s.min,s.max)),d=u>1?Math.min(...h):0,p=100-Math.max(...h);return w.jsx(Cr.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...n,ref:c,style:{...r.style,[i.startEdge]:d+"%",[i.endEdge]:p+"%"}})});l1.displayName=Fd;var Nd="SliderThumb",u1=m.forwardRef((r,e)=>{const t=FI(r.__scopeSlider),[n,s]=m.useState(null),i=_r(e,c=>s(c)),a=m.useMemo(()=>n?t().findIndex(c=>c.ref.current===n):-1,[t,n]);return w.jsx(zI,{...r,ref:i,index:a})}),zI=m.forwardRef((r,e)=>{const{__scopeSlider:t,index:n,name:s,...i}=r,a=tu(Nd,t),c=i1(Nd,t),[u,h]=m.useState(null),d=_r(e,k=>h(k)),p=u?a.form||!!u.closest("form"):!0,g=DI(u),v=a.values[n],b=v===void 0?0:h1(v,a.min,a.max),x=$I(n,a.values.length),C=g?.[c.size],T=C?XI(C,b,c.direction):0;return m.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),w.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${b}% + ${T}px)`},children:[w.jsx(Ld.ItemSlot,{scope:r.__scopeSlider,children:w.jsx(Cr.span,{role:"slider","aria-label":r["aria-label"]||x,"aria-valuemin":a.min,"aria-valuenow":v,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:d,style:v===void 0?{display:"none"}:r.style,onFocus:At(r.onFocus,()=>{a.valueIndexToChangeRef.current=n})})}),p&&w.jsx(WI,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:v},n)]})});u1.displayName=Nd;var WI=r=>{const{value:e,...t}=r,n=m.useRef(null),s=PI(e);return m.useEffect(()=>{const i=n.current,a=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==e&&u){const h=new Event("input",{bubbles:!0});u.call(i,e),i.dispatchEvent(h)}},[s,e]),w.jsx("input",{style:{display:"none"},...t,ref:n,defaultValue:e})};function UI(r=[],e,t){const n=[...r];return n[t]=e,n.sort((s,i)=>s-i)}function h1(r,e,t){const i=100/(t-e)*(r-e);return jf(i,[0,100])}function $I(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function YI(r,e){if(r.length===1)return 0;const t=r.map(s=>Math.abs(s-e)),n=Math.min(...t);return t.indexOf(n)}function XI(r,e,t){const n=r/2,i=Ff([0,50],[0,n]);return(n-i(e)*t)*t}function GI(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function qI(r,e){if(e>0){const t=GI(r);return Math.min(...t)>=e}return!0}function Ff(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function KI(r){return(String(r).split(".")[1]||"").length}function ZI(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var d1=n1,JI=c1,QI=l1,eM=u1;const f1=m.forwardRef(({className:r,...e},t)=>w.jsxs(d1,{ref:t,className:Fs("relative flex w-full touch-none select-none items-center",r),...e,children:[w.jsx(JI,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:w.jsx(QI,{className:"absolute h-full bg-primary"})}),w.jsx(eM,{className:"block h-4 w-4 cursor-pointer rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));f1.displayName=d1.displayName;function tM(r,e){return m.useReducer((t,n)=>e[t][n]??t,r)}var bo=r=>{const{present:e,children:t}=r,n=rM(e),s=typeof t=="function"?t({present:n.isPresent}):m.Children.only(t),i=_r(n.ref,nM(s));return typeof t=="function"||n.isPresent?m.cloneElement(s,{ref:i}):null};bo.displayName="Presence";function rM(r){const[e,t]=m.useState(),n=m.useRef({}),s=m.useRef(r),i=m.useRef("none"),a=r?"mounted":"unmounted",[c,u]=tM(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const h=Yc(n.current);i.current=c==="mounted"?h:"none"},[c]),ka(()=>{const h=n.current,d=s.current;if(d!==r){const g=i.current,v=Yc(h);r?u("MOUNT"):v==="none"||h?.display==="none"?u("UNMOUNT"):u(d&&g!==v?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,u]),ka(()=>{if(e){let h;const d=e.ownerDocument.defaultView??window,p=v=>{const x=Yc(n.current).includes(v.animationName);if(v.target===e&&x&&(u("ANIMATION_END"),!s.current)){const C=e.style.animationFillMode;e.style.animationFillMode="forwards",h=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=C)})}},g=v=>{v.target===e&&(i.current=Yc(n.current))};return e.addEventListener("animationstart",g),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{d.clearTimeout(h),e.removeEventListener("animationstart",g),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:m.useCallback(h=>{h&&(n.current=getComputedStyle(h)),t(h)},[])}}function Yc(r){return r?.animationName||"none"}function nM(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function sM(r,e){return m.useReducer((t,n)=>e[t][n]??t,r)}var Nf="ScrollArea",[p1,nN]=Ua(Nf),[iM,un]=p1(Nf),g1=m.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:s,scrollHideDelay:i=600,...a}=r,[c,u]=m.useState(null),[h,d]=m.useState(null),[p,g]=m.useState(null),[v,b]=m.useState(null),[x,C]=m.useState(null),[T,k]=m.useState(0),[A,I]=m.useState(0),[D,F]=m.useState(!1),[U,B]=m.useState(!1),X=_r(e,Z=>u(Z)),Y=eu(s);return w.jsx(iM,{scope:t,type:n,dir:Y,scrollHideDelay:i,scrollArea:c,viewport:h,onViewportChange:d,content:p,onContentChange:g,scrollbarX:v,onScrollbarXChange:b,scrollbarXEnabled:D,onScrollbarXEnabledChange:F,scrollbarY:x,onScrollbarYChange:C,scrollbarYEnabled:U,onScrollbarYEnabledChange:B,onCornerWidthChange:k,onCornerHeightChange:I,children:w.jsx(Cr.div,{dir:Y,...a,ref:X,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":A+"px",...r.style}})})});g1.displayName=Nf;var m1="ScrollAreaViewport",v1=m.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,nonce:s,...i}=r,a=un(m1,t),c=m.useRef(null),u=_r(e,c,a.onViewportChange);return w.jsxs(w.Fragment,{children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),w.jsx(Cr.div,{"data-radix-scroll-area-viewport":"",...i,ref:u,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...r.style},children:w.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});v1.displayName=m1;var Bn="ScrollAreaScrollbar",ru=m.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=un(Bn,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,c=r.orientation==="horizontal";return m.useEffect(()=>(c?i(!0):a(!0),()=>{c?i(!1):a(!1)}),[c,i,a]),s.type==="hover"?w.jsx(oM,{...n,ref:e,forceMount:t}):s.type==="scroll"?w.jsx(aM,{...n,ref:e,forceMount:t}):s.type==="auto"?w.jsx(y1,{...n,ref:e,forceMount:t}):s.type==="always"?w.jsx(Bf,{...n,ref:e}):null});ru.displayName=Bn;var oM=m.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=un(Bn,r.__scopeScrollArea),[i,a]=m.useState(!1);return m.useEffect(()=>{const c=s.scrollArea;let u=0;if(c){const h=()=>{window.clearTimeout(u),a(!0)},d=()=>{u=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",d),()=>{window.clearTimeout(u),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),w.jsx(bo,{present:t||i,children:w.jsx(y1,{"data-state":i?"visible":"hidden",...n,ref:e})})}),aM=m.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=un(Bn,r.__scopeScrollArea),i=r.orientation==="horizontal",a=su(()=>u("SCROLL_END"),100),[c,u]=sM("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return m.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>u("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,s.scrollHideDelay,u]),m.useEffect(()=>{const h=s.viewport,d=i?"scrollLeft":"scrollTop";if(h){let p=h[d];const g=()=>{const v=h[d];p!==v&&(u("SCROLL"),a()),p=v};return h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[s.viewport,i,u,a]),w.jsx(bo,{present:t||c!=="hidden",children:w.jsx(Bf,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:At(r.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:At(r.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),y1=m.forwardRef((r,e)=>{const t=un(Bn,r.__scopeScrollArea),{forceMount:n,...s}=r,[i,a]=m.useState(!1),c=r.orientation==="horizontal",u=su(()=>{if(t.viewport){const h=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;a(c?h:d)}},10);return ho(t.viewport,u),ho(t.content,u),w.jsx(bo,{present:n||i,children:w.jsx(Bf,{"data-state":i?"visible":"hidden",...s,ref:e})})}),Bf=m.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,s=un(Bn,r.__scopeScrollArea),i=m.useRef(null),a=m.useRef(0),[c,u]=m.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=x1(c.viewport,c.content),d={...n,sizes:c,onSizesChange:u,hasThumb:h>0&&h<1,onThumbChange:g=>i.current=g,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:g=>a.current=g};function p(g,v){return fM(g,a.current,c,v)}return t==="horizontal"?w.jsx(cM,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const g=s.viewport.scrollLeft,v=qv(g,c,s.dir);i.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollLeft=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollLeft=p(g,s.dir))}}):t==="vertical"?w.jsx(lM,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const g=s.viewport.scrollTop,v=qv(g,c);i.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollTop=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollTop=p(g))}}):null}),cM=m.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...s}=r,i=un(Bn,r.__scopeScrollArea),[a,c]=m.useState(),u=m.useRef(null),h=_r(e,u,i.onScrollbarXChange);return m.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),w.jsx(w1,{"data-orientation":"horizontal",...s,ref:h,sizes:t,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":nu(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.x),onDragScroll:d=>r.onDragScroll(d.x),onWheelScroll:(d,p)=>{if(i.viewport){const g=i.viewport.scrollLeft+d.deltaX;r.onWheelScroll(g),C1(g,p)&&d.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:kl(a.paddingLeft),paddingEnd:kl(a.paddingRight)}})}})}),lM=m.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...s}=r,i=un(Bn,r.__scopeScrollArea),[a,c]=m.useState(),u=m.useRef(null),h=_r(e,u,i.onScrollbarYChange);return m.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),w.jsx(w1,{"data-orientation":"vertical",...s,ref:h,sizes:t,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":nu(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.y),onDragScroll:d=>r.onDragScroll(d.y),onWheelScroll:(d,p)=>{if(i.viewport){const g=i.viewport.scrollTop+d.deltaY;r.onWheelScroll(g),C1(g,p)&&d.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:kl(a.paddingTop),paddingEnd:kl(a.paddingBottom)}})}})}),[uM,b1]=p1(Bn),w1=m.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:h,onWheelScroll:d,onResize:p,...g}=r,v=un(Bn,t),[b,x]=m.useState(null),C=_r(e,X=>x(X)),T=m.useRef(null),k=m.useRef(""),A=v.viewport,I=n.content-n.viewport,D=Mn(d),F=Mn(u),U=su(p,10);function B(X){if(T.current){const Y=X.clientX-T.current.left,Z=X.clientY-T.current.top;h({x:Y,y:Z})}}return m.useEffect(()=>{const X=Y=>{const Z=Y.target;b?.contains(Z)&&D(Y,I)};return document.addEventListener("wheel",X,{passive:!1}),()=>document.removeEventListener("wheel",X,{passive:!1})},[A,b,I,D]),m.useEffect(F,[n,F]),ho(b,U),ho(v.content,U),w.jsx(uM,{scope:t,scrollbar:b,hasThumb:s,onThumbChange:Mn(i),onThumbPointerUp:Mn(a),onThumbPositionChange:F,onThumbPointerDown:Mn(c),children:w.jsx(Cr.div,{...g,ref:C,style:{position:"absolute",...g.style},onPointerDown:At(r.onPointerDown,X=>{X.button===0&&(X.target.setPointerCapture(X.pointerId),T.current=b.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),B(X))}),onPointerMove:At(r.onPointerMove,B),onPointerUp:At(r.onPointerUp,X=>{const Y=X.target;Y.hasPointerCapture(X.pointerId)&&Y.releasePointerCapture(X.pointerId),document.body.style.webkitUserSelect=k.current,v.viewport&&(v.viewport.style.scrollBehavior=""),T.current=null})})})}),El="ScrollAreaThumb",Vf=m.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=b1(El,r.__scopeScrollArea);return w.jsx(bo,{present:t||s.hasThumb,children:w.jsx(hM,{ref:e,...n})})}),hM=m.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...s}=r,i=un(El,t),a=b1(El,t),{onThumbPositionChange:c}=a,u=_r(e,p=>a.onThumbChange(p)),h=m.useRef(void 0),d=su(()=>{h.current&&(h.current(),h.current=void 0)},100);return m.useEffect(()=>{const p=i.viewport;if(p){const g=()=>{if(d(),!h.current){const v=pM(p,c);h.current=v,c()}};return c(),p.addEventListener("scroll",g),()=>p.removeEventListener("scroll",g)}},[i.viewport,d,c]),w.jsx(Cr.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:At(r.onPointerDownCapture,p=>{const v=p.target.getBoundingClientRect(),b=p.clientX-v.left,x=p.clientY-v.top;a.onThumbPointerDown({x:b,y:x})}),onPointerUp:At(r.onPointerUp,a.onThumbPointerUp)})});Vf.displayName=El;var Hf="ScrollAreaCorner",_1=m.forwardRef((r,e)=>{const t=un(Hf,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?w.jsx(dM,{...r,ref:e}):null});_1.displayName=Hf;var dM=m.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,s=un(Hf,t),[i,a]=m.useState(0),[c,u]=m.useState(0),h=!!(i&&c);return ho(s.scrollbarX,()=>{const d=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(d),u(d)}),ho(s.scrollbarY,()=>{const d=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(d),a(d)}),h?w.jsx(Cr.div,{...n,ref:e,style:{width:i,height:c,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function kl(r){return r?parseInt(r,10):0}function x1(r,e){const t=r/e;return isNaN(t)?0:t}function nu(r){const e=x1(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function fM(r,e,t,n="ltr"){const s=nu(t),i=s/2,a=e||i,c=s-a,u=t.scrollbar.paddingStart+a,h=t.scrollbar.size-t.scrollbar.paddingEnd-c,d=t.content-t.viewport,p=n==="ltr"?[0,d]:[d*-1,0];return S1([u,h],p)(r)}function qv(r,e,t="ltr"){const n=nu(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,a=e.content-e.viewport,c=i-n,u=t==="ltr"?[0,a]:[a*-1,0],h=jf(r,u);return S1([0,a],[0,c])(h)}function S1(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function C1(r,e){return r>0&&r<e}var pM=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function s(){const i={left:r.scrollLeft,top:r.scrollTop},a=t.left!==i.left,c=t.top!==i.top;(a||c)&&e(),t=i,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function su(r,e){const t=Mn(r),n=m.useRef(0);return m.useEffect(()=>()=>window.clearTimeout(n.current),[]),m.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function ho(r,e){const t=Mn(e);ka(()=>{let n=0;if(r){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return s.observe(r),()=>{window.cancelAnimationFrame(n),s.unobserve(r)}}},[r,t])}var Ol=g1,Bd=v1,Kv=ru,Zv=Vf,gM=_1;const Ci=m.forwardRef(({className:r,children:e,...t},n)=>w.jsxs(Ol,{ref:n,className:Fs("relative overflow-hidden",r),...t,children:[w.jsx(Bd,{className:"h-full w-full rounded-[inherit]",children:e}),w.jsx(zf,{}),w.jsx(gM,{})]}));Ci.displayName=Ol.displayName;const zf=m.forwardRef(({className:r,orientation:e="vertical",...t},n)=>w.jsx(ru,{ref:n,orientation:e,className:Fs("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:w.jsx(Vf,{className:"relative flex-1 rounded-full bg-border"})}));zf.displayName=ru.displayName;const $a=({children:r,renderCustomPreview:e,data:t={},shouldDisplayPreview:n=!0})=>{const[s,i]=m.useState(!1),[a,c]=m.useState({x:0,y:0}),u=m.useRef(null),h=v=>{i(!0),v.dataTransfer.setDragImage(new Image,0,0),v.dataTransfer.setData(JSON.stringify(t),JSON.stringify(t)),c({x:v.clientX,y:v.clientY})},d=()=>{i(!1)},p=v=>{s&&c({x:v.clientX,y:v.clientY})},g=m.cloneElement(r,{draggable:!0,onDragStart:h,onDragEnd:d,onDrag:p,style:{...r.props.style}});return w.jsxs(w.Fragment,{children:[g,s&&n&&e?jd.createPortal(w.jsx("div",{ref:u,style:{position:"fixed",left:a.x,top:a.y,pointerEvents:"none",zIndex:9999,transform:"translate(-50%, -50%)"},children:e}),document.body):null]})};var mM=zA.useId||(()=>{}),vM=0;function T1(r){const[e,t]=m.useState(mM());return ka(()=>{t(n=>n??String(vM++))},[r]),e?`radix-${e}`:""}var ed="rovingFocusGroup.onEntryFocus",yM={bubbles:!1,cancelable:!0},iu="RovingFocusGroup",[Vd,E1,bM]=Jy(iu),[wM,k1]=Ua(iu,[bM]),[_M,xM]=wM(iu),O1=m.forwardRef((r,e)=>w.jsx(Vd.Provider,{scope:r.__scopeRovingFocusGroup,children:w.jsx(Vd.Slot,{scope:r.__scopeRovingFocusGroup,children:w.jsx(SM,{...r,ref:e})})}));O1.displayName=iu;var SM=m.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:h,preventScrollOnEntryFocus:d=!1,...p}=r,g=m.useRef(null),v=_r(e,g),b=eu(i),[x=null,C]=Lf({prop:a,defaultProp:c,onChange:u}),[T,k]=m.useState(!1),A=Mn(h),I=E1(t),D=m.useRef(!1),[F,U]=m.useState(0);return m.useEffect(()=>{const B=g.current;if(B)return B.addEventListener(ed,A),()=>B.removeEventListener(ed,A)},[A]),w.jsx(_M,{scope:t,orientation:n,dir:b,loop:s,currentTabStopId:x,onItemFocus:m.useCallback(B=>C(B),[C]),onItemShiftTab:m.useCallback(()=>k(!0),[]),onFocusableItemAdd:m.useCallback(()=>U(B=>B+1),[]),onFocusableItemRemove:m.useCallback(()=>U(B=>B-1),[]),children:w.jsx(Cr.div,{tabIndex:T||F===0?-1:0,"data-orientation":n,...p,ref:v,style:{outline:"none",...r.style},onMouseDown:At(r.onMouseDown,()=>{D.current=!0}),onFocus:At(r.onFocus,B=>{const X=!D.current;if(B.target===B.currentTarget&&X&&!T){const Y=new CustomEvent(ed,yM);if(B.currentTarget.dispatchEvent(Y),!Y.defaultPrevented){const Z=I().filter(Q=>Q.focusable),G=Z.find(Q=>Q.active),K=Z.find(Q=>Q.id===x),ve=[G,K,...Z].filter(Boolean).map(Q=>Q.ref.current);M1(ve,d)}}D.current=!1}),onBlur:At(r.onBlur,()=>k(!1))})})}),A1="RovingFocusGroupItem",I1=m.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,...a}=r,c=T1(),u=i||c,h=xM(A1,t),d=h.currentTabStopId===u,p=E1(t),{onFocusableItemAdd:g,onFocusableItemRemove:v}=h;return m.useEffect(()=>{if(n)return g(),()=>v()},[n,g,v]),w.jsx(Vd.ItemSlot,{scope:t,id:u,focusable:n,active:s,children:w.jsx(Cr.span,{tabIndex:d?0:-1,"data-orientation":h.orientation,...a,ref:e,onMouseDown:At(r.onMouseDown,b=>{n?h.onItemFocus(u):b.preventDefault()}),onFocus:At(r.onFocus,()=>h.onItemFocus(u)),onKeyDown:At(r.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){h.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const x=EM(b,h.orientation,h.dir);if(x!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let T=p().filter(k=>k.focusable).map(k=>k.ref.current);if(x==="last")T.reverse();else if(x==="prev"||x==="next"){x==="prev"&&T.reverse();const k=T.indexOf(b.currentTarget);T=h.loop?kM(T,k+1):T.slice(k+1)}setTimeout(()=>M1(T))}})})})});I1.displayName=A1;var CM={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function TM(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function EM(r,e,t){const n=TM(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return CM[n]}function M1(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function kM(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var OM=O1,AM=I1,Wf="Tabs",[IM,sN]=Ua(Wf,[k1]),P1=k1(),[MM,Uf]=IM(Wf),D1=m.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:c,activationMode:u="automatic",...h}=r,d=eu(c),[p,g]=Lf({prop:n,onChange:s,defaultProp:i});return w.jsx(MM,{scope:t,baseId:T1(),value:p,onValueChange:g,orientation:a,dir:d,activationMode:u,children:w.jsx(Cr.div,{dir:d,"data-orientation":a,...h,ref:e})})});D1.displayName=Wf;var R1="TabsList",j1=m.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=Uf(R1,t),a=P1(t);return w.jsx(OM,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:n,children:w.jsx(Cr.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});j1.displayName=R1;var L1="TabsTrigger",F1=m.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,a=Uf(L1,t),c=P1(t),u=V1(a.baseId,n),h=H1(a.baseId,n),d=n===a.value;return w.jsx(AM,{asChild:!0,...c,focusable:!s,active:d,children:w.jsx(Cr.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":h,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u,...i,ref:e,onMouseDown:At(r.onMouseDown,p=>{!s&&p.button===0&&p.ctrlKey===!1?a.onValueChange(n):p.preventDefault()}),onKeyDown:At(r.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&a.onValueChange(n)}),onFocus:At(r.onFocus,()=>{const p=a.activationMode!=="manual";!d&&!s&&p&&a.onValueChange(n)})})})});F1.displayName=L1;var N1="TabsContent",B1=m.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...a}=r,c=Uf(N1,t),u=V1(c.baseId,n),h=H1(c.baseId,n),d=n===c.value,p=m.useRef(d);return m.useEffect(()=>{const g=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(g)},[]),w.jsx(bo,{present:s||d,children:({present:g})=>w.jsx(Cr.div,{"data-state":d?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!g,id:h,tabIndex:0,...a,ref:e,style:{...r.style,animationDuration:p.current?"0s":void 0},children:g&&i})})});B1.displayName=N1;function V1(r,e){return`${r}-trigger-${e}`}function H1(r,e){return`${r}-content-${e}`}var PM=D1,z1=j1,W1=F1,U1=B1;const $1=PM,$f=m.forwardRef(({className:r,...e},t)=>w.jsx(z1,{ref:t,className:Fs("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));$f.displayName=z1.displayName;const Al=m.forwardRef(({className:r,...e},t)=>w.jsx(W1,{ref:t,className:Fs("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...e}));Al.displayName=W1.displayName;const Il=m.forwardRef(({className:r,...e},t)=>w.jsx(U1,{ref:t,className:Fs("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));Il.displayName=U1.displayName;const DM="add",RM="track",jM="trackItems",LM="track:changed",FM="trackItems:changed",NM="state",BM="state:changed",Y1="add",Yf="add:text",wo="add:video",_o="add:audio",VM="add:placeholder",xo="add:image",HM="add:mask",zM="add:transition",WM="add:animation",UM="edit",$M="edit:object",YM="edit:text",XM="edit:shape",GM="enterEditMode",qM="player",X1="player:play",G1="player:pause",KM="player:seek",ZM="player:seekTo",JM="player:seekBy",QM="player:togglePlay",q1="active",e5="active:set",Xf="active:delete",t5="active:paste",Gf="active:clone",qf="active:split",r5="layer",n5="layer:locked",s5="layer:hidden",i5="layer:move",o5="layer:select",K1="layer:selection",a5="layer:sendTo",c5="layer:rename",l5="layer:editingName",u5="layer:copy",h5="layer:paste",d5="layer:clone",f5="layer:split",p5="layer:cut",g5="layer:delete",Z1="history",Kf="history:undo",Zf="history:redo",m5="history:reset",J1="scale",Jf="scale:changed",Q1="drag",Qf="drag:start",Oa="drag:end",eb="timeline",ep="timeline:boundingChanged";var Hd=function(r,e){return Hd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},Hd(r,e)};function So(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Hd(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function zd(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wd(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return i}function Ud(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function Ln(r){return typeof r=="function"}function tb(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var td=tb(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,s){return s+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function $d(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var ou=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=zd(a),u=c.next();!u.done;u=c.next()){var h=u.value;h.remove(this)}}catch(x){e={error:x}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(Ln(d))try{d()}catch(x){i=x instanceof td?x.errors:[x]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var g=zd(p),v=g.next();!v.done;v=g.next()){var b=v.value;try{Jv(b)}catch(x){i=i??[],x instanceof td?i=Ud(Ud([],Wd(i)),Wd(x.errors)):i.push(x)}}}catch(x){n={error:x}}finally{try{v&&!v.done&&(s=g.return)&&s.call(g)}finally{if(n)throw n.error}}}if(i)throw new td(i)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Jv(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&$d(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&$d(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),rb=ou.EMPTY;function nb(r){return r instanceof ou||r&&"closed"in r&&Ln(r.remove)&&Ln(r.add)&&Ln(r.unsubscribe)}function Jv(r){Ln(r)?r():r.unsubscribe()}var v5={Promise:void 0},y5={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,Ud([r,e],Wd(t)))},clearTimeout:function(r){return clearTimeout(r)},delegate:void 0};function b5(r){y5.setTimeout(function(){throw r})}function Qv(){}function _l(r){r()}var tp=function(r){So(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,nb(t)&&t.add(n)):n.destination=x5,n}return e.create=function(t,n,s){return new Yd(t,n,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ou),w5=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){Xc(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){Xc(n)}else Xc(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Xc(t)}},r}(),Yd=function(r){So(e,r);function e(t,n,s){var i=r.call(this)||this,a;return Ln(t)||!t?a={next:t??void 0,error:n??void 0,complete:s??void 0}:a=t,i.destination=new w5(a),i}return e}(tp);function Xc(r){b5(r)}function _5(r){throw r}var x5={closed:!0,next:Qv,error:_5,complete:Qv},S5=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function C5(r){return r}function T5(r){return r.length===0?C5:r.length===1?r[0]:function(t){return r.reduce(function(n,s){return s(n)},t)}}var e0=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var s=this,i=k5(e)?e:new Yd(e,t,n);return _l(function(){var a=s,c=a.operator,u=a.source;i.add(c?c.call(i,u):u?s._subscribe(i):s._trySubscribe(i))}),i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=t0(t),new t(function(s,i){var a=new Yd({next:function(c){try{e(c)}catch(u){i(u),a.unsubscribe()}},error:i,complete:s});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[S5]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T5(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=t0(e),new e(function(n,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return n(i)})})},r.create=function(e){return new r(e)},r}();function t0(r){var e;return(e=r??v5.Promise)!==null&&e!==void 0?e:Promise}function E5(r){return r&&Ln(r.next)&&Ln(r.error)&&Ln(r.complete)}function k5(r){return r&&r instanceof tp||E5(r)&&nb(r)}function O5(r){return Ln(r?.lift)}function A5(r){return function(e){if(O5(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function I5(r,e,t,n,s){return new M5(r,e,t,n,s)}var M5=function(r){So(e,r);function e(t,n,s,i,a,c){var u=r.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=c,u._next=n?function(h){try{n(h)}catch(d){t.error(d)}}:r.prototype._next,u._error=i?function(h){try{i(h)}catch(d){t.error(d)}finally{this.unsubscribe()}}:r.prototype._error,u._complete=s?function(){try{s()}catch(h){t.error(h)}finally{this.unsubscribe()}}:r.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(tp),P5=tb(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),rp=function(r){So(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new r0(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new P5},e.prototype.next=function(t){var n=this;_l(function(){var s,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=zd(n.currentObservers),c=a.next();!c.done;c=a.next()){var u=c.value;u.next(t)}}catch(h){s={error:h}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var n=this;_l(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var s=n.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;_l(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,s=this,i=s.hasError,a=s.isStopped,c=s.observers;return i||a?rb:(this.currentObservers=null,c.push(t),new ou(function(){n.currentObservers=null,$d(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,s=n.hasError,i=n.thrownError,a=n.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new e0;return t.source=this,t},e.create=function(t,n){return new r0(t,n)},e}(e0),r0=function(r){So(e,r);function e(t,n){var s=r.call(this)||this;return s.destination=t,s.source=n,s}return e.prototype.next=function(t){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.next)===null||s===void 0||s.call(n,t)},e.prototype.error=function(t){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.error)===null||s===void 0||s.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,s;return(s=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&s!==void 0?s:rb},e}(rp),n0=function(r){So(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,s=t.thrownError,i=t._value;if(n)throw s;return this._throwIfClosed(),i},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e}(rp);function li(r,e){return A5(function(t,n){var s=0;t.subscribe(I5(n,function(i){return r.call(e,i,s++)&&n.next(i)}))})}const sb=new rp,D5=(r,e)=>{sb.next({key:r,value:e})},Ze={subject:sb,dispatch:D5},rr=[];for(let r=0;r<256;++r)rr.push((r+256).toString(16).slice(1));function R5(r,e=0){return(rr[r[e+0]]+rr[r[e+1]]+rr[r[e+2]]+rr[r[e+3]]+"-"+rr[r[e+4]]+rr[r[e+5]]+"-"+rr[r[e+6]]+rr[r[e+7]]+"-"+rr[r[e+8]]+rr[r[e+9]]+"-"+rr[r[e+10]]+rr[r[e+11]]+rr[r[e+12]]+rr[r[e+13]]+rr[r[e+14]]+rr[r[e+15]]).toLowerCase()}let rd;const j5=new Uint8Array(16);function L5(){if(!rd){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");rd=crypto.getRandomValues.bind(crypto)}return rd(j5)}const F5=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),s0={randomUUID:F5};function Yt(r,e,t){if(s0.randomUUID&&!r)return s0.randomUUID();r=r||{};const n=r.random??r.rng?.()??L5();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,R5(n)}var ib=(r=>(r.IMAGE="image",r.VIDEO="video",r.AUDIO="audio",r))(ib||{});const N5=r=>{const[e,t]=m.useState(!1),[n,s]=m.useState(!1),i=m.useCallback(d=>{const p={...d,id:Yt()};switch(d.type){case"image":Ze.dispatch(xo,{payload:p});break;case"video":Ze.dispatch(wo,{payload:p});break;case"audio":Ze.dispatch(_o,{payload:p});break}},[]),a=m.useCallback(d=>{d.preventDefault();try{const p=d.dataTransfer?.types[0],g=JSON.parse(p);if(!Object.values(ib).includes(g.type))return;s(!0),t(!0),r?.(!0)}catch(p){console.error("Error parsing dragged data:",p)}},[r]),c=m.useCallback(d=>{d.preventDefault(),e&&(s(!0),r?.(!0))},[e,r]),u=m.useCallback(d=>{if(n){d.preventDefault(),s(!1),r?.(!1);try{const p=d.dataTransfer?.types[0],g=JSON.parse(d.dataTransfer.getData(p));i(g)}catch(p){console.error("Error parsing dropped data:",p)}}},[n,r,i]),h=m.useCallback(d=>{d.preventDefault(),d.currentTarget.contains(d.relatedTarget)||(s(!1),t(!1),r?.(!1))},[r]);return{onDragEnter:a,onDragOver:c,onDrop:u,onDragLeave:h,isDraggingOver:n}},ob=({children:r,className:e,style:t,onDragStateChange:n,id:s})=>{const{onDragEnter:i,onDragOver:a,onDrop:c,onDragLeave:u}=N5(n);return w.jsx("div",{id:s,onDragEnter:i,onDrop:c,onDragOver:a,onDragLeave:u,className:e,style:t,role:"region","aria-label":"Droppable area for images, videos, and audio",children:r})},B5=({size:r,children:e})=>{const[t,n]=m.useState(!1);return w.jsxs(ob,{id:"artboard",onDragStateChange:n,style:{width:r.width,height:r.height},className:"designcombo_scene pointer-events-auto mt-3.5 bg-black",children:[w.jsx("div",{style:{width:r.width,height:r.height},className:`pointer-events-none absolute z-50 mt-3.5 transition-colors duration-200 ease-in-out ${t?"border-4 border-dashed border-white bg-white/[0.075]":"bg-transparent"} shadow-[0_0_0_5000px_#1D1D1F]`}),e]})},V5=100,H5=30,z5=18,W5=14,U5=30,$5=24,Y5=16,ab=12,X5="Regular",cb="sans-serif",Ya=188,Ml=40,G5=4e3,lb=1920,ub=1080,hb=60,db=1e3/hb,q5=2e6,K5=1e7,Z5=48e3,J5=192e3,np=2.3,Q5=lb/np,eP=ub/np,tP=184,rP=348,nP=512,sP=300,iP=0,oP=5e3,aP=1,cP=0,lP=0,uP=0,hP=359,dP=1,fP=0,pP=!1,gP=!1,mP=0,vP=2,yP=.01,bP=1,wP=0,_P=3,xP=.01,SP=1,CP=0,TP=1,EP=.01,kP=.5,OP=-1e3,AP=1e3,IP=1,MP=1,PP=0,DP=1,RP=.01,jP=1,LP=0,FP=1,NP=.01,BP=0,VP=.5,HP=10,zP=.01,WP=1,UP=0,$P=1,YP=.01,XP=1,au=16,Xd=80;function fb(r){if(!r)return"0";const e=r/Ya,t=Math.trunc(e)%60,n=Math.trunc(e/60)%60,s=Math.trunc(e/3600)%60,a=[Math.trunc(e/216e3).toString(),s.toString(),n.toString(),t.toString()];return e<60?`${a[3].padStart(2,"0")}f`:e<3600?`${a[2].padStart(1,"0")}s`:e<216e3?`${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`:`${a[0].padStart(2,"0")}:${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`}function GP(r,e=!1){if(!r)return"00:00";const n=1e3/60;if(r<1e3)return e?`${Math.floor(r/n)}f`:`${(r/1e3).toFixed(1)}s`;const s=Math.floor(r/1e3);if(s<60)return`${s}s`;const i=Math.floor(s/60);if(i<60){const h=s%60;return`${i.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}const a=Math.floor(i/60),c=i%60,u=s%60;return`${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}function Aa(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}const pb=({frame:r},{fps:e})=>{const t=r/e,n=Math.floor(t/3600),s=t%3600,i=Math.floor(s/60),a=Math.floor(s%60),c=Math.floor((s-Math.floor(s))*100);return n>0?`${n}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`:`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},gb=({time:r})=>{const e=r/1e3,t=Math.floor(e/3600),n=e%3600,s=Math.floor(n/60),i=Math.floor(n%60),a=Math.floor((n-Math.floor(n))*100);return t>0?`${t}:${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},mb=()=>{const r=document.getElementById("video-current-time");return(r?parseFloat(r.getAttribute("data-current-time")??""):0)*1e3},wn=[{index:0,unit:18e3,zoom:1/18e3,segments:5},{index:1,unit:10800,zoom:1/10800,segments:3},{index:2,unit:7200,zoom:1/7200,segments:2},{index:3,unit:3600,zoom:1/3600,segments:1},{index:4,unit:1800,zoom:1/1800,segments:2},{index:5,unit:900,zoom:1/900,segments:3},{index:6,unit:600,zoom:1/600,segments:2},{index:7,unit:300,zoom:1/300,segments:5},{index:8,unit:180,zoom:1/180,segments:3},{index:9,unit:120,zoom:1/120,segments:10},{index:10,unit:60,zoom:1/60,segments:5},{index:11,unit:60,zoom:1/60,segments:5},{index:12,unit:30,zoom:1/30,segments:2},{index:13,unit:15,zoom:1/15,segments:3},{index:14,unit:10,zoom:1/10,segments:2},{index:15,unit:5,zoom:1/5,segments:5},{index:16,unit:3,zoom:1/3,segments:3},{index:17,unit:2,zoom:1/2,segments:5},{index:18,unit:1,zoom:1,segments:5},{index:19,unit:1,zoom:2,segments:5},{index:20,unit:1,zoom:4,segments:10}];function sp(r,e){let t=-1,n=r.length-1;for(;1+t<n;){const s=t+(n-t>>1);e(r[s],s,r)?n=s:t=s}return n}function qP(r,e=1){const t=()=>{const u=Math.max(0,Ml),d=document.getElementById("designcombo-timeline-canvas")?.offsetWidth??document.body.offsetWidth;return Math.max(1,d-u)},n=()=>typeof r=="number"?Lt(r,e):xb(r,e),s=t()/n(),i=e*s;return{segments:5,index:sp(wn,c=>c.zoom>i),zoom:i,unit:1/i}}function KP(r){return wn[r]}function vb(r){return yb(r)||wn[0]}const yb=r=>{const e=wn.filter(n=>n.zoom<r.zoom);return e.length===0?null:e.reduce((n,s)=>s.zoom>n.zoom?s:n)},bb=r=>{const e=wn.filter(n=>n.zoom>r.zoom);return e.length===0?null:e.reduce((n,s)=>s.zoom<n.zoom?s:n)};function wb(r){return bb(r)||wn[wn.length-1]}function ZP(r){const e=wn.at(-1),t=r===e,s=_b(r)-(t?1:2);return Math.max(0,s)}function _b(r){const e=sp(wn,t=>t.zoom>r.zoom);return Math.min(wn.length-1,e)}function Lt(r,e=1,t=1){const n=Ya*e;return r*(60/1e3)*n/t}function ks(r,e=1){const t=Ya*e;return r/t*db}function xb(r,e=1){return Lt(r,e)}const JP=Math.floor(Math.random()*1e3)+1;function ip(r,e=1){const t=[],n=Math.floor(e),s=(i,a)=>{for(const c of i)Array.isArray(c)&&a<n?s(c,a+1):t.push(c)};return s(r,0),t}function op(r,e){const t=e.sort((s,i)=>s.tempIndex-i.tempIndex),n=[];for(const s of t)s.tempIndex<0&&n.push(s);n.push(r);for(const s of t)s.tempIndex>=0&&n.push(s);return n}const Gd={id:"font_UwdNKSyVq2iiMiuHSRRsUIOu",family:"Roboto",fullName:"Roboto Bold",postScriptName:"Roboto-Bold",preview:"https://ik.imagekit.io/lh/fonts/v2/5zQgS86djScKA0ri67BBCqW7.png",style:"Roboto-Bold",url:"https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmWUlvAx05IsDqlA.ttf",category:"sans-serif",createdAt:"2023-06-20T04:42:55.909Z",updatedAt:"2023-06-20T04:42:55.909Z",userId:null},Sb=r=>{const e=r.map(t=>new FontFace(t.fontFamily,`url(${t.fontUrl})`).load());return e.length===0?Promise.resolve(!0):new Promise((t,n)=>{Promise.all(e).then(s=>{s.forEach(i=>{i instanceof FontFace&&i.family&&(document.fonts.add(i),t(!0))})}).catch(s=>{n(s)})})},i0=r=>{let e;const t=new Set,n=(h,d)=>{const p=typeof h=="function"?h(e):h;if(!Object.is(p,e)){const g=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(v=>v(e,g))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h))},u=e=r(n,s,c);return c},QP=r=>r?i0(r):i0,eD=r=>r;function tD(r,e=eD){const t=Me.useSyncExternalStore(r.subscribe,()=>e(r.getState()),()=>e(r.getInitialState()));return Me.useDebugValue(t),t}const o0=r=>{const e=QP(r),t=n=>tD(e,n);return Object.assign(t,e),t},Cb=r=>r?o0(r):o0,Os=Cb(r=>({timeline:null,size:{width:1080,height:1920},duration:5e3,fps:30,scale:{index:7,unit:300,zoom:1/300,segments:5},scroll:{left:0,top:0},playerRef:null,activeIds:[],targetIds:[],tracks:[],trackItemIds:[],transitionIds:[],transitionsMap:{},trackItemDetailsMap:{},trackItemsMap:{},setTimeline:e=>{r(()=>({timeline:e}))},setScale:e=>{r(()=>({scale:e}))},setScroll:e=>{r(()=>({scroll:e}))},setState:async e=>{r({...e})},setPlayerRef:e=>{r({playerRef:e})}}));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Tb=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=m.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...c},u)=>m.createElement("svg",{ref:u,...nD,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Tb("lucide",s),...c},[...a.map(([h,d])=>m.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=(r,e)=>{const t=m.forwardRef(({className:n,...s},i)=>m.createElement(sD,{ref:i,iconNode:e,className:Tb(`lucide-${rD(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=En("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=En("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=En("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=En("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=En("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=En("SquareSplitHorizontal",[["path",{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3",key:"lubmu8"}],["path",{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3",key:"1ag34g"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uD=En("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=En("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hD=En("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=En("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=En("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),cu=r=>{const e=m.useCallback(n=>{if(!r?.current)return()=>{};const s=()=>{n()};return r.current.addEventListener("frameupdate",s),()=>{r.current&&r.current.removeEventListener("frameupdate",s)}},[r]);return m.useSyncExternalStore(e,()=>r?.current?.getCurrentFrame()??0,()=>0)},Xa=()=>{const[r,e]=m.useState(!1);return m.useEffect(()=>{const n=Ze.subject.pipe(li(({key:s})=>s.startsWith(Q1))).subscribe(s=>{s.key===Qf?e(!0):s.key===Oa&&e(!1)});return()=>n.unsubscribe()},[]),r},Eb=()=>{const[r,e]=m.useState(!1),{duration:t,fps:n,scale:s,playerRef:i,activeIds:a}=Os(),c=cu(i),u=()=>{Ze.dispatch(Xf)},h=()=>{Ze.dispatch(qf,{payload:{},options:{time:mb()}})},d=v=>{Ze.dispatch(Jf,{payload:{scale:v}})},p=()=>{Ze.dispatch(X1)},g=()=>{Ze.dispatch(G1)};return m.useEffect(()=>(i?.current?.addEventListener("play",()=>{e(!0)}),i?.current?.addEventListener("pause",()=>{e(!1)}),()=>{i?.current?.removeEventListener("play",()=>{e(!0)}),i?.current?.removeEventListener("pause",()=>{e(!1)})}),[i]),w.jsx("div",{style:{position:"relative",height:"50px",boxShadow:"inset 0 1px 0 0 #27272a",flex:"none"},className:"bg-background",children:w.jsx("div",{style:{position:"absolute",height:50,width:"100%",display:"flex",alignItems:"center"},children:w.jsxs("div",{style:{height:36,width:"100%",display:"grid",gridTemplateColumns:"1fr 260px 1fr",alignItems:"center"},children:[w.jsxs("div",{className:"flex px-2",children:[w.jsxs(hr,{disabled:!a.length,onClick:u,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[w.jsx(uD,{size:14})," Delete"]}),w.jsxs(hr,{disabled:!a.length,onClick:h,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[w.jsx(a0,{size:15})," Split"]}),w.jsxs(hr,{disabled:!a.length,onClick:()=>{Ze.dispatch(Gf)},variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[w.jsx(a0,{size:15})," Clone"]})]}),w.jsxs("div",{className:"flex items-center justify-center",children:[w.jsxs("div",{children:[w.jsx(hr,{onClick:u,variant:"ghost",size:"icon",children:w.jsx(cD,{size:14})}),w.jsx(hr,{onClick:()=>{if(r)return g();p()},variant:"ghost",size:"icon",children:r?w.jsx(oD,{size:14}):w.jsx(aD,{size:14})}),w.jsx(hr,{onClick:h,variant:"ghost",size:"icon",children:w.jsx(lD,{size:14})})]}),w.jsxs("div",{className:"text-xs font-light",style:{display:"grid",alignItems:"center",gridTemplateColumns:"54px 4px 54px",paddingTop:"2px",justifyContent:"center"},children:[w.jsx("div",{className:"font-medium text-zinc-200",style:{display:"flex",justifyContent:"center"},"data-current-time":c/n,id:"video-current-time",children:pb({frame:c},{fps:n})}),w.jsx("span",{children:"/"}),w.jsx("div",{className:"text-muted-foreground",style:{display:"flex",justifyContent:"center"},children:gb({time:t})})]})]}),w.jsx(pD,{scale:s,onChangeTimelineScale:d,duration:t})]})})})},pD=({scale:r,onChangeTimelineScale:e,duration:t})=>{const n=()=>{const i=vb(r);e(i)},s=()=>{const i=wb(r);e(i)};return w.jsx("div",{className:"flex items-center justify-end",children:w.jsxs("div",{className:"flex border-l border-border pl-4 pr-2",children:[w.jsx(hr,{size:"icon",variant:"ghost",onClick:n,disabled:r.index===0,children:w.jsx(fD,{size:16})}),w.jsx(hr,{size:"icon",variant:"ghost",onClick:s,disabled:r.index===20,children:w.jsx(dD,{size:16})})]})})},kb=[{id:"1",details:{src:"https://cdn.designcombo.dev/audio/Dawn%20of%20change.mp3",text:"Voiceover"},name:"Dawn of change",type:"audio",metadata:{author:"Roman Senyk"},display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/audio/Hope.mp3"},name:"Hope",type:"audio",metadata:{author:"Hugo Dujardin"}},{id:"3",details:{src:"https://cdn.designcombo.dev/audio/Tenderness.mp3"},name:"Tenderness",type:"audio",metadata:{author:"Benjamin Tissot"}},{id:"4",details:{src:"https://cdn.designcombo.dev/audio/Piano%20Moment.mp3"},name:"Piano moment",type:"audio",metadata:{author:"Benjamin Tissot"}}],Ob=[{id:"1",details:{src:"https://ik.imagekit.io/wombo/images/img1.jpg"},preview:"https://ik.imagekit.io/wombo/images/img1.jpg?tr=w-190",type:"image"},{id:"2",details:{src:"https://ik.imagekit.io/wombo/images/img2.jpg"},preview:"https://ik.imagekit.io/wombo/images/img2.jpg?tr=w-190",type:"image"},{id:"3",details:{src:"https://ik.imagekit.io/wombo/images/img3.jpg"},preview:"https://ik.imagekit.io/wombo/images/img3.jpg?tr=w-190",type:"image"},{id:"4",details:{src:"https://ik.imagekit.io/wombo/images/img4.jpg"},preview:"https://ik.imagekit.io/wombo/images/img4.jpg?tr=w-190",type:"image"},{id:"5",details:{src:"https://ik.imagekit.io/wombo/images/img5.jpg"},preview:"https://ik.imagekit.io/wombo/images/img5.jpg?tr=w-190",type:"image"},,{id:"6",details:{src:"https://ik.imagekit.io/wombo/images/img6.jpg"},preview:"https://ik.imagekit.io/wombo/images/img6.jpg?tr=w-190",type:"image"},{id:"7",details:{src:"https://ik.imagekit.io/wombo/images/img7.jpg"},preview:"https://ik.imagekit.io/wombo/images/img7.jpg?tr=w-190",type:"image"}],Ab=[{id:"1",details:{src:"https://cdn.designcombo.dev/videos/demo-video-1.mp4",text:"Scene"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-1.png",duration:17e3,display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/videos/demo-video-2.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-2.png"},{id:"3",details:{src:"https://cdn.designcombo.dev/videos/demo-video-3.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-3.png",duration:2e4},{id:"4",details:{src:"https://cdn.designcombo.dev/videos/demo-video-4.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-4.png",duration:2e4},{id:"5",details:{src:"https://cdn.designcombo.dev/videos/demo-video-5.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-5.png",duration:23e3},{id:"6",details:{src:"https://cdn.designcombo.dev/videos/demo-video-6.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-6.png",duration:1e4},{id:"7",details:{src:"https://cdn.designcombo.dev/videos/demo-video-7.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-7.png",duration:12e3},{id:"8",details:{src:"https://cdn.designcombo.dev/videos/demo-video-8.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-8.png",duration:15e3},{id:"9",details:{src:"https://cdn.designcombo.dev/videos/demo-video-9.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-9.png",duration:15e3},{id:"10",details:{src:"https://cdn.designcombo.dev/videos/demo-video-10.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-10.png",duration:5e3},{id:"11",details:{src:"https://cdn.designcombo.dev/videos/demo-video-11.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-11.png",duration:5e3}],Ib=[{id:"1",kind:"none",duration:0,preview:"https://ik.imagekit.io/wombo/transitions-v2/transition-none.png",type:"transition"},{id:"2",kind:"fade",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/fade.webp",type:"transition"},{id:"3",kind:"slide",name:"slide up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-up.webp",type:"transition",direction:"from-bottom"},{id:"4",kind:"slide",name:"slide down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-down.webp",type:"transition",direction:"from-top"},{id:"5",kind:"slide",name:"slide left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-left.webp",type:"transition",direction:"from-right"},{id:"6",kind:"slide",name:"slide right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-right.webp",type:"transition",direction:"from-left"},{id:"7",kind:"wipe",name:"wipe up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-up.webp",type:"transition",direction:"from-bottom"},{id:"8",kind:"wipe",name:"wipe down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-down.webp",type:"transition",direction:"from-top"},{id:"9",kind:"wipe",name:"wipe left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-left.webp",type:"transition",direction:"from-right"},{id:"10",kind:"wipe",name:"wipe right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-right.webp",type:"transition",direction:"from-left"},{id:"11",kind:"flip",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/flip.webp",type:"transition"},{id:"12",kind:"clockWipe",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/clock-wipe.webp",type:"transition"},{id:"13",kind:"star",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/star.webp",type:"transition"},{id:"14",kind:"circle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/circle.webp",type:"transition"},{id:"15",kind:"rectangle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/rectangle.webp",type:"transition"}],gD=[{id:"1",src:"https://ik.imagekit.io/snapmotion/upload-video-1.mp4",type:"video"},{id:"2",src:"https://ik.imagekit.io/snapmotion/upload-video-2.mp4",type:"video"},{id:"3",src:"https://ik.imagekit.io/snapmotion/upload-video-3.mp4",type:"video"}],mD=()=>{const r=Xa();return w.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Transitions"}),w.jsx(Ci,{children:w.jsx("div",{className:"grid grid-cols-3 gap-2 px-4",children:Ib.map((e,t)=>w.jsx(vD,{transition:e,shouldDisplayPreview:!r},t))})})]})},vD=({transition:r,shouldDisplayPreview:e})=>{const t=Me.useMemo(()=>({backgroundImage:`url(${r.preview})`,backgroundSize:"cover",width:"70px",height:"70px"}),[r.preview]);return w.jsx($a,{data:r,renderCustomPreview:w.jsx("div",{style:t}),shouldDisplayPreview:e,children:w.jsxs("div",{children:[w.jsx("div",{children:w.jsx("div",{style:t,draggable:!1})}),w.jsx("div",{className:"flex h-6 items-center overflow-ellipsis text-nowrap text-[12px] capitalize text-muted-foreground",children:r.name||r.type})]})})},yD=()=>{const r=()=>{Ze.dispatch(Yf,{payload:{id:Yt(),display:{from:0,to:5e3},details:{text:"Heading and some body",fontSize:120,width:600,fontUrl:Gd.url,fontFamily:Gd.postScriptName,color:"#ffffff",wordWrap:"break-word",textAlign:"center",borderWidth:0,borderColor:"#000000",boxShadow:{color:"#ffffff",x:0,y:0,blur:0}}},options:{}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Text"}),w.jsx("div",{className:"flex flex-col gap-2 px-4",children:w.jsx(hr,{draggable:!1,onClick:r,variant:"secondary",className:"w-full",children:"Add text"})})]})},bD=()=>{const r=m.useRef(null),e=n=>{t(n)},t=async n=>{const s=n[0].type;s.includes("audio")&&Ze.dispatch(_o,{payload:{id:Yt(),details:{src:URL.createObjectURL(n[0]),volume:50}}}),s.includes("video")&&Ze.dispatch(wo,{payload:{id:Yt(),display:{from:2e3,to:7e3},details:{src:URL.createObjectURL(n[0]),name:n[0].name}}}),s.includes("image")&&Ze.dispatch(xo,{payload:{id:Yt(),details:{src:URL.createObjectURL(n[0])}}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Your media"}),w.jsx("input",{ref:r,id:"file-upload-handle",type:"file",accept:"audio/*,video/*,image/*",onChange:n=>e(Array.from(n.target.files||[])),className:"hidden"}),w.jsx("div",{className:"px-4 py-2",children:w.jsx("div",{children:w.jsxs($1,{defaultValue:"projects",className:"w-full",children:[w.jsxs($f,{className:"grid w-full grid-cols-2",children:[w.jsx(Al,{value:"projects",children:"Project"}),w.jsx(Al,{value:"workspace",children:"Workspace"})]}),w.jsxs(Il,{value:"projects",children:[w.jsxs(hr,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[w.jsx(c0,{size:16})," Upload"]}),w.jsx("div",{})]}),w.jsx(Il,{value:"workspace",children:w.jsxs(hr,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[w.jsx(c0,{size:16})," Upload"]})})]})})}),w.jsx(Ci,{children:w.jsx("div",{className:"masonry-sm px-4"})})]})},wD=()=>{const r=Xa(),e=t=>{Ze.dispatch(_o,{payload:t,options:{}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Audios"}),w.jsx(Ci,{children:w.jsx("div",{className:"flex flex-col px-2",children:kb.map((t,n)=>w.jsx(_D,{shouldDisplayPreview:!r,handleAddAudio:e,audio:t},n))})})]})},_D=({handleAddAudio:r,audio:e,shouldDisplayPreview:t})=>{const n=Me.useMemo(()=>({backgroundImage:"url(https://cdn.designcombo.dev/thumbnails/music-preview.png)",backgroundSize:"cover",width:"70px",height:"70px"}),[]);return w.jsx($a,{data:e,renderCustomPreview:w.jsx("div",{style:n}),shouldDisplayPreview:t,children:w.jsxs("div",{draggable:!1,onClick:()=>r(e),style:{display:"grid",gridTemplateColumns:"48px 1fr"},className:"flex cursor-pointer gap-4 px-2 py-1 text-sm hover:bg-zinc-800/70",children:[w.jsx("div",{className:"flex h-12 items-center justify-center bg-zinc-800",children:w.jsx(iD,{width:16})}),w.jsxs("div",{className:"flex flex-col justify-center",children:[w.jsx("div",{children:e.name}),w.jsx("div",{className:"text-zinc-400",children:e.metadata?.author})]})]})})},xD=()=>{const r=Xa(),e=t=>{Ze.dispatch(xo,{payload:t,options:{trackId:"main"}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Photos"}),w.jsx(Ci,{children:w.jsx("div",{className:"masonry-sm px-4",children:Ob.map((t,n)=>w.jsx(SD,{image:t,shouldDisplayPreview:!r,handleAddImage:e},n))})})]})},SD=({handleAddImage:r,image:e,shouldDisplayPreview:t})=>{const n=Me.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return w.jsx($a,{data:e,renderCustomPreview:w.jsx("div",{style:n}),shouldDisplayPreview:t,children:w.jsx("div",{onClick:()=>r({id:Yt(),details:{src:e.details.src}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:w.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},CD=()=>{const r=Xa(),e=t=>{Ze.dispatch(wo,{payload:t,options:{resourceId:"main"}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Videos"}),w.jsx(Ci,{children:w.jsx("div",{className:"masonry-sm px-4",children:Ab.map((t,n)=>w.jsx(TD,{video:t,shouldDisplayPreview:!r,handleAddVideo:e},n))})})]})},TD=({handleAddVideo:r,video:e,shouldDisplayPreview:t})=>{const n=Me.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return w.jsx($a,{data:e,renderCustomPreview:w.jsx("div",{style:n,className:"draggable"}),shouldDisplayPreview:t,children:w.jsx("div",{onClick:()=>r({...e,id:Yt(),details:{src:e.details.src,...e.details}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:w.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},ap=Cb(r=>({activeMenuItem:null,showMenuItem:!1,cropTarget:null,showControlItem:!1,showToolboxItem:!1,activeToolboxItem:null,setCropTarget:e=>r({cropTarget:e}),setActiveMenuItem:e=>r({activeMenuItem:e}),setShowMenuItem:e=>r({showMenuItem:e}),setShowControlItem:e=>r({showControlItem:e}),setShowToolboxItem:e=>r({showToolboxItem:e}),setActiveToolboxItem:e=>r({activeToolboxItem:e})})),ED=({children:r})=>{const{showMenuItem:e,setShowMenuItem:t}=ap(),n=()=>{t(!1)};return w.jsxs("div",{style:{left:e?"0":"-100%",transition:"left 0.25s ease-in-out",zIndex:200},className:"absolute top-1/2 mt-6 flex h-[calc(100%-32px-64px)] w-[340px] -translate-y-1/2 rounded-lg shadow-lg",children:[w.jsx("div",{className:"w-[74px]"}),w.jsxs("div",{className:"relative flex flex-1 bg-background/80 backdrop-blur-lg backdrop-filter",children:[w.jsx(hr,{variant:"ghost",className:"absolute right-2 top-2 h-8 w-8 text-muted-foreground",size:"icon",children:w.jsx(hD,{width:16,onClick:n})}),r]})]})},kD=()=>{const{activeMenuItem:r}=ap();return r==="transitions"?w.jsx(mD,{}):r==="texts"?w.jsx(yD,{}):r==="videos"?w.jsx(CD,{}):r==="audios"?w.jsx(wD,{}):r==="images"?w.jsx(xD,{}):r==="uploads"?w.jsx(bD,{}):null},OD=()=>w.jsx(ED,{children:w.jsx(kD,{})}),l0={redo:({...r})=>w.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:w.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2957 4.15721C13.9052 3.76669 13.9052 3.13352 14.2957 2.743C14.6862 2.35247 15.3194 2.35247 15.7099 2.743L20.953 7.98603C21.1387 8.16758 21.2539 8.42087 21.2539 8.70108C21.2539 8.70111 21.2539 8.70114 21.2539 8.70117C21.2539 8.70431 21.2539 8.70744 21.2539 8.71057C21.2518 8.93273 21.1773 9.13757 21.0528 9.30262C21.0249 9.33973 20.9942 9.37505 20.961 9.40828L15.7099 14.6593C15.3194 15.0499 14.6862 15.0499 14.2957 14.6593C13.9052 14.2688 13.9052 13.6357 14.2957 13.2451L17.8398 9.70108H9.22665C8.59943 9.70108 7.97836 9.82462 7.39888 10.0646C6.81941 10.3047 6.29289 10.6565 5.84938 11.1C5.40587 11.5435 5.05406 12.07 4.81403 12.6495C4.57401 13.229 4.45047 13.85 4.45047 14.4773C4.45047 15.1045 4.57401 15.7256 4.81403 16.305C5.05406 16.8845 5.40587 17.411 5.84938 17.8545C6.29289 18.298 6.81941 18.6498 7.39888 18.8899C7.97836 19.1299 8.59943 19.2534 9.22665 19.2534H12.9024C13.4547 19.2534 13.9024 19.7012 13.9024 20.2534C13.9024 20.8057 13.4547 21.2534 12.9024 21.2534H9.22665C8.33679 21.2534 7.45564 21.0782 6.63352 20.7376C5.81139 20.3971 5.06439 19.898 4.43517 19.2687C3.80594 18.6395 3.30681 17.8925 2.96627 17.0704C2.62574 16.2483 2.45047 15.3671 2.45047 14.4773C2.45047 13.5874 2.62574 12.7063 2.96627 11.8841C3.30681 11.062 3.80594 10.315 4.43517 9.68578C5.06439 9.05655 5.81139 8.55742 6.63352 8.21689C7.45564 7.87635 8.33679 7.70108 9.22665 7.70108H17.8396L14.2957 4.15721Z",fill:"currentColor"})}),undo:({...r})=>w.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:w.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.60387 4.30711C9.99439 3.91659 9.99439 3.28342 9.60387 2.8929C9.21334 2.50238 8.58018 2.50237 8.18965 2.8929L2.8925 8.19004C2.70497 8.37758 2.59961 8.63193 2.59961 8.89715C2.59961 9.16237 2.70497 9.41672 2.8925 9.60426L8.18965 14.9014C8.58018 15.2919 9.21334 15.2919 9.60387 14.9014C9.99439 14.5109 9.99439 13.8777 9.60387 13.4872L5.86478 9.7481H15.1044C15.7383 9.7481 16.366 9.87295 16.9516 10.1155C17.5372 10.3581 18.0693 10.7136 18.5176 11.1619C18.9658 11.6101 19.3213 12.1422 19.5639 12.7278C19.8065 13.3134 19.9313 13.9411 19.9313 14.575C19.9313 15.2088 19.8065 15.8365 19.5639 16.4221C19.3213 17.0077 18.9658 17.5398 18.5176 17.9881C18.0693 18.4363 17.5372 18.7918 16.9516 19.0344C16.366 19.277 15.7383 19.4018 15.1044 19.4018H11.3964C10.8442 19.4018 10.3964 19.8495 10.3964 20.4018C10.3964 20.9541 10.8442 21.4018 11.3964 21.4018H15.1044C16.001 21.4018 16.8887 21.2252 17.717 20.8822C18.5452 20.5391 19.2978 20.0362 19.9318 19.4023C20.5657 18.7683 21.0686 18.0158 21.4116 17.1875C21.7547 16.3592 21.9313 15.4715 21.9313 14.575C21.9313 13.6784 21.7547 12.7907 21.4116 11.9624C21.0686 11.1342 20.5657 10.3816 19.9318 9.74764C19.2978 9.11371 18.5452 8.61085 17.717 8.26777C16.8887 7.92469 16.001 7.7481 15.1044 7.7481H6.16287L9.60387 4.30711Z",fill:"currentColor"})})};function AD(){const r=()=>{Ze.dispatch(Kf)},e=()=>{Ze.dispatch(Zf)};return w.jsx("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr 320px"},className:"pointer-events-none absolute left-0 right-0 top-0 z-[205] flex h-[72px] items-center px-2",children:w.jsxs("div",{className:"pointer-events-auto flex h-14 items-center gap-2",children:[w.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-md bg-background"}),w.jsxs("div",{className:"flex h-12 items-center bg-background px-1.5",children:[w.jsx(hr,{onClick:r,className:"text-muted-foreground",variant:"ghost",size:"icon",children:w.jsx(l0.undo,{width:20})}),w.jsx(hr,{onClick:e,className:"text-muted-foreground",variant:"ghost",size:"icon",children:w.jsx(l0.redo,{width:20})})]})]})})}var ID=Object.defineProperty,Mb=(r,e)=>{for(var t in e)ID(r,t,{get:e[t],enumerable:!0,configurable:!0,set:n=>e[t]=()=>n})};if(typeof m.createContext!="function"){const r=['Remotion requires React.createContext, but it is "undefined".','If you are in a React Server Component, turn it into a client component by adding "use client" at the top of the file.',"","Before:",'  import {useCurrentFrame} from "remotion";',"","After:",'  "use client";','  import {useCurrentFrame} from "remotion";'];throw new Error(r.join(`
`))}function u0(){return["NOD","E_EN","V"].join("")}var h0=()=>["e","nv"].join(""),Bt=()=>{const r=typeof window<"u"&&window.remotion_isPlayer,e=typeof window<"u"&&typeof window.process<"u"&&typeof window.process.env<"u"&&(window.process[h0()][u0()]==="test"||window.process[h0()][u0()]==="production"&&typeof window<"u"&&typeof window.remotion_puppeteerTimeout<"u");return{isStudio:typeof window<"u"&&window.remotion_isStudio,isRendering:e,isPlayer:r}},MD=Me.createElement,Pb=[],Db=()=>{if(!Bt().isStudio)return;const r=new Proxy(MD,{apply(e,t,n){if(Pb.includes(n[0])){const[s,i,...a]=n,c={...i??{},stack:new Error().stack};return Reflect.apply(e,t,[s,c,...a])}return Reflect.apply(e,t,n)}});Me.createElement=r},Ga=r=>{Pb.push(r),Db()},Rb=m.createContext(!1),PD=({children:r})=>w.jsx(Rb.Provider,{value:!0,children:r}),cp=()=>m.useContext(Rb);function lu(r){return!!r}var Gc="4.0.229",DD=()=>{if(typeof globalThis>"u")return;const r=globalThis.remotion_imported||typeof window<"u"&&window.remotion_imported;if(r){if(r===Gc)return;throw new TypeError(` Multiple versions of Remotion detected: ${[Gc,typeof r=="string"?r:"an older version"].filter(lu).join(" and ")}. This will cause things to break in an unexpected way.
Check that all your Remotion packages are on the same version. If your dependencies depend on Remotion, make them peer dependencies. You can also run \`npx remotion versions\` from your terminal to see which versions are mismatching.`)}globalThis.remotion_imported=Gc,typeof window<"u"&&(window.remotion_imported=Gc)},RD=(r,e)=>{const{style:t,...n}=r,s=m.useMemo(()=>({position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",...t}),[t]);return w.jsx("div",{ref:e,style:s,...n})},ma=m.forwardRef(RD),fr=m.createContext(null),Co=Me.createContext({registerSequence:()=>{throw new Error("SequenceManagerContext not initialized")},unregisterSequence:()=>{throw new Error("SequenceManagerContext not initialized")},sequences:[]}),qa=Me.createContext({hidden:{},setHidden:()=>{throw new Error("SequenceVisibilityToggle not initialized")}}),jD=({children:r})=>{const[e,t]=m.useState([]),[n,s]=m.useState({}),i=m.useCallback(h=>{t(d=>[...d,h])},[]),a=m.useCallback(h=>{t(d=>d.filter(p=>p.id!==h))},[]),c=m.useMemo(()=>({registerSequence:i,sequences:e,unregisterSequence:a}),[i,e,a]),u=m.useMemo(()=>({hidden:n,setHidden:s}),[n]);return w.jsx(Co.Provider,{value:c,children:w.jsx(qa.Provider,{value:u,children:r})})},To=m.createContext({getNonce:()=>0,fastRefreshes:0}),lp=()=>{const r=m.useContext(To),[e,t]=m.useState(()=>r.getNonce()),n=m.useRef(r);return m.useEffect(()=>{n.current!==r&&(n.current=r,t(r.getNonce))},[r]),e},jb={};Mb(jb,{useTimelineSetFrame:()=>Gb,useTimelinePosition:()=>Ti,usePlayingState:()=>fp,persistCurrentFrame:()=>$b,getInitialFrameState:()=>Yb,getFrameForComposition:()=>Xb,TimelineContext:()=>_n,SetTimelineContext:()=>Eo});var Ns=m.createContext({compositions:[],registerComposition:()=>{},unregisterComposition:()=>{},registerFolder:()=>{},unregisterFolder:()=>{},setCurrentCompositionMetadata:()=>{},updateCompositionDefaultProps:()=>{},folders:[],currentCompositionMetadata:null,canvasContent:null,setCanvasContent:()=>{}}),uu=m.createContext({props:{},updateProps:()=>{throw new Error("Not implemented")},resetUnsaved:()=>{throw new Error("Not implemented")}}),Lb=Me.createRef(),Fb=({children:r})=>{const[e,t]=Me.useState({}),n=m.useCallback(({defaultProps:a,id:c,newProps:u})=>{t(h=>({...h,[c]:typeof u=="function"?u(h[c]??a):u}))},[]),s=m.useCallback(()=>{t({})},[]);m.useImperativeHandle(Lb,()=>({getProps:()=>e,setProps:t}),[e]);const i=m.useMemo(()=>({props:e,updateProps:n,resetUnsaved:s}),[e,s,n]);return w.jsx(uu.Provider,{value:i,children:r})},LD={"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";"},d0={},FD=r=>{d0[r]||(console.warn(r),d0[r]=!0)},ND=r=>{for(const e of Object.keys(LD))if(r.includes(e))return{containsHex:!0,hexCode:e};return{containsHex:!1}},qd=r=>r.startsWith("/")?qd(r.substring(1)):r,BD=r=>{if(typeof window<"u"&&window.remotion_staticBase){if(r.startsWith(window.remotion_staticBase))throw new Error(`The value "${r}" is already prefixed with the static base ${window.remotion_staticBase}. You don't need to call staticFile() on it.`);return`${window.remotion_staticBase}/${qd(r)}`}return`/${qd(r)}`},VD=r=>r.split("/").map(s=>encodeURIComponent(s)).join("/"),HD=r=>{if(r===null)throw new TypeError("null was passed to staticFile()");if(typeof r>"u")throw new TypeError("undefined was passed to staticFile()");if(r.startsWith("http://")||r.startsWith("https://"))throw new TypeError(`staticFile() does not support remote URLs - got "${r}". Instead, pass the URL without wrapping it in staticFile(). See: https://remotion.dev/docs/staticfile-remote-urls`);if(r.startsWith("..")||r.startsWith("./"))throw new TypeError(`staticFile() does not support relative paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("/Users")||r.startsWith("/home")||r.startsWith("/tmp")||r.startsWith("/etc")||r.startsWith("/opt")||r.startsWith("/var")||r.startsWith("C:")||r.startsWith("D:")||r.startsWith("E:"))throw new TypeError(`staticFile() does not support absolute paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("public/"))throw new TypeError(`Do not include the public/ prefix when using staticFile() - got "${r}". See: https://remotion.dev/docs/staticfile-relative-paths`);const e=ND(r);e.containsHex&&FD(`WARNING: You seem to pass an already encoded path (path contains ${e.hexCode}). Since Remotion 4.0, the encoding is done by staticFile() itself. You may want to remove a encodeURIComponent() wrapping.`);const t=VD(r),n=BD(t);return n.startsWith("/")?n:`/${n}`},Kd="remotion-date:",Zd="remotion-file:",zD=({data:r,indent:e,staticBase:t})=>{let n=!1,s=!1,i=!1,a=!1;try{return{serializedString:JSON.stringify(r,function(u,h){const d=this[u];return d instanceof Date?(n=!0,`${Kd}${d.toISOString()}`):d instanceof Map?(i=!0,h):d instanceof Set?(a=!0,h):typeof d=="string"&&t!==null&&d.startsWith(t)?(s=!0,`${Zd}${d.replace(t+"/","")}`):h},e),customDateUsed:n,customFileUsed:s,mapUsed:i,setUsed:a}}catch(c){throw new Error("Could not serialize the passed input props to JSON: "+c.message)}},Nb=r=>JSON.parse(r,(e,t)=>typeof t=="string"&&t.startsWith(Kd)?new Date(t.replace(Kd,"")):typeof t=="string"&&t.startsWith(Zd)?HD(t.replace(Zd,"")):t),ni=r=>Bt().isStudio?Nb(zD({data:r,indent:2,staticBase:window.remotion_staticBase}).serializedString):r,f0=!1,WD=()=>{f0||(f0=!0,console.warn("Called `getInputProps()` on the server. This function is not available server-side and has returned an empty object."),console.warn("To hide this warning, don't call this function on the server:"),console.warn("  typeof window === 'undefined' ? {} : getInputProps()"))},Bb=()=>{if(typeof window>"u")return WD(),{};if(Bt().isPlayer)throw new Error("You cannot call `getInputProps()` from a <Player>. Instead, the props are available as React props from component that you passed as `component` prop.");const r=window.remotion_inputProps;return r?Nb(r):{}},p0=["h264","h265","vp8","vp9","mp3","aac","wav","prores","h264-mkv","h264-ts","gif"];function UD(r,e){if(!(typeof r>"u")){if(typeof r!="string")throw new TypeError(`The "defaultCodec" prop ${e} must be a string, but you passed a value of type ${typeof r}.`);if(!p0.includes(r))throw new Error(`The "defaultCodec" prop ${e} must be one of ${p0.join(", ")}, but you passed ${r}.`)}}function Pl(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function up(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function Vb(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`)}var g0=({calculated:r,compositionId:e,compositionFps:t,compositionHeight:n,compositionWidth:s,compositionDurationInFrames:i})=>{const a=`calculated by calculateMetadata() for the composition "${e}"`,c=`of the "<Composition />" component with the id "${e}"`,u=r?.width??s??void 0;Pl(u,"width",r?.width?a:c);const h=r?.height??n??void 0;Pl(h,"height",r?.height?a:c);const d=r?.fps??t??null;Vb(d,r?.fps?a:c);const p=r?.durationInFrames??i??null;up(p,{allowFloats:!1,component:`of the "<Composition />" component with the id "${e}"`});const g=r?.defaultCodec;return UD(g,a),{width:u,height:h,fps:d,durationInFrames:p,defaultCodec:g}},Hb=({calculateMetadata:r,signal:e,defaultProps:t,originalProps:n,compositionId:s,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u})=>{const h=r?r({defaultProps:t,props:n,abortSignal:e,compositionId:s}):null;if(h!==null&&typeof h=="object"&&"then"in h)return h.then(p=>{const{height:g,width:v,durationInFrames:b,fps:x,defaultCodec:C}=g0({calculated:p,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:s});return{width:v,height:g,fps:x,durationInFrames:b,id:s,defaultProps:ni(t),props:ni(p.props??n),defaultCodec:C??null}});const d=g0({calculated:h,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:s});return h===null?{...d,id:s,defaultProps:ni(t??{}),props:ni(n),defaultCodec:null}:{...d,id:s,defaultProps:ni(t??{}),props:ni(h.props??n),defaultCodec:h.defaultCodec??null}},$D=r=>{try{return{type:"success",result:Hb(r)}}catch(e){return{type:"error",error:e}}},hu=m.createContext(null),zb=m.createRef(),Wb=r=>!!r.calculateMetadata,YD="remotion.propsUpdatedExternally",Ub=({children:r})=>{const[e,t]=m.useState(null),{compositions:n,canvasContent:s,currentCompositionMetadata:i}=m.useContext(Ns),{fastRefreshes:a}=m.useContext(To),c=m.useMemo(()=>n.find(B=>s&&s.type==="composition"&&s.compositionId===B.id),[s,n]),u=n.find(B=>B.id===e),{props:h}=m.useContext(uu),d=m.useMemo(()=>typeof window>"u"||Bt().isPlayer?{}:Bb()??{},[]),[p,g]=m.useState({}),v=m.useMemo(()=>c?h[c.id]??{}:{},[h,c]),b=m.useMemo(()=>u?h[u.id]??{}:{},[h,u]),x=!!i,C=m.useCallback(({calculateMetadata:B,combinedProps:X,compositionDurationInFrames:Y,compositionFps:Z,compositionHeight:G,compositionId:K,compositionWidth:oe,defaultProps:ve})=>{const Q=new AbortController;if(x)return Q;const{signal:ge}=Q,de=$D({compositionId:K,calculateMetadata:B,originalProps:X,signal:ge,defaultProps:ve,compositionDurationInFrames:Y,compositionFps:Z,compositionHeight:G,compositionWidth:oe});if(de.type==="error")return g(M=>({...M,[K]:{type:"error",error:de.error}})),Q;const ne=de.result;return typeof ne=="object"&&"then"in ne?(g(M=>{const z=M[K];return z?.type==="success"||z?.type==="success-and-refreshing"?{...M,[K]:{type:"success-and-refreshing",result:z.result}}:{...M,[K]:{type:"loading"}}}),ne.then(M=>{Q.signal.aborted||g(z=>({...z,[K]:{type:"success",result:M}}))}).catch(M=>{Q.signal.aborted||g(z=>({...z,[K]:{type:"error",error:M}}))})):g(M=>({...M,[K]:{type:"success",result:ne}})),Q},[x]),T=s?.type==="composition"?s.compositionId:null;m.useImperativeHandle(zb,()=>({setCurrentRenderModalComposition:B=>{t(B)},reloadCurrentlySelectedComposition:()=>{if(!T)return;const B=n.find(G=>G.id===T);if(!B)throw new Error(`Could not find composition with id ${T}`);const X=h[T]??{},Y={...B.defaultProps??{},...X??{}},Z={...Y,...d??{}};C({defaultProps:Y,calculateMetadata:B.calculateMetadata,combinedProps:Z,compositionDurationInFrames:B.durationInFrames??null,compositionFps:B.fps??null,compositionHeight:B.height??null,compositionWidth:B.width??null,compositionId:B.id})}}),[h,n,T,C,d]);const k=c?.id===u?.id,A=m.useMemo(()=>({...c?.defaultProps??{},...v??{}}),[c?.defaultProps,v]),I=m.useMemo(()=>({...A,...d??{}}),[A,d]),D=c&&Wb(c),F=typeof window<"u"&&window.remotion_ignoreFastRefreshUpdate&&a<=window.remotion_ignoreFastRefreshUpdate;m.useEffect(()=>{if(!F&&D){const B=C({calculateMetadata:c.calculateMetadata,combinedProps:I,compositionDurationInFrames:c.durationInFrames??null,compositionFps:c.fps??null,compositionHeight:c.height??null,compositionWidth:c.width??null,defaultProps:A,compositionId:c.id});return()=>{B.abort()}}},[D,A,C,I,c?.calculateMetadata,c?.durationInFrames,c?.fps,c?.height,c?.id,c?.width,F]),m.useEffect(()=>{F||window.dispatchEvent(new CustomEvent("remotion.propsUpdatedExternally"))},[a]),m.useEffect(()=>{if(u&&!k){const B={...u.defaultProps??{},...b??{},...d??{}},X=C({calculateMetadata:u.calculateMetadata,compositionDurationInFrames:u.durationInFrames??null,compositionFps:u.fps??null,compositionHeight:u.height??null,compositionId:u.id,compositionWidth:u.width??null,defaultProps:A,combinedProps:B});return()=>{X.abort()}}},[A,C,d,k,u,b]);const U=m.useMemo(()=>{const B=n.filter(X=>X.calculateMetadata===null);return{...p,...B.reduce((X,Y)=>({...X,[Y.id]:{type:"success",result:{...Y,defaultProps:Y.defaultProps??{}}}}),{})}},[n,p]);return w.jsx(hu.Provider,{value:U,children:r})},hp=r=>{const e=m.useContext(hu),{props:t}=m.useContext(uu),{compositions:n,canvasContent:s,currentCompositionMetadata:i}=m.useContext(Ns),a=s?.type==="composition"?s.compositionId:null,c=r??a,u=n.find(d=>d.id===c),h=m.useMemo(()=>u?t[u.id]??{}:{},[t,u]);return m.useMemo(()=>u?i?{type:"success",result:{...i,id:u.id,props:i.props,defaultProps:u.defaultProps??{},defaultCodec:i.defaultCodec}}:Wb(u)?e[u.id]?e[u.id]:null:(up(u.durationInFrames,{allowFloats:!1,component:`in <Composition id="${u.id}">`}),Vb(u.fps,`in <Composition id="${u.id}">`),Pl(u.width,"width",`in <Composition id="${u.id}">`),Pl(u.height,"height",`in <Composition id="${u.id}">`),{type:"success",result:{width:u.width,height:u.height,fps:u.fps,id:u.id,durationInFrames:u.durationInFrames,defaultProps:u.defaultProps??{},props:{...u.defaultProps??{},...h??{},...typeof window>"u"||Bt().isPlayer?{}:Bb()??{}},defaultCodec:null}}):null,[u,e,i,h])},du=()=>{const{canvasContent:r,compositions:e,currentCompositionMetadata:t}=m.useContext(Ns),n=e.find(i=>r?.type==="composition"&&i.id===r.compositionId),s=hp(n?.id??null);return m.useMemo(()=>!s||s.type==="error"||s.type==="loading"||!n?null:{...s.result,defaultProps:n.defaultProps??{},id:n.id,...t??{},component:n.component},[t,s,n])},_n=m.createContext({frame:{},playing:!1,playbackRate:1,rootId:"",imperativePlaying:{current:!1},setPlaybackRate:()=>{throw new Error("default")},audioAndVideoTags:{current:[]}}),Eo=m.createContext({setFrame:()=>{throw new Error("default")},setPlaying:()=>{throw new Error("default")}}),dp=()=>"remotion.time-all",$b=r=>{localStorage.setItem(dp(),JSON.stringify(r))},Yb=()=>{const r=localStorage.getItem(dp())??"{}";return JSON.parse(r)},Xb=r=>{const e=localStorage.getItem(dp())??"{}",t=JSON.parse(e);return t[r]!==void 0?Number(t[r]):typeof window>"u"?0:window.remotion_initialFrame??0},Ti=()=>{const r=du(),e=m.useContext(_n);if(!r)return typeof window>"u"?0:window.remotion_initialFrame??0;const t=e.frame[r.id]??(Bt().isPlayer?0:Xb(r.id));return Math.min(r.durationInFrames-1,t)},Gb=()=>{const{setFrame:r}=m.useContext(Eo);return r},fp=()=>{const{playing:r,imperativePlaying:e}=m.useContext(_n),{setPlaying:t}=m.useContext(Eo);return m.useMemo(()=>[r,t,e],[e,r,t])},Ei=m.createContext(!1),Jd=({children:r})=>w.jsx(Ei.Provider,{value:!0,children:r}),fu=()=>{const r=m.useContext(fr),e=r?.width??null,t=r?.height??null,n=r?.durationInFrames??null,s=du();return m.useMemo(()=>{if(!s)return null;const{id:i,durationInFrames:a,fps:c,height:u,width:h,defaultProps:d,props:p,defaultCodec:g}=s;return{id:i,width:e??h,height:t??u,fps:c,durationInFrames:n??a,defaultProps:d,props:p,defaultCodec:g}},[n,t,e,s])},Bs=()=>{const r=fu(),e=m.useContext(Ei),t=cp();if(!r)throw typeof window<"u"&&window.remotion_isPlayer||t?new Error(["No video config found. Likely reasons:","- You are probably calling useVideoConfig() from outside the component passed to <Player />. See https://www.remotion.dev/docs/player/examples for how to set up the Player correctly.","- You have multiple versions of Remotion installed which causes the React context to get lost."].join("-")):new Error("No video config found. You are probably calling useVideoConfig() from a component which has not been registered as a <Composition />. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions for more information.");if(!e)throw new Error("Called useVideoConfig() outside a Remotion composition.");return r},Vs=()=>{if(!m.useContext(Ei))throw Bt().isPlayer?new Error("useCurrentFrame can only be called inside a component that was passed to <Player>. See: https://www.remotion.dev/docs/player/examples"):new Error("useCurrentFrame() can only be called inside a component that was registered as a composition. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions");const e=Ti(),t=m.useContext(fr),n=t?t.cumulatedFrom+t.relativeFrom:0;return e-n},XD=({frame:r,children:e,active:t=!0})=>{const n=Vs(),s=Bs();if(typeof r>"u")throw new Error("The <Freeze /> component requires a 'frame' prop, but none was passed.");if(typeof r!="number")throw new Error(`The 'frame' prop of <Freeze /> must be a number, but is of type ${typeof r}`);if(Number.isNaN(r))throw new Error("The 'frame' prop of <Freeze /> must be a real number, but it is NaN.");if(!Number.isFinite(r))throw new Error(`The 'frame' prop of <Freeze /> must be a finite number, but it is ${r}.`);const i=m.useMemo(()=>{if(typeof t=="boolean")return t;if(typeof t=="function")return t(n)},[t,n]),a=m.useContext(_n),u=m.useContext(fr)?.relativeFrom??0,h=m.useMemo(()=>i?{...a,playing:!1,imperativePlaying:{current:!1},frame:{[s.id]:r+u}}:a,[i,a,s.id,r,u]);return w.jsx(_n.Provider,{value:h,children:e})},GD=({from:r=0,durationInFrames:e=1/0,children:t,name:n,height:s,width:i,showInTimeline:a=!0,_remotionInternalLoopDisplay:c,_remotionInternalStack:u,_remotionInternalPremountDisplay:h,...d},p)=>{const{layout:g="absolute-fill"}=d,[v]=m.useState(()=>String(Math.random())),b=m.useContext(fr),{rootId:x}=m.useContext(_n),C=b?b.cumulatedFrom+b.relativeFrom:0,T=lp();if(g!=="absolute-fill"&&g!=="none")throw new TypeError(`The layout prop of <Sequence /> expects either "absolute-fill" or "none", but you passed: ${g}`);if(g==="none"&&typeof d.style<"u")throw new TypeError('If layout="none", you may not pass a style.');if(typeof e!="number")throw new TypeError(`You passed to durationInFrames an argument of type ${typeof e}, but it must be a number.`);if(e<=0)throw new TypeError(`durationInFrames must be positive, but got ${e}`);if(typeof r!="number")throw new TypeError(`You passed to the "from" props of your <Sequence> an argument of type ${typeof r}, but it must be a number.`);if(!Number.isFinite(r))throw new TypeError(`The "from" prop of a sequence must be finite, but got ${r}.`);const k=Ti(),A=Bs(),I=b?Math.min(b.durationInFrames-r,e):e,D=Math.max(0,Math.min(A.durationInFrames-r,I)),{registerSequence:F,unregisterSequence:U}=m.useContext(Co),{hidden:B}=m.useContext(qa),X=m.useMemo(()=>b?.premounting??!!d._remotionInternalIsPremounting,[d._remotionInternalIsPremounting,b?.premounting]),Y=m.useMemo(()=>({cumulatedFrom:C,relativeFrom:r,durationInFrames:D,parentFrom:b?.relativeFrom??0,id:v,height:s??b?.height??null,width:i??b?.width??null,premounting:X}),[C,r,D,b,v,s,i,X]),Z=m.useMemo(()=>n??"",[n]);m.useEffect(()=>{if(Bt().isStudio)return F({from:r,duration:D,id:v,displayName:Z,parent:b?.id??null,type:"sequence",rootId:x,showInTimeline:a,nonce:T,loopDisplay:c,stack:u??null,premountDisplay:h??null}),()=>{U(v)}},[e,v,n,F,Z,U,b?.id,D,x,r,a,T,c,u,h]);const G=Math.ceil(C+r+e-1),K=k<C+r||k>G?null:t,oe=d.layout==="none"?void 0:d.style,ve=m.useMemo(()=>({flexDirection:void 0,...i?{width:i}:{},...s?{height:s}:{},...oe??{}}),[s,oe,i]);if(p!==null&&g==="none")throw new TypeError('It is not supported to pass both a `ref` and `layout="none"` to <Sequence />.');return B[v]??!1?null:w.jsx(fr.Provider,{value:Y,children:K===null?null:d.layout==="none"?K:w.jsx(ma,{ref:p,style:ve,className:d.className,children:K})})},qD=m.forwardRef(GD),KD=(r,e)=>{const t=Vs();if(r.layout==="none")throw new Error('`<Sequence>` with `premountFor` prop does not support layout="none"');const{style:n,from:s=0,premountFor:i=0,...a}=r,c=t<s&&t>=s-i,u=m.useMemo(()=>({...n,opacity:c?0:1,pointerEvents:c?"none":n?.pointerEvents??void 0}),[c,n]);return w.jsx(XD,{frame:s,active:c,children:w.jsx(Dn,{ref:e,from:s,style:u,_remotionInternalPremountDisplay:i,_remotionInternalIsPremounting:c,...a})})},ZD=m.forwardRef(KD),JD=(r,e)=>r.layout!=="none"&&r.premountFor&&!Bt().isRendering?w.jsx(ZD,{...r,ref:e}):w.jsx(qD,{...r,ref:e}),Dn=m.forwardRef(JD),QD=r=>{if(typeof r!="string")throw new TypeError(`The "filename" must be a string, but you passed a value of type ${typeof r}`);if(r.trim()==="")throw new Error("The `filename` must not be empty");if(!r.match(/^([0-9a-zA-Z-!_.*'()/:&$@=;+,?]+)/g))throw new Error('The `filename` must match "/^([0-9a-zA-Z-!_.*\'()/:&$@=;+,?]+)/g". Use forward slashes only, even on Windows.')},eR=r=>{if(typeof r!="string"&&!(r instanceof Uint8Array))throw new TypeError(`The "content" must be a string or Uint8Array, but you passed a value of type ${typeof r}`);if(typeof r=="string"&&r.trim()==="")throw new Error("The `content` must not be empty")},qb=r=>{r.type==="artifact"&&(QD(r.filename),eR(r.content))},ki=m.createContext({registerRenderAsset:()=>{},unregisterRenderAsset:()=>{},renderAssets:[]}),tR=({children:r})=>{const[e,t]=m.useState([]),n=m.useCallback(a=>{qb(a),t(c=>[...c,a])},[]),s=m.useCallback(a=>{t(c=>c.filter(u=>u.id!==a))},[]);m.useLayoutEffect(()=>{typeof window<"u"&&(window.remotion_collectAssets=()=>(t([]),e))},[e]);const i=m.useMemo(()=>({registerRenderAsset:n,unregisterRenderAsset:s,renderAssets:e}),[e,n,s]);return w.jsx(ki.Provider,{value:i,children:r})},os=r=>typeof window>"u"?r:new URL(r,window.origin).href,Kb=({endAt:r,mediaDuration:e,playbackRate:t,startFrom:n})=>{let s=e;typeof r<"u"&&(s=r),typeof n<"u"&&(s-=n);const i=s/t;return Math.floor(i)};function Ia(r){let e;throw rR(r)?(e=r,e.stack||(e.stack=new Error(e.message).stack)):typeof r=="string"?e=Error(r):e=Error("Rendering was cancelled"),window.remotion_cancelledError=e.stack,e}var rR=r=>r instanceof Error?!0:!(r===null||typeof r!="object"||!("stack"in r)||typeof r.stack!="string"||!("message"in r)||typeof r.message!="string"),Zb=m.createContext(null),nR=()=>Me.useContext(Zb),pu=({durationInFrames:r,times:e=1/0,children:t,name:n,...s})=>{const i=Vs(),{durationInFrames:a}=Bs();if(up(r,{component:"of the <Loop /> component",allowFloats:!0}),typeof e!="number")throw new TypeError(`You passed to "times" an argument of type ${typeof e}, but it must be a number.`);if(e!==1/0&&e%1!==0)throw new TypeError(`The "times" prop of a loop must be an integer, but got ${e}.`);if(e<0)throw new TypeError(`The "times" prop of a loop must be at least 0, but got ${e}`);const c=Math.ceil(a/r),u=Math.min(c,e),h=s.layout==="none"?void 0:s.style,d=r*(u-1),g=Math.floor(i/r)*r,v=Math.min(g,d),b=m.useMemo(()=>({numberOfTimes:u,startOffset:-v,durationInFrames:r}),[u,r,v]),x=m.useMemo(()=>({iteration:Math.floor(i/r),durationInFrames:r}),[i,r]);return w.jsx(Zb.Provider,{value:x,children:w.jsx(Dn,{durationInFrames:r,from:v,name:n??"<Loop>",_remotionInternalLoopDisplay:b,layout:s.layout,style:h,children:t})})};pu.useLoop=nR;var gu=m.createContext({}),m0={},nd=[],Jb=({children:r})=>{const[e,t]=m.useState(()=>m0);return m.useEffect(()=>{const n=()=>{t(m0)};return nd.push(n),()=>{nd=nd.filter(s=>s!==n)}},[]),w.jsx(gu.Provider,{value:e,children:r})},ko=r=>m.useContext(gu)[r]??r,pp=(r,e)=>{if(typeof r.volume!="number"&&typeof r.volume!="function"&&typeof r.volume<"u")throw new TypeError(`You have passed a volume of type ${typeof r.volume} to your <${e} /> component. Volume must be a number or a function with the signature '(frame: number) => number' undefined.`);if(typeof r.volume=="number"&&r.volume<0)throw new TypeError(`You have passed a volume below 0 to your <${e} /> component. Volume must be between 0 and 1`);if(typeof r.playbackRate!="number"&&typeof r.playbackRate<"u")throw new TypeError(`You have passed a playbackRate of type ${typeof r.playbackRate} to your <${e} /> component. Playback rate must a real number or undefined.`);if(typeof r.playbackRate=="number"&&(isNaN(r.playbackRate)||!Number.isFinite(r.playbackRate)||r.playbackRate<=0))throw new TypeError(`You have passed a playbackRate of ${r.playbackRate} to your <${e} /> component. Playback rate must be a real number above 0.`)},gp=(r,e)=>{if(typeof r<"u"){if(typeof r!="number")throw new TypeError(`type of startFrom prop must be a number, instead got type ${typeof r}.`);if(isNaN(r)||r===1/0)throw new TypeError("startFrom prop can not be NaN or Infinity.");if(r<0)throw new TypeError(`startFrom must be greater than equal to 0 instead got ${r}.`)}if(typeof e<"u"){if(typeof e!="number")throw new TypeError(`type of endAt prop must be a number, instead got type ${typeof e}.`);if(isNaN(e))throw new TypeError("endAt prop can not be NaN.");if(e<=0)throw new TypeError(`endAt must be a positive number, instead got ${e}.`)}if(e<r)throw new TypeError("endAt prop must be greater than startFrom prop.")},sR=(r,e)=>{switch(e.type){case"got-duration":{const t=os(e.src);return r[t]===e.durationInSeconds?r:{...r,[t]:e.durationInSeconds}}default:return r}},mp=m.createContext({durations:{},setDurations:()=>{throw new Error("context missing")}}),Qb=({children:r})=>{const[e,t]=m.useReducer(sR,{}),n=m.useMemo(()=>({durations:e,setDurations:t}),[e]);return w.jsx(mp.Provider,{value:n,children:r})};function v0(r){let e=r+1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function iR(r){let e=0,t=0,n=0;for(e=0;e<r.length;e++)t=r.charCodeAt(e),n=(n<<5)-n+t,n|=0;return n}var Oi=(r,e)=>{if(r===null)return Math.random();if(typeof r=="string")return v0(iR(r));if(typeof r=="number")return v0(r*1e10);throw new Error("random() argument must be a number or a string")},Oo=()=>{const r=m.useContext(fr);return Math.min(0,r?.relativeFrom??0)},Ka=r=>{const e=pu.useLoop(),t=Vs(),n=Oo();return r==="repeat"||e===null?t+n:t+n+e.durationInFrames*e.iteration},oR=r=>{if(/data:|blob:/.test(r.substring(0,5)))return"Data URL";const e=r.split("/").map(t=>t.split("\\")).flat(1);return e[e.length-1]},Dl=(r,e,t)=>{const{current:n}=r;if(!n)return;const s=n.play();s.catch&&s.catch(i=>{if(n&&!i.message.includes("request was interrupted by a call to pause")&&!i.message.includes("The operation was aborted.")&&!i.message.includes("The fetching process for the media resource was aborted by the user agent")&&!i.message.includes("request was interrupted by a new load request")&&!i.message.includes("because the media was removed from the document")&&!(i.message.includes("user didn't interact with the document")&&n.muted)&&(console.log(`Could not play ${e} due to following error: `,i),!n.muted)){if(t){t();return}console.log("The video will be muted and we'll retry playing it."),e==="video"&&Bt().isPlayer&&console.log("Use onAutoPlayError() to handle this error yourself."),n.muted=!0,n.play()}})},Ao=({frame:r,volume:e,mediaVolume:t=1,allowAmplificationDuringRender:n})=>{const s=n?1/0:1;if(typeof e=="number")return Math.min(s,e*t);if(typeof e>"u")return Number(t);const i=e(r)*t;if(typeof i!="number")throw new TypeError(`You passed in a a function to the volume prop but it did not return a number but a value of type ${typeof i} for frame ${r}`);if(Number.isNaN(i))throw new TypeError(`You passed in a function to the volume prop but it returned NaN for frame ${r}.`);if(!Number.isFinite(i))throw new TypeError(`You passed in a function to the volume prop but it returned a non-finite number for frame ${r}.`);return Math.max(0,Math.min(s,i))},y0={},aR=r=>{y0[r]||(console.warn(r),y0[r]=!0)},ew=({volume:r,mediaVolume:e,mediaRef:t,src:n,mediaType:s,playbackRate:i,displayName:a,id:c,stack:u,showInTimeline:h,premountDisplay:d,onAutoPlayError:p})=>{const g=Bs(),{rootId:v,audioAndVideoTags:b}=m.useContext(_n),x=m.useContext(fr),C=x?x.relativeFrom+x.cumulatedFrom:0,[T]=fp(),k=Oo(),{registerSequence:A,unregisterSequence:I}=m.useContext(Co),[D]=m.useState(()=>r),F=lp(),U=x?Math.min(x.durationInFrames,g.durationInFrames):g.durationInFrames,B=typeof r=="function",X=m.useMemo(()=>typeof r=="number"?r:new Array(Math.floor(Math.max(0,U+k))).fill(!0).map((Y,Z)=>Ao({frame:Z+k,volume:r,mediaVolume:e,allowAmplificationDuringRender:!1})).join(","),[U,k,r,e]);m.useEffect(()=>{typeof r=="number"&&r!==D&&aR(`Remotion: The ${s} with src ${n} has changed it's volume. Prefer the callback syntax for setting volume to get better timeline display: https://www.remotion.dev/docs/using-audio/#controlling-volume`)},[D,s,n,r]),m.useEffect(()=>{if(t.current){if(!n)throw new Error("No src passed");if(!(!Bt().isStudio&&window.process?.env?.NODE_ENV!=="test")&&h)return A({type:s,src:n,id:c,duration:U,from:0,parent:x?.id??null,displayName:a??oR(n),rootId:v,volume:X,showInTimeline:!0,nonce:F,startMediaFrom:0-k,doesVolumeChange:B,loopDisplay:void 0,playbackRate:i,stack:u,premountDisplay:d}),()=>{I(c)}}},[C,U,c,x,n,A,v,I,g,X,B,F,t,s,k,i,a,u,h,d]),m.useEffect(()=>{const Y={id:c,play:()=>{if(T)return Dl(t,s,p)}};return b.current.push(Y),()=>{b.current=b.current.filter(Z=>Z.id!==c)}},[b,c,t,s,p,T])},cR=()=>{const[r,e]=m.useState([]),[t,n]=m.useState([]),[s,i]=m.useState([]),a=m.useRef(!1),c=m.useCallback(d=>(e(p=>[...p,d]),{unblock:()=>{e(p=>{const g=p.filter(v=>v!==d);return g.length===p.length?p:g})}}),[]),u=m.useCallback(d=>(n(p=>[...p,d]),{remove:()=>{n(p=>p.filter(g=>g!==d))}}),[]),h=m.useCallback(d=>(i(p=>[...p,d]),{remove:()=>{i(p=>p.filter(g=>g!==d))}}),[]);return m.useEffect(()=>{r.length>0&&t.forEach(d=>d())},[r]),m.useEffect(()=>{r.length===0&&s.forEach(d=>d())},[r]),m.useMemo(()=>({addBlock:c,listenForBuffering:u,listenForResume:h,buffering:a}),[c,a,u,h])},Io=Me.createContext(null),tw=({children:r})=>{const e=cR();return w.jsx(Io.Provider,{value:e,children:r})},lR=r=>{const[e,t]=m.useState(r.buffering.current);return m.useEffect(()=>{const n=()=>{t(!0)},s=()=>{t(!1)};return r.listenForBuffering(n),r.listenForResume(s),()=>{r.listenForBuffering(()=>{}),r.listenForResume(()=>{})}},[r]),e},vp=()=>{const r=m.useContext(Io),e=r?r.addBlock:null;return m.useMemo(()=>({delayPlayback:()=>{if(!e)throw new Error("Tried to enable the buffering state, but a Remotion context was not found. This API can only be called in a component that was passed to the Remotion Player or a <Composition>. Or you might have experienced a version mismatch - run `npx remotion versions` and ensure all packages have the same version. This error is thrown by the buffer state https://remotion.dev/docs/player/buffer-state");const{unblock:t}=e({id:String(Math.random())});return{unblock:t}}}),[e])},uR=({mediaRef:r,mediaType:e,onVariableFpsVideoDetected:t,pauseWhenBuffering:n})=>{const s=m.useRef(!1),{delayPlayback:i}=vp(),a=m.useCallback(c=>{if(e!=="video"||!n)return;const u=r.current;if(!u||!u.requestVideoFrameCallback)return;s.current=!0;const h=i(),d=()=>{h.unblock(),u.removeEventListener("ended",d,{once:!0}),u.removeEventListener("pause",d,{once:!0}),s.current=!1},p=()=>{d()};u.requestVideoFrameCallback((g,v)=>{Math.abs(v.mediaTime-c)>.5&&t(),d()}),u.addEventListener("ended",p,{once:!0}),u.addEventListener("pause",p,{once:!0}),u.addEventListener("canplay",p,{once:!0})},[i,r,e,t,n]);return m.useMemo(()=>({isBuffering:()=>s.current,bufferUntilFirstFrame:a}),[a])},hR=({element:r,shouldBuffer:e,isPremounting:t})=>{const n=vp(),[s,i]=m.useState(!1);return m.useEffect(()=>{let a=[];const{current:c}=r;if(!c||!e||t)return;const u=()=>{a.forEach(p=>p()),a=[],i(!1)},h=()=>{i(!0);const{unblock:p}=n.delayPlayback(),g=()=>{u(),d()},v=()=>{u(),d()};c.addEventListener("canplay",g,{once:!0}),a.push(()=>{c.removeEventListener("canplay",g)}),c.addEventListener("error",v,{once:!0}),a.push(()=>{c.removeEventListener("error",v)}),a.push(()=>{p()})},d=()=>{c.readyState<c.HAVE_FUTURE_DATA?(h(),navigator.userAgent.includes("Firefox/")||c.load()):(c.addEventListener("waiting",h),a.push(()=>{c.removeEventListener("waiting",h)}))};return d(),()=>{u()}},[n,r,t,e]),s},dR=({mediaRef:r,mediaType:e,lastSeek:t,onVariableFpsVideoDetected:n})=>{const s=m.useRef(null);return m.useEffect(()=>{const{current:i}=r;if(i)s.current=i.currentTime;else{s.current=null;return}if(e!=="video"){s.current=null;return}const a=i;if(!a.requestVideoFrameCallback)return;let c=()=>{};const u=()=>{if(!a)return;const h=a.requestVideoFrameCallback((d,p)=>{if(s.current!==null){const g=Math.abs(s.current-p.mediaTime),v=Math.abs(t.current===null?1/0:p.mediaTime-t.current);g>.5&&v>.5&&p.mediaTime>s.current&&n()}s.current=p.mediaTime,u()});c=()=>{a.cancelVideoFrameCallback(h),c=()=>{}}};return u(),()=>{c()}},[t,r,e,n]),s};function fR(r,e,t,n){const{extrapolateLeft:s,extrapolateRight:i,easing:a}=n;let c=r;const[u,h]=e,[d,p]=t;if(c<u){if(s==="identity")return c;if(s==="clamp")c=u;else if(s==="wrap"){const g=h-u;c=((c-u)%g+g)%g+u}}if(c>h){if(i==="identity")return c;if(i==="clamp")c=h;else if(i==="wrap"){const g=h-u;c=((c-u)%g+g)%g+u}}return d===p?d:(c=(c-u)/(h-u),c=a(c),c=c*(p-d)+d,c)}function pR(r,e){let t;for(t=1;t<e.length-1&&!(e[t]>=r);++t);return t-1}function gR(r){for(let e=1;e<r.length;++e)if(!(r[e]>r[e-1]))throw new Error(`inputRange must be strictly monotonically increasing but got [${r.join(",")}]`)}function b0(r,e){if(e.length<2)throw new Error(r+" must have at least 2 elements");for(const t of e){if(typeof t!="number")throw new Error(`${r} must contain only numbers`);if(!Number.isFinite(t))throw new Error(`${r} must contain only finite numbers, but got [${e.join(",")}]`)}}function rw(r,e,t,n){if(typeof r>"u")throw new Error("input can not be undefined");if(typeof e>"u")throw new Error("inputRange can not be undefined");if(typeof t>"u")throw new Error("outputRange can not be undefined");if(e.length!==t.length)throw new Error("inputRange ("+e.length+") and outputRange ("+t.length+") must have the same length");b0("inputRange",e),b0("outputRange",t),gR(e);const s=n?.easing??(u=>u);let i="extend";n?.extrapolateLeft!==void 0&&(i=n.extrapolateLeft);let a="extend";if(n?.extrapolateRight!==void 0&&(a=n.extrapolateRight),typeof r!="number")throw new TypeError("Cannot interpolate an input which is not a number");const c=pR(r,e);return fR(r,[e[c],e[c+1]],[t[c],t[c+1]],{easing:s,extrapolateLeft:i,extrapolateRight:a})}var nw=({frame:r,playbackRate:e,startFrom:t})=>rw(r,[-1,t,t+1],[-1,t,t+e]),sw=({fps:r,frame:e,playbackRate:t,startFrom:n})=>{const s=nw({frame:e,playbackRate:t,startFrom:n}),i=1e3/r;return s*i/1e3},iw=(r,e)=>Math.round(r/e*100)/100,mu=()=>{if(typeof window>"u")return!1;const r=/iP(ad|od|hone)/i.test(window.navigator.userAgent),e=/AppleWebKit/.test(window.navigator.userAgent);return r&&e},mR=r=>mu()&&r.startsWith("blob:"),Qd=({actualFrom:r,fps:e})=>iw(Math.max(0,-r),e),ef=({duration:r,fps:e})=>iw(r,e),vR=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{if(mR(r)||r.startsWith("data:")||!!new URL(r,(typeof window>"u"?null:window.location.href)??"http://localhost:3000").hash||!Number.isFinite(e))return r;const i=`${r}#t=${Qd({actualFrom:e,fps:n})}`;return Number.isFinite(t)?`${i},${ef({duration:t,fps:n})}`:i},yR=({prevStartFrom:r,newStartFrom:e,prevDuration:t,newDuration:n,fps:s})=>{const i=Qd({actualFrom:r,fps:s}),a=Qd({actualFrom:e,fps:s}),c=ef({duration:t,fps:s}),u=ef({duration:n,fps:s});return!(a<i||u>c)},bR=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{const s=m.useRef(e),i=m.useRef(t),a=m.useRef(r);return(!yR({prevStartFrom:s.current,newStartFrom:e,prevDuration:i.current,newDuration:t,fps:n})||r!==a.current)&&(s.current=e,i.current=t,a.current=r),vR({actualSrc:a.current,actualFrom:s.current,duration:i.current,fps:n})},w0={},wR=(r,e)=>{if(r===null||r.seekable.length===0||r.seekable.length>1||w0[r.src])return;const t={start:r.seekable.start(0),end:r.seekable.end(0)};if(t.start===0&&t.end===0){const n=[`The media ${r.src} cannot be seeked. This could be one of few reasons:`,"1) The media resource was replaced while the video is playing but it was not loaded yet.","2) The media does not support seeking.","3) The media was loaded with security headers prventing it from being included.","Please see https://remotion.dev/docs/non-seekable-media for assistance."].join(`
`);if(e==="console-error")console.error(n);else if(e==="console-warning")console.warn(`The media ${r.src} does not support seeking. The video will render fine, but may not play correctly in the Remotion Studio and in the <Player>. See https://remotion.dev/docs/non-seekable-media for an explanation.`);else throw new Error(n);w0[r.src]=!0}},yp=.45,sd=(r,e)=>{if(!r.current)return;const t=mu()?Number(e.toFixed(1)):e;r.current.currentTime=t},ow=({mediaRef:r,src:e,mediaType:t,playbackRate:n,onlyWarnForMediaSeekingError:s,acceptableTimeshift:i,pauseWhenBuffering:a,isPremounting:c,debugSeeking:u,onAutoPlayError:h})=>{const{playbackRate:d}=m.useContext(_n),p=Vs(),g=Ti(),[v]=fp(),b=m.useContext(Io),{fps:x}=Bs(),C=Oo(),T=m.useRef(null),k=m.useRef(null);if(!b)throw new Error("useMediaPlayback must be used inside a <BufferingContext>");const A=m.useRef({}),I=m.useCallback(()=>{e&&(u&&console.log(`Detected ${e} as a variable FPS video. Disabling buffering while seeking.`),A.current[e]=!0)},[u,e]),D=dR({mediaRef:r,mediaType:t,lastSeek:k,onVariableFpsVideoDetected:I}),F=sw({frame:p,playbackRate:n,startFrom:-C,fps:x}),U=hR({element:r,shouldBuffer:a,isPremounting:c}),{bufferUntilFirstFrame:B,isBuffering:X}=uR({mediaRef:r,mediaType:t,onVariableFpsVideoDetected:I,pauseWhenBuffering:a}),Y=n*d,Z=r.current?.duration?Math.min(r.current.duration,i??yp):i,G=lR(b);m.useEffect(()=>{if(!v){r.current?.pause();return}const K=U||X();G&&!K&&r.current?.pause()},[X,U,G,r,v]),m.useEffect(()=>{const K=t==="audio"?"<Audio>":"<Video>";if(!r.current)throw new Error(`No ${t} ref found`);if(!e)throw new Error(`No 'src' attribute was passed to the ${K} element.`);const oe=Math.max(0,Y);r.current.playbackRate!==oe&&(r.current.playbackRate=oe);const{duration:ve}=r.current,Q=!Number.isNaN(ve)&&Number.isFinite(ve)?Math.min(ve,F):F,ge=r.current.currentTime,de=D.current??null,ne=A.current[e],M=Math.abs(Q-ge),z=de?Math.abs(Q-de):null,ce=z&&!ne?z:M;if(u&&console.log({mediaTagTime:ge,rvcTime:de,shouldBeTime:Q,state:r.current.readyState,playing:!r.current.paused,isVariableFpsVideo:ne}),ce>Z&&T.current!==Q){u&&console.log("Seeking",{shouldBeTime:Q,isTime:ge,rvcTime:de,timeShift:ce,isVariableFpsVideo:ne}),sd(r,Q),k.current=Q,T.current=Q,v&&!ne&&(Y>0&&B(Q),r.current.paused&&Dl(r,t,h)),s||wR(r.current,s?"console-warning":"console-error");return}const fe=v?.15:1e-5,be=Math.abs(r.current.currentTime-Q)>fe,ye=U||X(),ue=b.buffering.current&&!ye;if(!v||ue){be&&(sd(r,Q),k.current=Q);return}(r.current.paused&&!r.current.ended||g===0)&&(be&&(sd(r,Q),k.current=Q),Dl(r,t,h),ne||Y>0&&B(Q))},[g,Z,B,b.buffering,D,u,F,X,U,r,t,s,Y,v,e,h])},aw=r=>{const[e,t]=m.useState(1);return m.useEffect(()=>{const n=r.current;if(!n)return;const s=()=>{t(n.volume)};return n.addEventListener("volumechange",s),()=>n.removeEventListener("volumechange",s)},[r]),m.useEffect(()=>{const n=r.current;n&&n.volume!==e&&t(n.volume)},[e,r]),e},_R=1e-5,bp=(r,e)=>Math.abs(r-e)<_R,cw=({volumePropFrame:r,actualVolume:e,volume:t,mediaVolume:n,mediaRef:s})=>{m.useEffect(()=>{const i=Ao({frame:r,volume:t,mediaVolume:n,allowAmplificationDuringRender:!1});!bp(i,e)&&s.current&&(s.current.volume=i)},[e,r,s,t,n])},wp=m.createContext({mediaMuted:!1,mediaVolume:1}),_p=m.createContext({setMediaMuted:()=>{throw new Error("default")},setMediaVolume:()=>{throw new Error("default")}}),xp=()=>{const{mediaVolume:r}=m.useContext(wp),{setMediaVolume:e}=m.useContext(_p);return m.useMemo(()=>[r,e],[r,e])},Sp=()=>{const{mediaMuted:r}=m.useContext(wp),{setMediaMuted:e}=m.useContext(_p);return m.useMemo(()=>[r,e],[r,e])},_0="data:audio/mp3;base64,/+MYxAAJcAV8AAgAABn//////+/gQ5BAMA+D4Pg+BAQBAEAwD4Pg+D4EBAEAQDAPg++hYBH///hUFQVBUFREDQNHmf///////+MYxBUGkAGIMAAAAP/29Xt6lUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDUAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",xR=(r,e)=>{const t=Object.keys(r).sort(),n=Object.keys(e).sort();if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==n[s]||r[t[s]]!==e[n[s]])return!1;return!0},SR=(r,e,t)=>r==="src"&&!t.startsWith("data:")&&!e.startsWith("data:")?new URL(t,window.origin).toString()!==new URL(e,window.origin).toString():t!==e,vu=m.createContext(null),lw=({children:r,numberOfAudioTags:e,component:t})=>{const n=m.useRef([]),[s]=m.useState(e);if(e!==s)throw new Error("The number of shared audio tags has changed dynamically. Once you have set this property, you cannot change it afterwards.");const i=m.useMemo(()=>new Array(e).fill(!0).map(()=>({id:Math.random(),ref:m.createRef()})),[e]),a=m.useRef(new Array(e).fill(!1)),c=m.useCallback(()=>{i.forEach(({ref:b,id:x})=>{const C=n.current?.find(k=>k.id===x),{current:T}=b;if(T){if(C===void 0){T.src=_0;return}if(!C)throw new TypeError("Expected audio data to be there");Object.keys(C.props).forEach(k=>{SR(k,C.props[k],T[k])&&(T[k]=C.props[k])})}})},[i]),u=m.useCallback((b,x)=>{const C=n.current?.find(F=>F.audioId===x);if(C)return C;const T=a.current.findIndex(F=>F===!1);if(T===-1)throw new Error(`Tried to simultaneously mount ${e+1} <Audio /> tags at the same time. With the current settings, the maximum amount of <Audio /> tags is limited to ${e} at the same time. Remotion pre-mounts silent audio tags to help avoid browser autoplay restrictions. See https://remotion.dev/docs/player/autoplay#use-the-numberofsharedaudiotags-property for more information on how to increase this limit.`);const{id:k,ref:A}=i[T],I=[...a.current];I[T]=k,a.current=I;const D={props:b,id:k,el:A,audioId:x};return n.current?.push(D),c(),D},[e,i,c]),h=m.useCallback(b=>{const x=[...a.current],C=i.findIndex(T=>T.id===b);if(C===-1)throw new TypeError("Error occured in ");x[C]=!1,a.current=x,n.current=n.current?.filter(T=>T.id!==b),c()},[i,c]),d=m.useCallback(({aud:b,audioId:x,id:C})=>{let T=!1;n.current=n.current?.map(k=>k.id===C?xR(b,k.props)?k:(T=!0,{...k,props:b,audioId:x}):k),T&&c()},[c]),p=m.useCallback(()=>{i.forEach(b=>{Dl(b.ref,"audio",null)})},[i]),g=m.useMemo(()=>({registerAudio:u,unregisterAudio:h,updateAudio:d,playAllAudios:p,numberOfAudioTags:e}),[e,p,u,h,d]),v=m.useCallback(()=>{a.current=new Array(e).fill(!1),n.current=[],c()},[e,c]);return m.useEffect(()=>()=>{v()},[t,v]),w.jsxs(vu.Provider,{value:g,children:[i.map(({id:b,ref:x})=>w.jsx("audio",{ref:x,preload:"metadata",src:_0},b)),r]})},CR=(r,e)=>{const t=m.useContext(vu),[n]=m.useState(()=>t&&t.numberOfAudioTags>0?t.registerAudio(r,e):{el:Me.createRef(),id:Math.random(),props:r,audioId:e}),s=Me.useInsertionEffect??Me.useLayoutEffect;return typeof document<"u"&&(s(()=>{t&&t.numberOfAudioTags>0&&t.updateAudio({id:n.id,aud:r,audioId:e})},[r,t,n.id,e]),s(()=>()=>{t&&t.numberOfAudioTags>0&&t.unregisterAudio(n.id)},[t,n.id])),n},TR=(r,e)=>{const[t]=m.useState(r.shouldPreMountAudioTags);if(r.shouldPreMountAudioTags!==t)throw new Error("Cannot change the behavior for pre-mounting audio tags dynamically.");const{volume:n,muted:s,playbackRate:i,shouldPreMountAudioTags:a,src:c,onDuration:u,acceptableTimeShiftInSeconds:h,_remotionInternalNeedsDurationCalculation:d,_remotionInternalNativeLoopPassed:p,_remotionInternalStack:g,_remotionDebugSeeking:v,allowAmplificationDuringRender:b,name:x,pauseWhenBuffering:C,showInTimeline:T,loopVolumeCurveBehavior:k,stack:A,...I}=r,[D]=xp(),[F]=Sp(),U=Ka(k??"repeat"),{hidden:B}=m.useContext(qa);if(!c)throw new TypeError("No 'src' was passed to <Audio>.");const X=ko(c),Y=m.useContext(fr),[Z]=m.useState(()=>String(Math.random())),G=B[Z]??!1,K=Ao({frame:U,volume:n,mediaVolume:D,allowAmplificationDuringRender:!1}),oe=m.useMemo(()=>({muted:s||F||G||K<=0,src:X,loop:p,...I}),[p,G,F,s,I,X,K]),ve=m.useMemo(()=>`audio-${Oi(c??"")}-${Y?.relativeFrom}-${Y?.cumulatedFrom}-${Y?.durationInFrames}-muted:${r.muted}-loop:${r.loop}`,[c,Y?.relativeFrom,Y?.cumulatedFrom,Y?.durationInFrames,r.muted,r.loop]),Q=CR(oe,ve).el,ge=aw(Q);cw({volumePropFrame:U,actualVolume:ge,volume:n,mediaVolume:D,mediaRef:Q}),ew({volume:n,mediaVolume:D,mediaRef:Q,src:c,mediaType:"audio",playbackRate:i??1,displayName:x??null,id:Z,stack:g,showInTimeline:T,premountDisplay:null,onAutoPlayError:null}),ow({mediaRef:Q,src:c,mediaType:"audio",playbackRate:i??1,onlyWarnForMediaSeekingError:!1,acceptableTimeshift:h??yp,isPremounting:!!Y?.premounting,pauseWhenBuffering:C,debugSeeking:v,onAutoPlayError:null}),m.useImperativeHandle(e,()=>Q.current,[Q]);const de=m.useRef();return de.current=u,m.useEffect(()=>{const{current:ne}=Q;if(!ne)return;if(ne.duration){de.current?.(ne.src,ne.duration);return}const M=()=>{de.current?.(ne.src,ne.duration)};return ne.addEventListener("loadedmetadata",M),()=>{ne.removeEventListener("loadedmetadata",M)}},[Q,c]),t?null:w.jsx("audio",{ref:Q,preload:"metadata",...oe})},ER=m.forwardRef(TR);typeof window<"u"&&(window.remotion_renderReady=!1);var xl=[];typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var kR="The delayRender was called:",OR="Retries left: ",AR="- Rendering the frame will be retried.",x0=3e4,As=(r,e)=>{if(typeof r!="string"&&typeof r<"u")throw new Error("The label parameter of delayRender() must be a string or undefined, got: "+JSON.stringify(r));const t=Math.random();xl.push(t);const n=Error().stack?.replace(/^Error/g,"")??"";if(Bt().isRendering){const s=(e?.timeoutInMilliseconds??(typeof window>"u"?x0:window.remotion_puppeteerTimeout??x0))-2e3;if(typeof window<"u"){const i=(e?.retries??0)-(window.remotion_attempt-1);window.remotion_delayRenderTimeouts[t]={label:r??null,timeout:setTimeout(()=>{const a=["A delayRender()",r?`"${r}"`:null,`was called but not cleared after ${s}ms. See https://remotion.dev/docs/timeout for help.`,i>0?OR+i:null,i>0?AR:null,kR,n].filter(lu).join(" ");Ia(Error(a))},s)}}}return typeof window<"u"&&(window.remotion_renderReady=!1),t},kt=r=>{if(typeof r>"u")throw new TypeError("The continueRender() method must be called with a parameter that is the return value of delayRender(). No value was passed.");if(typeof r!="number")throw new TypeError("The parameter passed into continueRender() must be the return value of delayRender() which is a number. Got: "+JSON.stringify(r));xl=xl.filter(e=>e===r?(Bt().isRendering&&(clearTimeout(window.remotion_delayRenderTimeouts[r].timeout),delete window.remotion_delayRenderTimeouts[r]),!1):!0),xl.length===0&&typeof window<"u"&&(window.remotion_renderReady=!0)},IR=(r,e)=>{const t=m.useRef(null),{volume:n,playbackRate:s,allowAmplificationDuringRender:i,onDuration:a,toneFrequency:c,_remotionInternalNeedsDurationCalculation:u,_remotionInternalNativeLoopPassed:h,acceptableTimeShiftInSeconds:d,name:p,onError:g,delayRenderRetries:v,delayRenderTimeoutInMilliseconds:b,loopVolumeCurveBehavior:x,pauseWhenBuffering:C,...T}=r,k=Ti(),A=Ka(x??"repeat"),I=Vs(),D=m.useContext(fr),{registerRenderAsset:F,unregisterRenderAsset:U}=m.useContext(ki),B=m.useMemo(()=>`audio-${Oi(r.src??"")}-${D?.relativeFrom}-${D?.cumulatedFrom}-${D?.durationInFrames}`,[r.src,D?.relativeFrom,D?.cumulatedFrom,D?.durationInFrames]),X=Ao({volume:n,frame:A,mediaVolume:1,allowAmplificationDuringRender:i??!1});m.useImperativeHandle(e,()=>t.current,[]),m.useEffect(()=>{if(!r.src)throw new Error("No src passed");if(window.remotion_audioEnabled&&!r.muted&&!(X<=0))return F({type:"audio",src:os(r.src),id:B,frame:k,volume:X,mediaFrame:I,playbackRate:r.playbackRate??1,allowAmplificationDuringRender:i??!1,toneFrequency:c??null,audioStartFrame:Math.max(0,-(D?.relativeFrom??0))}),()=>U(B)},[r.muted,r.src,F,k,B,U,X,A,I,s,r.playbackRate,i,c,D?.relativeFrom]);const{src:Y}=r,Z=e||u;return m.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"||!Z)return;const G=As("Loading <Audio> duration with src="+Y,{retries:v??void 0,timeoutInMilliseconds:b??void 0}),{current:K}=t,oe=()=>{K?.duration&&a(K.src,K.duration),kt(G)};return K?.duration?(a(K.src,K.duration),kt(G)):K?.addEventListener("loadedmetadata",oe,{once:!0}),()=>{K?.removeEventListener("loadedmetadata",oe),kt(G)}},[Y,a,Z,v,b]),Z?w.jsx("audio",{ref:t,...T}):null},MR=m.forwardRef(IR),PR=(r,e)=>{const t=m.useContext(vu),{startFrom:n,endAt:s,name:i,stack:a,pauseWhenBuffering:c,showInTimeline:u,_remotionDebugSeeking:h,...d}=r,{loop:p,...g}=r,{fps:v}=Bs(),b=Bt(),{durations:x,setDurations:C}=m.useContext(mp);if(typeof r.src!="string")throw new TypeError(`The \`<Audio>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const T=ko(r.src),k=m.useCallback(D=>{console.log(D.currentTarget.error);const F=`Could not play audio with src ${T}: ${D.currentTarget.error}. See https://remotion.dev/docs/media-playback-error for help.`;p?Ia(new Error(F)):console.warn(F)},[p,T]),A=m.useCallback((D,F)=>{C({type:"got-duration",durationInSeconds:F,src:D})},[C]),I=x[os(T)]??x[os(r.src)];if(p&&I!==void 0){if(!Number.isFinite(I))return w.jsx(va,{...g,ref:e,_remotionInternalNativeLoopPassed:!0});const D=I*v;return w.jsx(pu,{layout:"none",durationInFrames:Kb({endAt:s,mediaDuration:D,playbackRate:r.playbackRate??1,startFrom:n}),children:w.jsx(va,{...g,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof n<"u"||typeof s<"u"){gp(n,s);const D=n??0,F=s??1/0;return w.jsx(Dn,{layout:"none",from:0-D,showInTimeline:!1,durationInFrames:F,name:i,children:w.jsx(va,{_remotionInternalNeedsDurationCalculation:!!p,pauseWhenBuffering:c??!1,...d,ref:e})})}return pp(r,"Audio"),b.isRendering?w.jsx(MR,{onDuration:A,...r,ref:e,onError:k,_remotionInternalNeedsDurationCalculation:!!p}):w.jsx(ER,{_remotionInternalNativeLoopPassed:r._remotionInternalNativeLoopPassed??!1,_remotionDebugSeeking:h??!1,_remotionInternalStack:a??null,shouldPreMountAudioTags:t!==null&&t.numberOfAudioTags>0,...r,ref:e,onError:k,onDuration:A,pauseWhenBuffering:c??!1,_remotionInternalNeedsDurationCalculation:!!p,showInTimeline:u??!0})},va=m.forwardRef(PR);Ga(va);var DR=m.createContext({folderName:null,parentName:null}),RR={transform:"rotate(90deg)"},S0=40,jR={color:"white",fontSize:14,fontFamily:"sans-serif"},LR={justifyContent:"center",alignItems:"center"},FR=()=>w.jsxs(ma,{style:LR,id:"remotion-comp-loading",children:[w.jsx("style",{type:"text/css",children:`
				@keyframes anim {
					from {
						opacity: 0
					}
					to {
						opacity: 1
					}
				}
				#remotion-comp-loading {
					animation: anim 2s;
					animation-fill-mode: forwards;
				}
			`}),w.jsx("svg",{width:S0,height:S0,viewBox:"-100 -100 400 400",style:RR,children:w.jsx("path",{fill:"#555",stroke:"#555",strokeWidth:"100",strokeLinejoin:"round",d:"M 2 172 a 196 100 0 0 0 195 5 A 196 240 0 0 0 100 2.259 A 196 240 0 0 0 2 172 z"})}),w.jsxs("p",{style:jR,children:["Resolving ","<Suspense>","..."]})]}),zr=null,tf=()=>{if(!zr){if(typeof document>"u")throw new Error("Tried to call an API that only works in the browser from outside the browser");zr=document.createElement("div"),zr.style.position="absolute",zr.style.top="0px",zr.style.left="0px",zr.style.right="0px",zr.style.bottom="0px",zr.style.width="100%",zr.style.height="100%",zr.style.display="flex",zr.style.flexDirection="column";const r=document.createElement("div");r.style.position="fixed",r.style.top="-999999px",r.appendChild(zr),document.body.appendChild(r)}return zr},uw=r=>m.useMemo(()=>{if("lazyComponent"in r&&typeof r.lazyComponent<"u")return Me.lazy(r.lazyComponent);if("component"in r)return typeof document>"u"?r.component:Me.lazy(()=>Promise.resolve({default:r.component}));throw new Error("You must pass either 'component' or 'lazyComponent'")},[r.component,r.lazyComponent]),hw=()=>/^([a-zA-Z0-9-\u4E00-\u9FFF])+$/g,dw=r=>r.match(hw()),NR=r=>{if(!dw(r))throw new Error(`Composition id can only contain a-z, A-Z, 0-9, CJK characters and -. You passed ${r}`)},BR=`Composition ID must match ${String(hw())}`,VR=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}},HR=()=>(m.useEffect(()=>{const r=As("Waiting for Root component to unsuspend");return()=>kt(r)},[]),null),C0=({width:r,height:e,fps:t,durationInFrames:n,id:s,defaultProps:i,schema:a,...c})=>{const{registerComposition:u,unregisterComposition:h}=m.useContext(Ns),d=du(),p=uw(c),g=lp(),v=cp(),b=Bt();if(m.useContext(Ei))throw v?new Error("<Composition> was mounted inside the `component` that was passed to the <Player>. See https://remotion.dev/docs/wrong-composition-mount for help."):new Error("<Composition> mounted inside another composition. See https://remotion.dev/docs/wrong-composition-mount for help.");const{folderName:C,parentName:T}=m.useContext(DR);m.useEffect(()=>{if(!s)throw new Error("No id for composition passed.");return NR(s),VR(i,"defaultProps",s),u({durationInFrames:n??void 0,fps:t??void 0,height:e??void 0,width:r??void 0,id:s,folderName:C,component:p,defaultProps:ni(i??{}),nonce:g,parentFolderName:T,schema:a??null,calculateMetadata:c.calculateMetadata??null}),()=>{h(s)}},[n,t,e,p,s,C,i,u,h,r,g,T,a,c.calculateMetadata]);const k=hp(s);if(b.isStudio&&d&&d.component===p){const A=p;return k===null||k.type!=="success"?null:jd.createPortal(w.jsx(Jd,{children:w.jsx(m.Suspense,{fallback:w.jsx(FR,{}),children:w.jsx(A,{...k.result.props??{}})})}),tf())}if(b.isRendering&&d&&d.component===p){const A=p;return k===null||k.type!=="success"?null:jd.createPortal(w.jsx(Jd,{children:w.jsx(m.Suspense,{fallback:w.jsx(HR,{}),children:w.jsx(A,{...k.result.props??{}})})}),tf())}return null},fw=Me.createRef(),zR=({children:r,numberOfAudioTags:e})=>{const[t,n]=m.useState([]),s=m.useRef(t),[i,a]=m.useState([]),[c,u]=m.useState(null),[h,d]=m.useState(null),p=m.useCallback(A=>{n(I=>{const D=A(I);return s.current=D,D})},[]),g=m.useCallback(A=>{p(I=>{if(I.find(F=>F.id===A.id))throw new Error(`Multiple composition with id ${A.id} are registered.`);return[...I,A].slice().sort((F,U)=>F.nonce-U.nonce)})},[p]),v=m.useCallback(A=>{n(I=>I.filter(D=>D.id!==A))},[]),b=m.useCallback((A,I)=>{a(D=>[...D,{name:A,parent:I}])},[]),x=m.useCallback((A,I)=>{a(D=>D.filter(F=>!(F.name===A&&F.parent===I)))},[]);m.useImperativeHandle(fw,()=>({getCompositions:()=>s.current}),[]);const C=t.find(A=>c?.type==="composition"?A.id===c.compositionId:null),T=m.useCallback((A,I)=>{n(D=>D.map(U=>U.id===A?{...U,defaultProps:I}:U))},[]),k=m.useMemo(()=>({compositions:t,registerComposition:g,unregisterComposition:v,folders:i,registerFolder:b,unregisterFolder:x,currentCompositionMetadata:h,setCurrentCompositionMetadata:d,canvasContent:c,setCanvasContent:u,updateCompositionDefaultProps:T}),[t,g,v,i,b,x,h,c,T]);return w.jsx(Ns.Provider,{value:k,children:w.jsx(jD,{children:w.jsx(tR,{children:w.jsx(Ub,{children:w.jsx(lw,{numberOfAudioTags:e,component:C?.component??null,children:r})})})})})},WR=({onLoad:r,onError:e,delayRenderRetries:t,delayRenderTimeoutInMilliseconds:n,...s},i)=>{const[a]=m.useState(()=>As(`Loading <IFrame> with source ${s.src}`,{retries:t??void 0,timeoutInMilliseconds:n??void 0})),c=m.useCallback(h=>{kt(a),r?.(h)},[a,r]),u=m.useCallback(h=>{kt(a),e?e(h):console.error("Error loading iframe:",h,"Handle the event using the onError() prop to make this message disappear.")},[a,e]);return w.jsx("iframe",{...s,ref:i,onError:u,onLoad:c})};m.forwardRef(WR);function UR(r){return 1e3*2**(r-1)}var $R=({onError:r,maxRetries:e=2,src:t,pauseWhenLoading:n,delayRenderRetries:s,delayRenderTimeoutInMilliseconds:i,onImageFrame:a,...c},u)=>{const h=m.useRef(null),d=m.useRef({}),{delayPlayback:p}=vp(),g=m.useContext(fr);if(!t)throw new Error('No "src" prop was passed to <Img>.');m.useImperativeHandle(u,()=>h.current,[]);const v=ko(t),b=m.useCallback(C=>{if(!h.current)return;const T=h.current.src;setTimeout(()=>{if(!h.current)return;const k=h.current?.src;k===T&&(h.current.removeAttribute("src"),h.current.setAttribute("src",k))},C)},[]),x=m.useCallback(C=>{if(d.current){if(d.current[h.current?.src]=(d.current[h.current?.src]??0)+1,r&&(d.current[h.current?.src]??0)>e){r(C);return}if((d.current[h.current?.src]??0)<=e){const T=UR(d.current[h.current?.src]??0);console.warn(`Could not load image with source ${h.current?.src}, retrying again in ${T}ms`),b(T);return}Ia("Error loading image with src: "+h.current?.src)}},[e,r,b]);if(typeof window<"u"){const C=!!g?.premounting;m.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"){h.current&&(h.current.src=v);return}const T=As("Loading <Img> with src="+v,{retries:s??void 0,timeoutInMilliseconds:i??void 0}),k=n&&!C?p().unblock:()=>{},{current:A}=h;let I=!1;const D=()=>{I||((d.current[h.current?.src]??0)>0&&(delete d.current[h.current?.src],console.info(`Retry successful - ${h.current?.src} is now loaded`)),A&&(A.src=v,a?.(A)),k(),kt(T))},F=new Image;return F.src=v,F.decode().then(D).catch(U=>{console.warn(U),F.complete?D():F.addEventListener("load",D)}),()=>{I=!0,F.removeEventListener("load",D),k(),kt(T)}},[v,p,s,i,n,C,a])}return w.jsx("img",{...c,ref:h,onError:x})},pw=m.forwardRef($R),gw={};Mb(gw,{makeDefaultPreviewCSS:()=>XR,injectCSS:()=>YR,OFFTHREAD_VIDEO_CLASS_NAME:()=>Rl});var T0={},YR=r=>{if(typeof document>"u"||T0[r])return;const e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode(r)),e.prepend(t),T0[r]=!0},Rl="__remotion_offthreadvideo",XR=(r,e)=>r?`
    ${r} * {
      box-sizing: border-box;
    }
    ${r} *:-webkit-full-screen {
      width: 100%;
      height: 100%;
    }
    ${r} .${Rl} {
      object-fit: contain;
    }
  `:`
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
	    background-color: ${e};
    }
    .${Rl} {
      object-fit: contain;
    }
    `,mw="__remotion-studio-container",GR=()=>document.getElementById(mw),qR=null,id=[],KR=()=>qR,ZR=r=>(id.push(r),()=>{id=id.filter(e=>e!==r)}),JR=({children:r,numberOfAudioTags:e})=>{const[t]=m.useState(()=>String(Oi(null))),[n,s]=m.useState(()=>Yb()),[i,a]=m.useState(!1),c=m.useRef(!1),[u,h]=m.useState(0),[d,p]=m.useState(1),g=m.useRef([]);typeof window<"u"&&m.useLayoutEffect(()=>{window.remotion_setFrame=(C,T,k)=>{window.remotion_attempt=k;const A=As(`Setting the current frame to ${C}`);let I=!0;s(D=>(D[T]??window.remotion_initialFrame)===C?(I=!1,D):{...D,[T]:C}),I?requestAnimationFrame(()=>kt(A)):kt(A)},window.remotion_isPlayer=!1},[]);const v=m.useMemo(()=>({frame:n,playing:i,imperativePlaying:c,rootId:t,playbackRate:d,setPlaybackRate:p,audioAndVideoTags:g}),[n,d,i,t]),b=m.useMemo(()=>({setFrame:s,setPlaying:a}),[]),x=m.useMemo(()=>{let C=0;return{getNonce:()=>C++,fastRefreshes:u}},[u]);return m.useEffect(()=>{typeof __webpack_module__<"u"&&__webpack_module__.hot&&__webpack_module__.hot.addStatusHandler(C=>{C==="idle"&&h(T=>T+1)})},[]),w.jsx(To.Provider,{value:x,children:w.jsx(_n.Provider,{value:v,children:w.jsx(Eo.Provider,{value:b,children:w.jsx(Fb,{children:w.jsx(Jb,{children:w.jsx(zR,{numberOfAudioTags:e,children:w.jsx(Qb,{children:w.jsx(tw,{children:r})})})})})})})})},QR=()=>{if(Bt().isRendering){const r=window.remotion_envVariables;return r?{...JSON.parse(r),NODE_ENV:"production"}:{}}return{NODE_ENV:"production"}},e3=()=>{const r=QR();window.process||(window.process={}),window.process.env||(window.process.env={}),Object.keys(r).forEach(e=>{window.process.env[e]=r[e]})},t3=Me.createContext(null),r3=m.createContext({setSize:()=>{},size:{size:"auto",translation:{x:0,y:0}}}),n3=({canvasSize:r,compositionHeight:e,compositionWidth:t,previewSize:n})=>{const s=r.height/e,i=r.width/t,a=Math.min(s,i);return n==="auto"?a:Number(n)},s3="remotion_staticFilesChanged";function i3(){const r=Me.useContext(Ns),e=Me.useContext(_n),t=Me.useContext(Eo),n=Me.useContext(fr),s=Me.useContext(To),i=Me.useContext(Ei),a=Me.useContext(gu),c=Me.useContext(hu),u=Me.useContext(ki),h=Me.useContext(Co),d=Me.useContext(Io);return m.useMemo(()=>({compositionManagerCtx:r,timelineContext:e,setTimelineContext:t,sequenceContext:n,nonceContext:s,canUseRemotionHooksContext:i,preloadContext:a,resolveCompositionContext:c,renderAssetManagerContext:u,sequenceManagerContext:h,bufferManagerContext:d}),[r,s,n,t,e,i,a,c,u,h,d])}var o3=r=>{const{children:e,contexts:t}=r;return w.jsx(Ei.Provider,{value:t.canUseRemotionHooksContext,children:w.jsx(To.Provider,{value:t.nonceContext,children:w.jsx(gu.Provider,{value:t.preloadContext,children:w.jsx(Ns.Provider,{value:t.compositionManagerCtx,children:w.jsx(Co.Provider,{value:t.sequenceManagerContext,children:w.jsx(ki.Provider,{value:t.renderAssetManagerContext,children:w.jsx(hu.Provider,{value:t.resolveCompositionContext,children:w.jsx(_n.Provider,{value:t.timelineContext,children:w.jsx(Eo.Provider,{value:t.setTimelineContext,children:w.jsx(fr.Provider,{value:t.sequenceContext,children:w.jsx(Io.Provider,{value:t.bufferManagerContext,children:e})})})})})})})})})})})},Pe={useUnsafeVideoConfig:fu,Timeline:jb,CompositionManager:Ns,SequenceManager:Co,SequenceVisibilityToggleContext:qa,RemotionRoot:JR,useVideo:du,getRoot:KR,useMediaVolumeState:xp,useMediaMutedState:Sp,useLazyComponent:uw,truthy:lu,SequenceContext:fr,useRemotionContexts:i3,RemotionContextProvider:o3,CSSUtils:gw,setupEnvVariables:e3,MediaVolumeContext:wp,SetMediaVolumeContext:_p,getRemotionEnvironment:Bt,SharedAudioContext:vu,SharedAudioContextProvider:lw,invalidCompositionErrorMessage:BR,isCompositionIdValid:dw,getPreviewDomElement:GR,compositionsRef:fw,portalNode:tf,waitForRoot:ZR,CanUseRemotionHooksProvider:Jd,CanUseRemotionHooks:Ei,PrefetchProvider:Jb,DurationsContextProvider:Qb,IsPlayerContextProvider:PD,useIsPlayer:cp,EditorPropsProvider:Fb,EditorPropsContext:uu,usePreload:ko,NonceContext:To,resolveVideoConfig:Hb,useResolvedVideoConfig:hp,resolveCompositionsRef:zb,ResolveCompositionConfig:Ub,REMOTION_STUDIO_CONTAINER_ELEMENT:mw,RenderAssetManager:ki,persistCurrentFrame:$b,useTimelineSetFrame:Gb,isIosSafari:mu,WATCH_REMOTION_STATIC_FILES:s3,addSequenceStackTraces:Ga,useMediaStartsAt:Oo,BufferingProvider:tw,BufferingContextReact:Io,enableSequenceStackTraces:Db,CurrentScaleContext:t3,PreviewSizeContext:r3,calculateScale:n3,editorPropsProviderRef:Lb,PROPS_UPDATED_EXTERNALLY:YD,validateRenderAsset:qb},a3=({src:r,transparent:e,currentTime:t,toneMapped:n})=>`http://localhost:${window.remotion_proxyPort}/proxy?src=${encodeURIComponent(os(r))}&time=${encodeURIComponent(t)}&transparent=${String(e)}&toneMapped=${String(n)}`,vw=m.createContext(!1),c3=({children:r})=>w.jsx(vw.Provider,{value:!1,children:r}),l3=()=>{if(!Me.useContext(vw))throw new Error("This component must be inside a <Series /> component.")},u3=({children:r},e)=>(l3(),w.jsx(c3,{children:r})),h3=m.forwardRef(u3);Ga(h3);var d3=({onError:r,volume:e,playbackRate:t,src:n,muted:s,allowAmplificationDuringRender:i,transparent:a=!1,toneMapped:c=!0,toneFrequency:u,name:h,loopVolumeCurveBehavior:d,delayRenderRetries:p,delayRenderTimeoutInMilliseconds:g,onVideoFrame:v,...b})=>{const x=Ti(),C=Vs(),T=Ka(d??"repeat"),k=fu(),A=m.useContext(fr),I=Oo(),{registerRenderAsset:D,unregisterRenderAsset:F}=m.useContext(ki);if(!n)throw new TypeError("No `src` was passed to <OffthreadVideo>.");const U=m.useMemo(()=>`offthreadvideo-${Oi(n??"")}-${A?.cumulatedFrom}-${A?.relativeFrom}-${A?.durationInFrames}`,[n,A?.cumulatedFrom,A?.relativeFrom,A?.durationInFrames]);if(!k)throw new Error("No video config found");const B=Ao({volume:e,frame:T,mediaVolume:1,allowAmplificationDuringRender:i??!1});m.useEffect(()=>{if(!n)throw new Error("No src passed");if(window.remotion_audioEnabled&&!s&&!(B<=0))return D({type:"video",src:os(n),id:U,frame:x,volume:B,mediaFrame:C,playbackRate:t??1,allowAmplificationDuringRender:i??!1,toneFrequency:u??null,audioStartFrame:Math.max(0,-(A?.relativeFrom??0))}),()=>F(U)},[s,n,D,U,F,B,C,x,t,i,u,A?.relativeFrom]);const X=m.useMemo(()=>nw({frame:C,playbackRate:t||1,startFrom:-I})/k.fps,[C,I,t,k.fps]),Y=m.useMemo(()=>a3({src:n,currentTime:X,transparent:a,toneMapped:c}),[c,X,n,a]),[Z,G]=m.useState(null);m.useLayoutEffect(()=>{if(!window.remotion_videoEnabled)return;const Q=[];G(null);const ge=new AbortController,de=As(`Fetching ${Y} from server`,{retries:p??void 0,timeoutInMilliseconds:g??void 0});return(async()=>{try{const M=await fetch(Y,{signal:ge.signal});if(M.status!==200){if(M.status===500){const fe=await M.json();if(fe.error){const be=fe.error.replace(/^Error: /,"");throw new Error(be)}}throw new Error(`Server returned status ${M.status} while fetching ${Y}`)}const z=await M.blob(),ce=URL.createObjectURL(z);Q.push(()=>URL.revokeObjectURL(ce)),G({src:ce,handle:de})}catch(M){if(M.message.includes("aborted")){kt(de);return}if(ge.signal.aborted){kt(de);return}M.message.includes("Failed to fetch")&&(M=new Error(`Failed to fetch ${Y}. This could be caused by Chrome rejecting the request because the disk space is low. Consider increasing the disk size of your environment.`,{cause:M})),r?r(M):Ia(M)}})(),Q.push(()=>{ge.signal.aborted||ge.abort()}),()=>{Q.forEach(M=>M())}},[Y,p,g,r]);const K=m.useCallback(()=>{r?r?.(new Error("Failed to load image with src "+Z)):Ia("Failed to load image with src "+Z)},[Z,r]),oe=m.useMemo(()=>[Rl,b.className].filter(lu).join(" "),[b.className]),ve=m.useCallback(Q=>{v&&v(Q)},[v]);return!Z||!window.remotion_videoEnabled?null:(kt(Z.handle),w.jsx(pw,{src:Z.src,className:oe,delayRenderRetries:p,delayRenderTimeoutInMilliseconds:g,onImageFrame:ve,...b,onError:K}))},f3=({ref:r,onVideoFrame:e})=>{m.useEffect(()=>{const{current:t}=r;if(!t||!e)return;let n=0;const s=()=>{r.current&&(e(r.current),n=r.current.requestVideoFrameCallback(s))};return s(),()=>{t.cancelVideoFrameCallback(n)}},[e,r])},p3=(r,e)=>{const t=m.useRef(null),{volume:n,muted:s,playbackRate:i,onlyWarnForMediaSeekingError:a,src:c,onDuration:u,acceptableTimeShift:h,acceptableTimeShiftInSeconds:d,toneFrequency:p,name:g,_remotionInternalNativeLoopPassed:v,_remotionInternalStack:b,_remotionDebugSeeking:x,style:C,pauseWhenBuffering:T,showInTimeline:k,loopVolumeCurveBehavior:A,onError:I,onAutoPlayError:D,onVideoFrame:F,crossOrigin:U,...B}=r,X=Ka(A??"repeat"),{fps:Y,durationInFrames:Z}=Bs(),G=m.useContext(fr),{hidden:K}=m.useContext(qa),[oe]=m.useState(()=>String(Math.random())),ve=K[oe]??!1;if(typeof h<"u")throw new Error("acceptableTimeShift has been removed. Use acceptableTimeShiftInSeconds instead.");const Q=aw(t),[ge]=xp(),[de]=Sp();ew({mediaRef:t,volume:n,mediaVolume:ge,mediaType:"video",src:c,playbackRate:r.playbackRate??1,displayName:g??null,id:oe,stack:b,showInTimeline:k,premountDisplay:null,onAutoPlayError:D??null}),cw({volumePropFrame:X,actualVolume:Q,volume:n,mediaVolume:ge,mediaRef:t}),ow({mediaRef:t,src:c,mediaType:"video",playbackRate:r.playbackRate??1,onlyWarnForMediaSeekingError:a,acceptableTimeshift:d??yp,isPremounting:!!G?.premounting,pauseWhenBuffering:T,debugSeeking:x,onAutoPlayError:D??null});const ne=G?G.relativeFrom:0,M=G?Math.min(G.durationInFrames,Z):Z,z=bR({actualSrc:ko(c),actualFrom:ne,duration:M,fps:Y});m.useImperativeHandle(e,()=>t.current,[]),m.useEffect(()=>{const{current:ye}=t;if(!ye)return;const ue=()=>{if(ye.error){if(console.error("Error occurred in video",ye?.error),I){const Xe=new Error(`Code ${ye.error.code}: ${ye.error.message}`);I(Xe);return}throw new Error(`The browser threw an error while playing the video ${c}: Code ${ye.error.code} - ${ye?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else{if(I){const Xe=new Error(`The browser threw an error while playing the video ${c}`);I(Xe);return}throw new Error("The browser threw an error while playing the video")}};return ye.addEventListener("error",ue,{once:!0}),()=>{ye.removeEventListener("error",ue)}},[I,c]);const ce=m.useRef();ce.current=u,f3({ref:t,onVideoFrame:F}),m.useEffect(()=>{const{current:ye}=t;if(!ye)return;if(ye.duration){ce.current?.(c,ye.duration);return}const ue=()=>{ce.current?.(c,ye.duration)};return ye.addEventListener("loadedmetadata",ue),()=>{ye.removeEventListener("loadedmetadata",ue)}},[c]),m.useEffect(()=>{const{current:ye}=t;ye&&(mu()?ye.preload="metadata":ye.preload="auto")},[]);const fe=m.useMemo(()=>({...C,opacity:ve?0:C?.opacity??1}),[ve,C]),be=U??(F?"anonymous":void 0);return w.jsx("video",{ref:t,muted:s||de,playsInline:!0,src:z,loop:v,style:fe,disableRemotePlayback:!0,crossOrigin:be,...B})},yw=m.forwardRef(p3),bw=r=>{const{startFrom:e,endAt:t,name:n,pauseWhenBuffering:s,stack:i,showInTimeline:a,...c}=r,u=Bt(),h=m.useCallback(()=>{},[]);if(typeof r.src!="string")throw new TypeError(`The \`<OffthreadVideo>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);if(r.imageFormat)throw new TypeError("The `<OffthreadVideo>` tag does no longer accept `imageFormat`. Use the `transparent` prop if you want to render a transparent video.");if(typeof e<"u"||typeof t<"u"){gp(e,t);const T=e??0,k=t??1/0;return w.jsx(Dn,{layout:"none",from:0-T,showInTimeline:!1,durationInFrames:k,name:n,children:w.jsx(bw,{pauseWhenBuffering:s??!1,...c})})}if(pp(r,"Video"),u.isRendering)return w.jsx(d3,{...c});const{transparent:d,toneMapped:p,_remotionDebugSeeking:g,onAutoPlayError:v,onVideoFrame:b,crossOrigin:x,...C}=c;return w.jsx(yw,{_remotionInternalStack:i??null,_remotionInternalNativeLoopPassed:!1,_remotionDebugSeeking:g??!1,onDuration:h,onlyWarnForMediaSeekingError:!0,pauseWhenBuffering:s??!1,showInTimeline:a??!0,onAutoPlayError:v??void 0,onVideoFrame:b??null,crossOrigin:x,...C})},E0=r=>Math.round(r*1e5)/1e5,od=(r,e)=>{if(bp(r.currentTime,e))return{wait:Promise.resolve(e),cancel:()=>{}};r.currentTime=e;let t,n=null;const s=new Promise(a=>{t=r.requestVideoFrameCallback((c,u)=>{const h=u.expectedDisplayTime-c;if(h<=0){a(u.mediaTime);return}setTimeout(()=>{a(u.mediaTime)},h+150)})}),i=new Promise(a=>{const c=()=>{a()};r.addEventListener("seeked",c,{once:!0}),n=()=>{r.removeEventListener("seeked",c)}});return{wait:Promise.all([s,i]).then(([a])=>a),cancel:()=>{n?.(),r.cancelVideoFrameCallback(t)}}},g3=(r,e,t)=>{const n=1/t/2;let s=()=>{};return Number.isFinite(r.duration)&&r.currentTime>=r.duration&&e>=r.duration?{prom:Promise.resolve(),cancel:()=>{}}:{prom:new Promise((a,c)=>{const u=od(r,e+n);u.wait.then(h=>{if(Math.abs(e-h)<=n)return a();const p=e>h?1:-1,g=od(r,h+n*p);s=g.cancel,g.wait.then(v=>{const b=Math.abs(e-v);if(E0(b)<=E0(n))return a();const x=od(r,e+n);return s=x.cancel,x.wait.then(()=>{a()}).catch(C=>{c(C)})}).catch(v=>{c(v)})}),s=u.cancel}),cancel:()=>{s()}}},m3=({onError:r,volume:e,allowAmplificationDuringRender:t,playbackRate:n,onDuration:s,toneFrequency:i,name:a,acceptableTimeShiftInSeconds:c,delayRenderRetries:u,delayRenderTimeoutInMilliseconds:h,loopVolumeCurveBehavior:d,...p},g)=>{const v=Ti(),b=Vs(),x=Ka(d??"repeat"),C=fu(),T=m.useRef(null),k=m.useContext(fr),A=Oo(),I=Bt(),{registerRenderAsset:D,unregisterRenderAsset:F}=m.useContext(ki),U=m.useMemo(()=>`video-${Oi(p.src??"")}-${k?.cumulatedFrom}-${k?.relativeFrom}-${k?.durationInFrames}`,[p.src,k?.cumulatedFrom,k?.relativeFrom,k?.durationInFrames]);if(!C)throw new Error("No video config found");const B=Ao({volume:e,frame:x,mediaVolume:1,allowAmplificationDuringRender:t??!1});m.useEffect(()=>{if(!p.src)throw new Error("No src passed");if(!p.muted&&!(B<=0)&&window.remotion_audioEnabled)return D({type:"video",src:os(p.src),id:U,frame:v,volume:B,mediaFrame:b,playbackRate:n??1,allowAmplificationDuringRender:t??!1,toneFrequency:i??null,audioStartFrame:Math.max(0,-(k?.relativeFrom??0))}),()=>F(U)},[p.muted,p.src,D,U,F,B,b,v,n,t,i,k?.relativeFrom]),m.useImperativeHandle(g,()=>T.current,[]),m.useEffect(()=>{if(!window.remotion_videoEnabled)return;const{current:Y}=T;if(!Y)return;const Z=sw({frame:b,playbackRate:n||1,startFrom:-A,fps:C.fps}),G=As(`Rendering <Video /> with src="${p.src}" at time ${Z}`,{retries:u??void 0,timeoutInMilliseconds:h??void 0});if(window.process?.env?.NODE_ENV==="test"){kt(G);return}if(bp(Y.currentTime,Z)){if(Y.readyState>=2){kt(G);return}const Q=()=>{kt(G)};return Y.addEventListener("loadeddata",Q,{once:!0}),()=>{Y.removeEventListener("loadeddata",Q)}}const K=()=>{kt(G)},oe=g3(Y,Z,C.fps);oe.prom.then(()=>{kt(G)}),Y.addEventListener("ended",K,{once:!0});const ve=()=>{if(Y?.error){if(console.error("Error occurred in video",Y?.error),r)return;throw new Error(`The browser threw an error while playing the video ${p.src}: Code ${Y.error.code} - ${Y?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else throw new Error("The browser threw an error")};return Y.addEventListener("error",ve,{once:!0}),()=>{oe.cancel(),Y.removeEventListener("ended",K),Y.removeEventListener("error",ve),kt(G)}},[x,p.src,n,C.fps,b,A,r,u,h]);const{src:X}=p;return I.isRendering&&m.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test")return;const Y=As("Loading <Video> duration with src="+X,{retries:u??void 0,timeoutInMilliseconds:h??void 0}),{current:Z}=T,G=()=>{Z?.duration&&s(X,Z.duration),kt(Y)};return Z?.duration?(s(X,Z.duration),kt(Y)):Z?.addEventListener("loadedmetadata",G,{once:!0}),()=>{Z?.removeEventListener("loadedmetadata",G),kt(Y)}},[X,s,u,h]),w.jsx("video",{ref:T,disableRemotePlayback:!0,...p})},v3=m.forwardRef(m3),y3=(r,e)=>{const{startFrom:t,endAt:n,name:s,pauseWhenBuffering:i,stack:a,_remotionInternalNativeLoopPassed:c,showInTimeline:u,onAutoPlayError:h,...d}=r,{loop:p,_remotionDebugSeeking:g,...v}=r,{fps:b}=Bs(),x=Bt(),{durations:C,setDurations:T}=m.useContext(mp);if(typeof e=="string")throw new Error("string refs are not supported");if(typeof r.src!="string")throw new TypeError(`The \`<Video>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const k=ko(r.src),A=m.useCallback((F,U)=>{T({type:"got-duration",durationInSeconds:U,src:F})},[T]),I=m.useCallback(()=>{},[]),D=C[os(k)]??C[os(r.src)];if(p&&D!==void 0){if(!Number.isFinite(D))return w.jsx(Sl,{...v,ref:e,_remotionInternalNativeLoopPassed:!0});const F=D*b;return w.jsx(pu,{durationInFrames:Kb({endAt:n,mediaDuration:F,playbackRate:r.playbackRate??1,startFrom:t}),layout:"none",name:s,children:w.jsx(Sl,{...v,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof t<"u"||typeof n<"u"){gp(t,n);const F=t??0,U=n??1/0;return w.jsx(Dn,{layout:"none",from:0-F,showInTimeline:!1,durationInFrames:U,name:s,children:w.jsx(Sl,{pauseWhenBuffering:i??!1,...d,ref:e})})}return pp(r,"Video"),x.isRendering?w.jsx(v3,{onDuration:A,onVideoFrame:I??null,...d,ref:e}):w.jsx(yw,{onlyWarnForMediaSeekingError:!1,...d,ref:e,onVideoFrame:null,pauseWhenBuffering:i??!1,onDuration:A,_remotionInternalStack:a??null,_remotionInternalNativeLoopPassed:c??!1,_remotionDebugSeeking:g??!1,showInTimeline:u??!0,onAutoPlayError:h??void 0})},Sl=m.forwardRef(y3);Ga(Sl);DD();var b3={},w3=new Proxy(b3,{get(r,e){return e==="Bundling"||e==="Rendering"||e==="Log"||e==="Puppeteer"||e==="Output"?w3:()=>{console.warn("  The CLI configuration has been extracted from Remotion Core."),console.warn("Update the import from the config file:"),console.warn(),console.warn("- Delete:"),console.warn('import {Config} from "remotion";'),console.warn("+ Replace:"),console.warn('import {Config} from "@remotion/cli/config";'),console.warn(),console.warn("For more information, see https://www.remotion.dev/docs/4-0-migration."),process.exit(1)}}});Ga(Dn);typeof window<"u"&&(window.remotion_renderReady=!1);typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var _3=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}};function x3(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function S3(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function C3(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`);if(t&&r>50)throw new TypeError("The FPS for a GIF cannot be higher than 50. Use the --every-nth-frame option to lower the FPS: https://remotion.dev/docs/render-as-gif")}var yu={validateFps:C3,validateDimension:x3,validateDurationInFrames:S3,validateDefaultAndInputProps:_3},nr=25,rf=16,T3=()=>w.jsx("svg",{width:nr,height:nr,viewBox:"0 0 25 25",fill:"none",children:w.jsx("path",{d:"M8 6.375C7.40904 8.17576 7.06921 10.2486 7.01438 12.3871C6.95955 14.5255 7.19163 16.6547 7.6875 18.5625C9.95364 18.2995 12.116 17.6164 14.009 16.5655C15.902 15.5147 17.4755 14.124 18.6088 12.5C17.5158 10.8949 15.9949 9.51103 14.1585 8.45082C12.3222 7.3906 10.2174 6.68116 8 6.375Z",fill:"white",stroke:"white",strokeWidth:"6.25",strokeLinejoin:"round"})}),E3=()=>w.jsxs("svg",{viewBox:"0 0 100 100",width:nr,height:nr,children:[w.jsx("rect",{x:"25",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"}),w.jsx("rect",{x:"55",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"})]}),k3=({isFullscreen:r})=>{const n=r?0:3,s=r?6*1.6:6/2,i=r?6*1.6:6*2;return w.jsxs("svg",{viewBox:"0 0 32 32",height:rf,width:rf,children:[w.jsx("path",{d:`
				M ${n} ${i}
				L ${s} ${s}
				L ${i} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),w.jsx("path",{d:`
				M ${32-n} ${i}
				L ${32-s} ${s}
				L ${32-i} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),w.jsx("path",{d:`
				M ${n} ${32-i}
				L ${s} ${32-s}
				L ${i} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),w.jsx("path",{d:`
				M ${32-n} ${32-i}
				L ${32-s} ${32-s}
				L ${32-i} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"})]})},O3=()=>w.jsx("svg",{width:nr,height:nr,viewBox:"0 0 24 24",children:w.jsx("path",{d:"M3.63 3.63a.996.996 0 000 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z",fill:"#fff"})}),A3=()=>w.jsx("svg",{width:nr,height:nr,viewBox:"0 0 24 24",children:w.jsx("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z",fill:"#fff"})}),k0="__remotion_buffering_indicator",O0="__remotion_buffering_animation",I3={width:nr,height:nr,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},M3={width:14,height:14,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},P3=({type:r})=>{const e=r==="player"?I3:M3;return w.jsxs(w.Fragment,{children:[w.jsx("style",{type:"text/css",children:`
				@keyframes ${O0} {
          0% {
            rotate: 0deg;
          }
          100% {
            rotate: 360deg;
          }
        }
        
        .${k0} {
            animation: ${O0} 1s linear infinite;
        }        
			`}),w.jsx("div",{style:e,children:w.jsx("svg",{viewBox:r==="player"?"0 0 22 22":"0 0 18 18",style:e,className:k0,children:w.jsx("path",{d:r==="player"?"M 11 4 A 7 7 0 0 1 15.1145 16.66312":"M 9 2 A 7 7 0 0 1 13.1145 14.66312",stroke:"white",strokeLinecap:"round",fill:"none",strokeWidth:3})})})]})},D3=({currentSize:r,width:e,height:t,compositionWidth:n,compositionHeight:s})=>e!==void 0&&t===void 0?{aspectRatio:[n,s].join("/")}:t!==void 0&&e===void 0?{aspectRatio:[n,s].join("/")}:r?{width:n,height:s}:{width:n,height:s},ww=({previewSize:r,compositionWidth:e,compositionHeight:t,canvasSize:n})=>{const s=Pe.calculateScale({canvasSize:n,compositionHeight:t,compositionWidth:e,previewSize:r}),i=0-(1-s)/2,a=i*e,c=i*t,u=e*s,h=t*s,d=n.width/2-u/2,p=n.height/2-h/2;return{centerX:d,centerY:p,xCorrection:a,yCorrection:c,scale:s}},_w=({config:r,style:e,canvasSize:t,overflowVisible:n,layout:s})=>r?{position:"relative",overflow:n?"visible":"hidden",...D3({compositionHeight:r.height,compositionWidth:r.width,currentSize:t,height:e?.height,width:e?.width}),opacity:s?1:0,...e}:{},xw=({config:r,canvasSize:e,layout:t,scale:n,overflowVisible:s})=>!r||!e||!t?{}:{position:"absolute",width:r.width,height:r.height,display:"flex",transform:`scale(${n})`,marginLeft:t.xCorrection,marginTop:t.yCorrection,overflow:s?"visible":"hidden"},Sw=({layout:r,scale:e,config:t,overflowVisible:n})=>{if(!r||!t)return{};const{centerX:s,centerY:i}=r;return{width:t.width*e,height:t.height*e,display:"flex",flexDirection:"column",position:"absolute",left:s,top:i,overflow:n?"visible":"hidden"}},Cw=Me.createContext(void 0),Tw=Me.createContext(void 0);class R3{listeners={ended:[],error:[],pause:[],play:[],ratechange:[],scalechange:[],seeked:[],timeupdate:[],frameupdate:[],fullscreenchange:[],volumechange:[],mutechange:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchSeek(e){this.dispatchEvent("seeked",{frame:e})}dispatchVolumeChange(e){this.dispatchEvent("volumechange",{volume:e})}dispatchPause(){this.dispatchEvent("pause",void 0)}dispatchPlay(){this.dispatchEvent("play",void 0)}dispatchEnded(){this.dispatchEvent("ended",void 0)}dispatchRateChange(e){this.dispatchEvent("ratechange",{playbackRate:e})}dispatchScaleChange(e){this.dispatchEvent("scalechange",{scale:e})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchTimeUpdate(e){this.dispatchEvent("timeupdate",e)}dispatchFrameUpdate(e){this.dispatchEvent("frameupdate",e)}dispatchFullscreenChange(e){this.dispatchEvent("fullscreenchange",e)}dispatchMuteChange(e){this.dispatchEvent("mutechange",e)}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}class j3{listeners={error:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}var Ew=r=>{const e=m.useContext(Pe.BufferingContextReact);if(!e)throw new Error("BufferingContextReact not found");m.useEffect(()=>{const t=e.listenForBuffering(()=>{e.buffering.current=!0,r.dispatchWaiting({})}),n=e.listenForResume(()=>{e.buffering.current=!1,r.dispatchResume({})});return()=>{t.remove(),n.remove()}},[e,r])},L3=({children:r,currentPlaybackRate:e})=>{const[t]=m.useState(()=>new R3);if(!m.useContext(Pe.BufferingContextReact))throw new Error("BufferingContextReact not found");return m.useEffect(()=>{e&&t.dispatchRateChange(e)},[t,e]),Ew(t),w.jsx(Cw.Provider,{value:t,children:r})},Cp=(r,e)=>{const[t,n]=m.useState(!1);return m.useEffect(()=>{const{current:s}=r;if(!s)return;let i;const a=()=>{e&&(clearTimeout(i),i=setTimeout(()=>{n(!1)},e===!0?3e3:e))},c=()=>{n(!0),a()},u=()=>{n(!1),clearTimeout(i)},h=()=>{n(!0),a()};return s.addEventListener("mouseenter",c),s.addEventListener("mouseleave",u),s.addEventListener("mousemove",h),()=>{s.removeEventListener("mouseenter",c),s.removeEventListener("mouseleave",u),s.removeEventListener("mousemove",h),clearTimeout(i)}},[e,r]),t},bu=()=>{const[r,e,t]=Pe.Timeline.usePlayingState(),[n,s]=m.useState(!1),i=Pe.Timeline.useTimelinePosition(),a=m.useRef(i),c=Pe.Timeline.useTimelineSetFrame(),u=Pe.Timeline.useTimelineSetFrame(),h=m.useContext(Pe.SharedAudioContext),{audioAndVideoTags:d}=m.useContext(Pe.Timeline.TimelineContext),p=m.useRef(i);p.current=i;const g=Pe.useVideo(),v=Pe.useUnsafeVideoConfig(),b=m.useContext(Cw),x=(v?.durationInFrames??1)-1,C=i===x,T=i===0;if(!b)throw new TypeError("Expected Player event emitter context");const k=m.useContext(Pe.BufferingContextReact);if(!k)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");const{buffering:A}=k,I=m.useCallback(G=>{g?.id&&u(K=>({...K,[g.id]:G})),p.current=G,b.dispatchSeek(G)},[b,u,g?.id]),D=m.useCallback(G=>{t.current||(s(!0),C&&I(0),h&&h.numberOfAudioTags>0&&G&&h.playAllAudios(),d.current.forEach(K=>K.play()),t.current=!0,e(!0),a.current=p.current,b.dispatchPlay())},[t,C,h,e,b,I,d]),F=m.useCallback(()=>{t.current&&(t.current=!1,e(!1),b.dispatchPause())},[b,t,e]),U=m.useCallback(()=>{t.current&&(t.current=!1,p.current=a.current,v&&(u(G=>({...G,[v.id]:a.current})),e(!1),b.dispatchPause()))},[v,b,t,e,u]),B=g?.id,X=m.useCallback(G=>{if(!B)return null;t.current||c(K=>{const oe=K[B]??window.remotion_initialFrame??0;return{...K,[B]:Math.max(0,oe-G)}})},[t,c,B]),Y=m.useCallback(G=>{if(!B)return null;t.current||c(K=>{const oe=K[B]??window.remotion_initialFrame??0;return{...K,[B]:Math.min(x,oe+G)}})},[B,t,x,c]);return m.useMemo(()=>({frameBack:X,frameForward:Y,isLastFrame:C,emitter:b,playing:r,play:D,pause:F,seek:I,isFirstFrame:T,getCurrentFrame:()=>p.current,isPlaying:()=>t.current,isBuffering:()=>A.current,pauseAndReturnToPlayStart:U,hasPlayed:n,remotionInternal_currentFrameRef:p}),[X,Y,C,b,r,D,F,I,T,U,n,t,A])},F3=({browserMediaControlsBehavior:r,videoConfig:e,playbackRate:t})=>{const{playing:n,pause:s,play:i,emitter:a,getCurrentFrame:c,seek:u}=bu();m.useEffect(()=>{navigator.mediaSession&&r.mode!=="do-nothing"&&(n?navigator.mediaSession.playbackState="playing":navigator.mediaSession.playbackState="paused")},[r.mode,n]),m.useEffect(()=>{if(!navigator.mediaSession||r.mode==="do-nothing")return;const h=()=>{e&&navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:e.durationInFrames/e.fps,playbackRate:t,position:c()/e.fps})};return a.addEventListener("timeupdate",h),()=>{a.removeEventListener("timeupdate",h)}},[r.mode,a,c,t,e]),m.useEffect(()=>{if(navigator.mediaSession&&r.mode!=="do-nothing")return navigator.mediaSession.setActionHandler("play",()=>{r.mode==="register-media-session"&&i()}),navigator.mediaSession.setActionHandler("pause",()=>{r.mode==="register-media-session"&&s()}),navigator.mediaSession.setActionHandler("seekto",h=>{r.mode==="register-media-session"&&h.seekTime!==void 0&&e&&u(Math.round(h.seekTime*e.fps))}),navigator.mediaSession.setActionHandler("seekbackward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(0,Math.round((c()-10)*e.fps)))}),navigator.mediaSession.setActionHandler("seekforward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(e.durationInFrames-1,Math.round((c()+10)*e.fps)))}),navigator.mediaSession.setActionHandler("previoustrack",()=>{r.mode==="register-media-session"&&u(0)}),()=>{navigator.mediaSession.metadata=null,navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("seekto",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null)}},[r.mode,c,s,i,u,e])},N3=({time:r,currentFrame:e,playbackSpeed:t,fps:n,actualLastFrame:s,actualFirstFrame:i,framesAdvanced:a,shouldLoop:c})=>{const h=(t<0?Math.ceil:Math.floor)(r*t/(1e3/n))-a,d=h+e,p=e>s||e<i,g=d>s||d<i,v=!c&&g&&!p;return t>0?g?{nextFrame:i,framesToAdvance:h,hasEnded:v}:{nextFrame:d,framesToAdvance:h,hasEnded:v}:g?{nextFrame:s,framesToAdvance:h,hasEnded:v}:{nextFrame:d,framesToAdvance:h,hasEnded:v}},A0=()=>typeof document>"u"?!1:document.visibilityState==="hidden",B3=()=>{const r=m.useRef(A0());return m.useEffect(()=>{const e=()=>{r.current=A0()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),r},V3=({loop:r,playbackRate:e,moveToBeginningWhenEnded:t,inFrame:n,outFrame:s,frameRef:i,browserMediaControlsBehavior:a})=>{const c=Pe.useUnsafeVideoConfig(),u=Pe.Timeline.useTimelinePosition(),{playing:h,pause:d,emitter:p}=bu(),g=Pe.Timeline.useTimelineSetFrame(),v=m.useRef(null),b=B3(),x=m.useRef(null),C=m.useContext(Pe.BufferingContextReact);if(!C)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");F3({browserMediaControlsBehavior:a,playbackRate:e,videoConfig:c}),m.useEffect(()=>{const T=C.listenForBuffering(()=>{v.current=performance.now()}),k=C.listenForResume(()=>{v.current=null});return()=>{T.remove(),k.remove()}},[C]),m.useEffect(()=>{if(!c||!h)return;let T=!1,k=null,A=performance.now(),I=0;const D=()=>{k!==null&&(k.type==="raf"?cancelAnimationFrame(k.id):clearTimeout(k.id))},F=()=>{T=!0,D()},U=()=>{const Y=performance.now()-A,Z=s??c.durationInFrames-1,G=n??0,K=i.current,{nextFrame:oe,framesToAdvance:ve,hasEnded:Q}=N3({time:Y,currentFrame:K,playbackSpeed:e,fps:c.fps,actualFirstFrame:G,actualLastFrame:Z,framesAdvanced:I,shouldLoop:r});if(I+=ve,oe!==i.current&&(!Q||t)&&g(ge=>({...ge,[c.id]:oe})),Q){F(),d(),p.dispatchEnded();return}T||B()},B=()=>{if(v.current){const Y=C.listenForResume(()=>{Y.remove(),!T&&(A=performance.now(),I=0,U())});return}b.current?k={type:"timeout",id:setTimeout(U,1e3/c.fps)}:k={type:"raf",id:requestAnimationFrame(U)}};B();const X=()=>{document.visibilityState!=="visible"&&(D(),U())};return window.addEventListener("visibilitychange",X),()=>{window.removeEventListener("visibilitychange",X),F()}},[c,r,d,h,g,p,e,n,s,t,b,i,v,C]),m.useEffect(()=>{const T=setInterval(()=>{x.current!==i.current&&(p.dispatchTimeUpdate({frame:i.current}),x.current=i.current)},250);return()=>clearInterval(T)},[p,i]),m.useEffect(()=>{p.dispatchFrameUpdate({frame:u})},[p,u])},ad=[],Tp=(r,e)=>{const[t,n]=m.useState(()=>{if(!r.current)return null;const a=r.current.getClientRects();return a[0]?{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}}:null}),s=m.useMemo(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(a=>{const{contentRect:c,target:u}=a[0],h=u.getClientRects();if(!h?.[0]){n(null);return}const d=c.width===0?1:h[0].width/c.width,p=e.shouldApplyCssTransforms?h[0].width:h[0].width*(1/d),g=e.shouldApplyCssTransforms?h[0].height:h[0].height*(1/d);n({width:p,height:g,left:h[0].x,top:h[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})}),[e.shouldApplyCssTransforms]),i=m.useCallback(()=>{if(!r.current)return;const a=r.current.getClientRects();if(!a[0]){n(null);return}n(c=>c&&c.width===a[0].width&&c.height===a[0].height&&c.left===a[0].x&&c.top===a[0].y&&c.windowSize.height===window.innerHeight&&c.windowSize.width===window.innerWidth?c:{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})},[r]);return m.useEffect(()=>{if(!s)return;const{current:a}=r;return a&&s.observe(a),()=>{a&&s.unobserve(a)}},[s,r,i]),m.useEffect(()=>{if(e.triggerOnWindowResize)return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[e.triggerOnWindowResize,i]),m.useEffect(()=>(ad.push(i),()=>{ad=ad.filter(a=>a!==i)}),[i]),m.useMemo(()=>t?{...t,refresh:i}:null,[t,i])},I0=({playing:r,buffering:e})=>r&&e?w.jsx(P3,{type:"player"}):r?w.jsx(E3,{}):w.jsx(T3,{}),Qi=12,M0=5,H3=({volume:r,isVertical:e,onBlur:t,inputRef:n,setVolume:s})=>{const i=m.useMemo(()=>{const g={paddingLeft:5,height:nr,width:ui,display:"inline-flex",alignItems:"center"};return e?{...g,position:"absolute",transform:`rotate(-90deg) translateX(${ui/2+nr/2}px)`}:{...g}},[e]),a=typeof Me.useId>"u"?"volume-slider":Me.useId(),[c]=m.useState(()=>`__remotion-volume-slider-${Oi(a)}`.replace(".","")),u=m.useCallback(p=>{s(parseFloat(p.target.value))},[s]),h=m.useMemo(()=>{const p={WebkitAppearance:"none",backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:M0/2,cursor:"pointer",height:M0,width:ui,backgroundImage:`linear-gradient(
				to right,
				white ${r*100}%, rgba(255, 255, 255, 0) ${r*100}%
			)`};return e?{...p,bottom:nr+ui/2}:p},[e,r]),d=`
	.${c}::-webkit-slider-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${Qi/2}px;
		box-shadow: 0 0 2px black;
		height: ${Qi}px;
		width: ${Qi}px;
	}

	.${c}::-moz-range-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${Qi/2}px;
		box-shadow: 0 0 2px black;
		height: ${Qi}px;
		width: ${Qi}px;
	}
`;return w.jsxs("div",{style:i,children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:d}}),w.jsx("input",{ref:n,"aria-label":"Change volume",className:c,max:1,min:0,onBlur:t,onChange:u,step:.01,type:"range",value:r,style:h})]})},z3=r=>w.jsx(H3,{...r}),ui=100,W3=({displayVerticalVolumeSlider:r,renderMuteButton:e,renderVolumeSlider:t})=>{const[n,s]=Pe.useMediaMutedState(),[i,a]=Pe.useMediaVolumeState(),[c,u]=m.useState(!1),h=m.useRef(null),d=m.useRef(null),p=Cp(h,!1),g=m.useCallback(()=>{setTimeout(()=>{d.current&&document.activeElement!==d.current&&u(!1)},10)},[]),v=i===0,b=m.useCallback(()=>{if(v){a(1),s(!1);return}s(I=>!I)},[v,s,a]),x=m.useMemo(()=>({display:"inline-flex",background:"none",border:"none",justifyContent:"center",alignItems:"center",touchAction:"none",...r&&{position:"relative"}}),[r]),C=m.useMemo(()=>({display:"inline",width:nr,height:nr,cursor:"pointer",appearance:"none",background:"none",border:"none",padding:0}),[]),T=m.useCallback(({muted:I,volume:D})=>{const F=I||D===0;return w.jsx("button",{"aria-label":F?"Unmute sound":"Mute sound",title:F?"Unmute sound":"Mute sound",onClick:b,onBlur:g,onFocus:()=>u(!0),style:C,type:"button",children:F?w.jsx(O3,{}):w.jsx(A3,{})})},[g,b,C]),k=m.useMemo(()=>e?e({muted:n,volume:i}):T({muted:n,volume:i}),[n,i,T,e]),A=m.useMemo(()=>(c||p)&&!n&&!Pe.isIosSafari()?(t??z3)({isVertical:r,volume:i,onBlur:()=>u(!1),inputRef:d,setVolume:a}):null,[r,c,p,n,i,t,a]);return w.jsxs("div",{ref:h,style:x,children:[k,A]})};function U3(r){const[e,t]=m.useState(r),n=m.useRef(null);return m.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&t(!1)};return document.addEventListener("pointerup",s,!0),()=>{document.removeEventListener("pointerup",s,!0)}},[]),{ref:n,isComponentVisible:e,setIsComponentVisible:t}}var $3=35,Y3=70,X3={height:30,paddingRight:15,paddingLeft:12,display:"flex",flexDirection:"row",alignItems:"center"},G3={width:22,display:"flex",alignItems:"center"},q3={width:14,height:14,color:"black"},K3=()=>w.jsx("svg",{viewBox:"0 0 512 512",style:q3,children:w.jsx("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})}),Z3=({rate:r,onSelect:e,selectedRate:t,keyboardSelectedRate:n})=>{const s=m.useCallback(p=>{p.stopPropagation(),p.preventDefault(),e(r)},[e,r]),[i,a]=m.useState(!1),c=m.useCallback(()=>{a(!0)},[]),u=m.useCallback(()=>{a(!1)},[]),h=n===r,d=m.useMemo(()=>({...X3,backgroundColor:i||h?"#eee":"transparent"}),[i,h]);return w.jsxs("div",{onMouseEnter:c,onMouseLeave:u,tabIndex:0,style:d,onClick:s,children:[w.jsx("div",{style:G3,children:r===t?w.jsx(K3,{}):null}),r.toFixed(1),"x"]},r)},J3=({setIsComponentVisible:r,playbackRates:e,canvasSize:t})=>{const{setPlaybackRate:n,playbackRate:s}=m.useContext(Pe.Timeline.TimelineContext),[i,a]=m.useState(s);m.useEffect(()=>{const h=d=>{if(d.preventDefault(),d.key==="ArrowUp"){const p=e.findIndex(g=>g===i);if(p===0)return;a(p===-1?e[0]:e[p-1])}else if(d.key==="ArrowDown"){const p=e.findIndex(g=>g===i);if(p===e.length-1)return;a(p===-1?e[e.length-1]:e[p+1])}else d.key==="Enter"&&(n(i),r(!1))};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[e,i,n,r]);const c=m.useCallback(h=>{n(h),r(!1)},[r,n]),u=m.useMemo(()=>({position:"absolute",right:0,width:125,maxHeight:t.height-Y3-$3,bottom:35,background:"#fff",borderRadius:4,overflow:"auto",color:"black",textAlign:"left"}),[t.height]);return w.jsx("div",{style:u,children:e.map(h=>w.jsx(Z3,{selectedRate:s,onSelect:c,rate:h,keyboardSelectedRate:i},h))})},Q3={fontSize:13,fontWeight:"bold",color:"white",border:"2px solid white",borderRadius:20,paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2},nf={appearance:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",paddingLeft:0,paddingRight:0,paddingTop:6,paddingBottom:6,height:37,display:"inline-flex",marginBottom:0,marginTop:0,alignItems:"center"},e4={...nf,position:"relative"},t4=({playbackRates:r,canvasSize:e})=>{const{ref:t,isComponentVisible:n,setIsComponentVisible:s}=U3(!1),{playbackRate:i}=m.useContext(Pe.Timeline.TimelineContext),a=m.useCallback(c=>{c.stopPropagation(),c.preventDefault(),s(u=>!u)},[s]);return w.jsx("div",{ref:t,children:w.jsxs("button",{type:"button","aria-label":"Change playback rate",style:e4,onClick:a,children:[w.jsxs("div",{style:Q3,children:[i,"x"]}),n&&w.jsx(J3,{canvasSize:e,playbackRates:r,setIsComponentVisible:s})]})})},P0=(r,e,t)=>Math.round(rw(r,[0,t],[0,e-1],{extrapolateLeft:"clamp",extrapolateRight:"clamp"})),no=5,ca=12,sf=4,r4={userSelect:"none",WebkitUserSelect:"none",paddingTop:sf,paddingBottom:sf,boxSizing:"border-box",cursor:"pointer",position:"relative",touchAction:"none"},n4={height:no,backgroundColor:"rgba(255, 255, 255, 0.25)",width:"100%",borderRadius:no/2},s4=r=>{let e=r;for(;e.parentElement;)e=e.parentElement;return e},i4=({durationInFrames:r,onSeekEnd:e,onSeekStart:t,inFrame:n,outFrame:s})=>{const i=m.useRef(null),a=Cp(i,!1),c=Tp(i,{triggerOnWindowResize:!0,shouldApplyCssTransforms:!0}),{seek:u,play:h,pause:d,playing:p}=bu(),g=Pe.Timeline.useTimelinePosition(),[v,b]=m.useState({dragging:!1}),x=c?.width??0,C=m.useCallback(F=>{if(F.button!==0)return;const U=i.current?.getBoundingClientRect().left,B=P0(F.clientX-U,r,x);d(),u(B),b({dragging:!0,wasPlaying:p}),t()},[r,x,d,u,p,t]),T=m.useCallback(F=>{if(!c)throw new Error("Player has no size");if(!v.dragging)return;const U=i.current?.getBoundingClientRect().left,B=P0(F.clientX-U,r,c.width);u(B)},[v.dragging,r,u,c]),k=m.useCallback(()=>{b({dragging:!1}),v.dragging&&(v.wasPlaying?h():d(),e())},[v,e,d,h]);m.useEffect(()=>{if(!v.dragging)return;const F=s4(i.current);return F.addEventListener("pointermove",T),F.addEventListener("pointerup",k),()=>{F.removeEventListener("pointermove",T),F.removeEventListener("pointerup",k)}},[v.dragging,T,k]);const A=m.useMemo(()=>({height:ca,width:ca,borderRadius:ca/2,position:"absolute",top:sf-ca/2+5/2,backgroundColor:"white",left:Math.max(0,g/Math.max(1,r-1)*x-ca/2),boxShadow:"0 0 2px black",opacity:Number(a)}),[a,r,g,x]),I=m.useMemo(()=>({height:no,backgroundColor:"rgba(255, 255, 255, 1)",width:(g-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:no/2}),[r,g,n]),D=m.useMemo(()=>({height:no,backgroundColor:"rgba(255, 255, 255, 0.25)",width:((s??r-1)-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:no/2,position:"absolute"}),[r,n,s]);return w.jsxs("div",{ref:i,onPointerDown:C,style:r4,children:[w.jsxs("div",{style:n4,children:[w.jsx("div",{style:D}),w.jsx("div",{style:I})]}),w.jsx("div",{style:A})]})},D0=r=>{const e=Math.floor(r/60),t=Math.floor(r-e*60);return`${String(e)}:${String(t).padStart(2,"0")}`},o4=10,of=12,a4=({allowFullscreen:r,playerWidth:e})=>m.useMemo(()=>{const n=nr,s=nr,i=r?rf:0,a=s+n+i+of*2+o4*2,c=e-a,u=Math.max(c,0),h=u-ui,p=(h<ui?u:h)+a+ui,g=e<p;return{maxTimeLabelWidth:u===0?null:u,displayVerticalVolumeSlider:g}},[r,e]),c4=[0,.013,.049,.104,.175,.259,.352,.45,.55,.648,.741,.825,.896,.951,.987],l4=[0,8.1,15.5,22.5,29,35.3,41.2,47.1,52.9,58.8,64.7,71,77.5,84.5,91.9],u4=1/.7,h4={boxSizing:"border-box",position:"absolute",bottom:0,width:"100%",paddingTop:40,paddingBottom:10,backgroundImage:`linear-gradient(to bottom,${c4.map((r,e)=>`hsla(0, 0%, 0%, ${r}) ${l4[e]*u4}%`).join(", ")}, hsl(0, 0%, 0%) 100%)`,backgroundSize:"auto 145px",display:"flex",paddingRight:of,paddingLeft:of,flexDirection:"column",transition:"opacity 0.3s"},d4={display:"flex",flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none"},f4={display:"flex",flexDirection:"row",userSelect:"none",WebkitUserSelect:"none",alignItems:"center"},qc={width:12},p4={height:8},g4={flex:1},m4={},v4=({durationInFrames:r,isFullscreen:e,fps:t,player:n,showVolumeControls:s,onFullscreenButtonClick:i,allowFullscreen:a,onExitFullscreenButtonClick:c,spaceKeyToPlayOrPause:u,onSeekEnd:h,onSeekStart:d,inFrame:p,outFrame:g,initiallyShowControls:v,canvasSize:b,renderPlayPauseButton:x,renderFullscreenButton:C,alwaysShowControls:T,showPlaybackRateControl:k,containerRef:A,buffering:I,hideControlsWhenPointerDoesntMove:D,onPointerDown:F,onDoubleClick:U,renderMuteButton:B,renderVolumeSlider:X})=>{const Y=m.useRef(null),Z=Pe.Timeline.useTimelinePosition(),[G,K]=m.useState(!1),oe=Cp(A,D),{maxTimeLabelWidth:ve,displayVerticalVolumeSlider:Q}=a4({allowFullscreen:a,playerWidth:b?.width??0}),[ge,de]=m.useState(()=>{if(typeof v=="boolean")return v;if(typeof v=="number"){if(v%1!==0)throw new Error("initiallyShowControls must be an integer or a boolean");if(Number.isNaN(v))throw new Error("initiallyShowControls must not be NaN");if(!Number.isFinite(v))throw new Error("initiallyShowControls must be finite");if(v<=0)throw new Error("initiallyShowControls must be a positive integer");return v}throw new TypeError("initiallyShowControls must be a number or a boolean")}),ne=m.useMemo(()=>{const ue=oe||!n.playing||ge||T;return{...h4,opacity:Number(ue)}},[oe,ge,n.playing,T]);m.useEffect(()=>{Y.current&&u&&Y.current.focus({preventScroll:!0})},[n.playing,u]),m.useEffect(()=>{K((typeof document<"u"&&(document.fullscreenEnabled||document.webkitFullscreenEnabled))??!1)},[]),m.useEffect(()=>{if(ge===!1)return;const Xe=setTimeout(()=>{de(!1)},ge===!0?2e3:ge);return()=>{clearInterval(Xe)}},[ge]);const M=m.useMemo(()=>({color:"white",fontFamily:"sans-serif",fontSize:14,maxWidth:ve===null?void 0:ve,overflow:"hidden",textOverflow:"ellipsis"}),[ve]),z=m.useMemo(()=>{if(k===!0)return[.5,.8,1,1.2,1.5,1.8,2,2.5,3];if(Array.isArray(k)){for(const ue of k){if(typeof ue!="number")throw new Error("Every item in showPlaybackRateControl must be a number");if(ue<=0)throw new Error("Every item in showPlaybackRateControl must be positive")}return k}return null},[k]),ce=m.useRef(null),fe=m.useRef(null),be=m.useCallback(ue=>{(ue.target===ce.current||ue.target===fe.current)&&F?.(ue)},[F]),ye=m.useCallback(ue=>{(ue.target===ce.current||ue.target===fe.current)&&U?.(ue)},[U]);return w.jsxs("div",{ref:ce,style:ne,onPointerDown:be,onDoubleClick:ye,children:[w.jsxs("div",{ref:fe,style:d4,children:[w.jsxs("div",{style:f4,children:[w.jsx("button",{ref:Y,type:"button",style:nf,onClick:n.playing?n.pause:n.play,"aria-label":n.playing?"Pause video":"Play video",title:n.playing?"Pause video":"Play video",children:x===null?w.jsx(I0,{buffering:I,playing:n.playing}):x({playing:n.playing,isBuffering:I})??w.jsx(I0,{buffering:I,playing:n.playing})}),s?w.jsxs(w.Fragment,{children:[w.jsx("div",{style:qc}),w.jsx(W3,{renderMuteButton:B,renderVolumeSlider:X,displayVerticalVolumeSlider:Q})]}):null,w.jsx("div",{style:qc}),w.jsxs("div",{style:M,children:[D0(Z/t)," / ",D0(r/t)]}),w.jsx("div",{style:qc})]}),w.jsx("div",{style:g4}),z&&b&&w.jsx(t4,{canvasSize:b,playbackRates:z}),z&&G&&a?w.jsx("div",{style:qc}):null,w.jsx("div",{style:m4,children:G&&a?w.jsx("button",{type:"button","aria-label":e?"Exit fullscreen":"Enter Fullscreen",title:e?"Exit fullscreen":"Enter Fullscreen",style:nf,onClick:e?c:i,children:C===null?w.jsx(k3,{isFullscreen:e}):C({isFullscreen:e})}):null})]}),w.jsx("div",{style:p4}),w.jsx(i4,{onSeekEnd:h,onSeekStart:d,durationInFrames:r,inFrame:p,outFrame:g})]})},y4={display:"flex",justifyContent:"center",alignItems:"center",flex:1,height:"100%",width:"100%"};class kw extends Me.Component{state={hasError:null};static getDerivedStateFromError(e){return{hasError:e}}componentDidCatch(e){this.props.onError(e)}render(){return this.state.hasError?w.jsx("div",{style:y4,children:this.props.errorFallback({error:this.state.hasError})}):this.props.children}}var Ep="__remotion-player",Ow=typeof document>"u",b4=r=>{let e=!1;return{promise:new Promise((n,s)=>{r.then(i=>{if(e){s({isCanceled:e,value:i});return}n(i)}).catch(i=>{s({isCanceled:e,error:i})})}),cancel:()=>{e=!0}}},w4=r=>new Promise(e=>setTimeout(e,r)),_4=()=>{const r=m.useRef([]),e=m.useCallback(i=>{r.current=[...r.current,i]},[]),t=m.useCallback(i=>{r.current=r.current.filter(a=>a!==i)},[]),n=m.useCallback(()=>r.current.map(i=>i.cancel()),[]);return m.useMemo(()=>({appendPendingPromise:e,removePendingPromise:t,clearPendingPromises:n}),[e,n,t])},x4=(r,e,t)=>{const n=_4(),s=m.useCallback(async u=>{if(u instanceof PointerEvent?u.pointerType==="touch":u.nativeEvent.pointerType==="touch"){r(u);return}n.clearPendingPromises();const h=b4(w4(200));n.appendPendingPromise(h);try{await h.promise,n.removePendingPromise(h),r(u)}catch(d){const p=d;if(n.removePendingPromise(h),!p.isCanceled)throw p.error}},[n,r]),i=m.useCallback(()=>{document.addEventListener("pointerup",u=>{s(u)},{once:!0})},[s]),a=m.useCallback(()=>{n.clearPendingPromises(),e()},[n,e]);return m.useMemo(()=>t?{handlePointerDown:i,handleDoubleClick:a}:{handlePointerDown:r,handleDoubleClick:()=>{}},[t,a,i,r])},af=Me.version.split(".")[0];if(af==="0")throw new Error(`Version ${af} of "react" is not supported by Remotion`);var S4=parseInt(af,10)>=18,C4=({controls:r,style:e,loop:t,autoPlay:n,allowFullscreen:s,inputProps:i,clickToPlay:a,showVolumeControls:c,doubleClickToFullscreen:u,spaceKeyToPlayOrPause:h,errorFallback:d,playbackRate:p,renderLoading:g,renderPoster:v,className:b,moveToBeginningWhenEnded:x,showPosterWhenUnplayed:C,showPosterWhenEnded:T,showPosterWhenPaused:k,showPosterWhenBuffering:A,inFrame:I,outFrame:D,initiallyShowControls:F,renderFullscreen:U,renderPlayPauseButton:B,renderMuteButton:X,renderVolumeSlider:Y,alwaysShowControls:Z,showPlaybackRateControl:G,posterFillMode:K,bufferStateDelayInMilliseconds:oe,hideControlsWhenPointerDoesntMove:ve,overflowVisible:Q,browserMediaControlsBehavior:ge},de)=>{const ne=Pe.useUnsafeVideoConfig(),M=Pe.useVideo(),z=m.useRef(null),ce=Tp(z,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),[fe,be]=m.useState(!1),[ye,ue]=m.useState(n),[Xe,ze]=m.useState(()=>!1),[bt,wt]=m.useState(!1),Vt=m.useMemo(()=>typeof document>"u"?!1:!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),[]),Ce=bu();V3({loop:t,playbackRate:p,moveToBeginningWhenEnded:x,inFrame:I,outFrame:D,frameRef:Ce.remotionInternal_currentFrameRef,browserMediaControlsBehavior:ge}),m.useEffect(()=>{fe&&!Ce.playing&&(be(!1),Ce.play())},[fe,Ce]),m.useEffect(()=>{const{current:qe}=z;if(!qe)return;const $e=()=>{const Zt=document.fullscreenElement===qe||document.webkitFullscreenElement===qe;ze(Zt)};return document.addEventListener("fullscreenchange",$e),document.addEventListener("webkitfullscreenchange",$e),()=>{document.removeEventListener("fullscreenchange",$e),document.removeEventListener("webkitfullscreenchange",$e)}},[]);const qt=m.useCallback(qe=>{Ce.isPlaying()?Ce.pause():Ce.play(qe)},[Ce]),it=m.useCallback(()=>{if(!s)throw new Error("allowFullscreen is false");if(!Vt)throw new Error("Browser doesnt support fullscreen");if(!z.current)throw new Error("No player ref found");z.current.webkitRequestFullScreen?z.current.webkitRequestFullScreen():z.current.requestFullscreen()},[s,Vt]),Tt=m.useCallback(()=>{document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen()},[]);m.useEffect(()=>{const{current:qe}=z;if(!qe)return;const $e=()=>{const Zt=document.webkitFullscreenElement??document.fullscreenElement;Zt&&Zt===z.current?Ce.emitter.dispatchFullscreenChange({isFullscreen:!0}):Ce.emitter.dispatchFullscreenChange({isFullscreen:!1})};return qe.addEventListener("webkitfullscreenchange",$e),qe.addEventListener("fullscreenchange",$e),()=>{qe.removeEventListener("webkitfullscreenchange",$e),qe.removeEventListener("fullscreenchange",$e)}},[Ce.emitter]);const Tr=ne?.durationInFrames??1,tt=m.useMemo(()=>!ne||!ce?null:ww({canvasSize:ce,compositionHeight:ne.height,compositionWidth:ne.width,previewSize:"auto"}),[ce,ne]),Pt=tt?.scale??1,Gr=m.useRef(!1);m.useEffect(()=>{if(!Gr.current){Gr.current=!0;return}Ce.emitter.dispatchScaleChange(Pt)},[Ce.emitter,Pt]);const{setMediaVolume:sr,setMediaMuted:R}=m.useContext(Pe.SetMediaVolumeContext),{mediaMuted:he,mediaVolume:pe}=m.useContext(Pe.MediaVolumeContext);m.useEffect(()=>{Ce.emitter.dispatchVolumeChange(pe)},[Ce.emitter,pe]);const De=he||pe===0;m.useEffect(()=>{Ce.emitter.dispatchMuteChange({isMuted:De})},[Ce.emitter,De]);const[Je,Ge]=m.useState(!1);m.useEffect(()=>{let qe=null,$e=!1;const Zt=()=>{$e=!1,requestAnimationFrame(()=>{oe===0?Ge(!0):qe=setTimeout(()=>{$e||Ge(!0)},oe)})},pr=()=>{requestAnimationFrame(()=>{$e=!0,Ge(!1),qe&&clearTimeout(qe)})};return Ce.emitter.addEventListener("waiting",Zt),Ce.emitter.addEventListener("resume",pr),()=>{Ce.emitter.removeEventListener("waiting",Zt),Ce.emitter.removeEventListener("resume",pr),Ge(!1),qe&&clearTimeout(qe),$e=!0}},[oe,Ce.emitter]),m.useImperativeHandle(de,()=>{const qe={play:Ce.play,pause:()=>{be(!1),Ce.pause()},toggle:qt,getContainerNode:()=>z.current,getCurrentFrame:Ce.getCurrentFrame,isPlaying:Ce.isPlaying,seekTo:$e=>{const Zt=Tr-1,pr=Math.max(0,Math.min(Zt,$e));Ce.isPlaying()&&(be(pr!==Zt||t),Ce.pause()),pr===Zt&&!t&&Ce.emitter.dispatchEnded(),Ce.seek(pr)},isFullscreen:()=>{const{current:$e}=z;return $e?document.fullscreenElement===$e||document.webkitFullscreenElement===$e:!1},requestFullscreen:it,exitFullscreen:Tt,getVolume:()=>he?0:pe,setVolume:$e=>{if(typeof $e!="number")throw new TypeError(`setVolume() takes a number, got value of type ${typeof $e}`);if(isNaN($e))throw new TypeError("setVolume() got a number that is NaN. Volume must be between 0 and 1.");if($e<0||$e>1)throw new TypeError(`setVolume() got a number that is out of range. Must be between 0 and 1, got ${typeof $e}`);sr($e)},isMuted:()=>De,mute:()=>{R(!0)},unmute:()=>{R(!1)},getScale:()=>Pt,pauseAndReturnToPlayStart:()=>{Ce.pauseAndReturnToPlayStart()}};return Object.assign(Ce.emitter,qe)},[Tr,Tt,t,he,De,pe,Ce,it,R,sr,qt,Pt]);const ke=M?M.component:null,_e=m.useMemo(()=>_w({canvasSize:ce,config:ne,style:e,overflowVisible:Q,layout:tt}),[ce,ne,tt,Q,e]),Ht=m.useMemo(()=>Sw({config:ne,layout:tt,scale:Pt,overflowVisible:Q}),[ne,tt,Q,Pt]),_t=m.useMemo(()=>xw({canvasSize:ce,config:ne,layout:tt,scale:Pt,overflowVisible:Q}),[ce,ne,tt,Q,Pt]),zt=m.useCallback(qe=>{Ce.pause(),Ce.emitter.dispatchError(qe)},[Ce]),Er=m.useCallback(qe=>{qe.stopPropagation(),it()},[it]),Qt=m.useCallback(qe=>{qe.stopPropagation(),Tt()},[Tt]),jr=m.useCallback(qe=>{(qe instanceof MouseEvent?qe.button===2:qe.nativeEvent.button)||qt(qe)},[qt]),Kt=m.useCallback(()=>{wt(!0)},[]),hs=m.useCallback(()=>{wt(!1)},[]),ds=m.useCallback(()=>{Xe?Tt():it()},[Tt,Xe,it]),{handlePointerDown:Vn,handleDoubleClick:kn}=x4(jr,ds,u&&s&&Vt);m.useEffect(()=>{ye&&(Ce.play(),ue(!1))},[ye,Ce]);const Ri=m.useMemo(()=>g?g({height:_e.height,width:_e.width,isBuffering:Je}):null,[_e.height,_e.width,g,Je]),fs=m.useMemo(()=>({type:"scale",scale:Pt}),[Pt]);if(!ne)return null;const hn=v?v({height:K==="player-size"?_e.height:ne.height,width:K==="player-size"?_e.width:ne.width,isBuffering:Je}):null;if(hn===void 0)throw new TypeError("renderPoster() must return a React element, but undefined was returned");const ji=hn&&[k&&!Ce.isPlaying()&&!bt,T&&Ce.isLastFrame&&!Ce.isPlaying(),C&&!Ce.hasPlayed&&!Ce.isPlaying(),A&&Je&&Ce.isPlaying()].some(Boolean),{left:No,top:Bo,width:Vo,height:Li,...Fi}=Ht,Us=w.jsxs(w.Fragment,{children:[w.jsx("div",{style:Ht,onPointerDown:a?Vn:void 0,onDoubleClick:u?kn:void 0,children:w.jsxs("div",{style:_t,className:Ep,children:[ke?w.jsx(kw,{onError:zt,errorFallback:d,children:w.jsx(Pe.CurrentScaleContext.Provider,{value:fs,children:w.jsx(ke,{...M?.props??{},...i??{}})})}):null,ji&&K==="composition-size"?w.jsx("div",{style:{...Fi,width:ne.width,height:ne.height},onPointerDown:a?Vn:void 0,onDoubleClick:u?kn:void 0,children:hn}):null]})}),ji&&K==="player-size"?w.jsx("div",{style:Ht,onPointerDown:a?Vn:void 0,onDoubleClick:u?kn:void 0,children:hn}):null,r?w.jsx(v4,{fps:ne.fps,durationInFrames:ne.durationInFrames,player:Ce,containerRef:z,onFullscreenButtonClick:Er,isFullscreen:Xe,allowFullscreen:s,showVolumeControls:c,onExitFullscreenButtonClick:Qt,spaceKeyToPlayOrPause:h,onSeekEnd:hs,onSeekStart:Kt,inFrame:I,outFrame:D,initiallyShowControls:F,canvasSize:ce,renderFullscreenButton:U,renderPlayPauseButton:B,alwaysShowControls:Z,showPlaybackRateControl:G,buffering:Je,hideControlsWhenPointerDoesntMove:ve,onDoubleClick:u?kn:void 0,onPointerDown:a?Vn:void 0,renderMuteButton:X,renderVolumeSlider:Y}):null]});return Ow&&!S4?w.jsx("div",{ref:z,style:_e,className:b,children:Us}):w.jsx("div",{ref:z,style:_e,className:b,children:w.jsx(m.Suspense,{fallback:Ri,children:Us})})},T4=m.forwardRef(C4),Aw="remotion.volumePreference",E4=r=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Aw,String(r))}catch(e){console.log("Could not persist volume",e)}},k4=()=>{if(typeof window>"u")return 1;try{const r=window.localStorage.getItem(Aw);return r?Number(r):1}catch{return 1}},kp="player-comp",Iw=({children:r,timelineContext:e,fps:t,compositionHeight:n,compositionWidth:s,durationInFrames:i,component:a,numberOfSharedAudioTags:c,initiallyMuted:u})=>{const h=m.useMemo(()=>({compositions:[{component:a,durationInFrames:i,height:n,width:s,fps:t,id:kp,nonce:777,folderName:null,parentFolderName:null,schema:null,calculateMetadata:null}],folders:[],registerFolder:()=>{},unregisterFolder:()=>{},registerComposition:()=>{},unregisterComposition:()=>{},currentCompositionMetadata:null,setCurrentCompositionMetadata:()=>{},canvasContent:{type:"composition",compositionId:"player-comp"},setCanvasContent:()=>{},updateCompositionDefaultProps:()=>{}}),[a,i,n,s,t]),[d,p]=m.useState(()=>u),[g,v]=m.useState(()=>k4()),b=m.useMemo(()=>({mediaMuted:d,mediaVolume:g}),[d,g]),x=m.useCallback(T=>{v(T),E4(T)},[]),C=m.useMemo(()=>({setMediaMuted:p,setMediaVolume:x}),[x]);return w.jsx(Pe.CanUseRemotionHooksProvider,{children:w.jsx(Pe.Timeline.TimelineContext.Provider,{value:e,children:w.jsx(Pe.CompositionManager.Provider,{value:h,children:w.jsx(Pe.ResolveCompositionConfig,{children:w.jsx(Pe.PrefetchProvider,{children:w.jsx(Pe.DurationsContextProvider,{children:w.jsx(Pe.MediaVolumeContext.Provider,{value:b,children:w.jsx(Pe.SetMediaVolumeContext.Provider,{value:C,children:w.jsx(Pe.SharedAudioContextProvider,{numberOfAudioTags:c,component:a,children:w.jsx(Pe.BufferingProvider,{children:r})})})})})})})})})})},R0=(r,e)=>{if(typeof r>"u"||r===null)return r??null;if(typeof r!="number")throw new TypeError(`"${e}" must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new TypeError(`"${e}" must not be NaN, but is ${JSON.stringify(r)}`);if(!Number.isFinite(r))throw new TypeError(`"${e}" must be finite, but is ${JSON.stringify(r)}`);if(r%1!==0)throw new TypeError(`"${e}" must be an integer, but is ${JSON.stringify(r)}`);return r},O4=({inFrame:r,durationInFrames:e,outFrame:t})=>{const n=R0(r,"inFrame"),s=R0(t,"outFrame");if(!(n===null&&s===null)){if(n!==null&&n>e-1)throw new Error("inFrame must be less than (durationInFrames - 1), but is "+n);if(s!==null&&s>e-1)throw new Error("outFrame must be less than (durationInFrames - 1), but is "+s);if(n!==null&&n<0)throw new Error("inFrame must be greater than 0, but is "+n);if(s!==null&&s<=0)throw new Error(`outFrame must be greater than 0, but is ${s}. If you want to render a single frame, use <Thumbnail /> instead.`);if(s!==null&&n!==null&&s<=n)throw new Error("outFrame must be greater than inFrame, but is "+s+" <= "+n)}},A4=({initialFrame:r,durationInFrames:e})=>{if(typeof e!="number")throw new Error(`\`durationInFrames\` must be a number, but is ${JSON.stringify(e)}`);if(!(typeof r>"u")){if(typeof r!="number")throw new Error(`\`initialFrame\` must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new Error("`initialFrame` must be a number, but is NaN");if(!Number.isFinite(r))throw new Error("`initialFrame` must be a number, but is Infinity");if(r%1!==0)throw new Error(`\`initialFrame\` must be an integer, but is ${JSON.stringify(r)}`);if(r>e-1)throw new Error(`\`initialFrame\` must be less or equal than \`durationInFrames - 1\`, but is ${JSON.stringify(r)}`)}},I4=r=>{if(r!==void 0){if(r>4)throw new Error(`The highest possible playback rate is 4. You passed: ${r}`);if(r<-4)throw new Error(`The lowest possible playback rate is -4. You passed: ${r}`);if(r===0)throw new Error("A playback rate of 0 is not supported.")}},M4=yu.validateFps,j0=yu.validateDimension,P4=yu.validateDurationInFrames,D4=yu.validateDefaultAndInputProps,R4=r=>"component"in r?r.component:null,j4=({durationInFrames:r,compositionHeight:e,compositionWidth:t,fps:n,inputProps:s,style:i,controls:a=!1,loop:c=!1,autoPlay:u=!1,showVolumeControls:h=!0,allowFullscreen:d=!0,clickToPlay:p,doubleClickToFullscreen:g=!1,spaceKeyToPlayOrPause:v=!0,moveToBeginningWhenEnded:b=!0,numberOfSharedAudioTags:x=5,errorFallback:C=()=>"",playbackRate:T=1,renderLoading:k,className:A,showPosterWhenUnplayed:I,showPosterWhenEnded:D,showPosterWhenPaused:F,showPosterWhenBuffering:U,initialFrame:B,renderPoster:X,inFrame:Y,outFrame:Z,initiallyShowControls:G,renderFullscreenButton:K,renderPlayPauseButton:oe,renderVolumeSlider:ve,alwaysShowControls:Q=!1,initiallyMuted:ge=!1,showPlaybackRateControl:de=!1,posterFillMode:ne="player-size",bufferStateDelayInMilliseconds:M,hideControlsWhenPointerDoesntMove:z=!0,overflowVisible:ce=!1,renderMuteButton:fe,browserMediaControlsBehavior:be,...ye},ue)=>{if(typeof window<"u"&&m.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]),ye.defaultProps!==void 0)throw new Error("The <Player /> component does not accept `defaultProps`, but some were passed. Use `inputProps` instead.");const Xe=R4(ye);if(Xe?.type===C0)throw new TypeError("'component' should not be an instance of <Composition/>. Pass the React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");if(Xe===C0)throw new TypeError("'component' must not be the 'Composition' component. Pass your own React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");const ze=Pe.useLazyComponent(ye);A4({initialFrame:B,durationInFrames:r});const[bt,wt]=m.useState(()=>({[kp]:B??0})),[Vt,Ce]=m.useState(!1),[qt]=m.useState("player-comp"),it=m.useRef(null),Tt=m.useRef([]),Tr=m.useRef(!1),[tt,Pt]=m.useState(T);if(typeof e!="number")throw new TypeError(`'compositionHeight' must be a number but got '${typeof e}' instead`);if(typeof t!="number")throw new TypeError(`'compositionWidth' must be a number but got '${typeof t}' instead`);if(j0(e,"compositionHeight","of the <Player /> component"),j0(t,"compositionWidth","of the <Player /> component"),P4(r,{component:"of the <Player/> component",allowFloats:!1}),M4(n,"as a prop of the <Player/> component",!1),D4(s,"inputProps",null),O4({durationInFrames:r,inFrame:Y,outFrame:Z}),typeof a!="boolean"&&typeof a<"u")throw new TypeError(`'controls' must be a boolean or undefined but got '${typeof a}' instead`);if(typeof u!="boolean"&&typeof u<"u")throw new TypeError(`'autoPlay' must be a boolean or undefined but got '${typeof u}' instead`);if(typeof c!="boolean"&&typeof c<"u")throw new TypeError(`'loop' must be a boolean or undefined but got '${typeof c}' instead`);if(typeof g!="boolean"&&typeof g<"u")throw new TypeError(`'doubleClickToFullscreen' must be a boolean or undefined but got '${typeof g}' instead`);if(typeof h!="boolean"&&typeof h<"u")throw new TypeError(`'showVolumeControls' must be a boolean or undefined but got '${typeof h}' instead`);if(typeof d!="boolean"&&typeof d<"u")throw new TypeError(`'allowFullscreen' must be a boolean or undefined but got '${typeof d}' instead`);if(typeof p!="boolean"&&typeof p<"u")throw new TypeError(`'clickToPlay' must be a boolean or undefined but got '${typeof p}' instead`);if(typeof v!="boolean"&&typeof v<"u")throw new TypeError(`'spaceKeyToPlayOrPause' must be a boolean or undefined but got '${typeof v}' instead`);if(typeof x!="number"||x%1!==0||!Number.isFinite(x)||Number.isNaN(x)||x<0)throw new TypeError(`'numberOfSharedAudioTags' must be an integer but got '${x}' instead`);I4(tt),m.useEffect(()=>{Pt(T)},[T]),m.useImperativeHandle(ue,()=>it.current,[]);const Gr=m.useMemo(()=>({frame:bt,playing:Vt,rootId:qt,playbackRate:tt,imperativePlaying:Tr,setPlaybackRate:pe=>{Pt(pe)},audioAndVideoTags:Tt}),[bt,tt,Vt,qt]),sr=m.useMemo(()=>({setFrame:wt,setPlaying:Ce}),[wt]);typeof window<"u"&&m.useLayoutEffect(()=>{Pe.CSSUtils.injectCSS(Pe.CSSUtils.makeDefaultPreviewCSS(`.${Ep}`,"#fff"))},[]);const R=m.useMemo(()=>s??{},[s]),he=m.useMemo(()=>be??{mode:"prevent-media-session"},[be]);return w.jsx(Pe.IsPlayerContextProvider,{children:w.jsx(Iw,{timelineContext:Gr,component:ze,compositionHeight:e,compositionWidth:t,durationInFrames:r,fps:n,numberOfSharedAudioTags:x,initiallyMuted:ge,children:w.jsx(Pe.Timeline.SetTimelineContext.Provider,{value:sr,children:w.jsx(L3,{currentPlaybackRate:tt,children:w.jsx(T4,{ref:it,posterFillMode:ne,renderLoading:k,autoPlay:!!u,loop:!!c,controls:!!a,errorFallback:C,style:i,inputProps:R,allowFullscreen:!!d,moveToBeginningWhenEnded:!!b,clickToPlay:typeof p=="boolean"?p:!!a,showVolumeControls:!!h,doubleClickToFullscreen:!!g,spaceKeyToPlayOrPause:!!v,playbackRate:tt,className:A??void 0,showPosterWhenUnplayed:!!I,showPosterWhenEnded:!!D,showPosterWhenPaused:!!F,showPosterWhenBuffering:!!U,renderPoster:X,inFrame:Y??null,outFrame:Z??null,initiallyShowControls:G??!0,renderFullscreen:K??null,renderPlayPauseButton:oe??null,renderMuteButton:fe??null,renderVolumeSlider:ve??null,alwaysShowControls:Q,showPlaybackRateControl:de,bufferStateDelayInMilliseconds:M??300,hideControlsWhenPointerDoesntMove:z,overflowVisible:ce,browserMediaControlsBehavior:he})})})})})},L4=m.forwardRef,F4=L4(j4),N4=()=>{const r=m.useContext(Tw);if(!r)throw new TypeError("Expected Player event emitter context");return m.useMemo(()=>({emitter:r}),[r])},cf=Me.version.split(".")[0];if(cf==="0")throw new Error(`Version ${cf} of "react" is not supported by Remotion`);var B4=parseInt(cf,10)>=18,V4=({style:r,inputProps:e,errorFallback:t,renderLoading:n,className:s,overflowVisible:i},a)=>{const c=Pe.useUnsafeVideoConfig(),u=Pe.useVideo(),h=m.useRef(null),d=Tp(h,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),p=m.useMemo(()=>!c||!d?null:ww({canvasSize:d,compositionHeight:c.height,compositionWidth:c.width,previewSize:"auto"}),[d,c]),g=p?.scale??1,v=N4();Ew(v.emitter),m.useImperativeHandle(a,()=>{const F={getContainerNode:()=>h.current,getScale:()=>g};return Object.assign(v.emitter,F)},[g,v.emitter]);const b=u?u.component:null,x=m.useMemo(()=>_w({config:c,style:r,canvasSize:d,overflowVisible:i,layout:p}),[d,c,p,i,r]),C=m.useMemo(()=>Sw({config:c,layout:p,scale:g,overflowVisible:i}),[c,p,i,g]),T=m.useMemo(()=>xw({canvasSize:d,config:c,layout:p,scale:g,overflowVisible:i}),[d,c,p,i,g]),k=m.useCallback(F=>{v.emitter.dispatchError(F)},[v.emitter]),A=m.useMemo(()=>n?n({height:x.height,width:x.width,isBuffering:!1}):null,[x.height,x.width,n]),I=m.useMemo(()=>({type:"scale",scale:g}),[g]);if(!c)return null;const D=w.jsx("div",{style:C,children:w.jsx("div",{style:T,className:Ep,children:b?w.jsx(kw,{onError:k,errorFallback:t,children:w.jsx(Pe.CurrentScaleContext.Provider,{value:I,children:w.jsx(b,{...u?.props??{},...e??{}})})}):null})});return Ow&&!B4?w.jsx("div",{ref:h,style:x,className:s,children:D}):w.jsx("div",{ref:h,style:x,className:s,children:w.jsx(m.Suspense,{fallback:A,children:D})})},H4=m.forwardRef(V4),z4=({frameToDisplay:r,style:e,inputProps:t,compositionHeight:n,compositionWidth:s,durationInFrames:i,fps:a,className:c,errorFallback:u=()=>"",renderLoading:h,overflowVisible:d=!1,...p},g)=>{typeof window<"u"&&m.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]);const[v]=m.useState(()=>String(Oi(null))),b=m.useRef(null),x=m.useMemo(()=>({playing:!1,frame:{[kp]:r},rootId:v,imperativePlaying:{current:!1},playbackRate:1,setPlaybackRate:()=>{throw new Error("thumbnail")},audioAndVideoTags:{current:[]}}),[r,v]);m.useImperativeHandle(g,()=>b.current,[]);const C=Pe.useLazyComponent(p),[T]=m.useState(()=>new j3),k=m.useMemo(()=>t??{},[t]);return w.jsx(Pe.IsPlayerContextProvider,{children:w.jsx(Iw,{timelineContext:x,component:C,compositionHeight:n,compositionWidth:s,durationInFrames:i,fps:a,numberOfSharedAudioTags:0,initiallyMuted:!0,children:w.jsx(Tw.Provider,{value:T,children:w.jsx(H4,{ref:b,className:c,errorFallback:u,inputProps:k,renderLoading:h,style:e,overflowVisible:d})})})})},W4=m.forwardRef;W4(z4);const Kc=(r,e)=>{const t=r.from/1e3*e,n=r.to/1e3*e-t;return{from:t,durationInFrames:n}},Mw={text:(r,e)=>{const{fps:t,height:n,width:s}=e,{from:i,durationInFrames:a}=Kc(r.display,t);return w.jsx(Dn,{from:i,durationInFrames:a,"data-track-item":"transition-element",style:{position:"absolute",width:r.details.width??300,height:r.details.height??400,transform:r.details.transform??"none",fontSize:r.details.fontSize||"16px",textAlign:r.details.textAlign||"left",top:r.details.top??300,left:r.details.left??600,color:r.details.color||"#000000",backgroundColor:r.details.backgroundColor||"transparent",border:r.details.border??"none",opacity:r.details.opacity??100/100,fontFamily:r.details.fontFamily||"Arial",textDecoration:r.details.textDecoration||"none",fontWeight:r.details.fontWeight||"normal",lineHeight:r.details.lineHeight||"normal",letterSpacing:r.details.letterSpacing||"normal",wordSpacing:r.details.wordSpacing||"normal",wordWrap:r.details.wordWrap||"normal",wordBreak:r.details.wordBreak||"normal",pointerEvents:"auto"},children:w.jsx("div",{children:r.details.text})},r.id)},image:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Kc(r.display,t);return w.jsx(Dn,{from:n,durationInFrames:s,style:{width:r.details.width??"100%",height:r.details.height??"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",filter:r.details.filter||"none",top:r.details.top??0,left:r.details.left??0},children:w.jsx(ma,{style:{pointerEvents:"none"},children:w.jsx(pw,{style:{pointerEvents:"none"},"data-id":r.id,src:r.details.src})})},r.id)},video:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Kc(r.display,t),i=r.trim,a=r.details.crop||{x:0,y:0,width:r.details.width,height:r.details.height};return i?w.jsx(Dn,{premountFor:30*5,from:n,durationInFrames:s,style:{width:a.width||"100%",height:a.height||"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",top:r.details.top??0,left:r.details.left??0,overflow:"hidden"},children:w.jsx(ma,{style:{pointerEvents:"none",width:r.details.width,height:r.details.height,top:-a.y,left:-a.x},children:w.jsx(bw,{startFrom:i.from/1e3*t,endAt:i.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100,style:{pointerEvents:"none",width:r.details.width,height:r.details.height}})})},r.id):w.jsx(w.Fragment,{})},audio:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Kc(r.display,t),i=r.trim;return i?w.jsx(Dn,{className:`moonshine-scene-item id-${r.id} moonshine-scene-item-type-${r.type}`,from:n,durationInFrames:s,style:{userSelect:"none",pointerEvents:"none"},children:w.jsx(ma,{children:w.jsx(va,{startFrom:i.from/1e3*t,endAt:i.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100})})},r.id):w.jsx(w.Fragment,{})}};var jl={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */jl.exports;(function(r,e){(function(){var t,n="4.17.21",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",p=1,g=2,v=4,b=1,x=2,C=1,T=2,k=4,A=8,I=16,D=32,F=64,U=128,B=256,X=512,Y=30,Z="...",G=800,K=16,oe=1,ve=2,Q=3,ge=1/0,de=9007199254740991,ne=17976931348623157e292,M=NaN,z=4294967295,ce=z-1,fe=z>>>1,be=[["ary",U],["bind",C],["bindKey",T],["curry",A],["curryRight",I],["flip",X],["partial",D],["partialRight",F],["rearg",B]],ye="[object Arguments]",ue="[object Array]",Xe="[object AsyncFunction]",ze="[object Boolean]",bt="[object Date]",wt="[object DOMException]",Vt="[object Error]",Ce="[object Function]",qt="[object GeneratorFunction]",it="[object Map]",Tt="[object Number]",Tr="[object Null]",tt="[object Object]",Pt="[object Promise]",Gr="[object Proxy]",sr="[object RegExp]",R="[object Set]",he="[object String]",pe="[object Symbol]",De="[object Undefined]",Je="[object WeakMap]",Ge="[object WeakSet]",ke="[object ArrayBuffer]",_e="[object DataView]",Ht="[object Float32Array]",_t="[object Float64Array]",zt="[object Int8Array]",Er="[object Int16Array]",Qt="[object Int32Array]",jr="[object Uint8Array]",Kt="[object Uint8ClampedArray]",hs="[object Uint16Array]",ds="[object Uint32Array]",Vn=/\b__p \+= '';/g,kn=/\b(__p \+=) '' \+/g,Ri=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fs=/&(?:amp|lt|gt|quot|#39);/g,hn=/[&<>"']/g,ji=RegExp(fs.source),No=RegExp(hn.source),Bo=/<%-([\s\S]+?)%>/g,Vo=/<%([\s\S]+?)%>/g,Li=/<%=([\s\S]+?)%>/g,Fi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Us=/^\w*$/,qe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$e=/[\\^$.*+?()[\]{}|]/g,Zt=RegExp($e.source),pr=/^\s+/,$s=/\s/,Ho=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ic=/\{\n\/\* \[wrapped with (.+)\] \*/,_=/,? & /,V=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,te=/[()=,{}\[\]\/\s]/,ae=/\\(\\)?/g,xe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ee=/\w*$/,Se=/^[-+]0x[0-9a-f]+$/i,rt=/^0b[01]+$/i,Qe=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,ir=/^(?:0|[1-9]\d*)$/,Hn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,gr=/($^)/,Ni=/['\n\r\u2028\u2029\\]/g,kr="\\ud800-\\udfff",MS="\\u0300-\\u036f",PS="\\ufe20-\\ufe2f",DS="\\u20d0-\\u20ff",fg=MS+PS+DS,pg="\\u2700-\\u27bf",gg="a-z\\xdf-\\xf6\\xf8-\\xff",RS="\\xac\\xb1\\xd7\\xf7",jS="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",LS="\\u2000-\\u206f",FS=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",mg="A-Z\\xc0-\\xd6\\xd8-\\xde",vg="\\ufe0e\\ufe0f",yg=RS+jS+LS+FS,Wu="[']",NS="["+kr+"]",bg="["+yg+"]",oc="["+fg+"]",wg="\\d+",BS="["+pg+"]",_g="["+gg+"]",xg="[^"+kr+yg+wg+pg+gg+mg+"]",Uu="\\ud83c[\\udffb-\\udfff]",VS="(?:"+oc+"|"+Uu+")",Sg="[^"+kr+"]",$u="(?:\\ud83c[\\udde6-\\uddff]){2}",Yu="[\\ud800-\\udbff][\\udc00-\\udfff]",Bi="["+mg+"]",Cg="\\u200d",Tg="(?:"+_g+"|"+xg+")",HS="(?:"+Bi+"|"+xg+")",Eg="(?:"+Wu+"(?:d|ll|m|re|s|t|ve))?",kg="(?:"+Wu+"(?:D|LL|M|RE|S|T|VE))?",Og=VS+"?",Ag="["+vg+"]?",zS="(?:"+Cg+"(?:"+[Sg,$u,Yu].join("|")+")"+Ag+Og+")*",WS="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",US="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ig=Ag+Og+zS,$S="(?:"+[BS,$u,Yu].join("|")+")"+Ig,YS="(?:"+[Sg+oc+"?",oc,$u,Yu,NS].join("|")+")",XS=RegExp(Wu,"g"),GS=RegExp(oc,"g"),Xu=RegExp(Uu+"(?="+Uu+")|"+YS+Ig,"g"),qS=RegExp([Bi+"?"+_g+"+"+Eg+"(?="+[bg,Bi,"$"].join("|")+")",HS+"+"+kg+"(?="+[bg,Bi+Tg,"$"].join("|")+")",Bi+"?"+Tg+"+"+Eg,Bi+"+"+kg,US,WS,wg,$S].join("|"),"g"),KS=RegExp("["+Cg+kr+fg+vg+"]"),ZS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,JS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],QS=-1,ft={};ft[Ht]=ft[_t]=ft[zt]=ft[Er]=ft[Qt]=ft[jr]=ft[Kt]=ft[hs]=ft[ds]=!0,ft[ye]=ft[ue]=ft[ke]=ft[ze]=ft[_e]=ft[bt]=ft[Vt]=ft[Ce]=ft[it]=ft[Tt]=ft[tt]=ft[sr]=ft[R]=ft[he]=ft[Je]=!1;var dt={};dt[ye]=dt[ue]=dt[ke]=dt[_e]=dt[ze]=dt[bt]=dt[Ht]=dt[_t]=dt[zt]=dt[Er]=dt[Qt]=dt[it]=dt[Tt]=dt[tt]=dt[sr]=dt[R]=dt[he]=dt[pe]=dt[jr]=dt[Kt]=dt[hs]=dt[ds]=!0,dt[Vt]=dt[Ce]=dt[Je]=!1;var eC={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},tC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rC={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},nC={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},sC=parseFloat,iC=parseInt,Mg=typeof na=="object"&&na&&na.Object===Object&&na,oC=typeof self=="object"&&self&&self.Object===Object&&self,er=Mg||oC||Function("return this")(),Gu=e&&!e.nodeType&&e,Ys=Gu&&!0&&r&&!r.nodeType&&r,Pg=Ys&&Ys.exports===Gu,qu=Pg&&Mg.process,qr=function(){try{var H=Ys&&Ys.require&&Ys.require("util").types;return H||qu&&qu.binding&&qu.binding("util")}catch{}}(),Dg=qr&&qr.isArrayBuffer,Rg=qr&&qr.isDate,jg=qr&&qr.isMap,Lg=qr&&qr.isRegExp,Fg=qr&&qr.isSet,Ng=qr&&qr.isTypedArray;function Lr(H,J,q){switch(q.length){case 0:return H.call(J);case 1:return H.call(J,q[0]);case 2:return H.call(J,q[0],q[1]);case 3:return H.call(J,q[0],q[1],q[2])}return H.apply(J,q)}function aC(H,J,q,we){for(var Re=-1,nt=H==null?0:H.length;++Re<nt;){var Wt=H[Re];J(we,Wt,q(Wt),H)}return we}function Kr(H,J){for(var q=-1,we=H==null?0:H.length;++q<we&&J(H[q],q,H)!==!1;);return H}function cC(H,J){for(var q=H==null?0:H.length;q--&&J(H[q],q,H)!==!1;);return H}function Bg(H,J){for(var q=-1,we=H==null?0:H.length;++q<we;)if(!J(H[q],q,H))return!1;return!0}function ps(H,J){for(var q=-1,we=H==null?0:H.length,Re=0,nt=[];++q<we;){var Wt=H[q];J(Wt,q,H)&&(nt[Re++]=Wt)}return nt}function ac(H,J){var q=H==null?0:H.length;return!!q&&Vi(H,J,0)>-1}function Ku(H,J,q){for(var we=-1,Re=H==null?0:H.length;++we<Re;)if(q(J,H[we]))return!0;return!1}function mt(H,J){for(var q=-1,we=H==null?0:H.length,Re=Array(we);++q<we;)Re[q]=J(H[q],q,H);return Re}function gs(H,J){for(var q=-1,we=J.length,Re=H.length;++q<we;)H[Re+q]=J[q];return H}function Zu(H,J,q,we){var Re=-1,nt=H==null?0:H.length;for(we&&nt&&(q=H[++Re]);++Re<nt;)q=J(q,H[Re],Re,H);return q}function lC(H,J,q,we){var Re=H==null?0:H.length;for(we&&Re&&(q=H[--Re]);Re--;)q=J(q,H[Re],Re,H);return q}function Ju(H,J){for(var q=-1,we=H==null?0:H.length;++q<we;)if(J(H[q],q,H))return!0;return!1}var uC=Qu("length");function hC(H){return H.split("")}function dC(H){return H.match(V)||[]}function Vg(H,J,q){var we;return q(H,function(Re,nt,Wt){if(J(Re,nt,Wt))return we=nt,!1}),we}function cc(H,J,q,we){for(var Re=H.length,nt=q+(we?1:-1);we?nt--:++nt<Re;)if(J(H[nt],nt,H))return nt;return-1}function Vi(H,J,q){return J===J?CC(H,J,q):cc(H,Hg,q)}function fC(H,J,q,we){for(var Re=q-1,nt=H.length;++Re<nt;)if(we(H[Re],J))return Re;return-1}function Hg(H){return H!==H}function zg(H,J){var q=H==null?0:H.length;return q?th(H,J)/q:M}function Qu(H){return function(J){return J==null?t:J[H]}}function eh(H){return function(J){return H==null?t:H[J]}}function Wg(H,J,q,we,Re){return Re(H,function(nt,Wt,ut){q=we?(we=!1,nt):J(q,nt,Wt,ut)}),q}function pC(H,J){var q=H.length;for(H.sort(J);q--;)H[q]=H[q].value;return H}function th(H,J){for(var q,we=-1,Re=H.length;++we<Re;){var nt=J(H[we]);nt!==t&&(q=q===t?nt:q+nt)}return q}function rh(H,J){for(var q=-1,we=Array(H);++q<H;)we[q]=J(q);return we}function gC(H,J){return mt(J,function(q){return[q,H[q]]})}function Ug(H){return H&&H.slice(0,Gg(H)+1).replace(pr,"")}function Fr(H){return function(J){return H(J)}}function nh(H,J){return mt(J,function(q){return H[q]})}function zo(H,J){return H.has(J)}function $g(H,J){for(var q=-1,we=H.length;++q<we&&Vi(J,H[q],0)>-1;);return q}function Yg(H,J){for(var q=H.length;q--&&Vi(J,H[q],0)>-1;);return q}function mC(H,J){for(var q=H.length,we=0;q--;)H[q]===J&&++we;return we}var vC=eh(eC),yC=eh(tC);function bC(H){return"\\"+nC[H]}function wC(H,J){return H==null?t:H[J]}function Hi(H){return KS.test(H)}function _C(H){return ZS.test(H)}function xC(H){for(var J,q=[];!(J=H.next()).done;)q.push(J.value);return q}function sh(H){var J=-1,q=Array(H.size);return H.forEach(function(we,Re){q[++J]=[Re,we]}),q}function Xg(H,J){return function(q){return H(J(q))}}function ms(H,J){for(var q=-1,we=H.length,Re=0,nt=[];++q<we;){var Wt=H[q];(Wt===J||Wt===d)&&(H[q]=d,nt[Re++]=q)}return nt}function lc(H){var J=-1,q=Array(H.size);return H.forEach(function(we){q[++J]=we}),q}function SC(H){var J=-1,q=Array(H.size);return H.forEach(function(we){q[++J]=[we,we]}),q}function CC(H,J,q){for(var we=q-1,Re=H.length;++we<Re;)if(H[we]===J)return we;return-1}function TC(H,J,q){for(var we=q+1;we--;)if(H[we]===J)return we;return we}function zi(H){return Hi(H)?kC(H):uC(H)}function dn(H){return Hi(H)?OC(H):hC(H)}function Gg(H){for(var J=H.length;J--&&$s.test(H.charAt(J)););return J}var EC=eh(rC);function kC(H){for(var J=Xu.lastIndex=0;Xu.test(H);)++J;return J}function OC(H){return H.match(Xu)||[]}function AC(H){return H.match(qS)||[]}var IC=function H(J){J=J==null?er:Wi.defaults(er.Object(),J,Wi.pick(er,JS));var q=J.Array,we=J.Date,Re=J.Error,nt=J.Function,Wt=J.Math,ut=J.Object,ih=J.RegExp,MC=J.String,Zr=J.TypeError,uc=q.prototype,PC=nt.prototype,Ui=ut.prototype,hc=J["__core-js_shared__"],dc=PC.toString,ct=Ui.hasOwnProperty,DC=0,qg=function(){var o=/[^.]+$/.exec(hc&&hc.keys&&hc.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),fc=Ui.toString,RC=dc.call(ut),jC=er._,LC=ih("^"+dc.call(ct).replace($e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pc=Pg?J.Buffer:t,vs=J.Symbol,gc=J.Uint8Array,Kg=pc?pc.allocUnsafe:t,mc=Xg(ut.getPrototypeOf,ut),Zg=ut.create,Jg=Ui.propertyIsEnumerable,vc=uc.splice,Qg=vs?vs.isConcatSpreadable:t,Wo=vs?vs.iterator:t,Xs=vs?vs.toStringTag:t,yc=function(){try{var o=Js(ut,"defineProperty");return o({},"",{}),o}catch{}}(),FC=J.clearTimeout!==er.clearTimeout&&J.clearTimeout,NC=we&&we.now!==er.Date.now&&we.now,BC=J.setTimeout!==er.setTimeout&&J.setTimeout,bc=Wt.ceil,wc=Wt.floor,oh=ut.getOwnPropertySymbols,VC=pc?pc.isBuffer:t,em=J.isFinite,HC=uc.join,zC=Xg(ut.keys,ut),Ut=Wt.max,or=Wt.min,WC=we.now,UC=J.parseInt,tm=Wt.random,$C=uc.reverse,ah=Js(J,"DataView"),Uo=Js(J,"Map"),ch=Js(J,"Promise"),$i=Js(J,"Set"),$o=Js(J,"WeakMap"),Yo=Js(ut,"create"),_c=$o&&new $o,Yi={},YC=Qs(ah),XC=Qs(Uo),GC=Qs(ch),qC=Qs($i),KC=Qs($o),xc=vs?vs.prototype:t,Xo=xc?xc.valueOf:t,rm=xc?xc.toString:t;function E(o){if(Et(o)&&!je(o)&&!(o instanceof Ye)){if(o instanceof Jr)return o;if(ct.call(o,"__wrapped__"))return nv(o)}return new Jr(o)}var Xi=function(){function o(){}return function(l){if(!xt(l))return{};if(Zg)return Zg(l);o.prototype=l;var f=new o;return o.prototype=t,f}}();function Sc(){}function Jr(o,l){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=t}E.templateSettings={escape:Bo,evaluate:Vo,interpolate:Li,variable:"",imports:{_:E}},E.prototype=Sc.prototype,E.prototype.constructor=E,Jr.prototype=Xi(Sc.prototype),Jr.prototype.constructor=Jr;function Ye(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=z,this.__views__=[]}function ZC(){var o=new Ye(this.__wrapped__);return o.__actions__=Or(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Or(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Or(this.__views__),o}function JC(){if(this.__filtered__){var o=new Ye(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function QC(){var o=this.__wrapped__.value(),l=this.__dir__,f=je(o),y=l<0,S=f?o.length:0,O=hE(0,S,this.__views__),P=O.start,j=O.end,W=j-P,ee=y?j:P-1,re=this.__iteratees__,se=re.length,me=0,Te=or(W,this.__takeCount__);if(!f||!y&&S==W&&Te==W)return Em(o,this.__actions__);var Ae=[];e:for(;W--&&me<Te;){ee+=l;for(var Ve=-1,Ie=o[ee];++Ve<se;){var We=re[Ve],Ke=We.iteratee,Vr=We.type,yr=Ke(Ie);if(Vr==ve)Ie=yr;else if(!yr){if(Vr==oe)continue e;break e}}Ae[me++]=Ie}return Ae}Ye.prototype=Xi(Sc.prototype),Ye.prototype.constructor=Ye;function Gs(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var y=o[l];this.set(y[0],y[1])}}function eT(){this.__data__=Yo?Yo(null):{},this.size=0}function tT(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}function rT(o){var l=this.__data__;if(Yo){var f=l[o];return f===u?t:f}return ct.call(l,o)?l[o]:t}function nT(o){var l=this.__data__;return Yo?l[o]!==t:ct.call(l,o)}function sT(o,l){var f=this.__data__;return this.size+=this.has(o)?0:1,f[o]=Yo&&l===t?u:l,this}Gs.prototype.clear=eT,Gs.prototype.delete=tT,Gs.prototype.get=rT,Gs.prototype.has=nT,Gs.prototype.set=sT;function zn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var y=o[l];this.set(y[0],y[1])}}function iT(){this.__data__=[],this.size=0}function oT(o){var l=this.__data__,f=Cc(l,o);if(f<0)return!1;var y=l.length-1;return f==y?l.pop():vc.call(l,f,1),--this.size,!0}function aT(o){var l=this.__data__,f=Cc(l,o);return f<0?t:l[f][1]}function cT(o){return Cc(this.__data__,o)>-1}function lT(o,l){var f=this.__data__,y=Cc(f,o);return y<0?(++this.size,f.push([o,l])):f[y][1]=l,this}zn.prototype.clear=iT,zn.prototype.delete=oT,zn.prototype.get=aT,zn.prototype.has=cT,zn.prototype.set=lT;function Wn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var y=o[l];this.set(y[0],y[1])}}function uT(){this.size=0,this.__data__={hash:new Gs,map:new(Uo||zn),string:new Gs}}function hT(o){var l=Lc(this,o).delete(o);return this.size-=l?1:0,l}function dT(o){return Lc(this,o).get(o)}function fT(o){return Lc(this,o).has(o)}function pT(o,l){var f=Lc(this,o),y=f.size;return f.set(o,l),this.size+=f.size==y?0:1,this}Wn.prototype.clear=uT,Wn.prototype.delete=hT,Wn.prototype.get=dT,Wn.prototype.has=fT,Wn.prototype.set=pT;function qs(o){var l=-1,f=o==null?0:o.length;for(this.__data__=new Wn;++l<f;)this.add(o[l])}function gT(o){return this.__data__.set(o,u),this}function mT(o){return this.__data__.has(o)}qs.prototype.add=qs.prototype.push=gT,qs.prototype.has=mT;function fn(o){var l=this.__data__=new zn(o);this.size=l.size}function vT(){this.__data__=new zn,this.size=0}function yT(o){var l=this.__data__,f=l.delete(o);return this.size=l.size,f}function bT(o){return this.__data__.get(o)}function wT(o){return this.__data__.has(o)}function _T(o,l){var f=this.__data__;if(f instanceof zn){var y=f.__data__;if(!Uo||y.length<s-1)return y.push([o,l]),this.size=++f.size,this;f=this.__data__=new Wn(y)}return f.set(o,l),this.size=f.size,this}fn.prototype.clear=vT,fn.prototype.delete=yT,fn.prototype.get=bT,fn.prototype.has=wT,fn.prototype.set=_T;function nm(o,l){var f=je(o),y=!f&&ei(o),S=!f&&!y&&xs(o),O=!f&&!y&&!S&&Zi(o),P=f||y||S||O,j=P?rh(o.length,MC):[],W=j.length;for(var ee in o)(l||ct.call(o,ee))&&!(P&&(ee=="length"||S&&(ee=="offset"||ee=="parent")||O&&(ee=="buffer"||ee=="byteLength"||ee=="byteOffset")||Xn(ee,W)))&&j.push(ee);return j}function sm(o){var l=o.length;return l?o[bh(0,l-1)]:t}function xT(o,l){return Fc(Or(o),Ks(l,0,o.length))}function ST(o){return Fc(Or(o))}function lh(o,l,f){(f!==t&&!pn(o[l],f)||f===t&&!(l in o))&&Un(o,l,f)}function Go(o,l,f){var y=o[l];(!(ct.call(o,l)&&pn(y,f))||f===t&&!(l in o))&&Un(o,l,f)}function Cc(o,l){for(var f=o.length;f--;)if(pn(o[f][0],l))return f;return-1}function CT(o,l,f,y){return ys(o,function(S,O,P){l(y,S,f(S),P)}),y}function im(o,l){return o&&An(l,Jt(l),o)}function TT(o,l){return o&&An(l,Ir(l),o)}function Un(o,l,f){l=="__proto__"&&yc?yc(o,l,{configurable:!0,enumerable:!0,value:f,writable:!0}):o[l]=f}function uh(o,l){for(var f=-1,y=l.length,S=q(y),O=o==null;++f<y;)S[f]=O?t:Uh(o,l[f]);return S}function Ks(o,l,f){return o===o&&(f!==t&&(o=o<=f?o:f),l!==t&&(o=o>=l?o:l)),o}function Qr(o,l,f,y,S,O){var P,j=l&p,W=l&g,ee=l&v;if(f&&(P=S?f(o,y,S,O):f(o)),P!==t)return P;if(!xt(o))return o;var re=je(o);if(re){if(P=fE(o),!j)return Or(o,P)}else{var se=ar(o),me=se==Ce||se==qt;if(xs(o))return Am(o,j);if(se==tt||se==ye||me&&!S){if(P=W||me?{}:Gm(o),!j)return W?rE(o,TT(P,o)):tE(o,im(P,o))}else{if(!dt[se])return S?o:{};P=pE(o,se,j)}}O||(O=new fn);var Te=O.get(o);if(Te)return Te;O.set(o,P),Sv(o)?o.forEach(function(Ie){P.add(Qr(Ie,l,f,Ie,o,O))}):_v(o)&&o.forEach(function(Ie,We){P.set(We,Qr(Ie,l,f,We,o,O))});var Ae=ee?W?Ih:Ah:W?Ir:Jt,Ve=re?t:Ae(o);return Kr(Ve||o,function(Ie,We){Ve&&(We=Ie,Ie=o[We]),Go(P,We,Qr(Ie,l,f,We,o,O))}),P}function ET(o){var l=Jt(o);return function(f){return om(f,o,l)}}function om(o,l,f){var y=f.length;if(o==null)return!y;for(o=ut(o);y--;){var S=f[y],O=l[S],P=o[S];if(P===t&&!(S in o)||!O(P))return!1}return!0}function am(o,l,f){if(typeof o!="function")throw new Zr(a);return ta(function(){o.apply(t,f)},l)}function qo(o,l,f,y){var S=-1,O=ac,P=!0,j=o.length,W=[],ee=l.length;if(!j)return W;f&&(l=mt(l,Fr(f))),y?(O=Ku,P=!1):l.length>=s&&(O=zo,P=!1,l=new qs(l));e:for(;++S<j;){var re=o[S],se=f==null?re:f(re);if(re=y||re!==0?re:0,P&&se===se){for(var me=ee;me--;)if(l[me]===se)continue e;W.push(re)}else O(l,se,y)||W.push(re)}return W}var ys=Rm(On),cm=Rm(dh,!0);function kT(o,l){var f=!0;return ys(o,function(y,S,O){return f=!!l(y,S,O),f}),f}function Tc(o,l,f){for(var y=-1,S=o.length;++y<S;){var O=o[y],P=l(O);if(P!=null&&(j===t?P===P&&!Br(P):f(P,j)))var j=P,W=O}return W}function OT(o,l,f,y){var S=o.length;for(f=Le(f),f<0&&(f=-f>S?0:S+f),y=y===t||y>S?S:Le(y),y<0&&(y+=S),y=f>y?0:Tv(y);f<y;)o[f++]=l;return o}function lm(o,l){var f=[];return ys(o,function(y,S,O){l(y,S,O)&&f.push(y)}),f}function tr(o,l,f,y,S){var O=-1,P=o.length;for(f||(f=mE),S||(S=[]);++O<P;){var j=o[O];l>0&&f(j)?l>1?tr(j,l-1,f,y,S):gs(S,j):y||(S[S.length]=j)}return S}var hh=jm(),um=jm(!0);function On(o,l){return o&&hh(o,l,Jt)}function dh(o,l){return o&&um(o,l,Jt)}function Ec(o,l){return ps(l,function(f){return Gn(o[f])})}function Zs(o,l){l=ws(l,o);for(var f=0,y=l.length;o!=null&&f<y;)o=o[In(l[f++])];return f&&f==y?o:t}function hm(o,l,f){var y=l(o);return je(o)?y:gs(y,f(o))}function mr(o){return o==null?o===t?De:Tr:Xs&&Xs in ut(o)?uE(o):SE(o)}function fh(o,l){return o>l}function AT(o,l){return o!=null&&ct.call(o,l)}function IT(o,l){return o!=null&&l in ut(o)}function MT(o,l,f){return o>=or(l,f)&&o<Ut(l,f)}function ph(o,l,f){for(var y=f?Ku:ac,S=o[0].length,O=o.length,P=O,j=q(O),W=1/0,ee=[];P--;){var re=o[P];P&&l&&(re=mt(re,Fr(l))),W=or(re.length,W),j[P]=!f&&(l||S>=120&&re.length>=120)?new qs(P&&re):t}re=o[0];var se=-1,me=j[0];e:for(;++se<S&&ee.length<W;){var Te=re[se],Ae=l?l(Te):Te;if(Te=f||Te!==0?Te:0,!(me?zo(me,Ae):y(ee,Ae,f))){for(P=O;--P;){var Ve=j[P];if(!(Ve?zo(Ve,Ae):y(o[P],Ae,f)))continue e}me&&me.push(Ae),ee.push(Te)}}return ee}function PT(o,l,f,y){return On(o,function(S,O,P){l(y,f(S),O,P)}),y}function Ko(o,l,f){l=ws(l,o),o=Jm(o,l);var y=o==null?o:o[In(tn(l))];return y==null?t:Lr(y,o,f)}function dm(o){return Et(o)&&mr(o)==ye}function DT(o){return Et(o)&&mr(o)==ke}function RT(o){return Et(o)&&mr(o)==bt}function Zo(o,l,f,y,S){return o===l?!0:o==null||l==null||!Et(o)&&!Et(l)?o!==o&&l!==l:jT(o,l,f,y,Zo,S)}function jT(o,l,f,y,S,O){var P=je(o),j=je(l),W=P?ue:ar(o),ee=j?ue:ar(l);W=W==ye?tt:W,ee=ee==ye?tt:ee;var re=W==tt,se=ee==tt,me=W==ee;if(me&&xs(o)){if(!xs(l))return!1;P=!0,re=!1}if(me&&!re)return O||(O=new fn),P||Zi(o)?$m(o,l,f,y,S,O):cE(o,l,W,f,y,S,O);if(!(f&b)){var Te=re&&ct.call(o,"__wrapped__"),Ae=se&&ct.call(l,"__wrapped__");if(Te||Ae){var Ve=Te?o.value():o,Ie=Ae?l.value():l;return O||(O=new fn),S(Ve,Ie,f,y,O)}}return me?(O||(O=new fn),lE(o,l,f,y,S,O)):!1}function LT(o){return Et(o)&&ar(o)==it}function gh(o,l,f,y){var S=f.length,O=S,P=!y;if(o==null)return!O;for(o=ut(o);S--;){var j=f[S];if(P&&j[2]?j[1]!==o[j[0]]:!(j[0]in o))return!1}for(;++S<O;){j=f[S];var W=j[0],ee=o[W],re=j[1];if(P&&j[2]){if(ee===t&&!(W in o))return!1}else{var se=new fn;if(y)var me=y(ee,re,W,o,l,se);if(!(me===t?Zo(re,ee,b|x,y,se):me))return!1}}return!0}function fm(o){if(!xt(o)||yE(o))return!1;var l=Gn(o)?LC:Qe;return l.test(Qs(o))}function FT(o){return Et(o)&&mr(o)==sr}function NT(o){return Et(o)&&ar(o)==R}function BT(o){return Et(o)&&Wc(o.length)&&!!ft[mr(o)]}function pm(o){return typeof o=="function"?o:o==null?Mr:typeof o=="object"?je(o)?vm(o[0],o[1]):mm(o):Lv(o)}function mh(o){if(!ea(o))return zC(o);var l=[];for(var f in ut(o))ct.call(o,f)&&f!="constructor"&&l.push(f);return l}function VT(o){if(!xt(o))return xE(o);var l=ea(o),f=[];for(var y in o)y=="constructor"&&(l||!ct.call(o,y))||f.push(y);return f}function vh(o,l){return o<l}function gm(o,l){var f=-1,y=Ar(o)?q(o.length):[];return ys(o,function(S,O,P){y[++f]=l(S,O,P)}),y}function mm(o){var l=Ph(o);return l.length==1&&l[0][2]?Km(l[0][0],l[0][1]):function(f){return f===o||gh(f,o,l)}}function vm(o,l){return Rh(o)&&qm(l)?Km(In(o),l):function(f){var y=Uh(f,o);return y===t&&y===l?$h(f,o):Zo(l,y,b|x)}}function kc(o,l,f,y,S){o!==l&&hh(l,function(O,P){if(S||(S=new fn),xt(O))HT(o,l,P,f,kc,y,S);else{var j=y?y(Lh(o,P),O,P+"",o,l,S):t;j===t&&(j=O),lh(o,P,j)}},Ir)}function HT(o,l,f,y,S,O,P){var j=Lh(o,f),W=Lh(l,f),ee=P.get(W);if(ee){lh(o,f,ee);return}var re=O?O(j,W,f+"",o,l,P):t,se=re===t;if(se){var me=je(W),Te=!me&&xs(W),Ae=!me&&!Te&&Zi(W);re=W,me||Te||Ae?je(j)?re=j:Dt(j)?re=Or(j):Te?(se=!1,re=Am(W,!0)):Ae?(se=!1,re=Im(W,!0)):re=[]:ra(W)||ei(W)?(re=j,ei(j)?re=Ev(j):(!xt(j)||Gn(j))&&(re=Gm(W))):se=!1}se&&(P.set(W,re),S(re,W,y,O,P),P.delete(W)),lh(o,f,re)}function ym(o,l){var f=o.length;if(f)return l+=l<0?f:0,Xn(l,f)?o[l]:t}function bm(o,l,f){l.length?l=mt(l,function(O){return je(O)?function(P){return Zs(P,O.length===1?O[0]:O)}:O}):l=[Mr];var y=-1;l=mt(l,Fr(Oe()));var S=gm(o,function(O,P,j){var W=mt(l,function(ee){return ee(O)});return{criteria:W,index:++y,value:O}});return pC(S,function(O,P){return eE(O,P,f)})}function zT(o,l){return wm(o,l,function(f,y){return $h(o,y)})}function wm(o,l,f){for(var y=-1,S=l.length,O={};++y<S;){var P=l[y],j=Zs(o,P);f(j,P)&&Jo(O,ws(P,o),j)}return O}function WT(o){return function(l){return Zs(l,o)}}function yh(o,l,f,y){var S=y?fC:Vi,O=-1,P=l.length,j=o;for(o===l&&(l=Or(l)),f&&(j=mt(o,Fr(f)));++O<P;)for(var W=0,ee=l[O],re=f?f(ee):ee;(W=S(j,re,W,y))>-1;)j!==o&&vc.call(j,W,1),vc.call(o,W,1);return o}function _m(o,l){for(var f=o?l.length:0,y=f-1;f--;){var S=l[f];if(f==y||S!==O){var O=S;Xn(S)?vc.call(o,S,1):xh(o,S)}}return o}function bh(o,l){return o+wc(tm()*(l-o+1))}function UT(o,l,f,y){for(var S=-1,O=Ut(bc((l-o)/(f||1)),0),P=q(O);O--;)P[y?O:++S]=o,o+=f;return P}function wh(o,l){var f="";if(!o||l<1||l>de)return f;do l%2&&(f+=o),l=wc(l/2),l&&(o+=o);while(l);return f}function He(o,l){return Fh(Zm(o,l,Mr),o+"")}function $T(o){return sm(Ji(o))}function YT(o,l){var f=Ji(o);return Fc(f,Ks(l,0,f.length))}function Jo(o,l,f,y){if(!xt(o))return o;l=ws(l,o);for(var S=-1,O=l.length,P=O-1,j=o;j!=null&&++S<O;){var W=In(l[S]),ee=f;if(W==="__proto__"||W==="constructor"||W==="prototype")return o;if(S!=P){var re=j[W];ee=y?y(re,W,j):t,ee===t&&(ee=xt(re)?re:Xn(l[S+1])?[]:{})}Go(j,W,ee),j=j[W]}return o}var xm=_c?function(o,l){return _c.set(o,l),o}:Mr,XT=yc?function(o,l){return yc(o,"toString",{configurable:!0,enumerable:!1,value:Xh(l),writable:!0})}:Mr;function GT(o){return Fc(Ji(o))}function en(o,l,f){var y=-1,S=o.length;l<0&&(l=-l>S?0:S+l),f=f>S?S:f,f<0&&(f+=S),S=l>f?0:f-l>>>0,l>>>=0;for(var O=q(S);++y<S;)O[y]=o[y+l];return O}function qT(o,l){var f;return ys(o,function(y,S,O){return f=l(y,S,O),!f}),!!f}function Oc(o,l,f){var y=0,S=o==null?y:o.length;if(typeof l=="number"&&l===l&&S<=fe){for(;y<S;){var O=y+S>>>1,P=o[O];P!==null&&!Br(P)&&(f?P<=l:P<l)?y=O+1:S=O}return S}return _h(o,l,Mr,f)}function _h(o,l,f,y){var S=0,O=o==null?0:o.length;if(O===0)return 0;l=f(l);for(var P=l!==l,j=l===null,W=Br(l),ee=l===t;S<O;){var re=wc((S+O)/2),se=f(o[re]),me=se!==t,Te=se===null,Ae=se===se,Ve=Br(se);if(P)var Ie=y||Ae;else ee?Ie=Ae&&(y||me):j?Ie=Ae&&me&&(y||!Te):W?Ie=Ae&&me&&!Te&&(y||!Ve):Te||Ve?Ie=!1:Ie=y?se<=l:se<l;Ie?S=re+1:O=re}return or(O,ce)}function Sm(o,l){for(var f=-1,y=o.length,S=0,O=[];++f<y;){var P=o[f],j=l?l(P):P;if(!f||!pn(j,W)){var W=j;O[S++]=P===0?0:P}}return O}function Cm(o){return typeof o=="number"?o:Br(o)?M:+o}function Nr(o){if(typeof o=="string")return o;if(je(o))return mt(o,Nr)+"";if(Br(o))return rm?rm.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function bs(o,l,f){var y=-1,S=ac,O=o.length,P=!0,j=[],W=j;if(f)P=!1,S=Ku;else if(O>=s){var ee=l?null:oE(o);if(ee)return lc(ee);P=!1,S=zo,W=new qs}else W=l?[]:j;e:for(;++y<O;){var re=o[y],se=l?l(re):re;if(re=f||re!==0?re:0,P&&se===se){for(var me=W.length;me--;)if(W[me]===se)continue e;l&&W.push(se),j.push(re)}else S(W,se,f)||(W!==j&&W.push(se),j.push(re))}return j}function xh(o,l){return l=ws(l,o),o=Jm(o,l),o==null||delete o[In(tn(l))]}function Tm(o,l,f,y){return Jo(o,l,f(Zs(o,l)),y)}function Ac(o,l,f,y){for(var S=o.length,O=y?S:-1;(y?O--:++O<S)&&l(o[O],O,o););return f?en(o,y?0:O,y?O+1:S):en(o,y?O+1:0,y?S:O)}function Em(o,l){var f=o;return f instanceof Ye&&(f=f.value()),Zu(l,function(y,S){return S.func.apply(S.thisArg,gs([y],S.args))},f)}function Sh(o,l,f){var y=o.length;if(y<2)return y?bs(o[0]):[];for(var S=-1,O=q(y);++S<y;)for(var P=o[S],j=-1;++j<y;)j!=S&&(O[S]=qo(O[S]||P,o[j],l,f));return bs(tr(O,1),l,f)}function km(o,l,f){for(var y=-1,S=o.length,O=l.length,P={};++y<S;){var j=y<O?l[y]:t;f(P,o[y],j)}return P}function Ch(o){return Dt(o)?o:[]}function Th(o){return typeof o=="function"?o:Mr}function ws(o,l){return je(o)?o:Rh(o,l)?[o]:rv(ot(o))}var KT=He;function _s(o,l,f){var y=o.length;return f=f===t?y:f,!l&&f>=y?o:en(o,l,f)}var Om=FC||function(o){return er.clearTimeout(o)};function Am(o,l){if(l)return o.slice();var f=o.length,y=Kg?Kg(f):new o.constructor(f);return o.copy(y),y}function Eh(o){var l=new o.constructor(o.byteLength);return new gc(l).set(new gc(o)),l}function ZT(o,l){var f=l?Eh(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.byteLength)}function JT(o){var l=new o.constructor(o.source,Ee.exec(o));return l.lastIndex=o.lastIndex,l}function QT(o){return Xo?ut(Xo.call(o)):{}}function Im(o,l){var f=l?Eh(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.length)}function Mm(o,l){if(o!==l){var f=o!==t,y=o===null,S=o===o,O=Br(o),P=l!==t,j=l===null,W=l===l,ee=Br(l);if(!j&&!ee&&!O&&o>l||O&&P&&W&&!j&&!ee||y&&P&&W||!f&&W||!S)return 1;if(!y&&!O&&!ee&&o<l||ee&&f&&S&&!y&&!O||j&&f&&S||!P&&S||!W)return-1}return 0}function eE(o,l,f){for(var y=-1,S=o.criteria,O=l.criteria,P=S.length,j=f.length;++y<P;){var W=Mm(S[y],O[y]);if(W){if(y>=j)return W;var ee=f[y];return W*(ee=="desc"?-1:1)}}return o.index-l.index}function Pm(o,l,f,y){for(var S=-1,O=o.length,P=f.length,j=-1,W=l.length,ee=Ut(O-P,0),re=q(W+ee),se=!y;++j<W;)re[j]=l[j];for(;++S<P;)(se||S<O)&&(re[f[S]]=o[S]);for(;ee--;)re[j++]=o[S++];return re}function Dm(o,l,f,y){for(var S=-1,O=o.length,P=-1,j=f.length,W=-1,ee=l.length,re=Ut(O-j,0),se=q(re+ee),me=!y;++S<re;)se[S]=o[S];for(var Te=S;++W<ee;)se[Te+W]=l[W];for(;++P<j;)(me||S<O)&&(se[Te+f[P]]=o[S++]);return se}function Or(o,l){var f=-1,y=o.length;for(l||(l=q(y));++f<y;)l[f]=o[f];return l}function An(o,l,f,y){var S=!f;f||(f={});for(var O=-1,P=l.length;++O<P;){var j=l[O],W=y?y(f[j],o[j],j,f,o):t;W===t&&(W=o[j]),S?Un(f,j,W):Go(f,j,W)}return f}function tE(o,l){return An(o,Dh(o),l)}function rE(o,l){return An(o,Ym(o),l)}function Ic(o,l){return function(f,y){var S=je(f)?aC:CT,O=l?l():{};return S(f,o,Oe(y,2),O)}}function Gi(o){return He(function(l,f){var y=-1,S=f.length,O=S>1?f[S-1]:t,P=S>2?f[2]:t;for(O=o.length>3&&typeof O=="function"?(S--,O):t,P&&vr(f[0],f[1],P)&&(O=S<3?t:O,S=1),l=ut(l);++y<S;){var j=f[y];j&&o(l,j,y,O)}return l})}function Rm(o,l){return function(f,y){if(f==null)return f;if(!Ar(f))return o(f,y);for(var S=f.length,O=l?S:-1,P=ut(f);(l?O--:++O<S)&&y(P[O],O,P)!==!1;);return f}}function jm(o){return function(l,f,y){for(var S=-1,O=ut(l),P=y(l),j=P.length;j--;){var W=P[o?j:++S];if(f(O[W],W,O)===!1)break}return l}}function nE(o,l,f){var y=l&C,S=Qo(o);function O(){var P=this&&this!==er&&this instanceof O?S:o;return P.apply(y?f:this,arguments)}return O}function Lm(o){return function(l){l=ot(l);var f=Hi(l)?dn(l):t,y=f?f[0]:l.charAt(0),S=f?_s(f,1).join(""):l.slice(1);return y[o]()+S}}function qi(o){return function(l){return Zu(Rv(Dv(l).replace(XS,"")),o,"")}}function Qo(o){return function(){var l=arguments;switch(l.length){case 0:return new o;case 1:return new o(l[0]);case 2:return new o(l[0],l[1]);case 3:return new o(l[0],l[1],l[2]);case 4:return new o(l[0],l[1],l[2],l[3]);case 5:return new o(l[0],l[1],l[2],l[3],l[4]);case 6:return new o(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new o(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var f=Xi(o.prototype),y=o.apply(f,l);return xt(y)?y:f}}function sE(o,l,f){var y=Qo(o);function S(){for(var O=arguments.length,P=q(O),j=O,W=Ki(S);j--;)P[j]=arguments[j];var ee=O<3&&P[0]!==W&&P[O-1]!==W?[]:ms(P,W);if(O-=ee.length,O<f)return Hm(o,l,Mc,S.placeholder,t,P,ee,t,t,f-O);var re=this&&this!==er&&this instanceof S?y:o;return Lr(re,this,P)}return S}function Fm(o){return function(l,f,y){var S=ut(l);if(!Ar(l)){var O=Oe(f,3);l=Jt(l),f=function(j){return O(S[j],j,S)}}var P=o(l,f,y);return P>-1?S[O?l[P]:P]:t}}function Nm(o){return Yn(function(l){var f=l.length,y=f,S=Jr.prototype.thru;for(o&&l.reverse();y--;){var O=l[y];if(typeof O!="function")throw new Zr(a);if(S&&!P&&jc(O)=="wrapper")var P=new Jr([],!0)}for(y=P?y:f;++y<f;){O=l[y];var j=jc(O),W=j=="wrapper"?Mh(O):t;W&&jh(W[0])&&W[1]==(U|A|D|B)&&!W[4].length&&W[9]==1?P=P[jc(W[0])].apply(P,W[3]):P=O.length==1&&jh(O)?P[j]():P.thru(O)}return function(){var ee=arguments,re=ee[0];if(P&&ee.length==1&&je(re))return P.plant(re).value();for(var se=0,me=f?l[se].apply(this,ee):re;++se<f;)me=l[se].call(this,me);return me}})}function Mc(o,l,f,y,S,O,P,j,W,ee){var re=l&U,se=l&C,me=l&T,Te=l&(A|I),Ae=l&X,Ve=me?t:Qo(o);function Ie(){for(var We=arguments.length,Ke=q(We),Vr=We;Vr--;)Ke[Vr]=arguments[Vr];if(Te)var yr=Ki(Ie),Hr=mC(Ke,yr);if(y&&(Ke=Pm(Ke,y,S,Te)),O&&(Ke=Dm(Ke,O,P,Te)),We-=Hr,Te&&We<ee){var Rt=ms(Ke,yr);return Hm(o,l,Mc,Ie.placeholder,f,Ke,Rt,j,W,ee-We)}var gn=se?f:this,Kn=me?gn[o]:o;return We=Ke.length,j?Ke=CE(Ke,j):Ae&&We>1&&Ke.reverse(),re&&W<We&&(Ke.length=W),this&&this!==er&&this instanceof Ie&&(Kn=Ve||Qo(Kn)),Kn.apply(gn,Ke)}return Ie}function Bm(o,l){return function(f,y){return PT(f,o,l(y),{})}}function Pc(o,l){return function(f,y){var S;if(f===t&&y===t)return l;if(f!==t&&(S=f),y!==t){if(S===t)return y;typeof f=="string"||typeof y=="string"?(f=Nr(f),y=Nr(y)):(f=Cm(f),y=Cm(y)),S=o(f,y)}return S}}function kh(o){return Yn(function(l){return l=mt(l,Fr(Oe())),He(function(f){var y=this;return o(l,function(S){return Lr(S,y,f)})})})}function Dc(o,l){l=l===t?" ":Nr(l);var f=l.length;if(f<2)return f?wh(l,o):l;var y=wh(l,bc(o/zi(l)));return Hi(l)?_s(dn(y),0,o).join(""):y.slice(0,o)}function iE(o,l,f,y){var S=l&C,O=Qo(o);function P(){for(var j=-1,W=arguments.length,ee=-1,re=y.length,se=q(re+W),me=this&&this!==er&&this instanceof P?O:o;++ee<re;)se[ee]=y[ee];for(;W--;)se[ee++]=arguments[++j];return Lr(me,S?f:this,se)}return P}function Vm(o){return function(l,f,y){return y&&typeof y!="number"&&vr(l,f,y)&&(f=y=t),l=qn(l),f===t?(f=l,l=0):f=qn(f),y=y===t?l<f?1:-1:qn(y),UT(l,f,y,o)}}function Rc(o){return function(l,f){return typeof l=="string"&&typeof f=="string"||(l=rn(l),f=rn(f)),o(l,f)}}function Hm(o,l,f,y,S,O,P,j,W,ee){var re=l&A,se=re?P:t,me=re?t:P,Te=re?O:t,Ae=re?t:O;l|=re?D:F,l&=~(re?F:D),l&k||(l&=-4);var Ve=[o,l,S,Te,se,Ae,me,j,W,ee],Ie=f.apply(t,Ve);return jh(o)&&Qm(Ie,Ve),Ie.placeholder=y,ev(Ie,o,l)}function Oh(o){var l=Wt[o];return function(f,y){if(f=rn(f),y=y==null?0:or(Le(y),292),y&&em(f)){var S=(ot(f)+"e").split("e"),O=l(S[0]+"e"+(+S[1]+y));return S=(ot(O)+"e").split("e"),+(S[0]+"e"+(+S[1]-y))}return l(f)}}var oE=$i&&1/lc(new $i([,-0]))[1]==ge?function(o){return new $i(o)}:Kh;function zm(o){return function(l){var f=ar(l);return f==it?sh(l):f==R?SC(l):gC(l,o(l))}}function $n(o,l,f,y,S,O,P,j){var W=l&T;if(!W&&typeof o!="function")throw new Zr(a);var ee=y?y.length:0;if(ee||(l&=-97,y=S=t),P=P===t?P:Ut(Le(P),0),j=j===t?j:Le(j),ee-=S?S.length:0,l&F){var re=y,se=S;y=S=t}var me=W?t:Mh(o),Te=[o,l,f,y,S,re,se,O,P,j];if(me&&_E(Te,me),o=Te[0],l=Te[1],f=Te[2],y=Te[3],S=Te[4],j=Te[9]=Te[9]===t?W?0:o.length:Ut(Te[9]-ee,0),!j&&l&(A|I)&&(l&=-25),!l||l==C)var Ae=nE(o,l,f);else l==A||l==I?Ae=sE(o,l,j):(l==D||l==(C|D))&&!S.length?Ae=iE(o,l,f,y):Ae=Mc.apply(t,Te);var Ve=me?xm:Qm;return ev(Ve(Ae,Te),o,l)}function Wm(o,l,f,y){return o===t||pn(o,Ui[f])&&!ct.call(y,f)?l:o}function Um(o,l,f,y,S,O){return xt(o)&&xt(l)&&(O.set(l,o),kc(o,l,t,Um,O),O.delete(l)),o}function aE(o){return ra(o)?t:o}function $m(o,l,f,y,S,O){var P=f&b,j=o.length,W=l.length;if(j!=W&&!(P&&W>j))return!1;var ee=O.get(o),re=O.get(l);if(ee&&re)return ee==l&&re==o;var se=-1,me=!0,Te=f&x?new qs:t;for(O.set(o,l),O.set(l,o);++se<j;){var Ae=o[se],Ve=l[se];if(y)var Ie=P?y(Ve,Ae,se,l,o,O):y(Ae,Ve,se,o,l,O);if(Ie!==t){if(Ie)continue;me=!1;break}if(Te){if(!Ju(l,function(We,Ke){if(!zo(Te,Ke)&&(Ae===We||S(Ae,We,f,y,O)))return Te.push(Ke)})){me=!1;break}}else if(!(Ae===Ve||S(Ae,Ve,f,y,O))){me=!1;break}}return O.delete(o),O.delete(l),me}function cE(o,l,f,y,S,O,P){switch(f){case _e:if(o.byteLength!=l.byteLength||o.byteOffset!=l.byteOffset)return!1;o=o.buffer,l=l.buffer;case ke:return!(o.byteLength!=l.byteLength||!O(new gc(o),new gc(l)));case ze:case bt:case Tt:return pn(+o,+l);case Vt:return o.name==l.name&&o.message==l.message;case sr:case he:return o==l+"";case it:var j=sh;case R:var W=y&b;if(j||(j=lc),o.size!=l.size&&!W)return!1;var ee=P.get(o);if(ee)return ee==l;y|=x,P.set(o,l);var re=$m(j(o),j(l),y,S,O,P);return P.delete(o),re;case pe:if(Xo)return Xo.call(o)==Xo.call(l)}return!1}function lE(o,l,f,y,S,O){var P=f&b,j=Ah(o),W=j.length,ee=Ah(l),re=ee.length;if(W!=re&&!P)return!1;for(var se=W;se--;){var me=j[se];if(!(P?me in l:ct.call(l,me)))return!1}var Te=O.get(o),Ae=O.get(l);if(Te&&Ae)return Te==l&&Ae==o;var Ve=!0;O.set(o,l),O.set(l,o);for(var Ie=P;++se<W;){me=j[se];var We=o[me],Ke=l[me];if(y)var Vr=P?y(Ke,We,me,l,o,O):y(We,Ke,me,o,l,O);if(!(Vr===t?We===Ke||S(We,Ke,f,y,O):Vr)){Ve=!1;break}Ie||(Ie=me=="constructor")}if(Ve&&!Ie){var yr=o.constructor,Hr=l.constructor;yr!=Hr&&"constructor"in o&&"constructor"in l&&!(typeof yr=="function"&&yr instanceof yr&&typeof Hr=="function"&&Hr instanceof Hr)&&(Ve=!1)}return O.delete(o),O.delete(l),Ve}function Yn(o){return Fh(Zm(o,t,ov),o+"")}function Ah(o){return hm(o,Jt,Dh)}function Ih(o){return hm(o,Ir,Ym)}var Mh=_c?function(o){return _c.get(o)}:Kh;function jc(o){for(var l=o.name+"",f=Yi[l],y=ct.call(Yi,l)?f.length:0;y--;){var S=f[y],O=S.func;if(O==null||O==o)return S.name}return l}function Ki(o){var l=ct.call(E,"placeholder")?E:o;return l.placeholder}function Oe(){var o=E.iteratee||Gh;return o=o===Gh?pm:o,arguments.length?o(arguments[0],arguments[1]):o}function Lc(o,l){var f=o.__data__;return vE(l)?f[typeof l=="string"?"string":"hash"]:f.map}function Ph(o){for(var l=Jt(o),f=l.length;f--;){var y=l[f],S=o[y];l[f]=[y,S,qm(S)]}return l}function Js(o,l){var f=wC(o,l);return fm(f)?f:t}function uE(o){var l=ct.call(o,Xs),f=o[Xs];try{o[Xs]=t;var y=!0}catch{}var S=fc.call(o);return y&&(l?o[Xs]=f:delete o[Xs]),S}var Dh=oh?function(o){return o==null?[]:(o=ut(o),ps(oh(o),function(l){return Jg.call(o,l)}))}:Zh,Ym=oh?function(o){for(var l=[];o;)gs(l,Dh(o)),o=mc(o);return l}:Zh,ar=mr;(ah&&ar(new ah(new ArrayBuffer(1)))!=_e||Uo&&ar(new Uo)!=it||ch&&ar(ch.resolve())!=Pt||$i&&ar(new $i)!=R||$o&&ar(new $o)!=Je)&&(ar=function(o){var l=mr(o),f=l==tt?o.constructor:t,y=f?Qs(f):"";if(y)switch(y){case YC:return _e;case XC:return it;case GC:return Pt;case qC:return R;case KC:return Je}return l});function hE(o,l,f){for(var y=-1,S=f.length;++y<S;){var O=f[y],P=O.size;switch(O.type){case"drop":o+=P;break;case"dropRight":l-=P;break;case"take":l=or(l,o+P);break;case"takeRight":o=Ut(o,l-P);break}}return{start:o,end:l}}function dE(o){var l=o.match(ic);return l?l[1].split(_):[]}function Xm(o,l,f){l=ws(l,o);for(var y=-1,S=l.length,O=!1;++y<S;){var P=In(l[y]);if(!(O=o!=null&&f(o,P)))break;o=o[P]}return O||++y!=S?O:(S=o==null?0:o.length,!!S&&Wc(S)&&Xn(P,S)&&(je(o)||ei(o)))}function fE(o){var l=o.length,f=new o.constructor(l);return l&&typeof o[0]=="string"&&ct.call(o,"index")&&(f.index=o.index,f.input=o.input),f}function Gm(o){return typeof o.constructor=="function"&&!ea(o)?Xi(mc(o)):{}}function pE(o,l,f){var y=o.constructor;switch(l){case ke:return Eh(o);case ze:case bt:return new y(+o);case _e:return ZT(o,f);case Ht:case _t:case zt:case Er:case Qt:case jr:case Kt:case hs:case ds:return Im(o,f);case it:return new y;case Tt:case he:return new y(o);case sr:return JT(o);case R:return new y;case pe:return QT(o)}}function gE(o,l){var f=l.length;if(!f)return o;var y=f-1;return l[y]=(f>1?"& ":"")+l[y],l=l.join(f>2?", ":" "),o.replace(Ho,`{
/* [wrapped with `+l+`] */
`)}function mE(o){return je(o)||ei(o)||!!(Qg&&o&&o[Qg])}function Xn(o,l){var f=typeof o;return l=l??de,!!l&&(f=="number"||f!="symbol"&&ir.test(o))&&o>-1&&o%1==0&&o<l}function vr(o,l,f){if(!xt(f))return!1;var y=typeof l;return(y=="number"?Ar(f)&&Xn(l,f.length):y=="string"&&l in f)?pn(f[l],o):!1}function Rh(o,l){if(je(o))return!1;var f=typeof o;return f=="number"||f=="symbol"||f=="boolean"||o==null||Br(o)?!0:Us.test(o)||!Fi.test(o)||l!=null&&o in ut(l)}function vE(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}function jh(o){var l=jc(o),f=E[l];if(typeof f!="function"||!(l in Ye.prototype))return!1;if(o===f)return!0;var y=Mh(f);return!!y&&o===y[0]}function yE(o){return!!qg&&qg in o}var bE=hc?Gn:Jh;function ea(o){var l=o&&o.constructor,f=typeof l=="function"&&l.prototype||Ui;return o===f}function qm(o){return o===o&&!xt(o)}function Km(o,l){return function(f){return f==null?!1:f[o]===l&&(l!==t||o in ut(f))}}function wE(o){var l=Hc(o,function(y){return f.size===h&&f.clear(),y}),f=l.cache;return l}function _E(o,l){var f=o[1],y=l[1],S=f|y,O=S<(C|T|U),P=y==U&&f==A||y==U&&f==B&&o[7].length<=l[8]||y==(U|B)&&l[7].length<=l[8]&&f==A;if(!(O||P))return o;y&C&&(o[2]=l[2],S|=f&C?0:k);var j=l[3];if(j){var W=o[3];o[3]=W?Pm(W,j,l[4]):j,o[4]=W?ms(o[3],d):l[4]}return j=l[5],j&&(W=o[5],o[5]=W?Dm(W,j,l[6]):j,o[6]=W?ms(o[5],d):l[6]),j=l[7],j&&(o[7]=j),y&U&&(o[8]=o[8]==null?l[8]:or(o[8],l[8])),o[9]==null&&(o[9]=l[9]),o[0]=l[0],o[1]=S,o}function xE(o){var l=[];if(o!=null)for(var f in ut(o))l.push(f);return l}function SE(o){return fc.call(o)}function Zm(o,l,f){return l=Ut(l===t?o.length-1:l,0),function(){for(var y=arguments,S=-1,O=Ut(y.length-l,0),P=q(O);++S<O;)P[S]=y[l+S];S=-1;for(var j=q(l+1);++S<l;)j[S]=y[S];return j[l]=f(P),Lr(o,this,j)}}function Jm(o,l){return l.length<2?o:Zs(o,en(l,0,-1))}function CE(o,l){for(var f=o.length,y=or(l.length,f),S=Or(o);y--;){var O=l[y];o[y]=Xn(O,f)?S[O]:t}return o}function Lh(o,l){if(!(l==="constructor"&&typeof o[l]=="function")&&l!="__proto__")return o[l]}var Qm=tv(xm),ta=BC||function(o,l){return er.setTimeout(o,l)},Fh=tv(XT);function ev(o,l,f){var y=l+"";return Fh(o,gE(y,TE(dE(y),f)))}function tv(o){var l=0,f=0;return function(){var y=WC(),S=K-(y-f);if(f=y,S>0){if(++l>=G)return arguments[0]}else l=0;return o.apply(t,arguments)}}function Fc(o,l){var f=-1,y=o.length,S=y-1;for(l=l===t?y:l;++f<l;){var O=bh(f,S),P=o[O];o[O]=o[f],o[f]=P}return o.length=l,o}var rv=wE(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(qe,function(f,y,S,O){l.push(S?O.replace(ae,"$1"):y||f)}),l});function In(o){if(typeof o=="string"||Br(o))return o;var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function Qs(o){if(o!=null){try{return dc.call(o)}catch{}try{return o+""}catch{}}return""}function TE(o,l){return Kr(be,function(f){var y="_."+f[0];l&f[1]&&!ac(o,y)&&o.push(y)}),o.sort()}function nv(o){if(o instanceof Ye)return o.clone();var l=new Jr(o.__wrapped__,o.__chain__);return l.__actions__=Or(o.__actions__),l.__index__=o.__index__,l.__values__=o.__values__,l}function EE(o,l,f){(f?vr(o,l,f):l===t)?l=1:l=Ut(Le(l),0);var y=o==null?0:o.length;if(!y||l<1)return[];for(var S=0,O=0,P=q(bc(y/l));S<y;)P[O++]=en(o,S,S+=l);return P}function kE(o){for(var l=-1,f=o==null?0:o.length,y=0,S=[];++l<f;){var O=o[l];O&&(S[y++]=O)}return S}function OE(){var o=arguments.length;if(!o)return[];for(var l=q(o-1),f=arguments[0],y=o;y--;)l[y-1]=arguments[y];return gs(je(f)?Or(f):[f],tr(l,1))}var AE=He(function(o,l){return Dt(o)?qo(o,tr(l,1,Dt,!0)):[]}),IE=He(function(o,l){var f=tn(l);return Dt(f)&&(f=t),Dt(o)?qo(o,tr(l,1,Dt,!0),Oe(f,2)):[]}),ME=He(function(o,l){var f=tn(l);return Dt(f)&&(f=t),Dt(o)?qo(o,tr(l,1,Dt,!0),t,f):[]});function PE(o,l,f){var y=o==null?0:o.length;return y?(l=f||l===t?1:Le(l),en(o,l<0?0:l,y)):[]}function DE(o,l,f){var y=o==null?0:o.length;return y?(l=f||l===t?1:Le(l),l=y-l,en(o,0,l<0?0:l)):[]}function RE(o,l){return o&&o.length?Ac(o,Oe(l,3),!0,!0):[]}function jE(o,l){return o&&o.length?Ac(o,Oe(l,3),!0):[]}function LE(o,l,f,y){var S=o==null?0:o.length;return S?(f&&typeof f!="number"&&vr(o,l,f)&&(f=0,y=S),OT(o,l,f,y)):[]}function sv(o,l,f){var y=o==null?0:o.length;if(!y)return-1;var S=f==null?0:Le(f);return S<0&&(S=Ut(y+S,0)),cc(o,Oe(l,3),S)}function iv(o,l,f){var y=o==null?0:o.length;if(!y)return-1;var S=y-1;return f!==t&&(S=Le(f),S=f<0?Ut(y+S,0):or(S,y-1)),cc(o,Oe(l,3),S,!0)}function ov(o){var l=o==null?0:o.length;return l?tr(o,1):[]}function FE(o){var l=o==null?0:o.length;return l?tr(o,ge):[]}function NE(o,l){var f=o==null?0:o.length;return f?(l=l===t?1:Le(l),tr(o,l)):[]}function BE(o){for(var l=-1,f=o==null?0:o.length,y={};++l<f;){var S=o[l];y[S[0]]=S[1]}return y}function av(o){return o&&o.length?o[0]:t}function VE(o,l,f){var y=o==null?0:o.length;if(!y)return-1;var S=f==null?0:Le(f);return S<0&&(S=Ut(y+S,0)),Vi(o,l,S)}function HE(o){var l=o==null?0:o.length;return l?en(o,0,-1):[]}var zE=He(function(o){var l=mt(o,Ch);return l.length&&l[0]===o[0]?ph(l):[]}),WE=He(function(o){var l=tn(o),f=mt(o,Ch);return l===tn(f)?l=t:f.pop(),f.length&&f[0]===o[0]?ph(f,Oe(l,2)):[]}),UE=He(function(o){var l=tn(o),f=mt(o,Ch);return l=typeof l=="function"?l:t,l&&f.pop(),f.length&&f[0]===o[0]?ph(f,t,l):[]});function $E(o,l){return o==null?"":HC.call(o,l)}function tn(o){var l=o==null?0:o.length;return l?o[l-1]:t}function YE(o,l,f){var y=o==null?0:o.length;if(!y)return-1;var S=y;return f!==t&&(S=Le(f),S=S<0?Ut(y+S,0):or(S,y-1)),l===l?TC(o,l,S):cc(o,Hg,S,!0)}function XE(o,l){return o&&o.length?ym(o,Le(l)):t}var GE=He(cv);function cv(o,l){return o&&o.length&&l&&l.length?yh(o,l):o}function qE(o,l,f){return o&&o.length&&l&&l.length?yh(o,l,Oe(f,2)):o}function KE(o,l,f){return o&&o.length&&l&&l.length?yh(o,l,t,f):o}var ZE=Yn(function(o,l){var f=o==null?0:o.length,y=uh(o,l);return _m(o,mt(l,function(S){return Xn(S,f)?+S:S}).sort(Mm)),y});function JE(o,l){var f=[];if(!(o&&o.length))return f;var y=-1,S=[],O=o.length;for(l=Oe(l,3);++y<O;){var P=o[y];l(P,y,o)&&(f.push(P),S.push(y))}return _m(o,S),f}function Nh(o){return o==null?o:$C.call(o)}function QE(o,l,f){var y=o==null?0:o.length;return y?(f&&typeof f!="number"&&vr(o,l,f)?(l=0,f=y):(l=l==null?0:Le(l),f=f===t?y:Le(f)),en(o,l,f)):[]}function e2(o,l){return Oc(o,l)}function t2(o,l,f){return _h(o,l,Oe(f,2))}function r2(o,l){var f=o==null?0:o.length;if(f){var y=Oc(o,l);if(y<f&&pn(o[y],l))return y}return-1}function n2(o,l){return Oc(o,l,!0)}function s2(o,l,f){return _h(o,l,Oe(f,2),!0)}function i2(o,l){var f=o==null?0:o.length;if(f){var y=Oc(o,l,!0)-1;if(pn(o[y],l))return y}return-1}function o2(o){return o&&o.length?Sm(o):[]}function a2(o,l){return o&&o.length?Sm(o,Oe(l,2)):[]}function c2(o){var l=o==null?0:o.length;return l?en(o,1,l):[]}function l2(o,l,f){return o&&o.length?(l=f||l===t?1:Le(l),en(o,0,l<0?0:l)):[]}function u2(o,l,f){var y=o==null?0:o.length;return y?(l=f||l===t?1:Le(l),l=y-l,en(o,l<0?0:l,y)):[]}function h2(o,l){return o&&o.length?Ac(o,Oe(l,3),!1,!0):[]}function d2(o,l){return o&&o.length?Ac(o,Oe(l,3)):[]}var f2=He(function(o){return bs(tr(o,1,Dt,!0))}),p2=He(function(o){var l=tn(o);return Dt(l)&&(l=t),bs(tr(o,1,Dt,!0),Oe(l,2))}),g2=He(function(o){var l=tn(o);return l=typeof l=="function"?l:t,bs(tr(o,1,Dt,!0),t,l)});function m2(o){return o&&o.length?bs(o):[]}function v2(o,l){return o&&o.length?bs(o,Oe(l,2)):[]}function y2(o,l){return l=typeof l=="function"?l:t,o&&o.length?bs(o,t,l):[]}function Bh(o){if(!(o&&o.length))return[];var l=0;return o=ps(o,function(f){if(Dt(f))return l=Ut(f.length,l),!0}),rh(l,function(f){return mt(o,Qu(f))})}function lv(o,l){if(!(o&&o.length))return[];var f=Bh(o);return l==null?f:mt(f,function(y){return Lr(l,t,y)})}var b2=He(function(o,l){return Dt(o)?qo(o,l):[]}),w2=He(function(o){return Sh(ps(o,Dt))}),_2=He(function(o){var l=tn(o);return Dt(l)&&(l=t),Sh(ps(o,Dt),Oe(l,2))}),x2=He(function(o){var l=tn(o);return l=typeof l=="function"?l:t,Sh(ps(o,Dt),t,l)}),S2=He(Bh);function C2(o,l){return km(o||[],l||[],Go)}function T2(o,l){return km(o||[],l||[],Jo)}var E2=He(function(o){var l=o.length,f=l>1?o[l-1]:t;return f=typeof f=="function"?(o.pop(),f):t,lv(o,f)});function uv(o){var l=E(o);return l.__chain__=!0,l}function k2(o,l){return l(o),o}function Nc(o,l){return l(o)}var O2=Yn(function(o){var l=o.length,f=l?o[0]:0,y=this.__wrapped__,S=function(O){return uh(O,o)};return l>1||this.__actions__.length||!(y instanceof Ye)||!Xn(f)?this.thru(S):(y=y.slice(f,+f+(l?1:0)),y.__actions__.push({func:Nc,args:[S],thisArg:t}),new Jr(y,this.__chain__).thru(function(O){return l&&!O.length&&O.push(t),O}))});function A2(){return uv(this)}function I2(){return new Jr(this.value(),this.__chain__)}function M2(){this.__values__===t&&(this.__values__=Cv(this.value()));var o=this.__index__>=this.__values__.length,l=o?t:this.__values__[this.__index__++];return{done:o,value:l}}function P2(){return this}function D2(o){for(var l,f=this;f instanceof Sc;){var y=nv(f);y.__index__=0,y.__values__=t,l?S.__wrapped__=y:l=y;var S=y;f=f.__wrapped__}return S.__wrapped__=o,l}function R2(){var o=this.__wrapped__;if(o instanceof Ye){var l=o;return this.__actions__.length&&(l=new Ye(this)),l=l.reverse(),l.__actions__.push({func:Nc,args:[Nh],thisArg:t}),new Jr(l,this.__chain__)}return this.thru(Nh)}function j2(){return Em(this.__wrapped__,this.__actions__)}var L2=Ic(function(o,l,f){ct.call(o,f)?++o[f]:Un(o,f,1)});function F2(o,l,f){var y=je(o)?Bg:kT;return f&&vr(o,l,f)&&(l=t),y(o,Oe(l,3))}function N2(o,l){var f=je(o)?ps:lm;return f(o,Oe(l,3))}var B2=Fm(sv),V2=Fm(iv);function H2(o,l){return tr(Bc(o,l),1)}function z2(o,l){return tr(Bc(o,l),ge)}function W2(o,l,f){return f=f===t?1:Le(f),tr(Bc(o,l),f)}function hv(o,l){var f=je(o)?Kr:ys;return f(o,Oe(l,3))}function dv(o,l){var f=je(o)?cC:cm;return f(o,Oe(l,3))}var U2=Ic(function(o,l,f){ct.call(o,f)?o[f].push(l):Un(o,f,[l])});function $2(o,l,f,y){o=Ar(o)?o:Ji(o),f=f&&!y?Le(f):0;var S=o.length;return f<0&&(f=Ut(S+f,0)),Uc(o)?f<=S&&o.indexOf(l,f)>-1:!!S&&Vi(o,l,f)>-1}var Y2=He(function(o,l,f){var y=-1,S=typeof l=="function",O=Ar(o)?q(o.length):[];return ys(o,function(P){O[++y]=S?Lr(l,P,f):Ko(P,l,f)}),O}),X2=Ic(function(o,l,f){Un(o,f,l)});function Bc(o,l){var f=je(o)?mt:gm;return f(o,Oe(l,3))}function G2(o,l,f,y){return o==null?[]:(je(l)||(l=l==null?[]:[l]),f=y?t:f,je(f)||(f=f==null?[]:[f]),bm(o,l,f))}var q2=Ic(function(o,l,f){o[f?0:1].push(l)},function(){return[[],[]]});function K2(o,l,f){var y=je(o)?Zu:Wg,S=arguments.length<3;return y(o,Oe(l,4),f,S,ys)}function Z2(o,l,f){var y=je(o)?lC:Wg,S=arguments.length<3;return y(o,Oe(l,4),f,S,cm)}function J2(o,l){var f=je(o)?ps:lm;return f(o,zc(Oe(l,3)))}function Q2(o){var l=je(o)?sm:$T;return l(o)}function ek(o,l,f){(f?vr(o,l,f):l===t)?l=1:l=Le(l);var y=je(o)?xT:YT;return y(o,l)}function tk(o){var l=je(o)?ST:GT;return l(o)}function rk(o){if(o==null)return 0;if(Ar(o))return Uc(o)?zi(o):o.length;var l=ar(o);return l==it||l==R?o.size:mh(o).length}function nk(o,l,f){var y=je(o)?Ju:qT;return f&&vr(o,l,f)&&(l=t),y(o,Oe(l,3))}var sk=He(function(o,l){if(o==null)return[];var f=l.length;return f>1&&vr(o,l[0],l[1])?l=[]:f>2&&vr(l[0],l[1],l[2])&&(l=[l[0]]),bm(o,tr(l,1),[])}),Vc=NC||function(){return er.Date.now()};function ik(o,l){if(typeof l!="function")throw new Zr(a);return o=Le(o),function(){if(--o<1)return l.apply(this,arguments)}}function fv(o,l,f){return l=f?t:l,l=o&&l==null?o.length:l,$n(o,U,t,t,t,t,l)}function pv(o,l){var f;if(typeof l!="function")throw new Zr(a);return o=Le(o),function(){return--o>0&&(f=l.apply(this,arguments)),o<=1&&(l=t),f}}var Vh=He(function(o,l,f){var y=C;if(f.length){var S=ms(f,Ki(Vh));y|=D}return $n(o,y,l,f,S)}),gv=He(function(o,l,f){var y=C|T;if(f.length){var S=ms(f,Ki(gv));y|=D}return $n(l,y,o,f,S)});function mv(o,l,f){l=f?t:l;var y=$n(o,A,t,t,t,t,t,l);return y.placeholder=mv.placeholder,y}function vv(o,l,f){l=f?t:l;var y=$n(o,I,t,t,t,t,t,l);return y.placeholder=vv.placeholder,y}function yv(o,l,f){var y,S,O,P,j,W,ee=0,re=!1,se=!1,me=!0;if(typeof o!="function")throw new Zr(a);l=rn(l)||0,xt(f)&&(re=!!f.leading,se="maxWait"in f,O=se?Ut(rn(f.maxWait)||0,l):O,me="trailing"in f?!!f.trailing:me);function Te(Rt){var gn=y,Kn=S;return y=S=t,ee=Rt,P=o.apply(Kn,gn),P}function Ae(Rt){return ee=Rt,j=ta(We,l),re?Te(Rt):P}function Ve(Rt){var gn=Rt-W,Kn=Rt-ee,Fv=l-gn;return se?or(Fv,O-Kn):Fv}function Ie(Rt){var gn=Rt-W,Kn=Rt-ee;return W===t||gn>=l||gn<0||se&&Kn>=O}function We(){var Rt=Vc();if(Ie(Rt))return Ke(Rt);j=ta(We,Ve(Rt))}function Ke(Rt){return j=t,me&&y?Te(Rt):(y=S=t,P)}function Vr(){j!==t&&Om(j),ee=0,y=W=S=j=t}function yr(){return j===t?P:Ke(Vc())}function Hr(){var Rt=Vc(),gn=Ie(Rt);if(y=arguments,S=this,W=Rt,gn){if(j===t)return Ae(W);if(se)return Om(j),j=ta(We,l),Te(W)}return j===t&&(j=ta(We,l)),P}return Hr.cancel=Vr,Hr.flush=yr,Hr}var ok=He(function(o,l){return am(o,1,l)}),ak=He(function(o,l,f){return am(o,rn(l)||0,f)});function ck(o){return $n(o,X)}function Hc(o,l){if(typeof o!="function"||l!=null&&typeof l!="function")throw new Zr(a);var f=function(){var y=arguments,S=l?l.apply(this,y):y[0],O=f.cache;if(O.has(S))return O.get(S);var P=o.apply(this,y);return f.cache=O.set(S,P)||O,P};return f.cache=new(Hc.Cache||Wn),f}Hc.Cache=Wn;function zc(o){if(typeof o!="function")throw new Zr(a);return function(){var l=arguments;switch(l.length){case 0:return!o.call(this);case 1:return!o.call(this,l[0]);case 2:return!o.call(this,l[0],l[1]);case 3:return!o.call(this,l[0],l[1],l[2])}return!o.apply(this,l)}}function lk(o){return pv(2,o)}var uk=KT(function(o,l){l=l.length==1&&je(l[0])?mt(l[0],Fr(Oe())):mt(tr(l,1),Fr(Oe()));var f=l.length;return He(function(y){for(var S=-1,O=or(y.length,f);++S<O;)y[S]=l[S].call(this,y[S]);return Lr(o,this,y)})}),Hh=He(function(o,l){var f=ms(l,Ki(Hh));return $n(o,D,t,l,f)}),bv=He(function(o,l){var f=ms(l,Ki(bv));return $n(o,F,t,l,f)}),hk=Yn(function(o,l){return $n(o,B,t,t,t,l)});function dk(o,l){if(typeof o!="function")throw new Zr(a);return l=l===t?l:Le(l),He(o,l)}function fk(o,l){if(typeof o!="function")throw new Zr(a);return l=l==null?0:Ut(Le(l),0),He(function(f){var y=f[l],S=_s(f,0,l);return y&&gs(S,y),Lr(o,this,S)})}function pk(o,l,f){var y=!0,S=!0;if(typeof o!="function")throw new Zr(a);return xt(f)&&(y="leading"in f?!!f.leading:y,S="trailing"in f?!!f.trailing:S),yv(o,l,{leading:y,maxWait:l,trailing:S})}function gk(o){return fv(o,1)}function mk(o,l){return Hh(Th(l),o)}function vk(){if(!arguments.length)return[];var o=arguments[0];return je(o)?o:[o]}function yk(o){return Qr(o,v)}function bk(o,l){return l=typeof l=="function"?l:t,Qr(o,v,l)}function wk(o){return Qr(o,p|v)}function _k(o,l){return l=typeof l=="function"?l:t,Qr(o,p|v,l)}function xk(o,l){return l==null||om(o,l,Jt(l))}function pn(o,l){return o===l||o!==o&&l!==l}var Sk=Rc(fh),Ck=Rc(function(o,l){return o>=l}),ei=dm(function(){return arguments}())?dm:function(o){return Et(o)&&ct.call(o,"callee")&&!Jg.call(o,"callee")},je=q.isArray,Tk=Dg?Fr(Dg):DT;function Ar(o){return o!=null&&Wc(o.length)&&!Gn(o)}function Dt(o){return Et(o)&&Ar(o)}function Ek(o){return o===!0||o===!1||Et(o)&&mr(o)==ze}var xs=VC||Jh,kk=Rg?Fr(Rg):RT;function Ok(o){return Et(o)&&o.nodeType===1&&!ra(o)}function Ak(o){if(o==null)return!0;if(Ar(o)&&(je(o)||typeof o=="string"||typeof o.splice=="function"||xs(o)||Zi(o)||ei(o)))return!o.length;var l=ar(o);if(l==it||l==R)return!o.size;if(ea(o))return!mh(o).length;for(var f in o)if(ct.call(o,f))return!1;return!0}function Ik(o,l){return Zo(o,l)}function Mk(o,l,f){f=typeof f=="function"?f:t;var y=f?f(o,l):t;return y===t?Zo(o,l,t,f):!!y}function zh(o){if(!Et(o))return!1;var l=mr(o);return l==Vt||l==wt||typeof o.message=="string"&&typeof o.name=="string"&&!ra(o)}function Pk(o){return typeof o=="number"&&em(o)}function Gn(o){if(!xt(o))return!1;var l=mr(o);return l==Ce||l==qt||l==Xe||l==Gr}function wv(o){return typeof o=="number"&&o==Le(o)}function Wc(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=de}function xt(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}function Et(o){return o!=null&&typeof o=="object"}var _v=jg?Fr(jg):LT;function Dk(o,l){return o===l||gh(o,l,Ph(l))}function Rk(o,l,f){return f=typeof f=="function"?f:t,gh(o,l,Ph(l),f)}function jk(o){return xv(o)&&o!=+o}function Lk(o){if(bE(o))throw new Re(i);return fm(o)}function Fk(o){return o===null}function Nk(o){return o==null}function xv(o){return typeof o=="number"||Et(o)&&mr(o)==Tt}function ra(o){if(!Et(o)||mr(o)!=tt)return!1;var l=mc(o);if(l===null)return!0;var f=ct.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&dc.call(f)==RC}var Wh=Lg?Fr(Lg):FT;function Bk(o){return wv(o)&&o>=-9007199254740991&&o<=de}var Sv=Fg?Fr(Fg):NT;function Uc(o){return typeof o=="string"||!je(o)&&Et(o)&&mr(o)==he}function Br(o){return typeof o=="symbol"||Et(o)&&mr(o)==pe}var Zi=Ng?Fr(Ng):BT;function Vk(o){return o===t}function Hk(o){return Et(o)&&ar(o)==Je}function zk(o){return Et(o)&&mr(o)==Ge}var Wk=Rc(vh),Uk=Rc(function(o,l){return o<=l});function Cv(o){if(!o)return[];if(Ar(o))return Uc(o)?dn(o):Or(o);if(Wo&&o[Wo])return xC(o[Wo]());var l=ar(o),f=l==it?sh:l==R?lc:Ji;return f(o)}function qn(o){if(!o)return o===0?o:0;if(o=rn(o),o===ge||o===-1/0){var l=o<0?-1:1;return l*ne}return o===o?o:0}function Le(o){var l=qn(o),f=l%1;return l===l?f?l-f:l:0}function Tv(o){return o?Ks(Le(o),0,z):0}function rn(o){if(typeof o=="number")return o;if(Br(o))return M;if(xt(o)){var l=typeof o.valueOf=="function"?o.valueOf():o;o=xt(l)?l+"":l}if(typeof o!="string")return o===0?o:+o;o=Ug(o);var f=rt.test(o);return f||gt.test(o)?iC(o.slice(2),f?2:8):Se.test(o)?M:+o}function Ev(o){return An(o,Ir(o))}function $k(o){return o?Ks(Le(o),-9007199254740991,de):o===0?o:0}function ot(o){return o==null?"":Nr(o)}var Yk=Gi(function(o,l){if(ea(l)||Ar(l)){An(l,Jt(l),o);return}for(var f in l)ct.call(l,f)&&Go(o,f,l[f])}),kv=Gi(function(o,l){An(l,Ir(l),o)}),$c=Gi(function(o,l,f,y){An(l,Ir(l),o,y)}),Xk=Gi(function(o,l,f,y){An(l,Jt(l),o,y)}),Gk=Yn(uh);function qk(o,l){var f=Xi(o);return l==null?f:im(f,l)}var Kk=He(function(o,l){o=ut(o);var f=-1,y=l.length,S=y>2?l[2]:t;for(S&&vr(l[0],l[1],S)&&(y=1);++f<y;)for(var O=l[f],P=Ir(O),j=-1,W=P.length;++j<W;){var ee=P[j],re=o[ee];(re===t||pn(re,Ui[ee])&&!ct.call(o,ee))&&(o[ee]=O[ee])}return o}),Zk=He(function(o){return o.push(t,Um),Lr(Ov,t,o)});function Jk(o,l){return Vg(o,Oe(l,3),On)}function Qk(o,l){return Vg(o,Oe(l,3),dh)}function eO(o,l){return o==null?o:hh(o,Oe(l,3),Ir)}function tO(o,l){return o==null?o:um(o,Oe(l,3),Ir)}function rO(o,l){return o&&On(o,Oe(l,3))}function nO(o,l){return o&&dh(o,Oe(l,3))}function sO(o){return o==null?[]:Ec(o,Jt(o))}function iO(o){return o==null?[]:Ec(o,Ir(o))}function Uh(o,l,f){var y=o==null?t:Zs(o,l);return y===t?f:y}function oO(o,l){return o!=null&&Xm(o,l,AT)}function $h(o,l){return o!=null&&Xm(o,l,IT)}var aO=Bm(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=fc.call(l)),o[l]=f},Xh(Mr)),cO=Bm(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=fc.call(l)),ct.call(o,l)?o[l].push(f):o[l]=[f]},Oe),lO=He(Ko);function Jt(o){return Ar(o)?nm(o):mh(o)}function Ir(o){return Ar(o)?nm(o,!0):VT(o)}function uO(o,l){var f={};return l=Oe(l,3),On(o,function(y,S,O){Un(f,l(y,S,O),y)}),f}function hO(o,l){var f={};return l=Oe(l,3),On(o,function(y,S,O){Un(f,S,l(y,S,O))}),f}var dO=Gi(function(o,l,f){kc(o,l,f)}),Ov=Gi(function(o,l,f,y){kc(o,l,f,y)}),fO=Yn(function(o,l){var f={};if(o==null)return f;var y=!1;l=mt(l,function(O){return O=ws(O,o),y||(y=O.length>1),O}),An(o,Ih(o),f),y&&(f=Qr(f,p|g|v,aE));for(var S=l.length;S--;)xh(f,l[S]);return f});function pO(o,l){return Av(o,zc(Oe(l)))}var gO=Yn(function(o,l){return o==null?{}:zT(o,l)});function Av(o,l){if(o==null)return{};var f=mt(Ih(o),function(y){return[y]});return l=Oe(l),wm(o,f,function(y,S){return l(y,S[0])})}function mO(o,l,f){l=ws(l,o);var y=-1,S=l.length;for(S||(S=1,o=t);++y<S;){var O=o==null?t:o[In(l[y])];O===t&&(y=S,O=f),o=Gn(O)?O.call(o):O}return o}function vO(o,l,f){return o==null?o:Jo(o,l,f)}function yO(o,l,f,y){return y=typeof y=="function"?y:t,o==null?o:Jo(o,l,f,y)}var Iv=zm(Jt),Mv=zm(Ir);function bO(o,l,f){var y=je(o),S=y||xs(o)||Zi(o);if(l=Oe(l,4),f==null){var O=o&&o.constructor;S?f=y?new O:[]:xt(o)?f=Gn(O)?Xi(mc(o)):{}:f={}}return(S?Kr:On)(o,function(P,j,W){return l(f,P,j,W)}),f}function wO(o,l){return o==null?!0:xh(o,l)}function _O(o,l,f){return o==null?o:Tm(o,l,Th(f))}function xO(o,l,f,y){return y=typeof y=="function"?y:t,o==null?o:Tm(o,l,Th(f),y)}function Ji(o){return o==null?[]:nh(o,Jt(o))}function SO(o){return o==null?[]:nh(o,Ir(o))}function CO(o,l,f){return f===t&&(f=l,l=t),f!==t&&(f=rn(f),f=f===f?f:0),l!==t&&(l=rn(l),l=l===l?l:0),Ks(rn(o),l,f)}function TO(o,l,f){return l=qn(l),f===t?(f=l,l=0):f=qn(f),o=rn(o),MT(o,l,f)}function EO(o,l,f){if(f&&typeof f!="boolean"&&vr(o,l,f)&&(l=f=t),f===t&&(typeof l=="boolean"?(f=l,l=t):typeof o=="boolean"&&(f=o,o=t)),o===t&&l===t?(o=0,l=1):(o=qn(o),l===t?(l=o,o=0):l=qn(l)),o>l){var y=o;o=l,l=y}if(f||o%1||l%1){var S=tm();return or(o+S*(l-o+sC("1e-"+((S+"").length-1))),l)}return bh(o,l)}var kO=qi(function(o,l,f){return l=l.toLowerCase(),o+(f?Pv(l):l)});function Pv(o){return Yh(ot(o).toLowerCase())}function Dv(o){return o=ot(o),o&&o.replace(Hn,vC).replace(GS,"")}function OO(o,l,f){o=ot(o),l=Nr(l);var y=o.length;f=f===t?y:Ks(Le(f),0,y);var S=f;return f-=l.length,f>=0&&o.slice(f,S)==l}function AO(o){return o=ot(o),o&&No.test(o)?o.replace(hn,yC):o}function IO(o){return o=ot(o),o&&Zt.test(o)?o.replace($e,"\\$&"):o}var MO=qi(function(o,l,f){return o+(f?"-":"")+l.toLowerCase()}),PO=qi(function(o,l,f){return o+(f?" ":"")+l.toLowerCase()}),DO=Lm("toLowerCase");function RO(o,l,f){o=ot(o),l=Le(l);var y=l?zi(o):0;if(!l||y>=l)return o;var S=(l-y)/2;return Dc(wc(S),f)+o+Dc(bc(S),f)}function jO(o,l,f){o=ot(o),l=Le(l);var y=l?zi(o):0;return l&&y<l?o+Dc(l-y,f):o}function LO(o,l,f){o=ot(o),l=Le(l);var y=l?zi(o):0;return l&&y<l?Dc(l-y,f)+o:o}function FO(o,l,f){return f||l==null?l=0:l&&(l=+l),UC(ot(o).replace(pr,""),l||0)}function NO(o,l,f){return(f?vr(o,l,f):l===t)?l=1:l=Le(l),wh(ot(o),l)}function BO(){var o=arguments,l=ot(o[0]);return o.length<3?l:l.replace(o[1],o[2])}var VO=qi(function(o,l,f){return o+(f?"_":"")+l.toLowerCase()});function HO(o,l,f){return f&&typeof f!="number"&&vr(o,l,f)&&(l=f=t),f=f===t?z:f>>>0,f?(o=ot(o),o&&(typeof l=="string"||l!=null&&!Wh(l))&&(l=Nr(l),!l&&Hi(o))?_s(dn(o),0,f):o.split(l,f)):[]}var zO=qi(function(o,l,f){return o+(f?" ":"")+Yh(l)});function WO(o,l,f){return o=ot(o),f=f==null?0:Ks(Le(f),0,o.length),l=Nr(l),o.slice(f,f+l.length)==l}function UO(o,l,f){var y=E.templateSettings;f&&vr(o,l,f)&&(l=t),o=ot(o),l=$c({},l,y,Wm);var S=$c({},l.imports,y.imports,Wm),O=Jt(S),P=nh(S,O),j,W,ee=0,re=l.interpolate||gr,se="__p += '",me=ih((l.escape||gr).source+"|"+re.source+"|"+(re===Li?xe:gr).source+"|"+(l.evaluate||gr).source+"|$","g"),Te="//# sourceURL="+(ct.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++QS+"]")+`
`;o.replace(me,function(Ie,We,Ke,Vr,yr,Hr){return Ke||(Ke=Vr),se+=o.slice(ee,Hr).replace(Ni,bC),We&&(j=!0,se+=`' +
__e(`+We+`) +
'`),yr&&(W=!0,se+=`';
`+yr+`;
__p += '`),Ke&&(se+=`' +
((__t = (`+Ke+`)) == null ? '' : __t) +
'`),ee=Hr+Ie.length,Ie}),se+=`';
`;var Ae=ct.call(l,"variable")&&l.variable;if(!Ae)se=`with (obj) {
`+se+`
}
`;else if(te.test(Ae))throw new Re(c);se=(W?se.replace(Vn,""):se).replace(kn,"$1").replace(Ri,"$1;"),se="function("+(Ae||"obj")+`) {
`+(Ae?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(j?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+se+`return __p
}`;var Ve=jv(function(){return nt(O,Te+"return "+se).apply(t,P)});if(Ve.source=se,zh(Ve))throw Ve;return Ve}function $O(o){return ot(o).toLowerCase()}function YO(o){return ot(o).toUpperCase()}function XO(o,l,f){if(o=ot(o),o&&(f||l===t))return Ug(o);if(!o||!(l=Nr(l)))return o;var y=dn(o),S=dn(l),O=$g(y,S),P=Yg(y,S)+1;return _s(y,O,P).join("")}function GO(o,l,f){if(o=ot(o),o&&(f||l===t))return o.slice(0,Gg(o)+1);if(!o||!(l=Nr(l)))return o;var y=dn(o),S=Yg(y,dn(l))+1;return _s(y,0,S).join("")}function qO(o,l,f){if(o=ot(o),o&&(f||l===t))return o.replace(pr,"");if(!o||!(l=Nr(l)))return o;var y=dn(o),S=$g(y,dn(l));return _s(y,S).join("")}function KO(o,l){var f=Y,y=Z;if(xt(l)){var S="separator"in l?l.separator:S;f="length"in l?Le(l.length):f,y="omission"in l?Nr(l.omission):y}o=ot(o);var O=o.length;if(Hi(o)){var P=dn(o);O=P.length}if(f>=O)return o;var j=f-zi(y);if(j<1)return y;var W=P?_s(P,0,j).join(""):o.slice(0,j);if(S===t)return W+y;if(P&&(j+=W.length-j),Wh(S)){if(o.slice(j).search(S)){var ee,re=W;for(S.global||(S=ih(S.source,ot(Ee.exec(S))+"g")),S.lastIndex=0;ee=S.exec(re);)var se=ee.index;W=W.slice(0,se===t?j:se)}}else if(o.indexOf(Nr(S),j)!=j){var me=W.lastIndexOf(S);me>-1&&(W=W.slice(0,me))}return W+y}function ZO(o){return o=ot(o),o&&ji.test(o)?o.replace(fs,EC):o}var JO=qi(function(o,l,f){return o+(f?" ":"")+l.toUpperCase()}),Yh=Lm("toUpperCase");function Rv(o,l,f){return o=ot(o),l=f?t:l,l===t?_C(o)?AC(o):dC(o):o.match(l)||[]}var jv=He(function(o,l){try{return Lr(o,t,l)}catch(f){return zh(f)?f:new Re(f)}}),QO=Yn(function(o,l){return Kr(l,function(f){f=In(f),Un(o,f,Vh(o[f],o))}),o});function eA(o){var l=o==null?0:o.length,f=Oe();return o=l?mt(o,function(y){if(typeof y[1]!="function")throw new Zr(a);return[f(y[0]),y[1]]}):[],He(function(y){for(var S=-1;++S<l;){var O=o[S];if(Lr(O[0],this,y))return Lr(O[1],this,y)}})}function tA(o){return ET(Qr(o,p))}function Xh(o){return function(){return o}}function rA(o,l){return o==null||o!==o?l:o}var nA=Nm(),sA=Nm(!0);function Mr(o){return o}function Gh(o){return pm(typeof o=="function"?o:Qr(o,p))}function iA(o){return mm(Qr(o,p))}function oA(o,l){return vm(o,Qr(l,p))}var aA=He(function(o,l){return function(f){return Ko(f,o,l)}}),cA=He(function(o,l){return function(f){return Ko(o,f,l)}});function qh(o,l,f){var y=Jt(l),S=Ec(l,y);f==null&&!(xt(l)&&(S.length||!y.length))&&(f=l,l=o,o=this,S=Ec(l,Jt(l)));var O=!(xt(f)&&"chain"in f)||!!f.chain,P=Gn(o);return Kr(S,function(j){var W=l[j];o[j]=W,P&&(o.prototype[j]=function(){var ee=this.__chain__;if(O||ee){var re=o(this.__wrapped__),se=re.__actions__=Or(this.__actions__);return se.push({func:W,args:arguments,thisArg:o}),re.__chain__=ee,re}return W.apply(o,gs([this.value()],arguments))})}),o}function lA(){return er._===this&&(er._=jC),this}function Kh(){}function uA(o){return o=Le(o),He(function(l){return ym(l,o)})}var hA=kh(mt),dA=kh(Bg),fA=kh(Ju);function Lv(o){return Rh(o)?Qu(In(o)):WT(o)}function pA(o){return function(l){return o==null?t:Zs(o,l)}}var gA=Vm(),mA=Vm(!0);function Zh(){return[]}function Jh(){return!1}function vA(){return{}}function yA(){return""}function bA(){return!0}function wA(o,l){if(o=Le(o),o<1||o>de)return[];var f=z,y=or(o,z);l=Oe(l),o-=z;for(var S=rh(y,l);++f<o;)l(f);return S}function _A(o){return je(o)?mt(o,In):Br(o)?[o]:Or(rv(ot(o)))}function xA(o){var l=++DC;return ot(o)+l}var SA=Pc(function(o,l){return o+l},0),CA=Oh("ceil"),TA=Pc(function(o,l){return o/l},1),EA=Oh("floor");function kA(o){return o&&o.length?Tc(o,Mr,fh):t}function OA(o,l){return o&&o.length?Tc(o,Oe(l,2),fh):t}function AA(o){return zg(o,Mr)}function IA(o,l){return zg(o,Oe(l,2))}function MA(o){return o&&o.length?Tc(o,Mr,vh):t}function PA(o,l){return o&&o.length?Tc(o,Oe(l,2),vh):t}var DA=Pc(function(o,l){return o*l},1),RA=Oh("round"),jA=Pc(function(o,l){return o-l},0);function LA(o){return o&&o.length?th(o,Mr):0}function FA(o,l){return o&&o.length?th(o,Oe(l,2)):0}return E.after=ik,E.ary=fv,E.assign=Yk,E.assignIn=kv,E.assignInWith=$c,E.assignWith=Xk,E.at=Gk,E.before=pv,E.bind=Vh,E.bindAll=QO,E.bindKey=gv,E.castArray=vk,E.chain=uv,E.chunk=EE,E.compact=kE,E.concat=OE,E.cond=eA,E.conforms=tA,E.constant=Xh,E.countBy=L2,E.create=qk,E.curry=mv,E.curryRight=vv,E.debounce=yv,E.defaults=Kk,E.defaultsDeep=Zk,E.defer=ok,E.delay=ak,E.difference=AE,E.differenceBy=IE,E.differenceWith=ME,E.drop=PE,E.dropRight=DE,E.dropRightWhile=RE,E.dropWhile=jE,E.fill=LE,E.filter=N2,E.flatMap=H2,E.flatMapDeep=z2,E.flatMapDepth=W2,E.flatten=ov,E.flattenDeep=FE,E.flattenDepth=NE,E.flip=ck,E.flow=nA,E.flowRight=sA,E.fromPairs=BE,E.functions=sO,E.functionsIn=iO,E.groupBy=U2,E.initial=HE,E.intersection=zE,E.intersectionBy=WE,E.intersectionWith=UE,E.invert=aO,E.invertBy=cO,E.invokeMap=Y2,E.iteratee=Gh,E.keyBy=X2,E.keys=Jt,E.keysIn=Ir,E.map=Bc,E.mapKeys=uO,E.mapValues=hO,E.matches=iA,E.matchesProperty=oA,E.memoize=Hc,E.merge=dO,E.mergeWith=Ov,E.method=aA,E.methodOf=cA,E.mixin=qh,E.negate=zc,E.nthArg=uA,E.omit=fO,E.omitBy=pO,E.once=lk,E.orderBy=G2,E.over=hA,E.overArgs=uk,E.overEvery=dA,E.overSome=fA,E.partial=Hh,E.partialRight=bv,E.partition=q2,E.pick=gO,E.pickBy=Av,E.property=Lv,E.propertyOf=pA,E.pull=GE,E.pullAll=cv,E.pullAllBy=qE,E.pullAllWith=KE,E.pullAt=ZE,E.range=gA,E.rangeRight=mA,E.rearg=hk,E.reject=J2,E.remove=JE,E.rest=dk,E.reverse=Nh,E.sampleSize=ek,E.set=vO,E.setWith=yO,E.shuffle=tk,E.slice=QE,E.sortBy=sk,E.sortedUniq=o2,E.sortedUniqBy=a2,E.split=HO,E.spread=fk,E.tail=c2,E.take=l2,E.takeRight=u2,E.takeRightWhile=h2,E.takeWhile=d2,E.tap=k2,E.throttle=pk,E.thru=Nc,E.toArray=Cv,E.toPairs=Iv,E.toPairsIn=Mv,E.toPath=_A,E.toPlainObject=Ev,E.transform=bO,E.unary=gk,E.union=f2,E.unionBy=p2,E.unionWith=g2,E.uniq=m2,E.uniqBy=v2,E.uniqWith=y2,E.unset=wO,E.unzip=Bh,E.unzipWith=lv,E.update=_O,E.updateWith=xO,E.values=Ji,E.valuesIn=SO,E.without=b2,E.words=Rv,E.wrap=mk,E.xor=w2,E.xorBy=_2,E.xorWith=x2,E.zip=S2,E.zipObject=C2,E.zipObjectDeep=T2,E.zipWith=E2,E.entries=Iv,E.entriesIn=Mv,E.extend=kv,E.extendWith=$c,qh(E,E),E.add=SA,E.attempt=jv,E.camelCase=kO,E.capitalize=Pv,E.ceil=CA,E.clamp=CO,E.clone=yk,E.cloneDeep=wk,E.cloneDeepWith=_k,E.cloneWith=bk,E.conformsTo=xk,E.deburr=Dv,E.defaultTo=rA,E.divide=TA,E.endsWith=OO,E.eq=pn,E.escape=AO,E.escapeRegExp=IO,E.every=F2,E.find=B2,E.findIndex=sv,E.findKey=Jk,E.findLast=V2,E.findLastIndex=iv,E.findLastKey=Qk,E.floor=EA,E.forEach=hv,E.forEachRight=dv,E.forIn=eO,E.forInRight=tO,E.forOwn=rO,E.forOwnRight=nO,E.get=Uh,E.gt=Sk,E.gte=Ck,E.has=oO,E.hasIn=$h,E.head=av,E.identity=Mr,E.includes=$2,E.indexOf=VE,E.inRange=TO,E.invoke=lO,E.isArguments=ei,E.isArray=je,E.isArrayBuffer=Tk,E.isArrayLike=Ar,E.isArrayLikeObject=Dt,E.isBoolean=Ek,E.isBuffer=xs,E.isDate=kk,E.isElement=Ok,E.isEmpty=Ak,E.isEqual=Ik,E.isEqualWith=Mk,E.isError=zh,E.isFinite=Pk,E.isFunction=Gn,E.isInteger=wv,E.isLength=Wc,E.isMap=_v,E.isMatch=Dk,E.isMatchWith=Rk,E.isNaN=jk,E.isNative=Lk,E.isNil=Nk,E.isNull=Fk,E.isNumber=xv,E.isObject=xt,E.isObjectLike=Et,E.isPlainObject=ra,E.isRegExp=Wh,E.isSafeInteger=Bk,E.isSet=Sv,E.isString=Uc,E.isSymbol=Br,E.isTypedArray=Zi,E.isUndefined=Vk,E.isWeakMap=Hk,E.isWeakSet=zk,E.join=$E,E.kebabCase=MO,E.last=tn,E.lastIndexOf=YE,E.lowerCase=PO,E.lowerFirst=DO,E.lt=Wk,E.lte=Uk,E.max=kA,E.maxBy=OA,E.mean=AA,E.meanBy=IA,E.min=MA,E.minBy=PA,E.stubArray=Zh,E.stubFalse=Jh,E.stubObject=vA,E.stubString=yA,E.stubTrue=bA,E.multiply=DA,E.nth=XE,E.noConflict=lA,E.noop=Kh,E.now=Vc,E.pad=RO,E.padEnd=jO,E.padStart=LO,E.parseInt=FO,E.random=EO,E.reduce=K2,E.reduceRight=Z2,E.repeat=NO,E.replace=BO,E.result=mO,E.round=RA,E.runInContext=H,E.sample=Q2,E.size=rk,E.snakeCase=VO,E.some=nk,E.sortedIndex=e2,E.sortedIndexBy=t2,E.sortedIndexOf=r2,E.sortedLastIndex=n2,E.sortedLastIndexBy=s2,E.sortedLastIndexOf=i2,E.startCase=zO,E.startsWith=WO,E.subtract=jA,E.sum=LA,E.sumBy=FA,E.template=UO,E.times=wA,E.toFinite=qn,E.toInteger=Le,E.toLength=Tv,E.toLower=$O,E.toNumber=rn,E.toSafeInteger=$k,E.toString=ot,E.toUpper=YO,E.trim=XO,E.trimEnd=GO,E.trimStart=qO,E.truncate=KO,E.unescape=ZO,E.uniqueId=xA,E.upperCase=JO,E.upperFirst=Yh,E.each=hv,E.eachRight=dv,E.first=av,qh(E,function(){var o={};return On(E,function(l,f){ct.call(E.prototype,f)||(o[f]=l)}),o}(),{chain:!1}),E.VERSION=n,Kr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){E[o].placeholder=E}),Kr(["drop","take"],function(o,l){Ye.prototype[o]=function(f){f=f===t?1:Ut(Le(f),0);var y=this.__filtered__&&!l?new Ye(this):this.clone();return y.__filtered__?y.__takeCount__=or(f,y.__takeCount__):y.__views__.push({size:or(f,z),type:o+(y.__dir__<0?"Right":"")}),y},Ye.prototype[o+"Right"]=function(f){return this.reverse()[o](f).reverse()}}),Kr(["filter","map","takeWhile"],function(o,l){var f=l+1,y=f==oe||f==Q;Ye.prototype[o]=function(S){var O=this.clone();return O.__iteratees__.push({iteratee:Oe(S,3),type:f}),O.__filtered__=O.__filtered__||y,O}}),Kr(["head","last"],function(o,l){var f="take"+(l?"Right":"");Ye.prototype[o]=function(){return this[f](1).value()[0]}}),Kr(["initial","tail"],function(o,l){var f="drop"+(l?"":"Right");Ye.prototype[o]=function(){return this.__filtered__?new Ye(this):this[f](1)}}),Ye.prototype.compact=function(){return this.filter(Mr)},Ye.prototype.find=function(o){return this.filter(o).head()},Ye.prototype.findLast=function(o){return this.reverse().find(o)},Ye.prototype.invokeMap=He(function(o,l){return typeof o=="function"?new Ye(this):this.map(function(f){return Ko(f,o,l)})}),Ye.prototype.reject=function(o){return this.filter(zc(Oe(o)))},Ye.prototype.slice=function(o,l){o=Le(o);var f=this;return f.__filtered__&&(o>0||l<0)?new Ye(f):(o<0?f=f.takeRight(-o):o&&(f=f.drop(o)),l!==t&&(l=Le(l),f=l<0?f.dropRight(-l):f.take(l-o)),f)},Ye.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},Ye.prototype.toArray=function(){return this.take(z)},On(Ye.prototype,function(o,l){var f=/^(?:filter|find|map|reject)|While$/.test(l),y=/^(?:head|last)$/.test(l),S=E[y?"take"+(l=="last"?"Right":""):l],O=y||/^find/.test(l);S&&(E.prototype[l]=function(){var P=this.__wrapped__,j=y?[1]:arguments,W=P instanceof Ye,ee=j[0],re=W||je(P),se=function(We){var Ke=S.apply(E,gs([We],j));return y&&me?Ke[0]:Ke};re&&f&&typeof ee=="function"&&ee.length!=1&&(W=re=!1);var me=this.__chain__,Te=!!this.__actions__.length,Ae=O&&!me,Ve=W&&!Te;if(!O&&re){P=Ve?P:new Ye(this);var Ie=o.apply(P,j);return Ie.__actions__.push({func:Nc,args:[se],thisArg:t}),new Jr(Ie,me)}return Ae&&Ve?o.apply(this,j):(Ie=this.thru(se),Ae?y?Ie.value()[0]:Ie.value():Ie)})}),Kr(["pop","push","shift","sort","splice","unshift"],function(o){var l=uc[o],f=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",y=/^(?:pop|shift)$/.test(o);E.prototype[o]=function(){var S=arguments;if(y&&!this.__chain__){var O=this.value();return l.apply(je(O)?O:[],S)}return this[f](function(P){return l.apply(je(P)?P:[],S)})}}),On(Ye.prototype,function(o,l){var f=E[l];if(f){var y=f.name+"";ct.call(Yi,y)||(Yi[y]=[]),Yi[y].push({name:l,func:f})}}),Yi[Mc(t,T).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=ZC,Ye.prototype.reverse=JC,Ye.prototype.value=QC,E.prototype.at=O2,E.prototype.chain=A2,E.prototype.commit=I2,E.prototype.next=M2,E.prototype.plant=D2,E.prototype.reverse=R2,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=j2,E.prototype.first=E.prototype.head,Wo&&(E.prototype[Wo]=P2),E},Wi=IC();Ys?((Ys.exports=Wi)._=Wi,Gu._=Wi):er._=Wi}).call(na)})(jl,jl.exports);var st=jl.exports;const U4=()=>{const{trackItemIds:r,trackItemsMap:e,fps:t,trackItemDetailsMap:n}=Os(),s=st.merge(e,n);return w.jsx(w.Fragment,{children:r.map(i=>{const a=s[i];return Mw[a.type](a,{fps:t})})})};var Pw={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var i="",a=0;a<arguments.length;a++){var c=arguments[a];c&&(i=s(i,n(c)))}return i}function n(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var c in i)e.call(i,c)&&i[c]&&(a=s(a,c));return a}function s(i,a){return a?i?i+" "+a:i+a:i}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(Pw);var $4=Pw.exports;const fa=Hy($4),Y4={asChild:{type:"boolean"}},X4={width:{type:"string",className:"rt-r-w",customProperties:["--width"],responsive:!0},minWidth:{type:"string",className:"rt-r-min-w",customProperties:["--min-width"],responsive:!0},maxWidth:{type:"string",className:"rt-r-max-w",customProperties:["--max-width"],responsive:!0}},G4={height:{type:"string",className:"rt-r-h",customProperties:["--height"],responsive:!0},minHeight:{type:"string",className:"rt-r-min-h",customProperties:["--min-height"],responsive:!0},maxHeight:{type:"string",className:"rt-r-max-h",customProperties:["--max-height"],responsive:!0}},Op=["initial","xs","sm","md","lg","xl"];function Dw(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function ya(r){return typeof r=="object"&&Object.keys(r).some(e=>Op.includes(e))}function q4({className:r,customProperties:e,...t}){const n=Rw({allowArbitraryValues:!0,className:r,...t}),s=K4({customProperties:e,...t});return[n,s]}function Rw({allowArbitraryValues:r,value:e,className:t,propValues:n,parseValue:s=i=>i}){const i=[];if(e){if(typeof e=="string"&&n.includes(e))return L0(t,e,s);if(ya(e)){const a=e;for(const c in a){if(!Dw(a,c)||!Op.includes(c))continue;const u=a[c];if(u!==void 0){if(n.includes(u)){const h=L0(t,u,s),d=c==="initial"?h:`${c}:${h}`;i.push(d)}else if(r){const h=c==="initial"?t:`${c}:${t}`;i.push(h)}}}return i.join(" ")}if(r)return t}}function L0(r,e,t){const n=r?"-":"",s=t(e),i=s?.startsWith("-"),a=i?"-":"",c=i?s?.substring(1):s;return`${a}${r}${n}${c}`}function K4({customProperties:r,value:e,propValues:t,parseValue:n=s=>s}){let s={};if(!(!e||typeof e=="string"&&t.includes(e))){if(typeof e=="string"&&(s=Object.fromEntries(r.map(i=>[i,e]))),ya(e)){const i=e;for(const a in i){if(!Dw(i,a)||!Op.includes(a))continue;const c=i[a];if(!t.includes(c))for(const u of r)s={[a==="initial"?u:`${u}-${a}`]:c,...s}}}for(const i in s){const a=s[i];a!==void 0&&(s[i]=n(a))}return s}}function F0(...r){let e={};for(const t of r)t&&(e={...e,...t});return Object.keys(e).length?e:void 0}function Z4(...r){return Object.assign({},...r)}function J4(r,...e){let t,n;const s={...r},i=Z4(...e);for(const a in i){let c=s[a];const u=i[a];if(u.default!==void 0&&c===void 0&&(c=u.default),u.type==="enum"&&![u.default,...u.values].includes(c)&&!ya(c)&&(c=u.default),s[a]=c,"className"in u&&u.className){delete s[a];const h="responsive"in u;if(!c||ya(c)&&!h)continue;if(ya(c)&&(u.default!==void 0&&c.initial===void 0&&(c.initial=u.default),u.type==="enum"&&([u.default,...u.values].includes(c.initial)||(c.initial=u.default))),u.type==="enum"){const d=Rw({allowArbitraryValues:!1,value:c,className:u.className,propValues:u.values,parseValue:u.parseValue});t=fa(t,d);continue}if(u.type==="string"||u.type==="enum | string"){const d=u.type==="string"?[]:u.values,[p,g]=q4({className:u.className,customProperties:u.customProperties,propValues:d,parseValue:u.parseValue,value:c});n=F0(n,g),t=fa(t,p);continue}if(u.type==="boolean"&&c){t=fa(t,u.className);continue}}}return s.className=fa(t,r.className),s.style=F0(n,r.style),s}const ti=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],Q4={m:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-m",customProperties:["--m"]},mx:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-mx",customProperties:["--ml","--mr"]},my:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-my",customProperties:["--mt","--mb"]},mt:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-mt",customProperties:["--mt"]},mr:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-mr",customProperties:["--mr"]},mb:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-mb",customProperties:["--mb"]},ml:{type:"enum | string",values:ti,responsive:!0,className:"rt-r-ml",customProperties:["--ml"]}},ej=GA,ri=["0","1","2","3","4","5","6","7","8","9"],tj={p:{type:"enum | string",className:"rt-r-p",customProperties:["--p"],values:ri,responsive:!0},px:{type:"enum | string",className:"rt-r-px",customProperties:["--pl","--pr"],values:ri,responsive:!0},py:{type:"enum | string",className:"rt-r-py",customProperties:["--pt","--pb"],values:ri,responsive:!0},pt:{type:"enum | string",className:"rt-r-pt",customProperties:["--pt"],values:ri,responsive:!0},pr:{type:"enum | string",className:"rt-r-pr",customProperties:["--pr"],values:ri,responsive:!0},pb:{type:"enum | string",className:"rt-r-pb",customProperties:["--pb"],values:ri,responsive:!0},pl:{type:"enum | string",className:"rt-r-pl",customProperties:["--pl"],values:ri,responsive:!0}},cd=["visible","hidden","clip","scroll","auto"],rj=["static","relative","absolute","fixed","sticky"],la=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],nj=["0","1"],sj=["0","1"],ij={...tj,...X4,...G4,position:{type:"enum",className:"rt-r-position",values:rj,responsive:!0},inset:{type:"enum | string",className:"rt-r-inset",customProperties:["--inset"],values:la,responsive:!0},top:{type:"enum | string",className:"rt-r-top",customProperties:["--top"],values:la,responsive:!0},right:{type:"enum | string",className:"rt-r-right",customProperties:["--right"],values:la,responsive:!0},bottom:{type:"enum | string",className:"rt-r-bottom",customProperties:["--bottom"],values:la,responsive:!0},left:{type:"enum | string",className:"rt-r-left",customProperties:["--left"],values:la,responsive:!0},overflow:{type:"enum",className:"rt-r-overflow",values:cd,responsive:!0},overflowX:{type:"enum",className:"rt-r-ox",values:cd,responsive:!0},overflowY:{type:"enum",className:"rt-r-oy",values:cd,responsive:!0},flexBasis:{type:"string",className:"rt-r-fb",customProperties:["--flex-basis"],responsive:!0},flexShrink:{type:"enum | string",className:"rt-r-fs",customProperties:["--flex-shrink"],values:nj,responsive:!0},flexGrow:{type:"enum | string",className:"rt-r-fg",customProperties:["--flex-grow"],values:sj,responsive:!0},gridArea:{type:"string",className:"rt-r-ga",customProperties:["--grid-area"],responsive:!0},gridColumn:{type:"string",className:"rt-r-gc",customProperties:["--grid-column"],responsive:!0},gridColumnStart:{type:"string",className:"rt-r-gcs",customProperties:["--grid-column-start"],responsive:!0},gridColumnEnd:{type:"string",className:"rt-r-gce",customProperties:["--grid-column-end"],responsive:!0},gridRow:{type:"string",className:"rt-r-gr",customProperties:["--grid-row"],responsive:!0},gridRowStart:{type:"string",className:"rt-r-grs",customProperties:["--grid-row-start"],responsive:!0},gridRowEnd:{type:"string",className:"rt-r-gre",customProperties:["--grid-row-end"],responsive:!0}},ld=["0","1","2","3","4","5","6","7","8","9"],oj={gap:{type:"enum | string",className:"rt-r-gap",customProperties:["--gap"],values:ld,responsive:!0},gapX:{type:"enum | string",className:"rt-r-cg",customProperties:["--column-gap"],values:ld,responsive:!0},gapY:{type:"enum | string",className:"rt-r-rg",customProperties:["--row-gap"],values:ld,responsive:!0}},aj=["div","span"],cj=["none","inline-flex","flex"],lj=["row","column","row-reverse","column-reverse"],uj=["start","center","end","baseline","stretch"],hj=["start","center","end","between"],dj=["nowrap","wrap","wrap-reverse"],fj={as:{type:"enum",values:aj,default:"div"},...Y4,display:{type:"enum",className:"rt-r-display",values:cj,responsive:!0},direction:{type:"enum",className:"rt-r-fd",values:lj,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:uj,responsive:!0},justify:{type:"enum",className:"rt-r-jc",values:hj,parseValue:pj,responsive:!0},wrap:{type:"enum",className:"rt-r-fw",values:dj,responsive:!0},...oj};function pj(r){return r==="between"?"space-between":r}const Ap=m.forwardRef((r,e)=>{const{className:t,asChild:n,as:s="div",...i}=J4(r,fj,ij,Q4);return m.createElement(n?ej:s,{...i,ref:e,className:fa("rt-Flex",t)})});Ap.displayName="Flex";const jw=()=>{const r=m.useRef(null),{setPlayerRef:e,duration:t,fps:n,size:s}=Os();return m.useEffect(()=>{e(r)},[]),w.jsx(Ap,{className:"size-full",children:w.jsx(F4,{ref:r,component:U4,durationInFrames:Math.round(t/1e3*n)||5*30,compositionWidth:1920,compositionHeight:1080,style:{width:"100%",height:"100%"},inputProps:{},fps:n,controls:!0})})},Lw=({scrollLeft:r})=>{const e=m.useRef(null),{playerRef:t,fps:n,scale:s}=Os(),i=cu(t??void 0),a=Lt(i/n*1e3,s.zoom)-r,[c,u]=m.useState(!1),[h,d]=m.useState(0),[p,g]=m.useState(a),v=()=>{u(!1)},b=C=>{u(!0);const T="touches"in C?C.touches[0].clientX:C.clientX;d(T),g(a)},x=C=>{if(c){const k=("touches"in C?C.touches[0].clientX:C.clientX)-h,A=p+k,I=ks(A,s.zoom);t?.current?.seekTo(I*n/1e3)}};return m.useEffect(()=>{const C=T=>{T.preventDefault()};return c?(document.addEventListener("mousemove",x),document.addEventListener("mouseup",v),document.addEventListener("touchmove",x),document.addEventListener("touchend",v),document.addEventListener("dragstart",C)):(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",v)),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",v),document.removeEventListener("dragstart",C)}},[c,x,v]),w.jsx("div",{ref:e,role:"button",tabIndex:0,onMouseDown:C=>{b(C)},onTouchStart:C=>{b(C)},onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&b(C)},style:{position:"absolute",left:40+au+a,top:80,width:1,height:"calc(100% - 80px)",background:"#d4d4d8",zIndex:10,cursor:"pointer"},children:w.jsxs("div",{className:"relative h-full",children:[w.jsx("div",{className:"absolute top-0  h-full w-3 -translate-x-1/2"}),w.jsx("div",{className:"absolute top-0  h-full w-0.5 -translate-x-1/2 bg-white/50"}),w.jsx("div",{style:{borderRadius:"0 0 20px 20px"},className:"absolute h-3 -translate-x-1/2 px-1.5",children:w.jsx("svg",{height:"12",viewBox:"0 0 12 12",fill:"none",children:w.jsx("path",{fill:"currentColor",d:"M11.6585 7.04881L6.6585 11.4238C6.28148 11.7537 5.71852 11.7537 5.3415 11.4238L0.341495 7.04881C0.12448 6.85892 0 6.58459 0 6.29623V1C0 0.447715 0.447715 0 1 0H11C11.5523 0 12 0.447715 12 1V6.29623C12 6.58459 11.8755 6.85892 11.6585 7.04881Z"})})})]})})},Fw=r=>{const{height:e=40,longLineSize:t=8,shortLineSize:n=6,offsetX:s=Ml+au,textOffsetY:i=12,textFormat:a=fb,scrollLeft:c=0,onClick:u}=r,{scale:h}=Os(),d=m.useRef(null),[p,g]=m.useState(null),[v,b]=m.useState({width:0,height:e});m.useEffect(()=>{const k=d.current;if(k){const A=k.getContext("2d");g(A),x(k,A,c)}},[]),m.useEffect(()=>{p&&x(d.current,p,c)},[p,c,h]);const x=(k,A,I)=>{if(!k||!A)return;const F=k.offsetParent.offsetWidth??k.offsetWidth,U=v.height;k.width=F,k.height=U,C(A,I,F,U),b({width:F,height:U})},C=(k,A,I,D)=>{const F=h.zoom,U=h.unit,B=h.segments;k.clearRect(0,0,I,D),k.save(),k.strokeStyle="#71717a",k.fillStyle="#71717a",k.lineWidth=1,k.font=`${ab}px ${cb}`,k.textBaseline="top",k.translate(.5,0),k.beginPath();const X=U*F*Ya,Y=Math.floor(A/X),G=Math.ceil((A+I)/X)-Y;for(let K=0;K<=G;++K){const oe=K+Y;if(oe<0)continue;const ve=oe*X/F,Q=(ve-A/F)*F;if(Q<-X||Q>=I+X)continue;const ge=a(ve),ne=-k.measureText(ge).width/2;k.fillText(ge,Q+ne+s,i)}for(let K=0;K<=G;++K){const oe=K+Y;if(oe<0)continue;const Q=oe*X-A+s;for(let ge=0;ge<B;++ge){const de=Q+ge/B*X;if(de<0||de>=I)continue;const ne=ge%B?n:t;ne===n?k.strokeStyle="#a1a1aa":k.strokeStyle="#d4d4d8";const M=32,[z,ce]=[de,M],[fe,be]=[z,ce+ne];k.beginPath(),k.moveTo(z,ce),k.lineTo(fe,be),k.stroke()}}k.restore()},T=k=>{const A=d.current;if(!A)return;const I=A.getBoundingClientRect(),F=k.clientX-I.left+c-Ml;u?.(F)};return w.jsx("div",{className:"border-border border-t",style:{position:"relative",width:"100%",height:`${v.height}px`,backgroundColor:"transparent"},children:w.jsx("canvas",{onClick:T,ref:d,height:v.height})})},gj=()=>w.jsx(Ap,{flexGrow:"1",justify:"center",width:"100%",height:"100%",className:"bg-scene py-3",children:w.jsx("div",{className:"max-w-3xl flex-1  w-full h-full flex relative",children:w.jsx(jw,{})})});function N(r,e,t){return(e=function(n){var s=function(i,a){if(typeof i!="object"||!i)return i;var c=i[Symbol.toPrimitive];if(c!==void 0){var u=c.call(i,a);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}(n,"string");return typeof s=="symbol"?s:s+""}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function N0(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function L(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?N0(Object(t),!0).forEach(function(n){N(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):N0(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function yt(r,e){if(r==null)return{};var t,n,s=function(a,c){if(a==null)return{};var u={};for(var h in a)if({}.hasOwnProperty.call(a,h)){if(c.indexOf(h)>=0)continue;u[h]=a[h]}return u}(r,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)t=i[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(r,t)&&(s[t]=r[t])}return s}function Hs(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}class B0{constructor(){N(this,"browserShadowBlurConstant",1),N(this,"DPI",96),N(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),N(this,"perfLimitSizeTotal",2097152),N(this,"maxCacheSideLimit",4096),N(this,"minCacheSideLimit",256),N(this,"disableStyleCopyPaste",!1),N(this,"enableGLFiltering",!0),N(this,"textureSize",4096),N(this,"forceGLPutImageData",!1),N(this,"cachesBoundsOfCurve",!1),N(this,"fontPaths",{}),N(this,"NUM_FRACTION_DIGITS",4)}}const et=new class extends B0{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=L(L({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){const e=new B0,t=r?.reduce((n,s)=>(n[s]=e[s],n),{})||e;this.configure(t)}},Is=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[r]("fabric",...t)};class Rn extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class Nw extends Rn{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class mj{}class vj extends mj{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),Is("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const yj={};let V0;const Nn=()=>V0||(V0={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new vj,dispose(){},copyPasteData:yj}),Mo=()=>Nn().document,wu=()=>Nn().window,Bw=()=>{var r;return Math.max((r=et.devicePixelRatio)!==null&&r!==void 0?r:wu().devicePixelRatio,1)},ba=new class{constructor(){N(this,"charWidthsCache",{}),N(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:e,fontStyle:t,fontWeight:n}=r;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){const{perfLimitSizeTotal:e}=et,t=Math.sqrt(e*r);return[Math.floor(t),Math.floor(e/t)]}},lf="6.5.4";function pi(){}const Ms=Math.PI/2,as=2*Math.PI,Ip=Math.PI/180,xr=Object.freeze([1,0,0,1,0,0]),Mp=16,Ts=.4477152502,Be="center",at="left",Pr="top",uf="bottom",jt="right",Dr="none",Pp=/\r?\n/,Vw="moving",_u="scaling",Hw="rotating",Dp="rotate",zw="skewing",Ma="resizing",Ww="modifyPoly",bj="modifyPath",Ll="changed",xu="scale",Sr="scaleX",$r="scaleY",Po="skewX",Do="skewY",Xt="fill",Rr="stroke",Fl="modified",eo="json",ud="svg",le=new class{constructor(){this[eo]=new Map,this[ud]=new Map}has(r){return this[eo].has(r)}getClass(r){const e=this[eo].get(r);if(!e)throw new Rn("No class registered for ".concat(r));return e}setClass(r,e){e?this[eo].set(e,r):(this[eo].set(r.type,r),this[eo].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[ud].get(r)}setSVGClass(r,e){this[ud].set(e??r.type.toLowerCase(),r)}},Nl=new class extends Array{remove(r){const e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){const r=this.splice(0);return r.forEach(e=>e.abort()),r}cancelByCanvas(r){if(!r)return[];const e=this.filter(t=>{var n;return t.target===r||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===r});return e.forEach(t=>t.abort()),e}cancelByTarget(r){if(!r)return[];const e=this.filter(t=>t.target===r);return e.forEach(t=>t.abort()),e}};class wj{constructor(){N(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[s,i]=n;this.on(s,i)}),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(s=>{let[i,a]=s;n.push(this.once(i,a))}),()=>n.forEach(s=>s())}if(t){const n=this.on(e,function(){for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];t.call(this,...i),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],s=n.indexOf(t);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[s,i]=n;this._removeEventListener(s,i)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,t||{})}}const ii=(r,e)=>{const t=r.indexOf(e);return t!==-1&&r.splice(t,1),r},xn=r=>{if(r===0)return 1;switch(Math.abs(r)/Ms){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},Sn=r=>{if(r===0)return 0;const e=r/Ms,t=Math.sign(r);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(r)};class ${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new $(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new $(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new $(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new $(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new $(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new $(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new $(this.x/e.x,this.y/e.y)}scalarDivide(e){return new $(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new $(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new $(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new $(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new $(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rp;const n=Sn(e),s=xn(e),i=this.subtract(t);return new $(i.x*s-i.y*n,i.x*n+i.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new $(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Rp=new $(0,0),Cl=r=>!!r&&Array.isArray(r._objects);function Uw(r){class e extends r{constructor(){super(...arguments),N(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];const a=this._objects.push(...s);return s.forEach(c=>this._onObjectAdded(c)),a}insertAt(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];return this._objects.splice(n,0,...i),i.forEach(c=>this._onObjectAdded(c)),this._objects.length}remove(){const n=this._objects,s=[];for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return a.forEach(u=>{const h=n.indexOf(u);h!==-1&&(n.splice(h,1),s.push(u),this._onObjectRemoved(u))}),s}forEachObject(n){this.getObjects().forEach((s,i,a)=>n(s,i,a))}getObjects(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(a=>a.isType(...s))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(n,!0))}complexity(){return this._objects.reduce((n,s)=>n+=s.complexity?s.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(ii(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(ii(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==0){const a=this.findNewLowerIndex(n,i,s);return ii(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==this._objects.length-1){const a=this.findNewUpperIndex(n,i,s);return ii(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(ii(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,i){let a;if(i){a=s;for(let c=s-1;c>=0;--c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=s-1;return a}findNewUpperIndex(n,s,i){let a;if(i){a=s;for(let c=s+1;c<this._objects.length;++c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=s+1;return a}collectObjects(n){let{left:s,top:i,width:a,height:c}=n,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],d=new $(s,i),p=d.add(new $(a,c));for(let g=this._objects.length-1;g>=0;g--){const v=this._objects[g];v.selectable&&v.visible&&(u&&v.intersectsWithRect(d,p)||v.isContainedWithinRect(d,p)||u&&v.containsPoint(d)||u&&v.containsPoint(p))&&h.push(v)}return h}}return e}class $w extends wj{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function wa(r){return wu().requestAnimationFrame(r)}function Yw(r){return wu().cancelAnimationFrame(r)}let _j=0;const Ps=()=>_j++,cn=()=>{const r=Mo().createElement("canvas");if(!r||r.getContext===void 0)throw new Rn("Failed to create `canvas` element");return r},Xw=()=>Mo().createElement("img"),Cn=r=>{const e=cn();return e.width=r.width,e.height=r.height,e},jp=(r,e,t)=>r.toDataURL("image/".concat(e),t),It=r=>r*Ip,Ds=r=>r/Ip,Gw=r=>r.every((e,t)=>e===xr[t]),ur=(r,e,t)=>new $(r).transform(e,t),Ur=r=>{const e=1/(r[0]*r[3]-r[1]*r[2]),t=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:n,y:s}=new $(r[4],r[5]).transform(t,!0);return t[4]=-n,t[5]=-s,t},Mt=(r,e,t)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],t?0:r[0]*e[4]+r[2]*e[5]+r[4],t?0:r[1]*e[4]+r[3]*e[5]+r[5]],Su=(r,e)=>r.reduceRight((t,n)=>n&&t?Mt(n,t,e):n||t,void 0)||xr.concat(),qw=r=>{let[e,t]=r;return Math.atan2(t,e)},fo=r=>{const e=qw(r),t=Math.pow(r[0],2)+Math.pow(r[1],2),n=Math.sqrt(t),s=(r[0]*r[3]-r[2]*r[1])/n,i=Math.atan2(r[0]*r[2]+r[1]*r[3],t);return{angle:Ds(e),scaleX:n,scaleY:s,skewX:Ds(i),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},Ro=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function jo(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=It(r),s=xn(n),i=Sn(n);return[s,i,-i,s,e?e-(s*e-i*t):0,t?t-(i*e+s*t):0]}const Cu=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},Kw=r=>Math.tan(It(r)),Lp=r=>[1,0,Kw(r),1,0,0],Fp=r=>[1,Kw(r),0,1,0,0],Za=r=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:a=0}=r,c=Cu(n?-e:e,s?-t:t);return i&&(c=Mt(c,Lp(i),!0)),a&&(c=Mt(c,Fp(a),!0)),c},Zw=r=>{const{translateX:e=0,translateY:t=0,angle:n=0}=r;let s=Ro(e,t);n&&(s=Mt(s,jo({angle:n})));const i=Za(r);return Gw(i)||(s=Mt(s,i)),s},_a=function(r){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,s){if(e&&e.aborted)return s(new Nw("loadImage"));const i=Xw();let a;e&&(a=function(u){i.src="",s(u)},e.addEventListener("abort",a,{once:!0}));const c=function(){i.onload=i.onerror=null,a&&e?.removeEventListener("abort",a),n(i)};r?(i.onload=c,i.onerror=function(){a&&e?.removeEventListener("abort",a),s(new Rn("Error loading ".concat(i.src)))},t&&(i.crossOrigin=t),i.src=r):c()})},po=function(r){let{signal:e,reviver:t=pi}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(r.map(a=>le.getClass(a.type).fromObject(a,{signal:e}).then(c=>(t(a,c),i.push(c),c)))).then(n).catch(a=>{i.forEach(c=>{c.dispose&&c.dispose()}),s(a)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},Ja=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const i=Object.values(r).map(c=>c&&c.type&&le.has(c.type)?po([c],{signal:e}).then(u=>{let[h]=u;return s.push(h),h}):c),a=Object.keys(r);Promise.all(i).then(c=>c.reduce((u,h,d)=>(u[a[d]]=h,u),{})).then(t).catch(c=>{s.forEach(u=>{u.dispose&&u.dispose()}),n(c)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},Ai=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in r&&(e[t]=r[t]),e),{})},Np=(r,e)=>Object.keys(r).reduce((t,n)=>(e(r[n],n,r)&&(t[n]=r[n]),t),{}),H0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},hd=(r,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+(e-r)*(2/3-t)*6:r),z0=(r,e,t,n)=>{r/=255,e/=255,t/=255;const s=Math.max(r,e,t),i=Math.min(r,e,t);let a,c;const u=(s+i)/2;if(s===i)a=c=0;else{const h=s-i;switch(c=u>.5?h/(2-s-i):h/(s+i),s){case r:a=(e-t)/h+(e<t?6:0);break;case e:a=(t-r)/h+2;break;case t:a=(r-e)/h+4}a/=6}return[Math.round(360*a),Math.round(100*c),Math.round(100*u),n]},W0=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Zc=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),U0=r=>{let[e,t,n,s=1]=r;const i=Math.round(.3*e+.59*t+.11*n);return[i,i,i,s]};class lt{constructor(e){if(N(this,"isUnrecognised",!1),e)if(e instanceof lt)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,s,i=1]=e;this.setSource([t,n,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in H0&&(e=H0[e]),e==="transparent"?[255,255,255,0]:lt.sourceFromHex(e)||lt.sourceFromRgb(e)||lt.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=z0(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,s]=z0(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,s]=this.getSource();return"".concat(Zc(e)).concat(Zc(t)).concat(Zc(n)).concat(Zc(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(U0(this.getSource())),this}toBlackWhite(e){const[t,,,n]=U0(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof lt||(e=new lt(e));const t=this.getSource(),n=e.getSource(),[s,i,a]=t.map((c,u)=>Math.round(.5*c+.5*n[u]));return this.setSource([s,i,a,t[3]]),this}static fromRgb(e){return lt.fromRgba(e)}static fromRgba(e){return new lt(lt.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[n,s,i]=t.slice(1,4).map(a=>{const c=parseFloat(a);return a.endsWith("%")?Math.round(2.55*c):c});return[n,s,i,W0(t[4])]}}static fromHsl(e){return lt.fromHsla(e)}static fromHsla(e){return new lt(lt.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const n=(lt.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,i=parseFloat(t[3])/100;let a,c,u;if(s===0)a=c=u=i;else{const h=i<=.5?i*(s+1):i+s-i*s,d=2*i-h;a=hd(d,h,n+1/3),c=hd(d,h,n),u=hd(d,h,n-1/3)}return[Math.round(255*a),Math.round(255*c),Math.round(255*u),W0(t[4])]}static fromHex(e){return new lt(lt.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map(u=>u+u):t.match(/.{2}/g);const[s,i,a,c=255]=n.map(u=>parseInt(u,16));return[s,i,a,c/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?Ds(n):t.includes("turn")?360*n:n}}const vt=(r,e)=>parseFloat(Number(r).toFixed(e)),gi=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mp;const t=/\D{0,2}$/.exec(r),n=parseFloat(r),s=et.DPI;switch(t?.[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},Jw=r=>{const[e,t]=r.trim().split(" "),[n,s]=(i=e)&&i!==Dr?[i.slice(1,4),i.slice(5,8)]:i===Dr?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:t||"meet",alignX:n,alignY:s}},Pa=r=>"matrix("+r.map(e=>vt(e,et.NUM_FRACTION_DIGITS)).join(" ")+")",Da=function(r,e){let t,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const i=new lt(e),a=i.getAlpha();t=i.toRgb(),a!==1&&(n=a.toString())}else t="none";return s?"".concat(r,": ").concat(t,"; ").concat(n?"".concat(r,"-opacity: ").concat(n,"; "):""):"".concat(r,'="').concat(t,'" ').concat(n?"".concat(r,'-opacity="').concat(n,'" '):"")},on=r=>!!r&&r.toLive!==void 0,$0=r=>!!r&&typeof r.toObject=="function",Y0=r=>!!r&&r.offsetX!==void 0&&"source"in r,oi=r=>!!r&&"multiSelectionStacking"in r;function Qw(r){const e=r&&yn(r);let t=0,n=0;if(!r||!e)return{left:t,top:n};let s=r;const i=e.documentElement,a=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=a.scrollLeft||i.scrollLeft||0,n=a.scrollTop||i.scrollTop||0):(t+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:n}}const yn=r=>r.ownerDocument||null,e_=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},t_=function(r,e,t){let{width:n,height:s}=t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=n,r.height=s,i>1&&(r.setAttribute("width",(n*i).toString()),r.setAttribute("height",(s*i).toString()),e.scale(i,i))},hf=(r,e)=>{let{width:t,height:n}=e;t&&(r.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(r.style.height=typeof n=="number"?"".concat(n,"px"):n)};function X0(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=Dr,r}class r_{constructor(e){N(this,"_originalCanvasStyle",void 0),N(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&Mo().getElementById(e)||cn();var n;if(t.hasAttribute("data-fabric"))throw new Rn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:s}=this.lower;t_(n,s,e,t)}setCSSDimensions(e){hf(this.lower.el,e)}calcOffset(){return function(e){var t;const n=e&&yn(e),s={left:0,top:0};if(!n)return s;const i=((t=e_(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let a={left:0,top:0};const c=n.documentElement;e.getBoundingClientRect!==void 0&&(a=e.getBoundingClientRect());const u=Qw(e);return{left:a.left+u.left-(c.clientLeft||0)+s.left,top:a.top+u.top-(c.clientTop||0)+s.top}}(this.lower.el)}dispose(){Nn().dispose(this.lower.el),delete this.lower}}const xj={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...xr]};class Qa extends Uw($w){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Qa.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new r_(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Is("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Bw():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=L({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,s=[...this.viewportTransform],i=ur(e,Ur(s));s[0]=t,s[3]=t;const a=ur(i,s);s[4]+=n.x-a.x,s[5]+=n.y-a.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new $(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new $(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=wa(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,n=Ur(this.viewportTransform),s=ur({x:0,y:0},n),i=ur({x:e,y:t},n),a=s.min(i),c=s.max(i);return this.vptCoords={tl:a,tr:new $(c.x,a.y),bl:new $(a.x,c.y),br:c}}cancelRequestedRender(){this.nextRenderHandle&&(Yw(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,s=t.length;n<s;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],s=this["".concat(t,"Image")],i=this.viewportTransform,a=this["".concat(t,"Vpt")];if(!n&&!s)return;const c=on(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=c?n.toLive(e):n,a&&e.transform(...i),c){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const u=n.gradientTransform||n.patternTransform;u&&e.transform(...u)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:u}=this;this.skipOffscreen=a,a&&e.transform(...i),s.render(e),this.skipOffscreen=u,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new $(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new $(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new $(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new $(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new $(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return ur(this.getCenterPoint(),Ur(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Be,Be),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return L(L(L({version:lf},Ai(this,t)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,t))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,t){const n={},s=this.backgroundImage,i=this.overlayImage,a=this.backgroundColor,c=this.overlayColor;return on(a)?a.excludeFromExport||(n.background=a.toObject(t)):a&&(n.background=a),on(c)?c.excludeFromExport||(n.overlay=c.toObject(t)):c&&(n.overlay=c),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,t)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),s=t.height||"".concat(this.height),i=et.NUM_FRACTION_DIGITS,a=t.viewBox;let c;if(a)c='viewBox="'.concat(a.x," ").concat(a.y," ").concat(a.width," ").concat(a.height,'" ');else if(this.svgViewportTransformation){const u=this.viewportTransform;c='viewBox="'.concat(vt(-u[4]/u[0],i)," ").concat(vt(-u[5]/u[3],i)," ").concat(vt(this.width/u[0],i)," ").concat(vt(this.height/u[3],i),'" ')}else c='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',c,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",lf,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(Ps()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(on(t)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return t.toSVG(i,{additionalTransform:n?Pa(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=et.fontPaths;this._objects.forEach(function i(a){e.push(a),Cl(a)&&a._objects.forEach(i)}),e.forEach(i=>{if(!(a=i)||typeof a._renderText!="function")return;var a;const{styles:c,fontFamily:u}=i;!t[u]&&n[u]&&(t[u]=!0,c&&Object.values(c).forEach(h=>{Object.values(h).forEach(d=>{let{fontFamily:p=""}=d;!t[p]&&n[p]&&(t[p]=!0)})}))});const s=Object.keys(t).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(n[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(on(n)){const s=n.repeat||"",i=this.width,a=this.height,c=this["".concat(t,"Vpt")]?Pa(Ur(this.viewportTransform)):"";e.push('<rect transform="'.concat(c," translate(").concat(i/2,",").concat(a/2,')" x="').concat(n.offsetX-i/2,'" y="').concat(n.offsetY-a/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!Y0(n)?i:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!Y0(n)?a:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Rn("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:a,background:c,overlayImage:u,overlay:h,clipPath:d}=s,p=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([po(i,{reviver:t,signal:n}),Ja({backgroundImage:a,backgroundColor:c,overlayImage:u,overlayColor:h,clipPath:d},{signal:n})]).then(g=>{let[v,b]=g;return this.clear(),this.add(...v),this.set(s),this.set(b),this.renderOnAddRemove=p,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Cn(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,a=s*(i?this.getRetinaScaling():1);return jp(this.toCanvasElement(a,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:s,top:i,filter:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=(t||this.width)*e,u=(n||this.height)*e,h=this.getZoom(),d=this.width,p=this.height,g=this.skipControlsDrawing,v=h*e,b=this.viewportTransform,x=[v,0,0,v,(b[4]-(s||0))*e,(b[5]-(i||0))*e],C=this.enableRetinaScaling,T=Cn({width:c,height:u}),k=a?this._objects.filter(A=>a(A)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=x,this.width=c,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(T.getContext("2d"),k),this.viewportTransform=b,this.width=d,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=C,this.skipControlsDrawing=g,T}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Nl.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}N(Qa,"ownDefaults",xj);const Sj=["touchstart","touchmove","touchend"],n_=r=>{const e=Qw(r.target),t=function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n}(r);return new $(t.clientX+e.left,t.clientY+e.top)},Bl=r=>Sj.includes(r.type)||r.pointerType==="touch",df=r=>{r.preventDefault(),r.stopPropagation()},Fn=r=>{let e=0,t=0,n=0,s=0;for(let i=0,a=r.length;i<a;i++){const{x:c,y:u}=r[i];(c>n||!i)&&(n=c),(c<e||!i)&&(e=c),(u>s||!i)&&(s=u),(u<t||!i)&&(t=u)}return{left:e,top:t,width:n-e,height:s-t}},Cj=["translateX","translateY","scaleX","scaleY"],s_=(r,e)=>go(r,Mt(e,r.calcOwnMatrix())),go=(r,e)=>{const t=fo(e),{translateX:n,translateY:s,scaleX:i,scaleY:a}=t,c=yt(t,Cj),u=new $(n,s);r.flipX=!1,r.flipY=!1,Object.assign(r,c),r.set({scaleX:i,scaleY:a}),r.setPositionByOrigin(u,Be,Be)},i_=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},Bp=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),Tu=(r,e,t)=>{const n=r/2,s=e/2,i=[new $(-n,-s),new $(n,-s),new $(-n,s),new $(n,s)].map(c=>c.transform(t)),a=Fn(i);return new $(a.width,a.height)},ec=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xr;return Mt(Ur(arguments.length>1&&arguments[1]!==void 0?arguments[1]:xr),r)},ns=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xr;return r.transform(ec(e,t))},o_=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xr;return r.transform(ec(e,t),!0)},ff=(r,e,t)=>{const n=ec(e,t);return go(r,Mt(n,r.calcOwnMatrix())),n},Vp=(r,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(r),L(L({},e),{},{target:n})),n.fire(r,e)},Tj={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Ft=r=>typeof r=="string"?Tj[r]:r-.5,Vl="not-allowed";function a_(r){return Ft(r.originX)===Ft(Be)&&Ft(r.originY)===Ft(Be)}function G0(r){return .5-Ft(r)}const bn=(r,e)=>r[e],Hp=(r,e,t,n)=>({e:r,transform:e,pointer:new $(t,n)});function c_(r,e){const t=r.getTotalAngle()+Ds(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function Eu(r,e,t,n,s){var i;let{target:a,corner:c}=r;const u=a.controls[c],h=((i=a.canvas)===null||i===void 0?void 0:i.getZoom())||1,d=a.padding/h,p=function(g,v,b,x){const C=g.getRelativeCenterPoint(),T=b!==void 0&&x!==void 0?g.translateToGivenOrigin(C,Be,Be,b,x):new $(g.left,g.top);return(g.angle?v.rotate(-It(g.angle),C):v).subtract(T)}(a,new $(n,s),e,t);return p.x>=d&&(p.x-=d),p.x<=-d&&(p.x+=d),p.y>=d&&(p.y-=d),p.y<=d&&(p.y+=d),p.x-=u.offsetX,p.y-=u.offsetY,p}const l_=(r,e,t,n)=>{const{target:s,offsetX:i,offsetY:a}=e,c=t-i,u=n-a,h=!bn(s,"lockMovementX")&&s.left!==c,d=!bn(s,"lockMovementY")&&s.top!==u;return h&&s.set(at,c),d&&s.set(Pr,u),(h||d)&&Vp(Vw,Hp(r,e,t,n)),h||d};class u_{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):Dr,i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",p=e?"":this.getSvgFilter(),g=Da(Xt,this.fill);return[Da(Rr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",t,"; ","opacity: ",h,";",p,d].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(Pa(n));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=t?"":'style="'.concat(this.getSvgStyles(),'" '),c=s?'style="'.concat(this.getSvgFilter(),'" '):"",u=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,p=this.stroke,g=this.fill,v=this.shadow,b=[],x=e.indexOf("COMMON_PARTS");let C;u&&(u.clipPathId="CLIPPATH_".concat(Ps()),C='<clipPath id="'.concat(u.clipPathId,`" >
`).concat(u.toClipPathSVG(n),`</clipPath>
`)),d&&b.push("<g ",c,this.getSvgCommons(),` >
`),b.push("<g ",this.getSvgTransform(!1),d?"":c+this.getSvgCommons(),` >
`);const T=[a,h,t?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[x]=T,on(g)&&b.push(g.toSVG(this)),on(p)&&b.push(p.toSVG(this)),v&&b.push(v.toSVG(this)),u&&b.push(C),b.push(e.join("")),b.push(`</g>
`),d&&b.push(`</g>
`),n?n(b.join("")):b.join("")}addPaintOrder(){return this.paintFirst!==Xt?' paint-order="'.concat(this.paintFirst,'" '):""}}function ku(r){return new RegExp("^("+r.join("|")+")\\b","i")}var q0;const mi=String.raw(q0||(q0=Hs(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),Ej=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+mi+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+mi+"))?\\s+(.*)"),kj={cx:at,x:at,r:"radius",cy:Pr,y:Pr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},dd="font-size",fd="clip-path";ku(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);ku(["symbol","image","marker","pattern","view","svg"]);const K0=ku(["symbol","g","a","svg","clipPath","defs"]),Oj=new $(1,0),h_=new $,zp=(r,e)=>r.rotate(e),Hl=(r,e)=>new $(e).subtract(r),zl=r=>r.distanceFrom(h_),Wl=(r,e)=>Math.atan2(co(r,e),f_(r,e)),d_=r=>Wl(Oj,r),Ou=r=>r.eq(h_)?r:r.scalarDivide(zl(r)),Wp=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Ou(new $(-r.y,r.x).scalarMultiply(e?1:-1))},co=(r,e)=>r.x*e.y-r.y*e.x,f_=(r,e)=>r.x*e.x+r.y*e.y,pf=(r,e,t)=>{if(r.eq(e)||r.eq(t))return!0;const n=co(e,t),s=co(e,r),i=co(t,r);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},Z0="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",J0=new RegExp("(?:\\s|^)"+Z0+Z0+"("+mi+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class ss{constructor(e){const t=typeof e=="string"?ss.parseShadow(e):e;Object.assign(this,ss.ownDefaults,t),this.id=Ps()}static parseShadow(e){const t=e.trim(),[,n=0,s=0,i=0]=(J0.exec(t)||[]).map(a=>parseFloat(a)||0);return{color:(t.replace(J0,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=zp(new $(this.offsetX,this.offsetY),It(-e.angle)),n=new lt(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*vt((Math.abs(t.x)+this.blur)/e.width,et.NUM_FRACTION_DIGITS)+20,i=100*vt((Math.abs(t.y)+this.blur)/e.height,et.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(vt(this.blur?this.blur/2:0,et.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(vt(t.x,et.NUM_FRACTION_DIGITS),'" dy="').concat(vt(t.y,et.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=ss.ownDefaults;return this.includeDefaultValues?e:Np(e,(n,s)=>n!==t[s])}static async fromObject(e){return new this(e)}}N(ss,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),N(ss,"type","shadow"),le.setClass(ss,"shadow");const vi=(r,e,t)=>Math.max(r,Math.min(e,t)),Aj=[Pr,at,Sr,$r,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Po,Do],ls=[Xt,Rr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],Ij={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:at,originY:Pr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Xt,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},pd=(r,e,t,n)=>(r<Math.abs(e)?(r=e,n=t/4):n=e===0&&r===0?t/as*Math.asin(1):t/as*Math.asin(e/r),{a:r,c:e,p:t,s:n}),Q0=(r,e,t,n,s)=>r*Math.pow(2,10*(n-=1))*Math.sin((n*s-e)*as/t),p_=(r,e,t,n)=>-t*Math.cos(r/n*Ms)+t+e,gf=(r,e,t,n)=>(r/=n)<1/2.75?t*(7.5625*r*r)+e:r<2/2.75?t*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?t*(7.5625*(r-=2.25/2.75)*r+.9375)+e:t*(7.5625*(r-=2.625/2.75)*r+.984375)+e,ey=(r,e,t,n)=>t-gf(n-r,0,t,n)+e;var Mj=Object.freeze({__proto__:null,defaultEasing:p_,easeInBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(r/=n)*r*((s+1)*r-s)+e},easeInBounce:ey,easeInCirc:(r,e,t,n)=>-t*(Math.sqrt(1-(r/=n)*r)-1)+e,easeInCubic:(r,e,t,n)=>t*(r/n)**3+e,easeInElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n)===1)return e+t;i||(i=.3*n);const{a,s:c,p:u}=pd(s,t,i,1.70158);return-Q0(a,c,u,r,n)+e},easeInExpo:(r,e,t,n)=>r===0?e:t*2**(10*(r/n-1))+e,easeInOutBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=n/2)<1?t/2*(r*r*((1+(s*=1.525))*r-s))+e:t/2*((r-=2)*r*((1+(s*=1.525))*r+s)+2)+e},easeInOutBounce:(r,e,t,n)=>r<n/2?.5*ey(2*r,0,t,n)+e:.5*gf(2*r-n,0,t,n)+.5*t+e,easeInOutCirc:(r,e,t,n)=>(r/=n/2)<1?-t/2*(Math.sqrt(1-r**2)-1)+e:t/2*(Math.sqrt(1-(r-=2)*r)+1)+e,easeInOutCubic:(r,e,t,n)=>(r/=n/2)<1?t/2*r**3+e:t/2*((r-2)**3+2)+e,easeInOutElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n/2)===2)return e+t;i||(i=n*(.3*1.5));const{a,s:c,p:u,c:h}=pd(s,t,i,1.70158);return r<1?-.5*Q0(a,c,u,r,n)+e:a*Math.pow(2,-10*(r-=1))*Math.sin((r*n-c)*as/u)*.5+h+e},easeInOutExpo:(r,e,t,n)=>r===0?e:r===n?e+t:(r/=n/2)<1?t/2*2**(10*(r-1))+e:t/2*-(2**(-10*--r)+2)+e,easeInOutQuad:(r,e,t,n)=>(r/=n/2)<1?t/2*r**2+e:-t/2*(--r*(r-2)-1)+e,easeInOutQuart:(r,e,t,n)=>(r/=n/2)<1?t/2*r**4+e:-t/2*((r-=2)*r**3-2)+e,easeInOutQuint:(r,e,t,n)=>(r/=n/2)<1?t/2*r**5+e:t/2*((r-2)**5+2)+e,easeInOutSine:(r,e,t,n)=>-t/2*(Math.cos(Math.PI*r/n)-1)+e,easeInQuad:(r,e,t,n)=>t*(r/=n)*r+e,easeInQuart:(r,e,t,n)=>t*(r/=n)*r**3+e,easeInQuint:(r,e,t,n)=>t*(r/n)**5+e,easeInSine:(r,e,t,n)=>-t*Math.cos(r/n*Ms)+t+e,easeOutBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((r=r/n-1)*r*((s+1)*r+s)+1)+e},easeOutBounce:gf,easeOutCirc:(r,e,t,n)=>t*Math.sqrt(1-(r=r/n-1)*r)+e,easeOutCubic:(r,e,t,n)=>t*((r/n-1)**3+1)+e,easeOutElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n)===1)return e+t;i||(i=.3*n);const{a,s:c,p:u,c:h}=pd(s,t,i,1.70158);return a*2**(-10*r)*Math.sin((r*n-c)*as/u)+h+e},easeOutExpo:(r,e,t,n)=>r===n?e+t:t*-(2**(-10*r/n)+1)+e,easeOutQuad:(r,e,t,n)=>-t*(r/=n)*(r-2)+e,easeOutQuart:(r,e,t,n)=>-t*((r=r/n-1)*r**3-1)+e,easeOutQuint:(r,e,t,n)=>t*((r/n-1)**5+1)+e,easeOutSine:(r,e,t,n)=>t*Math.sin(r/n*Ms)+e});const Pj=()=>!1;class Up{constructor(e){let{startValue:t,byValue:n,duration:s=500,delay:i=0,easing:a=p_,onStart:c=pi,onChange:u=pi,onComplete:h=pi,abort:d=Pj,target:p}=e;N(this,"_state","pending"),N(this,"durationProgress",0),N(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=a,this._onStart=c,this._onChange=u,this._onComplete=h,this._abort=d,this.target=p,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>wa(e),this.delay):wa(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:i}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),wa(this.tick)))}register(){Nl.push(this)}unregister(){Nl.remove(this)}abort(){this._state="aborted",this.unregister()}}const Dj=["startValue","endValue"];class Rj extends Up{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(L(L({},yt(e,Dj)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const jj=["startValue","endValue"];class Lj extends Up{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(L(L({},yt(e,jj)),{},{startValue:t,byValue:n.map((s,i)=>s-t[i])}))}calculate(e){const t=this.startValue.map((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const Fj=["startValue","endValue","easing","onChange","onComplete","abort"],Nj=(r,e,t,n)=>e+t*(1-Math.cos(r/n*Ms)),gd=r=>r&&((e,t,n)=>r(new lt(e).toRgba(),t,n));class Bj extends Up{constructor(e){let{startValue:t,endValue:n,easing:s=Nj,onChange:i,onComplete:a,abort:c}=e,u=yt(e,Fj);const h=new lt(t).getSource(),d=new lt(n).getSource();super(L(L({},u),{},{startValue:h,byValue:d.map((p,g)=>p-h[g]),easing:s,onChange:gd(i),onComplete:gd(a),abort:gd(c)}))}calculate(e){const[t,n,s,i]=this.startValue.map((c,u)=>this.easing(e,c,this.byValue[u],this.duration,u)),a=[...[t,n,s].map(Math.round),vi(0,i,1)];return{value:a,valueProgress:a.map((c,u)=>this.byValue[u]!==0?Math.abs((c-this.startValue[u])/this.byValue[u]):0).find(c=>c!==0)||0}}}function $p(r){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(r)?new Lj(r):new Rj(r);return e.start(),e}function g_(r){const e=new Bj(r);return e.start(),e}class St{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(s=>!this.includes(s))),this}static isPointContained(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const i=Hl(t,n),a=Hl(t,e).divide(i);return s?Math.abs(a.x)===Math.abs(a.y):a.x===a.y&&a.x>=0&&a.x<=1}}static isPointInPolygon(e,t){const n=new $(e).setX(Math.min(e.x-1,...t.map(i=>i.x)));let s=0;for(let i=0;i<t.length;i++){const a=this.intersectSegmentSegment(t[i],t[(i+1)%t.length],e,n);if(a.includes(e))return!0;s+=+(a.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,n,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],a=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const c=t.x-e.x,u=t.y-e.y,h=s.x-n.x,d=s.y-n.y,p=e.x-n.x,g=e.y-n.y,v=h*g-d*p,b=c*g-u*p,x=d*c-h*u;if(x!==0){const C=v/x,T=b/x;return(i||0<=C&&C<=1)&&(a||0<=T&&T<=1)?new St("Intersection").append(new $(e.x+C*c,e.y+C*u)):new St}if(v===0||b===0){const C=i||a||St.isPointContained(e,n,s)||St.isPointContained(t,n,s)||St.isPointContained(n,e,t)||St.isPointContained(s,e,t);return new St(C?"Coincident":void 0)}return new St("Parallel")}static intersectSegmentLine(e,t,n,s){return St.intersectLineLine(e,t,n,s,!1,!0)}static intersectSegmentSegment(e,t,n,s){return St.intersectLineLine(e,t,n,s,!1,!1)}static intersectLinePolygon(e,t,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new St,a=n.length;for(let c,u,h,d=0;d<a;d++){if(c=n[d],u=n[(d+1)%a],h=St.intersectLineLine(e,t,c,u,s,!1),h.status==="Coincident")return h;i.append(...h.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,t,n){return St.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new St,s=e.length,i=[];for(let a=0;a<s;a++){const c=e[a],u=e[(a+1)%s],h=St.intersectSegmentPolygon(c,u,t);h.status==="Coincident"?(i.push(h),n.append(c,u)):n.append(...h.points)}return i.length>0&&i.length===e.length?new St("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const s=t.min(n),i=t.max(n),a=new $(i.x,s.y),c=new $(s.x,i.y);return St.intersectPolygonPolygon(e,[s,a,i,c])}}class Vj extends $w{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?ur(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=ur(e,Ur(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new $(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,t,n,s];if(this.group){const a=this.group.calcTransformMatrix();return i.map(c=>ur(c,a))}return i}intersectsWithRect(e,t){return St.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=St.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:n,top:s,width:i,height:a}=this.getBoundingRect();return n>=e.x&&n+i<=t.x&&s>=e.y&&s+a<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return St.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return Fn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Sr,e),this._set($r,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Ds(qw(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||xr.concat()}calcACoords(){const e=jo({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),s=Ro(t,n),i=Mt(s,e),a=this._getTransformedDimensions(),c=a.x/2,u=a.y/2;return{tl:ur({x:-c,y:-u},i),tr:ur({x:c,y:-u},i),bl:ur({x:-c,y:u},i),br:ur({x:c,y:u},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Ft(this.originX),Ft(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,a)=>i===n[a])?s.value:(this.group&&(t=Mt(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=Zw(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new $(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=L({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let s=n,i=0;this.strokeUniform&&(s=0,i=n);const a=t.width+s,c=t.height+s;let u;return u=t.skewX===0&&t.skewY===0?new $(a*t.scaleX,c*t.scaleY):Tu(a,c,Za(t)),u.scalarAdd(i)}translateToGivenOrigin(e,t,n,s,i){let a=e.x,c=e.y;const u=Ft(s)-Ft(t),h=Ft(i)-Ft(n);if(u||h){const d=this._getTransformedDimensions();a+=u*d.x,c+=h*d.y}return new $(a,c)}translateToCenterPoint(e,t,n){if(t===Be&&n===Be)return e;const s=this.translateToGivenOrigin(e,t,n,Be,Be);return this.angle?s.rotate(It(this.angle),e):s}translateToOriginPoint(e,t,n){const s=this.translateToGivenOrigin(e,Be,Be,t,n);return this.angle?s.rotate(It(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?ur(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new $(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const s=this.translateToCenterPoint(e,t,n),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),at,Pr)}}const Hj=["type"],zj=["extraParam"];let Jn=class Tl extends Vj{static getDefaults(){return Tl.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Is("warn","Setting type has no effect",e)}constructor(e){super(),N(this,"_cacheContext",null),Object.assign(this,Tl.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=cn(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,s=et.maxCacheSideLimit,i=et.minCacheSideLimit;if(t<=s&&n<=s&&t*n<=et.perfLimitSizeTotal)return t<i&&(e.width=i),n<i&&(e.height=i),e;const a=t/n,[c,u]=ba.limitDimsByArea(a),h=vi(i,c,s),d=vi(i,u,s);return t>h&&(e.zoomX/=t/h,e.width=h,e.capped=!0),n>d&&(e.zoomY/=n/d,e.height=d,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:s,zoomX:i,zoomY:a,x:c,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=n!==e.width||s!==e.height,d=this.zoomX!==i||this.zoomY!==a;if(!e||!t)return!1;if(h||d){n!==e.width||s!==e.height?(e.width=n,e.height=s):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const p=c/2,g=u/2;return this.cacheTranslationX=Math.round(e.width/2-p)+p,this.cacheTranslationY=Math.round(e.height/2-g)+g,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(i,a),this.zoomX=i,this.zoomY=a,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new $(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=fo(this.calcTransformMatrix());return new $(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Sr&&e!==$r||(t=this._constrainScale(t)),e===Sr&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof ss||(t=new ss(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i}=this,{width:a,height:c}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i,width:a,height:c,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Rr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const s=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=i}createClipPathLayer(e,t){const n=Cn(t),s=n.getContext("2d");if(s.translate(t.cacheTranslationX,t.cacheTranslationY),s.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach(i=>{i.transform(s)}),t.parentClipPaths.push(e),e.absolutePositioned){const i=Ur(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const s=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,on(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(on(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,a]=n?.viewportTransform||xr,c=i*s,u=a*s,h=t.nonScaling?new $(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*et.browserShadowBlurConstant*(c+u)*(h.x+h.y)/4,e.shadowOffsetX=t.offsetX*c*h.x,e.shadowOffsetY=t.offsetY*u*h.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!on(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,i=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===Rr?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),a=s.x/this.scaleX/i,c=s.y/this.scaleY/i,u=Cn({width:Math.ceil(a),height:Math.ceil(c)}),h=u.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(a,0),h.lineTo(a,c),h.lineTo(0,c),h.closePath(),h.translate(a/2,c/2),h.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(h,t),h.fillStyle=t.toLive(e),h.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(n=h.createPattern(u,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new $(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(le.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Bp(this),n=this.group,s=this.shadow,i=Math.abs,a=e.enableRetinaScaling?Bw():1,c=(e.multiplier||1)*a,u=e.canvasProvider||(k=>new Qa(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&i_(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&ff(this,this.getViewportTransform()),this.setCoords();const h=cn(),d=this.getBoundingRect(),p=this.shadow,g=new $;if(p){const k=p.blur,A=p.nonScaling?new $(1,1):this.getObjectScaling();g.x=2*Math.round(i(p.offsetX)+k)*i(A.x),g.y=2*Math.round(i(p.offsetY)+k)*i(A.y)}const v=d.width+g.x,b=d.height+g.y;h.width=Math.ceil(v),h.height=Math.ceil(b);const x=u(h);e.format==="jpeg"&&(x.backgroundColor="#fff"),this.setPositionByOrigin(new $(x.width/2,x.height/2),Be,Be);const C=this.canvas;x._objects=[this],this.set("canvas",x),this.setCoords();const T=x.toCanvasElement(c||1,e);return this.set("canvas",C),this.shadow=s,n&&(this.group=n),this.set(t),this.setCoords(),x._objects=[],x.destroy(),T}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return jp(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:s}=this;if(t){const{x:i,y:a}=this.getRelativeCenterPoint();this.originX=Be,this.originY=Be,this.left=i,this.top=a}if(this.set("angle",e),t){const{x:i,y:a}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=i,this.top=a,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Nl.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Nn().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((n,s)=>{let[i,a]=s;return n[i]=this._animate(i,a,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:a,startValue:c,onChange:u,onComplete:h}=n,d=L(L({},n),{},{target:this,startValue:c??s.reduce((p,g)=>p[g],this),endValue:t,abort:a?.bind(this),onChange:(p,g,v)=>{s.reduce((b,x,C)=>(C===s.length-1&&(b[x]=p),b[x]),this),u&&u(p,g,v)},onComplete:(p,g,v)=>{this.setCoords(),h&&h(p,g,v)}});return i?g_(d):$p(d)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,i=0;i<t.length;i++){if(s=t[i],s===e)return{fork:[this,...t.slice(0,i)],otherFork:[],common:t.slice(i)};for(let a=0;a<n.length;a++){if(this===n[a])return{fork:[],otherFork:[e,...n.slice(0,a)],common:[this,...t]};if(s===n[a])return{fork:[this,...t.slice(0,i)],otherFork:[e,...n.slice(0,a)],common:t.slice(i)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const s=t.fork.pop(),i=t.otherFork.pop(),a=n._objects.indexOf(s),c=n._objects.indexOf(i);return a>-1&&a>c}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Tl.customProperties,this.constructor.customProperties||[]);let t;const n=et.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:a,shadow:c,strokeDashArray:u,left:h,top:d,originX:p,originY:g,width:v,height:b,strokeWidth:x,strokeLineCap:C,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:A,strokeMiterLimit:I,scaleX:D,scaleY:F,angle:U,flipX:B,flipY:X,opacity:Y,visible:Z,backgroundColor:G,fillRule:K,paintFirst:oe,globalCompositeOperation:ve,skewX:Q,skewY:ge}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const de=M=>vt(M,n),ne=L(L({},Ai(this,e)),{},{type:this.constructor.type,version:lf,originX:p,originY:g,left:de(h),top:de(d),width:de(v),height:de(b),fill:$0(i)?i.toObject():i,stroke:$0(a)?a.toObject():a,strokeWidth:de(x),strokeDashArray:u&&u.concat(),strokeLineCap:C,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:A,strokeMiterLimit:de(I),scaleX:de(D),scaleY:de(F),angle:de(U),flipX:B,flipY:X,opacity:de(Y),shadow:c&&c.toObject(),visible:Z,backgroundColor:G,fillRule:K,paintFirst:oe,globalCompositeOperation:ve,skewX:de(Q),skewY:de(ge)},t?{clipPath:t}:null);return this.includeDefaultValues?ne:this._removeDefaultValues(ne)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return Np(e,(s,i)=>{if(i===at||i===Pr||i==="type")return!0;const a=n[i];return s!==a&&!(Array.isArray(s)&&Array.isArray(a)&&s.length===0&&a.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=yt(e,Hj),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,i=yt(n,zj);return Ja(t,i).then(a=>s?(delete a[s],new this(t[s],a)):new this(a))}static fromObject(e,t){return this._fromObject(e,t)}};N(Jn,"stateProperties",Aj),N(Jn,"cacheProperties",ls),N(Jn,"ownDefaults",Ij),N(Jn,"type","FabricObject"),N(Jn,"colorProperties",[Xt,Rr,"backgroundColor"]),N(Jn,"customProperties",[]),le.setClass(Jn),le.setClass(Jn,"object");const zs=(r,e,t)=>(n,s,i,a)=>{const c=e(n,s,i,a);return c&&Vp(r,L(L({},Hp(n,s,i,a)),t)),c};function Ii(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,t.originX,t.originY),d}}const mf=zs(Ma,Ii((r,e,t,n)=>{const s=Eu(e,e.originX,e.originY,t,n);if(Ft(e.originX)===Ft(Be)||Ft(e.originX)===Ft(jt)&&s.x<0||Ft(e.originX)===Ft(at)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=a_(e)?2:1,u=i.width,h=Math.abs(s.x*c/i.scaleX)-a;return i.set("width",Math.max(h,1)),u!==i.width}return!1}));function m_(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,u=c?Rr:Xt,h=!c&&(n.cornerStrokeColor||s.cornerStrokeColor);let d,p=e,g=t;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i>a?(d=i,r.scale(1,a/i),g=t*i/a):a>i?(d=a,r.scale(i/a,1),p=e*a/i):d=i,r.beginPath(),r.arc(p,g,d/2,0,as,!1),r[u](),h&&r.stroke(),r.restore()}function v_(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,u=c?Rr:Xt,h=!c&&(n.cornerStrokeColor||s.cornerStrokeColor),d=i/2,p=a/2;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",r.translate(e,t);const g=s.getTotalAngle();r.rotate(It(g)),r["".concat(u,"Rect")](-d,-p,i,a),h&&r.strokeRect(-d,-p,i,a),r.restore()}class Ct{constructor(e){N(this,"visible",!0),N(this,"actionName",xu),N(this,"angle",0),N(this,"x",0),N(this,"y",0),N(this,"offsetX",0),N(this,"offsetY",0),N(this,"sizeX",0),N(this,"sizeY",0),N(this,"touchSizeX",0),N(this,"touchSizeY",0),N(this,"cursorStyle","crosshair"),N(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,s){var i;let{tl:a,tr:c,br:u,bl:h}=s;return((i=t.canvas)===null||i===void 0?void 0:i.getActiveObject())===t&&t.isControlVisible(e)&&St.isPointInPolygon(n,[a,c,u,h])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,s){return new $(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,s,i,a){const c=Su([Ro(n,s),jo({angle:e}),Cu((i?this.touchSizeX:this.sizeX)||t,(i?this.touchSizeY:this.sizeY)||t)]);return{tl:new $(-.5,-.5).transform(c),tr:new $(.5,-.5).transform(c),br:new $(.5,.5).transform(c),bl:new $(-.5,.5).transform(c)}}render(e,t,n,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?m_.call(this,e,t,n,s,i):v_.call(this,e,t,n,s,i)}}const y_=(r,e,t)=>t.lockRotation?Vl:e.cursorStyle,b_=zs(Hw,Ii((r,e,t,n)=>{let{target:s,ex:i,ey:a,theta:c,originX:u,originY:h}=e;const d=s.translateToOriginPoint(s.getRelativeCenterPoint(),u,h);if(bn(s,"lockRotation"))return!1;const p=Math.atan2(a-d.y,i-d.x),g=Math.atan2(n-d.y,t-d.x);let v=Ds(g-p+c);if(s.snapAngle&&s.snapAngle>0){const x=s.snapAngle,C=s.snapThreshold||x,T=Math.ceil(v/x)*x,k=Math.floor(v/x)*x;Math.abs(v-k)<C?v=k:Math.abs(v-T)<C&&(v=T)}v<0&&(v=360+v),v%=360;const b=s.angle!==v;return s.angle=v,b}));function w_(r,e){const t=e.canvas,n=r[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function __(r,e,t){const n=bn(r,"lockScalingX"),s=bn(r,"lockScalingY");if(n&&s||!e&&(n||s)&&t||n&&e==="x"||s&&e==="y")return!0;const{width:i,height:a,strokeWidth:c}=r;return i===0&&c===0&&e!=="y"||a===0&&c===0&&e!=="x"}const Wj=["e","se","s","sw","w","nw","n","ne","e"],so=(r,e,t)=>{const n=w_(r,t);if(__(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Vl;const s=c_(t,e);return"".concat(Wj[s],"-resize")};function Yp(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,a=s.by,c=w_(r,i);let u,h,d,p,g,v;if(__(i,a,c))return!1;if(e.gestureScale)h=e.scaleX*e.gestureScale,d=e.scaleY*e.gestureScale;else{if(u=Eu(e,e.originX,e.originY,t,n),g=a!=="y"?Math.sign(u.x||e.signX||1):1,v=a!=="x"?Math.sign(u.y||e.signY||1):1,e.signX||(e.signX=g),e.signY||(e.signY=v),bn(i,"lockScalingFlip")&&(e.signX!==g||e.signY!==v))return!1;if(p=i._getTransformedDimensions(),c&&!a){const C=Math.abs(u.x)+Math.abs(u.y),{original:T}=e,k=C/(Math.abs(p.x*T.scaleX/i.scaleX)+Math.abs(p.y*T.scaleY/i.scaleY));h=T.scaleX*k,d=T.scaleY*k}else h=Math.abs(u.x*i.scaleX/p.x),d=Math.abs(u.y*i.scaleY/p.y);a_(e)&&(h*=2,d*=2),e.signX!==g&&a!=="y"&&(e.originX=G0(e.originX),h*=-1,e.signX=g),e.signY!==v&&a!=="x"&&(e.originY=G0(e.originY),d*=-1,e.signY=v)}const b=i.scaleX,x=i.scaleY;return a?(a==="x"&&i.set(Sr,h),a==="y"&&i.set($r,d)):(!bn(i,"lockScalingX")&&i.set(Sr,h),!bn(i,"lockScalingY")&&i.set($r,d)),b!==i.scaleX||x!==i.scaleY}const pa=zs(_u,Ii((r,e,t,n)=>Yp(r,e,t,n))),x_=zs(_u,Ii((r,e,t,n)=>Yp(r,e,t,n,{by:"x"}))),S_=zs(_u,Ii((r,e,t,n)=>Yp(r,e,t,n,{by:"y"}))),Uj=["target","ex","ey","skewingSide"],md={x:{counterAxis:"y",scale:Sr,skew:Po,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:$r,skew:Do,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},$j=["ns","nesw","ew","nwse"],C_=(r,e,t)=>{if(e.x!==0&&bn(t,"lockSkewingY")||e.y!==0&&bn(t,"lockSkewingX"))return Vl;const n=c_(t,e)%4;return"".concat($j[n],"-resize")};function T_(r,e,t,n,s){const{target:i}=t,{counterAxis:a,origin:c,lockSkewing:u,skew:h,flip:d}=md[r];if(bn(i,u))return!1;const{origin:p,flip:g}=md[a],v=Ft(t[p])*(i[g]?-1:1),b=-Math.sign(v)*(i[d]?-1:1),x=.5*-((i[h]===0&&Eu(t,Be,Be,n,s)[r]>0||i[h]>0?1:-1)*b)+.5;return zs(zw,Ii((T,k,A,I)=>function(D,F,U){let{target:B,ex:X,ey:Y,skewingSide:Z}=F,G=yt(F,Uj);const{skew:K}=md[D],oe=U.subtract(new $(X,Y)).divide(new $(B.scaleX,B.scaleY))[D],ve=B[K],Q=G[K],ge=Math.tan(It(Q)),de=D==="y"?B._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:B._getTransformedDimensions({scaleX:1,scaleY:1}).y,ne=2*oe*Z/Math.max(de,1)+ge,M=Ds(Math.atan(ne));B.set(K,M);const z=ve!==B[K];if(z&&D==="y"){const{skewX:ce,scaleX:fe}=B,be=B._getTransformedDimensions({skewY:ve}),ye=B._getTransformedDimensions(),ue=ce!==0?be.x/ye.x:1;ue!==1&&B.set(Sr,ue*fe)}return z}(r,k,new $(A,I))))(e,L(L({},t),{},{[c]:x,skewingSide:b}),n,s)}const E_=(r,e,t,n)=>T_("x",r,e,t,n),k_=(r,e,t,n)=>T_("y",r,e,t,n);function Au(r,e){return r[e.canvas.altActionKey]}const ga=(r,e,t)=>{const n=Au(r,t);return e.x===0?n?Po:$r:e.y===0?n?Do:Sr:""},hi=(r,e,t)=>Au(r,t)?C_(0,e,t):so(r,e,t),vf=(r,e,t,n)=>Au(r,e.target)?k_(r,e,t,n):x_(r,e,t,n),yf=(r,e,t,n)=>Au(r,e.target)?E_(r,e,t,n):S_(r,e,t,n),Xp=()=>({ml:new Ct({x:-.5,y:0,cursorStyleHandler:hi,actionHandler:vf,getActionName:ga}),mr:new Ct({x:.5,y:0,cursorStyleHandler:hi,actionHandler:vf,getActionName:ga}),mb:new Ct({x:0,y:.5,cursorStyleHandler:hi,actionHandler:yf,getActionName:ga}),mt:new Ct({x:0,y:-.5,cursorStyleHandler:hi,actionHandler:yf,getActionName:ga}),tl:new Ct({x:-.5,y:-.5,cursorStyleHandler:so,actionHandler:pa}),tr:new Ct({x:.5,y:-.5,cursorStyleHandler:so,actionHandler:pa}),bl:new Ct({x:-.5,y:.5,cursorStyleHandler:so,actionHandler:pa}),br:new Ct({x:.5,y:.5,cursorStyleHandler:so,actionHandler:pa}),mtr:new Ct({x:0,y:-.5,actionHandler:b_,cursorStyleHandler:y_,offsetY:-40,withConnection:!0,actionName:Dp})}),O_=()=>({mr:new Ct({x:.5,y:0,actionHandler:mf,cursorStyleHandler:hi,actionName:Ma}),ml:new Ct({x:-.5,y:0,actionHandler:mf,cursorStyleHandler:hi,actionName:Ma})}),A_=()=>L(L({},Xp()),O_());class Ra extends Jn{static getDefaults(){return L(L({},super.getDefaults()),Ra.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),Ra.ownDefaults),this.setOptions(e)}static createControls(){return{controls:Xp()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,s=t.action;if(this===n&&s&&s.startsWith(xu))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[i,a]=n[s],c=this.controls[i];if(c.shouldActivate(i,this,e,t?a.touchCorner:a.corner))return this.__corner=i,{key:i,control:c,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=Ro(t.x,t.y),s=jo({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=Mt(n,s),a=Mt(e,i),c=Mt(a,[1/e[0],0,0,1/e[3],0,0]),u=this.group?fo(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const h=this._calculateCurrentDimensions(u),d={};return this.forEachControl((p,g)=>{const v=p.positionHandler(h,c,this,p);d[g]=Object.assign(v,this._calcCornerCoords(p,v))}),d}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(It(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=L({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,i=L({hasBorders:n,hasControls:s},t),a=this.getViewportTransform(),c=i.hasBorders,u=i.hasControls,h=Mt(a,this.calcTransformMatrix()),d=fo(h);e.save(),e.translate(d.translateX,d.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),e.rotate(It(this.group?d.angle:this.angle)),c&&this.drawBorders(e,d,t),u&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let s;if(n&&n.forActiveSelection||this.group){const i=Tu(this.width,this.height,Za(t)),a=this.isStrokeAccountedForInDimensions()?Rp:(this.strokeUniform?new $().scalarAdd(this.canvas?this.canvas.getZoom():1):new $(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(a).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(n=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:a}=this,c=L({cornerStrokeColor:s,cornerDashArray:i,cornerColor:a},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=c.cornerColor,this.transparentCorners||(e.strokeStyle=c.cornerStrokeColor),this._setLineDash(e,c.cornerDashArray),this.forEachControl((u,h)=>{if(u.getVisibility(this,h)){const d=this.oCoords[h];u.render(e,d.x,d.y,c,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,s]=t;return this.setControlVisible(n,s)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const s=this.width+4,i=this.height+4;return t.clearRect(-s/2,-i/2,s,i),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function I_(r,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),r}N(Ra,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class ht extends Ra{}I_(ht,[u_]),le.setClass(ht),le.setClass(ht,"object");const M_=(r,e,t,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=r.getImageData(e-n,t-n,s,s);for(let a=3;a<i.length;a+=4)if(i[a]>0)return!1;return!0};class P_{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new $(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new $(1/this.options.scaleX,1/this.options.scaleY):new $(1,1)}createSideVector(e,t){const n=Hl(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new $(e);return t.y+=t.x*Math.tan(It(this.options.skewY)),t.x+=t.y*Math.tan(It(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const Yj=new $;class lo extends P_{static getOrthogonalRotationFactor(e,t){const n=t?Wl(e,t):d_(e);return Math.abs(n)<Ms?-1:1}constructor(e,t,n,s){super(s),N(this,"AB",void 0),N(this,"AC",void 0),N(this,"alpha",void 0),N(this,"bisector",void 0),this.A=new $(e),this.B=new $(t),this.C=new $(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Wl(this.AB,this.AC),this.bisector=Ou(zp(this.AB.eq(Yj)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),i=Wp(s),a=lo.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,n*a)}projectBevel(){const e=[];return(this.alpha%as==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),i=this.options.strokeUniform?zl(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return zl(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],s=new $(lo.getOrthogonalRotationFactor(this.bisector),lo.getOrthogonalRotationFactor(new $(this.bisector.y,this.bisector.x)));return[new $(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new $(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{pf(i,e,t)&&n.push(this.A.add(i))}),n}projectRoundWithSkew(e,t){const n=[],{skewX:s,skewY:i,scaleX:a,scaleY:c,strokeUniform:u}=this.options,h=new $(Math.tan(It(s)),Math.tan(It(i))),d=this.strokeProjectionMagnitude,p=u?d/c/Math.sqrt(1/c**2+1/a**2*h.y**2):d/Math.sqrt(1+h.y**2),g=new $(Math.sqrt(Math.max(d**2-p**2,0)),p),v=u?d/Math.sqrt(1+h.x**2*(1/c)**2/(1/a+1/a*h.x*h.y)**2):d/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),b=new $(v,Math.sqrt(Math.max(d**2-v**2,0)));return[b,b.scalarMultiply(-1),g,g.scalarMultiply(-1)].map(x=>this.applySkew(u?x.multiply(this.strokeUniformScalar):x)).forEach(x=>{pf(x,e,t)&&n.push(this.applySkew(this.A).add(x))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%as==0,n=this.applySkew(this.A),s=e[t?0:2].subtract(n),i=e[t?1:0].subtract(n),a=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),c=co(s,a)>0,u=c?s:i,h=c?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(u,h)):e.push(...this.projectRoundNoSkew(u,h)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class ty extends P_{constructor(e,t,n){super(n),this.A=new $(e),this.T=new $(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(Wp(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new $(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new lo(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new $(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(Ou(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(t),s.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const D_=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(r.length===0)return n;const s=r.reduce((i,a)=>(i[i.length-1].eq(a)||i.push(new $(a)),i),[new $(r[0])]);if(s.length===1)t=!0;else if(!t){const i=s[0],a=((c,u)=>{for(let h=c.length-1;h>=0;h--)if(u(c[h],h,c))return h;return-1})(s,c=>!c.eq(i));s.splice(a+1)}return s.forEach((i,a,c)=>{let u,h;a===0?(h=c[1],u=t?i:c[c.length-1]):a===c.length-1?(u=c[a-1],h=t?i:c[0]):(u=c[a-1],h=c[a+1]),t&&c.length===1?n.push(...new ty(i,i,e).project()):!t||a!==0&&a!==c.length-1?n.push(...new lo(i,u,h,e).project()):n.push(...new ty(i,a===0?h:u,e).project())}),n},Gp=r=>{const e={};return Object.keys(r).forEach(t=>{e[t]={},Object.keys(r[t]).forEach(n=>{e[t][n]=L({},r[t][n])})}),e},R_=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Iu=r=>{const e=[];for(let t,n=0;n<r.length;n++)(t=Xj(r,n))!==!1&&e.push(t);return e},Xj=(r,e)=>{const t=r.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return r.charAt(e);if(55296<=t&&t<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";const s=r.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=r.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var Gj=Object.freeze({__proto__:null,capitalize:function(r){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(e?r.slice(1):r.slice(1).toLowerCase())},escapeXml:R_,graphemeSplit:Iu});const Mu=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||t&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},j_=(r,e)=>{const t=e.split(`
`),n=[];let s=-1,i={};r=Gp(r);for(let a=0;a<t.length;a++){const c=Iu(t[a]);if(r[a])for(let u=0;u<c.length;u++){s++;const h=r[a][u];h&&Object.keys(h).length>0&&(Mu(i,h,!0)?n.push({start:s,end:s+1,style:h}):n[n.length-1].end++),i=h||{}}else s+=c.length,i={}}return n},L_=(r,e)=>{if(!Array.isArray(r))return Gp(r);const t=e.split(Pp),n={};let s=-1,i=0;for(let a=0;a<t.length;a++){const c=Iu(t[a]);for(let u=0;u<c.length;u++)s++,r[i]&&r[i].start<=s&&s<r[i].end&&(n[a]=n[a]||{},n[a][u]=L({},r[i].style),s===r[i].end-1&&i++)}return n},Ws=["display","transform",Xt,"fill-opacity","fill-rule","opacity",Rr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function ry(r,e){const t=r.nodeName,n=r.getAttribute("class"),s=r.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let a;if(a=new RegExp("^"+t,"i"),e=e.replace(a,""),s&&e.length&&(a=new RegExp("#"+s+i,"i"),e=e.replace(a,"")),n&&e.length){const c=n.split(" ");for(let u=c.length;u--;)a=new RegExp("\\."+c[u]+i,"i"),e=e.replace(a,"")}return e.length===0}function qj(r,e){let t=!0;const n=ry(r,e.pop());return n&&e.length&&(t=function(s,i){let a,c=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)c&&(a=i.pop()),c=ry(s=s.parentElement,a);return i.length===0}(r,e)),n&&t&&e.length===0}const Kj=r=>{var e;return(e=kj[r])!==null&&e!==void 0?e:r},Zj=new RegExp("(".concat(mi,")"),"gi"),Jj=r=>r.replace(Zj," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var ny,sy,iy,oy,ay,cy,ly;const wr="(".concat(mi,")"),Qj=String.raw(ny||(ny=Hs(["(skewX)(",")"],["(skewX)\\(","\\)"])),wr),eL=String.raw(sy||(sy=Hs(["(skewY)(",")"],["(skewY)\\(","\\)"])),wr),tL=String.raw(iy||(iy=Hs(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),wr,wr,wr),rL=String.raw(oy||(oy=Hs(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),wr,wr),nL=String.raw(ay||(ay=Hs(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),wr,wr),sL=String.raw(cy||(cy=Hs(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),wr,wr,wr,wr,wr,wr),qp="(?:".concat(sL,"|").concat(nL,"|").concat(tL,"|").concat(rL,"|").concat(Qj,"|").concat(eL,")"),iL="(?:".concat(qp,"*)"),oL=String.raw(ly||(ly=Hs(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),iL),aL=new RegExp(oL),cL=new RegExp(qp),lL=new RegExp(qp,"g");function bf(r){const e=[];if(!(r=Jj(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!aL.test(r))return[...xr];for(const t of r.matchAll(lL)){const n=cL.exec(t[0]);if(!n)continue;let s=xr;const i=n.filter(b=>!!b),[,a,...c]=i,[u,h,d,p,g,v]=c.map(b=>parseFloat(b));switch(a){case"translate":s=Ro(u,h);break;case Dp:s=jo({angle:u},{x:h,y:d});break;case xu:s=Cu(u,h);break;case Po:s=Lp(u);break;case Do:s=Fp(u);break;case"matrix":s=[u,h,d,p,g,v]}e.push(s)}return Su(e)}function uL(r,e,t,n){const s=Array.isArray(e);let i,a=e;if(r!==Xt&&r!==Rr||e!==Dr){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")a=e===Dr?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")a=t&&t.transformMatrix?Mt(t.transformMatrix,bf(e)):bf(e);else if(r==="visible")a=e!==Dr&&e!=="hidden",t&&t.visible===!1&&(a=!1);else if(r==="opacity")a=parseFloat(e),t&&t.opacity!==void 0&&(a*=t.opacity);else if(r==="textAnchor")a=e==="start"?at:e==="end"?jt:Be;else if(r==="charSpacing")i=gi(e,n)/n*1e3;else if(r==="paintFirst"){const c=e.indexOf(Xt),u=e.indexOf(Rr);a=Xt,(c>-1&&u>-1&&u<c||c===-1&&u>-1)&&(a=Rr)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(gi):gi(e,n)}}else a="";return!s&&isNaN(i)?a:i}function hL(r,e){const t=r.match(Ej);if(!t)return;const n=t[1],s=t[3],i=t[4],a=t[5],c=t[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=gi(i)),c&&(e.fontFamily=c),a&&(e.lineHeight=a==="normal"?1:a)}function dL(r,e){r.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[n,s]=t.split(":");e[n.trim().toLowerCase()]=s.trim()})}function fL(r){const e={},t=r.getAttribute("style");return t&&(typeof t=="string"?dL(t,e):function(n,s){Object.entries(n).forEach(i=>{let[a,c]=i;c!==void 0&&(s[a.toLowerCase()]=c)})}(t,e)),e}const pL={stroke:"strokeOpacity",fill:"fillOpacity"};function us(r,e,t){if(!r)return{};let n,s={},i=Mp;r.parentNode&&K0.test(r.parentNode.nodeName)&&(s=us(r.parentElement,e,t),s.fontSize&&(n=i=gi(s.fontSize)));const a=L(L(L({},e.reduce((h,d)=>{const p=r.getAttribute(d);return p&&(h[d]=p),h},{})),function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={};for(const g in d)qj(h,g.split(" "))&&(p=L(L({},p),d[g]));return p}(r,t)),fL(r));a[fd]&&r.setAttribute(fd,a[fd]),a[dd]&&(n=gi(a[dd],i),a[dd]="".concat(n));const c={};for(const h in a){const d=Kj(h),p=uL(d,a[h],s,n);c[d]=p}c&&c.font&&hL(c.font,c);const u=L(L({},s),c);return K0.test(r.nodeName)?u:function(h){const d=ht.getDefaults();return Object.entries(pL).forEach(p=>{let[g,v]=p;if(h[v]===void 0||h[g]==="")return;if(h[g]===void 0){if(!d[g])return;h[g]=d[g]}if(h[g].indexOf("url(")===0)return;const b=new lt(h[g]);h[g]=b.setAlpha(vt(b.getAlpha()*h[v],2)).toRgba()}),h}(u)}const gL=["left","top","width","height","visible"],F_=["rx","ry"];class Nt extends ht{static getDefaults(){return L(L({},super.getDefaults()),Nt.ownDefaults)}constructor(e){super(),Object.assign(this,Nt.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,s=-t/2,i=-n/2,a=this.rx?Math.min(this.rx,t/2):0,c=this.ry?Math.min(this.ry,n/2):0,u=a!==0||c!==0;e.beginPath(),e.moveTo(s+a,i),e.lineTo(s+t-a,i),u&&e.bezierCurveTo(s+t-Ts*a,i,s+t,i+Ts*c,s+t,i+c),e.lineTo(s+t,i+n-c),u&&e.bezierCurveTo(s+t,i+n-Ts*c,s+t-Ts*a,i+n,s+t-a,i+n),e.lineTo(s+a,i+n),u&&e.bezierCurveTo(s+Ts*a,i+n,s,i+n-Ts*c,s,i+n-c),e.lineTo(s,i+c),u&&e.bezierCurveTo(s,i+Ts*c,s+Ts*a,i,s+a,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...F_,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const s=us(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,width:c=0,height:u=0,visible:h=!0}=s,d=yt(s,gL);return new this(L(L(L({},t),d),{},{left:i,top:a,width:c,height:u,visible:!!(h&&c&&u)}))}}N(Nt,"type","Rect"),N(Nt,"cacheProperties",[...ls,...F_]),N(Nt,"ownDefaults",{rx:0,ry:0}),N(Nt,"ATTRIBUTE_NAMES",[...Ws,"x","y","rx","ry","width","height"]),le.setClass(Nt),le.setSVGClass(Nt);const ts="initialization",Ul="added",Kp="removed",$l="imperative",N_=(r,e)=>{const{strokeUniform:t,strokeWidth:n,width:s,height:i,group:a}=e,c=a&&a!==r?ec(a.calcTransformMatrix(),r.calcTransformMatrix()):null,u=c?e.getRelativeCenterPoint().transform(c):e.getRelativeCenterPoint(),h=!e.isStrokeAccountedForInDimensions(),d=t&&h?o_(new $(n,n),void 0,r.calcTransformMatrix()):Rp,p=!t&&h?n:0,g=Tu(s+p,i+p,Su([c,e.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[u.subtract(g),u.add(g)]};class Pu{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:s}=e;return t===ts||t===$l||!!n&&s!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==ts&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:s}=t;if(n===$l&&t.overrides)return t.overrides;if(e.length===0)return;const{left:i,top:a,width:c,height:u}=Fn(e.map(p=>N_(s,p)).reduce((p,g)=>p.concat(g),[])),h=new $(c,u),d=new $(i,a).add(h.scalarDivide(2));if(n===ts){const p=this.getInitialSize(t,{size:h,center:d});return{center:d,relativeCorrection:new $(0,0),size:p}}return{center:d.transform(s.calcOwnMatrix()),size:h}}}N(Pu,"type","strategy");class wf extends Pu{shouldPerformLayout(e){return!0}}N(wf,"type","fit-content"),le.setClass(wf);const mL=["strategy"],vL=["target","strategy","bubbles","prevStrategy"],B_="layoutManager";class ja{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new wf;N(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=L(L({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[Fl,Vw,Ma,Hw,_u,zw,Ll,Ww,bj].map(s=>e.on(s,i=>this.performLayout(s===Fl?{type:"object_modified",trigger:s,e:i,target:n}:{type:"object_modifying",trigger:s,e:i,target:n})))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:s}=t;if(n===ts||n===Ul?this.subscribeTargets(e):n===Kp&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),n===$l&&e.deep){const i=yt(e,mL);t.forEachObject(a=>a.layoutManager&&a.layoutManager.performLayout(L(L({},i),{},{bubbles:!1,target:a})))}}getLayoutResult(e){const{target:t,strategy:n,type:s}=e,i=n.calcLayoutResult(e,t.getObjects());if(!i)return;const a=s===ts?new $:t.getRelativeCenterPoint(),{center:c,correction:u=new $,relativeCorrection:h=new $}=i,d=a.subtract(c).add(u).transform(s===ts?xr:Ur(t.calcOwnMatrix()),!0).add(h);return{result:i,prevCenter:a,nextCenter:c,offset:d}}commitLayout(e,t){const{target:n}=e,{result:{size:s},nextCenter:i}=t;var a,c;n.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===ts?n.set({left:(a=e.x)!==null&&a!==void 0?a:i.x+s.x*Ft(n.originX),top:(c=e.y)!==null&&c!==void 0?c:i.y+s.y*Ft(n.originY)}):(n.setPositionByOrigin(i,Be,Be),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject(s=>{s.group===n&&this.layoutObject(e,t,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:s}=t;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,t){const{target:n,strategy:s,bubbles:i,prevStrategy:a}=e,c=yt(e,vL),{canvas:u}=n;n.fire("layout:after",{context:e,result:t}),u&&u.fire("object:layout:after",{context:e,result:t,target:n});const h=n.parent;i&&h!=null&&h.layoutManager&&((c.path||(c.path=[])).push(n),h.layoutManager.performLayout(L(L({},c),{},{target:h}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(n=>n())),e.clear()}toObject(){return{type:B_,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}le.setClass(ja,B_);const yL=["type","objects","layoutManager"];class bL extends ja{performLayout(){}}class an extends Uw(ht){static getDefaults(){return L(L({},super.getDefaults()),an.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),N(this,"_activeObjects",[]),N(this,"__objectSelectionTracker",void 0),N(this,"__objectSelectionDisposer",void 0),Object.assign(this,an.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new ja,this.layoutManager.performLayout({type:ts,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Is("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Is("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,s)=>this.canEnterGroup(t)&&s.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(t),i=super.add(...s);return this._onAfterObjectsChange(Ul,s),i}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(n),a=super.insertAt(e,...i);return this._onAfterObjectsChange(Ul,i),a}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(Kp,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(s=>{s._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(n);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&go(e,Mt(Ur(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(go(e,Mt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=ht.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const a=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&a.group!==this?(e.save(),e.transform(...Ur(this.calcTransformMatrix())),a.render(e),e.restore()):a.group===this&&a.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(L({target:this,type:$l},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=n;const a=s[e||"toObject"](t);return s.includeDefaultValues=i,a})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return L(L(L({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=Nt.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:s=[],layoutManager:i}=e,a=yt(e,yL);return Promise.all([po(s,t),Ja(a,t)]).then(c=>{let[u,h]=c;const d=new this(u,L(L(L({},a),h),{},{layoutManager:new bL}));if(i){const p=le.getClass(i.type),g=le.getClass(i.strategy);d.layoutManager=new p(new g)}else d.layoutManager=new ja;return d.layoutManager.subscribeTargets({type:ts,target:d,targets:d.getObjects()}),d.setCoords(),d})}}N(an,"type","Group"),N(an,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),le.setClass(an);const V_=(r,e)=>Math.min(e.width/r.width,e.height/r.height),H_=(r,e)=>Math.max(e.width/r.width,e.height/r.height),_f="\\s*,?\\s*",ua="".concat(_f,"(").concat(mi,")"),wL="".concat(ua).concat(ua).concat(ua).concat(_f,"([01])").concat(_f,"([01])").concat(ua).concat(ua),_L={m:"l",M:"L"},xL=(r,e,t,n,s,i,a,c,u,h,d)=>{const p=xn(r),g=Sn(r),v=xn(e),b=Sn(e),x=t*s*v-n*i*b+a,C=n*s*v+t*i*b+c;return["C",h+u*(-t*s*g-n*i*p),d+u*(-n*s*g+t*i*p),x+u*(t*s*b+n*i*v),C+u*(n*s*b-t*i*v),x,C]},uy=(r,e,t,n)=>{const s=Math.atan2(e,r),i=Math.atan2(n,t);return i>=s?i-s:2*Math.PI-(s-i)};function xf(r,e,t,n,s,i,a,c){let u;if(et.cachesBoundsOfCurve&&(u=[...arguments].join(),ba.boundsOfCurveCache[u]))return ba.boundsOfCurveCache[u];const h=Math.sqrt,d=Math.abs,p=[],g=[[0,0],[0,0]];let v=6*r-12*t+6*s,b=-3*r+9*t-9*s+3*a,x=3*t-3*r;for(let I=0;I<2;++I){if(I>0&&(v=6*e-12*n+6*i,b=-3*e+9*n-9*i+3*c,x=3*n-3*e),d(b)<1e-12){if(d(v)<1e-12)continue;const X=-x/v;0<X&&X<1&&p.push(X);continue}const D=v*v-4*x*b;if(D<0)continue;const F=h(D),U=(-v+F)/(2*b);0<U&&U<1&&p.push(U);const B=(-v-F)/(2*b);0<B&&B<1&&p.push(B)}let C=p.length;const T=C,k=W_(r,e,t,n,s,i,a,c);for(;C--;){const{x:I,y:D}=k(p[C]);g[0][C]=I,g[1][C]=D}g[0][T]=r,g[1][T]=e,g[0][T+1]=a,g[1][T+1]=c;const A=[new $(Math.min(...g[0]),Math.min(...g[1])),new $(Math.max(...g[0]),Math.max(...g[1]))];return et.cachesBoundsOfCurve&&(ba.boundsOfCurveCache[u]=A),A}const SL=(r,e,t)=>{let[n,s,i,a,c,u,h,d]=t;const p=((g,v,b,x,C,T,k)=>{if(b===0||x===0)return[];let A=0,I=0,D=0;const F=Math.PI,U=k*Ip,B=Sn(U),X=xn(U),Y=.5*(-X*g-B*v),Z=.5*(-X*v+B*g),G=b**2,K=x**2,oe=Z**2,ve=Y**2,Q=G*K-G*oe-K*ve;let ge=Math.abs(b),de=Math.abs(x);if(Q<0){const wt=Math.sqrt(1-Q/(G*K));ge*=wt,de*=wt}else D=(C===T?-1:1)*Math.sqrt(Q/(G*oe+K*ve));const ne=D*ge*Z/de,M=-D*de*Y/ge,z=X*ne-B*M+.5*g,ce=B*ne+X*M+.5*v;let fe=uy(1,0,(Y-ne)/ge,(Z-M)/de),be=uy((Y-ne)/ge,(Z-M)/de,(-Y-ne)/ge,(-Z-M)/de);T===0&&be>0?be-=2*F:T===1&&be<0&&(be+=2*F);const ye=Math.ceil(Math.abs(be/F*2)),ue=[],Xe=be/ye,ze=8/3*Math.sin(Xe/4)*Math.sin(Xe/4)/Math.sin(Xe/2);let bt=fe+Xe;for(let wt=0;wt<ye;wt++)ue[wt]=xL(fe,bt,X,B,ge,de,z,ce,ze,A,I),A=ue[wt][5],I=ue[wt][6],fe=bt,bt+=Xe;return ue})(h-r,d-e,s,i,c,u,a);for(let g=0,v=p.length;g<v;g++)p[g][1]+=r,p[g][2]+=e,p[g][3]+=r,p[g][4]+=e,p[g][5]+=r,p[g][6]+=e;return p},z_=r=>{let e=0,t=0,n=0,s=0;const i=[];let a,c=0,u=0;for(const h of r){const d=[...h];let p;switch(d[0]){case"l":d[1]+=e,d[2]+=t;case"L":e=d[1],t=d[2],p=["L",e,t];break;case"h":d[1]+=e;case"H":e=d[1],p=["L",e,t];break;case"v":d[1]+=t;case"V":t=d[1],p=["L",e,t];break;case"m":d[1]+=e,d[2]+=t;case"M":e=d[1],t=d[2],n=d[1],s=d[2],p=["M",e,t];break;case"c":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t,d[5]+=e,d[6]+=t;case"C":c=d[3],u=d[4],e=d[5],t=d[6],p=["C",d[1],d[2],c,u,e,t];break;case"s":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"S":a==="C"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[3],t=d[4],p=["C",c,u,d[1],d[2],e,t],c=p[3],u=p[4];break;case"q":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"Q":c=d[1],u=d[2],e=d[3],t=d[4],p=["Q",c,u,e,t];break;case"t":d[1]+=e,d[2]+=t;case"T":a==="Q"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[1],t=d[2],p=["Q",c,u,e,t];break;case"a":d[6]+=e,d[7]+=t;case"A":SL(e,t,d).forEach(g=>i.push(g)),e=d[6],t=d[7];break;case"z":case"Z":e=n,t=s,p=["Z"]}p?(i.push(p),a=p[0]):a=""}return i},Yl=(r,e,t,n)=>Math.sqrt((t-r)**2+(n-e)**2),W_=(r,e,t,n,s,i,a,c)=>u=>{const h=u**3,d=(v=>3*v**2*(1-v))(u),p=(v=>3*v*(1-v)**2)(u),g=(v=>(1-v)**3)(u);return new $(a*h+s*d+t*p+r*g,c*h+i*d+n*p+e*g)},U_=r=>r**2,$_=r=>2*r*(1-r),Y_=r=>(1-r)**2,CL=(r,e,t,n,s,i,a,c)=>u=>{const h=U_(u),d=$_(u),p=Y_(u),g=3*(p*(t-r)+d*(s-t)+h*(a-s)),v=3*(p*(n-e)+d*(i-n)+h*(c-i));return Math.atan2(v,g)},TL=(r,e,t,n,s,i)=>a=>{const c=U_(a),u=$_(a),h=Y_(a);return new $(s*c+t*u+r*h,i*c+n*u+e*h)},EL=(r,e,t,n,s,i)=>a=>{const c=1-a,u=2*(c*(t-r)+a*(s-t)),h=2*(c*(n-e)+a*(i-n));return Math.atan2(h,u)},hy=(r,e,t)=>{let n=new $(e,t),s=0;for(let i=1;i<=100;i+=1){const a=r(i/100);s+=Yl(n.x,n.y,a.x,a.y),n=a}return s},kL=(r,e)=>{let t,n=0,s=0,i={x:r.x,y:r.y},a=L({},i),c=.01,u=0;const h=r.iterator,d=r.angleFinder;for(;s<e&&c>1e-4;)a=h(n),u=n,t=Yl(i.x,i.y,a.x,a.y),t+s>e?(n-=c,c/=2):(i=a,n+=c,s+=t);return L(L({},a),{},{angle:d(u)})},Zp=r=>{let e,t,n=0,s=0,i=0,a=0,c=0;const u=[];for(const h of r){const d={x:s,y:i,command:h[0],length:0};switch(h[0]){case"M":t=d,t.x=a=s=h[1],t.y=c=i=h[2];break;case"L":t=d,t.length=Yl(s,i,h[1],h[2]),s=h[1],i=h[2];break;case"C":e=W_(s,i,h[1],h[2],h[3],h[4],h[5],h[6]),t=d,t.iterator=e,t.angleFinder=CL(s,i,h[1],h[2],h[3],h[4],h[5],h[6]),t.length=hy(e,s,i),s=h[5],i=h[6];break;case"Q":e=TL(s,i,h[1],h[2],h[3],h[4]),t=d,t.iterator=e,t.angleFinder=EL(s,i,h[1],h[2],h[3],h[4]),t.length=hy(e,s,i),s=h[3],i=h[4];break;case"Z":t=d,t.destX=a,t.destY=c,t.length=Yl(s,i,a,c),s=a,i=c}n+=t.length,u.push(t)}return u.push({length:n,x:s,y:i}),u},X_=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zp(r),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const s=t[n],i=e/s.length,a=r[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return L(L({},new $(s.x,s.y).lerp(new $(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return L(L({},new $(s.x,s.y).lerp(new $(a[1],a[2]),i)),{},{angle:Math.atan2(a[2]-s.y,a[1]-s.x)});case"C":case"Q":return kL(s,e)}},OL=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),dy=new RegExp(wL,"g"),AL=new RegExp(mi,"gi"),IL={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},G_=r=>{var e;const t=[],n=(e=r.match(OL))!==null&&e!==void 0?e:[];for(const s of n){const i=s[0];if(i==="z"||i==="Z"){t.push([i]);continue}const a=IL[i.toLowerCase()];let c=[];if(i==="a"||i==="A"){dy.lastIndex=0;for(let u=null;u=dy.exec(s);)c.push(...u.slice(1))}else c=s.match(AL)||[];for(let u=0;u<c.length;u+=a){const h=new Array(a),d=_L[i];h[0]=u>0&&d?d:i;for(let p=0;p<a;p++)h[p+1]=parseFloat(c[u+p]);t.push(h)}}return t},ML=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new $(r[0]),n=new $(r[1]),s=1,i=0;const a=[],c=r.length,u=c>2;let h;for(u&&(s=r[2].x<n.x?-1:r[2].x===n.x?0:1,i=r[2].y<n.y?-1:r[2].y===n.y?0:1),a.push(["M",t.x-s*e,t.y-i*e]),h=1;h<c;h++){if(!t.eq(n)){const d=t.midPointFrom(n);a.push(["Q",t.x,t.y,d.x,d.y])}t=r[h],h+1<r.length&&(n=r[h+1])}return u&&(s=t.x>r[h-2].x?1:t.x===r[h-2].x?0:-1,i=t.y>r[h-2].y?1:t.y===r[h-2].y?0:-1),a.push(["L",t.x+s*e,t.y+i*e]),a},q_=(r,e)=>r.map(t=>t.map((n,s)=>s===0||e===void 0?n:vt(n,e)).join(" ")).join(" ");function Xl(r,e){const t=r.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(n=>{let[s,i]=n;return t.setProperty(s,i)}))}const PL=(r,e)=>Math.floor(Math.random()*(e-r+1))+r;function DL(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||pi,n=new(wu()).XMLHttpRequest,s=e.signal,i=function(){n.abort()},a=function(){s&&s.removeEventListener("abort",i),n.onerror=n.ontimeout=pi};if(s&&s.aborted)throw new Nw("request");return s&&s.addEventListener("abort",i,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(a(),t(n),n.onreadystatechange=pi)},n.onerror=n.ontimeout=a,n.open("get",r,!0),n.send(),n}const RL=(r,e)=>{let t=r._findCenterFromElement();r.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:s,scaleY:i,angle:a,skewX:c}=fo(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(Sr,s),n.set($r,i),n.angle=a,n.skewX=c,n.skewY=0}})(r),t=t.transform(r.transformMatrix)),delete r.transformMatrix,e&&(r.scaleX*=e.scaleX,r.scaleY*=e.scaleY,r.cropX=e.cropX,r.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,r.width=e.width,r.height=e.height),r.setPositionByOrigin(t,Be,Be)};var K_=Object.freeze({__proto__:null,addTransformToObject:s_,animate:$p,animateColor:g_,applyTransformToObject:go,calcAngleBetweenVectors:Wl,calcDimensionsMatrix:Za,calcPlaneChangeMatrix:ec,calcVectorRotation:d_,cancelAnimFrame:Yw,capValue:vi,composeMatrix:Zw,copyCanvasElement:r=>{var e;const t=Cn(r);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(r,0,0),t},cos:xn,createCanvasElement:cn,createImage:Xw,createRotateMatrix:jo,createScaleMatrix:Cu,createSkewXMatrix:Lp,createSkewYMatrix:Fp,createTranslateMatrix:Ro,createVector:Hl,crossProduct:co,degreesToRadians:It,dotProduct:f_,ease:Mj,enlivenObjectEnlivables:Ja,enlivenObjects:po,findScaleToCover:H_,findScaleToFit:V_,getBoundsOfCurve:xf,getOrthonormalVector:Wp,getPathSegmentsInfo:Zp,getPointOnPath:X_,getPointer:n_,getRandomInt:PL,getRegularPolygonPath:(r,e)=>{const t=2*Math.PI/r;let n=-Ms;r%2==0&&(n+=t/2);const s=new Array(r+1);for(let i=0;i<r;i++){const a=i*t+n,{x:c,y:u}=new $(xn(a),Sn(a)).scalarMultiply(e);s[i]=[i===0?"M":"L",c,u]}return s[r]=["Z"],s},getSmoothPathFromPoints:ML,getSvgAttributes:r=>{const e=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:Ou,groupSVGElements:(r,e)=>r&&r.length===1?r[0]:new an(r,e),hasStyleChanged:Mu,invertTransform:Ur,isBetweenVectors:pf,isIdentityMatrix:Gw,isTouchEvent:Bl,isTransparent:M_,joinPath:q_,loadImage:_a,magnitude:zl,makeBoundingBoxFromPoints:Fn,makePathSimpler:z_,matrixToSVG:Pa,mergeClipPaths:(r,e)=>{var t;let n=r,s=e;n.inverted&&!s.inverted&&(n=e,s=r),ff(s,(t=s.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());const i=n.inverted&&s.inverted;return i&&(n.inverted=s.inverted=!1),new an([n],{clipPath:s,inverted:i})},multiplyTransformMatrices:Mt,multiplyTransformMatrixArray:Su,parsePath:G_,parsePreserveAspectRatioAttribute:Jw,parseUnit:gi,pick:Ai,projectStrokeOnPoints:D_,qrDecompose:fo,radiansToDegrees:Ds,removeFromArray:ii,removeTransformFromObject:(r,e)=>{const t=Ur(e),n=Mt(t,r.calcOwnMatrix());go(r,n)},removeTransformMatrixForSvgParsing:RL,request:DL,requestAnimFrame:wa,resetObjectTransform:i_,rotatePoint:(r,e,t)=>r.rotate(t,e),rotateVector:zp,saveObjectTransform:Bp,sendObjectToPlane:ff,sendPointToPlane:ns,sendVectorToPlane:o_,setStyle:Xl,sin:Sn,sizeAfterTransform:Tu,string:Gj,stylesFromArray:L_,stylesToArray:j_,toDataURL:jp,toFixed:vt,transformPath:(r,e,t)=>(t&&(e=Mt(e,[1,0,0,1,-t.x,-t.y])),r.map(n=>{const s=[...n];for(let i=1;i<n.length-1;i+=2){const{x:a,y:c}=ur({x:n[i],y:n[i+1]},e);s[i]=a,s[i+1]=c}return s})),transformPoint:ur});class jL extends r_{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),N(this,"upper",void 0),N(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(i,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const a=this.createContainerElement();a.classList.add(n),s.parentNode&&s.parentNode.replaceChild(a,s),a.append(s,i),this.container=a}createUpperCanvas(){const{el:e}=this.lower,t=cn();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Mo().createElement("div");return e.setAttribute("data-fabric","wrapper"),Xl(e,{position:"relative"}),X0(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:s}=t;Xl(e,L(L({},n),{},{"touch-action":s?"manipulation":Dr})),X0(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:s}=this.upper;t_(n,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),hf(this.upper.el,e),hf(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),Nn().dispose(this.upper.el),delete this.upper,delete this.container}}class Du extends Qa{constructor(){super(...arguments),N(this,"targets",[]),N(this,"_hoveredTargets",[]),N(this,"_objectsToRender",void 0),N(this,"_currentTransform",null),N(this,"_groupSelector",null),N(this,"contextTopDirty",!1)}static getDefaults(){return L(L({},super.getDefaults()),Du.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new jL(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-t+s,-n+s),i.transform(...this.viewportTransform);const a=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=a,i.restore();const c=Math.round(s*this.getRetinaScaling());return M_(i,c,c,c)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&n.length>1&&n.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let s;return t===xu||t===Sr||t===$r||t===Ma?s=this.centeredScaling||e.centeredScaling:t===Dp&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=jt:["mr","tr","br"].includes(t)&&(n.x=at),["tl","mt","tr"].includes(t)?n.y=uf:["bl","mb","br"].includes(t)&&(n.y=Pr)),n}_setupCurrentTransform(e,t,n){var s;const i=t.group?ns(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:a="",control:c}=t.getActiveControl()||{},u=n&&c?(s=c.getActionHandler(e,t,c))===null||s===void 0?void 0:s.bind(c):l_,h=((v,b,x,C)=>{if(!b||!v)return"drag";const T=C.controls[b];return T.getActionName(x,T,C)})(n,a,e,t),d=e[this.centeredKey],p=this._shouldCenterTransform(t,h,d)?{x:Be,y:Be}:this._getOriginFromCorner(t,a),g={target:t,action:h,actionHandler:u,actionPerformed:!1,corner:a,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:i.x-t.left,offsetY:i.y-t.top,originX:p.x,originY:p.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:It(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:d,original:L(L({},Bp(t)),{},{originX:p.x,originY:p.y})};this._currentTransform=g,this.fire("before:transform",{e,transform:g})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new $(t,n).transform(this.viewportTransform),c=new $(t+s,n+i).transform(this.viewportTransform),u=this.selectionLineWidth/2;let h=Math.min(a.x,c.x),d=Math.min(a.y,c.y),p=Math.max(a.x,c.x),g=Math.max(a.y,c.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(h,d,p-h,g-d)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,h+=u,d+=u,p-=u,g-=u,ht.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(h,d,p-h,g-d))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(t,Bl(e))||s.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const a=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&a&&a!==n?(this.targets=i,n):a}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[a,c,u,h]=n,d=Math.atan2(c.y-a.y,c.x-a.x),p=xn(d)*i,g=Sn(d)*i,v=p+g,b=p-g;n=[new $(a.x-b,a.y-v),new $(c.x+v,c.y-b),new $(u.x+b,u.y+v),new $(h.x-v,h.y+b)]}return St.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ns(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,t)){if(Cl(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,t);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&Cl(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const a=s[i];if(!Cl(a)||!a.interactive)return a}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let i=n_(e),a=s.width||0,c=s.height||0;a&&c||(Pr in s&&uf in s&&(c=Math.abs(s.top-s.bottom)),jt in s&&at in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,t||(i=ns(i,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(i.x/=u,i.y/=u);const h=a===0||c===0?new $(1,1):new $(n.width/a,n.height/c);return i.multiply(h)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=cn(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return oi(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,s=!1;const i=this.getActiveObjects(),a=[],c=[];e.forEach(u=>{i.includes(u)||(n=!0,u.fire("deselected",{e:t,target:u}),c.push(u))}),i.forEach(u=>{e.includes(u)||(n=!0,u.fire("selected",{e:t,target:u}),a.push(u))}),e.length>0&&i.length>0?(s=!0,n&&this.fire("selection:updated",{e:t,selected:a,deselected:c})):i.length>0?(s=!0,this.fire("selection:created",{e:t,selected:a})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:c})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),s}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,oi(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),oi(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,s={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),n.fire(Fl,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;oi(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,t,n);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&oi(t)&&this._activeObject===t){const n=Ai(e,["angle","flipX","flipY",at,Sr,$r,Po,Do,Pr]);return s_(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(s)}}N(Du,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class LL{constructor(e){N(this,"targets",[]),N(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),ii(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const FL=["target","oldTarget","fireCanvas","e"],Wr={passive:!1},to=(r,e)=>{const t=r.getViewportPoint(e),n=r.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},Es=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.addEventListener(...t)},nn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.removeEventListener(...t)},NL={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Sf extends Du{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),N(this,"_isClick",void 0),N(this,"textEditingManager",new LL(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(Es,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,s=this._getEventPrefix();e(e_(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,Wr),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Wr)}removeListeners(){this.addOrRemove(nn,"remove");const e=this._getEventPrefix(),t=yn(this.upperCanvasEl);nn(t,"".concat(e,"up"),this._onMouseUp),nn(t,"touchend",this._onTouchEnd,Wr),nn(t,"".concat(e,"move"),this._onMouseMove,Wr),nn(t,"touchmove",this._onMouseMove,Wr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=L({e},to(this,e));this.fire("mouse:out",L(L({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",L({},n)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",L(L({},n),{},{target:s})),s&&s.fire("mouseout",L({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",L({e},to(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void Es(this.upperCanvasEl,"drag",this._onDragProgress)}df(e)}_renderDragEffects(e,t,n){let s=!1;const i=this._dropTarget;i&&i!==t&&i!==n&&(i.clearContextTop(),s=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();const a=this.contextTop;a.save(),a.transform(...this.viewportTransform),t&&(a.save(),t.transform(a),t.renderDragSourceEffect(e),a.restore(),s=!0),n&&(a.save(),n.transform(a),n.renderDropTargetEffect(e),a.restore(),s=!0),a.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Dr,n=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};nn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:s}=this.findDragTargets(e),i=this._dragSource,a={e,target:n,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let c;this.fire(t,a),this._fireEnterLeaveEvents(n,a),n&&(n.canDrop(e)&&(c=n),n.fire(t,a));for(let u=0;u<s.length;u++){const h=s[u];h.canDrop(e)&&(c=h),h.fire(t,a)}this._renderDragEffects(e,i,c),this._dropTarget=c}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),s={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",L({e,target:t,subTargets:n,dragSource:this._dragSource},to(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&df(e),this._basicEventHandler("contextmenu",s),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),a=yn(s);Es(a,"touchend",this._onTouchEnd,Wr),t&&Es(a,"touchmove",this._onMouseMove,Wr),nn(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();nn(t,"".concat(n,"move"),this._onMouseMove,Wr);const s=yn(t);Es(s,"".concat(n,"up"),this._onMouseUp),Es(s,"".concat(n,"move"),this._onMouseMove,Wr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=yn(this.upperCanvasEl);nn(n,"touchend",this._onTouchEnd,Wr),nn(n,"touchmove",this._onMouseMove,Wr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Es(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=yn(this.upperCanvasEl);nn(s,"".concat(n,"up"),this._onMouseUp),nn(s,"".concat(n,"move"),this._onMouseMove,Wr),Es(t,"".concat(n,"move"),this._onMouseMove,Wr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,i=this._target,{button:a}=e;if(a)return(this.fireMiddleClick&&a===1||this.fireRightClick&&a===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let c,u,h=!1;if(n&&(this._finalizeCurrentTransform(e),h=n.actionPerformed),!s){const d=i===this._activeObject;this.handleSelection(e),h||(h=this._shouldRender(i)||!d&&i===this._activeObject)}if(i){const d=i.findControl(this.getViewportPoint(e),Bl(e)),{key:p,control:g}=d||{};if(u=p,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),h=!0;else if(g){const v=g.getMouseUpHandler(e,i,g);v&&(c=this.getScenePoint(e),v.call(g,e,n,c.x,c.y))}i.isMoving=!1}if(n&&(n.target!==i||n.corner!==u)){const d=n.target&&n.target.controls[n.corner],p=d&&d.getMouseUpHandler(e,n.target,d);c=c||this.getScenePoint(e),p&&p.call(d,e,n,c.x,c.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),h?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:s=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let i=0;i<s.length;i++)s[i]!==n&&s[i].fire(e,t);return t}_handleEvent(e,t){const n=this._target,s=this.targets||[],i=L(L({e,target:n,subTargets:s},to(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),i),n&&n.fire("mouse".concat(t),i);for(let a=0;a<s.length;a++)s[a]!==n&&s[a].fire("mouse".concat(t),i)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:n}=e;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),i=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,i=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(t){const a=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const c=t.findControl(this.getViewportPoint(e),Bl(e));if(t===this._activeObject&&(c||!i)){this._setupCurrentTransform(e,t,a);const u=c?c.control:void 0,h=this.getScenePoint(e),d=u&&u.getMouseDownHandler(e,t,u);d&&d.call(u,e,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ns(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("mouse",{e,target:i[c],oldTarget:s[c]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",L(L({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("drag",L(L({},t),{},{target:i[c],oldTarget:s[c]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:s,fireCanvas:i,e:a}=t,c=yt(t,FL);const{targetIn:u,targetOut:h,canvasIn:d,canvasOut:p}=NL[e],g=s!==n;if(s&&g){const v=L(L({},c),{},{e:a,target:s,nextTarget:n},to(this,a));i&&this.fire(p,v),s.fire(h,v)}if(n&&g){const v=L(L({},c),{},{e:a,target:n,previousTarget:s},to(this,a));i&&this.fire(d,v),n.fire(u,v)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,s=n.target,i=s.group?ns(t,void 0,s.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,i),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:s,actionHandler:i,target:a}=t,c=!!i&&i(e,t,n.x,n.y);c&&a.setCoords(),s==="drag"&&c&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||c}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const s=oi(this._activeObject)?this._activeObject:null,i=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(i){const a=i.control;this.setCursor(a.cursorStyleHandler(e,a,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(a=>{n=a.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,s=oi(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||s)&&(s||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(s){const i=n.getObjects();if(t===n){const a=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(i,a)||this.searchPossibleTargets(this._objects,a))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{n.isEditing&&n.exitEditing();const i=new(le.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(n,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new $(t,n),c=a.add(new $(s,i)),u=a.min(c),h=a.max(c).subtract(u),d=this.collectObjects({left:u.x,top:u.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),p=a.eq(c)?d[0]?[d[0]]:[]:d.length>1?d.filter(g=>!g.onSelect({e})).reverse():d;if(p.length===1)this.setActiveObject(p[0],e);else if(p.length>1){const g=le.getClass("ActiveSelection");this.setActiveObject(new g(p,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Z_={x1:0,y1:0,x2:0,y2:0},BL=L(L({},Z_),{},{r1:0,r2:0}),io=(r,e)=>isNaN(r)&&typeof e=="number"?e:r,VL=/^(\d+\.\d+)%|(\d+)%$/;function J_(r){return r&&VL.test(r)}function Q_(r,e){const t=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(J_(r)?100:1):NaN;return vi(0,io(t,e),1)}const HL=/\s*;\s*/,zL=/\s*:\s*/;function WL(r,e){let t,n;const s=r.getAttribute("style");if(s){const a=s.split(HL);a[a.length-1]===""&&a.pop();for(let c=a.length;c--;){const[u,h]=a[c].split(zL).map(d=>d.trim());u==="stop-color"?t=h:u==="stop-opacity"&&(n=h)}}const i=new lt(t||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:Q_(r.getAttribute("offset"),0),color:i.toRgb(),opacity:io(parseFloat(n||r.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function UL(r,e){const t=[],n=r.getElementsByTagName("stop"),s=Q_(e,1);for(let i=n.length;i--;)t.push(WL(n[i],s));return t}function ex(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function tx(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function mn(r,e){return r.getAttribute(e)}function $L(r,e){return function(t,n){let s,{width:i,height:a,gradientUnits:c}=n;return Object.keys(t).reduce((u,h)=>{const d=t[h];return d==="Infinity"?s=1:d==="-Infinity"?s=0:(s=typeof d=="string"?parseFloat(d):d,typeof d=="string"&&J_(d)&&(s*=.01,c==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(s*=i),h!=="y1"&&h!=="y2"||(s*=a)))),u[h]=s,u},{})}(ex(r)==="linear"?function(t){return{x1:mn(t,"x1")||0,y1:mn(t,"y1")||0,x2:mn(t,"x2")||"100%",y2:mn(t,"y2")||0}}(r):function(t){return{x1:mn(t,"fx")||mn(t,"cx")||"50%",y1:mn(t,"fy")||mn(t,"cy")||"50%",r1:0,x2:mn(t,"cx")||"50%",y2:mn(t,"cy")||"50%",r2:mn(t,"r")||"50%"}}(r),L(L({},e),{},{gradientUnits:tx(r)}))}class Jc{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:s={},colorStops:i=[],offsetX:a=0,offsetY:c=0,gradientTransform:u,id:h}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:L(L({},t==="radial"?BL:Z_),s),colorStops:i,offsetX:a,offsetY:c,gradientTransform:u,id:h?"".concat(h,"_").concat(Ps()):Ps()})}addColorStop(e){for(const t in e){const n=new lt(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return L(L({},Ai(this,e)),{},{type:this.type,coords:L({},this.coords),colorStops:this.colorStops.map(t=>L({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():xr.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",a=this.colorStops.map(p=>L({},p)).sort((p,g)=>p.offset-g.offset);let c=-this.offsetX,u=-this.offsetY;var h;i==="objectBoundingBox"?(c/=e.width,u/=e.height):(c+=e.width/2,u+=e.height/2),(h=e)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(c-=e.pathOffset.x,u-=e.pathOffset.y),s[4]-=c,s[5]-=u;const d=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(Pa(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:p,y1:g,x2:v,y2:b}=this.coords;n.push("<linearGradient ",d,' x1="',p,'" y1="',g,'" x2="',v,'" y2="',b,`">
`)}else if(this.type==="radial"){const{x1:p,y1:g,x2:v,y2:b,r1:x,r2:C}=this.coords,T=x>C;n.push("<radialGradient ",d,' cx="',T?p:v,'" cy="',T?g:b,'" r="',T?x:C,'" fx="',T?v:p,'" fy="',T?b:g,`">
`),T&&(a.reverse(),a.forEach(A=>{A.offset=1-A.offset}));const k=Math.min(x,C);if(k>0){const A=k/Math.max(x,C);a.forEach(I=>{I.offset+=A*(1-I.offset)})}}return a.forEach(p=>{let{color:g,offset:v,opacity:b}=p;n.push("<stop ",'offset="',100*v+"%",'" style="stop-color:',g,b!==void 0?";stop-opacity: "+b:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:s,y2:i,r1:a,r2:c}=this.coords,u=this.type==="linear"?e.createLinearGradient(t,n,s,i):e.createRadialGradient(t,n,a,s,i,c);return this.colorStops.forEach(h=>{let{color:d,opacity:p,offset:g}=h;u.addColorStop(g,p!==void 0?new lt(d).setAlpha(p).toRgba():d)}),u}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(L(L({},e),{},{colorStops:t?t.map(s=>L({},s)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const s=tx(e),i=t._findCenterFromElement();return new this(L({id:e.getAttribute("id")||void 0,type:ex(e),coords:$L(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:UL(e,n.opacity),gradientUnits:s,gradientTransform:bf(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-i.x,offsetY:t.height/2-i.y}:{offsetX:0,offsetY:0}))}}N(Jc,"type","Gradient"),le.setClass(Jc,"gradient"),le.setClass(Jc,"linear"),le.setClass(Jc,"radial");const YL=["type","source","patternTransform"];class vd{get type(){return"pattern"}set type(e){Is("warn","Setting type has no effect",e)}constructor(e){N(this,"repeat","repeat"),N(this,"offsetX",0),N(this,"offsetY",0),N(this,"crossOrigin",""),this.id=Ps(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return L(L({},Ai(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:vt(this.offsetX,et.NUM_FRACTION_DIGITS),offsetY:vt(this.offsetY,et.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:s,repeat:i,id:a}=this,c=io(this.offsetX/t,0),u=io(this.offsetY/n,0),h=i==="repeat-y"||i==="no-repeat"?1+Math.abs(c||0):io(s.width/t,0),d=i==="repeat-x"||i==="no-repeat"?1+Math.abs(u||0):io(s.height/n,0);return['<pattern id="SVGID_'.concat(a,'" x="').concat(c,'" y="').concat(u,'" width="').concat(h,'" height="').concat(d,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:s,patternTransform:i}=e,a=yt(e,YL);const c=await _a(s,L(L({},t),{},{crossOrigin:a.crossOrigin}));return new this(L(L({},a),{},{patternTransform:i&&i.slice(0),source:c}))}}N(vd,"type","Pattern"),le.setClass(vd),le.setClass(vd,"pattern");const XL=["path","left","top"],GL=["d"];class ai extends ht{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:i}=t,a=yt(t,XL);super(),Object.assign(this,ai.ownDefaults),this.setOptions(a),this._setPath(e||[],!0),typeof s=="number"&&this.set(at,s),typeof i=="number"&&this.set(Pr,i)}_setPath(e,t){this.path=z_(Array.isArray(e)?e:G_(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new $(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+n);break;case"M":e.moveTo(s[1]+t,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n,s[5]+t,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=q_(this.path,et.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=et.NUM_FRACTION_DIGITS;return" translate(".concat(vt(-this.pathOffset.x,e),", ").concat(vt(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:s}=this._calcDimensions();this.set({width:t,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,Be,Be)}_calcBoundsFromPath(){const e=[];let t=0,n=0,s=0,i=0;for(const a of this.path)switch(a[0]){case"L":s=a[1],i=a[2],e.push({x:t,y:n},{x:s,y:i});break;case"M":s=a[1],i=a[2],t=s,n=i;break;case"C":e.push(...xf(s,i,a[1],a[2],a[3],a[4],a[5],a[6])),s=a[5],i=a[6];break;case"Q":e.push(...xf(s,i,a[1],a[2],a[1],a[2],a[3],a[4])),s=a[3],i=a[4];break;case"Z":s=t,i=n}return Fn(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return L(L({},e),{},{pathOffset:new $(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const s=us(e,this.ATTRIBUTE_NAMES,n),{d:i}=s;return new this(i,L(L(L({},yt(s,GL)),t),{},{left:void 0,top:void 0}))}}N(ai,"type","Path"),N(ai,"cacheProperties",[...ls,"path","fillRule"]),N(ai,"ATTRIBUTE_NAMES",[...Ws,"d"]),le.setClass(ai),le.setSVGClass(ai);const qL=["left","top","radius"],rx=["radius","startAngle","endAngle","counterClockwise"];class Qn extends ht{static getDefaults(){return L(L({},super.getDefaults()),Qn.ownDefaults)}constructor(e){super(),Object.assign(this,Qn.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,It(this.startAngle),It(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Sr)}getRadiusY(){return this.get("radius")*this.get($r)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...rx,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=It(this.startAngle),s=It(this.endAngle),i=xn(n)*t,a=Sn(n)*t,c=xn(s)*t,u=Sn(s)*t,h=e>180?1:0,d=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(a," A ").concat(t," ").concat(t," 0 ").concat(h," ").concat(d," ").concat(c," ").concat(u,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const s=us(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,radius:c=0}=s;return new this(L(L({},yt(s,qL)),{},{radius:c,left:i-c,top:a-c}))}static fromObject(e){return super._fromObject(e)}}N(Qn,"type","Circle"),N(Qn,"cacheProperties",[...ls,...rx]),N(Qn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),N(Qn,"ATTRIBUTE_NAMES",["cx","cy","r",...Ws]),le.setClass(Qn),le.setSVGClass(Qn);const KL=["x1","y1","x2","y2"],ZL=["x1","y1","x2","y2"],Cf=["x1","x2","y1","y2"];class ci extends ht{constructor(){let[e,t,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,ci.ownDefaults),this.setOptions(i),this.x1=e,this.x2=n,this.y1=t,this.y2=s,this._setWidthHeight();const{left:a,top:c}=i;typeof a=="number"&&this.set(at,a),typeof c=="number"&&this.set(Pr,c)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-t);const{left:i,top:a,width:c,height:u}=Fn([{x:e,y:t},{x:n,y:s}]),h=new $(i+c/2,a+u/2);this.setPositionByOrigin(h,Be,Be)}_set(e,t){return super._set(e,t),Cf.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;on(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new $((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:s,width:i,height:a}=this,c=e<=t?-1:1,u=n<=s?-1:1;return{x1:c*i/2,x2:c*-i/2,y1:u*a/2,y2:u*-a/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,n){const s=us(e,this.ATTRIBUTE_NAMES,n),{x1:i=0,y1:a=0,x2:c=0,y2:u=0}=s;return new this([i,a,c,u],yt(s,KL))}static fromObject(e){let{x1:t,y1:n,x2:s,y2:i}=e,a=yt(e,ZL);return this._fromObject(L(L({},a),{},{points:[t,n,s,i]}),{extraParam:"points"})}}N(ci,"type","Line"),N(ci,"cacheProperties",[...ls,...Cf]),N(ci,"ATTRIBUTE_NAMES",Ws.concat(Cf)),le.setClass(ci),le.setSVGClass(ci);class di extends ht{static getDefaults(){return L(L({},super.getDefaults()),di.ownDefaults)}constructor(e){super(),Object.assign(this,di.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}N(di,"type","Triangle"),N(di,"ownDefaults",{width:100,height:100}),le.setClass(di),le.setSVGClass(di);const nx=["rx","ry"];class es extends ht{static getDefaults(){return L(L({},super.getDefaults()),es.ownDefaults)}constructor(e){super(),Object.assign(this,es.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Sr)}getRy(){return this.get("ry")*this.get($r)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...nx,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,as,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const s=us(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function JL(r){if(!r)return[];const e=r.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}N(es,"type","Ellipse"),N(es,"cacheProperties",[...ls,...nx]),N(es,"ownDefaults",{rx:0,ry:0}),N(es,"ATTRIBUTE_NAMES",[...Ws,"cx","cy","rx","ry"]),le.setClass(es),le.setSVGClass(es);const QL=["left","top"],sx={exactBoundingBox:!1};class vn extends ht{static getDefaults(){return L(L({},super.getDefaults()),vn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),N(this,"strokeDiff",void 0),Object.assign(this,vn.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(at,n),typeof s=="number"&&this.set(Pr,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return D_(this.points,e,this.isOpen())}_calcDimensions(e){e=L({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(h=>h.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new $,strokeOffset:new $,strokeDiff:new $};const n=Fn(t),s=Za(L(L({},e),{},{scaleX:1,scaleY:1})),i=Fn(this.points.map(h=>ur(h,s,!0))),a=new $(this.scaleX,this.scaleY);let c=n.left+n.width/2,u=n.top+n.height/2;return this.exactBoundingBox&&(c-=u*Math.tan(It(this.skewX)),u-=c*Math.tan(It(this.skewY))),L(L({},n),{},{pathOffset:new $(c,u),strokeOffset:new $(i.left,i.top).subtract(new $(n.left,n.top)).multiply(a),strokeDiff:new $(n.width,n.height).subtract(new $(i.width,i.height)).multiply(a)})}_findCenterFromElement(){const e=Fn(this.points);return new $(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:s,height:i,pathOffset:a,strokeOffset:c,strokeDiff:u}=this._calcDimensions();this.set({width:s,height:i,pathOffset:a,strokeOffset:c,strokeDiff:u}),e&&this.setPositionByOrigin(new $(t+s/2,n+i/2),Be,Be)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new $(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let a;if(Object.keys(e).some(c=>this.strokeUniform||this.constructor.layoutProperties.includes(c))){var t,n;const{width:c,height:u}=this._calcDimensions(e);a=new $((t=e.width)!==null&&t!==void 0?t:c,(n=e.height)!==null&&n!==void 0?n:u)}else{var s,i;a=new $((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return a.multiply(new $(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&n&&((e===Sr||e===$r)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:n,y:s}=t;return{x:n,y:s}})})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,s=et.NUM_FRACTION_DIGITS;for(let i=0,a=this.points.length;i<a;i++)e.push(vt(this.points[i].x-t,s),",",vt(this.points[i].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let i=0;i<t;i++){const a=this.points[i];e.lineTo(a.x-n,a.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(JL(e.getAttribute("points")),L(L({},yt(us(e,this.ATTRIBUTE_NAMES,n),QL)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}N(vn,"ownDefaults",sx),N(vn,"type","Polyline"),N(vn,"layoutProperties",[Po,Do,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),N(vn,"cacheProperties",[...ls,"points"]),N(vn,"ATTRIBUTE_NAMES",[...Ws]),le.setClass(vn),le.setSVGClass(vn);class Qc extends vn{isOpen(){return!1}}N(Qc,"ownDefaults",sx),N(Qc,"type","Polygon"),le.setClass(Qc),le.setSVGClass(Qc);const ix=["fontSize","fontWeight","fontFamily","fontStyle"],ox=["underline","overline","linethrough"],ax=[...ix,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],cx=[...ax,...ox,"textBackgroundColor","direction"],e6=[...ix,...ox,Rr,"strokeWidth",Xt,"deltaY","textBackgroundColor"],t6={_reNewline:Pp,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:at,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:at,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Pn="justify",Gl="justify-left",xa="justify-right",Sa="justify-center";class lx extends ht{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const s in t[n])for(const i in t[n][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const s in n)for(const i in n[s])if(n[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,s,i=0,a=!0,c=0;for(const u in t){n=0;for(const h in t[u]){const d=t[u][h]||{};i++,d[e]!==void 0?(s?d[e]!==s&&(a=!1):s=d[e],d[e]===this[e]&&delete d[e]):a=!1,Object.keys(d).length!==0?n++:delete t[u][h]}n===0&&delete t[u]}for(let u=0;u<this._textLines.length;u++)c+=this._textLines[u].length;a&&i===c&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,s,i;for(s in t){for(i in n=t[s],n)delete n[i][e],Object.keys(n[i]).length===0&&delete n[i];Object.keys(n).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const i=Np(L(L({},this._getStyleDeclaration(n,s)),t),a=>a!==void 0);this._setStyleDeclaration(n,s,i)}getSelectionStyles(e,t,n){const s=[];for(let i=e;i<(t||e);i++)s.push(this.getStyleAtPosition(i,n));return s}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,t,n){for(let s=t;s<(n||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const s=this.styles&&this.styles[e];return s&&(n=s[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return L(L({},Ai(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}N(lx,"_styleProperties",e6);const r6=/  +/g,n6=/"/g;function yd(r,e,t,n,s){return"		".concat(function(i,a){let{left:c,top:u,width:h,height:d}=a,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:et.NUM_FRACTION_DIGITS;const g=Da(Xt,i,!1),[v,b,x,C]=[c,u,h,d].map(T=>vt(T,p));return"<rect ".concat(g,' x="').concat(v,'" y="').concat(b,'" width="').concat(x,'" height="').concat(C,'"></rect>')}(r,{left:e,top:t,width:n,height:s}),`
`)}const s6=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let bd;class br extends lx{static getDefaults(){return L(L({},super.getDefaults()),br.ownDefaults)}constructor(e,t){super(),N(this,"__charBounds",[]),Object.assign(this,br.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Zp(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Pn)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,s,i,a,c;for(let u=0,h=this._textLines.length;u<h;u++)if((this.textAlign===Pn||u!==h-1&&!this.isEndOfWrapping(u))&&(s=0,i=this._textLines[u],t=this.getLineWidth(u),t<this.width&&(c=this.textLines[u].match(this._reSpacesAndTabs)))){n=c.length,e=(this.width-t)/n;for(let d=0;d<=i.length;d++)a=this.__charBounds[u][d],this._reSpaceAndTab.test(i[d])?(a.width+=e,a.kernedWidth+=e,a.left+=s,s+=e):a.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Rr?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Be:e.textBaseline="middle";break;case"ascender":e.textBaseline=Pr;break;case"descender":e.textBaseline=uf}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,n,s,i,a){this._renderChars(e,t,n,s,i,a)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,a=this._textLines.length;i<a;i++){const c=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=c;continue}const u=this._textLines[i].length,h=this._getLineLeftOffset(i);let d,p,g=0,v=0,b=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let x=0;x<u;x++){const C=this.__charBounds[i][x];p=this.getValueOfPropertyAt(i,x,"textBackgroundColor"),this.path?(e.save(),e.translate(C.renderLeft,C.renderTop),e.rotate(C.angle),e.fillStyle=p,p&&e.fillRect(-C.width/2,-c/this.lineHeight*(1-this._fontSizeFraction),C.width,c/this.lineHeight),e.restore()):p!==b?(d=n+h+v,this.direction==="rtl"&&(d=this.width-d-g),e.fillStyle=b,b&&e.fillRect(d,s,g,c/this.lineHeight),v=C.left,g=C.width,b=p):g+=C.kernedWidth}p&&!this.path&&(d=n+h+v,this.direction==="rtl"&&(d=this.width-d-g),e.fillStyle=p,e.fillRect(d,s,g,c/this.lineHeight)),s+=c}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,s){const i=ba.getFontCache(t),a=this._getFontDeclaration(t),c=n+e,u=n&&a===this._getFontDeclaration(s),h=t.fontSize/this.CACHE_FONT_SIZE;let d,p,g,v;if(n&&i[n]!==void 0&&(g=i[n]),i[e]!==void 0&&(v=d=i[e]),u&&i[c]!==void 0&&(p=i[c],v=p-g),d===void 0||g===void 0||p===void 0){const b=function(){return bd||(bd=Cn({width:0,height:0}).getContext("2d")),bd}();this._setTextStyles(b,t,!0),d===void 0&&(v=d=b.measureText(e).width,i[e]=d),g===void 0&&u&&n&&(g=b.measureText(n).width,i[n]=g),u&&p===void 0&&(p=b.measureText(c).width,i[c]=p,v=p-g)}return{width:d*h,kernedWidth:v*h}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,s=0;const i=this.pathSide===jt,a=this.path,c=this._textLines[e],u=c.length,h=new Array(u);this.__charBounds[e]=h;for(let d=0;d<u;d++){const p=c[d];n=this._getGraphemeBox(p,e,d,t),h[d]=n,s+=n.kernedWidth,t=p}if(h[u]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},a&&a.segmentsInfo){let d=0;const p=a.segmentsInfo[a.segmentsInfo.length-1].length;switch(this.textAlign){case at:d=i?p-s:0;break;case Be:d=(p-s)/2;break;case jt:d=i?0:p-s}d+=this.pathStartOffset*(i?-1:1);for(let g=i?u-1:0;i?g>=0:g<u;i?g--:g++)n=h[g],d>p?d%=p:d<0&&(d+=p),this._setGraphemeOnPath(d,n),d+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,s=this.path,i=X_(s.path,n,s.segmentsInfo);t.renderLeft=i.x-s.pathOffset.x,t.renderTop=i.y-s.pathOffset.y,t.angle=i.angle+(this.pathSide===jt?Math.PI:0)}_getGraphemeBox(e,t,n,s,i){const a=this.getCompleteStyleDeclaration(t,n),c=s?this.getCompleteStyleDeclaration(t,n-1):{},u=this._measureChar(e,a,s,c);let h,d=u.kernedWidth,p=u.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),p+=h,d+=h);const g={width:p,left:0,height:a.fontSize,kernedWidth:d,deltaY:a.deltaY};if(n>0&&!i){const v=this.__charBounds[t][n-1];g.left=v.left+v.width+u.kernedWidth-u.width}return g}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,s=this._textLines.length;n<s;n++)e=this.getHeightOfLine(n),t+=n===s-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let a=0,c=this._textLines.length;a<c;a++){const u=this.getHeightOfLine(a),h=u/this.lineHeight,d=this._getLineLeftOffset(a);this._renderTextLine(t,e,this._textLines[a],s+d,i+n+h,a),n+=u}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Xt))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,s,i,a){const c=this.getHeightOfLine(a),u=this.textAlign.includes(Pn),h=this.path,d=!u&&this.charSpacing===0&&this.isEmptyStyles(a)&&!h,p=this.direction==="ltr",g=this.direction==="ltr"?1:-1,v=t.direction;let b,x,C,T,k,A="",I=0;if(t.save(),v!==this.direction&&(t.canvas.setAttribute("dir",p?"ltr":"rtl"),t.direction=p?"ltr":"rtl",t.textAlign=p?at:jt),i-=c*this._fontSizeFraction/this.lineHeight,d)return this._renderChar(e,t,a,0,n.join(""),s,i),void t.restore();for(let D=0,F=n.length-1;D<=F;D++)T=D===F||this.charSpacing||h,A+=n[D],C=this.__charBounds[a][D],I===0?(s+=g*(C.kernedWidth-C.width),I+=C.width):I+=C.kernedWidth,u&&!T&&this._reSpaceAndTab.test(n[D])&&(T=!0),T||(b=b||this.getCompleteStyleDeclaration(a,D),x=this.getCompleteStyleDeclaration(a,D+1),T=Mu(b,x,!1)),T&&(h?(t.save(),t.translate(C.renderLeft,C.renderTop),t.rotate(C.angle),this._renderChar(e,t,a,D,A,-I/2,0),t.restore()):(k=s,this._renderChar(e,t,a,D,A,k,i)),A="",b=x,s+=g*I,I=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=Cn({width:t,height:n}),i=s.getContext("2d");return s.width=t,s.height=n,i.beginPath(),i.moveTo(0,0),i.lineTo(t,0),i.lineTo(t,n),i.lineTo(0,n),i.closePath(),i.translate(t/2,n/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,t,n){let s,i;return on(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[t]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:i}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,s,i,a,c){const u=this._getStyleDeclaration(n,s),h=this.getCompleteStyleDeclaration(n,s),d=e==="fillText"&&h.fill,p=e==="strokeText"&&h.stroke&&h.strokeWidth;if(p||d){if(t.save(),t.font=this._getFontDeclaration(h),u.textBackgroundColor&&this._removeShadow(t),u.deltaY&&(c+=u.deltaY),d){const g=this._setFillStyles(t,h);t.fillText(i,a-g.offsetX,c-g.offsetY)}if(p){const g=this._setStrokeStyles(t,h);t.strokeText(i,a-g.offsetX,c-g.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),a=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),c={fontSize:i*n.size,deltaY:a+i*n.baseline};this.setSelectionStyles(c,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,s=this.textAlign,i=this.direction,a=this.isEndOfWrapping(e);let c=0;return s===Pn||s===Sa&&!a||s===xa&&!a||s===Gl&&!a?0:(s===Be&&(c=n/2),s===jt&&(c=n),s===Sa&&(c=n/2),s===xa&&(c=n),i==="rtl"&&(s===jt||s===Pn||s===xa?c=0:s===at||s===Gl?c=-n:s!==Be&&s!==Sa||(c=-n/2)),c)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var s;return(s=this._getStyleDeclaration(e,t)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,a=this._getWidthOfCharSpacing(),c=this.offsets[t];for(let u=0,h=this._textLines.length;u<h;u++){const d=this.getHeightOfLine(u);if(!this[t]&&!this.styleHas(t,u)){n+=d;continue}const p=this._textLines[u],g=d/this.lineHeight,v=this._getLineLeftOffset(u);let b,x,C=0,T=0,k=this.getValueOfPropertyAt(u,0,t),A=this.getValueOfPropertyAt(u,0,Xt);const I=n+g*(1-this._fontSizeFraction);let D=this.getHeightOfChar(u,0),F=this.getValueOfPropertyAt(u,0,"deltaY");for(let B=0,X=p.length;B<X;B++){const Y=this.__charBounds[u][B];b=this.getValueOfPropertyAt(u,B,t),x=this.getValueOfPropertyAt(u,B,Xt);const Z=this.getHeightOfChar(u,B),G=this.getValueOfPropertyAt(u,B,"deltaY");if(i&&b&&x)e.save(),e.fillStyle=A,e.translate(Y.renderLeft,Y.renderTop),e.rotate(Y.angle),e.fillRect(-Y.kernedWidth/2,c*Z+G,Y.kernedWidth,this.fontSize/15),e.restore();else if((b!==k||x!==A||Z!==D||G!==F)&&T>0){let K=s+v+C;this.direction==="rtl"&&(K=this.width-K-T),k&&A&&(e.fillStyle=A,e.fillRect(K,I+c*D+F,T,this.fontSize/15)),C=Y.left,T=Y.width,k=b,A=x,D=Z,F=G}else T+=Y.kernedWidth}let U=s+v+C;this.direction==="rtl"&&(U=this.width-U-T),e.fillStyle=x,b&&x&&e.fillRect(U,I+c*D+F,T-a,this.fontSize/15),n+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const a=e.includes("'")||e.includes('"')||e.includes(",")||br.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),a].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return Iu(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),s=[`
`];let i=[];for(let a=0;a<t.length;a++)n[a]=this.graphemeSplit(t[a]),i=i.concat(n[a],s);return i.pop(),{_unwrappedLines:n,lines:t,graphemeText:i,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject([...cx,...e])),{},{styles:j_(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let s=!1,i=!1;if(typeof e=="object")for(const a in e)a==="path"&&this.setPathInfo(),s=s||n.includes(a),i=i||a==="path";else s=n.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const s=us(e,br.ATTRIBUTE_NAMES,n),i=L(L({},t),s),{textAnchor:a=at,textDecoration:c="",dx:u=0,dy:h=0,top:d=0,left:p=0,fontSize:g=Mp,strokeWidth:v=1}=i,b=yt(i,s6),x=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),L({left:p+u,top:d+h,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:g},b)),C=x.getScaledHeight()/x.height,T=((x.height+x.strokeWidth)*x.lineHeight-x.height)*C,k=x.getScaledHeight()+T;let A=0;return a===Be&&(A=x.getScaledWidth()/2),a===jt&&(A=x.getScaledWidth()),x.set({left:x.left-A,top:x.top-(k-x.fontSize*(.07+x._fontSizeFraction))/x.lineHeight,strokeWidth:v}),x}static fromObject(e){return this._fromObject(L(L({},e),{},{styles:L_(e.styles||{},e.text)}),{extraParam:"text"})}}N(br,"textLayoutProperties",ax),N(br,"cacheProperties",[...ls,...cx]),N(br,"ownDefaults",t6),N(br,"type","Text"),N(br,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),N(br,"ATTRIBUTE_NAMES",Ws.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),I_(br,[class extends u_{_toSVG(){const r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:t}=r;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(n6,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(r,e){const t=[],n=[];let s,i=r;this.backgroundColor&&n.push(...yd(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let a=0,c=this._textLines.length;a<c;a++)s=this._getLineLeftOffset(a),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(n,a,e+s,i),this._setSVGTextLineText(t,a,e+s,i),i+=this.getHeightOfLine(a);return{textSpans:t,textBgRects:n}}_createTextCharSpan(r,e,t,n){const s=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(r6)),i=s?'style="'.concat(s,'"'):"",a=e.deltaY,c=a?' dy="'.concat(vt(a,et.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(vt(t,et.NUM_FRACTION_DIGITS),'" y="').concat(vt(n,et.NUM_FRACTION_DIGITS),'" ').concat(c).concat(i,">").concat(R_(r),"</tspan>")}_setSVGTextLineText(r,e,t,n){const s=this.getHeightOfLine(e),i=this.textAlign.includes(Pn),a=this._textLines[e];let c,u,h,d,p,g="",v=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let b=0,x=a.length-1;b<=x;b++)p=b===x||this.charSpacing,g+=a[b],h=this.__charBounds[e][b],v===0?(t+=h.kernedWidth-h.width,v+=h.width):v+=h.kernedWidth,i&&!p&&this._reSpaceAndTab.test(a[b])&&(p=!0),p||(c=c||this.getCompleteStyleDeclaration(e,b),u=this.getCompleteStyleDeclaration(e,b+1),p=Mu(c,u,!0)),p&&(d=this._getStyleDeclaration(e,b),r.push(this._createTextCharSpan(g,d,t,n)),g="",c=u,this.direction==="rtl"?t-=v:t+=v,v=0)}_setSVGTextLineBg(r,e,t,n){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let a,c=0,u=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let d=0;d<s.length;d++){const{left:p,width:g,kernedWidth:v}=this.__charBounds[e][d];a=this.getValueOfPropertyAt(e,d,"textBackgroundColor"),a!==h?(h&&r.push(...yd(h,t+u,n,c,i)),u=p,c=g,h=a):c+=v}a&&r.push(...yd(h,t+u,n,c,i))}_getSVGLineTopOffset(r){let e,t=0;for(e=0;e<r;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," white-space: pre;")}getSvgSpanStyles(r,e){const{fontFamily:t,strokeWidth:n,stroke:s,fill:i,fontSize:a,fontStyle:c,fontWeight:u,deltaY:h}=r,d=this.getSvgTextDecoration(r);return[s?Da(Rr,s):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",a?"font-size: ".concat(a,"px; "):"",c?"font-style: ".concat(c,"; "):"",u?"font-weight: ".concat(u,"; "):"",d&&"text-decoration: ".concat(d,"; "),i?Da(Xt,i):"",h?"baseline-shift: ".concat(-h,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(e=>r[e.replace("-","")]).join(" ")}}]),le.setClass(br),le.setSVGClass(br);class i6{constructor(e){N(this,"target",void 0),N(this,"__mouseDownInPlace",!1),N(this,"__dragStartFired",!1),N(this,"__isDraggingOver",!1),N(this,"__dragStartSelection",void 0),N(this,"__dragImageDisposer",void 0),N(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:s,selectionEnd:i}=t;const a=this.target,c=a.canvas,u=new $(a.flipX?-1:1,a.flipY?-1:1),h=a._getCursorBoundaries(s),d=new $(h.left+h.leftOffset,h.top+h.topOffset).multiply(u).transform(a.calcTransformMatrix()),p=c.getScenePoint(e).subtract(d),g=a.getCanvasRetinaScaling(),v=a.getBoundingRect(),b=d.subtract(new $(v.left,v.top)),x=c.viewportTransform,C=b.add(p).transform(x,!0),T=a.backgroundColor,k=Gp(a.styles);a.backgroundColor="";const A={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};a.setSelectionStyles(A,0,s),a.setSelectionStyles(A,i,a.text.length),a.dirty=!0;const I=a.toCanvasElement({enableRetinaScaling:c.enableRetinaScaling,viewportTransform:!0});a.backgroundColor=T,a.styles=k,a.dirty=!0,Xl(I,{position:"fixed",left:"".concat(-I.width,"px"),border:Dr,width:"".concat(I.width/g,"px"),height:"".concat(I.height/g,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{I.remove()},yn(e.target||this.target.hiddenTextarea).body.appendChild(I),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(I,C.x,C.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(s.selectionStart,s.selectionEnd).join(""),a=L({text:t.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,a)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let i=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(i&&!s){const a=this.target,c=a.canvas;let u=a.getSelectionStartFromPointer(n);const{styles:h}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},d=i[Math.max(0,i.length-1)],p=0;if(this.__dragStartSelection){const g=this.__dragStartSelection.selectionStart,v=this.__dragStartSelection.selectionEnd;u>g&&u<=v?u=g:u>v&&(u-=v-g),a.removeChars(g,v),delete this.__dragStartSelection}a._reNewline.test(d)&&(a._reNewline.test(a._text[u])||u===a._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=a,a.insertChars(i,h,u),c.setActiveObject(a),a.enterEditing(n),a.selectionStart=Math.min(u+p,a._text.length),a.selectionEnd=Math.min(a.selectionStart+i.length,a._text.length),a.hiddenTextarea.value=a.text,a._updateTextarea(),a.hiddenTextarea.focus(),a.fire(Ll,{index:u+p,action:"drop"}),c.fire("text:changed",{target:a}),c.contextTopDirty=!0,c.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,i=this.target.canvas,{selectionStart:a,selectionEnd:c}=this.__dragStartSelection,u=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||Dr;u===Dr?(s.selectionStart=a,s.selectionEnd=c,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),u==="move"&&(s.removeChars(a,c),s.selectionStart=s.selectionEnd=a,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Ll,{index:a,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const fy=/[ \n\.,;!\?\-]/;class o6 extends br{constructor(){super(...arguments),N(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:s,onComplete:i}=e;return $p({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:a=>{this._currentCursorOpacity=a,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(t===-1||!Pp.test(n[e-1]))?e-1:e,i=n[s];for(;s>0&&s<n.length&&!fy.test(i);)s+=t,i=n[s];return t===-1&&fy.test(i)&&s++,s}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;yn(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==i||s!==n&&i!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const s=n.slice(0,e),i=this.graphemeSplit(s).length;if(e===t)return{selectionStart:i,selectionEnd:i};const a=n.slice(e,t);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(a).length}}fromGraphemeToStringSelection(e,t,n){const s=n.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex,a=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,c=t.leftOffset,u=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,p=h.height/u,g=d-a,v=p-a,b=new $(t.left+c,t.top+t.topOffset+a).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new $(h.clientWidth/d,h.clientHeight/p));return b.x<0&&(b.x=0),b.x>g&&(b.x=g),b.y<0&&(b.y=0),b.y>v&&(b.y=v),b.x+=this.canvas._offset.left,b.y+=this.canvas._offset.top,{left:"".concat(b.x,"px"),top:"".concat(b.y,"px"),fontSize:"".concat(a,"px"),charHeight:a}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Fl),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:a}=this.get2DCursorLocation(t,!0);if(n!==i){if(this.styles[n])for(let c=s;c<this._unwrappedTextLines[n].length;c++)delete this.styles[n][c];if(this.styles[i])for(let c=a;c<this._unwrappedTextLines[i].length;c++){const u=this.styles[i][c];u&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+c-a]=u)}for(let c=n+1;c<=i;c++)delete this.styles[c];this.shiftLineStyles(i,n-i)}else if(this.styles[n]){const c=this.styles[n],u=a-s;for(let h=s;h<a;h++)delete c[h];for(const h in this.styles[n]){const d=parseInt(h,10);d>=a&&(c[d-u]=c[h],delete c[h])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+t]=n[i],n[i-t]||delete this.styles[i])}}insertNewlineStyleObject(e,t,n,s){const i={},a=this._unwrappedTextLines[e].length,c=a===t;let u=!1;n||(n=1),this.shiftLineStyles(e,n);const h=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const p in this.styles[e]){const g=parseInt(p,10);g>=t&&(u=!0,i[g-t]=this.styles[e][p],c&&t===0||delete this.styles[e][p])}let d=!1;for(u&&!c&&(this.styles[e+n]=i,d=!0),(d||a>t)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:L({},s[n-1])}:h?this.styles[e+n]={0:L({},h)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,s){this.styles||(this.styles={});const i=this.styles[e],a=i?L({},i):{};n||(n=1);for(const u in a){const h=parseInt(u,10);h>=t&&(i[h+n]=a[h],a[h-n]||delete i[h])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=L({},s[n]));return}if(!i)return;const c=i[t?t-1:1];for(;c&&n--;)this.styles[e][t+n]=L({},c)}insertNewStyleBlock(e,t,n){const s=this.get2DCursorLocation(t,!0),i=[0];let a,c=0;for(let u=0;u<e.length;u++)e[u]===`
`?(c++,i[c]=0):i[c]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),c&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],c),a=1;a<c;a++)i[a]>0?this.insertCharStyleObject(s.lineIndex+a,0,i[a],n):n&&this.styles[s.lineIndex+a]&&n[0]&&(this.styles[s.lineIndex+a][0]=n[0]),n=n&&n.slice(i[a]+1);i[a]>0&&this.insertCharStyleObject(s.lineIndex+a,0,i[a],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,n,t),this._text=[...this._text.slice(0,n),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=at:this._selectionDirection===jt&&(this._selectionDirection=at,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===jt?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=jt:this._selectionDirection===at&&(this._selectionDirection=jt,this.selectionStart=t),this.selectionEnd=n)}}class a6 extends o6{initHiddenTextarea(){const e=this.canvas&&yn(this.canvas.getElement())||Mo(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(a=>{let[c,u]=a;return t.setAttribute(c,u)});const{top:n,left:s,fontSize:i}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(a=>{let[c,u]=a;return t.addEventListener(c,this[u].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const n=()=>{this.updateFromTextArea(),this.fire(Ll),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void n();const s=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,i=this._text.length,a=s.length,c=this.selectionStart,u=this.selectionEnd,h=c!==u;let d,p,g,v,b=a-i;const x=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),C=c>x.selectionStart;h?(p=this._text.slice(c,u),b+=u-c):a<i&&(p=C?this._text.slice(u+b,u):this._text.slice(c,c-b));const T=s.slice(x.selectionEnd-b,x.selectionEnd);if(p&&p.length&&(T.length&&(d=this.getSelectionStyles(c,c+1,!1),d=T.map(()=>d[0])),h?(g=c,v=u):C?(g=u-p.length,v=u):(g=u,v=u+p.length),this.removeStyleFromTo(g,v)),T.length){const{copyPasteData:k}=Nn();t&&T.join("")===k.copiedText&&!et.disableStyleCopyPaste&&(d=k.copiedTextStyle),this.insertNewStyleBlock(T,c,d)}n()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:s}=t;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Nn();e.copiedText=this.getSelectedText(),et.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,s=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],s+=n.left+n.width),s}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const a=s.charIndex,c=this._getWidthBeforeCursor(i,a),u=this._getIndexOnLine(i+1,c);return this._textLines[i].slice(a).length+u+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-n;const a=s.charIndex,c=this._getWidthBeforeCursor(i,a),u=this._getIndexOnLine(i-1,c),h=this._textLines[i].slice(0,a),d=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+u-h.length+(1-d)}_getIndexOnLine(e,t){const n=this._textLines[e];let s,i,a=this._getLineLeftOffset(e),c=0;for(let u=0,h=n.length;u<h;u++)if(s=this.__charBounds[e][u].width,a+=s,a>t){i=!0;const d=a-s,p=a,g=Math.abs(d-t);c=Math.abs(p-t)<g?u:u-1;break}return i||(c=n.length-1),c}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===jt);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=vi(0,this.selectionStart,s),this.selectionEnd=vi(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===at?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=at,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===jt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=at,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===at&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=jt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=jt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const wd=r=>!!r.button;class c6 extends a6{constructor(){super(...arguments),N(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new i6(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),df(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!wd(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!wd(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:n}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||wd(t)||s||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Ur(this.calcTransformMatrix())).add(new $(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,i=0;for(let h=0;h<this._textLines.length&&n<=t.y;h++)n+=this.getHeightOfLine(h),i=h,h>0&&(s+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let a=Math.abs(this._getLineLeftOffset(i));const c=this._textLines[i].length,u=this.__charBounds[i];for(let h=0;h<c;h++){const d=a+u[h].kernedWidth;if(t.x<=d){Math.abs(t.x-d)<=Math.abs(t.x-a)&&s++;break}a=d,s++}return Math.min(this.flipX?c-s:s,this._text.length)}}const el="moveCursorUp",tl="moveCursorDown",rl="moveCursorLeft",nl="moveCursorRight",sl="exitEditing",l6=L({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:sl,27:sl,33:el,34:tl,35:nl,36:rl,37:rl,38:el,39:nl,40:tl},keysMapRtl:{9:sl,27:sl,33:el,34:tl,35:rl,36:nl,37:nl,38:el,39:rl,40:tl},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class rs extends c6{static getDefaults(){return L(L({},super.getDefaults()),rs.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,L(L({},rs.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Sf&&this.canvas.textEditingManager.remove(this),t instanceof Sf&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,t);return{left:n,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let h=0;h<i;h++)t+=this.getHeightOfLine(h);const a=this._getLineLeftOffset(i),c=this.__charBounds[i][s];c&&(n=c.left),this.charSpacing!==0&&s===this._textLines[i].length&&(n-=this._getWidthOfCharSpacing());const u={top:t,left:a+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===jt||this.textAlign===Pn||this.textAlign===xa?u.left*=-1:this.textAlign===at||this.textAlign===Gl?u.left=a-(n>0?n:0):this.textAlign!==Be&&this.textAlign!==Sa||(u.left=a-(n>0?n:0))),u}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,a=this.getValueOfPropertyAt(s,i,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/c,h=this.getValueOfPropertyAt(s,i,"deltaY"),d=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-a*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-u/2,top:d+t.top+h,width:u,height:a}}_renderCursor(e,t,n){const{color:s,opacity:i,left:a,top:c,width:u,height:h}=this.getCursorRenderingData(n,t);e.fillStyle=s,e.globalAlpha=i,e.fillRect(a,c,u,h)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const s=t.selectionStart,i=t.selectionEnd,a=this.textAlign.includes(Pn),c=this.get2DCursorLocation(s),u=this.get2DCursorLocation(i),h=c.lineIndex,d=u.lineIndex,p=c.charIndex<0?0:c.charIndex,g=u.charIndex<0?0:u.charIndex;for(let v=h;v<=d;v++){const b=this._getLineLeftOffset(v)||0;let x=this.getHeightOfLine(v),C=0,T=0,k=0;if(v===h&&(T=this.__charBounds[h][p].left),v>=h&&v<d)k=a&&!this.isEndOfWrapping(v)?this.width:this.getLineWidth(v)||5;else if(v===d)if(g===0)k=this.__charBounds[d][g].left;else{const U=this._getWidthOfCharSpacing();k=this.__charBounds[d][g-1].left+this.__charBounds[d][g-1].width-U}C=x,(this.lineHeight<1||v===d&&this.lineHeight>1)&&(x/=this.lineHeight);let A=n.left+b+T,I=x,D=0;const F=k-T;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",I=1,D=x):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===jt||this.textAlign===Pn||this.textAlign===xa?A=this.width-A-F:this.textAlign===at||this.textAlign===Gl?A=n.left+b-k:this.textAlign!==Be&&this.textAlign!==Sa||(A=n.left+b-k)),e.fillRect(A,n.top+n.topOffset+D,F,I),n.topOffset+=C}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Xt)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}N(rs,"ownDefaults",l6),N(rs,"type","IText"),le.setClass(rs),le.setClass(rs,"i-text");class fi extends rs{static getDefaults(){return L(L({},super.getDefaults()),fi.ownDefaults)}constructor(e,t){super(e,L(L({},fi.ownDefaults),t))}static createControls(){return{controls:A_()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Pn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,s=0;const i={};for(let a=0;a<e.graphemeLines.length;a++)e.graphemeText[s]===`
`&&a>0?(n=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&a>0&&(n++,s++),i[a]={line:t,offset:n},s+=e.graphemeLines[a].length,n+=e.graphemeLines[a].length;return i}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,s=e+1,i=!1;const a=this._styleMap[e],c=this._styleMap[e+1];a&&(e=a.line,n=a.offset),c&&(s=c.line,i=s===e,t=c.offset);const u=e===void 0?this.styles:{line:this.styles[e]};for(const h in u)for(const d in u[h]){const p=parseInt(d,10);if(p>=n&&(!i||p<t))for(const g in u[h][d])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<n.wordsData.length;i++)s.push(...this._wrapLine(i,t,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let s=0;return{wordsData:e.map((i,a)=>{let c=0;const u=t?this.graphemeSplit(i):this.wordSplit(i);return u.length===0?[{word:[],width:0}]:u.map(h=>{const d=t?[h]:this.graphemeSplit(h),p=this._measureWord(d,a,c);return s=Math.max(p,s),c+=d.length+n.length,{word:d,width:p}})}),largestWordWidth:s}}_measureWord(e,t){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let a=0,c=e.length;a<c;a++)i+=this._getGraphemeBox(e[a],t,a+s,n,!0).kernedWidth,n=e[a];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:s,wordsData:i}=n,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,h=[],d=u?"":" ";let p=0,g=[],v=0,b=0,x=!0;t-=a;const C=Math.max(t,s,this.dynamicMinWidth),T=i[e];let k;for(v=0,k=0;k<T.length;k++){const{word:A,width:I}=T[k];v+=A.length,p+=b+I-c,p>C&&!x?(h.push(g),g=[],p=I,x=!0):p+=c,x||u||g.push(d),g=g.concat(A),b=u?0:this._measureWord([d],e,v),v++,x=!1}return k&&h.push(g),s+a>this.dynamicMinWidth&&(this.dynamicMinWidth=s-c+a),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),s=new Array(n.length);for(let i=0;i<n.length;i++)s[i]=n[i].join("");return t.lines=s,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}N(fi,"type","Textbox"),N(fi,"textLayoutProperties",[...rs.textLayoutProperties,"width"]),N(fi,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),le.setClass(fi);class py extends Pu{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:s,group:i}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:a,height:c}=Fn(N_(n,s)),u=new $(a,c);if(s.absolutePositioned)return{center:ns(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:u};{const h=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:d=new $,correction:p=new $}=this.calcBoundingBox(t,e)||{};return{center:d.add(h),correction:p.subtract(h),size:u}}return{center:n.getRelativeCenterPoint().add(h),size:u}}}}N(py,"type","clip-path"),le.setClass(py);class gy extends Pu{getInitialSize(e,t){let{target:n}=e,{size:s}=t;return new $(n.width||s.x,n.height||s.y)}}N(gy,"type","fixed"),le.setClass(gy);class u6 extends ja{subscribeTargets(e){const t=e.target;e.targets.reduce((n,s)=>(s.parent&&n.add(s.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!n.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})})}}class jn extends an{static getDefaults(){return L(L({},super.getDefaults()),jn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,jn.ownDefaults),this.setOptions(t);const{left:n,top:s,layoutManager:i}=t;this.groupInit(e,{left:n,top:s,layoutManager:i??new u6})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(s=>{const i=this._objects.findIndex(c=>c.isInFrontOf(s)),a=i===-1?this.size():i;this.insertAt(a,s)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(Is("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach(s=>{const{parent:i}=s;i&&n.add(i)}),e===Kp?n.forEach(s=>{s._onAfterObjectsChange(Ul,t)}):n.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=L(L({hasControls:!1},n),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,t),e.restore()}}N(jn,"type","ActiveSelection"),N(jn,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),le.setClass(jn),le.setClass(jn,"activeSelection");class h6{constructor(){N(this,"resources",{})}applyFilters(e,t,n,s,i){const a=i.getContext("2d");if(!a)return;a.drawImage(t,0,0,n,s);const c={sourceWidth:n,sourceHeight:s,imageData:a.getImageData(0,0,n,s),originalEl:t,originalImageData:a.getImageData(0,0,n,s),canvasEl:i,ctx:a,filterBackend:this};e.forEach(h=>{h.applyTo(c)});const{imageData:u}=c;return u.width===n&&u.height===s||(i.width=u.width,i.height=u.height),a.putImageData(u,0,0),c}}class ux{constructor(){let{tileSize:e=et.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};N(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),N(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=Cn({width:e,height:t}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,t,n,s,i,a){const c=this.gl,u=i.getContext("2d");if(!c||!u)return;let h;a&&(h=this.getCachedTexture(a,t));const d={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:c,sourceTexture:this.createTexture(c,n,s,h?void 0:t),targetTexture:this.createTexture(c,n,s),originalTexture:h||this.createTexture(c,n,s,h?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},p=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,p),e.forEach(g=>{g&&g.applyTo(d)}),function(g){const v=g.targetCanvas,b=v.width,x=v.height,C=g.destinationWidth,T=g.destinationHeight;b===C&&x===T||(v.width=C,v.height=T)}(d),this.copyGLTo2D(c,d),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(d.sourceTexture),c.deleteTexture(d.targetTexture),c.deleteFramebuffer(p),u.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,s,i){const{NEAREST:a,TEXTURE_2D:c,RGBA:u,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:g,TEXTURE_WRAP_S:v,TEXTURE_WRAP_T:b}=e,x=e.createTexture();return e.bindTexture(c,x),e.texParameteri(c,p,i||a),e.texParameteri(c,g,i||a),e.texParameteri(c,v,d),e.texParameteri(c,b,d),s?e.texImage2D(c,0,u,u,h,s):e.texImage2D(c,0,u,t,n,0,u,h,null),x}getCachedTexture(e,t,n){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,t.width,t.height,t,n);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,s=t.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const a=n.height-s.height;i.drawImage(n,0,a,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),s=t.destinationWidth,i=t.destinationHeight,a=s*i*4;if(!n)return;const c=new Uint8Array(this.imageBuffer,0,a),u=new Uint8ClampedArray(this.imageBuffer,0,a);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,c);const h=new ImageData(u,s,i);n.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),i=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),i&&(t.vendor=i.toLowerCase())}return this.gpuInfo=t,t}}let _d;function d6(){const{WebGLProbe:r}=Nn();return r.queryWebGL(cn()),et.enableGLFiltering&&r.isSupported(et.textureSize)?new ux({tileSize:et.textureSize}):new h6}function xd(){return!_d&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(_d=d6()),_d}const f6=["filters","resizeFilter","src","crossOrigin","type"],hx=["cropX","cropY"];class sn extends ht{static getDefaults(){return L(L({},super.getDefaults()),sn.ownDefaults)}constructor(e,t){super(),N(this,"_lastScaleX",1),N(this,"_lastScaleY",1),N(this,"_filterScalingX",1),N(this,"_filterScalingY",1),this.filters=[],Object.assign(this,sn.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(Ps()),this.setElement(typeof e=="string"?(this.canvas&&yn(this.canvas.getElement())||Mo()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(sn.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=xd(!1);t instanceof ux&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&Nn().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),L(L({},super.toObject([...hx,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,s=-this.height/2;let i=[],a=[],c="",u="";if(!t)return[];if(this.hasCrop()){const h=Ps();i.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(u).concat(c,`></image>
`)),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,a=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=h}return i=this.paintFirst!==Xt?i.concat(a,e):i.concat(e,a),i}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _a(e,{crossOrigin:t,signal:n}).then(s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,i=n.y,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&i>t)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const c=Cn(a),{width:u,height:h}=a;this._element=c,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,xd().applyFilters([e],a,u,h,this._element),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const i=Cn({width:n,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);xd().applyFilters(e,this._originalElement,n,s,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,s=this._filterScalingY,i=this.width,a=this.height,c=Math.max(this.cropX,0),u=Math.max(this.cropY,0),h=t.naturalWidth||t.width,d=t.naturalHeight||t.height,p=c*n,g=u*s,v=Math.min(i*n,h-p),b=Math.min(a*s,d-g),x=-i/2,C=-a/2,T=Math.min(i,h/n-c),k=Math.min(a,d/s-u);t&&e.drawImage(t,p,g,v,b,x,C,T,k)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=Jw(this.preserveAspectRatio||""),t=this.width,n=this.height,s={width:t,height:n};let i,a=this._element.width,c=this._element.height,u=1,h=1,d=0,p=0,g=0,v=0;return!e||e.alignX===Dr&&e.alignY===Dr?(u=t/a,h=n/c):(e.meetOrSlice==="meet"&&(u=h=V_(this._element,s),i=(t-a*u)/2,e.alignX==="Min"&&(d=-i),e.alignX==="Max"&&(d=i),i=(n-c*h)/2,e.alignY==="Min"&&(p=-i),e.alignY==="Max"&&(p=i)),e.meetOrSlice==="slice"&&(u=h=H_(this._element,s),i=a-t/u,e.alignX==="Mid"&&(g=i/2),e.alignX==="Max"&&(g=i),i=c-n/h,e.alignY==="Mid"&&(v=i/2),e.alignY==="Max"&&(v=i),a=t/u,c=n/h)),{width:a,height:c,scaleX:u,scaleY:h,offsetLeft:d,offsetTop:p,cropX:g,cropY:v}}static fromObject(e,t){let{filters:n,resizeFilter:s,src:i,crossOrigin:a,type:c}=e,u=yt(e,f6);return Promise.all([_a(i,L(L({},t),{},{crossOrigin:a})),n&&po(n,t),s&&po([s],t),Ja(u,t)]).then(h=>{let[d,p=[],[g]=[],v={}]=h;return new this(d,L(L({},u),{},{src:i,filters:p,resizeFilter:g},v))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return _a(e,{crossOrigin:t,signal:n}).then(i=>new this(i,s))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=us(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"],t,s).catch(i=>(Is("log","Unable to parse Image",i),null))}}N(sn,"type","Image"),N(sn,"cacheProperties",[...ls,...hx]),N(sn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),N(sn,"CSS_CANVAS","canvas-img"),N(sn,"ATTRIBUTE_NAMES",[...Ws,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),le.setClass(sn),le.setSVGClass(sn);ku(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const dx=Ww,my=r=>function(e,t,n){const{points:s,pathOffset:i}=n;return new $(s[r]).subtract(i).transform(Mt(n.getViewportTransform(),n.calcTransformMatrix()))},fx=(r,e,t,n)=>{const{target:s,pointIndex:i}=e,a=s,c=ns(new $(t,n),void 0,a.calcOwnMatrix());return a.points[i]=c.add(a.pathOffset),a.setDimensions(),!0},px=(r,e)=>function(t,n,s,i){const a=n.target,c=new $(a.points[(r>0?r:a.points.length)-1]),u=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()),h=e(t,L(L({},n),{},{pointIndex:r}),s,i),d=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()).subtract(u);return a.left-=d.x,a.top-=d.y,h},vy=r=>zs(dx,px(r,fx)),Tf=(r,e,t)=>{const{path:n,pathOffset:s}=r,i=n[e];return new $(i[t]-s.x,i[t+1]-s.y).transform(Mt(r.getViewportTransform(),r.calcTransformMatrix()))};function p6(r,e,t){const{commandIndex:n,pointIndex:s}=this;return Tf(t,n,s)}function g6(r,e,t,n){const{target:s}=e,{commandIndex:i,pointIndex:a}=this,c=((u,h,d,p,g)=>{const{path:v,pathOffset:b}=u,x=v[(p>0?p:v.length)-1],C=new $(x[g],x[g+1]),T=C.subtract(b).transform(u.calcOwnMatrix()),k=ns(new $(h,d),void 0,u.calcOwnMatrix());v[p][g]=k.x+b.x,v[p][g+1]=k.y+b.y,u.setDimensions();const A=C.subtract(u.pathOffset).transform(u.calcOwnMatrix()).subtract(T);return u.left-=A.x,u.top-=A.y,u.set("dirty",!0),!0})(s,t,n,i,a);return Vp(this.actionName,L(L({},Hp(r,e,t,n)),{},{commandIndex:i,pointIndex:a})),c}class gx extends Ct{constructor(e){super(e)}render(e,t,n,s,i){const a=L(L({},s),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,a,i)}}class m6 extends gx{constructor(e){super(e)}render(e,t,n,s,i){const{path:a}=i,{commandIndex:c,pointIndex:u,connectToCommandIndex:h,connectToPointIndex:d}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);const[p]=a[c],g=Tf(i,h,d);if(p==="Q"){const v=Tf(i,c,u+2);e.moveTo(v.x,v.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(g.x,g.y),e.stroke(),e.restore(),super.render(e,t,n,s,i)}}const il=(r,e,t,n,s,i)=>new(t?m6:gx)(L(L({commandIndex:r,pointIndex:e,actionName:"modifyPath",positionHandler:p6,actionHandler:g6,connectToCommandIndex:s,connectToPointIndex:i},n),t?n.controlPointStyle:n.pointStyle));var dr=Object.freeze({__proto__:null,changeWidth:mf,createObjectDefaultControls:Xp,createPathControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};let n="M";return r.path.forEach((s,i)=>{const a=s[0];switch(a!=="Z"&&(t["c_".concat(i,"_").concat(a)]=il(i,s.length-2,!1,e)),a){case"C":t["c_".concat(i,"_C_CP_1")]=il(i,1,!0,e,i-1,(c=>c==="C"?5:c==="Q"?3:1)(n)),t["c_".concat(i,"_C_CP_2")]=il(i,3,!0,e,i,5);break;case"Q":t["c_".concat(i,"_Q_CP_1")]=il(i,1,!0,e,i,3)}n=a}),t},createPolyActionHandler:vy,createPolyControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};for(let n=0;n<(typeof r=="number"?r:r.points.length);n++)t["p".concat(n)]=new Ct(L({actionName:dx,positionHandler:my(n),actionHandler:vy(n)},e));return t},createPolyPositionHandler:my,createResizeControls:O_,createTextboxDefaultControls:A_,dragHandler:l_,factoryPolyActionHandler:px,getLocalPoint:Eu,polyActionHandler:fx,renderCircleControl:m_,renderSquareControl:v_,rotationStyleHandler:y_,rotationWithSnapping:b_,scaleCursorStyleHandler:so,scaleOrSkewActionName:ga,scaleSkewCursorStyleHandler:hi,scalingEqually:pa,scalingX:x_,scalingXOrSkewingY:vf,scalingY:S_,scalingYOrSkewingX:yf,skewCursorStyleHandler:C_,skewHandlerX:E_,skewHandlerY:k_,wrapWithFireEvent:zs,wrapWithFixedAnchor:Ii});const Ru=r=>r.webgl!==void 0,Jp="precision highp float",v6=`
    `.concat(Jp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),y6=["type"],b6=["type"],w6=new RegExp(Jp,"g");class Gt{get type(){return this.constructor.type}constructor(){let e=yt(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y6);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return v6}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=Nn();s!=="highp"&&(t=t.replace(w6,Jp.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER),c=e.createProgram();if(!i||!a||!c)throw new Rn("Vertex, fragment shader or program creation error");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Rn("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new Rn("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.attachShader(c,i),e.attachShader(c,a),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new Rn('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(c)));const u=this.getUniformLocations(e,c)||{};return u.uStepW=e.getUniformLocation(c,"uStepW"),u.uStepH=e.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:this.getAttributeLocations(e,c),uniformLocations:u}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,s={};for(let i=0;i<n.length;i++)s[n[i]]=e.getUniformLocation(t,n[i]);return s}sendAttributeData(e,t,n){const s=t.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Ru(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,s=Cn({width:t,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return L({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(yt(e,b6))}}N(Gt,"type","BaseFilter"),N(Gt,"uniformLocations",[]);const _6={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class ol extends Gt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(_6[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new lt(this.color).getSource(),s=this.alpha,i=n[0]*s,a=n[1]*s,c=n[2]*s,u=1-s;for(let h=0;h<t.length;h+=4){const d=t[h],p=t[h+1],g=t[h+2];let v,b,x;switch(this.mode){case"multiply":v=d*i/255,b=p*a/255,x=g*c/255;break;case"screen":v=255-(255-d)*(255-i)/255,b=255-(255-p)*(255-a)/255,x=255-(255-g)*(255-c)/255;break;case"add":v=d+i,b=p+a,x=g+c;break;case"difference":v=Math.abs(d-i),b=Math.abs(p-a),x=Math.abs(g-c);break;case"subtract":v=d-i,b=p-a,x=g-c;break;case"darken":v=Math.min(d,i),b=Math.min(p,a),x=Math.min(g,c);break;case"lighten":v=Math.max(d,i),b=Math.max(p,a),x=Math.max(g,c);break;case"overlay":v=i<128?2*d*i/255:255-2*(255-d)*(255-i)/255,b=a<128?2*p*a/255:255-2*(255-p)*(255-a)/255,x=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":v=i+d-2*i*d/255,b=a+p-2*a*p/255,x=c+g-2*c*g/255;break;case"tint":v=i+d*u,b=a+p*u,x=c+g*u}t[h]=v,t[h+1]=b,t[h+2]=x}}sendUniformData(e,t){const n=new lt(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}N(ol,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),N(ol,"type","BlendColor"),N(ol,"uniformLocations",["uColor"]),le.setClass(ol);const x6={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},S6=["type","image"];class al extends Gt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return x6[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:s},filterBackend:{resources:i}}=e;const a=this.image;i.blendImage||(i.blendImage=cn());const c=i.blendImage,u=c.getContext("2d");c.width!==n||c.height!==s?(c.width=n,c.height=s):u.clearRect(0,0,n,s),u.setTransform(a.scaleX,0,0,a.scaleY,a.left,a.top),u.drawImage(a.getElement(),0,0,n,s);const h=u.getImageData(0,0,n,s).data;for(let d=0;d<t.length;d+=4){const p=t[d],g=t[d+1],v=t[d+2],b=t[d+3],x=h[d],C=h[d+1],T=h[d+2],k=h[d+3];switch(this.mode){case"multiply":t[d]=p*x/255,t[d+1]=g*C/255,t[d+2]=v*T/255,t[d+3]=b*k/255;break;case"mask":t[d+3]=k}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return L(L({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:s}=e,i=yt(e,S6);return sn.fromObject(s,t).then(a=>new this(L(L({},i),{},{image:a})))}}N(al,"type","BlendImage"),N(al,"defaults",{mode:"multiply",alpha:1}),N(al,"uniformLocations",["uTransformMatrix","uImage"]),le.setClass(al);class cl extends Gt{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){Ru(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:n,filterBackend:{resources:s}}=e;const{width:i,height:a}=n;s.blurLayer1||(s.blurLayer1=cn(),s.blurLayer2=cn());const c=s.blurLayer1,u=s.blurLayer2;c.width===i&&c.height===a||(u.width=c.width=i,u.height=c.height=a);const h=c.getContext("2d"),d=u.getContext("2d"),p=15,g=.06*this.blur*.5;let v,b,x,C;for(h.putImageData(n,0,0),d.clearRect(0,0,i,a),C=-15;C<=p;C++)v=(Math.random()-.5)/4,b=C/p,x=g*b*i+v,d.globalAlpha=1-Math.abs(b),d.drawImage(c,x,v),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);for(C=-15;C<=p;C++)v=(Math.random()-.5)/4,b=C/p,x=g*b*a+v,d.globalAlpha=1-Math.abs(b),d.drawImage(c,v,x),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);t.drawImage(c,0,0);const T=t.getImageData(0,0,c.width,c.height);return h.globalAlpha=1,h.clearRect(0,0,c.width,c.height),T}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const n=e*this.blur*.12;return this.horizontal?t[0]=n:t[1]=n,t}}N(cl,"type","Blur"),N(cl,"defaults",{blur:0}),N(cl,"uniformLocations",["uDelta"]),le.setClass(cl);class ll extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]+=n,t[s+1]+=n,t[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}N(ll,"type","Brightness"),N(ll,"defaults",{brightness:0}),N(ll,"uniformLocations",["uBrightness"]),le.setClass(ll);const mx={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class oo extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let i=0;i<t.length;i+=4){const a=t[i],c=t[i+1],u=t[i+2];if(t[i]=a*n[0]+c*n[1]+u*n[2]+255*n[4],t[i+1]=a*n[5]+c*n[6]+u*n[7]+255*n[9],t[i+2]=a*n[10]+c*n[11]+u*n[12]+255*n[14],!s){const h=t[i+3];t[i]+=h*n[3],t[i+1]+=h*n[8],t[i+2]+=h*n[13],t[i+3]=a*n[15]+c*n[16]+u*n[17]+h*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,i)}toObject(){return L(L({},super.toObject()),{},{matrix:[...this.matrix]})}}function Mi(r,e){var t;const n=(N(t=class extends oo{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),N(t,"defaults",{colorsOnly:!1,matrix:e}),t);return le.setClass(n,r),n}N(oo,"type","ColorMatrix"),N(oo,"defaults",mx),N(oo,"uniformLocations",["uColorMatrix","uConstants"]),le.setClass(oo);Mi("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Mi("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Mi("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Mi("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Mi("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Mi("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Mi("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class yy extends Gt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Ru(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>le.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}}N(yy,"type","Composed"),le.setClass(yy);class ul extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let i=0;i<t.length;i+=4)t[i]=s*(t[i]-128)+128,t[i+1]=s*(t[i+1]-128)+128,t[i+2]=s*(t[i+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}N(ul,"type","Contrast"),N(ul,"defaults",{contrast:0}),N(ul,"uniformLocations",["uContrast"]),le.setClass(ul);const C6={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class hl extends Gt{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return C6[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),a=Math.floor(i/2),c=t.width,u=t.height,h=e.ctx.createImageData(c,u),d=h.data,p=this.opaque?1:0;let g,v,b,x,C,T,k,A,I,D,F,U,B;for(F=0;F<u;F++)for(D=0;D<c;D++){for(C=4*(F*c+D),g=0,v=0,b=0,x=0,B=0;B<i;B++)for(U=0;U<i;U++)k=F+B-a,T=D+U-a,k<0||k>=u||T<0||T>=c||(A=4*(k*c+T),I=s[B*i+U],g+=n[A]*I,v+=n[A+1]*I,b+=n[A+2]*I,p||(x+=n[A+3]*I));d[C]=g,d[C+1]=v,d[C+2]=b,d[C+3]=p?n[C+3]:x}e.imageData=h}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return L(L({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}N(hl,"type","Convolute"),N(hl,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),N(hl,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),le.setClass(hl);const vx="Gamma";class dl extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,s=1/n[0],i=1/n[1],a=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const c=this.rgbValues;for(let u=0;u<256;u++)c.r[u]=255*Math.pow(u/255,s),c.g[u]=255*Math.pow(u/255,i),c.b[u]=255*Math.pow(u/255,a);for(let u=0;u<t.length;u+=4)t[u]=c.r[t[u]],t[u+1]=c.g[t[u+1]],t[u+2]=c.b[t[u+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:vx,gamma:this.gamma.concat()}}}N(dl,"type",vx),N(dl,"defaults",{gamma:[1,1,1]}),N(dl,"uniformLocations",["uGamma"]),le.setClass(dl);const T6={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class fl extends Gt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2];switch(this.mode){case"average":n=(i+a+c)/3;break;case"lightness":n=(Math.min(i,a,c)+Math.max(i,a,c))/2;break;case"luminosity":n=.21*i+.72*a+.07*c}t[s+2]=t[s+1]=t[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return T6[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}N(fl,"type","Grayscale"),N(fl,"defaults",{mode:"average"}),N(fl,"uniformLocations",["uMode"]),le.setClass(fl);const E6=L(L({},mx),{},{rotation:0});class Sd extends oo{calculateMatrix(){const e=this.rotation*Math.PI,t=xn(e),n=Sn(e),s=1/3,i=Math.sqrt(s)*n,a=1-t;this.matrix=[t+a/3,s*a-i,s*a+i,0,0,s*a+i,t+s*a,s*a-i,0,0,s*a-i,s*a+i,t+s*a,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}N(Sd,"type","HueRotation"),N(Sd,"defaults",E6),le.setClass(Sd);class pl extends Gt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}N(pl,"type","Invert"),N(pl,"defaults",{alpha:!1,invert:!0}),N(pl,"uniformLocations",["uInvert","uAlpha"]),le.setClass(pl);class gl extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let s=0;s<t.length;s+=4){const i=(.5-Math.random())*n;t[s]+=i,t[s+1]+=i,t[s+2]+=i}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}N(gl,"type","Noise"),N(gl,"defaults",{noise:0}),N(gl,"uniformLocations",["uNoise","uSeed"]),le.setClass(gl);class ml extends Gt{applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let a=0;a<n;a+=this.blocksize){const c=4*i*n+4*a,u=t[c],h=t[c+1],d=t[c+2],p=t[c+3];for(let g=i;g<Math.min(i+this.blocksize,s);g++)for(let v=a;v<Math.min(a+this.blocksize,n);v++){const b=4*g*n+4*v;t[b]=u,t[b+1]=h,t[b+2]=d,t[b+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}N(ml,"type","Pixelate"),N(ml,"defaults",{blocksize:4}),N(ml,"uniformLocations",["uBlocksize"]),le.setClass(ml);class vl extends Gt{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,s=new lt(this.color).getSource(),i=[s[0]-n,s[1]-n,s[2]-n],a=[s[0]+n,s[1]+n,s[2]+n];for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],d=t[c+2];u>i[0]&&h>i[1]&&d>i[2]&&u<a[0]&&h<a[1]&&d<a[2]&&(t[c+3]=0)}}sendUniformData(e,t){const n=new lt(this.color).getSource(),s=this.distance,i=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],a=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(t.uLow,i),e.uniform4fv(t.uHigh,a)}}N(vl,"type","RemoveColor"),N(vl,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),N(vl,"uniformLocations",["uLow","uHigh"]),le.setClass(vl);class yl extends Gt{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let i=1;i<=n;i++)s[i-1]=e(i*t);return s}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Ru(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const i=t.width,a=t.height,c=Math.round(i*n),u=Math.round(a*s);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,a,c,u):this.resizeType==="hermite"?this.hermiteFastResize(e,i,a,c,u):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,a,c,u):this.resizeType==="lanczos"?this.lanczosResize(e,i,a,c,u):new ImageData(c,u),e.imageData=h}sliceByTwo(e,t,n,s,i){const a=e.imageData,c=.5;let u=!1,h=!1,d=t*c,p=n*c;const g=e.filterBackend.resources;let v=0,b=0;const x=t;let C=0;g.sliceByTwo||(g.sliceByTwo=cn());const T=g.sliceByTwo;(T.width<1.5*t||T.height<n)&&(T.width=1.5*t,T.height=n);const k=T.getContext("2d");for(k.clearRect(0,0,1.5*t,n),k.putImageData(a,0,0),s=Math.floor(s),i=Math.floor(i);!u||!h;)t=d,n=p,s<Math.floor(d*c)?d=Math.floor(d*c):(d=s,u=!0),i<Math.floor(p*c)?p=Math.floor(p*c):(p=i,h=!0),k.drawImage(T,v,b,t,n,x,C,d,p),v=x,b=C,C+=p;return k.getImageData(v,b,s,i)}lanczosResize(e,t,n,s,i){const a=e.imageData.data,c=e.ctx.createImageData(s,i),u=c.data,h=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,p=this.rcpScaleY,g=2/this.rcpScaleX,v=2/this.rcpScaleY,b=Math.ceil(d*this.lanczosLobes/2),x=Math.ceil(p*this.lanczosLobes/2),C={},T={x:0,y:0},k={x:0,y:0};return function A(I){let D,F,U,B,X,Y,Z,G,K,oe,ve;for(T.x=(I+.5)*d,k.x=Math.floor(T.x),D=0;D<i;D++){for(T.y=(D+.5)*p,k.y=Math.floor(T.y),X=0,Y=0,Z=0,G=0,K=0,F=k.x-b;F<=k.x+b;F++)if(!(F<0||F>=t)){oe=Math.floor(1e3*Math.abs(F-T.x)),C[oe]||(C[oe]={});for(let Q=k.y-x;Q<=k.y+x;Q++)Q<0||Q>=n||(ve=Math.floor(1e3*Math.abs(Q-T.y)),C[oe][ve]||(C[oe][ve]=h(Math.sqrt(Math.pow(oe*g,2)+Math.pow(ve*v,2))/1e3)),U=C[oe][ve],U>0&&(B=4*(Q*t+F),X+=U,Y+=U*a[B],Z+=U*a[B+1],G+=U*a[B+2],K+=U*a[B+3]))}B=4*(D*s+I),u[B]=Y/X,u[B+1]=Z/X,u[B+2]=G/X,u[B+3]=K/X}return++I<s?A(I):c}(0)}bilinearFiltering(e,t,n,s,i){let a,c,u,h,d,p,g,v,b,x,C,T,k,A=0;const I=this.rcpScaleX,D=this.rcpScaleY,F=4*(t-1),U=e.imageData.data,B=e.ctx.createImageData(s,i),X=B.data;for(g=0;g<i;g++)for(v=0;v<s;v++)for(d=Math.floor(I*v),p=Math.floor(D*g),b=I*v-d,x=D*g-p,k=4*(p*t+d),C=0;C<4;C++)a=U[k+C],c=U[k+4+C],u=U[k+F+C],h=U[k+F+4+C],T=a*(1-b)*(1-x)+c*b*(1-x)+u*x*(1-b)+h*b*x,X[A++]=T;return B}hermiteFastResize(e,t,n,s,i){const a=this.rcpScaleX,c=this.rcpScaleY,u=Math.ceil(a/2),h=Math.ceil(c/2),d=e.imageData.data,p=e.ctx.createImageData(s,i),g=p.data;for(let v=0;v<i;v++)for(let b=0;b<s;b++){const x=4*(b+v*s);let C=0,T=0,k=0,A=0,I=0,D=0,F=0;const U=(v+.5)*c;for(let B=Math.floor(v*c);B<(v+1)*c;B++){const X=Math.abs(U-(B+.5))/h,Y=(b+.5)*a,Z=X*X;for(let G=Math.floor(b*a);G<(b+1)*a;G++){let K=Math.abs(Y-(G+.5))/u;const oe=Math.sqrt(Z+K*K);oe>1&&oe<-1||(C=2*oe*oe*oe-3*oe*oe+1,C>0&&(K=4*(G+B*t),F+=C*d[K+3],k+=C,d[K+3]<255&&(C=C*d[K+3]/250),A+=C*d[K],I+=C*d[K+1],D+=C*d[K+2],T+=C))}}g[x]=A/T,g[x+1]=I/T,g[x+2]=D/T,g[x+3]=F/k}return p}}N(yl,"type","Resize"),N(yl,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),N(yl,"uniformLocations",["uDelta","uTaps"]),le.setClass(yl);class bl extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2],u=Math.max(i,a,c);t[s]+=u!==i?(u-i)*n:0,t[s+1]+=u!==a?(u-a)*n:0,t[s+2]+=u!==c?(u-c)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}N(bl,"type","Saturation"),N(bl,"defaults",{saturation:0}),N(bl,"uniformLocations",["uSaturation"]),le.setClass(bl);class wl extends Gt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2],u=Math.max(i,a,c),h=(i+a+c)/3,d=2*Math.abs(u-h)/255*n;t[s]+=u!==i?(u-i)*d:0,t[s+1]+=u!==a?(u-a)*d:0,t[s+2]+=u!==c?(u-c)*d:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}N(wl,"type","Vibrance"),N(wl,"defaults",{vibrance:0}),N(wl,"uniformLocations",["uVibrance"]),le.setClass(wl);class yx{___eventListeners;___activeObjects;constructor(){this.___activeObjects=[],this.___eventListeners={}}pauseEventListeners(){this.___eventListeners=this.__eventListeners,this.__eventListeners={};const e=this.getActiveObjects();this.discardActiveObject(),this.___activeObjects=e}resumeEventListeners(){this.__eventListeners=this.___eventListeners,this.___eventListeners={};const e=this.___activeObjects;if(!e.length)return this.requestRenderAll(),!1;if(e.length===1)this.setActiveObject(e[0]);else{const t=new jn(e);this.setActiveObject(t)}this.requestRenderAll()}}class yi extends Nt{isSelected=!1;text;tScale;display;id;backgroundColor;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default",fontSize:16,fontFamily:"Arial",fontColor:"#ffffff",textAlign:"center"};static type="Text";constructor(e){super(e),Object.assign(this,yi.ownDefaults),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.text=e.text||"",this.backgroundColor=e.backgroundColor||"transparent"}static createControls(){return{controls:Qp()}}static getDefaults(){return{...super.getDefaults(),...yi.ownDefaults}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,6),e.lineWidth=2,e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore())}}function cs(r,e,t,n,s){r.save(),r.translate(e,t),r.rotate(K_.degreesToRadians(90+s.angle)),r.beginPath(),r.lineWidth=4,r.lineCap="round",r.strokeStyle="#dfe2e8",r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}function Qp(){return{mr:new Ct({x:.5,y:0,actionHandler:La,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing",render:cs}),ml:new Ct({x:-.5,y:0,actionHandler:La,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing",render:cs})}}const La=dr.wrapWithFireEvent("resizing",dr.wrapWithFixedAnchor((r,e,t,n)=>{const s=dr.getLocalPoint(e,e.originX,e.originY,t,n);if(k6(e.originX)||A6(e.originX)&&s.x<0||O6(e.originX)&&s.x>0){const i=e.target,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=I6(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a);if(e.corner==="ml"){const p=u-h;if(i.left+p<0)return i.set("width",i.width+i.left),!0}return i.set("width",Math.max(h,0)),u!==i.width}return!1})),bx={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Ue=r=>typeof r=="string"?bx[r]:r-.5,k6=r=>Ue(r)===Ue("center"),O6=r=>Ue(r)===Ue("left"),A6=r=>Ue(r)===Ue("right");function I6(r){return Ue(r.originX)===Ue("center")&&Ue(r.originY)===Ue("center")}le.setClass(yi,"Text");class ln extends Nt{static type="Transition";id;duration;fromId;toId;static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0, 0, 0, 0.5)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};isSelected=!1;constructor(e){super(e),this.id=e.id,this.fromId=e.fromId,this.toId=e.toId,Object.assign(this,{duration:e.duration,fromId:e.fromId,toId:e.toId,kind:e.kind,tScale:e.tScale,strokeDashArray:e.strokeDashArray||[],isSelected:!1,centeredScaling:!0,strokeWidth:0}),Object.assign(this,ln.ownDefaults)}static createControls(){return{controls:M6()}}static getDefaults(){return{...super.getDefaults(),...ln.ownDefaults}}updateCoords(){}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle=this.isSelected?"rgba(255, 255, 255,1.0)":"rgba(255, 255, 255,0.15)",e.stroke(),e.restore()}}le.setClass(ln,"Transition");const M6=()=>({mr:new Ct({x:.5,y:0,actionHandler:by,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing",render:cs}),ml:new Ct({x:-.5,y:0,actionHandler:by,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing",render:cs})});le.setClass(ln,"Transition");const{wrapWithFireEvent:P6,getLocalPoint:D6}=dr,Ef="center",R6="left",j6="right";function L6(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,a,c),d}}const F6=(r,e,t,n)=>{const s=D6(e,e.originX,e.originY,t,n);if(Ue(e.originX)===Ue(Ef)||Ue(e.originX)===Ue(j6)&&s.x<0||Ue(e.originX)===Ue(R6)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=N6(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a),d=ks(h,i.tScale);return d>=1500||d<500?!1:(i.set("width",Math.max(h,0)),i.set("duration",d),i.setCoords(),i.canvas&&i.canvas.renderAll(),u!==i.width)}return!1};function N6(r){return Ue(r.originX)===Ue(Ef)&&Ue(r.originY)===Ue(Ef)}const by=P6("resizing",L6(F6));class mo extends Nt{static type="Placeholder";guideItemId;distXToActCenter;trackItemType;defaultPos;draggedObject=null;for;id;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",strokeWidth:0,fill:"rgba(255, 211, 42, 0.1)",stroke:"rgba(255, 211, 42, 1.0)",selectable:!1,borderOpacityWhenMoving:1,hoverCursor:"default",strokeDashArray:[5,1],evented:!1};constructor(e){super(e),this.id=e.id,this.for=e.for,Object.assign(this,mo.ownDefaults)}static getDefaults(){return{...super.getDefaults(),...mo.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore()}}le.setClass(mo,"Placeholder");const B6={top:{top:35,guideHeight:2,bottom:3},center:{top:3,guideHeight:2,bottom:3},bottom:{top:3,guideHeight:2,bottom:35}},tc="rgba(0, 216, 214, 1.0)",Cd=(r,e,t)=>new Nt({top:r,left:0,strokeWidth:0,fill:"transparent",selectable:!0,height:t,width:e});class Ca extends an{static type="Helper";static defaultSettings={selectable:!1,evented:!1};static ownDefaults={...Ca.defaultSettings};guide;topGuide;bottomGuide;id;metadata={};tScale;kind;constructor(e){const t=B6[e.kind],n=Cd(0,e.width,t.top),s=Cd(t.top,e.width,t.guideHeight),i=Cd(t.top+t.guideHeight,e.width,t.bottom);super([n,s,i],{...Ca.defaultSettings,...e}),this.topGuide=n,this.guide=s,this.bottomGuide=i,this.id=e.id,this.metadata=e.metadata??{},this.tScale=e.tScale,this.kind=e.kind}static getDefaults(){return{...super.getDefaults(),...Ca.defaultSettings}}updateCoords(e){this.scaleToWidth(e),this.set("scaleY",1)}setSelected(e){this.guide.set("fill",e?tc:"transparent")}}const Lo=Ca;le.setClass(Lo,"Helper");class Rs extends Nt{static ownDefaults={selectable:!1,evented:!1,strokeWidth:0,stroke:"transparent"};static type="Track";id;accepts;metadata;items;borderColor="transparent";stroke="transparent";strokeWidth=0;constructor(e){super(e),Object.assign(this,Rs.ownDefaults),this.id=e.id,this.accepts=e.accepts||["audio","video","image","text"],this.items=e.items||[],this.metadata=e.metadata}static getDefaults(){return{...super.getDefaults(),...Rs.ownDefaults}}updateCoords(e){this.width=e}}le.setClass(Rs,"Track");class ql extends Nt{isSelected;tScale;display;id;src;itemType;static ownDefaults={rx:8,ry:8,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",fill:"#27272a"};static type="Image";constructor(e){super(e),this.itemType="image",this.isSelected=!1,Object.assign(this,ql.ownDefaults),this.id=e.id,this.src=e.src,this.display=e.display,this.tScale=e.tScale}static createControls(){return{controls:Qp()}}static getDefaults(){return{...super.getDefaults(),...ql.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=tc,e.stroke(),e.restore())}}const ju=ql;le.setClass(ju,"Image");class Pi extends Nt{id;tScale;isSelected=!1;display;trim;static type="Video";static defaultProps={objectCaching:!1,rx:8,ry:8,fill:"#27272a"};constructor(e){super(Object.assign({},Pi.defaultProps,e)),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim}static createControls(){return{controls:wx()}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=tc,e.stroke(),e.restore())}}le.setClass(Pi,"Video");const wx=()=>({mr:new Ct({x:.5,y:0,render:cs,actionHandler:wy,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new Ct({x:-.5,y:0,render:cs,actionHandler:wy,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:V6,getLocalPoint:H6}=dr,z6=(r,e,t,n)=>{const s=H6(e,e.originX,e.originY,t,n);if(Ue(e.originX)===Ue("center")||Ue(e.originX)===Ue("right")&&s.x<0||Ue(e.originX)===Ue("left")&&s.x>0){const{target:i}=e;return i.width!==i.width}return!1};function eg(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,a,c),d}}const wy=V6("resizing",eg(z6));class is extends Nt{id;itemType="audio";isSelected=!1;trim;src;tScale;display;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default"};static type="Audio";constructor(e){super({...is.getDefaults(),...e}),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim,this.src=e.src}static getDefaults(){return{...super.getDefaults(),...is.ownDefaults}}static createControls(){return{controls:_x()}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,is.ownDefaults.rx),e.lineWidth=2,e.strokeStyle=tc,e.stroke(),e.restore())}}le.setClass(is,"Audio");const _x=()=>({mr:new Ct({x:.5,y:0,render:cs,actionHandler:_y,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new Ct({x:-.5,y:0,render:cs,actionHandler:_y,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:W6,getLocalPoint:U6}=dr,$6=(r,e,t,n)=>{const s=U6(e,e.originX,e.originY,t,n);if(Ue(e.originX)===Ue("center")||Ue(e.originX)===Ue("right")&&s.x<0||Ue(e.originX)===Ue("left")&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=Y6(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a);if(e.corner==="mr"){const d=i.trim.to,p=h-u,g=ks(p,i.tScale),v=d+g;if(v>i.duration)return!1;i.set("width",Math.max(h,0)),i.trim.to=v}else{if(i.left<0)return!1;const d=u-h;if(i.left+d<0)return i.set("width",i.width+i.left),!0;const p=h-u,g=i.trim.from,v=ks(p,i.tScale),b=g-v;if(b<0)return!1;i.set("width",Math.max(h,0)),i.trim.from=b}return u!==i.width}return!1};function Y6(r){return Ue(r.originX)===Ue("center")&&Ue(r.originY)===Ue("center")}const _y=W6("resizing",eg($6));class Fa extends Nt{static type="TransitionGuide";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0,0,0,0.85)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};tScale;duration=0;fromId;toId;itemType="none";isSelected=!1;id;constructor(e){super(e),Object.assign(this,Fa.ownDefaults),this.id=e.id}static createControls(){return{controls:xx()}}static getDefaults(){return{...super.getDefaults(),...Fa.ownDefaults}}updateCoords(){const e=this.canvas;if(!e)return;const t=e.getObjects().find(i=>i.id===this.fromId);if(!t)return;const n=Lt(this.duration,this.tScale),s=t.left+t.width-n/2;this.set({width:n,left:s})}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M3 5.30359C3 3.93159 4.659 3.24359 5.629 4.21359L11.997 10.5826L10.583 11.9966L5 6.41359V17.5856L10.586 11.9996L10.583 11.9966L11.997 10.5826L12 10.5856L18.371 4.21459C19.341 3.24459 21 3.93159 21 5.30359V18.6956C21 20.0676 19.341 20.7556 18.371 19.7856L12 13.5L13.414 11.9996L19 17.5866V6.41359L13.414 11.9996L13.421 12.0056L12.006 13.4206L12 13.4136L5.629 19.7846C4.659 20.7546 3 20.0676 3 18.6956V5.30359Z");e.save(),e.translate(-12,-12),e.fillStyle="#ffffff",e.fill(t),e.restore()}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=1,e.strokeStyle="rgba(255, 255, 255,1.0)",e.stroke(),e.restore())}}function xx(){return{mr:new Ct({x:.5,y:0,actionHandler:La,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing",render:xy}),ml:new Ct({x:-.5,y:0,actionHandler:La,cursorStyleHandler:dr.scaleSkewCursorStyleHandler,actionName:"resizing",render:xy})}}function xy(r,e,t,n,s){r.save(),r.translate(e,t),r.rotate(K_.degreesToRadians(90+s.angle)),r.lineWidth=6,r.lineCap="round",r.strokeStyle="white",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.lineWidth=4,r.strokeStyle="black",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}class Na extends Nt{static type="PreviewTrackItem";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",rx:4,ry:4};duration=0;fromId="";toId="";isSelected=!1;name;durationString;id;constructor(e){super(e),Object.assign(this,Na.ownDefaults),this.id=e.id,this.name=e.name||"item",this.durationString="00:05",this.fill="#27272a"}static getDefaults(){return{...super.getDefaults(),...Na.ownDefaults}}_render(e){e.save(),super._render(e),e.beginPath(),e.rect(-this.width/2,-this.height/2,this.width,this.height),e.clip(),this.drawTextIdentity(e),e.restore()}drawTextIdentity(e){e.font="600 12px 'Geist variable'",e.textAlign="left";const u=e.measureText(this.name).width,h=e.measureText(this.durationString).width,d=-this.height/2+4,p=-this.width/2,g=p+u+8*2+4,v=u+8*2;this.drawRoundedRect(e,p,d,v,20,4),e.fillStyle="#f4f4f5",e.fillText(this.name,p+8,d+12+2);const b=h+8*2;this.drawRoundedRect(e,g,d,b,20,4),e.fillStyle="#f4f4f5",e.fillText(this.durationString,g+8,d+12+2)}drawRoundedRect(e,t,n,s,i,a){e.fillStyle="rgba(0, 0, 0, 0.5)",e.roundRect?(e.beginPath(),e.roundRect(t,n,s,i,a),e.fill()):e.fillRect(t,n,s,i)}}function Sx(r,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{if(n!=="constructor"){const s=Object.getOwnPropertyDescriptor(t.prototype,n);s&&Object.defineProperty(r.prototype,n,s)}})})}const Lu=(r,e)=>{const t={x:r.size.width/2,y:r.size.height/2},n={x:e.width/2,y:e.height/2},s=t.x-n.x,i=t.y-n.y,a=Math.min(r.size.width/e.width,r.size.height/e.height);return{top:`${i}px`,left:`${s}px`,transform:`scale(${a})`}},Cx=r=>new Promise((e,t)=>{const n=new Audio;n.preload="auto",n.addEventListener("loadedmetadata",()=>{const s=n.duration*1e3;e({duration:s})}),n.addEventListener("error",s=>{t(s)}),n.src=r,n.crossOrigin="anonymous",n.load()}),Tx=r=>new Promise((e,t)=>{const n=new Image;console.warn("Consider updating CDN config for CORS issues?"),n.onload=()=>{const s=n.width,i=n.height;e({width:s,height:i})},n.onerror=s=>{t(s)},n.crossOrigin="anonymous",n.src=r}),Ex=r=>new Promise((e,t)=>{const n=document.createElement("video");n.preload="auto",n.addEventListener("loadedmetadata",()=>{const s=n.duration*1e3,i=n.videoWidth,a=n.videoHeight;e({duration:s,width:i,height:a})}),n.addEventListener("error",s=>{t(s)}),n.src=r,n.load()}),Ta=(r,e)=>{const t=document.createElement("div");Object.keys(e).forEach(s=>{s!=="height"&&(t.style[s]=e[s])}),document.body.appendChild(t),t.textContent=r,t.style.width=`${e.width}px`,t.style.fontSize=`${e.fontSize}px`;const n=getComputedStyle(t).height;return document.body.removeChild(t),parseFloat(n)},Tn=r=>Object.keys(r).reduce((e,t)=>{const{display:{to:n}}=r[t];return Math.max(e,n)},0),kx=(r,e)=>{if(!r)return{from:0,to:e.duration};const{from:t,to:n}=r;return{from:t??0,to:n??e.duration}},Ox=(r,e)=>{const{duration:t,trim:n}=e,s=n?n.to-n.from:t||5e3,i={from:0,to:s};if(!r)return i;if(r.from!==void 0&&r.from<0)return console.error("'from' must be a non-negative number. Returning default display."),i;if(r.from!==void 0&&r.to===void 0)return{from:r.from,to:r.from+s};if(r.to!==void 0){if(r.to<0)return console.error("'to' must be a non-negative number. Returning default display."),i;if(r.to<r.from)return console.error("'to' must be greater than or equal to 'from'. Returning default display."),i}return r};function Ax(r,e){return r.map(t=>{const n=t.items.filter(s=>!e.includes(s));return{...t,items:n}}).filter(t=>t.items.length>0)}const Ix=async(r,e)=>{const t=r.details,n=await Tx(t.src),s=Lu(e,n);return{id:r.id,type:"image",name:"",display:{from:e.origin||0,to:(e.origin||5e3)+5e3},details:{src:t.src||"",width:t.width||n.width||100,height:t.height||n.height||100,opacity:t.opacity??100,transform:s.transform,border:t.border||"none",borderRadius:t.borderRadius||"0",boxShadow:t.boxShadow||"none",top:s.top||"0px",left:s.left||"0px"},metadata:r.metadata||{}}},Mx=async(r,e)=>{const t=r.details.src,n=await Ex(t),s=Lu(e,{...n}),i=kx(r.trim,{duration:n.duration}),a={width:n.width,height:n.height,duration:n.duration,src:t,volume:r.details.volume??100,top:r.details.top||s.top||"0px",left:r.details.left||s.left||"0px",text:r.details.text};return{...r,trim:i,type:"video",details:a,display:Ox(r?.display,{duration:n.duration,trim:i})}},Px=async r=>{const e=r.details,t=(await Cx(e.src)).duration,n=r?.display?.from??0;return{id:r.id,name:"",type:"audio",display:{from:n,to:n+t},trim:{from:0,to:t},details:{src:e.src,duration:t,volume:e.volume??100,text:e.text},metadata:{...r.metadata}}},X6=5e3,tg=async(r,e)=>{const t=r.id;await Sb([{fontFamily:r.details.fontFamily??"",fontUrl:r.details.fontUrl??""}]);const n={fontFamily:r.details.fontFamily??"Arial",fontSize:r.details.fontSize??"16px",fontWeight:r.details.fontWeight??"normal",fontStyle:r.details.fontStyle??"normal",textDecoration:r.details.textDecoration??"none",textAlign:r.details.textAlign??"left",lineHeight:r.details.lineHeight??"normal",letterSpacing:r.details.letterSpacing??"normal",wordSpacing:r.details.wordSpacing??"normal",color:r.details.color??"#ffffff",backgroundColor:r.details.backgroundColor??"transparent",border:r.details.border??"none",textShadow:r.details.textShadow??"none",text:r.details.text??"",opacity:r.details.opacity??100,width:r.details.width??300,wordWrap:r.details.wordWrap??"normal",wordBreak:r.details.wordBreak??"normal",WebkitTextStrokeColor:r.details.WebkitTextStrokeColor??"#ffffff",WebkitTextStrokeWidth:r.details.WebkitTextStrokeWidth??"0px",top:r.details.top??"0px",left:r.details.left??"0px"},s=Ta(r.details.text??"",n),i=Lu(e,{width:n.width??0,height:s});return{id:t,name:"",type:"text",display:{from:0,to:X6},details:{...n,height:s,top:i.top,left:i.left,fontUrl:r.details.fontUrl,text:r.details.text??""},metadata:{}}},Dx=(r,e)=>{const t=r.display,n=Lt(t.from,e.tScale),s=Lt(t.to-t.from,e.tScale),i=le.getClass("Audio")||is;return new i({width:s,height:42,top:10,left:n,id:r.id,display:t,text:r.details.text,trim:r.trim||{from:0,to:r.details.duration},duration:r.details.duration,src:r.details.src,tScale:e.tScale})},Rx=(r,e)=>{const t=Lt(r.display.from,e.tScale),n=Lt(r.details.duration||5e3,e.tScale),s=le.getClass("Image")||ju;return new s({width:n,height:42,id:r.id,src:r.details.src,tScale:e.tScale,top:10,left:t,display:r.display})},jx=(r,e)=>{const t=Lt(r.trim.from,e.tScale),n=Lt(r.trim.to-r.trim.from,e.tScale),s=le.getClass("Video")||Pi;return new s({width:n,height:42,id:r.id,tScale:e.tScale,fill:"#333333",top:10,left:t,display:r.trim,trim:r.trim,text:r.details.text})},Lx=(r,e)=>{const t=r.display,n=Lt(t.from,e.tScale),s=Lt(t.to-t.from,e.tScale),i=le.getClass("Text")||yi;return new i({width:s,height:42,id:r.id,display:t,top:10,left:n,text:r.details.text,tScale:e.tScale})},Fx={video:42,image:42,audio:42,text:42,caption:42,template:42},Nx=(r={})=>{const e={...Fx,...r};return Object.fromEntries(Object.entries(e).filter(([,t])=>typeof t=="number"))};let Bx=class extends is{static type="Audio";text;constructor(e){super(e),this.text=e.text??"Audio"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M8.24092 0C8.24092 2.51565 10.2795 4.55419 12.7951 4.55419C12.9677 4.55419 13.1331 4.62274 13.2552 4.74475C13.3772 4.86676 13.4457 5.03224 13.4457 5.20479C13.4457 5.37734 13.3772 5.54282 13.2552 5.66483C13.1331 5.78685 12.9677 5.85539 12.7951 5.85539C11.9218 5.85605 11.0594 5.66105 10.2713 5.28471C9.48319 4.90838 8.78942 4.36027 8.24092 3.68066V13.8794C8.24094 14.8271 7.91431 15.7458 7.31606 16.4808C6.71781 17.2157 5.88451 17.722 4.95657 17.9143C4.02863 18.1066 3.06276 17.9731 2.22172 17.5364C1.38067 17.0997 0.715856 16.3865 0.339286 15.5169C-0.0372842 14.6473 -0.10259 13.6744 0.154372 12.7622C0.411334 11.8501 0.974857 11.0544 1.74999 10.5092C2.52512 9.96403 3.46449 9.7027 4.40981 9.76924C5.35512 9.83579 6.24861 10.2261 6.93972 10.8745V0H8.24092ZM6.93972 13.8794C6.93972 13.1317 6.6427 12.4146 6.11398 11.8859C5.58527 11.3572 4.86818 11.0602 4.12046 11.0602C3.37275 11.0602 2.65566 11.3572 2.12694 11.8859C1.59823 12.4146 1.3012 13.1317 1.3012 13.8794C1.3012 14.6272 1.59823 15.3443 2.12694 15.873C2.65566 16.4017 3.37275 16.6987 4.12046 16.6987C4.86818 16.6987 5.58527 16.4017 6.11398 15.873C6.6427 15.3443 6.93972 14.6272 6.93972 13.8794Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,10),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,14),e.translate(10,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class Vx extends Pi{static type="Video";text;constructor(e){super(e),this.text=e.text??"Video"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M16.5625 0.925L12.5 3.275V0.625L11.875 0H0.625L0 0.625V9.375L0.625 10H11.875L12.5 9.375V6.875L16.5625 9.2125L17.5 8.625V1.475L16.5625 0.925ZM11.25 8.75H1.25V1.25H11.25V8.75ZM16.25 7.5L12.5 5.375V4.725L16.25 2.5V7.5Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,14),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,10),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}class rg extends yi{static type="Text";constructor(e){super(e),this.fill="#303030"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M6.23982 0.361968C6.18894 0.253743 6.10832 0.162234 6.00736 0.0981357C5.9064 0.034038 5.78929 0 5.6697 0C5.55012 0 5.433 0.034038 5.33204 0.0981357C5.23109 0.162234 5.15046 0.253743 5.09959 0.361968L0.0599035 11.0713C0.0246926 11.1462 0.00457285 11.2272 0.000693114 11.3099C-0.00318662 11.3925 0.00924959 11.4751 0.0372917 11.553C0.0939253 11.7102 0.210687 11.8384 0.361891 11.9095C0.513095 11.9806 0.686354 11.9888 0.843555 11.9322C1.00076 11.8755 1.12902 11.7588 1.20013 11.6075L2.51202 8.81998H8.82738L10.1393 11.6075C10.1745 11.6824 10.2241 11.7496 10.2853 11.8053C10.3465 11.861 10.418 11.9041 10.4958 11.9322C10.5737 11.9602 10.6563 11.9726 10.7389 11.9687C10.8216 11.9649 10.9026 11.9447 10.9775 11.9095C11.0524 11.8743 11.1196 11.8247 11.1753 11.7635C11.231 11.7023 11.2741 11.6308 11.3021 11.553C11.3302 11.4751 11.3426 11.3925 11.3387 11.3099C11.3348 11.2272 11.3147 11.1462 11.2795 11.0713L6.23982 0.361968ZM3.10498 7.56005L5.6697 2.11011L8.23443 7.56005H3.10498ZM15.1191 3.78029C14.1143 3.78029 13.3292 4.05354 12.7859 4.59294C12.6721 4.71153 12.6092 4.86987 12.6106 5.03419C12.6119 5.19851 12.6774 5.3558 12.7931 5.4725C12.9088 5.58921 13.0655 5.6561 13.2298 5.6589C13.3941 5.6617 13.553 5.60018 13.6726 5.48748C13.9718 5.19062 14.46 5.04021 15.1191 5.04021C16.1609 5.04021 17.009 5.74892 17.009 6.61511V6.86867C16.45 6.49465 15.7917 6.29663 15.1191 6.30013C13.382 6.30013 11.9693 7.57187 11.9693 9.13495C11.9693 10.698 13.382 11.9698 15.1191 11.9698C15.792 11.9727 16.4503 11.7739 17.009 11.3989C17.0168 11.566 17.0907 11.7231 17.2144 11.8357C17.3381 11.9483 17.5014 12.0071 17.6685 11.9993C17.8356 11.9915 17.9927 11.9176 18.1053 11.7939C18.2179 11.6702 18.2767 11.5069 18.2689 11.3398V6.61511C18.2689 5.05202 16.8562 3.78029 15.1191 3.78029ZM15.1191 10.7099C14.0773 10.7099 13.2292 10.0012 13.2292 9.13495C13.2292 8.26876 14.0773 7.56005 15.1191 7.56005C16.1609 7.56005 17.009 8.26876 17.009 9.13495C17.009 10.0012 16.1609 10.7099 15.1191 10.7099Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}let Hx=class extends ju{static type="Image";text;constructor(e){super(e),this.text=e.text??"Image"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M1.55556 0H14.4444C15.3031 0 16 0.696889 16 1.55556V14.4444C16 14.857 15.8361 15.2527 15.5444 15.5444C15.2527 15.8361 14.857 16 14.4444 16H1.55556C1.143 16 0.747335 15.8361 0.455612 15.5444C0.163889 15.2527 0 14.857 0 14.4444V1.55556C0 0.696889 0.696889 0 1.55556 0ZM14.4444 1.33333H1.55556C1.49662 1.33333 1.4401 1.35675 1.39842 1.39842C1.35675 1.4401 1.33333 1.49662 1.33333 1.55556V14.4444C1.33333 14.5671 1.43289 14.6667 1.55556 14.6667H1.72444L10.456 5.93511C10.6004 5.79065 10.7719 5.67605 10.9607 5.59787C11.1494 5.51968 11.3517 5.47944 11.556 5.47944C11.7603 5.47944 11.9626 5.51968 12.1513 5.59787C12.3401 5.67605 12.5116 5.79065 12.656 5.93511L14.6667 7.94578V1.55556C14.6667 1.49662 14.6433 1.4401 14.6016 1.39842C14.5599 1.35675 14.5034 1.33333 14.4444 1.33333ZM14.6667 9.83111L11.7129 6.87733C11.6922 6.85664 11.6677 6.84022 11.6407 6.82902C11.6137 6.81781 11.5848 6.81205 11.5556 6.81205C11.5263 6.81205 11.4974 6.81781 11.4704 6.82902C11.4434 6.84022 11.4189 6.85664 11.3982 6.87733L3.60978 14.6667H14.4444C14.5034 14.6667 14.5599 14.6433 14.6016 14.6016C14.6433 14.5599 14.6667 14.5034 14.6667 14.4444V9.83111ZM4.88889 7.11111C4.29952 7.11111 3.73429 6.87699 3.31754 6.46024C2.90079 6.04349 2.66667 5.47826 2.66667 4.88889C2.66667 4.29952 2.90079 3.73429 3.31754 3.31754C3.73429 2.90079 4.29952 2.66667 4.88889 2.66667C5.47826 2.66667 6.04349 2.90079 6.46024 3.31754C6.87699 3.73429 7.11111 4.29952 7.11111 4.88889C7.11111 5.47826 6.87699 6.04349 6.46024 6.46024C6.04349 6.87699 5.47826 7.11111 4.88889 7.11111ZM4.88889 5.77778C5.12464 5.77778 5.35073 5.68413 5.51743 5.51743C5.68413 5.35073 5.77778 5.12464 5.77778 4.88889C5.77778 4.65314 5.68413 4.42705 5.51743 4.26035C5.35073 4.09365 5.12464 4 4.88889 4C4.65314 4 4.42705 4.09365 4.26035 4.26035C4.09365 4.42705 4 4.65314 4 4.88889C4 5.12464 4.09365 5.35073 4.26035 5.51743C4.42705 5.68413 4.65314 5.77778 4.88889 5.77778Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class zx extends Rs{static type="Track";constructor(e){super(e),this.fill="#18181b"}_render(e){super._render(e);const t=new Path2D("M14.4444 13.3263H11.0667C12.5384 12.3991 13.6259 10.9716 14.1289 9.30644C14.632 7.64131 14.5169 5.85051 13.8048 4.26348C13.0927 2.67645 11.8314 1.39993 10.2531 0.668736C8.67478 -0.0624548 6.8855 -0.199136 5.21442 0.283835C3.54334 0.766806 2.10285 1.83695 1.15794 3.2974C0.213035 4.75785 -0.172743 6.51038 0.0715766 8.23261C0.315896 9.95484 1.17388 11.5309 2.4877 12.671C3.80151 13.811 5.4828 14.4383 7.22227 14.4374H14.4444C14.5918 14.4374 14.7331 14.3789 14.8373 14.2747C14.9415 14.1705 15 14.0292 15 13.8819C15 13.7345 14.9415 13.5932 14.8373 13.489C14.7331 13.3848 14.5918 13.3263 14.4444 13.3263ZM1.1112 7.21523C1.1112 6.00658 1.46961 4.82506 2.14111 3.8201C2.8126 2.81514 3.76702 2.03187 4.88367 1.56934C6.00032 1.10681 7.22905 0.985789 8.41449 1.22159C9.59992 1.45738 10.6888 2.03941 11.5435 2.89405C12.3981 3.7487 12.9801 4.83759 13.2159 6.02302C13.4517 7.20845 13.3307 8.43719 12.8682 9.55384C12.4056 10.6705 11.6224 11.6249 10.6174 12.2964C9.61244 12.9679 8.43093 13.3263 7.22227 13.3263C5.60208 13.3245 4.04878 12.68 2.90313 11.5344C1.75748 10.3887 1.11304 8.83542 1.1112 7.21523ZM7.22227 5.54858C7.55191 5.54858 7.87414 5.45083 8.14822 5.2677C8.4223 5.08456 8.63592 4.82426 8.76206 4.51972C8.88821 4.21518 8.92121 3.88007 8.85691 3.55677C8.7926 3.23347 8.63386 2.9365 8.40078 2.70342C8.16769 2.47033 7.87072 2.3116 7.54742 2.24729C7.22412 2.18298 6.88901 2.21599 6.58447 2.34213C6.27993 2.46828 6.01964 2.6819 5.8365 2.95598C5.65337 3.23006 5.55562 3.55229 5.55562 3.88192C5.55562 4.32395 5.73121 4.74787 6.04377 5.06043C6.35633 5.37298 6.78025 5.54858 7.22227 5.54858ZM7.22227 3.32637C7.33215 3.32637 7.43956 3.35895 7.53092 3.42C7.62228 3.48104 7.69349 3.56781 7.73554 3.66932C7.77759 3.77084 7.78859 3.88254 7.76715 3.9903C7.74572 4.09807 7.6928 4.19706 7.61511 4.27476C7.53741 4.35245 7.43842 4.40536 7.33066 4.4268C7.22289 4.44824 7.11119 4.43723 7.00967 4.39519C6.90816 4.35314 6.82139 4.28193 6.76035 4.19057C6.69931 4.09921 6.66672 3.9918 6.66672 3.88192C6.66672 3.73458 6.72525 3.59327 6.82944 3.48909C6.93363 3.3849 7.07493 3.32637 7.22227 3.32637ZM8.88893 10.5485C8.88893 10.2189 8.79118 9.89668 8.60805 9.6226C8.42491 9.34852 8.16462 9.1349 7.86008 9.00875C7.55553 8.88261 7.22043 8.8496 6.89713 8.91391C6.57383 8.97822 6.27686 9.13695 6.04377 9.37004C5.81069 9.60313 5.65195 9.9001 5.58764 10.2234C5.52334 10.5467 5.55634 10.8818 5.68249 11.1863C5.80863 11.4909 6.02225 11.7512 6.29633 11.9343C6.57041 12.1175 6.89264 12.2152 7.22227 12.2152C7.6643 12.2152 8.08822 12.0396 8.40078 11.727C8.71334 11.4145 8.88893 10.9906 8.88893 10.5485ZM6.66672 10.5485C6.66672 10.4387 6.69931 10.3313 6.76035 10.2399C6.82139 10.1485 6.90816 10.0773 7.00967 10.0353C7.11119 9.99323 7.22289 9.98223 7.33066 10.0037C7.43842 10.0251 7.53741 10.078 7.61511 10.1557C7.6928 10.2334 7.74572 10.3324 7.76715 10.4402C7.78859 10.5479 7.77759 10.6596 7.73554 10.7611C7.69349 10.8627 7.62228 10.9494 7.53092 11.0105C7.43956 11.0715 7.33215 11.1041 7.22227 11.1041C7.07493 11.1041 6.93363 11.0456 6.82944 10.9414C6.72525 10.8372 6.66672 10.6959 6.66672 10.5485ZM10.5556 8.88189C10.8852 8.88189 11.2074 8.78414 11.4815 8.60101C11.7556 8.41787 11.9692 8.15758 12.0954 7.85303C12.2215 7.54849 12.2545 7.21338 12.1902 6.89008C12.1259 6.56678 11.9672 6.26982 11.7341 6.03673C11.501 5.80364 11.204 5.64491 10.8807 5.5806C10.5574 5.51629 10.2223 5.5493 9.91778 5.67544C9.61324 5.80159 9.35295 6.01521 9.16981 6.28929C8.98668 6.56337 8.88893 6.8856 8.88893 7.21523C8.88893 7.65726 9.06452 8.08118 9.37708 8.39374C9.68964 8.70629 10.1136 8.88189 10.5556 8.88189ZM10.5556 6.65968C10.6655 6.65968 10.7729 6.69226 10.8642 6.75331C10.9556 6.81435 11.0268 6.90112 11.0688 7.00263C11.1109 7.10415 11.1219 7.21585 11.1005 7.32362C11.079 7.43138 11.0261 7.53037 10.9484 7.60807C10.8707 7.68576 10.7717 7.73867 10.664 7.76011C10.5562 7.78155 10.4445 7.77054 10.343 7.7285C10.2415 7.68645 10.1547 7.61524 10.0937 7.52388C10.0326 7.43252 10 7.32511 10 7.21523C10 7.06789 10.0586 6.92658 10.1628 6.8224C10.2669 6.71821 10.4082 6.65968 10.5556 6.65968ZM3.88896 5.54858C3.55933 5.54858 3.2371 5.64633 2.96302 5.82946C2.68894 6.01259 2.47532 6.27289 2.34918 6.57743C2.22303 6.88197 2.19002 7.21708 2.25433 7.54038C2.31864 7.86368 2.47737 8.16065 2.71046 8.39374C2.94355 8.62682 3.24052 8.78556 3.56382 8.84986C3.88711 8.91417 4.22222 8.88117 4.52677 8.75502C4.83131 8.62888 5.0916 8.41526 5.27474 8.14118C5.45787 7.8671 5.55562 7.54487 5.55562 7.21523C5.55562 6.77321 5.38003 6.34929 5.06747 6.03673C4.75491 5.72417 4.33099 5.54858 3.88896 5.54858ZM3.88896 7.77078C3.77909 7.77078 3.67168 7.7382 3.58032 7.67716C3.48896 7.61611 3.41775 7.52935 3.3757 7.42783C3.33365 7.32632 3.32265 7.21462 3.34409 7.10685C3.36552 6.99908 3.41843 6.90009 3.49613 6.8224C3.57382 6.7447 3.67281 6.69179 3.78058 6.67036C3.88835 6.64892 4.00005 6.65992 4.10156 6.70197C4.20308 6.74402 4.28984 6.81522 4.35089 6.90658C4.41193 6.99794 4.44452 7.10535 4.44452 7.21523C4.44452 7.36257 4.38598 7.50388 4.2818 7.60807C4.17761 7.71225 4.03631 7.77078 3.88896 7.77078Z");this.items.length||(e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#A0A4A2",e.textAlign="left",e.clip(),e.fillText("Drag and drop media here",32,12),e.translate(8,1),e.fillStyle="#A0A4A2",e.fill(t),e.restore())}}class Wx extends Lo{static type="Helper";constructor(e){e.activeGuideFill="#ffffff",super(e)}}class Ux{addTrackItem(e){const t=e.id,n=Td(e,{tScale:this.tScale,sizesMap:this.sizesMap});this.add(n),this.trackItemIds.push(t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=Tn(this.trackItemsMap)}alignItemsToTrack(){this.pauseEventListeners();const e=new Map(this.getObjects("Track").map(n=>[n.id,n])),t=this.getObjects("Image","Video","Text","Audio");this.trackItemIds.forEach(n=>{const s=this.tracks.find(c=>c.items.includes(n));if(!s)return;const i=e.get(s.id);this.duration;const a=this.getObjects().find(c=>c.id===n);a&&i&&(a.isMain=!1,this.trackItemsMap[n].isMain=!1,a.set({top:i.top}),a.setCoords())}),e.forEach(n=>{n.items=t.filter(s=>s.top===n.top).map(s=>s.id)}),this.resumeEventListeners()}updateTrackItemsPosition(){const e=this.getObjects("Image","Text","Video","Audio");e.sort((t,n)=>t.top-n.top),this.trackItemIds=e.map(t=>t.id).reverse()}restoreTrackItemPositions(){}updateTrackItemsState(){this.pauseEventListeners();const e=this.getObjects("Image","Video","Text","Audio"),t={};e.forEach(n=>{const{id:s,left:i,width:a}=n,c=this.trackItemsMap[s],u=ks(i,this.tScale),h=u+ks(a,this.tScale),d={from:u,to:h},p={...c,display:d,trim:n instanceof Pi||n instanceof is?n.trim:void 0};n.display=d,t[s]=p}),this.trackItemsMap=t,this.resumeEventListeners()}deleteActiveTrackItem(){const e=this.getActiveObjects();if(!e.length)return!1;const t=e.map(s=>s.id),n=Aa(this.tracks,t);this.trackItemsMap=Object.keys(this.trackItemsMap).reduce((s,i)=>(t.includes(i)||(s[i]=this.trackItemsMap[i]),s),{}),this.trackItemIds=this.trackItemIds.filter(s=>!t.includes(s)),this.tracks=n,this.discardActiveObject(),this.remove(...e),this.setActiveIds([]),this.renderTracks(),this.alignItemsToTrack(),this.updateState({updateHistory:!0,kind:"remove"})}updateTrackItemsToHistory(){this.pauseEventListeners();const e=this.getObjects();this.trackItemIds.forEach(t=>{const n=this.tracks.find(h=>h.items.includes(t)),s=e.find(h=>h.id===n?.id)?.top;if(!s){console.warn(`Track top not found for trackItemId: ${t}`);return}const i=this.trackItemsMap[t],a=e.find(h=>h.id===t);if(!a){console.warn(`Object not found for trackItemId: ${t}`);return}const c=Lt(i.display.from,this.tScale),u=Lt(i.display.to-i.display.from,this.tScale);a.set({left:c,width:u,top:s}),a.setCoords()}),this.requestRenderAll(),this.resumeEventListeners()}cloneActiveTrackItem(e){const t=e?.trackItemId||this.activeIds[0];if(!t)return!1;const s={...this.trackItemsMap[t],id:Yt()},i=this.tracks.find(d=>d.items.includes(t)),a=this.tracks.findIndex(d=>d.id===i?.id)+1;this.findOrCreateTrack(s,{trackIndex:a});const c=Td(s,{tScale:this.tScale});c&&this.add(c);const{audioData:u,...h}=s.metadata||{};s.metadata=h,this.trackItemsMap[s.id]=s,this.trackItemIds.push(s.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}splitActiveTrackItem(e){const t=e.trackItemId??this.activeIds[0];if(!t||this.activeIds.length>1)return!1;const n=this.trackItemsMap[t],s=e.time;if(n.display.from>=s||n.display.to<=s)return!1;const i={...n,display:{from:n.display.from,to:s}},a={...n,display:{from:s,to:n.display.to},id:Yt()};if(n.type==="video"||n.type==="audio"){const d=s-i.display.from;i.trim={from:n.trim.from,to:n.trim.from+d},a.trim={from:i.trim.to,to:n.trim.to}}const c=this.getObjects().find(d=>d.id===t);c.display=i.display,this.tracks.find(d=>d.items.includes(t))?.items.push(a.id);const h=Td(a,{tScale:this.tScale});h&&this.add(h),this.trackItemsMap[a.id]=a,this.trackItemsMap[t]=i,this.trackItemIds.push(a.id),this.updateTrackItemCoords(i.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}updateTrackItemCoords(e){const t=this.getObjects().find(a=>a.id===e),n=this.trackItemsMap[e],s=Lt(n.display.from,this.tScale),i=Lt(n.display.to-n.display.from,this.tScale);t?.set({left:s,width:i}),t?.setCoords()}updateTrackItemDetails(e,t){const n=t?.trackItemId;if(!n)return!1;const s=this.trackItemsMap[n],i={...s.details,...e.details};("fontSize"in i||"lineHeight"in i)&&(i.height=Ta(i.text,i)),this.trackItemsMap[n]={...s,...e,details:i},this.updateState()}updateTrackItem(e,t){const n=t.trackItemId;if(!n)return!1;const s=this.trackItemsMap[n],i={...s.details,...e.details};if(s.type==="text"&&e.details.text){const a=this.getObjects("Text").find(c=>c.id===n);a instanceof rg&&(a.text=e.details.text,this.requestRenderAll())}("fontSize"in i||"lineHeight"in i)&&(i.height=Ta(i.text,i)),this.trackItemsMap[n]={...s,...e,details:i},this.updateState()}updateTrackItemsDetails(e,t){t?.trackItemIds?.forEach((n,s)=>{const i=this.trackItemsMap[n],a={...i.details,...e[s].details};("fontSize"in a||"lineHeight"in a)&&(a.height=Ta(a.text,a)),this.trackItemsMap[n]={...i,...e[s],details:a}}),this.updateState()}getTrackItems(){return this.getObjects(...G6)}setActiveTrackItemCoords(){this.getActiveObjects().forEach(e=>e.setCoords())}deleteTrackItemById(e){const t=this.getObjects().filter(n=>e.includes(n.id));this.tracks=Aa(this.tracks,e),this.trackItemsMap=Object.keys(this.trackItemsMap).filter(n=>!e.includes(n)).reduce((n,s)=>(n[s]=this.trackItemsMap[s],n),{}),this.trackItemIds=this.trackItemIds.filter(n=>!e.includes(n)),this.discardActiveObject(),this.remove(...t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=Tn(this.trackItemsMap)}selectTrackItemByIds(e){const t=this.getActiveObjects().map(s=>s.id);if(st.isEqual(t,e))return;const n=this.getTrackItems().filter(s=>e.includes(s.id));if(n.length===0)this.discardActiveObject();else if(n.length===1)this.setActiveObject(n[0]);else{const s=new jn(n);this.setActiveObject(s)}this.requestRenderAll()}}const G6=["Image","Text","Video","Audio","Caption","Template"],Td=(r,e)=>{const n={text:Lx,video:jx,image:Rx,audio:Dx}[r.type];return n(r,e)},ro={text:32,image:40,video:40,audio:32,main:40},Sy=r=>{switch(r){case"text":return ro.text;case"image":return ro.image;case"video":return ro.video;case"audio":return ro.audio;case"helperTop":return 40;case"helperBottom":return 40;case"helperCenter":return 8;case"main":return ro.main;default:return ro.text}};class $x{findOrCreateTrack(e,{trackId:t,trackIndex:n}){const s=t;if(s){const a=this.tracks.find(c=>c.id===s);if(a)return a.items.push(e.id),s}const i={id:Yt(),items:[e.id],type:e.type,accepts:this.acceptsMap?.[e.type]};return n!==void 0?this.tracks.splice(n,0,i):this.tracks.push(i),this.renderTracks(),i.id}removeTracks(){this.getObjects("Track","Helper")?.forEach(e=>this.remove(e))}renderTracks(){this.updateTracksState(),this.removeTracks();const e=this.width,t=this.tracks.flatMap(c=>[c,{id:`after-${c.id}`,type:"helper",items:[],accepts:[]}]).slice(0,-1);let n=0;const s=le.getClass("Helper")||Lo,i=new s({id:"helperLineTop",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"top",metadata:{}});n+=Sy("helperTop"),this.insertAt(0,i),t.forEach((c,u)=>{if(c.type==="helper"){const h=Sy("helperCenter"),d=new s({id:c.id,top:n,tScale:this.tScale,width:e,height:h,metadata:{order:(u+1)/2},kind:"center"});n+=h,this.insertAt(0,d)}else{const h=le.getClass("Track")||Rs,d=new h({id:c.id,top:n,left:0,fill:"#18181b",height:42,width:e,tScale:this.tScale,accepts:this.acceptsMap?.[c.type]||[],items:c.items});n+=42,this.insertAt(0,d)}});const a=new s({id:"helperLineBottom",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"bottom",metadata:{}});this.insertAt(0,a)}updateTracksState(){const e=this.tracks.filter(n=>n.items.length||n.type==="main"),t=new Map;e.forEach(n=>t.set(n.id,n)),this.tracks=Array.from(t.values())}updateTrackCoords(){const e=this.bounding.width+this.spacing.right;this.getObjects("Track","Helper").forEach(t=>{t.updateCoords(e),t.setCoords()})}}const q6=60,K6=188;function Cy(r,e=1,t=1){const n=K6*e;return r*(q6/1e3)*n/t}class Yx{removeTransitions(){const e=this.getObjects("Transition");this.remove(...e)}renderTransitions(){this.removeTransitions(),this.transitionIds.forEach(e=>{const t=this.transitionsMap[e],n=t.fromId,s=t.toId,i=this.getObjects(),a=i.find(g=>g.id===n),c=i.find(g=>g.id===s);if(!a||!c)return;const u=Cy(t.duration,this.tScale),h=a.left+a.width-u/2,d=a.height,p=new ln({id:t.id,left:h,top:a.top,height:d,width:u,tScale:this.tScale,duration:t.duration,fromId:a.id,toId:c.id,kind:t.kind});t.kind==="none"&&(p.visible=!1),this.add(p)})}updateTransitionCoordinates(){this.pauseEventListeners(),this.getObjects("Transition").forEach(e=>{e.tScale=this.tScale,e.updateCoords(),e.setCoords()}),this.resumeEventListeners()}alignTransitionsToTrack(){this.pauseEventListeners(),this.transitionIds.forEach(e=>{const t=this.getObjects("Transition").find(n=>n.id===e);if(t instanceof ln){const n=this.getObjects().find(a=>a.id===t.fromId);if(!n)return;const s=Cy(t.duration,this.tScale),i=n.left+n.width-s/2;t.set({left:i,top:n.top}),t.setCoords()}}),this.resumeEventListeners()}updateTransitions(e=!0){e&&this.pauseEventListeners();const t=this.getObjects("Track"),n=this.getObjects("Video","Image");this.removeTransitions();const s={},i=[];t.forEach(a=>{const c=n.filter(u=>a.items.includes(u.id)).sort((u,h)=>u.left-h.left);for(let u=0;u<c.length-1;u++){const h=c[u],d=c[u+1];if(Math.abs(h.left+h.width-d.left)<=1){const p=`${h.id}-${d.id}`;if(this.transitionIds.includes(p))s[p]=this.transitionsMap[p];else{const g={id:p,duration:1500,fromId:h.id,toId:d.id,kind:"none",trackId:a.id,type:"transition"};s[p]=g}i.push(p)}}}),this.transitionIds=i,this.transitionsMap=s,this.renderTransitions(),e&&this.resumeEventListeners()}}const ie={canvas:null,enableGuideRedraw:!0,isPointerOverHelperTrack:!1,draggingOverTrack:null,primaryMovingObjects:[],secondaryMovingObjects:[],placeholderMovingObjects:[],objectInitialPositions:{},originTrack:{},trackToItemsMap:{},activeTrackToItemsMap:{},trackTopToIdMap:{},trackTops:[],activeObjects:[],primaryTracks:{},secondaryTracks:{}},Ot={guide:null,object:null,objects:[]},Z6=()=>ie,J6=r=>{Object.assign(ie,r)},Q6=r=>{r.on("before:transform",Xx.bind(r))},eF=r=>{r.off("before:transform",Xx.bind(r))};function Xx(r){ie.canvas=this,ie.activeTrackToItemsMap={},ie.primaryTracks={},ie.secondaryTracks={},ie.trackTops=[],ie.trackToItemsMap={},ie.activeObjects=[],ie.trackTopToIdMap={},ie.canvas.trackIdAfterTransform="",ie.canvas.positionAfterTransform={};const e=ie.canvas.getActiveObject();if(!e)return;ie.activeObjects=e instanceof jn?e.getObjects():[e];const t=ie.canvas.getScenePoint(r.e),n=ie.canvas.getObjects("Track");ie.originTrack=n.find(a=>{const c=a.getBoundingRect();return t.x>=c.left&&t.x<=c.left+c.width&&t.y>=c.top&&t.y<=c.top+c.height})??{};const s=ie.canvas.getObjects("Video","Image","Audio","Text","Element");n.forEach(a=>{const c=s.filter(u=>a.items.includes(u.id));ie.trackToItemsMap[a.id]=c,ie.trackTopToIdMap[a.top]=a.id,ie.trackTops.push(a.top)}),ie.trackTops.sort((a,c)=>a-c),ie.activeObjects.forEach(a=>{const c=n?.find(h=>h.items.includes(a.id));if(!c)return;const u=c.id;ie.activeTrackToItemsMap[u]?ie.activeTrackToItemsMap[u].push(a):ie.activeTrackToItemsMap[u]=[a]}),ie.primaryMovingObjects=ie.activeObjects.filter(a=>{const c=a.getBoundingRect();return t.y>=c.top&&t.y<=c.top+c.height&&!(a instanceof ln)}),ie.primaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=ie.trackTopToIdMap[c];if(ie.primaryTracks[u])ie.primaryTracks[u].objects.push(a);else{const h=kf(ie.trackTops,ie.originTrack.top,c);if(typeof h!="number")return;ie.primaryTracks[u]={objects:[a],index:h}}}),ie.primaryMovingObjects=ie.primaryMovingObjects.sort((a,c)=>a.left-c.left),ie.secondaryMovingObjects=ie.activeObjects.filter(a=>!ie.primaryMovingObjects.includes(a)&&!(a instanceof ln)),ie.secondaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=ie.trackTopToIdMap[a.getBoundingRect().top];if(ie.secondaryTracks[u])ie.secondaryTracks[u].objects.push(a);else{const h=kf(ie.trackTops,ie.originTrack.top,c);if(typeof h!="number")return;ie.secondaryTracks[u]={objects:[a],index:h}}}),ie.originTrack&&(ie.canvas.trackOriginBeforeTransform=ie.originTrack.id),e&&(ie.canvas.positionBeforeTransform={top:e.top,left:e.left}),("transform"in r?r.transform:{}).action==="drag"&&(ie.placeholderMovingObjects=ie.primaryMovingObjects.map(a=>{const c=a.getBoundingRect();ie.objectInitialPositions[a.id]={top:c.top,left:c.left};const u=new mo({id:`${a.id}-placeholder`,left:c.left,top:c.top,width:c.width,height:c.height,for:tF[a.type]});return u.draggedObject=a,u}),ie.canvas.add(...ie.placeholderMovingObjects))}function kf(r,e,t){const n=r.indexOf(e),s=r.indexOf(t);return n===-1||s===-1?null:s-n}const tF={trackitemvideo:"video",trackitemimage:"image",trackitemaudio:"audio",trackitemtext:"text"};function Gx(r){if(!Ot.guide)return!1;r.e.preventDefault();const e=this,t=e.getViewportPoint(r.e);Ot.guide.set({left:t.x-16,top:t.y-Ot.guide.height/2});const n=rF(t,Ot.objects);n&&(Ot.object=n,n.strokeDashArray=[5,1],n.setSelected(!0)),Ot.objects.forEach(s=>{s!==n&&s.setSelected(!1)}),e.requestRenderAll()}function rF(r,e){let t=1/0,n=null;const s=new $(r.x,r.y);return e.forEach(i=>{const a=nF(i,s);a<t&&(t=a,n=i)}),n}function nF(r,e){return Math.sqrt(Math.pow(r.left-e.x,2)+Math.pow(r.top-e.y,2))}const sF=["transition","image","video","audio","caption","text"];function qx(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(e),{type:n,duration:s=5e3}=t;if(!sF.includes(n))return;const i=this;i.discardActiveObject();const a=Lt(s,i.tScale);Ot.guide=iF({width:a,height:48,id:"TransitionGuide",left:0,top:0,type:n}),i.add(Ot.guide),n==="transition"&&(Ot.objects=i.getObjects("Transition"),Ot.objects.forEach(c=>{c.visible=!0})),Ze.dispatch(Qf)}function iF({width:r,height:e,id:t,left:n,top:s,type:i}){return i==="transition"?new Fa({top:0,left:0,height:48,width:48,id:"TransitionGuide"}):new Na({top:s,left:n,height:e,width:r,id:t,name:"Rivers in the mountains"})}function Kx(){if(!Ot.guide)return;Ze.dispatch(Oa);const r=this;oF(Ot.objects),r.remove(Ot.guide)}function oF(r){r.forEach(e=>{e.strokeDashArray=[],e.setSelected(!1),e.kind==="none"&&(e.visible=!1)})}var aF=typeof global=="object"&&global&&global.Object===Object&&global,cF=typeof self=="object"&&self&&self.Object===Object&&self,ng=aF||cF||Function("return this")(),js=ng.Symbol,Zx=Object.prototype,lF=Zx.hasOwnProperty,uF=Zx.toString,ha=js?js.toStringTag:void 0;function hF(r){var e=lF.call(r,ha),t=r[ha];try{r[ha]=void 0;var n=!0}catch{}var s=uF.call(r);return n&&(e?r[ha]=t:delete r[ha]),s}var dF=Object.prototype,fF=dF.toString;function pF(r){return fF.call(r)}var gF="[object Null]",mF="[object Undefined]",Ty=js?js.toStringTag:void 0;function sg(r){return r==null?r===void 0?mF:gF:Ty&&Ty in Object(r)?hF(r):pF(r)}function ig(r){return r!=null&&typeof r=="object"}var vF="[object Symbol]";function og(r){return typeof r=="symbol"||ig(r)&&sg(r)==vF}function yF(r,e){for(var t=-1,n=r==null?0:r.length,s=Array(n);++t<n;)s[t]=e(r[t],t,r);return s}var rc=Array.isArray,Ey=js?js.prototype:void 0,ky=Ey?Ey.toString:void 0;function Jx(r){if(typeof r=="string")return r;if(rc(r))return yF(r,Jx)+"";if(og(r))return ky?ky.call(r):"";var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function Kl(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function bF(r){return r}var wF="[object AsyncFunction]",_F="[object Function]",xF="[object GeneratorFunction]",SF="[object Proxy]";function CF(r){if(!Kl(r))return!1;var e=sg(r);return e==_F||e==xF||e==wF||e==SF}var Ed=ng["__core-js_shared__"],Oy=function(){var r=/[^.]+$/.exec(Ed&&Ed.keys&&Ed.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function TF(r){return!!Oy&&Oy in r}var EF=Function.prototype,kF=EF.toString;function OF(r){if(r!=null){try{return kF.call(r)}catch{}try{return r+""}catch{}}return""}var AF=/[\\^$.*+?()[\]{}|]/g,IF=/^\[object .+?Constructor\]$/,MF=Function.prototype,PF=Object.prototype,DF=MF.toString,RF=PF.hasOwnProperty,jF=RegExp("^"+DF.call(RF).replace(AF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function LF(r){if(!Kl(r)||TF(r))return!1;var e=CF(r)?jF:IF;return e.test(OF(r))}function FF(r,e){return r?.[e]}function ag(r,e){var t=FF(r,e);return LF(t)?t:void 0}function NF(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var BF=800,VF=16,HF=Date.now;function zF(r){var e=0,t=0;return function(){var n=HF(),s=VF-(n-t);if(t=n,s>0){if(++e>=BF)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function WF(r){return function(){return r}}var Zl=function(){try{var r=ag(Object,"defineProperty");return r({},"",{}),r}catch{}}(),UF=Zl?function(r,e){return Zl(r,"toString",{configurable:!0,enumerable:!1,value:WF(e),writable:!0})}:bF,$F=zF(UF),YF=9007199254740991,XF=/^(?:0|[1-9]\d*)$/;function Qx(r,e){var t=typeof r;return e=e??YF,!!e&&(t=="number"||t!="symbol"&&XF.test(r))&&r>-1&&r%1==0&&r<e}function GF(r,e,t){e=="__proto__"&&Zl?Zl(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}function eS(r,e){return r===e||r!==r&&e!==e}var qF=Object.prototype,KF=qF.hasOwnProperty;function ZF(r,e,t){var n=r[e];(!(KF.call(r,e)&&eS(n,t))||t===void 0&&!(e in r))&&GF(r,e,t)}var Ay=Math.max;function JF(r,e,t){return e=Ay(e===void 0?r.length-1:e,0),function(){for(var n=arguments,s=-1,i=Ay(n.length-e,0),a=Array(i);++s<i;)a[s]=n[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=n[s];return c[e]=t(a),NF(r,this,c)}}var QF=9007199254740991;function e8(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=QF}var t8="[object Arguments]";function Iy(r){return ig(r)&&sg(r)==t8}var tS=Object.prototype,r8=tS.hasOwnProperty,n8=tS.propertyIsEnumerable,rS=Iy(function(){return arguments}())?Iy:function(r){return ig(r)&&r8.call(r,"callee")&&!n8.call(r,"callee")},s8=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i8=/^\w*$/;function o8(r,e){if(rc(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||og(r)?!0:i8.test(r)||!s8.test(r)||e!=null&&r in Object(e)}var Ba=ag(Object,"create");function a8(){this.__data__=Ba?Ba(null):{},this.size=0}function c8(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var l8="__lodash_hash_undefined__",u8=Object.prototype,h8=u8.hasOwnProperty;function d8(r){var e=this.__data__;if(Ba){var t=e[r];return t===l8?void 0:t}return h8.call(e,r)?e[r]:void 0}var f8=Object.prototype,p8=f8.hasOwnProperty;function g8(r){var e=this.__data__;return Ba?e[r]!==void 0:p8.call(e,r)}var m8="__lodash_hash_undefined__";function v8(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Ba&&e===void 0?m8:e,this}function bi(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}bi.prototype.clear=a8;bi.prototype.delete=c8;bi.prototype.get=d8;bi.prototype.has=g8;bi.prototype.set=v8;function y8(){this.__data__=[],this.size=0}function Fu(r,e){for(var t=r.length;t--;)if(eS(r[t][0],e))return t;return-1}var b8=Array.prototype,w8=b8.splice;function _8(r){var e=this.__data__,t=Fu(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():w8.call(e,t,1),--this.size,!0}function x8(r){var e=this.__data__,t=Fu(e,r);return t<0?void 0:e[t][1]}function S8(r){return Fu(this.__data__,r)>-1}function C8(r,e){var t=this.__data__,n=Fu(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}function Fo(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Fo.prototype.clear=y8;Fo.prototype.delete=_8;Fo.prototype.get=x8;Fo.prototype.has=S8;Fo.prototype.set=C8;var T8=ag(ng,"Map");function E8(){this.size=0,this.__data__={hash:new bi,map:new(T8||Fo),string:new bi}}function k8(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function Nu(r,e){var t=r.__data__;return k8(e)?t[typeof e=="string"?"string":"hash"]:t.map}function O8(r){var e=Nu(this,r).delete(r);return this.size-=e?1:0,e}function A8(r){return Nu(this,r).get(r)}function I8(r){return Nu(this,r).has(r)}function M8(r,e){var t=Nu(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}function Di(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Di.prototype.clear=E8;Di.prototype.delete=O8;Di.prototype.get=A8;Di.prototype.has=I8;Di.prototype.set=M8;var P8="Expected a function";function cg(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(P8);var t=function(){var n=arguments,s=e?e.apply(this,n):n[0],i=t.cache;if(i.has(s))return i.get(s);var a=r.apply(this,n);return t.cache=i.set(s,a)||i,a};return t.cache=new(cg.Cache||Di),t}cg.Cache=Di;var D8=500;function R8(r){var e=cg(r,function(n){return t.size===D8&&t.clear(),n}),t=e.cache;return e}var j8=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,L8=/\\(\\)?/g,F8=R8(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(j8,function(t,n,s,i){e.push(s?i.replace(L8,"$1"):n||t)}),e});function N8(r){return r==null?"":Jx(r)}function Bu(r,e){return rc(r)?r:o8(r,e)?[r]:F8(N8(r))}function lg(r){if(typeof r=="string"||og(r))return r;var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function B8(r,e){e=Bu(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[lg(e[t++])];return t&&t==n?r:void 0}function V8(r,e){for(var t=-1,n=e.length,s=r.length;++t<n;)r[s+t]=e[t];return r}var My=js?js.isConcatSpreadable:void 0;function H8(r){return rc(r)||rS(r)||!!(My&&r&&r[My])}function z8(r,e,t,n,s){var i=-1,a=r.length;for(t||(t=H8),s||(s=[]);++i<a;){var c=r[i];t(c)?V8(s,c):s[s.length]=c}return s}function W8(r){var e=r==null?0:r.length;return e?z8(r):[]}function U8(r){return $F(JF(r,void 0,W8),r+"")}function $8(r,e){return r!=null&&e in Object(r)}function Y8(r,e,t){e=Bu(e,r);for(var n=-1,s=e.length,i=!1;++n<s;){var a=lg(e[n]);if(!(i=r!=null&&t(r,a)))break;r=r[a]}return i||++n!=s?i:(s=r==null?0:r.length,!!s&&e8(s)&&Qx(a,s)&&(rc(r)||rS(r)))}function X8(r,e){return r!=null&&Y8(r,e,$8)}function G8(r,e,t,n){if(!Kl(r))return r;e=Bu(e,r);for(var s=-1,i=e.length,a=i-1,c=r;c!=null&&++s<i;){var u=lg(e[s]),h=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(s!=a){var d=c[u];h=void 0,h===void 0&&(h=Kl(d)?d:Qx(e[s+1])?[]:{})}ZF(c,u,h),c=c[u]}return r}function q8(r,e,t){for(var n=-1,s=e.length,i={};++n<s;){var a=e[n],c=B8(r,a);t(c,a)&&G8(i,Bu(a,r),c)}return i}function K8(r,e){return q8(r,e,function(t,n){return X8(r,n)})}var Z8=U8(function(r,e){return r==null?{}:K8(r,e)});function nS(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(r.e.dataTransfer.getData(e)),n=this;if(t.type!=="transition"){J8(t),n.remove(Ot.guide),n.requestRenderAll(),Ze.dispatch(Oa);return}Ot.guide&&(Ot.object&&Q8(t,n),Ot.objects.forEach(s=>{s.strokeDashArray=[],s.setSelected(!1),s.kind==="none"&&(s.visible=!1)}),n.remove(Ot.guide),n.requestRenderAll(),Ze.dispatch(Oa))}function J8(r){const e={...r,id:Yt()};switch(r.type){case"image":Ze.dispatch(xo,{payload:e});break;case"video":Ze.dispatch(wo,{payload:e});break;case"audio":Ze.dispatch(_o,{payload:e});break}}function Q8(r,e){const t=Ot.object?.id,n=Z8(r,["kind","direction"]);Object.entries(n).forEach(([s,i])=>{s==="kind"?Ot.object.kind=i:Ot.object[s]=i}),e.transitionsMap[t]={...e.transitionsMap[t],...n},e.updateState()}const e7=r=>{r.on("dragover",Gx),r.on("dragenter",qx),r.on("dragleave",Kx),r.on("drop",nS)},t7=r=>{r.off("dragover",Gx),r.off("dragenter",qx),r.off("dragleave",Kx),r.off("drop",nS)},sS=r=>{const e=r.target.canvas,t=r.target;if(r.action==="resizing"&&t instanceof ln&&e){const n=t.id,s=e.getObjects("Transition").find(i=>i.id===n);if(s&&s instanceof ln){const i=st.cloneDeep(e.transitionsMap),a={...i,[n]:{...i[n],width:s.width,duration:s.duration}};e.transitionsMap=a,e.updateState()}}e&&(r7(e,e.getObjects()),n7(e.getObjects("Helper")),ie.isPointerOverHelperTrack=!1,ie.draggingOverTrack=null)},r7=(r,e)=>{e.forEach(t=>{t.isAlignmentAuxiliary&&r.remove(t)})},n7=r=>{r.forEach(e=>e.setSelected(!1))};function iS(r){const e=r.target.canvas;if(!e)return;const t=e.getActiveObject();if(!t||!e.positionBeforeTransform)return;const n=e.getScenePoint(r.e),s=e.getObjects("Track","Helper").find(i=>{const a=i.getBoundingRect();return n.x>=a.left&&n.x<=a.left+a.width&&n.y>=a.top&&n.y<=a.top+a.height});if(r.action==="resizing"){const i=(ie.trackToItemsMap[ie.originTrack.id]||[]).filter(c=>c!==t);t.setCoords();const a=Vu(i,t.getBoundingRect());return e.fire("track-items:resized",{trackId:ie.originTrack.id,trackItemIds:[t.id],isOverlapped:!!a}),!1}if(!s)return t&&(t?.set(e.positionBeforeTransform),t?.setCoords()),!1;if(s instanceof Lo){let i;switch(s.kind){case"top":i=0;break;case"center":i=s.metadata.order||0;break;case"bottom":i=-1;break;default:return}const a={isSecondaryOverlapped:!1,secondaryTracks:ie.secondaryTracks,primaryTracks:ie.primaryTracks,primaryPositions:{trackIndex:i,trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};a7(a)}else if(s instanceof Rs){const i={isSecondaryOverlapped:i7(),secondaryTracks:ie.secondaryTracks,primaryTracks:ie.primaryTracks,primaryPositions:{trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};s7(i)}}const s7=r=>{ie.canvas&&ie.canvas.fire("track-items:moved",r)};function i7(){const r=o7();return Object.keys(r).some(e=>{const t=ie.trackToItemsMap[e],n=r[e].objects;return t?.length?t.filter(s=>!n.includes(s)).some(s=>Vu(n,s.getBoundingRect())):!0})}function o7(){const[r]=ie.primaryMovingObjects,e=r.id,n=ie.canvas.positionAfterTransform[e].top-r.getBoundingRect().top,s={};return ie.secondaryMovingObjects.forEach(i=>{const a=i.getBoundingRect().top+n,c=ie.trackTopToIdMap[a],u=kf(ie.trackTops,ie.originTrack.top,a);s[c]?s[c].objects.push(i):s[c]={objects:[i],index:u}}),s}const a7=r=>{ie.canvas&&ie.canvas.fire("track:create",r)};function Vu(r,e){return r.find(t=>{const n=t.getBoundingRect();return e.left<n.left+n.width&&e.left+e.width>n.left&&e.top<n.top+n.height&&e.top+e.height>n.top})}const c7=r=>{r.on("object:modified",sS),r.on("object:modified",iS)},l7=r=>{r.off("object:modified",sS),r.off("object:modified",iS)};function u7(r,e){r.remove(...e),e.length=0}function oS(){u7(this,ie.placeholderMovingObjects)}function aS(r){const e=this.height<this.bounding.height,t=this.width<this.bounding.width;if(!e&&!t)return;const n=this.viewportTransform;let s=n[4],i=n[5];const a=2;r.e.shiftKey?s=n[4]-r.e.deltaY*a:(e&&(i=n[5]-r.e.deltaY*a),s=n[4]-r.e.deltaX*a),this.setViewportPos(s,i)}const h7=r=>{r.on("mouse:wheel",aS),r.on("mouse:up",oS.bind(r))},d7=r=>{r.off("mouse:wheel",aS),r.off("mouse:up",oS.bind(r))};function cS(r){const e=this;if(!e)return;const t=e.getScenePoint(r.e),n=e.getObjects("Helper","Track");ie.draggingOverTrack=n.find(h=>{const d=h.getBoundingRect();return t.x>=d.left&&t.x<=d.left+d.width&&t.y>=d.top&&t.y<=d.top+d.height})??null,n.forEach(h=>{if(Dy(h)){const d=ie.draggingOverTrack;h.setSelected(h===d)}}),ie.isPointerOverHelperTrack=Dy(ie.draggingOverTrack),e.getObjects();const s=r.target;s.getBoundingRect(),s.setCoords();const i=[s,...e.getActiveObjects(),...e.getObjects("Track","Helper","Transition","Placeholder")],a=f7(i,e),c=g7(s);p7(a,c).forEach(h=>{h.orientation==="V"?s.left=h.lineGuide+h.offset:s.top=h.lineGuide+h.offset})}const f7=(r,e)=>{const t=[],n=[];return e.getObjects().filter(s=>s.visible).forEach(s=>{if(r.some(c=>c.id===s.id)||s.isAlignmentAuxiliary)return;const a=s.getBoundingRect();t.push(Py(a.left,a.width,a.top,a.height)),n.push(Py(a.top,a.height,a.left,a.width))}),{vertical:t.flat(),horizontal:[]}},Py=(r,e,t,n)=>[r,r+e].map(s=>({val:s,start:t,end:t+n})),p7=(r,e)=>{const t=[],n=[];r.vertical.forEach(u=>{e.vertical.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&t.push({lineGuide:u.val,diff:d,orientation:"V",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})}),r.horizontal.forEach(u=>{e.horizontal.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&n.push({lineGuide:u.val,diff:d,orientation:"H",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})});const i=[],a=t.sort((u,h)=>u.diff-h.diff)[0],c=n.sort((u,h)=>u.diff-h.diff)[0];return a&&i.push({lineGuide:a.lineGuide,offset:a.offset,orientation:"V",snap:a.snap,targetDim:a.targetDim}),c&&i.push({lineGuide:c.lineGuide,offset:c.offset,orientation:"H",snap:c.snap,targetDim:c.targetDim}),i},g7=r=>{const e=r.getBoundingRect();return{vertical:[{guide:Math.round(e.left),offset:Math.round(r.left-e.left),snap:"start"},{guide:Math.round(e.left+e.width),offset:Math.round(r.left-e.left-e.width),snap:"end"}],horizontal:[{guide:Math.round(e.top),offset:Math.round(r.top-e.top),snap:"start"},{guide:Math.round(e.top+e.height),offset:Math.round(r.top-e.top-e.height),snap:"end"}]}},Dy=r=>r instanceof Lo;function m7(r){r.opacity=ie.isPointerOverHelperTrack?0:1}const lS=S7(r=>{const e=r.target.canvas;if(C7(r),!ie.draggingOverTrack)return;const t=ie.placeholderMovingObjects.map(i=>i.draggedObject),n=(ie.trackToItemsMap[ie.draggingOverTrack.id]||[]).filter(i=>!t.includes(i)),s=n.find(i=>Vu(t,i.getBoundingRect()));ie.placeholderMovingObjects.forEach(i=>{const a=i.draggedObject;a?.setCoords(),m7(i);const c=v7(a,n,s,ie.placeholderMovingObjects.length>1);e.trackIdAfterTransform=ie.trackTopToIdMap[c.top],e.positionAfterTransform[a?.id]={top:c.top,left:c.left},i.left=c.left,i.top=c.top})},5),v7=(r,e,t,n)=>!y7(r)||n&&t?uS(r):t?b7(r,t,e):x7(r),y7=r=>ie.draggingOverTrack?ie.draggingOverTrack.accepts?.includes(r.type)??!1:!1,uS=r=>({top:ie.objectInitialPositions[r.id].top,left:ie.objectInitialPositions[r.id].left}),b7=(r,e,t)=>{const n=w7(r,e);return!_7(t,r,n)||ie.activeObjects.length!==1?uS(r):{left:n,top:e.top}},w7=(r,e)=>{const t=r.left+r.width/2,n=e.left+e.width/2;return t<n?e.left-r.width:e.left+e.width},_7=(r,e,t)=>!(t<0||Vu(r,{...e.getBoundingRect(),left:t})),x7=r=>({left:r.getBoundingRect().left,top:ie.draggingOverTrack?.top??0});function S7(r,e){let t=null;return function(...n){const s=Date.now();(t===null||s-t>=e)&&(t=s,r(...n))}}function C7(r){const e=r.target,t=e.canvas,n=e.top,s=-e.height*.75,i=t.height+e.height*.75;e.top=Math.min(Math.max(n,s),i-e.height);const a=e.left;e.left=Math.max(a,0)}const T7=r=>{r.on("object:moving",cS.bind(r)),r.on("object:moving",lS)},E7=r=>{r.off("object:moving",cS.bind(r)),r.off("object:moving",lS)};function hS(){const r=this,e=r.getActiveObject(),t=r.getActiveObjects().map(n=>n.id);e instanceof an?(e.borderColor="rgba(0, 216, 214, 0.75)",e.hasControls=!1,e.hoverCursor="default",e.borderScaleFactor=1,e.padding=0,e.getObjects().forEach(n=>{n.setSelected(!0)})):e?.setSelected(!0),this.setActiveIds(t)}function dS(r){const e=this,t=e.getActiveObject();t instanceof an&&(t.borderColor="transparent",t.hasControls=!1,t.hoverCursor="default"),r.selected.forEach(s=>{s.setSelected(!0)}),r.deselected.forEach(s=>{s.setSelected(!1)});const n=e.getActiveObjects().map(s=>s.id);this.setActiveIds(n)}function fS(r){this.getObjects().forEach(t=>{t.isSelected&&(t.isSelected=!1)}),r.deselected.forEach(t=>{t.setSelected(!1)});const e=this.getActiveObjects().map(t=>t.id);this.setActiveIds(e)}const k7=r=>{r.on("selection:created",hS),r.on("selection:updated",dS),r.on("selection:cleared",fS)},O7=r=>{r.off("selection:created",hS),r.off("selection:updated",dS),r.off("selection:cleared",fS)};let pS,gS,mS;const A7=r=>{const{state:e}=r;pS=e.subscribeToActiveIds(({activeIds:t})=>{if(t.length===1){const n=t[0],{trackItemIds:s,trackItemsMap:i}=e.getState();s.forEach(a=>{i[a].type}),r.selectTrackItemByIds([n])}else r.selectTrackItemByIds(t)}),gS=e.subscribeToHistory(t=>{const{tracks:n,trackItemsMap:s,trackItemIds:i,trackItemDetailsMap:a}=t;r.tracks=n,r.trackItemsMap=s,r.trackItemIds=i,r.trackItemDetailsMap=a,r.renderTracks(),r.updateTrackItemsToHistory(),r.alignItemsToTrack(),r.calcBounding(),r.updateTransitions(),r.duration=Tn(r.trackItemsMap)}),mS=e.subscribeToAddOrRemoveItems(()=>{const t=r.getTrackItems().map(c=>c.id),{trackItemIds:n,trackItemsMap:s,trackItemDetailsMap:i}=e.getState(),a=[];t.forEach(c=>{n.includes(c)||a.push(c)}),r.deleteTrackItemById(a),r.tracks=e.getState().tracks,r.trackItemsMap=s,r.trackItemDetailsMap=i,n.forEach(c=>{if(!t.includes(c)){const u={...s[c],details:{...i[c].details}};r.addTrackItem(u)}}),r.renderTracks(),r.alignItemsToTrack(),n.forEach(c=>{r.updateTrackItemCoords(c)}),r.updateTransitions(),r.updateTrackCoords()})},I7=r=>{pS.unsubscribe(),gS.unsubscribe(),mS.unsubscribe()};function vS(r){const{isSecondaryOverlapped:e,secondaryTracks:t,primaryTracks:n,primaryPositions:s}=r,{trackId:i,positions:a}=s,c=this.tracks.findIndex(v=>v.id===i),u=ip(Object.keys(t).map(v=>t[v].objects.map(b=>b.id))),h=Aa(this.tracks,[...Object.keys(a),...u]);Object.keys(n).forEach(v=>{this.pauseEventListeners();const{objects:b}=n[v];b.forEach(C=>{const T=a[C.id];C.left=T.left}),this.resumeEventListeners();const x=h.find(C=>C.id===i);x&&x.items.push(...Object.keys(a)),this.tracks=h});const d=this.tracks[c],p=[];Object.keys(t).forEach(v=>{const{objects:b,index:x}=t[v],C=b.map(A=>A.id),[T]=C,k=this.trackItemsMap[T];if(e){const A={id:Yt(),items:C,type:k.type,accepts:this.acceptsMap?.[k.type],tempIndex:x};p.push(A)}else{const A=h[c+x];A&&A.items.push(...C),this.tracks=h}});const g=op(d,p);g.length&&h.splice(c,1,...g),this.tracks=h,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}function yS({trackItemIds:r,isOverlapped:e}){const[t]=r;if(t){if(!this.getObjects("Transition").find(n=>n.id===t)){const n=this.tracks.find(s=>s.items.includes(t));if(e){const s=M7(this.tracks,r),i={id:Yt(),items:[t],type:n?.type,accepts:n?.accepts},a=this.tracks.findIndex(c=>c.id===n?.id);s.splice(a,0,i),this.tracks=s}}this.renderTracks(),this.alignItemsToTrack(),this.alignTransitionsToTrack(),this.updateTransitions(),this.updateTrackItemsPosition(),this.updateState({updateHistory:!0,kind:"update"})}}function M7(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}function bS(r){const{secondaryTracks:e,primaryTracks:t,primaryPositions:n}=r,{positions:s,trackIndex:i}=n,a=i===-1?this.tracks.length:i,[c]=Object.keys(t),u=this.tracks.find(x=>x.id==c),h=t[c],d={id:Yt(),items:h.objects.map(x=>x.id),type:u?.type,accepts:u?.accepts},p=ip(Object.keys(e).map(x=>e[x].objects.map(C=>C.id))),g=Aa(this.tracks,[...Object.keys(s),...p]),v=[];Object.keys(e).forEach(x=>{const{objects:C,index:T}=e[x],k=this.tracks.find(D=>D.id==x),A=C.map(D=>D.id),I={id:Yt(),items:A,type:k?.type,accepts:k?.accepts,tempIndex:T};v.push(I)});const b=op(d,v);b.length&&g.splice(a,0,...b),this.tracks=g,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}const P7=r=>{r.on("track:create",bS.bind(r)),r.on("track-items:resized",yS.bind(r)),r.on("track-items:moved",vS.bind(r))},D7=r=>{r.off("track:create",bS.bind(r)),r.off("track-items:resized",yS.bind(r)),r.off("track-items:moved",vS.bind(r))},wS=r=>{e7(r),c7(r),h7(r),T7(r),P7(r),k7(r),Q6(r),A7(r)},_S=r=>{t7(r),l7(r),d7(r),E7(r),D7(r),O7(r),eF(r),I7()},R7={video:["*"],image:["*"],audio:["*"],text:["*"]},j7=["video","image","audio","text"];let Hu=class extends Sf{acceptsMap;tracks=[];trackItemsMap={};trackItemIds=[];transitionIds=[];transitionsMap={};trackItemDetailsMap={};bounding;onScroll;tScale;store;state;activeIds=[];spacing;scale;sizesMap;duration;setupFabricDefaults(){ht.ownDefaults.borderColor="transparent",ht.ownDefaults.cornerColor="white",ht.ownDefaults.cornerStrokeColor="transparent",ht.ownDefaults.strokeWidth=0,ht.ownDefaults.borderOpacityWhenMoving=1,ht.ownDefaults.borderScaleFactor=1,ht.ownDefaults.cornerSize=8,ht.ownDefaults.cornerStyle="rect",ht.ownDefaults.centeredScaling=!1,ht.ownDefaults.centeredRotation=!0,ht.ownDefaults.transparentCorners=!1}constructor(e,t){super(e,t),this.bounding=t.bounding||{width:t.width||0,height:t.height||0},this.spacing={left:16,right:80,...t.spacing};const n=this.viewportTransform;n[4]=this.spacing.left,this.tScale=t.tScale||1/300,this.store=t.store,this.state=t.state,this.scale=t.scale,this.onScroll=t.onScroll,this.acceptsMap=this.createAcceptsItemMap(t.acceptsMap),this.sizesMap=Nx(t.sizesMap),this.setupFabricDefaults(),this.initEventListeners()}createAcceptsItemMap(e=R7){const t={};return Object.keys(e).forEach(n=>{const s=e[n];t[n]=s.includes("*")?j7:s}),t}setActiveIds(e){this.activeIds=e,this.getObjects("Transition").some(n=>e.includes(n.id))||(this.state?.updateState({activeIds:st.cloneDeep(this.activeIds)}),Ze.dispatch(K1,{payload:{activeIds:this.activeIds}}))}purge(){_S(this),this.dispose()}static registerItems(e){Object.keys(e).forEach(t=>{le.setClass(e[t],t)})}initEventListeners(){wS(this)}getUpdatedState(){const e=Tn(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,scale:this.scale,duration:e}}getState(){const e=Tn(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,trackItemDetailsMap:this.trackItemDetailsMap,scale:this.scale,duration:e}}notify(e={updateHistory:!1}){const t=this.getUpdatedState();this.state.updateState(t,e)}updateState(e){this.updateTracksState(),this.updateTrackItemsState(),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords();const t=this.getUpdatedState();this.state.updateState(t,e)}scrollTo({scrollLeft:e,scrollTop:t}){const n=[...this.viewportTransform];let s=!1;if(typeof e=="number"&&(n[4]=-e+this.spacing.left,s=!0),typeof t=="number"&&(n[5]=-t,s=!0),s){this.viewportTransform=n;const i=this.getActiveObject();i&&i.setCoords(),this.requestRenderAll()}}setBoundingBox(e){this.bounding=e}calcBounding(){const e=this.getTrackItems().reduce((t,n)=>{const{left:s,top:i,width:a,height:c}=n.getBoundingRect();return{left:Math.min(t.left,s),top:Math.min(t.top,i),width:Math.max(t.width,s+a),height:Math.max(t.height,i+c)}},{left:1/0,top:1/0,width:this.width,height:0});this.bounding=e,Ze.dispatch(ep,{payload:{bounding:e}})}setScale(e){this.pauseEventListeners(),this.tScale=e.zoom,this.scale=e;const t=this.getState();this.getObjects("Video","Image","Text","Audio").forEach(n=>{const s=t.trackItemsMap[n.id],{from:i,to:a}=s.display,c=Lt(i,this.tScale),u=Lt(a-i,this.tScale,n.playbackRate);n.set({left:c,width:u,tScale:e.zoom}),n.setCoords()}),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords(),this.updateTransitions(!1),this.resumeEventListeners(),this.notify()}setViewportPos(e,t){const n=this.getViewportPos(e,t),s=this.viewportTransform;s[4]=n.x,s[5]=n.y,this.requestRenderAll(),this.setActiveTrackItemCoords();const i=this.onScroll;i&&i.call(this,{scrollTop:n.y,scrollLeft:n.x-this.spacing.left})}getViewportPos(e,t){const n=this.bounding.width-100>=this.width?this.spacing.right:0,s=this.width-this.bounding.width-n,i=this.spacing.left,a=Math.max(s,Math.min(e,i));if(this.bounding.height<this.height)return{x:a,y:0};const c=this.height-this.bounding.height-40,u=Math.max(c,Math.min(t,0));return{x:a,y:u}}};Sx(Hu,[yx,Ux,$x,Yx]);function xS(r){const e=Ze.subject.pipe(li(({key:t})=>t.startsWith(J1))).subscribe(t=>{if(t.key===Jf){const n=t.value;r.setScale(n?.payload.scale??void 0)}});return{unsubscribe:()=>{e.unsubscribe()}}}Hu.registerItems({Text:rg,Image:Hx,Video:Vx,Audio:Bx,Track:zx,Helper:Wx});const L7=({stateManager:r})=>{const e=m.useRef(!1),[t,n]=m.useState(0),s=m.useRef(null),i=m.useRef(null),a=m.useRef(null),c=m.useRef(null),u=m.useRef(null),[h,d]=m.useState({width:0,height:0}),[p,g]=m.useState({width:0,height:0}),{scale:v,playerRef:b,fps:x,setState:C,timeline:T}=Os(),{setTimeline:k}=Os(),A=cu(b??void 0),I=B=>{u.current&&c.current&&(c.current.scrollTop=-B.scrollTop,u.current.scrollLeft=-B.scrollLeft,n(-B.scrollLeft))};m.useEffect(()=>{const B=Lt(A/x*1e3,v.zoom),X=i.current?.getBoundingClientRect().x+i.current?.clientWidth;if(B-t+40>=X){const Z=u.current?.clientWidth,G=u.current?.scrollWidth,K=u.current?.scrollLeft,ve=(G-(Z+K))/Z;ve>=0&&(ve>1?u.current?.scrollTo({left:K+Z}):u.current?.scrollTo({left:G-Z}))}},[A]),m.useEffect(()=>{const B=i.current,X=s.current;if(!B||!X)return;const Y=X.clientWidth,Z=X.clientHeight,G=new Hu(B,{width:Y,height:Z,bounding:{width:Y,height:0},selectionColor:"rgba(0, 216, 214,0.1)",selectionBorderColor:"rgba(0, 216, 214,1.0)",onScroll:I,state:r,scale:v,spacing:{left:au,right:Xd}}),K=xS(G);a.current=G,d({width:Y,height:Z}),g({width:Y,height:0}),k(G);const oe=r.subscribeToSize(z=>{C(z)}),ve=r.subscribeToScale(z=>{C(z)}),Q=r.subscribeToTracks(z=>{C(z)}),ge=r.subscribeToDuration(z=>{C(z)}),de=r.subscribeToUpdateTrackItem(()=>{const z=r.getState();C({duration:z.duration,trackItemsMap:z.trackItemsMap})}),ne=r.subscribeToAddOrRemoveItems(()=>{const z=r.getState();C({trackItemDetailsMap:z.trackItemDetailsMap,trackItemsMap:z.trackItemsMap,trackItemIds:z.trackItemIds,tracks:z.tracks})}),M=r.subscribeToUpdateItemDetails(()=>{const z=r.getState();C({trackItemDetailsMap:z.trackItemDetailsMap})});return()=>{K.unsubscribe(),G.purge(),ve.unsubscribe(),Q.unsubscribe(),ge.unsubscribe(),ne.unsubscribe(),de.unsubscribe(),M.unsubscribe(),oe.unsubscribe()}},[]),m.useEffect(()=>{const X=Ze.subject.pipe(li(({key:Y})=>Y.startsWith(eb))).subscribe(Y=>{if(Y.key===ep){const Z=Y.value?.payload?.bounding;Z&&g({width:Z.width,height:Z.height})}});return()=>{X.unsubscribe()}},[]);const D=B=>{const X=B.currentTarget.scrollLeft;e.current&&a.current.scrollTo({scrollLeft:X}),n(X)},F=B=>{const X=B.currentTarget.scrollTop;e.current&&a.current.scrollTo({scrollTop:X})};m.useEffect(()=>{const B=u.current?.scrollWidth;if(!B||!T)return;const X=T.width;B<X+t&&T.scrollTo({scrollLeft:B-X})},[v]);const U=B=>{if(!a.current)return;const Y=ks(B,v.zoom);b?.current?.seekTo(Y*x/1e3)};return w.jsxs("div",{className:"relative overflow-hidden h-80 w-full",children:[w.jsx(Eb,{}),w.jsx(Fw,{onClick:U,scrollLeft:t}),w.jsx(Lw,{scrollLeft:t}),w.jsxs("div",{className:"flex",children:[w.jsx("div",{className:"relative w-10 flex-none"}),w.jsxs("div",{className:"relative h-[230px] flex-1",children:[w.jsx("div",{ref:s,className:"absolute top-0 h-[230px] w-full text-sm text-white ",children:w.jsx("canvas",{ref:i,id:"designcombo-timeline-canvas"})}),w.jsxs(Ol,{type:"always",style:{position:"absolute",width:"calc(100vw - 40px)",height:"10px"},className:"ScrollAreaRootH",children:[w.jsx(Bd,{onScroll:D,className:"ScrollAreaViewport",id:"viewportH",ref:u,children:w.jsx("div",{style:{width:p.width>h.width?p.width+Xd:p.width},className:"pointer-events-none h-[10px]"})}),w.jsx(Kv,{className:"ScrollAreaScrollbar",orientation:"horizontal",children:w.jsx(Zv,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]}),w.jsxs(Ol,{type:"always",style:{position:"absolute",height:"230px",width:"10px"},className:"ScrollAreaRootV",children:[w.jsx(Bd,{onScroll:F,className:"ScrollAreaViewport",ref:c,children:w.jsx("div",{style:{height:p.height>h.height?p.height+40:h.height},className:"pointer-events-none w-[10px]"})}),w.jsx(Kv,{className:"ScrollAreaScrollbar",orientation:"vertical",children:w.jsx(Zv,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]})]})]})]})},F7={Date:!0,RegExp:!0,String:!0,Number:!0};function SS(r,e,t={cyclesFix:!0},n=[]){let s=[];const i=Array.isArray(r);for(const c in r){const u=r[c],h=i?+c:c;if(!(c in e)){s.push({type:"REMOVE",path:[h],oldValue:r[c]});continue}const d=e[c],p=typeof u=="object"&&typeof d=="object"&&Array.isArray(u)===Array.isArray(d);u&&d&&p&&!F7[Object.getPrototypeOf(u)?.constructor?.name]&&(!t.cyclesFix||!n.includes(u))?s.push.apply(s,SS(u,d,t,t.cyclesFix?n.concat([u]):[]).map(g=>(g.path.unshift(h),g))):u!==d&&!(Number.isNaN(u)&&Number.isNaN(d))&&!(p&&(isNaN(u)?u+""==d+"":+u==+d))&&s.push({path:[h],type:"CHANGE",value:d,oldValue:u})}const a=Array.isArray(e);for(const c in e)c in r||s.push({type:"CREATE",path:[a?+c:c],value:e[c]});return s}var ug=Symbol.for("immer-nothing"),Ea=Symbol.for("immer-draftable"),Yr=Symbol.for("immer-state"),CS=process.env.NODE_ENV!=="production"?[function(r){return`The plugin for '${r}' has not been loaded into Immer. To enable the plugin, import and call \`enable${r}()\` when initializing your application.`},function(r){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${r}'`},"This object has been frozen and should not be mutated",function(r){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+r},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(r){return`'current' expects a draft, got: ${r}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(r){return`'original' expects a draft, got: ${r}`}]:[];function $t(r,...e){if(process.env.NODE_ENV!=="production"){const t=CS[r],n=typeof t=="function"?t.apply(null,e):t;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var wi=Object.getPrototypeOf;function _i(r){return!!r&&!!r[Yr]}function Ls(r){return r?TS(r)||Array.isArray(r)||!!r[Ea]||!!r.constructor?.[Ea]||nc(r)||sc(r):!1}var N7=Object.prototype.constructor.toString();function TS(r){if(!r||typeof r!="object")return!1;const e=wi(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===N7}function Va(r,e){xi(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,n)=>e(n,t,r))}function xi(r){const e=r[Yr];return e?e.type_:Array.isArray(r)?1:nc(r)?2:sc(r)?3:0}function Ha(r,e){return xi(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function kd(r,e){return xi(r)===2?r.get(e):r[e]}function ES(r,e,t){const n=xi(r);n===2?r.set(e,t):n===3?r.add(t):r[e]=t}function B7(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function nc(r){return r instanceof Map}function sc(r){return r instanceof Set}function si(r){return r.copy_||r.base_}function Of(r,e){if(nc(r))return new Map(r);if(sc(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=TS(r);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(r);delete n[Yr];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const a=s[i],c=n[a];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[a]={configurable:!0,writable:!0,enumerable:c.enumerable,value:r[a]})}return Object.create(wi(r),n)}else{const n=wi(r);if(n!==null&&t)return{...r};const s=Object.create(n);return Object.assign(s,r)}}function hg(r,e=!1){return zu(r)||_i(r)||!Ls(r)||(xi(r)>1&&(r.set=r.add=r.clear=r.delete=V7),Object.freeze(r),e&&Object.entries(r).forEach(([t,n])=>hg(n,!0))),r}function V7(){$t(2)}function zu(r){return Object.isFrozen(r)}var Af={};function Si(r){const e=Af[r];return e||$t(0,r),e}function H7(r,e){Af[r]||(Af[r]=e)}var za;function kS(){return za}function z7(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ry(r,e){e&&(Si("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function If(r){Mf(r),r.drafts_.forEach(W7),r.drafts_=null}function Mf(r){r===za&&(za=r.parent_)}function jy(r){return za=z7(za,r)}function W7(r){const e=r[Yr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Ly(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[Yr].modified_&&(If(e),$t(4)),Ls(r)&&(r=Jl(e,r),e.parent_||Ql(e,r)),e.patches_&&Si("Patches").generateReplacementPatches_(t[Yr].base_,r,e.patches_,e.inversePatches_)):r=Jl(e,t,[]),If(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==ug?r:void 0}function Jl(r,e,t){if(zu(e))return e;const n=e[Yr];if(!n)return Va(e,(s,i)=>Fy(r,n,e,s,i,t)),e;if(n.scope_!==r)return e;if(!n.modified_)return Ql(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,a=!1;n.type_===3&&(i=new Set(s),s.clear(),a=!0),Va(i,(c,u)=>Fy(r,n,s,c,u,t,a)),Ql(r,s,!1),t&&r.patches_&&Si("Patches").generatePatches_(n,t,r.patches_,r.inversePatches_)}return n.copy_}function Fy(r,e,t,n,s,i,a){if(process.env.NODE_ENV!=="production"&&s===t&&$t(5),_i(s)){const c=i&&e&&e.type_!==3&&!Ha(e.assigned_,n)?i.concat(n):void 0,u=Jl(r,s,c);if(ES(t,n,u),_i(u))r.canAutoFreeze_=!1;else return}else a&&t.add(s);if(Ls(s)&&!zu(s)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;Jl(r,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&Ql(r,s)}}function Ql(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&hg(e,t)}function U7(r,e){const t=Array.isArray(r),n={type_:t?1:0,scope_:e?e.scope_:kS(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=dg;t&&(s=[n],i=Wa);const{revoke:a,proxy:c}=Proxy.revocable(s,i);return n.draft_=c,n.revoke_=a,c}var dg={get(r,e){if(e===Yr)return r;const t=si(r);if(!Ha(t,e))return $7(r,t,e);const n=t[e];return r.finalized_||!Ls(n)?n:n===Od(r.base_,e)?(Ad(r),r.copy_[e]=Df(n,r)):n},has(r,e){return e in si(r)},ownKeys(r){return Reflect.ownKeys(si(r))},set(r,e,t){const n=OS(si(r),e);if(n?.set)return n.set.call(r.draft_,t),!0;if(!r.modified_){const s=Od(si(r),e),i=s?.[Yr];if(i&&i.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(B7(t,s)&&(t!==void 0||Ha(r.base_,e)))return!0;Ad(r),Pf(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return Od(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,Ad(r),Pf(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=si(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){$t(11)},getPrototypeOf(r){return wi(r.base_)},setPrototypeOf(){$t(12)}},Wa={};Va(dg,(r,e)=>{Wa[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wa.deleteProperty=function(r,e){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(e))&&$t(13),Wa.set.call(this,r,e,void 0)};Wa.set=function(r,e,t){return process.env.NODE_ENV!=="production"&&e!=="length"&&isNaN(parseInt(e))&&$t(14),dg.set.call(this,r[0],e,t,r[0])};function Od(r,e){const t=r[Yr];return(t?si(t):r)[e]}function $7(r,e,t){const n=OS(e,t);return n?"value"in n?n.value:n.get?.call(r.draft_):void 0}function OS(r,e){if(!(e in r))return;let t=wi(r);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=wi(t)}}function Pf(r){r.modified_||(r.modified_=!0,r.parent_&&Pf(r.parent_))}function Ad(r){r.copy_||(r.copy_=Of(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var Y7=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const a=this;return function(u=i,...h){return a.produce(u,d=>t.call(this,d,...h))}}typeof t!="function"&&$t(6),n!==void 0&&typeof n!="function"&&$t(7);let s;if(Ls(e)){const i=jy(this),a=Df(e,void 0);let c=!0;try{s=t(a),c=!1}finally{c?If(i):Mf(i)}return Ry(i,n),Ly(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===ug&&(s=void 0),this.autoFreeze_&&hg(s,!0),n){const i=[],a=[];Si("Patches").generateReplacementPatches_(e,s,i,a),n(i,a)}return s}else $t(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...c)=>this.produceWithPatches(a,u=>e(u,...c));let n,s;return[this.produce(e,t,(a,c)=>{n=a,s=c}),n,s]},typeof r?.autoFreeze=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof r?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){Ls(r)||$t(8),_i(r)&&(r=X7(r));const e=jy(this),t=Df(r,void 0);return t[Yr].isManual_=!0,Mf(e),t}finishDraft(r,e){const t=r&&r[Yr];(!t||!t.isManual_)&&$t(9);const{scope_:n}=t;return Ry(n,e),Ly(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){r=s.value;break}}t>-1&&(e=e.slice(t+1));const n=Si("Patches").applyPatches_;return _i(r)?n(r,e):this.produce(r,s=>n(s,e))}};function Df(r,e){const t=nc(r)?Si("MapSet").proxyMap_(r,e):sc(r)?Si("MapSet").proxySet_(r,e):U7(r,e);return(e?e.scope_:kS()).drafts_.push(t),t}function X7(r){return _i(r)||$t(10,r),AS(r)}function AS(r){if(!Ls(r)||zu(r))return r;const e=r[Yr];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Of(r,e.scope_.immer_.useStrictShallowCopy_)}else t=Of(r,!0);return Va(t,(n,s)=>{ES(t,n,AS(s))}),e&&(e.finalized_=!1),t}function Ny(){process.env.NODE_ENV!=="production"&&CS.push('Sets cannot have "replace" patches.',function(g){return"Unsupported patch operation: "+g},function(g){return"Cannot apply patch, path doesn't resolve: "+g},"Patching reserved attributes like __proto__, prototype and constructor is not allowed");const e="replace",t="add",n="remove";function s(g,v,b,x){switch(g.type_){case 0:case 2:return a(g,v,b,x);case 1:return i(g,v,b,x);case 3:return c(g,v,b,x)}}function i(g,v,b,x){let{base_:C,assigned_:T}=g,k=g.copy_;k.length<C.length&&([C,k]=[k,C],[b,x]=[x,b]);for(let A=0;A<C.length;A++)if(T[A]&&k[A]!==C[A]){const I=v.concat([A]);b.push({op:e,path:I,value:p(k[A])}),x.push({op:e,path:I,value:p(C[A])})}for(let A=C.length;A<k.length;A++){const I=v.concat([A]);b.push({op:t,path:I,value:p(k[A])})}for(let A=k.length-1;C.length<=A;--A){const I=v.concat([A]);x.push({op:n,path:I})}}function a(g,v,b,x){const{base_:C,copy_:T}=g;Va(g.assigned_,(k,A)=>{const I=kd(C,k),D=kd(T,k),F=A?Ha(C,k)?e:t:n;if(I===D&&F===e)return;const U=v.concat(k);b.push(F===n?{op:F,path:U}:{op:F,path:U,value:D}),x.push(F===t?{op:n,path:U}:F===n?{op:t,path:U,value:p(I)}:{op:e,path:U,value:p(I)})})}function c(g,v,b,x){let{base_:C,copy_:T}=g,k=0;C.forEach(A=>{if(!T.has(A)){const I=v.concat([k]);b.push({op:n,path:I,value:A}),x.unshift({op:t,path:I,value:A})}k++}),k=0,T.forEach(A=>{if(!C.has(A)){const I=v.concat([k]);b.push({op:t,path:I,value:A}),x.unshift({op:n,path:I,value:A})}k++})}function u(g,v,b,x){b.push({op:e,path:[],value:v===ug?void 0:v}),x.push({op:e,path:[],value:g})}function h(g,v){return v.forEach(b=>{const{path:x,op:C}=b;let T=g;for(let D=0;D<x.length-1;D++){const F=xi(T);let U=x[D];typeof U!="string"&&typeof U!="number"&&(U=""+U),(F===0||F===1)&&(U==="__proto__"||U==="constructor")&&$t(19),typeof T=="function"&&U==="prototype"&&$t(19),T=kd(T,U),typeof T!="object"&&$t(18,x.join("/"))}const k=xi(T),A=d(b.value),I=x[x.length-1];switch(C){case e:switch(k){case 2:return T.set(I,A);case 3:$t(16);default:return T[I]=A}case t:switch(k){case 1:return I==="-"?T.push(A):T.splice(I,0,A);case 2:return T.set(I,A);case 3:return T.add(A);default:return T[I]=A}case n:switch(k){case 1:return T.splice(I,1);case 2:return T.delete(I);case 3:return T.delete(b.value);default:return delete T[I]}default:$t(17,C)}}),g}function d(g){if(!Ls(g))return g;if(Array.isArray(g))return g.map(d);if(nc(g))return new Map(Array.from(g.entries()).map(([b,x])=>[b,d(x)]));if(sc(g))return new Set(Array.from(g).map(d));const v=Object.create(wi(g));for(const b in g)v[b]=d(g[b]);return Ha(g,Ea)&&(v[Ea]=g[Ea]),v}function p(g){return _i(g)?d(g):g}H7("Patches",{applyPatches_:h,generatePatches_:s,generateReplacementPatches_:u})}var Xr=new Y7,G7=Xr.produce;Xr.produceWithPatches.bind(Xr);Xr.setAutoFreeze.bind(Xr);Xr.setUseStrictShallowCopy.bind(Xr);var q7=Xr.applyPatches.bind(Xr);Xr.createDraft.bind(Xr);Xr.finishDraft.bind(Xr);function K7(r){const e=r.value,t=[];if(e?.payload?.trackItemIds){const n=e.payload.trackItemIds;t.push(n),this.updateState({activeIds:t})}if(r.key===Xf){const n=r.value?.payload.trackItemIds,s=st.cloneDeep(this.getState()),i=n?.length?n:s.activeIds,a=s.trackItemIds.filter(p=>!i.includes(p)),c=Object.fromEntries(Object.entries(s.trackItemDetailsMap).filter(([p])=>!i.includes(p))),u=Ax(s.tracks,i),h=Object.fromEntries(Object.entries(s.trackItemsMap).filter(([p])=>!i.includes(p))),d=Tn(h);this.updateState({trackItemIds:a,trackItemDetailsMap:c,activeIds:[],trackItemsMap:h,tracks:u,duration:d},{updateHistory:!0,kind:"remove"})}if(r.key===Gf){const n=st.cloneDeep(this.getState()),s=[],i=r.value?.payload.trackItemIds||n.activeIds;if(i.length===0)return;i.forEach(c=>{const u=n.trackItemsMap[c],h=n.trackItemDetailsMap[c],d=Yt();s.push(d),n.trackItemsMap={...n.trackItemsMap,[d]:{...st.cloneDeep(u),id:d}},n.trackItemDetailsMap={...n.trackItemDetailsMap,[d]:{...st.cloneDeep(h)}},n.trackItemIds.push(d)});const a=n.tracks.map(c=>{const u={...c,id:Yt(),items:c.items.filter(h=>i.includes(h)).map(h=>{const d=i.indexOf(h);return s[d]})};return u.items.length?u:null}).filter(Boolean);n.tracks.unshift(...a),this.updateState({trackItemDetailsMap:n.trackItemDetailsMap,tracks:n.tracks,trackItemIds:n.trackItemIds,trackItemsMap:n.trackItemsMap},{updateHistory:!0,kind:"update"})}if(r.key===qf){const n=st.cloneDeep(this.getState()),s=r.value?.options.time;if(n.activeIds.length!==1)return;const i=n.activeIds[0],a=n.trackItemsMap[i];if(s<=a.display.from||s>=a.display.to)return;const c=Yt(),u={...a,id:c,display:{from:s,to:a.display.to},trim:{from:s,to:a.display.to}};n.trackItemsMap[i].display.to=s,n.trackItemsMap[c]=u,n.trackItemDetailsMap[c]=n.trackItemDetailsMap[i],n.trackItemIds.push(c),n.tracks.forEach(h=>{h.items.includes(i)&&h.items.push(c)}),this.updateState({trackItemsMap:n.trackItemsMap,trackItemDetailsMap:n.trackItemDetailsMap,trackItemIds:n.trackItemIds,tracks:n.tracks},{updateHistory:!0,kind:"update"})}}async function Z7(r){if(r.key==="scene:load"){const e=r.value?.payload,t=e.size,n=e.trackItemIds,s=e.trackItemsMap,i=e.trackItemDetailsMap;if(!n)return;const a=n?.map(async u=>{try{const h=i[u],d=s[u];if(h.type==="text"){const p=await tg({id:u,details:h.details,...d},{size:t}),{details:g,...v}=p;i[u]={type:"text",details:g},s[u]=v}return!0}catch{return!1}});await Promise.all(a);const c=Tn(s);this.updateState({...e,trackItemsMap:s,duration:c})}}async function J7(r){const e=st.cloneDeep(this.getState()),t=r.value?.options?.trackId,n=r.value?.options?.trackIndex;let s=[],i;if(r.key===wo){i="video";const c=await Mx(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===xo){i="image";const c=await Ix(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===_o){i="audio";const c=await Px(r.value?.payload),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===Yf){i="text";const{details:c,...u}=await tg(r.value?.payload??void 0,{size:e.size});e.trackItemDetailsMap[u.id]={type:i,details:c},e.trackItemsMap[u.id]=u,e.trackItemIds.push(u.id),s.push(u.id)}const a=Q7(s,e.tracks,e.trackItemsMap,t,n);if(a.trackId)e.tracks.find(u=>u.id===a.trackId)?.items.push(...s);else if(a.trackIndex!==void 0){const c=By(i,s);e.tracks.splice(a.trackIndex,0,c)}else{const c=By(i,s);e.tracks.unshift(c)}e.duration=Tn(e.trackItemsMap),this.updateState({trackItemIds:e.trackItemIds,trackItemDetailsMap:e.trackItemDetailsMap,trackItemsMap:e.trackItemsMap,tracks:e.tracks,duration:e.duration,structure:e.structure},{updateHistory:!0,kind:"add"})}function By(r,e){return{id:Yt(),accepts:["text","audio","helper","video","image"],type:r,items:e,magnetic:!1,static:!1}}const Q7=(r,e,t,n,s)=>{if(n===void 0&&s===void 0)return{trackId:void 0,trackIndex:void 0};const i=s!==void 0?e[Math.max(0,Math.min(s,e.length-1))]:e.find(u=>u.id===n);if(!i)return{trackId:void 0,trackIndex:s!==void 0?Math.max(0,Math.min(s,e.length-1)):void 0};const a=i.items.map(u=>t[u]),c=r.map(u=>t[u]);for(const u of a){const h=u.display.from,d=u.display.to;for(const p of c){const g=p.display.from;if(!(p.display.to<=h||g>=d))return{trackId:void 0,trackIndex:e.indexOf(i)}}}return{trackId:i.id,trackIndex:e.indexOf(i)}},Vy=["tracks","trackItemsMap","trackItemDetailsMap","transitionIds","transitionsMap","trackItemIds"],eN={size:{width:1080,height:1920},tracks:[],trackItemIds:[],trackItemsMap:{},transitionIds:[],transitionsMap:{},scale:{unit:1,zoom:1,segments:1,index:1},duration:0,activeIds:[],trackItemDetailsMap:{},structure:[]};class tN{stateSubject;stateHistorySubject;prevState;undos;redos;listener;constructor(e){this.stateSubject=null,this.stateHistorySubject=null,this.prevState=null,this.undos=[],this.redos=[],this.listener=null;const t=e||eN;this.stateSubject=new n0(t),this.stateHistorySubject=new n0({handleRedo:!1,handleUndo:!1}),this.prevState=t,this.initListeners()}initListeners(){IS(this)}destroyListeners(){this.listener&&this.listener.unsubscribe()}purge(){this.destroyListeners()}updateHistory(e,t){const n=st.pick(e,Vy),s=st.pick(this.getState(),Vy),i=SS(s,n);i.length&&(this.undos.push({undos:i,type:t}),this.redos=[])}getStateHistory(){return this.stateHistorySubject.getValue()}subscribeHistory(e){return this.stateHistorySubject.subscribe(e)}getState(){return this.stateSubject.getValue()}subscribe(e){return this.stateSubject.subscribe(e)}updateState(e,t={updateHistory:!1,kind:void 0}){const n=this.getState(),s={...n,...e};if(!st.isEqual(n,s)){t.updateHistory&&this.updateHistory(s,t.kind);const{duration:i,trackItemsMap:a,...c}=n;this.prevState={...c,duration:this.prevState.duration,trackItemsMap:this.prevState.trackItemsMap},this.stateSubject.next(s)}}subscribeToSize(e){return this.stateSubject.asObservable().subscribe(t=>{st.isEqual(t.size,this.prevState.size)||e({size:t.size})})}subscribeToScale(e){return this.stateSubject.asObservable().subscribe(t=>{st.isEqual(t.scale,this.prevState.scale)||e({scale:t.scale})})}subscribeToUpdateTrackItem(e){return this.stateSubject.asObservable().subscribe(t=>{st.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||e({trackItemsMap:t.trackItemsMap})})}subscribeToUpdateItemDetails(e){return this.stateSubject.asObservable().subscribe(t=>{st.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap)||e({trackItemDetailsMap:t.trackItemDetailsMap})})}subscribeToDuration(e){return this.stateSubject.asObservable().subscribe(t=>{t.duration!==this.prevState.duration&&e({duration:t.duration})})}subscribeToHistory(e){return this.stateHistorySubject.asObservable().subscribe(t=>{if(t.handleRedo){const n=this.undos[this.undos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}if(t.handleUndo){const n=this.redos[this.redos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}})}subscribeToAddOrRemoveItems(e){return this.stateSubject.asObservable().subscribe(t=>{(!t.trackItemIds?.every(n=>this.prevState.trackItemIds?.includes(n))||!st.isEqual(t.tracks,this.prevState.tracks))&&e({trackItemIds:t.trackItemIds})})}subscribeToActiveIds(e){return this.stateSubject.asObservable().subscribe(t=>{st.isEqual(t.activeIds,this.prevState.activeIds)||e({activeIds:t.activeIds})})}subscribeToTracks(e){return this.stateSubject.asObservable().subscribe(t=>{(!st.isEqual(t.tracks,this.prevState.tracks)||!st.isEqual(t.trackItemIds,this.prevState.trackItemIds)||!st.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||!st.isEqual(t.transitionIds,this.prevState.transitionIds)||!st.isEqual(t.transitionsMap,this.prevState.transitionsMap)||!st.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap))&&e({tracks:t.tracks,trackItemIds:t.trackItemIds,trackItemsMap:t.trackItemsMap,transitionIds:t.transitionIds,transitionsMap:t.transitionsMap,trackItemDetailsMap:t.trackItemDetailsMap})})}undo(){const e=this.undos.pop(),t=e?.undos,n=e?.type;if(!t||!n)return;Ny();const{trackItemDetailsMap:s,trackItemIds:i,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}=this.getState(),d=st.cloneDeep({trackItemDetailsMap:s,trackItemIds:i,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}),p=[],g=[],v=[],b=[],x=[],C=[];t.forEach(G=>{let K;const oe=G.path.slice(1);G.type==="CREATE"?K={path:oe,op:"remove",value:G.value}:G.type==="CHANGE"?K={path:oe,op:"replace",value:G.oldValue}:K={path:oe,op:"add",value:G.oldValue},G.path.includes("trackItemIds")?v.push(K):G.path.includes("transitionIds")?g.push(K):G.path.includes("trackItemsMap")?x.push(K):G.path.includes("transitionsMap")?b.push(K):G.path.includes("tracks")?p.push(K):G.path.includes("trackItemDetailsMap")&&C.push(K)});const T=this.applyPatch(d.tracks,p),k=this.applyPatch(d.transitionIds,g),A=this.applyPatch(d.trackItemIds,v),I=this.applyPatch(d.transitionsMap,b),D=this.applyPatch(d.trackItemsMap,x),F=this.applyPatch(d.trackItemDetailsMap,C),U=st.cloneDeep({tracks:T,transitionIds:k,trackItemIds:A,transitionsMap:I,trackItemsMap:D,trackItemDetailsMap:F}),B=st.cloneDeep(this.getState()),X={...B,...U};this.prevState=B;const Y={redos:t,type:n};this.redos.push(Y);const Z=Tn(X.trackItemsMap);this.stateSubject.next({...X,duration:Z}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!0})}redo(){const e=this.redos.pop();if(!e?.redos||!e?.type)return;Ny();const t=this.getState(),{trackItemDetailsMap:n,trackItemIds:s,tracks:i,transitionIds:a,transitionsMap:c,trackItemsMap:u}=t,h=st.cloneDeep({trackItemDetailsMap:n,trackItemIds:s,tracks:i,transitionIds:a,transitionsMap:c,trackItemsMap:u}),d=[],p=[],g=[],v=[],b=[],x=[];e.redos.forEach(I=>{const D=I.path.slice(1);let F={};switch(I.type){case"CREATE":F={path:D,op:"add",value:I.value};break;case"CHANGE":F={path:D,op:"replace",value:I.value};break;case"REMOVE":F={path:D,op:"remove",value:I.oldValue};break;default:return null}I.path.includes("trackItemIds")?g.push(F):I.path.includes("transitionIds")?p.push(F):I.path.includes("trackItemsMap")?b.push(F):I.path.includes("transitionsMap")?v.push(F):I.path.includes("trackItemDetailsMap")?x.push(F):d.push(F)});const C={tracks:this.applyPatch(h.tracks,d),transitionIds:this.applyPatch(h.transitionIds,p),trackItemIds:this.applyPatch(h.trackItemIds,g),transitionsMap:this.applyPatch(h.transitionsMap,v),trackItemsMap:this.applyPatch(h.trackItemsMap,b),trackItemDetailsMap:this.applyPatch(h.trackItemDetailsMap,x)},T=st.cloneDeep(C),k={...st.cloneDeep(t),...T};this.prevState=t,this.undos.push({undos:e.redos,type:e.type});const A=Tn(k.trackItemsMap);this.stateSubject.next({...k,duration:A}),this.stateHistorySubject.next({handleRedo:!0,handleUndo:!1})}applyPatch(e,t){return t.reverse().reduce((n,s)=>G7(n,i=>{q7(i,[s])}),e)}}function IS(r){const e=Ze.subject.pipe(li(({key:i})=>i.startsWith(Z1))).subscribe(i=>{i.key===Kf&&r.undo(),i.key===Zf&&r.redo()}),t=Ze.subject.pipe(li(({key:i,value:a})=>i.startsWith(Y1))).subscribe(i=>{J7.bind(r)(i)}),n=Ze.subject.pipe(li(({key:i,value:a})=>i.startsWith("scene"))).subscribe(async i=>{await Z7.bind(r)(i)}),s=Ze.subject.pipe(li(({key:i})=>i.startsWith(q1))).subscribe(async i=>{K7.bind(r)(i)});return()=>{e.unsubscribe(),t.unsubscribe(),s.unsubscribe(),n.unsubscribe()}}exports.ACTIVE_CLONE=Gf;exports.ACTIVE_DELETE=Xf;exports.ACTIVE_PASTE=t5;exports.ACTIVE_PREFIX=q1;exports.ACTIVE_SET=e5;exports.ACTIVE_SPLIT=qf;exports.ADD_ANIMATION=WM;exports.ADD_AUDIO=_o;exports.ADD_IMAGE=xo;exports.ADD_MASK=HM;exports.ADD_PLACEHOLDER=VM;exports.ADD_PREFIX=Y1;exports.ADD_SUFFIX=DM;exports.ADD_TEXT=Yf;exports.ADD_TRANSITION=zM;exports.ADD_VIDEO=wo;exports.AUDIOS=kb;exports.Audio=Bx;exports.AudioObject=is;exports.BASE_TIMELINE_ELEMENT_DURATION_MS=G5;exports.Button=hr;exports.CanvasMixin=yx;exports.DEFAULT_AUDIO_BITRATE=J5;exports.DEFAULT_AUDIO_SAMPLE_RATE=Z5;exports.DEFAULT_BLUR=BP;exports.DEFAULT_BLUR_STEP=NP;exports.DEFAULT_BRIGHTNESS=bP;exports.DEFAULT_BRIGHTNESS_STEP=yP;exports.DEFAULT_CONTRAST=MP;exports.DEFAULT_CONTRAST_STEP=IP;exports.DEFAULT_FADE_IN=cP;exports.DEFAULT_FADE_OUT=lP;exports.DEFAULT_FADE_STEP=aP;exports.DEFAULT_FLIP_X=pP;exports.DEFAULT_FLIP_Y=gP;exports.DEFAULT_FONT=Gd;exports.DEFAULT_FRAMERATE=hb;exports.DEFAULT_MAX_BLUR=FP;exports.DEFAULT_MAX_BRIGHTNESS=vP;exports.DEFAULT_MAX_CONTRAST=AP;exports.DEFAULT_MAX_FADE=oP;exports.DEFAULT_MAX_OPACITY=DP;exports.DEFAULT_MAX_ROTATION=hP;exports.DEFAULT_MAX_SATURATION=_P;exports.DEFAULT_MAX_SPEED=HP;exports.DEFAULT_MAX_TEMPERATURE=TP;exports.DEFAULT_MAX_VOLUME=$P;exports.DEFAULT_MEDIA_PANEL_WIDTH=rP;exports.DEFAULT_MIN_BLUR=LP;exports.DEFAULT_MIN_BRIGHTNESS=mP;exports.DEFAULT_MIN_CONTRAST=OP;exports.DEFAULT_MIN_FADE=iP;exports.DEFAULT_MIN_OPACITY=PP;exports.DEFAULT_MIN_ROTATION=uP;exports.DEFAULT_MIN_SATURATION=wP;exports.DEFAULT_MIN_SPEED=VP;exports.DEFAULT_MIN_TEMPERATURE=CP;exports.DEFAULT_MIN_VOLUME=UP;exports.DEFAULT_OPACITY=jP;exports.DEFAULT_OPACITY_STEP=RP;exports.DEFAULT_PREVIEW_HEIGHT=eP;exports.DEFAULT_PREVIEW_SCALE=np;exports.DEFAULT_PREVIEW_WIDTH=Q5;exports.DEFAULT_ROTATION=fP;exports.DEFAULT_ROTATION_STEP=dP;exports.DEFAULT_SATURATION=SP;exports.DEFAULT_SATURATION_STEP=xP;exports.DEFAULT_SETTINGS_PANEL_WIDTH=sP;exports.DEFAULT_SPEED=WP;exports.DEFAULT_SPEED_STEP=zP;exports.DEFAULT_TEMPERATURE=kP;exports.DEFAULT_TEMPERATURE_STEP=EP;exports.DEFAULT_VIDEO_HEIGHT=ub;exports.DEFAULT_VIDEO_MAX_BITRATE=K5;exports.DEFAULT_VIDEO_MIN_BITRATE=q5;exports.DEFAULT_VIDEO_WIDTH=lb;exports.DEFAULT_VOLUME=XP;exports.DEFAULT_VOLUME_STEP=YP;exports.DEFAULT_WEIGHT=X5;exports.DRAG_END=Oa;exports.DRAG_PREFIX=Q1;exports.DRAG_START=Qf;exports.Draggable=$a;exports.DroppableArea=ob;exports.EDIT_OBJECT=$M;exports.EDIT_PREFIX=UM;exports.EDIT_SHAPE=XM;exports.EDIT_TEXT=YM;exports.ENTER_EDIT_MODE=GM;exports.FRAME_INTERVAL=db;exports.GIANT_ICON_SIZE=V5;exports.HISTORY_PREFIX=Z1;exports.HISTORY_REDO=Zf;exports.HISTORY_RESET=m5;exports.HISTORY_UNDO=Kf;exports.Header=Eb;exports.Helper=Wx;exports.HelperObject=Lo;exports.IMAGES=Ob;exports.Image=Hx;exports.ImageObject=ju;exports.LARGER_FONT_SIZE=U5;exports.LARGE_FONT_SIZE=$5;exports.LARGE_ICON_SIZE=H5;exports.LAYER_CLONE=d5;exports.LAYER_COPY=u5;exports.LAYER_CUT=p5;exports.LAYER_DELETE=g5;exports.LAYER_EDITING_NAME=l5;exports.LAYER_HIDDEN=s5;exports.LAYER_LOCKED=n5;exports.LAYER_MOVE=i5;exports.LAYER_PASTE=h5;exports.LAYER_PREFIX=r5;exports.LAYER_RENAME=c5;exports.LAYER_SELECT=o5;exports.LAYER_SELECTION=K1;exports.LAYER_SEND_TO=a5;exports.LAYER_SPLIT=f5;exports.MAX_MEDIA_PANEL_WIDTH=nP;exports.MIN_MEDIA_PANEL_WIDTH=tP;exports.MenuItem=OD;exports.NORMAL_FONT_SIZE=Y5;exports.NORMAL_ICON_SIZE=z5;exports.NavbarComponent=AD;exports.PLAYER_PAUSE=G1;exports.PLAYER_PLAY=X1;exports.PLAYER_PREFIX=qM;exports.PLAYER_SEEK=KM;exports.PLAYER_SEEK_BY=JM;exports.PLAYER_SEEK_TO=ZM;exports.PLAYER_TOGGLE_PLAY=QM;exports.PREVIEW_FRAME_WIDTH=Ya;exports.Placeholder=mo;exports.Player=jw;exports.PlayheadComponent=Lw;exports.PreviewTrackItem=Na;exports.RulerComponent=Fw;exports.SECONDARY_FONT=cb;exports.SMALL_FONT_SIZE=ab;exports.SMALL_ICON_SIZE=W5;exports.STATE_CHANGED=BM;exports.STATE_PREFIX=NM;exports.Scene=gj;exports.SceneBoard=B5;exports.ScrollArea=Ci;exports.ScrollBar=zf;exports.SequenceItem=Mw;exports.Slider=f1;exports.StateManager=tN;exports.TIMELINE_BOUNDING_CHANGED=ep;exports.TIMELINE_OFFSET_CANVAS_LEFT=au;exports.TIMELINE_OFFSET_CANVAS_RIGHT=Xd;exports.TIMELINE_OFFSET_X=Ml;exports.TIMELINE_PREFIX=eb;exports.TIMELINE_SCALE_CHANGED=Jf;exports.TIMELINE_SCALE_PREFIX=J1;exports.TIMELINE_ZOOM_LEVELS=wn;exports.TRACKS_CHANGED=LM;exports.TRACK_ITEMS_CHANGED=FM;exports.TRACK_ITEMS_PREFIX=jM;exports.TRACK_PREFIX=RM;exports.TRANSITIONS=Ib;exports.Tabs=$1;exports.TabsContent=Il;exports.TabsList=$f;exports.TabsTrigger=Al;exports.Text=rg;exports.TextObject=yi;exports.Timeline=Hu;exports.TimelineComponent=L7;exports.Track=zx;exports.TrackItemsMixin=Ux;exports.TrackObject=Rs;exports.TracksMixin=$x;exports.Transition=ln;exports.TransitionGuide=Fa;exports.TransitionsMixin=Yx;exports.UPLOADS=gD;exports.VIDEOS=Ab;exports.Video=Vx;exports.VideoObject=Pi;exports.addEventListeners=wS;exports.applyMixins=Sx;exports.buttonVariants=Ky;exports.calculateDisplayRange=Ox;exports.calculateDuration=Tn;exports.calculatePosition=Lu;exports.calculateTimelineWidth=xb;exports.calculateTrim=kx;exports.cn=Fs;exports.createAudioControls=_x;exports.createControls=xx;exports.createMediaControls=wx;exports.createResizeControls=Qp;exports.defaultColor=tc;exports.defaultSizes=Fx;exports.filterAndCleanTracks=Ax;exports.findIndex=sp;exports.formatBytes=OI;exports.formatTimeToHumanReadable=GP;exports.formatTimelineUnit=fb;exports.frameToTimeString=pb;exports.getCurrentTime=mb;exports.getFitZoomLevel=qP;exports.getMovingState=Z6;exports.getNextZoom=bb;exports.getNextZoomIndex=_b;exports.getNextZoomLevel=wb;exports.getOffset=Ue;exports.getPreviousZoom=yb;exports.getPreviousZoomIndex=ZP;exports.getPreviousZoomLevel=vb;exports.getTextHeight=Ta;exports.getZoomByIndex=KP;exports.handleEvents=xS;exports.handleResize=La;exports.loadAudio=Cx;exports.loadAudioItem=Px;exports.loadAudioObject=Dx;exports.loadFonts=Sb;exports.loadImage=Tx;exports.loadImageItem=Ix;exports.loadImageObject=Rx;exports.loadTextItem=tg;exports.loadTextObject=Lx;exports.loadVideo=Ex;exports.loadVideoItem=Mx;exports.loadVideoObject=jx;exports.mergeSizes=Nx;exports.mergeTrackObjects=ip;exports.movingState=ie;exports.positionOffsets=bx;exports.randomInt=JP;exports.removeEventListeners=_S;exports.removeItemsFromTrack=Aa;exports.renderControl=cs;exports.reorderTracksByIndex=op;exports.setupHistoryListeners=IS;exports.timeMsToUnits=Lt;exports.timeToString=gb;exports.transitionStore=Ot;exports.unitsToTimeMs=ks;exports.updateMovingState=J6;exports.useCurrentPlayerFrame=cu;exports.useIsDraggingOverTimeline=Xa;exports.useLayoutStore=ap;exports.useStore=Os;exports.wrapResizeWithAnchorPosition=eg;
