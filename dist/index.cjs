"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const v=require("react"),ad=require("react-dom");function EA(r){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(r){for(const t in r)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return e.default=r,Object.freeze(e)}const H=EA(v);var Io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kA(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var cd={exports:{}},Ao={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yv;function IA(){if(yv)return Ao;yv=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var c in s)c!=="key"&&(i[c]=s[c])}else i=s;return s=i.ref,{$$typeof:r,type:n,key:a,ref:s!==void 0?s:null,props:i}}return Ao.Fragment=e,Ao.jsx=t,Ao.jsxs=t,Ao}var Oo={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv;function AA(){return bv||(bv=1,process.env.NODE_ENV!=="production"&&function(){function r(M){if(M==null)return null;if(typeof M=="function")return M.$$typeof===ie?null:M.displayName||M.name||null;if(typeof M=="string")return M;switch(M){case F:return"Fragment";case D:return"Portal";case L:return"Profiler";case z:return"StrictMode";case U:return"Suspense";case X:return"SuspenseList"}if(typeof M=="object")switch(typeof M.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),M.$$typeof){case W:return(M.displayName||"Context")+".Provider";case Y:return(M._context.displayName||"Context")+".Consumer";case q:var ce=M.render;return M=M.displayName,M||(M=ce.displayName||ce.name||"",M=M!==""?"ForwardRef("+M+")":"ForwardRef"),M;case te:return ce=M.displayName||null,ce!==null?ce:r(M.type)||"Memo";case de:ce=M._payload,M=M._init;try{return r(M(ce))}catch{}}return null}function e(M){return""+M}function t(M){try{e(M);var ce=!1}catch{ce=!0}if(ce){ce=console;var ae=ce.error,Ae=typeof Symbol=="function"&&Symbol.toStringTag&&M[Symbol.toStringTag]||M.constructor.name||"Object";return ae.call(ce,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",Ae),e(M)}}function n(){}function s(){if(je===0){we=console.log,Se=console.info,ot=console.warn,tr=console.error,Rt=console.group,Ct=console.groupCollapsed,rr=console.groupEnd;var M={configurable:!0,enumerable:!0,value:n,writable:!0};Object.defineProperties(console,{info:M,log:M,warn:M,error:M,group:M,groupCollapsed:M,groupEnd:M})}je++}function i(){if(je--,je===0){var M={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:re({},M,{value:we}),info:re({},M,{value:Se}),warn:re({},M,{value:ot}),error:re({},M,{value:tr}),group:re({},M,{value:Rt}),groupCollapsed:re({},M,{value:Ct}),groupEnd:re({},M,{value:rr})})}0>je&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function a(M){if(pe===void 0)try{throw Error()}catch(ae){var ce=ae.stack.trim().match(/\n( *(at )?)/);pe=ce&&ce[1]||"",dr=-1<ae.stack.indexOf(`
    at`)?" (<anonymous>)":-1<ae.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pe+M+dr}function c(M,ce){if(!M||Qe)return"";var ae=Pt.get(M);if(ae!==void 0)return ae;Qe=!0,ae=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var Ae=null;Ae=se.H,se.H=null,s();try{var Ge={DetermineComponentFrameRoot:function(){try{if(ce){var sr=function(){throw Error()};if(Object.defineProperty(sr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(sr,[])}catch($t){var on=$t}Reflect.construct(M,[],sr)}else{try{sr.call()}catch($t){on=$t}M.call(sr.prototype)}}else{try{throw Error()}catch($t){on=$t}(sr=M())&&typeof sr.catch=="function"&&sr.catch(function(){})}}catch($t){if($t&&on&&typeof $t.stack=="string")return[$t.stack,on.stack]}return[null,null]}};Ge.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var We=Object.getOwnPropertyDescriptor(Ge.DetermineComponentFrameRoot,"name");We&&We.configurable&&Object.defineProperty(Ge.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ye=Ge.DetermineComponentFrameRoot(),et=ye[0],nr=ye[1];if(et&&nr){var mt=et.split(`
`),pr=nr.split(`
`);for(ye=We=0;We<mt.length&&!mt[We].includes("DetermineComponentFrameRoot");)We++;for(;ye<pr.length&&!pr[ye].includes("DetermineComponentFrameRoot");)ye++;if(We===mt.length||ye===pr.length)for(We=mt.length-1,ye=pr.length-1;1<=We&&0<=ye&&mt[We]!==pr[ye];)ye--;for(;1<=We&&0<=ye;We--,ye--)if(mt[We]!==pr[ye]){if(We!==1||ye!==1)do if(We--,ye--,0>ye||mt[We]!==pr[ye]){var Hr=`
`+mt[We].replace(" at new "," at ");return M.displayName&&Hr.includes("<anonymous>")&&(Hr=Hr.replace("<anonymous>",M.displayName)),typeof M=="function"&&Pt.set(M,Hr),Hr}while(1<=We&&0<=ye);break}}}finally{Qe=!1,se.H=Ae,i(),Error.prepareStackTrace=ae}return mt=(mt=M?M.displayName||M.name:"")?a(mt):"",typeof M=="function"&&Pt.set(M,mt),mt}function u(M){if(M==null)return"";if(typeof M=="function"){var ce=M.prototype;return c(M,!(!ce||!ce.isReactComponent))}if(typeof M=="string")return a(M);switch(M){case U:return a("Suspense");case X:return a("SuspenseList")}if(typeof M=="object")switch(M.$$typeof){case q:return M=c(M.render,!1),M;case te:return u(M.type);case de:ce=M._payload,M=M._init;try{return u(M(ce))}catch{}}return""}function h(){var M=se.A;return M===null?null:M.getOwner()}function d(M){if(he.call(M,"key")){var ce=Object.getOwnPropertyDescriptor(M,"key").get;if(ce&&ce.isReactWarning)return!1}return M.key!==void 0}function p(M,ce){function ae(){Ze||(Ze=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",ce))}ae.isReactWarning=!0,Object.defineProperty(M,"key",{get:ae,configurable:!0})}function g(){var M=r(this.type);return Tt[M]||(Tt[M]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),M=this.props.ref,M!==void 0?M:null}function y(M,ce,ae,Ae,Ge,We){return ae=We.ref,M={$$typeof:A,type:M,key:ce,props:We,_owner:Ge},(ae!==void 0?ae:null)!==null?Object.defineProperty(M,"ref",{enumerable:!1,get:g}):Object.defineProperty(M,"ref",{enumerable:!1,value:null}),M._store={},Object.defineProperty(M._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(M,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.freeze&&(Object.freeze(M.props),Object.freeze(M)),M}function b(M,ce,ae,Ae,Ge,We){if(typeof M=="string"||typeof M=="function"||M===F||M===L||M===z||M===U||M===X||M===J||typeof M=="object"&&M!==null&&(M.$$typeof===de||M.$$typeof===te||M.$$typeof===W||M.$$typeof===Y||M.$$typeof===q||M.$$typeof===De||M.getModuleId!==void 0)){var ye=ce.children;if(ye!==void 0)if(Ae)if($e(ye)){for(Ae=0;Ae<ye.length;Ae++)_(ye[Ae],M);Object.freeze&&Object.freeze(ye)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else _(ye,M)}else ye="",(M===void 0||typeof M=="object"&&M!==null&&Object.keys(M).length===0)&&(ye+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),M===null?Ae="null":$e(M)?Ae="array":M!==void 0&&M.$$typeof===A?(Ae="<"+(r(M.type)||"Unknown")+" />",ye=" Did you accidentally export a JSX literal instead of a component?"):Ae=typeof M,console.error("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Ae,ye);if(he.call(ce,"key")){ye=r(M);var et=Object.keys(ce).filter(function(mt){return mt!=="key"});Ae=0<et.length?"{key: someKey, "+et.join(": ..., ")+": ...}":"{key: someKey}",wn[ye+Ae]||(et=0<et.length?"{"+et.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Ae,ye,et,ye),wn[ye+Ae]=!0)}if(ye=null,ae!==void 0&&(t(ae),ye=""+ae),d(ce)&&(t(ce.key),ye=""+ce.key),"key"in ce){ae={};for(var nr in ce)nr!=="key"&&(ae[nr]=ce[nr])}else ae=ce;return ye&&p(ae,typeof M=="function"?M.displayName||M.name||"Unknown":M),y(M,ye,We,Ge,h(),ae)}function _(M,ce){if(typeof M=="object"&&M&&M.$$typeof!==Un){if($e(M))for(var ae=0;ae<M.length;ae++){var Ae=M[ae];S(Ae)&&T(Ae,ce)}else if(S(M))M._store&&(M._store.validated=1);else if(M===null||typeof M!="object"?ae=null:(ae=le&&M[le]||M["@@iterator"],ae=typeof ae=="function"?ae:null),typeof ae=="function"&&ae!==M.entries&&(ae=ae.call(M),ae!==M))for(;!(M=ae.next()).done;)S(M.value)&&T(M.value,ce)}}function S(M){return typeof M=="object"&&M!==null&&M.$$typeof===A}function T(M,ce){if(M._store&&!M._store.validated&&M.key==null&&(M._store.validated=1,ce=k(ce),!fr[ce])){fr[ce]=!0;var ae="";M&&M._owner!=null&&M._owner!==h()&&(ae=null,typeof M._owner.tag=="number"?ae=r(M._owner.type):typeof M._owner.name=="string"&&(ae=M._owner.name),ae=" It was passed a child from "+ae+".");var Ae=se.getCurrentStack;se.getCurrentStack=function(){var Ge=u(M.type);return Ae&&(Ge+=Ae()||""),Ge},console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',ce,ae),se.getCurrentStack=Ae}}function k(M){var ce="",ae=h();return ae&&(ae=r(ae.type))&&(ce=`

Check the render method of \``+ae+"`."),ce||(M=r(M))&&(ce=`

Check the top-level render call using <`+M+">."),ce}var I=v,A=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),W=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),le=Symbol.iterator,ie=Symbol.for("react.client.reference"),se=I.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=Object.prototype.hasOwnProperty,re=Object.assign,De=Symbol.for("react.client.reference"),$e=Array.isArray,je=0,we,Se,ot,tr,Rt,Ct,rr;n.__reactDisabledLog=!0;var pe,dr,Qe=!1,Pt=new(typeof WeakMap=="function"?WeakMap:Map),Un=Symbol.for("react.client.reference"),Ze,Tt={},wn={},fr={};Oo.Fragment=F,Oo.jsx=function(M,ce,ae,Ae,Ge){return b(M,ce,ae,!1,Ae,Ge)},Oo.jsxs=function(M,ce,ae,Ae,Ge){return b(M,ce,ae,!0,Ae,Ge)}}()),Oo}process.env.NODE_ENV==="production"?cd.exports=IA():cd.exports=AA();var w=cd.exports;function wv(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function vy(...r){return e=>{let t=!1;const n=r.map(s=>{const i=wv(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():wv(r[s],null)}}}}function Zt(...r){return H.useCallback(vy(...r),r)}var Li=H.forwardRef((r,e)=>{const{children:t,...n}=r,s=H.Children.toArray(t),i=s.find(MA);if(i){const a=i.props.children,c=s.map(u=>u===i?H.Children.count(a)>1?H.Children.only(null):H.isValidElement(a)?a.props.children:null:u);return w.jsx(ld,{...n,ref:e,children:H.isValidElement(a)?H.cloneElement(a,void 0,c):null})}return w.jsx(ld,{...n,ref:e,children:t})});Li.displayName="Slot";var ld=H.forwardRef((r,e)=>{const{children:t,...n}=r;if(H.isValidElement(t)){const s=DA(t),i=PA(n,t.props);return t.type!==H.Fragment&&(i.ref=e?vy(e,s):s),H.cloneElement(t,i)}return H.Children.count(t)>1?H.Children.only(null):null});ld.displayName="SlotClone";var OA=({children:r})=>w.jsx(w.Fragment,{children:r});function MA(r){return H.isValidElement(r)&&r.type===OA}function PA(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...c)=>{i(...c),s(...c)}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function DA(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var RA=Li;function yy(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=yy(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function by(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=yy(r))&&(n&&(n+=" "),n+=e);return n}const xv=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,_v=by,jA=(r,e)=>t=>{var n;if(e?.variants==null)return _v(r,t?.class,t?.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(h=>{const d=t?.[h],p=i?.[h];if(d===null)return null;const g=xv(d)||xv(p);return s[h][g]}),c=t&&Object.entries(t).reduce((h,d)=>{let[p,g]=d;return g===void 0||(h[p]=g),h},{}),u=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((h,d)=>{let{class:p,className:g,...y}=d;return Object.entries(y).every(b=>{let[_,S]=b;return Array.isArray(S)?S.includes({...i,...c}[_]):{...i,...c}[_]===S})?[...h,p,g]:h},[]);return _v(r,a,u,t?.class,t?.className)},lf="-",FA=r=>{const e=NA(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:a=>{const c=a.split(lf);return c[0]===""&&c.length!==1&&c.shift(),wy(c,e)||LA(a)},getConflictingClassGroupIds:(a,c)=>{const u=t[a]||[];return c&&n[a]?[...u,...n[a]]:u}}},wy=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?wy(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(lf);return e.validators.find(({validator:a})=>a(i))?.classGroupId},Sv=/^\[(.+)\]$/,LA=r=>{if(Sv.test(r)){const e=Sv.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},NA=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return VA(Object.entries(r.classGroups),t).forEach(([i,a])=>{ud(a,n,i,e)}),n},ud=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Cv(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(BA(s)){ud(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,a])=>{ud(a,Cv(e,i),t,n)})})},Cv=(r,e)=>{let t=r;return e.split(lf).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},BA=r=>r.isThemeGetter,VA=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,c])=>[e+a,c])):i);return[t,s]}):r,zA=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,a)=>{t.set(i,a),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let a=t.get(i);if(a!==void 0)return a;if((a=n.get(i))!==void 0)return s(i,a),a},set(i,a){t.has(i)?t.set(i,a):s(i,a)}}},xy="!",WA=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,a=c=>{const u=[];let h=0,d=0,p;for(let S=0;S<c.length;S++){let T=c[S];if(h===0){if(T===s&&(n||c.slice(S,S+i)===e)){u.push(c.slice(d,S)),d=S+i;continue}if(T==="/"){p=S;continue}}T==="["?h++:T==="]"&&h--}const g=u.length===0?c:c.substring(d),y=g.startsWith(xy),b=y?g.substring(1):g,_=p&&p>d?p-d:void 0;return{modifiers:u,hasImportantModifier:y,baseClassName:b,maybePostfixModifierPosition:_}};return t?c=>t({className:c,parseClassName:a}):a},HA=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},UA=r=>({cache:zA(r.cacheSize),parseClassName:WA(r),...FA(r)}),$A=/\s+/,YA=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],a=r.trim().split($A);let c="";for(let u=a.length-1;u>=0;u-=1){const h=a[u],{modifiers:d,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:y}=t(h);let b=!!y,_=n(b?g.substring(0,y):g);if(!_){if(!b){c=h+(c.length>0?" "+c:c);continue}if(_=n(g),!_){c=h+(c.length>0?" "+c:c);continue}b=!1}const S=HA(d).join(":"),T=p?S+xy:S,k=T+_;if(i.includes(k))continue;i.push(k);const I=s(_,b);for(let A=0;A<I.length;++A){const D=I[A];i.push(T+D)}c=h+(c.length>0?" "+c:c)}return c};function XA(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=_y(e))&&(n&&(n+=" "),n+=t);return n}const _y=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=_y(r[n]))&&(t&&(t+=" "),t+=e);return t};function GA(r,...e){let t,n,s,i=a;function a(u){const h=e.reduce((d,p)=>p(d),r());return t=UA(h),n=t.cache.get,s=t.cache.set,i=c,c(u)}function c(u){const h=n(u);if(h)return h;const d=YA(u,t);return s(u,d),d}return function(){return i(XA.apply(null,arguments))}}const rt=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},Sy=/^\[(?:([a-z-]+):)?(.+)\]$/i,qA=/^\d+\/\d+$/,KA=new Set(["px","full","screen"]),ZA=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,JA=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,QA=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,eO=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,tO=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,On=r=>Ri(r)||KA.has(r)||qA.test(r),es=r=>Hi(r,"length",lO),Ri=r=>!!r&&!Number.isNaN(Number(r)),Oh=r=>Hi(r,"number",Ri),Mo=r=>!!r&&Number.isInteger(Number(r)),rO=r=>r.endsWith("%")&&Ri(r.slice(0,-1)),Te=r=>Sy.test(r),ts=r=>ZA.test(r),nO=new Set(["length","size","percentage"]),sO=r=>Hi(r,nO,Cy),iO=r=>Hi(r,"position",Cy),oO=new Set(["image","url"]),aO=r=>Hi(r,oO,hO),cO=r=>Hi(r,"",uO),Po=()=>!0,Hi=(r,e,t)=>{const n=Sy.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},lO=r=>JA.test(r)&&!QA.test(r),Cy=()=>!1,uO=r=>eO.test(r),hO=r=>tO.test(r),dO=()=>{const r=rt("colors"),e=rt("spacing"),t=rt("blur"),n=rt("brightness"),s=rt("borderColor"),i=rt("borderRadius"),a=rt("borderSpacing"),c=rt("borderWidth"),u=rt("contrast"),h=rt("grayscale"),d=rt("hueRotate"),p=rt("invert"),g=rt("gap"),y=rt("gradientColorStops"),b=rt("gradientColorStopPositions"),_=rt("inset"),S=rt("margin"),T=rt("opacity"),k=rt("padding"),I=rt("saturate"),A=rt("scale"),D=rt("sepia"),F=rt("skew"),z=rt("space"),L=rt("translate"),Y=()=>["auto","contain","none"],W=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto",Te,e],U=()=>[Te,e],X=()=>["",On,es],te=()=>["auto",Ri,Te],de=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],J=()=>["solid","dashed","dotted","double","none"],le=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ie=()=>["start","end","center","between","around","evenly","stretch"],se=()=>["","0",Te],he=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[Ri,Te];return{cacheSize:500,separator:":",theme:{colors:[Po],spacing:[On,es],blur:["none","",ts,Te],brightness:re(),borderColor:[r],borderRadius:["none","","full",ts,Te],borderSpacing:U(),borderWidth:X(),contrast:re(),grayscale:se(),hueRotate:re(),invert:se(),gap:U(),gradientColorStops:[r],gradientColorStopPositions:[rO,es],inset:q(),margin:q(),opacity:re(),padding:U(),saturate:re(),scale:re(),sepia:se(),skew:re(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",Te]}],container:["container"],columns:[{columns:[ts]}],"break-after":[{"break-after":he()}],"break-before":[{"break-before":he()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...de(),Te]}],overflow:[{overflow:W()}],"overflow-x":[{"overflow-x":W()}],"overflow-y":[{"overflow-y":W()}],overscroll:[{overscroll:Y()}],"overscroll-x":[{"overscroll-x":Y()}],"overscroll-y":[{"overscroll-y":Y()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Mo,Te]}],basis:[{basis:q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Te]}],grow:[{grow:se()}],shrink:[{shrink:se()}],order:[{order:["first","last","none",Mo,Te]}],"grid-cols":[{"grid-cols":[Po]}],"col-start-end":[{col:["auto",{span:["full",Mo,Te]},Te]}],"col-start":[{"col-start":te()}],"col-end":[{"col-end":te()}],"grid-rows":[{"grid-rows":[Po]}],"row-start-end":[{row:["auto",{span:[Mo,Te]},Te]}],"row-start":[{"row-start":te()}],"row-end":[{"row-end":te()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Te]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Te]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...ie()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ie(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ie(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Te,e]}],"min-w":[{"min-w":[Te,e,"min","max","fit"]}],"max-w":[{"max-w":[Te,e,"none","full","min","max","fit","prose",{screen:[ts]},ts]}],h:[{h:[Te,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Te,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Te,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Te,e,"auto","min","max","fit"]}],"font-size":[{text:["base",ts,es]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Oh]}],"font-family":[{font:[Po]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Te]}],"line-clamp":[{"line-clamp":["none",Ri,Oh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",On,Te]}],"list-image":[{"list-image":["none",Te]}],"list-style-type":[{list:["none","disc","decimal",Te]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...J(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",On,es]}],"underline-offset":[{"underline-offset":["auto",On,Te]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Te]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Te]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...de(),iO]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",sO]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},aO]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...J(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:J()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...J()]}],"outline-offset":[{"outline-offset":[On,Te]}],"outline-w":[{outline:[On,es]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[On,es]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",ts,cO]}],"shadow-color":[{shadow:[Po]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...le(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":le()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",ts,Te]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[p]}],saturate:[{saturate:[I]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[I]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Te]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",Te]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",Te]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[A]}],"scale-x":[{"scale-x":[A]}],"scale-y":[{"scale-y":[A]}],rotate:[{rotate:[Mo,Te]}],"translate-x":[{"translate-x":[L]}],"translate-y":[{"translate-y":[L]}],"skew-x":[{"skew-x":[F]}],"skew-y":[{"skew-y":[F]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Te]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Te]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Te]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[On,es,Oh]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},fO=GA(dO);function ps(...r){return fO(by(r))}function pO(r,e={}){const{decimals:t=0,sizeType:n="normal"}=e,s=["Bytes","KB","MB","GB","TB"],i=["Bytes","KiB","MiB","GiB","TiB"];if(r===0)return"0 Byte";const a=Math.floor(Math.log(r)/Math.log(1024));return`${(r/Math.pow(1024,a)).toFixed(t)} ${n==="accurate"?i[a]??"Bytest":s[a]??"Bytes"}`}const Ty=jA("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Wt=H.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const a=n?Li:"button";return w.jsx(a,{className:ps(Ty({variant:e,size:t,className:r})),ref:i,...s})});Wt.displayName="Button";function uf(r,[e,t]){return Math.min(t,Math.max(e,r))}function ft(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r?.(s),t===!1||!s.defaultPrevented)return e?.(s)}}function pa(r,e=[]){let t=[];function n(i,a){const c=H.createContext(a),u=t.length;t=[...t,a];const h=p=>{const{scope:g,children:y,...b}=p,_=g?.[r]?.[u]||c,S=H.useMemo(()=>b,Object.values(b));return w.jsx(_.Provider,{value:S,children:y})};h.displayName=i+"Provider";function d(p,g){const y=g?.[r]?.[u]||c,b=H.useContext(y);if(b)return b;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[h,d]}const s=()=>{const i=t.map(a=>H.createContext(a));return function(c){const u=c?.[r]||i;return H.useMemo(()=>({[`__scope${r}`]:{...c,[r]:u}}),[c,u])}};return s.scopeName=r,[n,gO(s,...e)]}function gO(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((c,{useScope:u,scopeName:h})=>{const p=u(i)[`__scope${h}`];return{...c,...p}},{});return H.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function hn(r){const e=H.useRef(r);return H.useEffect(()=>{e.current=r}),H.useMemo(()=>(...t)=>e.current?.(...t),[])}function hf({prop:r,defaultProp:e,onChange:t=()=>{}}){const[n,s]=mO({defaultProp:e,onChange:t}),i=r!==void 0,a=i?r:n,c=hn(t),u=H.useCallback(h=>{if(i){const p=typeof h=="function"?h(r):h;p!==r&&c(p)}else s(h)},[i,r,s,c]);return[a,u]}function mO({defaultProp:r,onChange:e}){const t=H.useState(r),[n]=t,s=H.useRef(n),i=hn(e);return H.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),t}var vO=H.createContext(void 0);function Il(r){const e=H.useContext(vO);return r||e||"ltr"}function yO(r){const e=H.useRef({value:r,previous:r});return H.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var Zo=globalThis?.document?H.useLayoutEffect:()=>{};function bO(r){const[e,t]=H.useState(void 0);return Zo(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,c;if("borderBoxSize"in i){const u=i.borderBoxSize,h=Array.isArray(u)?u[0]:u;a=h.inlineSize,c=h.blockSize}else a=r.offsetWidth,c=r.offsetHeight;t({width:a,height:c})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var wO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],er=wO.reduce((r,e)=>{const t=H.forwardRef((n,s)=>{const{asChild:i,...a}=n,c=i?Li:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(c,{...a,ref:s})});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{});function Ey(r){const e=r+"CollectionProvider",[t,n]=pa(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),a=y=>{const{scope:b,children:_}=y,S=v.useRef(null),T=v.useRef(new Map).current;return w.jsx(s,{scope:b,itemMap:T,collectionRef:S,children:_})};a.displayName=e;const c=r+"CollectionSlot",u=v.forwardRef((y,b)=>{const{scope:_,children:S}=y,T=i(c,_),k=Zt(b,T.collectionRef);return w.jsx(Li,{ref:k,children:S})});u.displayName=c;const h=r+"CollectionItemSlot",d="data-radix-collection-item",p=v.forwardRef((y,b)=>{const{scope:_,children:S,...T}=y,k=v.useRef(null),I=Zt(b,k),A=i(h,_);return v.useEffect(()=>(A.itemMap.set(k,{ref:k,...T}),()=>void A.itemMap.delete(k))),w.jsx(Li,{[d]:"",ref:I,children:S})});p.displayName=h;function g(y){const b=i(r+"CollectionConsumer",y);return v.useCallback(()=>{const S=b.collectionRef.current;if(!S)return[];const T=Array.from(S.querySelectorAll(`[${d}]`));return Array.from(b.itemMap.values()).sort((A,D)=>T.indexOf(A.ref.current)-T.indexOf(D.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:a,Slot:u,ItemSlot:p},g,n]}var ky=["PageUp","PageDown"],Iy=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ay={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Ui="Slider",[hd,xO,_O]=Ey(Ui),[Oy,V7]=pa(Ui,[_O]),[SO,Al]=Oy(Ui),My=H.forwardRef((r,e)=>{const{name:t,min:n=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:u=0,defaultValue:h=[n],value:d,onValueChange:p=()=>{},onValueCommit:g=()=>{},inverted:y=!1,form:b,..._}=r,S=H.useRef(new Set),T=H.useRef(0),I=a==="horizontal"?CO:TO,[A=[],D]=hf({prop:d,defaultProp:h,onChange:q=>{[...S.current][T.current]?.focus(),p(q)}}),F=H.useRef(A);function z(q){const U=OO(A,q);W(q,U)}function L(q){W(q,T.current)}function Y(){const q=F.current[T.current];A[T.current]!==q&&g(A)}function W(q,U,{commit:X}={commit:!1}){const te=RO(i),de=jO(Math.round((q-n)/i)*i+n,te),J=uf(de,[n,s]);D((le=[])=>{const ie=IO(le,J,U);if(DO(ie,u*i)){T.current=ie.indexOf(J);const se=String(ie)!==String(le);return se&&X&&g(ie),se?ie:le}else return le})}return w.jsx(SO,{scope:r.__scopeSlider,name:t,disabled:c,min:n,max:s,valueIndexToChangeRef:T,thumbs:S.current,values:A,orientation:a,form:b,children:w.jsx(hd.Provider,{scope:r.__scopeSlider,children:w.jsx(hd.Slot,{scope:r.__scopeSlider,children:w.jsx(I,{"aria-disabled":c,"data-disabled":c?"":void 0,..._,ref:e,onPointerDown:ft(_.onPointerDown,()=>{c||(F.current=A)}),min:n,max:s,inverted:y,onSlideStart:c?void 0:z,onSlideMove:c?void 0:L,onSlideEnd:c?void 0:Y,onHomeKeyDown:()=>!c&&W(n,0,{commit:!0}),onEndKeyDown:()=>!c&&W(s,A.length-1,{commit:!0}),onStepKeyDown:({event:q,direction:U})=>{if(!c){const de=ky.includes(q.key)||q.shiftKey&&Iy.includes(q.key)?10:1,J=T.current,le=A[J],ie=i*de*U;W(le+ie,J,{commit:!0})}}})})})})});My.displayName=Ui;var[Py,Dy]=Oy(Ui,{startEdge:"left",endEdge:"right",size:"width",direction:1}),CO=H.forwardRef((r,e)=>{const{min:t,max:n,dir:s,inverted:i,onSlideStart:a,onSlideMove:c,onSlideEnd:u,onStepKeyDown:h,...d}=r,[p,g]=H.useState(null),y=Zt(e,I=>g(I)),b=H.useRef(void 0),_=Il(s),S=_==="ltr",T=S&&!i||!S&&i;function k(I){const A=b.current||p.getBoundingClientRect(),D=[0,A.width],z=df(D,T?[t,n]:[n,t]);return b.current=A,z(I-A.left)}return w.jsx(Py,{scope:r.__scopeSlider,startEdge:T?"left":"right",endEdge:T?"right":"left",direction:T?1:-1,size:"width",children:w.jsx(Ry,{dir:_,"data-orientation":"horizontal",...d,ref:y,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const A=k(I.clientX);a?.(A)},onSlideMove:I=>{const A=k(I.clientX);c?.(A)},onSlideEnd:()=>{b.current=void 0,u?.()},onStepKeyDown:I=>{const D=Ay[T?"from-left":"from-right"].includes(I.key);h?.({event:I,direction:D?-1:1})}})})}),TO=H.forwardRef((r,e)=>{const{min:t,max:n,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:c,onStepKeyDown:u,...h}=r,d=H.useRef(null),p=Zt(e,d),g=H.useRef(void 0),y=!s;function b(_){const S=g.current||d.current.getBoundingClientRect(),T=[0,S.height],I=df(T,y?[n,t]:[t,n]);return g.current=S,I(_-S.top)}return w.jsx(Py,{scope:r.__scopeSlider,startEdge:y?"bottom":"top",endEdge:y?"top":"bottom",size:"height",direction:y?1:-1,children:w.jsx(Ry,{"data-orientation":"vertical",...h,ref:p,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:_=>{const S=b(_.clientY);i?.(S)},onSlideMove:_=>{const S=b(_.clientY);a?.(S)},onSlideEnd:()=>{g.current=void 0,c?.()},onStepKeyDown:_=>{const T=Ay[y?"from-bottom":"from-top"].includes(_.key);u?.({event:_,direction:T?-1:1})}})})}),Ry=H.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:u,...h}=r,d=Al(Ui,t);return w.jsx(er.span,{...h,ref:e,onKeyDown:ft(r.onKeyDown,p=>{p.key==="Home"?(a(p),p.preventDefault()):p.key==="End"?(c(p),p.preventDefault()):ky.concat(Iy).includes(p.key)&&(u(p),p.preventDefault())}),onPointerDown:ft(r.onPointerDown,p=>{const g=p.target;g.setPointerCapture(p.pointerId),p.preventDefault(),d.thumbs.has(g)?g.focus():n(p)}),onPointerMove:ft(r.onPointerMove,p=>{p.target.hasPointerCapture(p.pointerId)&&s(p)}),onPointerUp:ft(r.onPointerUp,p=>{const g=p.target;g.hasPointerCapture(p.pointerId)&&(g.releasePointerCapture(p.pointerId),i(p))})})}),jy="SliderTrack",Fy=H.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,s=Al(jy,t);return w.jsx(er.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:e})});Fy.displayName=jy;var dd="SliderRange",Ly=H.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,s=Al(dd,t),i=Dy(dd,t),a=H.useRef(null),c=Zt(e,a),u=s.values.length,h=s.values.map(g=>By(g,s.min,s.max)),d=u>1?Math.min(...h):0,p=100-Math.max(...h);return w.jsx(er.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...n,ref:c,style:{...r.style,[i.startEdge]:d+"%",[i.endEdge]:p+"%"}})});Ly.displayName=dd;var fd="SliderThumb",Ny=H.forwardRef((r,e)=>{const t=xO(r.__scopeSlider),[n,s]=H.useState(null),i=Zt(e,c=>s(c)),a=H.useMemo(()=>n?t().findIndex(c=>c.ref.current===n):-1,[t,n]);return w.jsx(EO,{...r,ref:i,index:a})}),EO=H.forwardRef((r,e)=>{const{__scopeSlider:t,index:n,name:s,...i}=r,a=Al(fd,t),c=Dy(fd,t),[u,h]=H.useState(null),d=Zt(e,k=>h(k)),p=u?a.form||!!u.closest("form"):!0,g=bO(u),y=a.values[n],b=y===void 0?0:By(y,a.min,a.max),_=AO(n,a.values.length),S=g?.[c.size],T=S?MO(S,b,c.direction):0;return H.useEffect(()=>{if(u)return a.thumbs.add(u),()=>{a.thumbs.delete(u)}},[u,a.thumbs]),w.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${b}% + ${T}px)`},children:[w.jsx(hd.ItemSlot,{scope:r.__scopeSlider,children:w.jsx(er.span,{role:"slider","aria-label":r["aria-label"]||_,"aria-valuemin":a.min,"aria-valuenow":y,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:d,style:y===void 0?{display:"none"}:r.style,onFocus:ft(r.onFocus,()=>{a.valueIndexToChangeRef.current=n})})}),p&&w.jsx(kO,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:y},n)]})});Ny.displayName=fd;var kO=r=>{const{value:e,...t}=r,n=H.useRef(null),s=yO(e);return H.useEffect(()=>{const i=n.current,a=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==e&&u){const h=new Event("input",{bubbles:!0});u.call(i,e),i.dispatchEvent(h)}},[s,e]),w.jsx("input",{style:{display:"none"},...t,ref:n,defaultValue:e})};function IO(r=[],e,t){const n=[...r];return n[t]=e,n.sort((s,i)=>s-i)}function By(r,e,t){const i=100/(t-e)*(r-e);return uf(i,[0,100])}function AO(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function OO(r,e){if(r.length===1)return 0;const t=r.map(s=>Math.abs(s-e)),n=Math.min(...t);return t.indexOf(n)}function MO(r,e,t){const n=r/2,i=df([0,50],[0,n]);return(n-i(e)*t)*t}function PO(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function DO(r,e){if(e>0){const t=PO(r);return Math.min(...t)>=e}return!0}function df(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function RO(r){return(String(r).split(".")[1]||"").length}function jO(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var Vy=My,FO=Fy,LO=Ly,NO=Ny;const zy=H.forwardRef(({className:r,...e},t)=>w.jsxs(Vy,{ref:t,className:ps("relative flex w-full touch-none select-none items-center",r),...e,children:[w.jsx(FO,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:w.jsx(LO,{className:"absolute h-full bg-primary"})}),w.jsx(NO,{className:"block h-4 w-4 cursor-pointer rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));zy.displayName=Vy.displayName;function BO(r,e){return H.useReducer((t,n)=>e[t][n]??t,r)}var $i=r=>{const{present:e,children:t}=r,n=VO(e),s=typeof t=="function"?t({present:n.isPresent}):H.Children.only(t),i=Zt(n.ref,zO(s));return typeof t=="function"||n.isPresent?H.cloneElement(s,{ref:i}):null};$i.displayName="Presence";function VO(r){const[e,t]=H.useState(),n=H.useRef({}),s=H.useRef(r),i=H.useRef("none"),a=r?"mounted":"unmounted",[c,u]=BO(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return H.useEffect(()=>{const h=wc(n.current);i.current=c==="mounted"?h:"none"},[c]),Zo(()=>{const h=n.current,d=s.current;if(d!==r){const g=i.current,y=wc(h);r?u("MOUNT"):y==="none"||h?.display==="none"?u("UNMOUNT"):u(d&&g!==y?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,u]),Zo(()=>{if(e){let h;const d=e.ownerDocument.defaultView??window,p=y=>{const _=wc(n.current).includes(y.animationName);if(y.target===e&&_&&(u("ANIMATION_END"),!s.current)){const S=e.style.animationFillMode;e.style.animationFillMode="forwards",h=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=S)})}},g=y=>{y.target===e&&(i.current=wc(n.current))};return e.addEventListener("animationstart",g),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{d.clearTimeout(h),e.removeEventListener("animationstart",g),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:H.useCallback(h=>{h&&(n.current=getComputedStyle(h)),t(h)},[])}}function wc(r){return r?.animationName||"none"}function zO(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function WO(r,e){return H.useReducer((t,n)=>e[t][n]??t,r)}var ff="ScrollArea",[Wy,z7]=pa(ff),[HO,Wr]=Wy(ff),Hy=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:s,scrollHideDelay:i=600,...a}=r,[c,u]=H.useState(null),[h,d]=H.useState(null),[p,g]=H.useState(null),[y,b]=H.useState(null),[_,S]=H.useState(null),[T,k]=H.useState(0),[I,A]=H.useState(0),[D,F]=H.useState(!1),[z,L]=H.useState(!1),Y=Zt(e,q=>u(q)),W=Il(s);return w.jsx(HO,{scope:t,type:n,dir:W,scrollHideDelay:i,scrollArea:c,viewport:h,onViewportChange:d,content:p,onContentChange:g,scrollbarX:y,onScrollbarXChange:b,scrollbarXEnabled:D,onScrollbarXEnabledChange:F,scrollbarY:_,onScrollbarYChange:S,scrollbarYEnabled:z,onScrollbarYEnabledChange:L,onCornerWidthChange:k,onCornerHeightChange:A,children:w.jsx(er.div,{dir:W,...a,ref:Y,style:{position:"relative","--radix-scroll-area-corner-width":T+"px","--radix-scroll-area-corner-height":I+"px",...r.style}})})});Hy.displayName=ff;var Uy="ScrollAreaViewport",$y=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,nonce:s,...i}=r,a=Wr(Uy,t),c=H.useRef(null),u=Zt(e,c,a.onViewportChange);return w.jsxs(w.Fragment,{children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),w.jsx(er.div,{"data-radix-scroll-area-viewport":"",...i,ref:u,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...r.style},children:w.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});$y.displayName=Uy;var bn="ScrollAreaScrollbar",Ol=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Wr(bn,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,c=r.orientation==="horizontal";return H.useEffect(()=>(c?i(!0):a(!0),()=>{c?i(!1):a(!1)}),[c,i,a]),s.type==="hover"?w.jsx(UO,{...n,ref:e,forceMount:t}):s.type==="scroll"?w.jsx($O,{...n,ref:e,forceMount:t}):s.type==="auto"?w.jsx(Yy,{...n,ref:e,forceMount:t}):s.type==="always"?w.jsx(pf,{...n,ref:e}):null});Ol.displayName=bn;var UO=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Wr(bn,r.__scopeScrollArea),[i,a]=H.useState(!1);return H.useEffect(()=>{const c=s.scrollArea;let u=0;if(c){const h=()=>{window.clearTimeout(u),a(!0)},d=()=>{u=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",d),()=>{window.clearTimeout(u),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),w.jsx($i,{present:t||i,children:w.jsx(Yy,{"data-state":i?"visible":"hidden",...n,ref:e})})}),$O=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Wr(bn,r.__scopeScrollArea),i=r.orientation==="horizontal",a=Pl(()=>u("SCROLL_END"),100),[c,u]=WO("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return H.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>u("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,s.scrollHideDelay,u]),H.useEffect(()=>{const h=s.viewport,d=i?"scrollLeft":"scrollTop";if(h){let p=h[d];const g=()=>{const y=h[d];p!==y&&(u("SCROLL"),a()),p=y};return h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[s.viewport,i,u,a]),w.jsx($i,{present:t||c!=="hidden",children:w.jsx(pf,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:ft(r.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:ft(r.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),Yy=H.forwardRef((r,e)=>{const t=Wr(bn,r.__scopeScrollArea),{forceMount:n,...s}=r,[i,a]=H.useState(!1),c=r.orientation==="horizontal",u=Pl(()=>{if(t.viewport){const h=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;a(c?h:d)}},10);return Ni(t.viewport,u),Ni(t.content,u),w.jsx($i,{present:n||i,children:w.jsx(pf,{"data-state":i?"visible":"hidden",...s,ref:e})})}),pf=H.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,s=Wr(bn,r.__scopeScrollArea),i=H.useRef(null),a=H.useRef(0),[c,u]=H.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Ky(c.viewport,c.content),d={...n,sizes:c,onSizesChange:u,hasThumb:h>0&&h<1,onThumbChange:g=>i.current=g,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:g=>a.current=g};function p(g,y){return ZO(g,a.current,c,y)}return t==="horizontal"?w.jsx(YO,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const g=s.viewport.scrollLeft,y=Tv(g,c,s.dir);i.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollLeft=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollLeft=p(g,s.dir))}}):t==="vertical"?w.jsx(XO,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const g=s.viewport.scrollTop,y=Tv(g,c);i.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:g=>{s.viewport&&(s.viewport.scrollTop=g)},onDragScroll:g=>{s.viewport&&(s.viewport.scrollTop=p(g))}}):null}),YO=H.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...s}=r,i=Wr(bn,r.__scopeScrollArea),[a,c]=H.useState(),u=H.useRef(null),h=Zt(e,u,i.onScrollbarXChange);return H.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),w.jsx(Gy,{"data-orientation":"horizontal",...s,ref:h,sizes:t,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ml(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.x),onDragScroll:d=>r.onDragScroll(d.x),onWheelScroll:(d,p)=>{if(i.viewport){const g=i.viewport.scrollLeft+d.deltaX;r.onWheelScroll(g),Jy(g,p)&&d.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:tl(a.paddingLeft),paddingEnd:tl(a.paddingRight)}})}})}),XO=H.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...s}=r,i=Wr(bn,r.__scopeScrollArea),[a,c]=H.useState(),u=H.useRef(null),h=Zt(e,u,i.onScrollbarYChange);return H.useEffect(()=>{u.current&&c(getComputedStyle(u.current))},[u]),w.jsx(Gy,{"data-orientation":"vertical",...s,ref:h,sizes:t,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ml(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.y),onDragScroll:d=>r.onDragScroll(d.y),onWheelScroll:(d,p)=>{if(i.viewport){const g=i.viewport.scrollTop+d.deltaY;r.onWheelScroll(g),Jy(g,p)&&d.preventDefault()}},onResize:()=>{u.current&&i.viewport&&a&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:tl(a.paddingTop),paddingEnd:tl(a.paddingBottom)}})}})}),[GO,Xy]=Wy(bn),Gy=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:h,onWheelScroll:d,onResize:p,...g}=r,y=Wr(bn,t),[b,_]=H.useState(null),S=Zt(e,Y=>_(Y)),T=H.useRef(null),k=H.useRef(""),I=y.viewport,A=n.content-n.viewport,D=hn(d),F=hn(u),z=Pl(p,10);function L(Y){if(T.current){const W=Y.clientX-T.current.left,q=Y.clientY-T.current.top;h({x:W,y:q})}}return H.useEffect(()=>{const Y=W=>{const q=W.target;b?.contains(q)&&D(W,A)};return document.addEventListener("wheel",Y,{passive:!1}),()=>document.removeEventListener("wheel",Y,{passive:!1})},[I,b,A,D]),H.useEffect(F,[n,F]),Ni(b,z),Ni(y.content,z),w.jsx(GO,{scope:t,scrollbar:b,hasThumb:s,onThumbChange:hn(i),onThumbPointerUp:hn(a),onThumbPositionChange:F,onThumbPointerDown:hn(c),children:w.jsx(er.div,{...g,ref:S,style:{position:"absolute",...g.style},onPointerDown:ft(r.onPointerDown,Y=>{Y.button===0&&(Y.target.setPointerCapture(Y.pointerId),T.current=b.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),L(Y))}),onPointerMove:ft(r.onPointerMove,L),onPointerUp:ft(r.onPointerUp,Y=>{const W=Y.target;W.hasPointerCapture(Y.pointerId)&&W.releasePointerCapture(Y.pointerId),document.body.style.webkitUserSelect=k.current,y.viewport&&(y.viewport.style.scrollBehavior=""),T.current=null})})})}),el="ScrollAreaThumb",gf=H.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=Xy(el,r.__scopeScrollArea);return w.jsx($i,{present:t||s.hasThumb,children:w.jsx(qO,{ref:e,...n})})}),qO=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...s}=r,i=Wr(el,t),a=Xy(el,t),{onThumbPositionChange:c}=a,u=Zt(e,p=>a.onThumbChange(p)),h=H.useRef(void 0),d=Pl(()=>{h.current&&(h.current(),h.current=void 0)},100);return H.useEffect(()=>{const p=i.viewport;if(p){const g=()=>{if(d(),!h.current){const y=JO(p,c);h.current=y,c()}};return c(),p.addEventListener("scroll",g),()=>p.removeEventListener("scroll",g)}},[i.viewport,d,c]),w.jsx(er.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ft(r.onPointerDownCapture,p=>{const y=p.target.getBoundingClientRect(),b=p.clientX-y.left,_=p.clientY-y.top;a.onThumbPointerDown({x:b,y:_})}),onPointerUp:ft(r.onPointerUp,a.onThumbPointerUp)})});gf.displayName=el;var mf="ScrollAreaCorner",qy=H.forwardRef((r,e)=>{const t=Wr(mf,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?w.jsx(KO,{...r,ref:e}):null});qy.displayName=mf;var KO=H.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,s=Wr(mf,t),[i,a]=H.useState(0),[c,u]=H.useState(0),h=!!(i&&c);return Ni(s.scrollbarX,()=>{const d=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(d),u(d)}),Ni(s.scrollbarY,()=>{const d=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(d),a(d)}),h?w.jsx(er.div,{...n,ref:e,style:{width:i,height:c,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function tl(r){return r?parseInt(r,10):0}function Ky(r,e){const t=r/e;return isNaN(t)?0:t}function Ml(r){const e=Ky(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function ZO(r,e,t,n="ltr"){const s=Ml(t),i=s/2,a=e||i,c=s-a,u=t.scrollbar.paddingStart+a,h=t.scrollbar.size-t.scrollbar.paddingEnd-c,d=t.content-t.viewport,p=n==="ltr"?[0,d]:[d*-1,0];return Zy([u,h],p)(r)}function Tv(r,e,t="ltr"){const n=Ml(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,a=e.content-e.viewport,c=i-n,u=t==="ltr"?[0,a]:[a*-1,0],h=uf(r,u);return Zy([0,a],[0,c])(h)}function Zy(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function Jy(r,e){return r>0&&r<e}var JO=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function s(){const i={left:r.scrollLeft,top:r.scrollTop},a=t.left!==i.left,c=t.top!==i.top;(a||c)&&e(),t=i,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function Pl(r,e){const t=hn(r),n=H.useRef(0);return H.useEffect(()=>()=>window.clearTimeout(n.current),[]),H.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function Ni(r,e){const t=hn(e);Zo(()=>{let n=0;if(r){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return s.observe(r),()=>{window.cancelAnimationFrame(n),s.unobserve(r)}}},[r,t])}var rl=Hy,pd=$y,Ev=Ol,kv=gf,QO=qy;const ei=H.forwardRef(({className:r,children:e,...t},n)=>w.jsxs(rl,{ref:n,className:ps("relative overflow-hidden",r),...t,children:[w.jsx(pd,{className:"h-full w-full rounded-[inherit]",children:e}),w.jsx(vf,{}),w.jsx(QO,{})]}));ei.displayName=rl.displayName;const vf=H.forwardRef(({className:r,orientation:e="vertical",...t},n)=>w.jsx(Ol,{ref:n,orientation:e,className:ps("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:w.jsx(gf,{className:"relative flex-1 rounded-full bg-border"})}));vf.displayName=Ol.displayName;const ga=({children:r,renderCustomPreview:e,data:t={},shouldDisplayPreview:n=!0})=>{const[s,i]=v.useState(!1),[a,c]=v.useState({x:0,y:0}),u=v.useRef(null),h=y=>{i(!0),y.dataTransfer.setDragImage(new Image,0,0),y.dataTransfer.setData(JSON.stringify(t),JSON.stringify(t)),c({x:y.clientX,y:y.clientY})},d=()=>{i(!1)},p=y=>{s&&c({x:y.clientX,y:y.clientY})},g=v.cloneElement(r,{draggable:!0,onDragStart:h,onDragEnd:d,onDrag:p,style:{...r.props.style}});return w.jsxs(w.Fragment,{children:[g,s&&n&&e?ad.createPortal(w.jsx("div",{ref:u,style:{position:"fixed",left:a.x,top:a.y,pointerEvents:"none",zIndex:9999,transform:"translate(-50%, -50%)"},children:e}),document.body):null]})};var e5=H.useId||(()=>{}),t5=0;function Qy(r){const[e,t]=H.useState(e5());return Zo(()=>{t(n=>n??String(t5++))},[r]),e?`radix-${e}`:""}var Mh="rovingFocusGroup.onEntryFocus",r5={bubbles:!1,cancelable:!0},Dl="RovingFocusGroup",[gd,e1,n5]=Ey(Dl),[s5,t1]=pa(Dl,[n5]),[i5,o5]=s5(Dl),r1=H.forwardRef((r,e)=>w.jsx(gd.Provider,{scope:r.__scopeRovingFocusGroup,children:w.jsx(gd.Slot,{scope:r.__scopeRovingFocusGroup,children:w.jsx(a5,{...r,ref:e})})}));r1.displayName=Dl;var a5=H.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:h,preventScrollOnEntryFocus:d=!1,...p}=r,g=H.useRef(null),y=Zt(e,g),b=Il(i),[_=null,S]=hf({prop:a,defaultProp:c,onChange:u}),[T,k]=H.useState(!1),I=hn(h),A=e1(t),D=H.useRef(!1),[F,z]=H.useState(0);return H.useEffect(()=>{const L=g.current;if(L)return L.addEventListener(Mh,I),()=>L.removeEventListener(Mh,I)},[I]),w.jsx(i5,{scope:t,orientation:n,dir:b,loop:s,currentTabStopId:_,onItemFocus:H.useCallback(L=>S(L),[S]),onItemShiftTab:H.useCallback(()=>k(!0),[]),onFocusableItemAdd:H.useCallback(()=>z(L=>L+1),[]),onFocusableItemRemove:H.useCallback(()=>z(L=>L-1),[]),children:w.jsx(er.div,{tabIndex:T||F===0?-1:0,"data-orientation":n,...p,ref:y,style:{outline:"none",...r.style},onMouseDown:ft(r.onMouseDown,()=>{D.current=!0}),onFocus:ft(r.onFocus,L=>{const Y=!D.current;if(L.target===L.currentTarget&&Y&&!T){const W=new CustomEvent(Mh,r5);if(L.currentTarget.dispatchEvent(W),!W.defaultPrevented){const q=A().filter(J=>J.focusable),U=q.find(J=>J.active),X=q.find(J=>J.id===_),de=[U,X,...q].filter(Boolean).map(J=>J.ref.current);i1(de,d)}}D.current=!1}),onBlur:ft(r.onBlur,()=>k(!1))})})}),n1="RovingFocusGroupItem",s1=H.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,...a}=r,c=Qy(),u=i||c,h=o5(n1,t),d=h.currentTabStopId===u,p=e1(t),{onFocusableItemAdd:g,onFocusableItemRemove:y}=h;return H.useEffect(()=>{if(n)return g(),()=>y()},[n,g,y]),w.jsx(gd.ItemSlot,{scope:t,id:u,focusable:n,active:s,children:w.jsx(er.span,{tabIndex:d?0:-1,"data-orientation":h.orientation,...a,ref:e,onMouseDown:ft(r.onMouseDown,b=>{n?h.onItemFocus(u):b.preventDefault()}),onFocus:ft(r.onFocus,()=>h.onItemFocus(u)),onKeyDown:ft(r.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){h.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const _=u5(b,h.orientation,h.dir);if(_!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let T=p().filter(k=>k.focusable).map(k=>k.ref.current);if(_==="last")T.reverse();else if(_==="prev"||_==="next"){_==="prev"&&T.reverse();const k=T.indexOf(b.currentTarget);T=h.loop?h5(T,k+1):T.slice(k+1)}setTimeout(()=>i1(T))}})})})});s1.displayName=n1;var c5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function l5(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function u5(r,e,t){const n=l5(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return c5[n]}function i1(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function h5(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var d5=r1,f5=s1,yf="Tabs",[p5,W7]=pa(yf,[t1]),o1=t1(),[g5,bf]=p5(yf),a1=H.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:c,activationMode:u="automatic",...h}=r,d=Il(c),[p,g]=hf({prop:n,onChange:s,defaultProp:i});return w.jsx(g5,{scope:t,baseId:Qy(),value:p,onValueChange:g,orientation:a,dir:d,activationMode:u,children:w.jsx(er.div,{dir:d,"data-orientation":a,...h,ref:e})})});a1.displayName=yf;var c1="TabsList",l1=H.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=bf(c1,t),a=o1(t);return w.jsx(d5,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:n,children:w.jsx(er.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});l1.displayName=c1;var u1="TabsTrigger",h1=H.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,a=bf(u1,t),c=o1(t),u=p1(a.baseId,n),h=g1(a.baseId,n),d=n===a.value;return w.jsx(f5,{asChild:!0,...c,focusable:!s,active:d,children:w.jsx(er.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":h,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u,...i,ref:e,onMouseDown:ft(r.onMouseDown,p=>{!s&&p.button===0&&p.ctrlKey===!1?a.onValueChange(n):p.preventDefault()}),onKeyDown:ft(r.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&a.onValueChange(n)}),onFocus:ft(r.onFocus,()=>{const p=a.activationMode!=="manual";!d&&!s&&p&&a.onValueChange(n)})})})});h1.displayName=u1;var d1="TabsContent",f1=H.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...a}=r,c=bf(d1,t),u=p1(c.baseId,n),h=g1(c.baseId,n),d=n===c.value,p=H.useRef(d);return H.useEffect(()=>{const g=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(g)},[]),w.jsx($i,{present:s||d,children:({present:g})=>w.jsx(er.div,{"data-state":d?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!g,id:h,tabIndex:0,...a,ref:e,style:{...r.style,animationDuration:p.current?"0s":void 0},children:g&&i})})});f1.displayName=d1;function p1(r,e){return`${r}-trigger-${e}`}function g1(r,e){return`${r}-content-${e}`}var m5=a1,m1=l1,v1=h1,y1=f1;const b1=m5,wf=H.forwardRef(({className:r,...e},t)=>w.jsx(m1,{ref:t,className:ps("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));wf.displayName=m1.displayName;const nl=H.forwardRef(({className:r,...e},t)=>w.jsx(v1,{ref:t,className:ps("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...e}));nl.displayName=v1.displayName;const sl=H.forwardRef(({className:r,...e},t)=>w.jsx(y1,{ref:t,className:ps("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));sl.displayName=y1.displayName;const v5="add",y5="track",b5="trackItems",w5="track:changed",x5="trackItems:changed",_5="state",S5="state:changed",w1="add",xf="add:text",Yi="add:video",Xi="add:audio",C5="add:placeholder",Gi="add:image",T5="add:mask",E5="add:transition",k5="add:animation",I5="edit",A5="edit:object",O5="edit:text",M5="edit:shape",P5="enterEditMode",D5="player",x1="player:play",_1="player:pause",R5="player:seek",j5="player:seekTo",F5="player:seekBy",L5="player:togglePlay",S1="active",N5="active:set",_f="active:delete",B5="active:paste",Sf="active:clone",Cf="active:split",V5="layer",z5="layer:locked",W5="layer:hidden",H5="layer:move",U5="layer:select",C1="layer:selection",$5="layer:sendTo",Y5="layer:rename",X5="layer:editingName",G5="layer:copy",q5="layer:paste",K5="layer:clone",Z5="layer:split",J5="layer:cut",Q5="layer:delete",T1="history",Tf="history:undo",Ef="history:redo",eM="history:reset",E1="scale",kf="scale:changed",k1="drag",If="drag:start",Jo="drag:end",I1="timeline",Af="timeline:boundingChanged";var md=function(r,e){return md=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},md(r,e)};function qi(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");md(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function vd(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function yd(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return i}function bd(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}function mn(r){return typeof r=="function"}function A1(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ph=A1(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,s){return s+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function wd(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var Rl=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var c=vd(a),u=c.next();!u.done;u=c.next()){var h=u.value;h.remove(this)}}catch(_){e={error:_}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(mn(d))try{d()}catch(_){i=_ instanceof Ph?_.errors:[_]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var g=vd(p),y=g.next();!y.done;y=g.next()){var b=y.value;try{Iv(b)}catch(_){i=i??[],_ instanceof Ph?i=bd(bd([],yd(i)),yd(_.errors)):i.push(_)}}}catch(_){n={error:_}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(n)throw n.error}}}if(i)throw new Ph(i)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Iv(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&wd(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&wd(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),O1=Rl.EMPTY;function M1(r){return r instanceof Rl||r&&"closed"in r&&mn(r.remove)&&mn(r.add)&&mn(r.unsubscribe)}function Iv(r){mn(r)?r():r.unsubscribe()}var tM={Promise:void 0},rM={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout.apply(void 0,bd([r,e],yd(t)))},clearTimeout:function(r){return clearTimeout(r)},delegate:void 0};function nM(r){rM.setTimeout(function(){throw r})}function Av(){}function qc(r){r()}var Of=function(r){qi(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,M1(t)&&t.add(n)):n.destination=oM,n}return e.create=function(t,n,s){return new xd(t,n,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Rl),sM=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){xc(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){xc(n)}else xc(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){xc(t)}},r}(),xd=function(r){qi(e,r);function e(t,n,s){var i=r.call(this)||this,a;return mn(t)||!t?a={next:t??void 0,error:n??void 0,complete:s??void 0}:a=t,i.destination=new sM(a),i}return e}(Of);function xc(r){nM(r)}function iM(r){throw r}var oM={closed:!0,next:Av,error:iM,complete:Av},aM=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function cM(r){return r}function lM(r){return r.length===0?cM:r.length===1?r[0]:function(t){return r.reduce(function(n,s){return s(n)},t)}}var Ov=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var s=this,i=hM(e)?e:new xd(e,t,n);return qc(function(){var a=s,c=a.operator,u=a.source;i.add(c?c.call(i,u):u?s._subscribe(i):s._trySubscribe(i))}),i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=Mv(t),new t(function(s,i){var a=new xd({next:function(c){try{e(c)}catch(u){i(u),a.unsubscribe()}},error:i,complete:s});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[aM]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return lM(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=Mv(e),new e(function(n,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return n(i)})})},r.create=function(e){return new r(e)},r}();function Mv(r){var e;return(e=r??tM.Promise)!==null&&e!==void 0?e:Promise}function uM(r){return r&&mn(r.next)&&mn(r.error)&&mn(r.complete)}function hM(r){return r&&r instanceof Of||uM(r)&&M1(r)}function dM(r){return mn(r?.lift)}function fM(r){return function(e){if(dM(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function pM(r,e,t,n,s){return new gM(r,e,t,n,s)}var gM=function(r){qi(e,r);function e(t,n,s,i,a,c){var u=r.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=c,u._next=n?function(h){try{n(h)}catch(d){t.error(d)}}:r.prototype._next,u._error=i?function(h){try{i(h)}catch(d){t.error(d)}finally{this.unsubscribe()}}:r.prototype._error,u._complete=s?function(){try{s()}catch(h){t.error(h)}finally{this.unsubscribe()}}:r.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(Of),mM=A1(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Mf=function(r){qi(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new Pv(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new mM},e.prototype.next=function(t){var n=this;qc(function(){var s,i;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=vd(n.currentObservers),c=a.next();!c.done;c=a.next()){var u=c.value;u.next(t)}}catch(h){s={error:h}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var n=this;qc(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var s=n.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;qc(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,s=this,i=s.hasError,a=s.isStopped,c=s.observers;return i||a?O1:(this.currentObservers=null,c.push(t),new Rl(function(){n.currentObservers=null,wd(c,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,s=n.hasError,i=n.thrownError,a=n.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new Ov;return t.source=this,t},e.create=function(t,n){return new Pv(t,n)},e}(Ov),Pv=function(r){qi(e,r);function e(t,n){var s=r.call(this)||this;return s.destination=t,s.source=n,s}return e.prototype.next=function(t){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.next)===null||s===void 0||s.call(n,t)},e.prototype.error=function(t){var n,s;(s=(n=this.destination)===null||n===void 0?void 0:n.error)===null||s===void 0||s.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,s;return(s=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&s!==void 0?s:O1},e}(Mf),Dv=function(r){qi(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,s=t.thrownError,i=t._value;if(n)throw s;return this._throwIfClosed(),i},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e}(Mf);function Bs(r,e){return fM(function(t,n){var s=0;t.subscribe(pM(n,function(i){return r.call(e,i,s++)&&n.next(i)}))})}const P1=new Mf,vM=(r,e)=>{P1.next({key:r,value:e})},Fe={subject:P1,dispatch:vM},Lt=[];for(let r=0;r<256;++r)Lt.push((r+256).toString(16).slice(1));function yM(r,e=0){return(Lt[r[e+0]]+Lt[r[e+1]]+Lt[r[e+2]]+Lt[r[e+3]]+"-"+Lt[r[e+4]]+Lt[r[e+5]]+"-"+Lt[r[e+6]]+Lt[r[e+7]]+"-"+Lt[r[e+8]]+Lt[r[e+9]]+"-"+Lt[r[e+10]]+Lt[r[e+11]]+Lt[r[e+12]]+Lt[r[e+13]]+Lt[r[e+14]]+Lt[r[e+15]]).toLowerCase()}let Dh;const bM=new Uint8Array(16);function wM(){if(!Dh){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Dh=crypto.getRandomValues.bind(crypto)}return Dh(bM)}const xM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Rv={randomUUID:xM};function At(r,e,t){if(Rv.randomUUID&&!r)return Rv.randomUUID();r=r||{};const n=r.random??r.rng?.()??wM();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,yM(n)}var D1=(r=>(r.IMAGE="image",r.VIDEO="video",r.AUDIO="audio",r))(D1||{});const _M=r=>{const[e,t]=v.useState(!1),[n,s]=v.useState(!1),i=v.useCallback(d=>{const p={...d,id:At()};switch(d.type){case"image":Fe.dispatch(Gi,{payload:p});break;case"video":Fe.dispatch(Yi,{payload:p});break;case"audio":Fe.dispatch(Xi,{payload:p});break}},[]),a=v.useCallback(d=>{d.preventDefault();try{const p=d.dataTransfer?.types[0],g=JSON.parse(p);if(!Object.values(D1).includes(g.type))return;s(!0),t(!0),r?.(!0)}catch(p){console.error("Error parsing dragged data:",p)}},[r]),c=v.useCallback(d=>{d.preventDefault(),e&&(s(!0),r?.(!0))},[e,r]),u=v.useCallback(d=>{if(n){d.preventDefault(),s(!1),r?.(!1);try{const p=d.dataTransfer?.types[0],g=JSON.parse(d.dataTransfer.getData(p));i(g)}catch(p){console.error("Error parsing dropped data:",p)}}},[n,r,i]),h=v.useCallback(d=>{d.preventDefault(),d.currentTarget.contains(d.relatedTarget)||(s(!1),t(!1),r?.(!1))},[r]);return{onDragEnter:a,onDragOver:c,onDrop:u,onDragLeave:h,isDraggingOver:n}},R1=({children:r,className:e,style:t,onDragStateChange:n,id:s})=>{const{onDragEnter:i,onDragOver:a,onDrop:c,onDragLeave:u}=_M(n);return w.jsx("div",{id:s,onDragEnter:i,onDrop:c,onDragOver:a,onDragLeave:u,className:e,style:t,role:"region","aria-label":"Droppable area for images, videos, and audio",children:r})},SM=({size:r,children:e})=>{const[t,n]=v.useState(!1);return w.jsxs(R1,{id:"artboard",onDragStateChange:n,style:{width:r.width,height:r.height},className:"designcombo_scene pointer-events-auto mt-3.5 bg-black",children:[w.jsx("div",{style:{width:r.width,height:r.height},className:`pointer-events-none absolute z-50 mt-3.5 transition-colors duration-200 ease-in-out ${t?"border-4 border-dashed border-white bg-white/[0.075]":"bg-transparent"} shadow-[0_0_0_5000px_#1D1D1F]`}),e]})},CM=100,TM=30,EM=18,kM=14,IM=30,AM=24,OM=16,j1=12,MM="Regular",F1="sans-serif",ma=188,il=40,PM=4e3,L1=1920,N1=1080,B1=60,V1=1e3/B1,DM=2e6,RM=1e7,jM=48e3,FM=192e3,Pf=2.3,LM=L1/Pf,NM=N1/Pf,BM=184,VM=348,zM=512,WM=300,HM=0,UM=5e3,$M=1,YM=0,XM=0,GM=0,qM=359,KM=1,ZM=0,JM=!1,QM=!1,eP=0,tP=2,rP=.01,nP=1,sP=0,iP=3,oP=.01,aP=1,cP=0,lP=1,uP=.01,hP=.5,dP=-1e3,fP=1e3,pP=1,gP=1,mP=0,vP=1,yP=.01,bP=1,wP=0,xP=1,_P=.01,SP=0,CP=.5,TP=10,EP=.01,kP=1,IP=0,AP=1,OP=.01,MP=1,jl=16,_d=80;function z1(r){if(!r)return"0";const e=r/ma,t=Math.trunc(e)%60,n=Math.trunc(e/60)%60,s=Math.trunc(e/3600)%60,a=[Math.trunc(e/216e3).toString(),s.toString(),n.toString(),t.toString()];return e<60?`${a[3].padStart(2,"0")}f`:e<3600?`${a[2].padStart(1,"0")}s`:e<216e3?`${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`:`${a[0].padStart(2,"0")}:${a[1].padStart(2,"0")}:${a[2].padStart(2,"0")}`}function PP(r,e=!1){if(!r)return"00:00";const n=1e3/60;if(r<1e3)return e?`${Math.floor(r/n)}f`:`${(r/1e3).toFixed(1)}s`;const s=Math.floor(r/1e3);if(s<60)return`${s}s`;const i=Math.floor(s/60);if(i<60){const h=s%60;return`${i.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}const a=Math.floor(i/60),c=i%60,u=s%60;return`${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}function Qo(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}const W1=({frame:r},{fps:e})=>{const t=r/e,n=Math.floor(t/3600),s=t%3600,i=Math.floor(s/60),a=Math.floor(s%60),c=Math.floor((s-Math.floor(s))*100);return n>0?`${n}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`:`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},H1=({time:r})=>{const e=r/1e3,t=Math.floor(e/3600),n=e%3600,s=Math.floor(n/60),i=Math.floor(n%60),a=Math.floor((n-Math.floor(n))*100);return t>0?`${t}:${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},U1=()=>{const r=document.getElementById("video-current-time");return(r?parseFloat(r.getAttribute("data-current-time")??""):0)*1e3},Jr=[{index:0,unit:18e3,zoom:1/18e3,segments:5},{index:1,unit:10800,zoom:1/10800,segments:3},{index:2,unit:7200,zoom:1/7200,segments:2},{index:3,unit:3600,zoom:1/3600,segments:1},{index:4,unit:1800,zoom:1/1800,segments:2},{index:5,unit:900,zoom:1/900,segments:3},{index:6,unit:600,zoom:1/600,segments:2},{index:7,unit:300,zoom:1/300,segments:5},{index:8,unit:180,zoom:1/180,segments:3},{index:9,unit:120,zoom:1/120,segments:10},{index:10,unit:60,zoom:1/60,segments:5},{index:11,unit:60,zoom:1/60,segments:5},{index:12,unit:30,zoom:1/30,segments:2},{index:13,unit:15,zoom:1/15,segments:3},{index:14,unit:10,zoom:1/10,segments:2},{index:15,unit:5,zoom:1/5,segments:5},{index:16,unit:3,zoom:1/3,segments:3},{index:17,unit:2,zoom:1/2,segments:5},{index:18,unit:1,zoom:1,segments:5},{index:19,unit:1,zoom:2,segments:5},{index:20,unit:1,zoom:4,segments:10}];function Df(r,e){let t=-1,n=r.length-1;for(;1+t<n;){const s=t+(n-t>>1);e(r[s],s,r)?n=s:t=s}return n}function DP(r,e=1){const t=()=>{const u=Math.max(0,il),d=document.getElementById("designcombo-timeline-canvas")?.offsetWidth??document.body.offsetWidth;return Math.max(1,d-u)},n=()=>typeof r=="number"?wt(r,e):K1(r,e),s=t()/n(),i=e*s;return{segments:5,index:Df(Jr,c=>c.zoom>i),zoom:i,unit:1/i}}function RP(r){return Jr[r]}function $1(r){return Y1(r)||Jr[0]}const Y1=r=>{const e=Jr.filter(n=>n.zoom<r.zoom);return e.length===0?null:e.reduce((n,s)=>s.zoom>n.zoom?s:n)},X1=r=>{const e=Jr.filter(n=>n.zoom>r.zoom);return e.length===0?null:e.reduce((n,s)=>s.zoom<n.zoom?s:n)};function G1(r){return X1(r)||Jr[Jr.length-1]}function jP(r){const e=Jr.at(-1),t=r===e,s=q1(r)-(t?1:2);return Math.max(0,s)}function q1(r){const e=Df(Jr,t=>t.zoom>r.zoom);return Math.min(Jr.length-1,e)}function wt(r,e=1,t=1){const n=ma*e;return r*(60/1e3)*n/t}function ss(r,e=1){const t=ma*e;return r/t*V1}function K1(r,e=1){return wt(r,e)}const FP=Math.floor(Math.random()*1e3)+1;function Rf(r,e=1){const t=[],n=Math.floor(e),s=(i,a)=>{for(const c of i)Array.isArray(c)&&a<n?s(c,a+1):t.push(c)};return s(r,0),t}function jf(r,e){const t=e.sort((s,i)=>s.tempIndex-i.tempIndex),n=[];for(const s of t)s.tempIndex<0&&n.push(s);n.push(r);for(const s of t)s.tempIndex>=0&&n.push(s);return n}const Sd={id:"font_UwdNKSyVq2iiMiuHSRRsUIOu",family:"Roboto",fullName:"Roboto Bold",postScriptName:"Roboto-Bold",preview:"https://ik.imagekit.io/lh/fonts/v2/5zQgS86djScKA0ri67BBCqW7.png",style:"Roboto-Bold",url:"https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmWUlvAx05IsDqlA.ttf",category:"sans-serif",createdAt:"2023-06-20T04:42:55.909Z",updatedAt:"2023-06-20T04:42:55.909Z",userId:null},Z1=r=>{const e=r.map(t=>new FontFace(t.fontFamily,`url(${t.fontUrl})`).load());return e.length===0?Promise.resolve(!0):new Promise((t,n)=>{Promise.all(e).then(s=>{s.forEach(i=>{i instanceof FontFace&&i.family&&(document.fonts.add(i),t(!0))})}).catch(s=>{n(s)})})},jv=r=>{let e;const t=new Set,n=(h,d)=>{const p=typeof h=="function"?h(e):h;if(!Object.is(p,e)){const g=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(y=>y(e,g))}},s=()=>e,c={setState:n,getState:s,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h))},u=e=r(n,s,c);return c},LP=r=>r?jv(r):jv,NP=r=>r;function BP(r,e=NP){const t=v.useSyncExternalStore(r.subscribe,()=>e(r.getState()),()=>e(r.getInitialState()));return v.useDebugValue(t),t}const Fv=r=>{const e=LP(r),t=n=>BP(e,n);return Object.assign(t,e),t},J1=r=>r?Fv(r):Fv,is=J1(r=>({timeline:null,size:{width:1080,height:1920},duration:5e3,fps:30,scale:{index:7,unit:300,zoom:1/300,segments:5},scroll:{left:0,top:0},playerRef:null,activeIds:[],targetIds:[],tracks:[],trackItemIds:[],transitionIds:[],transitionsMap:{},trackItemDetailsMap:{},trackItemsMap:{},setTimeline:e=>{r(()=>({timeline:e}))},setScale:e=>{r(()=>({scale:e}))},setScroll:e=>{r(()=>({scroll:e}))},setState:async e=>{r({...e})},setPlayerRef:e=>{r({playerRef:e})}}));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q1=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=v.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...c},u)=>v.createElement("svg",{ref:u,...zP,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Q1("lucide",s),...c},[...a.map(([h,d])=>v.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=(r,e)=>{const t=v.forwardRef(({className:n,...s},i)=>v.createElement(WP,{ref:i,iconNode:e,className:Q1(`lucide-${VP(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=sn("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=sn("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=sn("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=sn("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=sn("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=sn("SquareSplitHorizontal",[["path",{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3",key:"lubmu8"}],["path",{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3",key:"1ag34g"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=sn("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=sn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=sn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=sn("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=sn("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Fl=r=>{const e=v.useCallback(n=>{if(!r?.current)return()=>{};const s=()=>{n()};return r.current.addEventListener("frameupdate",s),()=>{r.current&&r.current.removeEventListener("frameupdate",s)}},[r]);return v.useSyncExternalStore(e,()=>r?.current?.getCurrentFrame()??0,()=>0)},va=()=>{const[r,e]=v.useState(!1);return v.useEffect(()=>{const n=Fe.subject.pipe(Bs(({key:s})=>s.startsWith(k1))).subscribe(s=>{s.key===If?e(!0):s.key===Jo&&e(!1)});return()=>n.unsubscribe()},[]),r},eb=()=>{const[r,e]=v.useState(!1),{duration:t,fps:n,scale:s,playerRef:i,activeIds:a}=is(),c=Fl(i),u=()=>{Fe.dispatch(_f)},h=()=>{Fe.dispatch(Cf,{payload:{},options:{time:U1()}})},d=y=>{Fe.dispatch(kf,{payload:{scale:y}})},p=()=>{Fe.dispatch(x1)},g=()=>{Fe.dispatch(_1)};return v.useEffect(()=>(i?.current?.addEventListener("play",()=>{e(!0)}),i?.current?.addEventListener("pause",()=>{e(!1)}),()=>{i?.current?.removeEventListener("play",()=>{e(!0)}),i?.current?.removeEventListener("pause",()=>{e(!1)})}),[i]),w.jsx("div",{style:{position:"relative",height:"50px",boxShadow:"inset 0 1px 0 0 #27272a",flex:"none"},className:"bg-background",children:w.jsx("div",{style:{position:"absolute",height:50,width:"100%",display:"flex",alignItems:"center"},children:w.jsxs("div",{style:{height:36,width:"100%",display:"grid",gridTemplateColumns:"1fr 260px 1fr",alignItems:"center"},children:[w.jsxs("div",{className:"flex px-2",children:[w.jsxs(Wt,{disabled:!a.length,onClick:u,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[w.jsx(GP,{size:14})," Delete"]}),w.jsxs(Wt,{disabled:!a.length,onClick:h,variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[w.jsx(Lv,{size:15})," Split"]}),w.jsxs(Wt,{disabled:!a.length,onClick:()=>{Fe.dispatch(Sf)},variant:"ghost",size:"sm",className:"flex items-center gap-1 px-2",children:[w.jsx(Lv,{size:15})," Clone"]})]}),w.jsxs("div",{className:"flex items-center justify-center",children:[w.jsxs("div",{children:[w.jsx(Wt,{onClick:u,variant:"ghost",size:"icon",children:w.jsx(YP,{size:14})}),w.jsx(Wt,{onClick:()=>{if(r)return g();p()},variant:"ghost",size:"icon",children:r?w.jsx(UP,{size:14}):w.jsx($P,{size:14})}),w.jsx(Wt,{onClick:h,variant:"ghost",size:"icon",children:w.jsx(XP,{size:14})})]}),w.jsxs("div",{className:"text-xs font-light",style:{display:"grid",alignItems:"center",gridTemplateColumns:"54px 4px 54px",paddingTop:"2px",justifyContent:"center"},children:[w.jsx("div",{className:"font-medium text-zinc-200",style:{display:"flex",justifyContent:"center"},"data-current-time":c/n,id:"video-current-time",children:W1({frame:c},{fps:n})}),w.jsx("span",{children:"/"}),w.jsx("div",{className:"text-muted-foreground",style:{display:"flex",justifyContent:"center"},children:H1({time:t})})]})]}),w.jsx(JP,{scale:s,onChangeTimelineScale:d,duration:t})]})})})},JP=({scale:r,onChangeTimelineScale:e,duration:t})=>{const n=()=>{const i=$1(r);e(i)},s=()=>{const i=G1(r);e(i)};return w.jsx("div",{className:"flex items-center justify-end",children:w.jsxs("div",{className:"flex border-l border-border pl-4 pr-2",children:[w.jsx(Wt,{size:"icon",variant:"ghost",onClick:n,disabled:r.index===0,children:w.jsx(ZP,{size:16})}),w.jsx(Wt,{size:"icon",variant:"ghost",onClick:s,disabled:r.index===20,children:w.jsx(KP,{size:16})})]})})},tb=[{id:"1",details:{src:"https://cdn.designcombo.dev/audio/Dawn%20of%20change.mp3",text:"Voiceover"},name:"Dawn of change",type:"audio",metadata:{author:"Roman Senyk"},display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/audio/Hope.mp3"},name:"Hope",type:"audio",metadata:{author:"Hugo Dujardin"}},{id:"3",details:{src:"https://cdn.designcombo.dev/audio/Tenderness.mp3"},name:"Tenderness",type:"audio",metadata:{author:"Benjamin Tissot"}},{id:"4",details:{src:"https://cdn.designcombo.dev/audio/Piano%20Moment.mp3"},name:"Piano moment",type:"audio",metadata:{author:"Benjamin Tissot"}}],rb=[{id:"1",details:{src:"https://ik.imagekit.io/wombo/images/img1.jpg"},preview:"https://ik.imagekit.io/wombo/images/img1.jpg?tr=w-190",type:"image"},{id:"2",details:{src:"https://ik.imagekit.io/wombo/images/img2.jpg"},preview:"https://ik.imagekit.io/wombo/images/img2.jpg?tr=w-190",type:"image"},{id:"3",details:{src:"https://ik.imagekit.io/wombo/images/img3.jpg"},preview:"https://ik.imagekit.io/wombo/images/img3.jpg?tr=w-190",type:"image"},{id:"4",details:{src:"https://ik.imagekit.io/wombo/images/img4.jpg"},preview:"https://ik.imagekit.io/wombo/images/img4.jpg?tr=w-190",type:"image"},{id:"5",details:{src:"https://ik.imagekit.io/wombo/images/img5.jpg"},preview:"https://ik.imagekit.io/wombo/images/img5.jpg?tr=w-190",type:"image"},,{id:"6",details:{src:"https://ik.imagekit.io/wombo/images/img6.jpg"},preview:"https://ik.imagekit.io/wombo/images/img6.jpg?tr=w-190",type:"image"},{id:"7",details:{src:"https://ik.imagekit.io/wombo/images/img7.jpg"},preview:"https://ik.imagekit.io/wombo/images/img7.jpg?tr=w-190",type:"image"}],nb=[{id:"1",details:{src:"https://cdn.designcombo.dev/videos/demo-video-1.mp4",text:"Scene"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-1.png",duration:17e3,display:{from:3e3}},{id:"2",details:{src:"https://cdn.designcombo.dev/videos/demo-video-2.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-2.png"},{id:"3",details:{src:"https://cdn.designcombo.dev/videos/demo-video-3.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-3.png",duration:2e4},{id:"4",details:{src:"https://cdn.designcombo.dev/videos/demo-video-4.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-4.png",duration:2e4},{id:"5",details:{src:"https://cdn.designcombo.dev/videos/demo-video-5.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-5.png",duration:23e3},{id:"6",details:{src:"https://cdn.designcombo.dev/videos/demo-video-6.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-6.png",duration:1e4},{id:"7",details:{src:"https://cdn.designcombo.dev/videos/demo-video-7.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-7.png",duration:12e3},{id:"8",details:{src:"https://cdn.designcombo.dev/videos/demo-video-8.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-8.png",duration:15e3},{id:"9",details:{src:"https://cdn.designcombo.dev/videos/demo-video-9.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-9.png",duration:15e3},{id:"10",details:{src:"https://cdn.designcombo.dev/videos/demo-video-10.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-10.png",duration:5e3},{id:"11",details:{src:"https://cdn.designcombo.dev/videos/demo-video-11.mp4"},type:"video",preview:"https://cdn.designcombo.dev/thumbnails/demo-video-s-11.png",duration:5e3}],sb=[{id:"1",kind:"none",duration:0,preview:"https://ik.imagekit.io/wombo/transitions-v2/transition-none.png",type:"transition"},{id:"2",kind:"fade",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/fade.webp",type:"transition"},{id:"3",kind:"slide",name:"slide up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-up.webp",type:"transition",direction:"from-bottom"},{id:"4",kind:"slide",name:"slide down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-down.webp",type:"transition",direction:"from-top"},{id:"5",kind:"slide",name:"slide left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-left.webp",type:"transition",direction:"from-right"},{id:"6",kind:"slide",name:"slide right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/slide-right.webp",type:"transition",direction:"from-left"},{id:"7",kind:"wipe",name:"wipe up",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-up.webp",type:"transition",direction:"from-bottom"},{id:"8",kind:"wipe",name:"wipe down",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-down.webp",type:"transition",direction:"from-top"},{id:"9",kind:"wipe",name:"wipe left",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-left.webp",type:"transition",direction:"from-right"},{id:"10",kind:"wipe",name:"wipe right",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/wipe-right.webp",type:"transition",direction:"from-left"},{id:"11",kind:"flip",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/flip.webp",type:"transition"},{id:"12",kind:"clockWipe",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/clock-wipe.webp",type:"transition"},{id:"13",kind:"star",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/star.webp",type:"transition"},{id:"14",kind:"circle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/circle.webp",type:"transition"},{id:"15",kind:"rectangle",duration:.5,preview:"https://ik.imagekit.io/wombo/transitions-v2/rectangle.webp",type:"transition"}],QP=[{id:"1",src:"https://ik.imagekit.io/snapmotion/upload-video-1.mp4",type:"video"},{id:"2",src:"https://ik.imagekit.io/snapmotion/upload-video-2.mp4",type:"video"},{id:"3",src:"https://ik.imagekit.io/snapmotion/upload-video-3.mp4",type:"video"}],eD=()=>{const r=va();return w.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Transitions"}),w.jsx(ei,{children:w.jsx("div",{className:"grid grid-cols-3 gap-2 px-4",children:sb.map((e,t)=>w.jsx(tD,{transition:e,shouldDisplayPreview:!r},t))})})]})},tD=({transition:r,shouldDisplayPreview:e})=>{const t=v.useMemo(()=>({backgroundImage:`url(${r.preview})`,backgroundSize:"cover",width:"70px",height:"70px"}),[r.preview]);return w.jsx(ga,{data:r,renderCustomPreview:w.jsx("div",{style:t}),shouldDisplayPreview:e,children:w.jsxs("div",{children:[w.jsx("div",{children:w.jsx("div",{style:t,draggable:!1})}),w.jsx("div",{className:"flex h-6 items-center overflow-ellipsis text-nowrap text-[12px] capitalize text-muted-foreground",children:r.name||r.type})]})})},rD=()=>{const r=()=>{Fe.dispatch(xf,{payload:{id:At(),display:{from:0,to:5e3},details:{text:"Heading and some body",fontSize:120,width:600,fontUrl:Sd.url,fontFamily:Sd.postScriptName,color:"#ffffff",wordWrap:"break-word",textAlign:"center",borderWidth:0,borderColor:"#000000",boxShadow:{color:"#ffffff",x:0,y:0,blur:0}}},options:{}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Text"}),w.jsx("div",{className:"flex flex-col gap-2 px-4",children:w.jsx(Wt,{draggable:!1,onClick:r,variant:"secondary",className:"w-full",children:"Add text"})})]})},nD=()=>{const r=v.useRef(null),e=n=>{t(n)},t=async n=>{const s=n[0].type;s.includes("audio")&&Fe.dispatch(Xi,{payload:{id:At(),details:{src:URL.createObjectURL(n[0]),volume:50}}}),s.includes("video")&&Fe.dispatch(Yi,{payload:{id:At(),display:{from:2e3,to:7e3},details:{src:URL.createObjectURL(n[0]),name:n[0].name}}}),s.includes("image")&&Fe.dispatch(Gi,{payload:{id:At(),details:{src:URL.createObjectURL(n[0])}}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Your media"}),w.jsx("input",{ref:r,id:"file-upload-handle",type:"file",accept:"audio/*,video/*,image/*",onChange:n=>e(Array.from(n.target.files||[])),className:"hidden"}),w.jsx("div",{className:"px-4 py-2",children:w.jsx("div",{children:w.jsxs(b1,{defaultValue:"projects",className:"w-full",children:[w.jsxs(wf,{className:"grid w-full grid-cols-2",children:[w.jsx(nl,{value:"projects",children:"Project"}),w.jsx(nl,{value:"workspace",children:"Workspace"})]}),w.jsxs(sl,{value:"projects",children:[w.jsxs(Wt,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[w.jsx(Nv,{size:16})," Upload"]}),w.jsx("div",{})]}),w.jsx(sl,{value:"workspace",children:w.jsxs(Wt,{onClick:()=>{r.current?.click()},className:"flex w-full gap-2",variant:"secondary",children:[w.jsx(Nv,{size:16})," Upload"]})})]})})}),w.jsx(ei,{children:w.jsx("div",{className:"masonry-sm px-4"})})]})},sD=()=>{const r=va(),e=t=>{Fe.dispatch(Xi,{payload:t,options:{}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Audios"}),w.jsx(ei,{children:w.jsx("div",{className:"flex flex-col px-2",children:tb.map((t,n)=>w.jsx(iD,{shouldDisplayPreview:!r,handleAddAudio:e,audio:t},n))})})]})},iD=({handleAddAudio:r,audio:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:"url(https://cdn.designcombo.dev/thumbnails/music-preview.png)",backgroundSize:"cover",width:"70px",height:"70px"}),[]);return w.jsx(ga,{data:e,renderCustomPreview:w.jsx("div",{style:n}),shouldDisplayPreview:t,children:w.jsxs("div",{draggable:!1,onClick:()=>r(e),style:{display:"grid",gridTemplateColumns:"48px 1fr"},className:"flex cursor-pointer gap-4 px-2 py-1 text-sm hover:bg-zinc-800/70",children:[w.jsx("div",{className:"flex h-12 items-center justify-center bg-zinc-800",children:w.jsx(HP,{width:16})}),w.jsxs("div",{className:"flex flex-col justify-center",children:[w.jsx("div",{children:e.name}),w.jsx("div",{className:"text-zinc-400",children:e.metadata?.author})]})]})})},oD=()=>{const r=va(),e=t=>{Fe.dispatch(Gi,{payload:t,options:{trackId:"main"}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Photos"}),w.jsx(ei,{children:w.jsx("div",{className:"masonry-sm px-4",children:rb.map((t,n)=>w.jsx(aD,{image:t,shouldDisplayPreview:!r,handleAddImage:e},n))})})]})},aD=({handleAddImage:r,image:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return w.jsx(ga,{data:e,renderCustomPreview:w.jsx("div",{style:n}),shouldDisplayPreview:t,children:w.jsx("div",{onClick:()=>r({id:At(),details:{src:e.details.src}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:w.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},cD=()=>{const r=va(),e=t=>{Fe.dispatch(Yi,{payload:t,options:{resourceId:"main"}})};return w.jsxs("div",{className:"flex flex-1 flex-col",children:[w.jsx("div",{className:"text-text-primary flex h-12 flex-none items-center px-4 text-sm font-medium",children:"Videos"}),w.jsx(ei,{children:w.jsx("div",{className:"masonry-sm px-4",children:nb.map((t,n)=>w.jsx(lD,{video:t,shouldDisplayPreview:!r,handleAddVideo:e},n))})})]})},lD=({handleAddVideo:r,video:e,shouldDisplayPreview:t})=>{const n=v.useMemo(()=>({backgroundImage:`url(${e.preview})`,backgroundSize:"cover",width:"80px",height:"80px"}),[e.preview]);return w.jsx(ga,{data:e,renderCustomPreview:w.jsx("div",{style:n,className:"draggable"}),shouldDisplayPreview:t,children:w.jsx("div",{onClick:()=>r({...e,id:At(),details:{src:e.details.src,...e.details}}),className:"flex w-full items-center justify-center overflow-hidden bg-background pb-2",children:w.jsx("img",{draggable:!1,src:e.preview,className:"h-full w-full rounded-md object-cover",alt:"image"})})})},Ff=J1(r=>({activeMenuItem:null,showMenuItem:!1,cropTarget:null,showControlItem:!1,showToolboxItem:!1,activeToolboxItem:null,setCropTarget:e=>r({cropTarget:e}),setActiveMenuItem:e=>r({activeMenuItem:e}),setShowMenuItem:e=>r({showMenuItem:e}),setShowControlItem:e=>r({showControlItem:e}),setShowToolboxItem:e=>r({showToolboxItem:e}),setActiveToolboxItem:e=>r({activeToolboxItem:e})})),uD=({children:r})=>{const{showMenuItem:e,setShowMenuItem:t}=Ff(),n=()=>{t(!1)};return w.jsxs("div",{style:{left:e?"0":"-100%",transition:"left 0.25s ease-in-out",zIndex:200},className:"absolute top-1/2 mt-6 flex h-[calc(100%-32px-64px)] w-[340px] -translate-y-1/2 rounded-lg shadow-lg",children:[w.jsx("div",{className:"w-[74px]"}),w.jsxs("div",{className:"relative flex flex-1 bg-background/80 backdrop-blur-lg backdrop-filter",children:[w.jsx(Wt,{variant:"ghost",className:"absolute right-2 top-2 h-8 w-8 text-muted-foreground",size:"icon",children:w.jsx(qP,{width:16,onClick:n})}),r]})]})},hD=()=>{const{activeMenuItem:r}=Ff();return r==="transitions"?w.jsx(eD,{}):r==="texts"?w.jsx(rD,{}):r==="videos"?w.jsx(cD,{}):r==="audios"?w.jsx(sD,{}):r==="images"?w.jsx(oD,{}):r==="uploads"?w.jsx(nD,{}):null},dD=()=>w.jsx(uD,{children:w.jsx(hD,{})}),Bv={redo:({...r})=>w.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:w.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2957 4.15721C13.9052 3.76669 13.9052 3.13352 14.2957 2.743C14.6862 2.35247 15.3194 2.35247 15.7099 2.743L20.953 7.98603C21.1387 8.16758 21.2539 8.42087 21.2539 8.70108C21.2539 8.70111 21.2539 8.70114 21.2539 8.70117C21.2539 8.70431 21.2539 8.70744 21.2539 8.71057C21.2518 8.93273 21.1773 9.13757 21.0528 9.30262C21.0249 9.33973 20.9942 9.37505 20.961 9.40828L15.7099 14.6593C15.3194 15.0499 14.6862 15.0499 14.2957 14.6593C13.9052 14.2688 13.9052 13.6357 14.2957 13.2451L17.8398 9.70108H9.22665C8.59943 9.70108 7.97836 9.82462 7.39888 10.0646C6.81941 10.3047 6.29289 10.6565 5.84938 11.1C5.40587 11.5435 5.05406 12.07 4.81403 12.6495C4.57401 13.229 4.45047 13.85 4.45047 14.4773C4.45047 15.1045 4.57401 15.7256 4.81403 16.305C5.05406 16.8845 5.40587 17.411 5.84938 17.8545C6.29289 18.298 6.81941 18.6498 7.39888 18.8899C7.97836 19.1299 8.59943 19.2534 9.22665 19.2534H12.9024C13.4547 19.2534 13.9024 19.7012 13.9024 20.2534C13.9024 20.8057 13.4547 21.2534 12.9024 21.2534H9.22665C8.33679 21.2534 7.45564 21.0782 6.63352 20.7376C5.81139 20.3971 5.06439 19.898 4.43517 19.2687C3.80594 18.6395 3.30681 17.8925 2.96627 17.0704C2.62574 16.2483 2.45047 15.3671 2.45047 14.4773C2.45047 13.5874 2.62574 12.7063 2.96627 11.8841C3.30681 11.062 3.80594 10.315 4.43517 9.68578C5.06439 9.05655 5.81139 8.55742 6.63352 8.21689C7.45564 7.87635 8.33679 7.70108 9.22665 7.70108H17.8396L14.2957 4.15721Z",fill:"currentColor"})}),undo:({...r})=>w.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r,children:w.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.60387 4.30711C9.99439 3.91659 9.99439 3.28342 9.60387 2.8929C9.21334 2.50238 8.58018 2.50237 8.18965 2.8929L2.8925 8.19004C2.70497 8.37758 2.59961 8.63193 2.59961 8.89715C2.59961 9.16237 2.70497 9.41672 2.8925 9.60426L8.18965 14.9014C8.58018 15.2919 9.21334 15.2919 9.60387 14.9014C9.99439 14.5109 9.99439 13.8777 9.60387 13.4872L5.86478 9.7481H15.1044C15.7383 9.7481 16.366 9.87295 16.9516 10.1155C17.5372 10.3581 18.0693 10.7136 18.5176 11.1619C18.9658 11.6101 19.3213 12.1422 19.5639 12.7278C19.8065 13.3134 19.9313 13.9411 19.9313 14.575C19.9313 15.2088 19.8065 15.8365 19.5639 16.4221C19.3213 17.0077 18.9658 17.5398 18.5176 17.9881C18.0693 18.4363 17.5372 18.7918 16.9516 19.0344C16.366 19.277 15.7383 19.4018 15.1044 19.4018H11.3964C10.8442 19.4018 10.3964 19.8495 10.3964 20.4018C10.3964 20.9541 10.8442 21.4018 11.3964 21.4018H15.1044C16.001 21.4018 16.8887 21.2252 17.717 20.8822C18.5452 20.5391 19.2978 20.0362 19.9318 19.4023C20.5657 18.7683 21.0686 18.0158 21.4116 17.1875C21.7547 16.3592 21.9313 15.4715 21.9313 14.575C21.9313 13.6784 21.7547 12.7907 21.4116 11.9624C21.0686 11.1342 20.5657 10.3816 19.9318 9.74764C19.2978 9.11371 18.5452 8.61085 17.717 8.26777C16.8887 7.92469 16.001 7.7481 15.1044 7.7481H6.16287L9.60387 4.30711Z",fill:"currentColor"})})};function fD(){const r=()=>{Fe.dispatch(Tf)},e=()=>{Fe.dispatch(Ef)};return w.jsx("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr 320px"},className:"pointer-events-none absolute left-0 right-0 top-0 z-[205] flex h-[72px] items-center px-2",children:w.jsxs("div",{className:"pointer-events-auto flex h-14 items-center gap-2",children:[w.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-md bg-background"}),w.jsxs("div",{className:"flex h-12 items-center bg-background px-1.5",children:[w.jsx(Wt,{onClick:r,className:"text-muted-foreground",variant:"ghost",size:"icon",children:w.jsx(Bv.undo,{width:20})}),w.jsx(Wt,{onClick:e,className:"text-muted-foreground",variant:"ghost",size:"icon",children:w.jsx(Bv.redo,{width:20})})]})]})})}var pD=Object.defineProperty,ib=(r,e)=>{for(var t in e)pD(r,t,{get:e[t],enumerable:!0,configurable:!0,set:n=>e[t]=()=>n})};if(typeof v.createContext!="function"){const r=['Remotion requires React.createContext, but it is "undefined".','If you are in a React Server Component, turn it into a client component by adding "use client" at the top of the file.',"","Before:",'  import {useCurrentFrame} from "remotion";',"","After:",'  "use client";','  import {useCurrentFrame} from "remotion";'];throw new Error(r.join(`
`))}function Vv(){return["NOD","E_EN","V"].join("")}var zv=()=>["e","nv"].join(""),St=()=>{const r=typeof window<"u"&&window.remotion_isPlayer,e=typeof window<"u"&&typeof window.process<"u"&&typeof window.process.env<"u"&&(window.process[zv()][Vv()]==="test"||window.process[zv()][Vv()]==="production"&&typeof window<"u"&&typeof window.remotion_puppeteerTimeout<"u");return{isStudio:typeof window<"u"&&window.remotion_isStudio,isRendering:e,isPlayer:r}},gD=v.createElement,ob=[],ab=()=>{if(!St().isStudio)return;const r=new Proxy(gD,{apply(e,t,n){if(ob.includes(n[0])){const[s,i,...a]=n,c={...i??{},stack:new Error().stack};return Reflect.apply(e,t,[s,c,...a])}return Reflect.apply(e,t,n)}});v.createElement=r},ya=r=>{ob.push(r),ab()},cb=v.createContext(!1),mD=({children:r})=>w.jsx(cb.Provider,{value:!0,children:r}),Lf=()=>v.useContext(cb);function Ll(r){return!!r}var _c="4.0.229",vD=()=>{if(typeof globalThis>"u")return;const r=globalThis.remotion_imported||typeof window<"u"&&window.remotion_imported;if(r){if(r===_c)return;throw new TypeError(` Multiple versions of Remotion detected: ${[_c,typeof r=="string"?r:"an older version"].filter(Ll).join(" and ")}. This will cause things to break in an unexpected way.
Check that all your Remotion packages are on the same version. If your dependencies depend on Remotion, make them peer dependencies. You can also run \`npx remotion versions\` from your terminal to see which versions are mismatching.`)}globalThis.remotion_imported=_c,typeof window<"u"&&(window.remotion_imported=_c)},yD=(r,e)=>{const{style:t,...n}=r,s=v.useMemo(()=>({position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",...t}),[t]);return w.jsx("div",{ref:e,style:s,...n})},Vo=v.forwardRef(yD),Ut=v.createContext(null),Ki=v.createContext({registerSequence:()=>{throw new Error("SequenceManagerContext not initialized")},unregisterSequence:()=>{throw new Error("SequenceManagerContext not initialized")},sequences:[]}),ba=v.createContext({hidden:{},setHidden:()=>{throw new Error("SequenceVisibilityToggle not initialized")}}),bD=({children:r})=>{const[e,t]=v.useState([]),[n,s]=v.useState({}),i=v.useCallback(h=>{t(d=>[...d,h])},[]),a=v.useCallback(h=>{t(d=>d.filter(p=>p.id!==h))},[]),c=v.useMemo(()=>({registerSequence:i,sequences:e,unregisterSequence:a}),[i,e,a]),u=v.useMemo(()=>({hidden:n,setHidden:s}),[n]);return w.jsx(Ki.Provider,{value:c,children:w.jsx(ba.Provider,{value:u,children:r})})},Zi=v.createContext({getNonce:()=>0,fastRefreshes:0}),Nf=()=>{const r=v.useContext(Zi),[e,t]=v.useState(()=>r.getNonce()),n=v.useRef(r);return v.useEffect(()=>{n.current!==r&&(n.current=r,t(r.getNonce))},[r]),e},lb={};ib(lb,{useTimelineSetFrame:()=>_b,useTimelinePosition:()=>ti,usePlayingState:()=>Wf,persistCurrentFrame:()=>bb,getInitialFrameState:()=>wb,getFrameForComposition:()=>xb,TimelineContext:()=>Qr,SetTimelineContext:()=>Ji});var gs=v.createContext({compositions:[],registerComposition:()=>{},unregisterComposition:()=>{},registerFolder:()=>{},unregisterFolder:()=>{},setCurrentCompositionMetadata:()=>{},updateCompositionDefaultProps:()=>{},folders:[],currentCompositionMetadata:null,canvasContent:null,setCanvasContent:()=>{}}),Nl=v.createContext({props:{},updateProps:()=>{throw new Error("Not implemented")},resetUnsaved:()=>{throw new Error("Not implemented")}}),ub=v.createRef(),hb=({children:r})=>{const[e,t]=v.useState({}),n=v.useCallback(({defaultProps:a,id:c,newProps:u})=>{t(h=>({...h,[c]:typeof u=="function"?u(h[c]??a):u}))},[]),s=v.useCallback(()=>{t({})},[]);v.useImperativeHandle(ub,()=>({getProps:()=>e,setProps:t}),[e]);const i=v.useMemo(()=>({props:e,updateProps:n,resetUnsaved:s}),[e,s,n]);return w.jsx(Nl.Provider,{value:i,children:r})},wD={"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";"},Wv={},xD=r=>{Wv[r]||(console.warn(r),Wv[r]=!0)},_D=r=>{for(const e of Object.keys(wD))if(r.includes(e))return{containsHex:!0,hexCode:e};return{containsHex:!1}},Cd=r=>r.startsWith("/")?Cd(r.substring(1)):r,SD=r=>{if(typeof window<"u"&&window.remotion_staticBase){if(r.startsWith(window.remotion_staticBase))throw new Error(`The value "${r}" is already prefixed with the static base ${window.remotion_staticBase}. You don't need to call staticFile() on it.`);return`${window.remotion_staticBase}/${Cd(r)}`}return`/${Cd(r)}`},CD=r=>r.split("/").map(s=>encodeURIComponent(s)).join("/"),TD=r=>{if(r===null)throw new TypeError("null was passed to staticFile()");if(typeof r>"u")throw new TypeError("undefined was passed to staticFile()");if(r.startsWith("http://")||r.startsWith("https://"))throw new TypeError(`staticFile() does not support remote URLs - got "${r}". Instead, pass the URL without wrapping it in staticFile(). See: https://remotion.dev/docs/staticfile-remote-urls`);if(r.startsWith("..")||r.startsWith("./"))throw new TypeError(`staticFile() does not support relative paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("/Users")||r.startsWith("/home")||r.startsWith("/tmp")||r.startsWith("/etc")||r.startsWith("/opt")||r.startsWith("/var")||r.startsWith("C:")||r.startsWith("D:")||r.startsWith("E:"))throw new TypeError(`staticFile() does not support absolute paths - got "${r}". Instead, pass the name of a file that is inside the public/ folder. See: https://remotion.dev/docs/staticfile-relative-paths`);if(r.startsWith("public/"))throw new TypeError(`Do not include the public/ prefix when using staticFile() - got "${r}". See: https://remotion.dev/docs/staticfile-relative-paths`);const e=_D(r);e.containsHex&&xD(`WARNING: You seem to pass an already encoded path (path contains ${e.hexCode}). Since Remotion 4.0, the encoding is done by staticFile() itself. You may want to remove a encodeURIComponent() wrapping.`);const t=CD(r),n=SD(t);return n.startsWith("/")?n:`/${n}`},Td="remotion-date:",Ed="remotion-file:",ED=({data:r,indent:e,staticBase:t})=>{let n=!1,s=!1,i=!1,a=!1;try{return{serializedString:JSON.stringify(r,function(u,h){const d=this[u];return d instanceof Date?(n=!0,`${Td}${d.toISOString()}`):d instanceof Map?(i=!0,h):d instanceof Set?(a=!0,h):typeof d=="string"&&t!==null&&d.startsWith(t)?(s=!0,`${Ed}${d.replace(t+"/","")}`):h},e),customDateUsed:n,customFileUsed:s,mapUsed:i,setUsed:a}}catch(c){throw new Error("Could not serialize the passed input props to JSON: "+c.message)}},db=r=>JSON.parse(r,(e,t)=>typeof t=="string"&&t.startsWith(Td)?new Date(t.replace(Td,"")):typeof t=="string"&&t.startsWith(Ed)?TD(t.replace(Ed,"")):t),Ds=r=>St().isStudio?db(ED({data:r,indent:2,staticBase:window.remotion_staticBase}).serializedString):r,Hv=!1,kD=()=>{Hv||(Hv=!0,console.warn("Called `getInputProps()` on the server. This function is not available server-side and has returned an empty object."),console.warn("To hide this warning, don't call this function on the server:"),console.warn("  typeof window === 'undefined' ? {} : getInputProps()"))},fb=()=>{if(typeof window>"u")return kD(),{};if(St().isPlayer)throw new Error("You cannot call `getInputProps()` from a <Player>. Instead, the props are available as React props from component that you passed as `component` prop.");const r=window.remotion_inputProps;return r?db(r):{}},Uv=["h264","h265","vp8","vp9","mp3","aac","wav","prores","h264-mkv","h264-ts","gif"];function ID(r,e){if(!(typeof r>"u")){if(typeof r!="string")throw new TypeError(`The "defaultCodec" prop ${e} must be a string, but you passed a value of type ${typeof r}.`);if(!Uv.includes(r))throw new Error(`The "defaultCodec" prop ${e} must be one of ${Uv.join(", ")}, but you passed ${r}.`)}}function ol(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function Bf(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function pb(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`)}var $v=({calculated:r,compositionId:e,compositionFps:t,compositionHeight:n,compositionWidth:s,compositionDurationInFrames:i})=>{const a=`calculated by calculateMetadata() for the composition "${e}"`,c=`of the "<Composition />" component with the id "${e}"`,u=r?.width??s??void 0;ol(u,"width",r?.width?a:c);const h=r?.height??n??void 0;ol(h,"height",r?.height?a:c);const d=r?.fps??t??null;pb(d,r?.fps?a:c);const p=r?.durationInFrames??i??null;Bf(p,{allowFloats:!1,component:`of the "<Composition />" component with the id "${e}"`});const g=r?.defaultCodec;return ID(g,a),{width:u,height:h,fps:d,durationInFrames:p,defaultCodec:g}},gb=({calculateMetadata:r,signal:e,defaultProps:t,originalProps:n,compositionId:s,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u})=>{const h=r?r({defaultProps:t,props:n,abortSignal:e,compositionId:s}):null;if(h!==null&&typeof h=="object"&&"then"in h)return h.then(p=>{const{height:g,width:y,durationInFrames:b,fps:_,defaultCodec:S}=$v({calculated:p,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:s});return{width:y,height:g,fps:_,durationInFrames:b,id:s,defaultProps:Ds(t),props:Ds(p.props??n),defaultCodec:S??null}});const d=$v({calculated:h,compositionDurationInFrames:i,compositionFps:a,compositionHeight:c,compositionWidth:u,compositionId:s});return h===null?{...d,id:s,defaultProps:Ds(t??{}),props:Ds(n),defaultCodec:null}:{...d,id:s,defaultProps:Ds(t??{}),props:Ds(h.props??n),defaultCodec:h.defaultCodec??null}},AD=r=>{try{return{type:"success",result:gb(r)}}catch(e){return{type:"error",error:e}}},Bl=v.createContext(null),mb=v.createRef(),vb=r=>!!r.calculateMetadata,OD="remotion.propsUpdatedExternally",yb=({children:r})=>{const[e,t]=v.useState(null),{compositions:n,canvasContent:s,currentCompositionMetadata:i}=v.useContext(gs),{fastRefreshes:a}=v.useContext(Zi),c=v.useMemo(()=>n.find(L=>s&&s.type==="composition"&&s.compositionId===L.id),[s,n]),u=n.find(L=>L.id===e),{props:h}=v.useContext(Nl),d=v.useMemo(()=>typeof window>"u"||St().isPlayer?{}:fb()??{},[]),[p,g]=v.useState({}),y=v.useMemo(()=>c?h[c.id]??{}:{},[h,c]),b=v.useMemo(()=>u?h[u.id]??{}:{},[h,u]),_=!!i,S=v.useCallback(({calculateMetadata:L,combinedProps:Y,compositionDurationInFrames:W,compositionFps:q,compositionHeight:U,compositionId:X,compositionWidth:te,defaultProps:de})=>{const J=new AbortController;if(_)return J;const{signal:le}=J,ie=AD({compositionId:X,calculateMetadata:L,originalProps:Y,signal:le,defaultProps:de,compositionDurationInFrames:W,compositionFps:q,compositionHeight:U,compositionWidth:te});if(ie.type==="error")return g(he=>({...he,[X]:{type:"error",error:ie.error}})),J;const se=ie.result;return typeof se=="object"&&"then"in se?(g(he=>{const re=he[X];return re?.type==="success"||re?.type==="success-and-refreshing"?{...he,[X]:{type:"success-and-refreshing",result:re.result}}:{...he,[X]:{type:"loading"}}}),se.then(he=>{J.signal.aborted||g(re=>({...re,[X]:{type:"success",result:he}}))}).catch(he=>{J.signal.aborted||g(re=>({...re,[X]:{type:"error",error:he}}))})):g(he=>({...he,[X]:{type:"success",result:se}})),J},[_]),T=s?.type==="composition"?s.compositionId:null;v.useImperativeHandle(mb,()=>({setCurrentRenderModalComposition:L=>{t(L)},reloadCurrentlySelectedComposition:()=>{if(!T)return;const L=n.find(U=>U.id===T);if(!L)throw new Error(`Could not find composition with id ${T}`);const Y=h[T]??{},W={...L.defaultProps??{},...Y??{}},q={...W,...d??{}};S({defaultProps:W,calculateMetadata:L.calculateMetadata,combinedProps:q,compositionDurationInFrames:L.durationInFrames??null,compositionFps:L.fps??null,compositionHeight:L.height??null,compositionWidth:L.width??null,compositionId:L.id})}}),[h,n,T,S,d]);const k=c?.id===u?.id,I=v.useMemo(()=>({...c?.defaultProps??{},...y??{}}),[c?.defaultProps,y]),A=v.useMemo(()=>({...I,...d??{}}),[I,d]),D=c&&vb(c),F=typeof window<"u"&&window.remotion_ignoreFastRefreshUpdate&&a<=window.remotion_ignoreFastRefreshUpdate;v.useEffect(()=>{if(!F&&D){const L=S({calculateMetadata:c.calculateMetadata,combinedProps:A,compositionDurationInFrames:c.durationInFrames??null,compositionFps:c.fps??null,compositionHeight:c.height??null,compositionWidth:c.width??null,defaultProps:I,compositionId:c.id});return()=>{L.abort()}}},[D,I,S,A,c?.calculateMetadata,c?.durationInFrames,c?.fps,c?.height,c?.id,c?.width,F]),v.useEffect(()=>{F||window.dispatchEvent(new CustomEvent("remotion.propsUpdatedExternally"))},[a]),v.useEffect(()=>{if(u&&!k){const L={...u.defaultProps??{},...b??{},...d??{}},Y=S({calculateMetadata:u.calculateMetadata,compositionDurationInFrames:u.durationInFrames??null,compositionFps:u.fps??null,compositionHeight:u.height??null,compositionId:u.id,compositionWidth:u.width??null,defaultProps:I,combinedProps:L});return()=>{Y.abort()}}},[I,S,d,k,u,b]);const z=v.useMemo(()=>{const L=n.filter(Y=>Y.calculateMetadata===null);return{...p,...L.reduce((Y,W)=>({...Y,[W.id]:{type:"success",result:{...W,defaultProps:W.defaultProps??{}}}}),{})}},[n,p]);return w.jsx(Bl.Provider,{value:z,children:r})},Vf=r=>{const e=v.useContext(Bl),{props:t}=v.useContext(Nl),{compositions:n,canvasContent:s,currentCompositionMetadata:i}=v.useContext(gs),a=s?.type==="composition"?s.compositionId:null,c=r??a,u=n.find(d=>d.id===c),h=v.useMemo(()=>u?t[u.id]??{}:{},[t,u]);return v.useMemo(()=>u?i?{type:"success",result:{...i,id:u.id,props:i.props,defaultProps:u.defaultProps??{},defaultCodec:i.defaultCodec}}:vb(u)?e[u.id]?e[u.id]:null:(Bf(u.durationInFrames,{allowFloats:!1,component:`in <Composition id="${u.id}">`}),pb(u.fps,`in <Composition id="${u.id}">`),ol(u.width,"width",`in <Composition id="${u.id}">`),ol(u.height,"height",`in <Composition id="${u.id}">`),{type:"success",result:{width:u.width,height:u.height,fps:u.fps,id:u.id,durationInFrames:u.durationInFrames,defaultProps:u.defaultProps??{},props:{...u.defaultProps??{},...h??{},...typeof window>"u"||St().isPlayer?{}:fb()??{}},defaultCodec:null}}):null,[u,e,i,h])},Vl=()=>{const{canvasContent:r,compositions:e,currentCompositionMetadata:t}=v.useContext(gs),n=e.find(i=>r?.type==="composition"&&i.id===r.compositionId),s=Vf(n?.id??null);return v.useMemo(()=>!s||s.type==="error"||s.type==="loading"||!n?null:{...s.result,defaultProps:n.defaultProps??{},id:n.id,...t??{},component:n.component},[t,s,n])},Qr=v.createContext({frame:{},playing:!1,playbackRate:1,rootId:"",imperativePlaying:{current:!1},setPlaybackRate:()=>{throw new Error("default")},audioAndVideoTags:{current:[]}}),Ji=v.createContext({setFrame:()=>{throw new Error("default")},setPlaying:()=>{throw new Error("default")}}),zf=()=>"remotion.time-all",bb=r=>{localStorage.setItem(zf(),JSON.stringify(r))},wb=()=>{const r=localStorage.getItem(zf())??"{}";return JSON.parse(r)},xb=r=>{const e=localStorage.getItem(zf())??"{}",t=JSON.parse(e);return t[r]!==void 0?Number(t[r]):typeof window>"u"?0:window.remotion_initialFrame??0},ti=()=>{const r=Vl(),e=v.useContext(Qr);if(!r)return typeof window>"u"?0:window.remotion_initialFrame??0;const t=e.frame[r.id]??(St().isPlayer?0:xb(r.id));return Math.min(r.durationInFrames-1,t)},_b=()=>{const{setFrame:r}=v.useContext(Ji);return r},Wf=()=>{const{playing:r,imperativePlaying:e}=v.useContext(Qr),{setPlaying:t}=v.useContext(Ji);return v.useMemo(()=>[r,t,e],[e,r,t])},ri=v.createContext(!1),kd=({children:r})=>w.jsx(ri.Provider,{value:!0,children:r}),zl=()=>{const r=v.useContext(Ut),e=r?.width??null,t=r?.height??null,n=r?.durationInFrames??null,s=Vl();return v.useMemo(()=>{if(!s)return null;const{id:i,durationInFrames:a,fps:c,height:u,width:h,defaultProps:d,props:p,defaultCodec:g}=s;return{id:i,width:e??h,height:t??u,fps:c,durationInFrames:n??a,defaultProps:d,props:p,defaultCodec:g}},[n,t,e,s])},ms=()=>{const r=zl(),e=v.useContext(ri),t=Lf();if(!r)throw typeof window<"u"&&window.remotion_isPlayer||t?new Error(["No video config found. Likely reasons:","- You are probably calling useVideoConfig() from outside the component passed to <Player />. See https://www.remotion.dev/docs/player/examples for how to set up the Player correctly.","- You have multiple versions of Remotion installed which causes the React context to get lost."].join("-")):new Error("No video config found. You are probably calling useVideoConfig() from a component which has not been registered as a <Composition />. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions for more information.");if(!e)throw new Error("Called useVideoConfig() outside a Remotion composition.");return r},vs=()=>{if(!v.useContext(ri))throw St().isPlayer?new Error("useCurrentFrame can only be called inside a component that was passed to <Player>. See: https://www.remotion.dev/docs/player/examples"):new Error("useCurrentFrame() can only be called inside a component that was registered as a composition. See https://www.remotion.dev/docs/the-fundamentals#defining-compositions");const e=ti(),t=v.useContext(Ut),n=t?t.cumulatedFrom+t.relativeFrom:0;return e-n},MD=({frame:r,children:e,active:t=!0})=>{const n=vs(),s=ms();if(typeof r>"u")throw new Error("The <Freeze /> component requires a 'frame' prop, but none was passed.");if(typeof r!="number")throw new Error(`The 'frame' prop of <Freeze /> must be a number, but is of type ${typeof r}`);if(Number.isNaN(r))throw new Error("The 'frame' prop of <Freeze /> must be a real number, but it is NaN.");if(!Number.isFinite(r))throw new Error(`The 'frame' prop of <Freeze /> must be a finite number, but it is ${r}.`);const i=v.useMemo(()=>{if(typeof t=="boolean")return t;if(typeof t=="function")return t(n)},[t,n]),a=v.useContext(Qr),u=v.useContext(Ut)?.relativeFrom??0,h=v.useMemo(()=>i?{...a,playing:!1,imperativePlaying:{current:!1},frame:{[s.id]:r+u}}:a,[i,a,s.id,r,u]);return w.jsx(Qr.Provider,{value:h,children:e})},PD=({from:r=0,durationInFrames:e=1/0,children:t,name:n,height:s,width:i,showInTimeline:a=!0,_remotionInternalLoopDisplay:c,_remotionInternalStack:u,_remotionInternalPremountDisplay:h,...d},p)=>{const{layout:g="absolute-fill"}=d,[y]=v.useState(()=>String(Math.random())),b=v.useContext(Ut),{rootId:_}=v.useContext(Qr),S=b?b.cumulatedFrom+b.relativeFrom:0,T=Nf();if(g!=="absolute-fill"&&g!=="none")throw new TypeError(`The layout prop of <Sequence /> expects either "absolute-fill" or "none", but you passed: ${g}`);if(g==="none"&&typeof d.style<"u")throw new TypeError('If layout="none", you may not pass a style.');if(typeof e!="number")throw new TypeError(`You passed to durationInFrames an argument of type ${typeof e}, but it must be a number.`);if(e<=0)throw new TypeError(`durationInFrames must be positive, but got ${e}`);if(typeof r!="number")throw new TypeError(`You passed to the "from" props of your <Sequence> an argument of type ${typeof r}, but it must be a number.`);if(!Number.isFinite(r))throw new TypeError(`The "from" prop of a sequence must be finite, but got ${r}.`);const k=ti(),I=ms(),A=b?Math.min(b.durationInFrames-r,e):e,D=Math.max(0,Math.min(I.durationInFrames-r,A)),{registerSequence:F,unregisterSequence:z}=v.useContext(Ki),{hidden:L}=v.useContext(ba),Y=v.useMemo(()=>b?.premounting??!!d._remotionInternalIsPremounting,[d._remotionInternalIsPremounting,b?.premounting]),W=v.useMemo(()=>({cumulatedFrom:S,relativeFrom:r,durationInFrames:D,parentFrom:b?.relativeFrom??0,id:y,height:s??b?.height??null,width:i??b?.width??null,premounting:Y}),[S,r,D,b,y,s,i,Y]),q=v.useMemo(()=>n??"",[n]);v.useEffect(()=>{if(St().isStudio)return F({from:r,duration:D,id:y,displayName:q,parent:b?.id??null,type:"sequence",rootId:_,showInTimeline:a,nonce:T,loopDisplay:c,stack:u??null,premountDisplay:h??null}),()=>{z(y)}},[e,y,n,F,q,z,b?.id,D,_,r,a,T,c,u,h]);const U=Math.ceil(S+r+e-1),X=k<S+r||k>U?null:t,te=d.layout==="none"?void 0:d.style,de=v.useMemo(()=>({flexDirection:void 0,...i?{width:i}:{},...s?{height:s}:{},...te??{}}),[s,te,i]);if(p!==null&&g==="none")throw new TypeError('It is not supported to pass both a `ref` and `layout="none"` to <Sequence />.');return L[y]??!1?null:w.jsx(Ut.Provider,{value:W,children:X===null?null:d.layout==="none"?X:w.jsx(Vo,{ref:p,style:de,className:d.className,children:X})})},DD=v.forwardRef(PD),RD=(r,e)=>{const t=vs();if(r.layout==="none")throw new Error('`<Sequence>` with `premountFor` prop does not support layout="none"');const{style:n,from:s=0,premountFor:i=0,...a}=r,c=t<s&&t>=s-i,u=v.useMemo(()=>({...n,opacity:c?0:1,pointerEvents:c?"none":n?.pointerEvents??void 0}),[c,n]);return w.jsx(MD,{frame:s,active:c,children:w.jsx(fn,{ref:e,from:s,style:u,_remotionInternalPremountDisplay:i,_remotionInternalIsPremounting:c,...a})})},jD=v.forwardRef(RD),FD=(r,e)=>r.layout!=="none"&&r.premountFor&&!St().isRendering?w.jsx(jD,{...r,ref:e}):w.jsx(DD,{...r,ref:e}),fn=v.forwardRef(FD),LD=r=>{if(typeof r!="string")throw new TypeError(`The "filename" must be a string, but you passed a value of type ${typeof r}`);if(r.trim()==="")throw new Error("The `filename` must not be empty");if(!r.match(/^([0-9a-zA-Z-!_.*'()/:&$@=;+,?]+)/g))throw new Error('The `filename` must match "/^([0-9a-zA-Z-!_.*\'()/:&$@=;+,?]+)/g". Use forward slashes only, even on Windows.')},ND=r=>{if(typeof r!="string"&&!(r instanceof Uint8Array))throw new TypeError(`The "content" must be a string or Uint8Array, but you passed a value of type ${typeof r}`);if(typeof r=="string"&&r.trim()==="")throw new Error("The `content` must not be empty")},Sb=r=>{r.type==="artifact"&&(LD(r.filename),ND(r.content))},ni=v.createContext({registerRenderAsset:()=>{},unregisterRenderAsset:()=>{},renderAssets:[]}),BD=({children:r})=>{const[e,t]=v.useState([]),n=v.useCallback(a=>{Sb(a),t(c=>[...c,a])},[]),s=v.useCallback(a=>{t(c=>c.filter(u=>u.id!==a))},[]);v.useLayoutEffect(()=>{typeof window<"u"&&(window.remotion_collectAssets=()=>(t([]),e))},[e]);const i=v.useMemo(()=>({registerRenderAsset:n,unregisterRenderAsset:s,renderAssets:e}),[e,n,s]);return w.jsx(ni.Provider,{value:i,children:r})},Bn=r=>typeof window>"u"?r:new URL(r,window.origin).href,Cb=({endAt:r,mediaDuration:e,playbackRate:t,startFrom:n})=>{let s=e;typeof r<"u"&&(s=r),typeof n<"u"&&(s-=n);const i=s/t;return Math.floor(i)};function ea(r){let e;throw VD(r)?(e=r,e.stack||(e.stack=new Error(e.message).stack)):typeof r=="string"?e=Error(r):e=Error("Rendering was cancelled"),window.remotion_cancelledError=e.stack,e}var VD=r=>r instanceof Error?!0:!(r===null||typeof r!="object"||!("stack"in r)||typeof r.stack!="string"||!("message"in r)||typeof r.message!="string"),Tb=v.createContext(null),zD=()=>v.useContext(Tb),Wl=({durationInFrames:r,times:e=1/0,children:t,name:n,...s})=>{const i=vs(),{durationInFrames:a}=ms();if(Bf(r,{component:"of the <Loop /> component",allowFloats:!0}),typeof e!="number")throw new TypeError(`You passed to "times" an argument of type ${typeof e}, but it must be a number.`);if(e!==1/0&&e%1!==0)throw new TypeError(`The "times" prop of a loop must be an integer, but got ${e}.`);if(e<0)throw new TypeError(`The "times" prop of a loop must be at least 0, but got ${e}`);const c=Math.ceil(a/r),u=Math.min(c,e),h=s.layout==="none"?void 0:s.style,d=r*(u-1),g=Math.floor(i/r)*r,y=Math.min(g,d),b=v.useMemo(()=>({numberOfTimes:u,startOffset:-y,durationInFrames:r}),[u,r,y]),_=v.useMemo(()=>({iteration:Math.floor(i/r),durationInFrames:r}),[i,r]);return w.jsx(Tb.Provider,{value:_,children:w.jsx(fn,{durationInFrames:r,from:y,name:n??"<Loop>",_remotionInternalLoopDisplay:b,layout:s.layout,style:h,children:t})})};Wl.useLoop=zD;var Hl=v.createContext({}),Yv={},Rh=[],Eb=({children:r})=>{const[e,t]=v.useState(()=>Yv);return v.useEffect(()=>{const n=()=>{t(Yv)};return Rh.push(n),()=>{Rh=Rh.filter(s=>s!==n)}},[]),w.jsx(Hl.Provider,{value:e,children:r})},Qi=r=>v.useContext(Hl)[r]??r,Hf=(r,e)=>{if(typeof r.volume!="number"&&typeof r.volume!="function"&&typeof r.volume<"u")throw new TypeError(`You have passed a volume of type ${typeof r.volume} to your <${e} /> component. Volume must be a number or a function with the signature '(frame: number) => number' undefined.`);if(typeof r.volume=="number"&&r.volume<0)throw new TypeError(`You have passed a volume below 0 to your <${e} /> component. Volume must be between 0 and 1`);if(typeof r.playbackRate!="number"&&typeof r.playbackRate<"u")throw new TypeError(`You have passed a playbackRate of type ${typeof r.playbackRate} to your <${e} /> component. Playback rate must a real number or undefined.`);if(typeof r.playbackRate=="number"&&(isNaN(r.playbackRate)||!Number.isFinite(r.playbackRate)||r.playbackRate<=0))throw new TypeError(`You have passed a playbackRate of ${r.playbackRate} to your <${e} /> component. Playback rate must be a real number above 0.`)},Uf=(r,e)=>{if(typeof r<"u"){if(typeof r!="number")throw new TypeError(`type of startFrom prop must be a number, instead got type ${typeof r}.`);if(isNaN(r)||r===1/0)throw new TypeError("startFrom prop can not be NaN or Infinity.");if(r<0)throw new TypeError(`startFrom must be greater than equal to 0 instead got ${r}.`)}if(typeof e<"u"){if(typeof e!="number")throw new TypeError(`type of endAt prop must be a number, instead got type ${typeof e}.`);if(isNaN(e))throw new TypeError("endAt prop can not be NaN.");if(e<=0)throw new TypeError(`endAt must be a positive number, instead got ${e}.`)}if(e<r)throw new TypeError("endAt prop must be greater than startFrom prop.")},WD=(r,e)=>{switch(e.type){case"got-duration":{const t=Bn(e.src);return r[t]===e.durationInSeconds?r:{...r,[t]:e.durationInSeconds}}default:return r}},$f=v.createContext({durations:{},setDurations:()=>{throw new Error("context missing")}}),kb=({children:r})=>{const[e,t]=v.useReducer(WD,{}),n=v.useMemo(()=>({durations:e,setDurations:t}),[e]);return w.jsx($f.Provider,{value:n,children:r})};function Xv(r){let e=r+1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function HD(r){let e=0,t=0,n=0;for(e=0;e<r.length;e++)t=r.charCodeAt(e),n=(n<<5)-n+t,n|=0;return n}var si=(r,e)=>{if(r===null)return Math.random();if(typeof r=="string")return Xv(HD(r));if(typeof r=="number")return Xv(r*1e10);throw new Error("random() argument must be a number or a string")},eo=()=>{const r=v.useContext(Ut);return Math.min(0,r?.relativeFrom??0)},wa=r=>{const e=Wl.useLoop(),t=vs(),n=eo();return r==="repeat"||e===null?t+n:t+n+e.durationInFrames*e.iteration},UD=r=>{if(/data:|blob:/.test(r.substring(0,5)))return"Data URL";const e=r.split("/").map(t=>t.split("\\")).flat(1);return e[e.length-1]},al=(r,e,t)=>{const{current:n}=r;if(!n)return;const s=n.play();s.catch&&s.catch(i=>{if(n&&!i.message.includes("request was interrupted by a call to pause")&&!i.message.includes("The operation was aborted.")&&!i.message.includes("The fetching process for the media resource was aborted by the user agent")&&!i.message.includes("request was interrupted by a new load request")&&!i.message.includes("because the media was removed from the document")&&!(i.message.includes("user didn't interact with the document")&&n.muted)&&(console.log(`Could not play ${e} due to following error: `,i),!n.muted)){if(t){t();return}console.log("The video will be muted and we'll retry playing it."),e==="video"&&St().isPlayer&&console.log("Use onAutoPlayError() to handle this error yourself."),n.muted=!0,n.play()}})},to=({frame:r,volume:e,mediaVolume:t=1,allowAmplificationDuringRender:n})=>{const s=n?1/0:1;if(typeof e=="number")return Math.min(s,e*t);if(typeof e>"u")return Number(t);const i=e(r)*t;if(typeof i!="number")throw new TypeError(`You passed in a a function to the volume prop but it did not return a number but a value of type ${typeof i} for frame ${r}`);if(Number.isNaN(i))throw new TypeError(`You passed in a function to the volume prop but it returned NaN for frame ${r}.`);if(!Number.isFinite(i))throw new TypeError(`You passed in a function to the volume prop but it returned a non-finite number for frame ${r}.`);return Math.max(0,Math.min(s,i))},Gv={},$D=r=>{Gv[r]||(console.warn(r),Gv[r]=!0)},Ib=({volume:r,mediaVolume:e,mediaRef:t,src:n,mediaType:s,playbackRate:i,displayName:a,id:c,stack:u,showInTimeline:h,premountDisplay:d,onAutoPlayError:p})=>{const g=ms(),{rootId:y,audioAndVideoTags:b}=v.useContext(Qr),_=v.useContext(Ut),S=_?_.relativeFrom+_.cumulatedFrom:0,[T]=Wf(),k=eo(),{registerSequence:I,unregisterSequence:A}=v.useContext(Ki),[D]=v.useState(()=>r),F=Nf(),z=_?Math.min(_.durationInFrames,g.durationInFrames):g.durationInFrames,L=typeof r=="function",Y=v.useMemo(()=>typeof r=="number"?r:new Array(Math.floor(Math.max(0,z+k))).fill(!0).map((W,q)=>to({frame:q+k,volume:r,mediaVolume:e,allowAmplificationDuringRender:!1})).join(","),[z,k,r,e]);v.useEffect(()=>{typeof r=="number"&&r!==D&&$D(`Remotion: The ${s} with src ${n} has changed it's volume. Prefer the callback syntax for setting volume to get better timeline display: https://www.remotion.dev/docs/using-audio/#controlling-volume`)},[D,s,n,r]),v.useEffect(()=>{if(t.current){if(!n)throw new Error("No src passed");if(!(!St().isStudio&&window.process?.env?.NODE_ENV!=="test")&&h)return I({type:s,src:n,id:c,duration:z,from:0,parent:_?.id??null,displayName:a??UD(n),rootId:y,volume:Y,showInTimeline:!0,nonce:F,startMediaFrom:0-k,doesVolumeChange:L,loopDisplay:void 0,playbackRate:i,stack:u,premountDisplay:d}),()=>{A(c)}}},[S,z,c,_,n,I,y,A,g,Y,L,F,t,s,k,i,a,u,h,d]),v.useEffect(()=>{const W={id:c,play:()=>{if(T)return al(t,s,p)}};return b.current.push(W),()=>{b.current=b.current.filter(q=>q.id!==c)}},[b,c,t,s,p,T])},YD=()=>{const[r,e]=v.useState([]),[t,n]=v.useState([]),[s,i]=v.useState([]),a=v.useRef(!1),c=v.useCallback(d=>(e(p=>[...p,d]),{unblock:()=>{e(p=>{const g=p.filter(y=>y!==d);return g.length===p.length?p:g})}}),[]),u=v.useCallback(d=>(n(p=>[...p,d]),{remove:()=>{n(p=>p.filter(g=>g!==d))}}),[]),h=v.useCallback(d=>(i(p=>[...p,d]),{remove:()=>{i(p=>p.filter(g=>g!==d))}}),[]);return v.useEffect(()=>{r.length>0&&t.forEach(d=>d())},[r]),v.useEffect(()=>{r.length===0&&s.forEach(d=>d())},[r]),v.useMemo(()=>({addBlock:c,listenForBuffering:u,listenForResume:h,buffering:a}),[c,a,u,h])},ro=v.createContext(null),Ab=({children:r})=>{const e=YD();return w.jsx(ro.Provider,{value:e,children:r})},XD=r=>{const[e,t]=v.useState(r.buffering.current);return v.useEffect(()=>{const n=()=>{t(!0)},s=()=>{t(!1)};return r.listenForBuffering(n),r.listenForResume(s),()=>{r.listenForBuffering(()=>{}),r.listenForResume(()=>{})}},[r]),e},Yf=()=>{const r=v.useContext(ro),e=r?r.addBlock:null;return v.useMemo(()=>({delayPlayback:()=>{if(!e)throw new Error("Tried to enable the buffering state, but a Remotion context was not found. This API can only be called in a component that was passed to the Remotion Player or a <Composition>. Or you might have experienced a version mismatch - run `npx remotion versions` and ensure all packages have the same version. This error is thrown by the buffer state https://remotion.dev/docs/player/buffer-state");const{unblock:t}=e({id:String(Math.random())});return{unblock:t}}}),[e])},GD=({mediaRef:r,mediaType:e,onVariableFpsVideoDetected:t,pauseWhenBuffering:n})=>{const s=v.useRef(!1),{delayPlayback:i}=Yf(),a=v.useCallback(c=>{if(e!=="video"||!n)return;const u=r.current;if(!u||!u.requestVideoFrameCallback)return;s.current=!0;const h=i(),d=()=>{h.unblock(),u.removeEventListener("ended",d,{once:!0}),u.removeEventListener("pause",d,{once:!0}),s.current=!1},p=()=>{d()};u.requestVideoFrameCallback((g,y)=>{Math.abs(y.mediaTime-c)>.5&&t(),d()}),u.addEventListener("ended",p,{once:!0}),u.addEventListener("pause",p,{once:!0}),u.addEventListener("canplay",p,{once:!0})},[i,r,e,t,n]);return v.useMemo(()=>({isBuffering:()=>s.current,bufferUntilFirstFrame:a}),[a])},qD=({element:r,shouldBuffer:e,isPremounting:t})=>{const n=Yf(),[s,i]=v.useState(!1);return v.useEffect(()=>{let a=[];const{current:c}=r;if(!c||!e||t)return;const u=()=>{a.forEach(p=>p()),a=[],i(!1)},h=()=>{i(!0);const{unblock:p}=n.delayPlayback(),g=()=>{u(),d()},y=()=>{u(),d()};c.addEventListener("canplay",g,{once:!0}),a.push(()=>{c.removeEventListener("canplay",g)}),c.addEventListener("error",y,{once:!0}),a.push(()=>{c.removeEventListener("error",y)}),a.push(()=>{p()})},d=()=>{c.readyState<c.HAVE_FUTURE_DATA?(h(),navigator.userAgent.includes("Firefox/")||c.load()):(c.addEventListener("waiting",h),a.push(()=>{c.removeEventListener("waiting",h)}))};return d(),()=>{u()}},[n,r,t,e]),s},KD=({mediaRef:r,mediaType:e,lastSeek:t,onVariableFpsVideoDetected:n})=>{const s=v.useRef(null);return v.useEffect(()=>{const{current:i}=r;if(i)s.current=i.currentTime;else{s.current=null;return}if(e!=="video"){s.current=null;return}const a=i;if(!a.requestVideoFrameCallback)return;let c=()=>{};const u=()=>{if(!a)return;const h=a.requestVideoFrameCallback((d,p)=>{if(s.current!==null){const g=Math.abs(s.current-p.mediaTime),y=Math.abs(t.current===null?1/0:p.mediaTime-t.current);g>.5&&y>.5&&p.mediaTime>s.current&&n()}s.current=p.mediaTime,u()});c=()=>{a.cancelVideoFrameCallback(h),c=()=>{}}};return u(),()=>{c()}},[t,r,e,n]),s};function ZD(r,e,t,n){const{extrapolateLeft:s,extrapolateRight:i,easing:a}=n;let c=r;const[u,h]=e,[d,p]=t;if(c<u){if(s==="identity")return c;if(s==="clamp")c=u;else if(s==="wrap"){const g=h-u;c=((c-u)%g+g)%g+u}}if(c>h){if(i==="identity")return c;if(i==="clamp")c=h;else if(i==="wrap"){const g=h-u;c=((c-u)%g+g)%g+u}}return d===p?d:(c=(c-u)/(h-u),c=a(c),c=c*(p-d)+d,c)}function JD(r,e){let t;for(t=1;t<e.length-1&&!(e[t]>=r);++t);return t-1}function QD(r){for(let e=1;e<r.length;++e)if(!(r[e]>r[e-1]))throw new Error(`inputRange must be strictly monotonically increasing but got [${r.join(",")}]`)}function qv(r,e){if(e.length<2)throw new Error(r+" must have at least 2 elements");for(const t of e){if(typeof t!="number")throw new Error(`${r} must contain only numbers`);if(!Number.isFinite(t))throw new Error(`${r} must contain only finite numbers, but got [${e.join(",")}]`)}}function Ob(r,e,t,n){if(typeof r>"u")throw new Error("input can not be undefined");if(typeof e>"u")throw new Error("inputRange can not be undefined");if(typeof t>"u")throw new Error("outputRange can not be undefined");if(e.length!==t.length)throw new Error("inputRange ("+e.length+") and outputRange ("+t.length+") must have the same length");qv("inputRange",e),qv("outputRange",t),QD(e);const s=n?.easing??(u=>u);let i="extend";n?.extrapolateLeft!==void 0&&(i=n.extrapolateLeft);let a="extend";if(n?.extrapolateRight!==void 0&&(a=n.extrapolateRight),typeof r!="number")throw new TypeError("Cannot interpolate an input which is not a number");const c=JD(r,e);return ZD(r,[e[c],e[c+1]],[t[c],t[c+1]],{easing:s,extrapolateLeft:i,extrapolateRight:a})}var Mb=({frame:r,playbackRate:e,startFrom:t})=>Ob(r,[-1,t,t+1],[-1,t,t+e]),Pb=({fps:r,frame:e,playbackRate:t,startFrom:n})=>{const s=Mb({frame:e,playbackRate:t,startFrom:n}),i=1e3/r;return s*i/1e3},Db=(r,e)=>Math.round(r/e*100)/100,Ul=()=>{if(typeof window>"u")return!1;const r=/iP(ad|od|hone)/i.test(window.navigator.userAgent),e=/AppleWebKit/.test(window.navigator.userAgent);return r&&e},e4=r=>Ul()&&r.startsWith("blob:"),Id=({actualFrom:r,fps:e})=>Db(Math.max(0,-r),e),Ad=({duration:r,fps:e})=>Db(r,e),t4=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{if(e4(r)||r.startsWith("data:")||!!new URL(r,(typeof window>"u"?null:window.location.href)??"http://localhost:3000").hash||!Number.isFinite(e))return r;const i=`${r}#t=${Id({actualFrom:e,fps:n})}`;return Number.isFinite(t)?`${i},${Ad({duration:t,fps:n})}`:i},r4=({prevStartFrom:r,newStartFrom:e,prevDuration:t,newDuration:n,fps:s})=>{const i=Id({actualFrom:r,fps:s}),a=Id({actualFrom:e,fps:s}),c=Ad({duration:t,fps:s}),u=Ad({duration:n,fps:s});return!(a<i||u>c)},n4=({actualSrc:r,actualFrom:e,duration:t,fps:n})=>{const s=v.useRef(e),i=v.useRef(t),a=v.useRef(r);return(!r4({prevStartFrom:s.current,newStartFrom:e,prevDuration:i.current,newDuration:t,fps:n})||r!==a.current)&&(s.current=e,i.current=t,a.current=r),t4({actualSrc:a.current,actualFrom:s.current,duration:i.current,fps:n})},Kv={},s4=(r,e)=>{if(r===null||r.seekable.length===0||r.seekable.length>1||Kv[r.src])return;const t={start:r.seekable.start(0),end:r.seekable.end(0)};if(t.start===0&&t.end===0){const n=[`The media ${r.src} cannot be seeked. This could be one of few reasons:`,"1) The media resource was replaced while the video is playing but it was not loaded yet.","2) The media does not support seeking.","3) The media was loaded with security headers prventing it from being included.","Please see https://remotion.dev/docs/non-seekable-media for assistance."].join(`
`);if(e==="console-error")console.error(n);else if(e==="console-warning")console.warn(`The media ${r.src} does not support seeking. The video will render fine, but may not play correctly in the Remotion Studio and in the <Player>. See https://remotion.dev/docs/non-seekable-media for an explanation.`);else throw new Error(n);Kv[r.src]=!0}},Xf=.45,jh=(r,e)=>{if(!r.current)return;const t=Ul()?Number(e.toFixed(1)):e;r.current.currentTime=t},Rb=({mediaRef:r,src:e,mediaType:t,playbackRate:n,onlyWarnForMediaSeekingError:s,acceptableTimeshift:i,pauseWhenBuffering:a,isPremounting:c,debugSeeking:u,onAutoPlayError:h})=>{const{playbackRate:d}=v.useContext(Qr),p=vs(),g=ti(),[y]=Wf(),b=v.useContext(ro),{fps:_}=ms(),S=eo(),T=v.useRef(null),k=v.useRef(null);if(!b)throw new Error("useMediaPlayback must be used inside a <BufferingContext>");const I=v.useRef({}),A=v.useCallback(()=>{e&&(u&&console.log(`Detected ${e} as a variable FPS video. Disabling buffering while seeking.`),I.current[e]=!0)},[u,e]),D=KD({mediaRef:r,mediaType:t,lastSeek:k,onVariableFpsVideoDetected:A}),F=Pb({frame:p,playbackRate:n,startFrom:-S,fps:_}),z=qD({element:r,shouldBuffer:a,isPremounting:c}),{bufferUntilFirstFrame:L,isBuffering:Y}=GD({mediaRef:r,mediaType:t,onVariableFpsVideoDetected:A,pauseWhenBuffering:a}),W=n*d,q=r.current?.duration?Math.min(r.current.duration,i??Xf):i,U=XD(b);v.useEffect(()=>{if(!y){r.current?.pause();return}const X=z||Y();U&&!X&&r.current?.pause()},[Y,z,U,r,y]),v.useEffect(()=>{const X=t==="audio"?"<Audio>":"<Video>";if(!r.current)throw new Error(`No ${t} ref found`);if(!e)throw new Error(`No 'src' attribute was passed to the ${X} element.`);const te=Math.max(0,W);r.current.playbackRate!==te&&(r.current.playbackRate=te);const{duration:de}=r.current,J=!Number.isNaN(de)&&Number.isFinite(de)?Math.min(de,F):F,le=r.current.currentTime,ie=D.current??null,se=I.current[e],he=Math.abs(J-le),re=ie?Math.abs(J-ie):null,De=re&&!se?re:he;if(u&&console.log({mediaTagTime:le,rvcTime:ie,shouldBeTime:J,state:r.current.readyState,playing:!r.current.paused,isVariableFpsVideo:se}),De>q&&T.current!==J){u&&console.log("Seeking",{shouldBeTime:J,isTime:le,rvcTime:ie,timeShift:De,isVariableFpsVideo:se}),jh(r,J),k.current=J,T.current=J,y&&!se&&(W>0&&L(J),r.current.paused&&al(r,t,h)),s||s4(r.current,s?"console-warning":"console-error");return}const $e=y?.15:1e-5,je=Math.abs(r.current.currentTime-J)>$e,we=z||Y(),Se=b.buffering.current&&!we;if(!y||Se){je&&(jh(r,J),k.current=J);return}(r.current.paused&&!r.current.ended||g===0)&&(je&&(jh(r,J),k.current=J),al(r,t,h),se||W>0&&L(J))},[g,q,L,b.buffering,D,u,F,Y,z,r,t,s,W,y,e,h])},jb=r=>{const[e,t]=v.useState(1);return v.useEffect(()=>{const n=r.current;if(!n)return;const s=()=>{t(n.volume)};return n.addEventListener("volumechange",s),()=>n.removeEventListener("volumechange",s)},[r]),v.useEffect(()=>{const n=r.current;n&&n.volume!==e&&t(n.volume)},[e,r]),e},i4=1e-5,Gf=(r,e)=>Math.abs(r-e)<i4,Fb=({volumePropFrame:r,actualVolume:e,volume:t,mediaVolume:n,mediaRef:s})=>{v.useEffect(()=>{const i=to({frame:r,volume:t,mediaVolume:n,allowAmplificationDuringRender:!1});!Gf(i,e)&&s.current&&(s.current.volume=i)},[e,r,s,t,n])},qf=v.createContext({mediaMuted:!1,mediaVolume:1}),Kf=v.createContext({setMediaMuted:()=>{throw new Error("default")},setMediaVolume:()=>{throw new Error("default")}}),Zf=()=>{const{mediaVolume:r}=v.useContext(qf),{setMediaVolume:e}=v.useContext(Kf);return v.useMemo(()=>[r,e],[r,e])},Jf=()=>{const{mediaMuted:r}=v.useContext(qf),{setMediaMuted:e}=v.useContext(Kf);return v.useMemo(()=>[r,e],[r,e])},Zv="data:audio/mp3;base64,/+MYxAAJcAV8AAgAABn//////+/gQ5BAMA+D4Pg+BAQBAEAwD4Pg+D4EBAEAQDAPg++hYBH///hUFQVBUFREDQNHmf///////+MYxBUGkAGIMAAAAP/29Xt6lUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDUAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",o4=(r,e)=>{const t=Object.keys(r).sort(),n=Object.keys(e).sort();if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==n[s]||r[t[s]]!==e[n[s]])return!1;return!0},a4=(r,e,t)=>r==="src"&&!t.startsWith("data:")&&!e.startsWith("data:")?new URL(t,window.origin).toString()!==new URL(e,window.origin).toString():t!==e,$l=v.createContext(null),Lb=({children:r,numberOfAudioTags:e,component:t})=>{const n=v.useRef([]),[s]=v.useState(e);if(e!==s)throw new Error("The number of shared audio tags has changed dynamically. Once you have set this property, you cannot change it afterwards.");const i=v.useMemo(()=>new Array(e).fill(!0).map(()=>({id:Math.random(),ref:v.createRef()})),[e]),a=v.useRef(new Array(e).fill(!1)),c=v.useCallback(()=>{i.forEach(({ref:b,id:_})=>{const S=n.current?.find(k=>k.id===_),{current:T}=b;if(T){if(S===void 0){T.src=Zv;return}if(!S)throw new TypeError("Expected audio data to be there");Object.keys(S.props).forEach(k=>{a4(k,S.props[k],T[k])&&(T[k]=S.props[k])})}})},[i]),u=v.useCallback((b,_)=>{const S=n.current?.find(F=>F.audioId===_);if(S)return S;const T=a.current.findIndex(F=>F===!1);if(T===-1)throw new Error(`Tried to simultaneously mount ${e+1} <Audio /> tags at the same time. With the current settings, the maximum amount of <Audio /> tags is limited to ${e} at the same time. Remotion pre-mounts silent audio tags to help avoid browser autoplay restrictions. See https://remotion.dev/docs/player/autoplay#use-the-numberofsharedaudiotags-property for more information on how to increase this limit.`);const{id:k,ref:I}=i[T],A=[...a.current];A[T]=k,a.current=A;const D={props:b,id:k,el:I,audioId:_};return n.current?.push(D),c(),D},[e,i,c]),h=v.useCallback(b=>{const _=[...a.current],S=i.findIndex(T=>T.id===b);if(S===-1)throw new TypeError("Error occured in ");_[S]=!1,a.current=_,n.current=n.current?.filter(T=>T.id!==b),c()},[i,c]),d=v.useCallback(({aud:b,audioId:_,id:S})=>{let T=!1;n.current=n.current?.map(k=>k.id===S?o4(b,k.props)?k:(T=!0,{...k,props:b,audioId:_}):k),T&&c()},[c]),p=v.useCallback(()=>{i.forEach(b=>{al(b.ref,"audio",null)})},[i]),g=v.useMemo(()=>({registerAudio:u,unregisterAudio:h,updateAudio:d,playAllAudios:p,numberOfAudioTags:e}),[e,p,u,h,d]),y=v.useCallback(()=>{a.current=new Array(e).fill(!1),n.current=[],c()},[e,c]);return v.useEffect(()=>()=>{y()},[t,y]),w.jsxs($l.Provider,{value:g,children:[i.map(({id:b,ref:_})=>w.jsx("audio",{ref:_,preload:"metadata",src:Zv},b)),r]})},c4=(r,e)=>{const t=v.useContext($l),[n]=v.useState(()=>t&&t.numberOfAudioTags>0?t.registerAudio(r,e):{el:v.createRef(),id:Math.random(),props:r,audioId:e}),s=v.useInsertionEffect??v.useLayoutEffect;return typeof document<"u"&&(s(()=>{t&&t.numberOfAudioTags>0&&t.updateAudio({id:n.id,aud:r,audioId:e})},[r,t,n.id,e]),s(()=>()=>{t&&t.numberOfAudioTags>0&&t.unregisterAudio(n.id)},[t,n.id])),n},l4=(r,e)=>{const[t]=v.useState(r.shouldPreMountAudioTags);if(r.shouldPreMountAudioTags!==t)throw new Error("Cannot change the behavior for pre-mounting audio tags dynamically.");const{volume:n,muted:s,playbackRate:i,shouldPreMountAudioTags:a,src:c,onDuration:u,acceptableTimeShiftInSeconds:h,_remotionInternalNeedsDurationCalculation:d,_remotionInternalNativeLoopPassed:p,_remotionInternalStack:g,_remotionDebugSeeking:y,allowAmplificationDuringRender:b,name:_,pauseWhenBuffering:S,showInTimeline:T,loopVolumeCurveBehavior:k,stack:I,...A}=r,[D]=Zf(),[F]=Jf(),z=wa(k??"repeat"),{hidden:L}=v.useContext(ba);if(!c)throw new TypeError("No 'src' was passed to <Audio>.");const Y=Qi(c),W=v.useContext(Ut),[q]=v.useState(()=>String(Math.random())),U=L[q]??!1,X=to({frame:z,volume:n,mediaVolume:D,allowAmplificationDuringRender:!1}),te=v.useMemo(()=>({muted:s||F||U||X<=0,src:Y,loop:p,...A}),[p,U,F,s,A,Y,X]),de=v.useMemo(()=>`audio-${si(c??"")}-${W?.relativeFrom}-${W?.cumulatedFrom}-${W?.durationInFrames}-muted:${r.muted}-loop:${r.loop}`,[c,W?.relativeFrom,W?.cumulatedFrom,W?.durationInFrames,r.muted,r.loop]),J=c4(te,de).el,le=jb(J);Fb({volumePropFrame:z,actualVolume:le,volume:n,mediaVolume:D,mediaRef:J}),Ib({volume:n,mediaVolume:D,mediaRef:J,src:c,mediaType:"audio",playbackRate:i??1,displayName:_??null,id:q,stack:g,showInTimeline:T,premountDisplay:null,onAutoPlayError:null}),Rb({mediaRef:J,src:c,mediaType:"audio",playbackRate:i??1,onlyWarnForMediaSeekingError:!1,acceptableTimeshift:h??Xf,isPremounting:!!W?.premounting,pauseWhenBuffering:S,debugSeeking:y,onAutoPlayError:null}),v.useImperativeHandle(e,()=>J.current,[J]);const ie=v.useRef();return ie.current=u,v.useEffect(()=>{const{current:se}=J;if(!se)return;if(se.duration){ie.current?.(se.src,se.duration);return}const he=()=>{ie.current?.(se.src,se.duration)};return se.addEventListener("loadedmetadata",he),()=>{se.removeEventListener("loadedmetadata",he)}},[J,c]),t?null:w.jsx("audio",{ref:J,preload:"metadata",...te})},u4=v.forwardRef(l4);typeof window<"u"&&(window.remotion_renderReady=!1);var Kc=[];typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var h4="The delayRender was called:",d4="Retries left: ",f4="- Rendering the frame will be retried.",Jv=3e4,os=(r,e)=>{if(typeof r!="string"&&typeof r<"u")throw new Error("The label parameter of delayRender() must be a string or undefined, got: "+JSON.stringify(r));const t=Math.random();Kc.push(t);const n=Error().stack?.replace(/^Error/g,"")??"";if(St().isRendering){const s=(e?.timeoutInMilliseconds??(typeof window>"u"?Jv:window.remotion_puppeteerTimeout??Jv))-2e3;if(typeof window<"u"){const i=(e?.retries??0)-(window.remotion_attempt-1);window.remotion_delayRenderTimeouts[t]={label:r??null,timeout:setTimeout(()=>{const a=["A delayRender()",r?`"${r}"`:null,`was called but not cleared after ${s}ms. See https://remotion.dev/docs/timeout for help.`,i>0?d4+i:null,i>0?f4:null,h4,n].filter(Ll).join(" ");ea(Error(a))},s)}}}return typeof window<"u"&&(window.remotion_renderReady=!1),t},ht=r=>{if(typeof r>"u")throw new TypeError("The continueRender() method must be called with a parameter that is the return value of delayRender(). No value was passed.");if(typeof r!="number")throw new TypeError("The parameter passed into continueRender() must be the return value of delayRender() which is a number. Got: "+JSON.stringify(r));Kc=Kc.filter(e=>e===r?(St().isRendering&&(clearTimeout(window.remotion_delayRenderTimeouts[r].timeout),delete window.remotion_delayRenderTimeouts[r]),!1):!0),Kc.length===0&&typeof window<"u"&&(window.remotion_renderReady=!0)},p4=(r,e)=>{const t=v.useRef(null),{volume:n,playbackRate:s,allowAmplificationDuringRender:i,onDuration:a,toneFrequency:c,_remotionInternalNeedsDurationCalculation:u,_remotionInternalNativeLoopPassed:h,acceptableTimeShiftInSeconds:d,name:p,onError:g,delayRenderRetries:y,delayRenderTimeoutInMilliseconds:b,loopVolumeCurveBehavior:_,pauseWhenBuffering:S,...T}=r,k=ti(),I=wa(_??"repeat"),A=vs(),D=v.useContext(Ut),{registerRenderAsset:F,unregisterRenderAsset:z}=v.useContext(ni),L=v.useMemo(()=>`audio-${si(r.src??"")}-${D?.relativeFrom}-${D?.cumulatedFrom}-${D?.durationInFrames}`,[r.src,D?.relativeFrom,D?.cumulatedFrom,D?.durationInFrames]),Y=to({volume:n,frame:I,mediaVolume:1,allowAmplificationDuringRender:i??!1});v.useImperativeHandle(e,()=>t.current,[]),v.useEffect(()=>{if(!r.src)throw new Error("No src passed");if(window.remotion_audioEnabled&&!r.muted&&!(Y<=0))return F({type:"audio",src:Bn(r.src),id:L,frame:k,volume:Y,mediaFrame:A,playbackRate:r.playbackRate??1,allowAmplificationDuringRender:i??!1,toneFrequency:c??null,audioStartFrame:Math.max(0,-(D?.relativeFrom??0))}),()=>z(L)},[r.muted,r.src,F,k,L,z,Y,I,A,s,r.playbackRate,i,c,D?.relativeFrom]);const{src:W}=r,q=e||u;return v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"||!q)return;const U=os("Loading <Audio> duration with src="+W,{retries:y??void 0,timeoutInMilliseconds:b??void 0}),{current:X}=t,te=()=>{X?.duration&&a(X.src,X.duration),ht(U)};return X?.duration?(a(X.src,X.duration),ht(U)):X?.addEventListener("loadedmetadata",te,{once:!0}),()=>{X?.removeEventListener("loadedmetadata",te),ht(U)}},[W,a,q,y,b]),q?w.jsx("audio",{ref:t,...T}):null},g4=v.forwardRef(p4),m4=(r,e)=>{const t=v.useContext($l),{startFrom:n,endAt:s,name:i,stack:a,pauseWhenBuffering:c,showInTimeline:u,_remotionDebugSeeking:h,...d}=r,{loop:p,...g}=r,{fps:y}=ms(),b=St(),{durations:_,setDurations:S}=v.useContext($f);if(typeof r.src!="string")throw new TypeError(`The \`<Audio>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const T=Qi(r.src),k=v.useCallback(D=>{console.log(D.currentTarget.error);const F=`Could not play audio with src ${T}: ${D.currentTarget.error}. See https://remotion.dev/docs/media-playback-error for help.`;p?ea(new Error(F)):console.warn(F)},[p,T]),I=v.useCallback((D,F)=>{S({type:"got-duration",durationInSeconds:F,src:D})},[S]),A=_[Bn(T)]??_[Bn(r.src)];if(p&&A!==void 0){if(!Number.isFinite(A))return w.jsx(zo,{...g,ref:e,_remotionInternalNativeLoopPassed:!0});const D=A*y;return w.jsx(Wl,{layout:"none",durationInFrames:Cb({endAt:s,mediaDuration:D,playbackRate:r.playbackRate??1,startFrom:n}),children:w.jsx(zo,{...g,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof n<"u"||typeof s<"u"){Uf(n,s);const D=n??0,F=s??1/0;return w.jsx(fn,{layout:"none",from:0-D,showInTimeline:!1,durationInFrames:F,name:i,children:w.jsx(zo,{_remotionInternalNeedsDurationCalculation:!!p,pauseWhenBuffering:c??!1,...d,ref:e})})}return Hf(r,"Audio"),b.isRendering?w.jsx(g4,{onDuration:I,...r,ref:e,onError:k,_remotionInternalNeedsDurationCalculation:!!p}):w.jsx(u4,{_remotionInternalNativeLoopPassed:r._remotionInternalNativeLoopPassed??!1,_remotionDebugSeeking:h??!1,_remotionInternalStack:a??null,shouldPreMountAudioTags:t!==null&&t.numberOfAudioTags>0,...r,ref:e,onError:k,onDuration:I,pauseWhenBuffering:c??!1,_remotionInternalNeedsDurationCalculation:!!p,showInTimeline:u??!0})},zo=v.forwardRef(m4);ya(zo);var v4=v.createContext({folderName:null,parentName:null}),y4={transform:"rotate(90deg)"},Qv=40,b4={color:"white",fontSize:14,fontFamily:"sans-serif"},w4={justifyContent:"center",alignItems:"center"},x4=()=>w.jsxs(Vo,{style:w4,id:"remotion-comp-loading",children:[w.jsx("style",{type:"text/css",children:`
				@keyframes anim {
					from {
						opacity: 0
					}
					to {
						opacity: 1
					}
				}
				#remotion-comp-loading {
					animation: anim 2s;
					animation-fill-mode: forwards;
				}
			`}),w.jsx("svg",{width:Qv,height:Qv,viewBox:"-100 -100 400 400",style:y4,children:w.jsx("path",{fill:"#555",stroke:"#555",strokeWidth:"100",strokeLinejoin:"round",d:"M 2 172 a 196 100 0 0 0 195 5 A 196 240 0 0 0 100 2.259 A 196 240 0 0 0 2 172 z"})}),w.jsxs("p",{style:b4,children:["Resolving ","<Suspense>","..."]})]}),_r=null,Od=()=>{if(!_r){if(typeof document>"u")throw new Error("Tried to call an API that only works in the browser from outside the browser");_r=document.createElement("div"),_r.style.position="absolute",_r.style.top="0px",_r.style.left="0px",_r.style.right="0px",_r.style.bottom="0px",_r.style.width="100%",_r.style.height="100%",_r.style.display="flex",_r.style.flexDirection="column";const r=document.createElement("div");r.style.position="fixed",r.style.top="-999999px",r.appendChild(_r),document.body.appendChild(r)}return _r},Nb=r=>v.useMemo(()=>{if("lazyComponent"in r&&typeof r.lazyComponent<"u")return v.lazy(r.lazyComponent);if("component"in r)return typeof document>"u"?r.component:v.lazy(()=>Promise.resolve({default:r.component}));throw new Error("You must pass either 'component' or 'lazyComponent'")},[r.component,r.lazyComponent]),Bb=()=>/^([a-zA-Z0-9-\u4E00-\u9FFF])+$/g,Vb=r=>r.match(Bb()),_4=r=>{if(!Vb(r))throw new Error(`Composition id can only contain a-z, A-Z, 0-9, CJK characters and -. You passed ${r}`)},S4=`Composition ID must match ${String(Bb())}`,C4=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}},T4=()=>(v.useEffect(()=>{const r=os("Waiting for Root component to unsuspend");return()=>ht(r)},[]),null),e0=({width:r,height:e,fps:t,durationInFrames:n,id:s,defaultProps:i,schema:a,...c})=>{const{registerComposition:u,unregisterComposition:h}=v.useContext(gs),d=Vl(),p=Nb(c),g=Nf(),y=Lf(),b=St();if(v.useContext(ri))throw y?new Error("<Composition> was mounted inside the `component` that was passed to the <Player>. See https://remotion.dev/docs/wrong-composition-mount for help."):new Error("<Composition> mounted inside another composition. See https://remotion.dev/docs/wrong-composition-mount for help.");const{folderName:S,parentName:T}=v.useContext(v4);v.useEffect(()=>{if(!s)throw new Error("No id for composition passed.");return _4(s),C4(i,"defaultProps",s),u({durationInFrames:n??void 0,fps:t??void 0,height:e??void 0,width:r??void 0,id:s,folderName:S,component:p,defaultProps:Ds(i??{}),nonce:g,parentFolderName:T,schema:a??null,calculateMetadata:c.calculateMetadata??null}),()=>{h(s)}},[n,t,e,p,s,S,i,u,h,r,g,T,a,c.calculateMetadata]);const k=Vf(s);if(b.isStudio&&d&&d.component===p){const I=p;return k===null||k.type!=="success"?null:ad.createPortal(w.jsx(kd,{children:w.jsx(v.Suspense,{fallback:w.jsx(x4,{}),children:w.jsx(I,{...k.result.props??{}})})}),Od())}if(b.isRendering&&d&&d.component===p){const I=p;return k===null||k.type!=="success"?null:ad.createPortal(w.jsx(kd,{children:w.jsx(v.Suspense,{fallback:w.jsx(T4,{}),children:w.jsx(I,{...k.result.props??{}})})}),Od())}return null},zb=v.createRef(),E4=({children:r,numberOfAudioTags:e})=>{const[t,n]=v.useState([]),s=v.useRef(t),[i,a]=v.useState([]),[c,u]=v.useState(null),[h,d]=v.useState(null),p=v.useCallback(I=>{n(A=>{const D=I(A);return s.current=D,D})},[]),g=v.useCallback(I=>{p(A=>{if(A.find(F=>F.id===I.id))throw new Error(`Multiple composition with id ${I.id} are registered.`);return[...A,I].slice().sort((F,z)=>F.nonce-z.nonce)})},[p]),y=v.useCallback(I=>{n(A=>A.filter(D=>D.id!==I))},[]),b=v.useCallback((I,A)=>{a(D=>[...D,{name:I,parent:A}])},[]),_=v.useCallback((I,A)=>{a(D=>D.filter(F=>!(F.name===I&&F.parent===A)))},[]);v.useImperativeHandle(zb,()=>({getCompositions:()=>s.current}),[]);const S=t.find(I=>c?.type==="composition"?I.id===c.compositionId:null),T=v.useCallback((I,A)=>{n(D=>D.map(z=>z.id===I?{...z,defaultProps:A}:z))},[]),k=v.useMemo(()=>({compositions:t,registerComposition:g,unregisterComposition:y,folders:i,registerFolder:b,unregisterFolder:_,currentCompositionMetadata:h,setCurrentCompositionMetadata:d,canvasContent:c,setCanvasContent:u,updateCompositionDefaultProps:T}),[t,g,y,i,b,_,h,c,T]);return w.jsx(gs.Provider,{value:k,children:w.jsx(bD,{children:w.jsx(BD,{children:w.jsx(yb,{children:w.jsx(Lb,{numberOfAudioTags:e,component:S?.component??null,children:r})})})})})},k4=({onLoad:r,onError:e,delayRenderRetries:t,delayRenderTimeoutInMilliseconds:n,...s},i)=>{const[a]=v.useState(()=>os(`Loading <IFrame> with source ${s.src}`,{retries:t??void 0,timeoutInMilliseconds:n??void 0})),c=v.useCallback(h=>{ht(a),r?.(h)},[a,r]),u=v.useCallback(h=>{ht(a),e?e(h):console.error("Error loading iframe:",h,"Handle the event using the onError() prop to make this message disappear.")},[a,e]);return w.jsx("iframe",{...s,ref:i,onError:u,onLoad:c})};v.forwardRef(k4);function I4(r){return 1e3*2**(r-1)}var A4=({onError:r,maxRetries:e=2,src:t,pauseWhenLoading:n,delayRenderRetries:s,delayRenderTimeoutInMilliseconds:i,onImageFrame:a,...c},u)=>{const h=v.useRef(null),d=v.useRef({}),{delayPlayback:p}=Yf(),g=v.useContext(Ut);if(!t)throw new Error('No "src" prop was passed to <Img>.');v.useImperativeHandle(u,()=>h.current,[]);const y=Qi(t),b=v.useCallback(S=>{if(!h.current)return;const T=h.current.src;setTimeout(()=>{if(!h.current)return;const k=h.current?.src;k===T&&(h.current.removeAttribute("src"),h.current.setAttribute("src",k))},S)},[]),_=v.useCallback(S=>{if(d.current){if(d.current[h.current?.src]=(d.current[h.current?.src]??0)+1,r&&(d.current[h.current?.src]??0)>e){r(S);return}if((d.current[h.current?.src]??0)<=e){const T=I4(d.current[h.current?.src]??0);console.warn(`Could not load image with source ${h.current?.src}, retrying again in ${T}ms`),b(T);return}ea("Error loading image with src: "+h.current?.src)}},[e,r,b]);if(typeof window<"u"){const S=!!g?.premounting;v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test"){h.current&&(h.current.src=y);return}const T=os("Loading <Img> with src="+y,{retries:s??void 0,timeoutInMilliseconds:i??void 0}),k=n&&!S?p().unblock:()=>{},{current:I}=h;let A=!1;const D=()=>{A||((d.current[h.current?.src]??0)>0&&(delete d.current[h.current?.src],console.info(`Retry successful - ${h.current?.src} is now loaded`)),I&&(I.src=y,a?.(I)),k(),ht(T))},F=new Image;return F.src=y,F.decode().then(D).catch(z=>{console.warn(z),F.complete?D():F.addEventListener("load",D)}),()=>{A=!0,F.removeEventListener("load",D),k(),ht(T)}},[y,p,s,i,n,S,a])}return w.jsx("img",{...c,ref:h,onError:_})},Wb=v.forwardRef(A4),Hb={};ib(Hb,{makeDefaultPreviewCSS:()=>M4,injectCSS:()=>O4,OFFTHREAD_VIDEO_CLASS_NAME:()=>cl});var t0={},O4=r=>{if(typeof document>"u"||t0[r])return;const e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.appendChild(document.createTextNode(r)),e.prepend(t),t0[r]=!0},cl="__remotion_offthreadvideo",M4=(r,e)=>r?`
    ${r} * {
      box-sizing: border-box;
    }
    ${r} *:-webkit-full-screen {
      width: 100%;
      height: 100%;
    }
    ${r} .${cl} {
      object-fit: contain;
    }
  `:`
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
	    background-color: ${e};
    }
    .${cl} {
      object-fit: contain;
    }
    `,Ub="__remotion-studio-container",P4=()=>document.getElementById(Ub),D4=null,Fh=[],R4=()=>D4,j4=r=>(Fh.push(r),()=>{Fh=Fh.filter(e=>e!==r)}),F4=({children:r,numberOfAudioTags:e})=>{const[t]=v.useState(()=>String(si(null))),[n,s]=v.useState(()=>wb()),[i,a]=v.useState(!1),c=v.useRef(!1),[u,h]=v.useState(0),[d,p]=v.useState(1),g=v.useRef([]);typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_setFrame=(S,T,k)=>{window.remotion_attempt=k;const I=os(`Setting the current frame to ${S}`);let A=!0;s(D=>(D[T]??window.remotion_initialFrame)===S?(A=!1,D):{...D,[T]:S}),A?requestAnimationFrame(()=>ht(I)):ht(I)},window.remotion_isPlayer=!1},[]);const y=v.useMemo(()=>({frame:n,playing:i,imperativePlaying:c,rootId:t,playbackRate:d,setPlaybackRate:p,audioAndVideoTags:g}),[n,d,i,t]),b=v.useMemo(()=>({setFrame:s,setPlaying:a}),[]),_=v.useMemo(()=>{let S=0;return{getNonce:()=>S++,fastRefreshes:u}},[u]);return v.useEffect(()=>{typeof __webpack_module__<"u"&&__webpack_module__.hot&&__webpack_module__.hot.addStatusHandler(S=>{S==="idle"&&h(T=>T+1)})},[]),w.jsx(Zi.Provider,{value:_,children:w.jsx(Qr.Provider,{value:y,children:w.jsx(Ji.Provider,{value:b,children:w.jsx(hb,{children:w.jsx(Eb,{children:w.jsx(E4,{numberOfAudioTags:e,children:w.jsx(kb,{children:w.jsx(Ab,{children:r})})})})})})})})},L4=()=>{if(St().isRendering){const r=window.remotion_envVariables;return r?{...JSON.parse(r),NODE_ENV:"production"}:{}}return{NODE_ENV:"production"}},N4=()=>{const r=L4();window.process||(window.process={}),window.process.env||(window.process.env={}),Object.keys(r).forEach(e=>{window.process.env[e]=r[e]})},B4=v.createContext(null),V4=v.createContext({setSize:()=>{},size:{size:"auto",translation:{x:0,y:0}}}),z4=({canvasSize:r,compositionHeight:e,compositionWidth:t,previewSize:n})=>{const s=r.height/e,i=r.width/t,a=Math.min(s,i);return n==="auto"?a:Number(n)},W4="remotion_staticFilesChanged";function H4(){const r=v.useContext(gs),e=v.useContext(Qr),t=v.useContext(Ji),n=v.useContext(Ut),s=v.useContext(Zi),i=v.useContext(ri),a=v.useContext(Hl),c=v.useContext(Bl),u=v.useContext(ni),h=v.useContext(Ki),d=v.useContext(ro);return v.useMemo(()=>({compositionManagerCtx:r,timelineContext:e,setTimelineContext:t,sequenceContext:n,nonceContext:s,canUseRemotionHooksContext:i,preloadContext:a,resolveCompositionContext:c,renderAssetManagerContext:u,sequenceManagerContext:h,bufferManagerContext:d}),[r,s,n,t,e,i,a,c,u,h,d])}var U4=r=>{const{children:e,contexts:t}=r;return w.jsx(ri.Provider,{value:t.canUseRemotionHooksContext,children:w.jsx(Zi.Provider,{value:t.nonceContext,children:w.jsx(Hl.Provider,{value:t.preloadContext,children:w.jsx(gs.Provider,{value:t.compositionManagerCtx,children:w.jsx(Ki.Provider,{value:t.sequenceManagerContext,children:w.jsx(ni.Provider,{value:t.renderAssetManagerContext,children:w.jsx(Bl.Provider,{value:t.resolveCompositionContext,children:w.jsx(Qr.Provider,{value:t.timelineContext,children:w.jsx(Ji.Provider,{value:t.setTimelineContext,children:w.jsx(Ut.Provider,{value:t.sequenceContext,children:w.jsx(ro.Provider,{value:t.bufferManagerContext,children:e})})})})})})})})})})})},be={useUnsafeVideoConfig:zl,Timeline:lb,CompositionManager:gs,SequenceManager:Ki,SequenceVisibilityToggleContext:ba,RemotionRoot:F4,useVideo:Vl,getRoot:R4,useMediaVolumeState:Zf,useMediaMutedState:Jf,useLazyComponent:Nb,truthy:Ll,SequenceContext:Ut,useRemotionContexts:H4,RemotionContextProvider:U4,CSSUtils:Hb,setupEnvVariables:N4,MediaVolumeContext:qf,SetMediaVolumeContext:Kf,getRemotionEnvironment:St,SharedAudioContext:$l,SharedAudioContextProvider:Lb,invalidCompositionErrorMessage:S4,isCompositionIdValid:Vb,getPreviewDomElement:P4,compositionsRef:zb,portalNode:Od,waitForRoot:j4,CanUseRemotionHooksProvider:kd,CanUseRemotionHooks:ri,PrefetchProvider:Eb,DurationsContextProvider:kb,IsPlayerContextProvider:mD,useIsPlayer:Lf,EditorPropsProvider:hb,EditorPropsContext:Nl,usePreload:Qi,NonceContext:Zi,resolveVideoConfig:gb,useResolvedVideoConfig:Vf,resolveCompositionsRef:mb,ResolveCompositionConfig:yb,REMOTION_STUDIO_CONTAINER_ELEMENT:Ub,RenderAssetManager:ni,persistCurrentFrame:bb,useTimelineSetFrame:_b,isIosSafari:Ul,WATCH_REMOTION_STATIC_FILES:W4,addSequenceStackTraces:ya,useMediaStartsAt:eo,BufferingProvider:Ab,BufferingContextReact:ro,enableSequenceStackTraces:ab,CurrentScaleContext:B4,PreviewSizeContext:V4,calculateScale:z4,editorPropsProviderRef:ub,PROPS_UPDATED_EXTERNALLY:OD,validateRenderAsset:Sb},$4=({src:r,transparent:e,currentTime:t,toneMapped:n})=>`http://localhost:${window.remotion_proxyPort}/proxy?src=${encodeURIComponent(Bn(r))}&time=${encodeURIComponent(t)}&transparent=${String(e)}&toneMapped=${String(n)}`,$b=v.createContext(!1),Y4=({children:r})=>w.jsx($b.Provider,{value:!1,children:r}),X4=()=>{if(!v.useContext($b))throw new Error("This component must be inside a <Series /> component.")},G4=({children:r},e)=>(X4(),w.jsx(Y4,{children:r})),q4=v.forwardRef(G4);ya(q4);var K4=({onError:r,volume:e,playbackRate:t,src:n,muted:s,allowAmplificationDuringRender:i,transparent:a=!1,toneMapped:c=!0,toneFrequency:u,name:h,loopVolumeCurveBehavior:d,delayRenderRetries:p,delayRenderTimeoutInMilliseconds:g,onVideoFrame:y,...b})=>{const _=ti(),S=vs(),T=wa(d??"repeat"),k=zl(),I=v.useContext(Ut),A=eo(),{registerRenderAsset:D,unregisterRenderAsset:F}=v.useContext(ni);if(!n)throw new TypeError("No `src` was passed to <OffthreadVideo>.");const z=v.useMemo(()=>`offthreadvideo-${si(n??"")}-${I?.cumulatedFrom}-${I?.relativeFrom}-${I?.durationInFrames}`,[n,I?.cumulatedFrom,I?.relativeFrom,I?.durationInFrames]);if(!k)throw new Error("No video config found");const L=to({volume:e,frame:T,mediaVolume:1,allowAmplificationDuringRender:i??!1});v.useEffect(()=>{if(!n)throw new Error("No src passed");if(window.remotion_audioEnabled&&!s&&!(L<=0))return D({type:"video",src:Bn(n),id:z,frame:_,volume:L,mediaFrame:S,playbackRate:t??1,allowAmplificationDuringRender:i??!1,toneFrequency:u??null,audioStartFrame:Math.max(0,-(I?.relativeFrom??0))}),()=>F(z)},[s,n,D,z,F,L,S,_,t,i,u,I?.relativeFrom]);const Y=v.useMemo(()=>Mb({frame:S,playbackRate:t||1,startFrom:-A})/k.fps,[S,A,t,k.fps]),W=v.useMemo(()=>$4({src:n,currentTime:Y,transparent:a,toneMapped:c}),[c,Y,n,a]),[q,U]=v.useState(null);v.useLayoutEffect(()=>{if(!window.remotion_videoEnabled)return;const J=[];U(null);const le=new AbortController,ie=os(`Fetching ${W} from server`,{retries:p??void 0,timeoutInMilliseconds:g??void 0});return(async()=>{try{const he=await fetch(W,{signal:le.signal});if(he.status!==200){if(he.status===500){const $e=await he.json();if($e.error){const je=$e.error.replace(/^Error: /,"");throw new Error(je)}}throw new Error(`Server returned status ${he.status} while fetching ${W}`)}const re=await he.blob(),De=URL.createObjectURL(re);J.push(()=>URL.revokeObjectURL(De)),U({src:De,handle:ie})}catch(he){if(he.message.includes("aborted")){ht(ie);return}if(le.signal.aborted){ht(ie);return}he.message.includes("Failed to fetch")&&(he=new Error(`Failed to fetch ${W}. This could be caused by Chrome rejecting the request because the disk space is low. Consider increasing the disk size of your environment.`,{cause:he})),r?r(he):ea(he)}})(),J.push(()=>{le.signal.aborted||le.abort()}),()=>{J.forEach(he=>he())}},[W,p,g,r]);const X=v.useCallback(()=>{r?r?.(new Error("Failed to load image with src "+q)):ea("Failed to load image with src "+q)},[q,r]),te=v.useMemo(()=>[cl,b.className].filter(Ll).join(" "),[b.className]),de=v.useCallback(J=>{y&&y(J)},[y]);return!q||!window.remotion_videoEnabled?null:(ht(q.handle),w.jsx(Wb,{src:q.src,className:te,delayRenderRetries:p,delayRenderTimeoutInMilliseconds:g,onImageFrame:de,...b,onError:X}))},Z4=({ref:r,onVideoFrame:e})=>{v.useEffect(()=>{const{current:t}=r;if(!t||!e)return;let n=0;const s=()=>{r.current&&(e(r.current),n=r.current.requestVideoFrameCallback(s))};return s(),()=>{t.cancelVideoFrameCallback(n)}},[e,r])},J4=(r,e)=>{const t=v.useRef(null),{volume:n,muted:s,playbackRate:i,onlyWarnForMediaSeekingError:a,src:c,onDuration:u,acceptableTimeShift:h,acceptableTimeShiftInSeconds:d,toneFrequency:p,name:g,_remotionInternalNativeLoopPassed:y,_remotionInternalStack:b,_remotionDebugSeeking:_,style:S,pauseWhenBuffering:T,showInTimeline:k,loopVolumeCurveBehavior:I,onError:A,onAutoPlayError:D,onVideoFrame:F,crossOrigin:z,...L}=r,Y=wa(I??"repeat"),{fps:W,durationInFrames:q}=ms(),U=v.useContext(Ut),{hidden:X}=v.useContext(ba),[te]=v.useState(()=>String(Math.random())),de=X[te]??!1;if(typeof h<"u")throw new Error("acceptableTimeShift has been removed. Use acceptableTimeShiftInSeconds instead.");const J=jb(t),[le]=Zf(),[ie]=Jf();Ib({mediaRef:t,volume:n,mediaVolume:le,mediaType:"video",src:c,playbackRate:r.playbackRate??1,displayName:g??null,id:te,stack:b,showInTimeline:k,premountDisplay:null,onAutoPlayError:D??null}),Fb({volumePropFrame:Y,actualVolume:J,volume:n,mediaVolume:le,mediaRef:t}),Rb({mediaRef:t,src:c,mediaType:"video",playbackRate:r.playbackRate??1,onlyWarnForMediaSeekingError:a,acceptableTimeshift:d??Xf,isPremounting:!!U?.premounting,pauseWhenBuffering:T,debugSeeking:_,onAutoPlayError:D??null});const se=U?U.relativeFrom:0,he=U?Math.min(U.durationInFrames,q):q,re=n4({actualSrc:Qi(c),actualFrom:se,duration:he,fps:W});v.useImperativeHandle(e,()=>t.current,[]),v.useEffect(()=>{const{current:we}=t;if(!we)return;const Se=()=>{if(we.error){if(console.error("Error occurred in video",we?.error),A){const ot=new Error(`Code ${we.error.code}: ${we.error.message}`);A(ot);return}throw new Error(`The browser threw an error while playing the video ${c}: Code ${we.error.code} - ${we?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else{if(A){const ot=new Error(`The browser threw an error while playing the video ${c}`);A(ot);return}throw new Error("The browser threw an error while playing the video")}};return we.addEventListener("error",Se,{once:!0}),()=>{we.removeEventListener("error",Se)}},[A,c]);const De=v.useRef();De.current=u,Z4({ref:t,onVideoFrame:F}),v.useEffect(()=>{const{current:we}=t;if(!we)return;if(we.duration){De.current?.(c,we.duration);return}const Se=()=>{De.current?.(c,we.duration)};return we.addEventListener("loadedmetadata",Se),()=>{we.removeEventListener("loadedmetadata",Se)}},[c]),v.useEffect(()=>{const{current:we}=t;we&&(Ul()?we.preload="metadata":we.preload="auto")},[]);const $e=v.useMemo(()=>({...S,opacity:de?0:S?.opacity??1}),[de,S]),je=z??(F?"anonymous":void 0);return w.jsx("video",{ref:t,muted:s||ie,playsInline:!0,src:re,loop:y,style:$e,disableRemotePlayback:!0,crossOrigin:je,...L})},Yb=v.forwardRef(J4),Xb=r=>{const{startFrom:e,endAt:t,name:n,pauseWhenBuffering:s,stack:i,showInTimeline:a,...c}=r,u=St(),h=v.useCallback(()=>{},[]);if(typeof r.src!="string")throw new TypeError(`The \`<OffthreadVideo>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);if(r.imageFormat)throw new TypeError("The `<OffthreadVideo>` tag does no longer accept `imageFormat`. Use the `transparent` prop if you want to render a transparent video.");if(typeof e<"u"||typeof t<"u"){Uf(e,t);const T=e??0,k=t??1/0;return w.jsx(fn,{layout:"none",from:0-T,showInTimeline:!1,durationInFrames:k,name:n,children:w.jsx(Xb,{pauseWhenBuffering:s??!1,...c})})}if(Hf(r,"Video"),u.isRendering)return w.jsx(K4,{...c});const{transparent:d,toneMapped:p,_remotionDebugSeeking:g,onAutoPlayError:y,onVideoFrame:b,crossOrigin:_,...S}=c;return w.jsx(Yb,{_remotionInternalStack:i??null,_remotionInternalNativeLoopPassed:!1,_remotionDebugSeeking:g??!1,onDuration:h,onlyWarnForMediaSeekingError:!0,pauseWhenBuffering:s??!1,showInTimeline:a??!0,onAutoPlayError:y??void 0,onVideoFrame:b??null,crossOrigin:_,...S})},r0=r=>Math.round(r*1e5)/1e5,Lh=(r,e)=>{if(Gf(r.currentTime,e))return{wait:Promise.resolve(e),cancel:()=>{}};r.currentTime=e;let t,n=null;const s=new Promise(a=>{t=r.requestVideoFrameCallback((c,u)=>{const h=u.expectedDisplayTime-c;if(h<=0){a(u.mediaTime);return}setTimeout(()=>{a(u.mediaTime)},h+150)})}),i=new Promise(a=>{const c=()=>{a()};r.addEventListener("seeked",c,{once:!0}),n=()=>{r.removeEventListener("seeked",c)}});return{wait:Promise.all([s,i]).then(([a])=>a),cancel:()=>{n?.(),r.cancelVideoFrameCallback(t)}}},Q4=(r,e,t)=>{const n=1/t/2;let s=()=>{};return Number.isFinite(r.duration)&&r.currentTime>=r.duration&&e>=r.duration?{prom:Promise.resolve(),cancel:()=>{}}:{prom:new Promise((a,c)=>{const u=Lh(r,e+n);u.wait.then(h=>{if(Math.abs(e-h)<=n)return a();const p=e>h?1:-1,g=Lh(r,h+n*p);s=g.cancel,g.wait.then(y=>{const b=Math.abs(e-y);if(r0(b)<=r0(n))return a();const _=Lh(r,e+n);return s=_.cancel,_.wait.then(()=>{a()}).catch(S=>{c(S)})}).catch(y=>{c(y)})}),s=u.cancel}),cancel:()=>{s()}}},eR=({onError:r,volume:e,allowAmplificationDuringRender:t,playbackRate:n,onDuration:s,toneFrequency:i,name:a,acceptableTimeShiftInSeconds:c,delayRenderRetries:u,delayRenderTimeoutInMilliseconds:h,loopVolumeCurveBehavior:d,...p},g)=>{const y=ti(),b=vs(),_=wa(d??"repeat"),S=zl(),T=v.useRef(null),k=v.useContext(Ut),I=eo(),A=St(),{registerRenderAsset:D,unregisterRenderAsset:F}=v.useContext(ni),z=v.useMemo(()=>`video-${si(p.src??"")}-${k?.cumulatedFrom}-${k?.relativeFrom}-${k?.durationInFrames}`,[p.src,k?.cumulatedFrom,k?.relativeFrom,k?.durationInFrames]);if(!S)throw new Error("No video config found");const L=to({volume:e,frame:_,mediaVolume:1,allowAmplificationDuringRender:t??!1});v.useEffect(()=>{if(!p.src)throw new Error("No src passed");if(!p.muted&&!(L<=0)&&window.remotion_audioEnabled)return D({type:"video",src:Bn(p.src),id:z,frame:y,volume:L,mediaFrame:b,playbackRate:n??1,allowAmplificationDuringRender:t??!1,toneFrequency:i??null,audioStartFrame:Math.max(0,-(k?.relativeFrom??0))}),()=>F(z)},[p.muted,p.src,D,z,F,L,b,y,n,t,i,k?.relativeFrom]),v.useImperativeHandle(g,()=>T.current,[]),v.useEffect(()=>{if(!window.remotion_videoEnabled)return;const{current:W}=T;if(!W)return;const q=Pb({frame:b,playbackRate:n||1,startFrom:-I,fps:S.fps}),U=os(`Rendering <Video /> with src="${p.src}" at time ${q}`,{retries:u??void 0,timeoutInMilliseconds:h??void 0});if(window.process?.env?.NODE_ENV==="test"){ht(U);return}if(Gf(W.currentTime,q)){if(W.readyState>=2){ht(U);return}const J=()=>{ht(U)};return W.addEventListener("loadeddata",J,{once:!0}),()=>{W.removeEventListener("loadeddata",J)}}const X=()=>{ht(U)},te=Q4(W,q,S.fps);te.prom.then(()=>{ht(U)}),W.addEventListener("ended",X,{once:!0});const de=()=>{if(W?.error){if(console.error("Error occurred in video",W?.error),r)return;throw new Error(`The browser threw an error while playing the video ${p.src}: Code ${W.error.code} - ${W?.error?.message}. See https://remotion.dev/docs/media-playback-error for help. Pass an onError() prop to handle the error.`)}else throw new Error("The browser threw an error")};return W.addEventListener("error",de,{once:!0}),()=>{te.cancel(),W.removeEventListener("ended",X),W.removeEventListener("error",de),ht(U)}},[_,p.src,n,S.fps,b,I,r,u,h]);const{src:Y}=p;return A.isRendering&&v.useLayoutEffect(()=>{if(window.process?.env?.NODE_ENV==="test")return;const W=os("Loading <Video> duration with src="+Y,{retries:u??void 0,timeoutInMilliseconds:h??void 0}),{current:q}=T,U=()=>{q?.duration&&s(Y,q.duration),ht(W)};return q?.duration?(s(Y,q.duration),ht(W)):q?.addEventListener("loadedmetadata",U,{once:!0}),()=>{q?.removeEventListener("loadedmetadata",U),ht(W)}},[Y,s,u,h]),w.jsx("video",{ref:T,disableRemotePlayback:!0,...p})},tR=v.forwardRef(eR),rR=(r,e)=>{const{startFrom:t,endAt:n,name:s,pauseWhenBuffering:i,stack:a,_remotionInternalNativeLoopPassed:c,showInTimeline:u,onAutoPlayError:h,...d}=r,{loop:p,_remotionDebugSeeking:g,...y}=r,{fps:b}=ms(),_=St(),{durations:S,setDurations:T}=v.useContext($f);if(typeof e=="string")throw new Error("string refs are not supported");if(typeof r.src!="string")throw new TypeError(`The \`<Video>\` tag requires a string for \`src\`, but got ${JSON.stringify(r.src)} instead.`);const k=Qi(r.src),I=v.useCallback((F,z)=>{T({type:"got-duration",durationInSeconds:z,src:F})},[T]),A=v.useCallback(()=>{},[]),D=S[Bn(k)]??S[Bn(r.src)];if(p&&D!==void 0){if(!Number.isFinite(D))return w.jsx(Zc,{...y,ref:e,_remotionInternalNativeLoopPassed:!0});const F=D*b;return w.jsx(Wl,{durationInFrames:Cb({endAt:n,mediaDuration:F,playbackRate:r.playbackRate??1,startFrom:t}),layout:"none",name:s,children:w.jsx(Zc,{...y,ref:e,_remotionInternalNativeLoopPassed:!0})})}if(typeof t<"u"||typeof n<"u"){Uf(t,n);const F=t??0,z=n??1/0;return w.jsx(fn,{layout:"none",from:0-F,showInTimeline:!1,durationInFrames:z,name:s,children:w.jsx(Zc,{pauseWhenBuffering:i??!1,...d,ref:e})})}return Hf(r,"Video"),_.isRendering?w.jsx(tR,{onDuration:I,onVideoFrame:A??null,...d,ref:e}):w.jsx(Yb,{onlyWarnForMediaSeekingError:!1,...d,ref:e,onVideoFrame:null,pauseWhenBuffering:i??!1,onDuration:I,_remotionInternalStack:a??null,_remotionInternalNativeLoopPassed:c??!1,_remotionDebugSeeking:g??!1,showInTimeline:u??!0,onAutoPlayError:h??void 0})},Zc=v.forwardRef(rR);ya(Zc);vD();var nR={},sR=new Proxy(nR,{get(r,e){return e==="Bundling"||e==="Rendering"||e==="Log"||e==="Puppeteer"||e==="Output"?sR:()=>{console.warn("  The CLI configuration has been extracted from Remotion Core."),console.warn("Update the import from the config file:"),console.warn(),console.warn("- Delete:"),console.warn('import {Config} from "remotion";'),console.warn("+ Replace:"),console.warn('import {Config} from "@remotion/cli/config";'),console.warn(),console.warn("For more information, see https://www.remotion.dev/docs/4-0-migration."),process.exit(1)}}});ya(fn);typeof window<"u"&&(window.remotion_renderReady=!1);typeof window<"u"&&(window.remotion_delayRenderTimeouts={});var iR=(r,e,t)=>{if(r){if(typeof r!="object")throw new Error(`"${e}" must be an object, but you passed a value of type ${typeof r}`);if(Array.isArray(r))throw new Error(`"${e}" must be an object, an array was passed ${t?`for composition "${t}"`:""}`)}};function oR(r,e,t){if(typeof r!="number")throw new Error(`The "${e}" prop ${t} must be a number, but you passed a value of type ${typeof r}`);if(isNaN(r))throw new TypeError(`The "${e}" prop ${t} must not be NaN, but is NaN.`);if(!Number.isFinite(r))throw new TypeError(`The "${e}" prop ${t} must be finite, but is ${r}.`);if(r%1!==0)throw new TypeError(`The "${e}" prop ${t} must be an integer, but is ${r}.`);if(r<=0)throw new TypeError(`The "${e}" prop ${t} must be positive, but got ${r}.`)}function aR(r,e){const{allowFloats:t,component:n}=e;if(typeof r>"u")throw new Error(`The "durationInFrames" prop ${n} is missing.`);if(typeof r!="number")throw new Error(`The "durationInFrames" prop ${n} must be a number, but you passed a value of type ${typeof r}`);if(r<=0)throw new TypeError(`The "durationInFrames" prop ${n} must be positive, but got ${r}.`);if(!t&&r%1!==0)throw new TypeError(`The "durationInFrames" prop ${n} must be an integer, but got ${r}.`);if(!Number.isFinite(r))throw new TypeError(`The "durationInFrames" prop ${n} must be finite, but got ${r}.`)}function cR(r,e,t){if(typeof r!="number")throw new Error(`"fps" must be a number, but you passed a value of type ${typeof r} ${e}`);if(!Number.isFinite(r))throw new Error(`"fps" must be a finite, but you passed ${r} ${e}`);if(isNaN(r))throw new Error(`"fps" must not be NaN, but got ${r} ${e}`);if(r<=0)throw new TypeError(`"fps" must be positive, but got ${r} ${e}`);if(t&&r>50)throw new TypeError("The FPS for a GIF cannot be higher than 50. Use the --every-nth-frame option to lower the FPS: https://remotion.dev/docs/render-as-gif")}var Yl={validateFps:cR,validateDimension:oR,validateDurationInFrames:aR,validateDefaultAndInputProps:iR},Nt=25,Md=16,lR=()=>w.jsx("svg",{width:Nt,height:Nt,viewBox:"0 0 25 25",fill:"none",children:w.jsx("path",{d:"M8 6.375C7.40904 8.17576 7.06921 10.2486 7.01438 12.3871C6.95955 14.5255 7.19163 16.6547 7.6875 18.5625C9.95364 18.2995 12.116 17.6164 14.009 16.5655C15.902 15.5147 17.4755 14.124 18.6088 12.5C17.5158 10.8949 15.9949 9.51103 14.1585 8.45082C12.3222 7.3906 10.2174 6.68116 8 6.375Z",fill:"white",stroke:"white",strokeWidth:"6.25",strokeLinejoin:"round"})}),uR=()=>w.jsxs("svg",{viewBox:"0 0 100 100",width:Nt,height:Nt,children:[w.jsx("rect",{x:"25",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"}),w.jsx("rect",{x:"55",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"})]}),hR=({isFullscreen:r})=>{const n=r?0:3,s=r?6*1.6:6/2,i=r?6*1.6:6*2;return w.jsxs("svg",{viewBox:"0 0 32 32",height:Md,width:Md,children:[w.jsx("path",{d:`
				M ${n} ${i}
				L ${s} ${s}
				L ${i} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),w.jsx("path",{d:`
				M ${32-n} ${i}
				L ${32-s} ${s}
				L ${32-i} ${n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),w.jsx("path",{d:`
				M ${n} ${32-i}
				L ${s} ${32-s}
				L ${i} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"}),w.jsx("path",{d:`
				M ${32-n} ${32-i}
				L ${32-s} ${32-s}
				L ${32-i} ${32-n}
				`,stroke:"#fff",strokeWidth:6,fill:"none"})]})},dR=()=>w.jsx("svg",{width:Nt,height:Nt,viewBox:"0 0 24 24",children:w.jsx("path",{d:"M3.63 3.63a.996.996 0 000 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z",fill:"#fff"})}),fR=()=>w.jsx("svg",{width:Nt,height:Nt,viewBox:"0 0 24 24",children:w.jsx("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z",fill:"#fff"})}),n0="__remotion_buffering_indicator",s0="__remotion_buffering_animation",pR={width:Nt,height:Nt,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},gR={width:14,height:14,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},mR=({type:r})=>{const e=r==="player"?pR:gR;return w.jsxs(w.Fragment,{children:[w.jsx("style",{type:"text/css",children:`
				@keyframes ${s0} {
          0% {
            rotate: 0deg;
          }
          100% {
            rotate: 360deg;
          }
        }
        
        .${n0} {
            animation: ${s0} 1s linear infinite;
        }        
			`}),w.jsx("div",{style:e,children:w.jsx("svg",{viewBox:r==="player"?"0 0 22 22":"0 0 18 18",style:e,className:n0,children:w.jsx("path",{d:r==="player"?"M 11 4 A 7 7 0 0 1 15.1145 16.66312":"M 9 2 A 7 7 0 0 1 13.1145 14.66312",stroke:"white",strokeLinecap:"round",fill:"none",strokeWidth:3})})})]})},vR=({currentSize:r,width:e,height:t,compositionWidth:n,compositionHeight:s})=>e!==void 0&&t===void 0?{aspectRatio:[n,s].join("/")}:t!==void 0&&e===void 0?{aspectRatio:[n,s].join("/")}:r?{width:n,height:s}:{width:n,height:s},Gb=({previewSize:r,compositionWidth:e,compositionHeight:t,canvasSize:n})=>{const s=be.calculateScale({canvasSize:n,compositionHeight:t,compositionWidth:e,previewSize:r}),i=0-(1-s)/2,a=i*e,c=i*t,u=e*s,h=t*s,d=n.width/2-u/2,p=n.height/2-h/2;return{centerX:d,centerY:p,xCorrection:a,yCorrection:c,scale:s}},qb=({config:r,style:e,canvasSize:t,overflowVisible:n,layout:s})=>r?{position:"relative",overflow:n?"visible":"hidden",...vR({compositionHeight:r.height,compositionWidth:r.width,currentSize:t,height:e?.height,width:e?.width}),opacity:s?1:0,...e}:{},Kb=({config:r,canvasSize:e,layout:t,scale:n,overflowVisible:s})=>!r||!e||!t?{}:{position:"absolute",width:r.width,height:r.height,display:"flex",transform:`scale(${n})`,marginLeft:t.xCorrection,marginTop:t.yCorrection,overflow:s?"visible":"hidden"},Zb=({layout:r,scale:e,config:t,overflowVisible:n})=>{if(!r||!t)return{};const{centerX:s,centerY:i}=r;return{width:t.width*e,height:t.height*e,display:"flex",flexDirection:"column",position:"absolute",left:s,top:i,overflow:n?"visible":"hidden"}},Jb=v.createContext(void 0),Qb=v.createContext(void 0);class yR{listeners={ended:[],error:[],pause:[],play:[],ratechange:[],scalechange:[],seeked:[],timeupdate:[],frameupdate:[],fullscreenchange:[],volumechange:[],mutechange:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchSeek(e){this.dispatchEvent("seeked",{frame:e})}dispatchVolumeChange(e){this.dispatchEvent("volumechange",{volume:e})}dispatchPause(){this.dispatchEvent("pause",void 0)}dispatchPlay(){this.dispatchEvent("play",void 0)}dispatchEnded(){this.dispatchEvent("ended",void 0)}dispatchRateChange(e){this.dispatchEvent("ratechange",{playbackRate:e})}dispatchScaleChange(e){this.dispatchEvent("scalechange",{scale:e})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchTimeUpdate(e){this.dispatchEvent("timeupdate",e)}dispatchFrameUpdate(e){this.dispatchEvent("frameupdate",e)}dispatchFullscreenChange(e){this.dispatchEvent("fullscreenchange",e)}dispatchMuteChange(e){this.dispatchEvent("mutechange",e)}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}class bR{listeners={error:[],waiting:[],resume:[]};addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(n=>n!==t)}dispatchEvent(e,t){this.listeners[e].forEach(n=>{n({detail:t})})}dispatchError(e){this.dispatchEvent("error",{error:e})}dispatchWaiting(e){this.dispatchEvent("waiting",e)}dispatchResume(e){this.dispatchEvent("resume",e)}}var ew=r=>{const e=v.useContext(be.BufferingContextReact);if(!e)throw new Error("BufferingContextReact not found");v.useEffect(()=>{const t=e.listenForBuffering(()=>{e.buffering.current=!0,r.dispatchWaiting({})}),n=e.listenForResume(()=>{e.buffering.current=!1,r.dispatchResume({})});return()=>{t.remove(),n.remove()}},[e,r])},wR=({children:r,currentPlaybackRate:e})=>{const[t]=v.useState(()=>new yR);if(!v.useContext(be.BufferingContextReact))throw new Error("BufferingContextReact not found");return v.useEffect(()=>{e&&t.dispatchRateChange(e)},[t,e]),ew(t),w.jsx(Jb.Provider,{value:t,children:r})},Qf=(r,e)=>{const[t,n]=v.useState(!1);return v.useEffect(()=>{const{current:s}=r;if(!s)return;let i;const a=()=>{e&&(clearTimeout(i),i=setTimeout(()=>{n(!1)},e===!0?3e3:e))},c=()=>{n(!0),a()},u=()=>{n(!1),clearTimeout(i)},h=()=>{n(!0),a()};return s.addEventListener("mouseenter",c),s.addEventListener("mouseleave",u),s.addEventListener("mousemove",h),()=>{s.removeEventListener("mouseenter",c),s.removeEventListener("mouseleave",u),s.removeEventListener("mousemove",h),clearTimeout(i)}},[e,r]),t},Xl=()=>{const[r,e,t]=be.Timeline.usePlayingState(),[n,s]=v.useState(!1),i=be.Timeline.useTimelinePosition(),a=v.useRef(i),c=be.Timeline.useTimelineSetFrame(),u=be.Timeline.useTimelineSetFrame(),h=v.useContext(be.SharedAudioContext),{audioAndVideoTags:d}=v.useContext(be.Timeline.TimelineContext),p=v.useRef(i);p.current=i;const g=be.useVideo(),y=be.useUnsafeVideoConfig(),b=v.useContext(Jb),_=(y?.durationInFrames??1)-1,S=i===_,T=i===0;if(!b)throw new TypeError("Expected Player event emitter context");const k=v.useContext(be.BufferingContextReact);if(!k)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");const{buffering:I}=k,A=v.useCallback(U=>{g?.id&&u(X=>({...X,[g.id]:U})),p.current=U,b.dispatchSeek(U)},[b,u,g?.id]),D=v.useCallback(U=>{t.current||(s(!0),S&&A(0),h&&h.numberOfAudioTags>0&&U&&h.playAllAudios(),d.current.forEach(X=>X.play()),t.current=!0,e(!0),a.current=p.current,b.dispatchPlay())},[t,S,h,e,b,A,d]),F=v.useCallback(()=>{t.current&&(t.current=!1,e(!1),b.dispatchPause())},[b,t,e]),z=v.useCallback(()=>{t.current&&(t.current=!1,p.current=a.current,y&&(u(U=>({...U,[y.id]:a.current})),e(!1),b.dispatchPause()))},[y,b,t,e,u]),L=g?.id,Y=v.useCallback(U=>{if(!L)return null;t.current||c(X=>{const te=X[L]??window.remotion_initialFrame??0;return{...X,[L]:Math.max(0,te-U)}})},[t,c,L]),W=v.useCallback(U=>{if(!L)return null;t.current||c(X=>{const te=X[L]??window.remotion_initialFrame??0;return{...X,[L]:Math.min(_,te+U)}})},[L,t,_,c]);return v.useMemo(()=>({frameBack:Y,frameForward:W,isLastFrame:S,emitter:b,playing:r,play:D,pause:F,seek:A,isFirstFrame:T,getCurrentFrame:()=>p.current,isPlaying:()=>t.current,isBuffering:()=>I.current,pauseAndReturnToPlayStart:z,hasPlayed:n,remotionInternal_currentFrameRef:p}),[Y,W,S,b,r,D,F,A,T,z,n,t,I])},xR=({browserMediaControlsBehavior:r,videoConfig:e,playbackRate:t})=>{const{playing:n,pause:s,play:i,emitter:a,getCurrentFrame:c,seek:u}=Xl();v.useEffect(()=>{navigator.mediaSession&&r.mode!=="do-nothing"&&(n?navigator.mediaSession.playbackState="playing":navigator.mediaSession.playbackState="paused")},[r.mode,n]),v.useEffect(()=>{if(!navigator.mediaSession||r.mode==="do-nothing")return;const h=()=>{e&&navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:e.durationInFrames/e.fps,playbackRate:t,position:c()/e.fps})};return a.addEventListener("timeupdate",h),()=>{a.removeEventListener("timeupdate",h)}},[r.mode,a,c,t,e]),v.useEffect(()=>{if(navigator.mediaSession&&r.mode!=="do-nothing")return navigator.mediaSession.setActionHandler("play",()=>{r.mode==="register-media-session"&&i()}),navigator.mediaSession.setActionHandler("pause",()=>{r.mode==="register-media-session"&&s()}),navigator.mediaSession.setActionHandler("seekto",h=>{r.mode==="register-media-session"&&h.seekTime!==void 0&&e&&u(Math.round(h.seekTime*e.fps))}),navigator.mediaSession.setActionHandler("seekbackward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(0,Math.round((c()-10)*e.fps)))}),navigator.mediaSession.setActionHandler("seekforward",()=>{r.mode==="register-media-session"&&e&&u(Math.max(e.durationInFrames-1,Math.round((c()+10)*e.fps)))}),navigator.mediaSession.setActionHandler("previoustrack",()=>{r.mode==="register-media-session"&&u(0)}),()=>{navigator.mediaSession.metadata=null,navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("seekto",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null)}},[r.mode,c,s,i,u,e])},_R=({time:r,currentFrame:e,playbackSpeed:t,fps:n,actualLastFrame:s,actualFirstFrame:i,framesAdvanced:a,shouldLoop:c})=>{const h=(t<0?Math.ceil:Math.floor)(r*t/(1e3/n))-a,d=h+e,p=e>s||e<i,g=d>s||d<i,y=!c&&g&&!p;return t>0?g?{nextFrame:i,framesToAdvance:h,hasEnded:y}:{nextFrame:d,framesToAdvance:h,hasEnded:y}:g?{nextFrame:s,framesToAdvance:h,hasEnded:y}:{nextFrame:d,framesToAdvance:h,hasEnded:y}},i0=()=>typeof document>"u"?!1:document.visibilityState==="hidden",SR=()=>{const r=v.useRef(i0());return v.useEffect(()=>{const e=()=>{r.current=i0()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),r},CR=({loop:r,playbackRate:e,moveToBeginningWhenEnded:t,inFrame:n,outFrame:s,frameRef:i,browserMediaControlsBehavior:a})=>{const c=be.useUnsafeVideoConfig(),u=be.Timeline.useTimelinePosition(),{playing:h,pause:d,emitter:p}=Xl(),g=be.Timeline.useTimelineSetFrame(),y=v.useRef(null),b=SR(),_=v.useRef(null),S=v.useContext(be.BufferingContextReact);if(!S)throw new Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");xR({browserMediaControlsBehavior:a,playbackRate:e,videoConfig:c}),v.useEffect(()=>{const T=S.listenForBuffering(()=>{y.current=performance.now()}),k=S.listenForResume(()=>{y.current=null});return()=>{T.remove(),k.remove()}},[S]),v.useEffect(()=>{if(!c||!h)return;let T=!1,k=null,I=performance.now(),A=0;const D=()=>{k!==null&&(k.type==="raf"?cancelAnimationFrame(k.id):clearTimeout(k.id))},F=()=>{T=!0,D()},z=()=>{const W=performance.now()-I,q=s??c.durationInFrames-1,U=n??0,X=i.current,{nextFrame:te,framesToAdvance:de,hasEnded:J}=_R({time:W,currentFrame:X,playbackSpeed:e,fps:c.fps,actualFirstFrame:U,actualLastFrame:q,framesAdvanced:A,shouldLoop:r});if(A+=de,te!==i.current&&(!J||t)&&g(le=>({...le,[c.id]:te})),J){F(),d(),p.dispatchEnded();return}T||L()},L=()=>{if(y.current){const W=S.listenForResume(()=>{W.remove(),!T&&(I=performance.now(),A=0,z())});return}b.current?k={type:"timeout",id:setTimeout(z,1e3/c.fps)}:k={type:"raf",id:requestAnimationFrame(z)}};L();const Y=()=>{document.visibilityState!=="visible"&&(D(),z())};return window.addEventListener("visibilitychange",Y),()=>{window.removeEventListener("visibilitychange",Y),F()}},[c,r,d,h,g,p,e,n,s,t,b,i,y,S]),v.useEffect(()=>{const T=setInterval(()=>{_.current!==i.current&&(p.dispatchTimeUpdate({frame:i.current}),_.current=i.current)},250);return()=>clearInterval(T)},[p,i]),v.useEffect(()=>{p.dispatchFrameUpdate({frame:u})},[p,u])},Nh=[],ep=(r,e)=>{const[t,n]=v.useState(()=>{if(!r.current)return null;const a=r.current.getClientRects();return a[0]?{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}}:null}),s=v.useMemo(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(a=>{const{contentRect:c,target:u}=a[0],h=u.getClientRects();if(!h?.[0]){n(null);return}const d=c.width===0?1:h[0].width/c.width,p=e.shouldApplyCssTransforms?h[0].width:h[0].width*(1/d),g=e.shouldApplyCssTransforms?h[0].height:h[0].height*(1/d);n({width:p,height:g,left:h[0].x,top:h[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})}),[e.shouldApplyCssTransforms]),i=v.useCallback(()=>{if(!r.current)return;const a=r.current.getClientRects();if(!a[0]){n(null);return}n(c=>c&&c.width===a[0].width&&c.height===a[0].height&&c.left===a[0].x&&c.top===a[0].y&&c.windowSize.height===window.innerHeight&&c.windowSize.width===window.innerWidth?c:{width:a[0].width,height:a[0].height,left:a[0].x,top:a[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})},[r]);return v.useEffect(()=>{if(!s)return;const{current:a}=r;return a&&s.observe(a),()=>{a&&s.unobserve(a)}},[s,r,i]),v.useEffect(()=>{if(e.triggerOnWindowResize)return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[e.triggerOnWindowResize,i]),v.useEffect(()=>(Nh.push(i),()=>{Nh=Nh.filter(a=>a!==i)}),[i]),v.useMemo(()=>t?{...t,refresh:i}:null,[t,i])},o0=({playing:r,buffering:e})=>r&&e?w.jsx(mR,{type:"player"}):r?w.jsx(uR,{}):w.jsx(lR,{}),Ei=12,a0=5,TR=({volume:r,isVertical:e,onBlur:t,inputRef:n,setVolume:s})=>{const i=v.useMemo(()=>{const g={paddingLeft:5,height:Nt,width:Vs,display:"inline-flex",alignItems:"center"};return e?{...g,position:"absolute",transform:`rotate(-90deg) translateX(${Vs/2+Nt/2}px)`}:{...g}},[e]),a=typeof v.useId>"u"?"volume-slider":v.useId(),[c]=v.useState(()=>`__remotion-volume-slider-${si(a)}`.replace(".","")),u=v.useCallback(p=>{s(parseFloat(p.target.value))},[s]),h=v.useMemo(()=>{const p={WebkitAppearance:"none",backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:a0/2,cursor:"pointer",height:a0,width:Vs,backgroundImage:`linear-gradient(
				to right,
				white ${r*100}%, rgba(255, 255, 255, 0) ${r*100}%
			)`};return e?{...p,bottom:Nt+Vs/2}:p},[e,r]),d=`
	.${c}::-webkit-slider-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${Ei/2}px;
		box-shadow: 0 0 2px black;
		height: ${Ei}px;
		width: ${Ei}px;
	}

	.${c}::-moz-range-thumb {
		-webkit-appearance: none;
		background-color: white;
		border-radius: ${Ei/2}px;
		box-shadow: 0 0 2px black;
		height: ${Ei}px;
		width: ${Ei}px;
	}
`;return w.jsxs("div",{style:i,children:[w.jsx("style",{dangerouslySetInnerHTML:{__html:d}}),w.jsx("input",{ref:n,"aria-label":"Change volume",className:c,max:1,min:0,onBlur:t,onChange:u,step:.01,type:"range",value:r,style:h})]})},ER=r=>w.jsx(TR,{...r}),Vs=100,kR=({displayVerticalVolumeSlider:r,renderMuteButton:e,renderVolumeSlider:t})=>{const[n,s]=be.useMediaMutedState(),[i,a]=be.useMediaVolumeState(),[c,u]=v.useState(!1),h=v.useRef(null),d=v.useRef(null),p=Qf(h,!1),g=v.useCallback(()=>{setTimeout(()=>{d.current&&document.activeElement!==d.current&&u(!1)},10)},[]),y=i===0,b=v.useCallback(()=>{if(y){a(1),s(!1);return}s(A=>!A)},[y,s,a]),_=v.useMemo(()=>({display:"inline-flex",background:"none",border:"none",justifyContent:"center",alignItems:"center",touchAction:"none",...r&&{position:"relative"}}),[r]),S=v.useMemo(()=>({display:"inline",width:Nt,height:Nt,cursor:"pointer",appearance:"none",background:"none",border:"none",padding:0}),[]),T=v.useCallback(({muted:A,volume:D})=>{const F=A||D===0;return w.jsx("button",{"aria-label":F?"Unmute sound":"Mute sound",title:F?"Unmute sound":"Mute sound",onClick:b,onBlur:g,onFocus:()=>u(!0),style:S,type:"button",children:F?w.jsx(dR,{}):w.jsx(fR,{})})},[g,b,S]),k=v.useMemo(()=>e?e({muted:n,volume:i}):T({muted:n,volume:i}),[n,i,T,e]),I=v.useMemo(()=>(c||p)&&!n&&!be.isIosSafari()?(t??ER)({isVertical:r,volume:i,onBlur:()=>u(!1),inputRef:d,setVolume:a}):null,[r,c,p,n,i,t,a]);return w.jsxs("div",{ref:h,style:_,children:[k,I]})};function IR(r){const[e,t]=v.useState(r),n=v.useRef(null);return v.useEffect(()=>{const s=i=>{n.current&&!n.current.contains(i.target)&&t(!1)};return document.addEventListener("pointerup",s,!0),()=>{document.removeEventListener("pointerup",s,!0)}},[]),{ref:n,isComponentVisible:e,setIsComponentVisible:t}}var AR=35,OR=70,MR={height:30,paddingRight:15,paddingLeft:12,display:"flex",flexDirection:"row",alignItems:"center"},PR={width:22,display:"flex",alignItems:"center"},DR={width:14,height:14,color:"black"},RR=()=>w.jsx("svg",{viewBox:"0 0 512 512",style:DR,children:w.jsx("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})}),jR=({rate:r,onSelect:e,selectedRate:t,keyboardSelectedRate:n})=>{const s=v.useCallback(p=>{p.stopPropagation(),p.preventDefault(),e(r)},[e,r]),[i,a]=v.useState(!1),c=v.useCallback(()=>{a(!0)},[]),u=v.useCallback(()=>{a(!1)},[]),h=n===r,d=v.useMemo(()=>({...MR,backgroundColor:i||h?"#eee":"transparent"}),[i,h]);return w.jsxs("div",{onMouseEnter:c,onMouseLeave:u,tabIndex:0,style:d,onClick:s,children:[w.jsx("div",{style:PR,children:r===t?w.jsx(RR,{}):null}),r.toFixed(1),"x"]},r)},FR=({setIsComponentVisible:r,playbackRates:e,canvasSize:t})=>{const{setPlaybackRate:n,playbackRate:s}=v.useContext(be.Timeline.TimelineContext),[i,a]=v.useState(s);v.useEffect(()=>{const h=d=>{if(d.preventDefault(),d.key==="ArrowUp"){const p=e.findIndex(g=>g===i);if(p===0)return;a(p===-1?e[0]:e[p-1])}else if(d.key==="ArrowDown"){const p=e.findIndex(g=>g===i);if(p===e.length-1)return;a(p===-1?e[e.length-1]:e[p+1])}else d.key==="Enter"&&(n(i),r(!1))};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[e,i,n,r]);const c=v.useCallback(h=>{n(h),r(!1)},[r,n]),u=v.useMemo(()=>({position:"absolute",right:0,width:125,maxHeight:t.height-OR-AR,bottom:35,background:"#fff",borderRadius:4,overflow:"auto",color:"black",textAlign:"left"}),[t.height]);return w.jsx("div",{style:u,children:e.map(h=>w.jsx(jR,{selectedRate:s,onSelect:c,rate:h,keyboardSelectedRate:i},h))})},LR={fontSize:13,fontWeight:"bold",color:"white",border:"2px solid white",borderRadius:20,paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2},Pd={appearance:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",paddingLeft:0,paddingRight:0,paddingTop:6,paddingBottom:6,height:37,display:"inline-flex",marginBottom:0,marginTop:0,alignItems:"center"},NR={...Pd,position:"relative"},BR=({playbackRates:r,canvasSize:e})=>{const{ref:t,isComponentVisible:n,setIsComponentVisible:s}=IR(!1),{playbackRate:i}=v.useContext(be.Timeline.TimelineContext),a=v.useCallback(c=>{c.stopPropagation(),c.preventDefault(),s(u=>!u)},[s]);return w.jsx("div",{ref:t,children:w.jsxs("button",{type:"button","aria-label":"Change playback rate",style:NR,onClick:a,children:[w.jsxs("div",{style:LR,children:[i,"x"]}),n&&w.jsx(FR,{canvasSize:e,playbackRates:r,setIsComponentVisible:s})]})})},c0=(r,e,t)=>Math.round(Ob(r,[0,t],[0,e-1],{extrapolateLeft:"clamp",extrapolateRight:"clamp"})),Oi=5,Do=12,Dd=4,VR={userSelect:"none",WebkitUserSelect:"none",paddingTop:Dd,paddingBottom:Dd,boxSizing:"border-box",cursor:"pointer",position:"relative",touchAction:"none"},zR={height:Oi,backgroundColor:"rgba(255, 255, 255, 0.25)",width:"100%",borderRadius:Oi/2},WR=r=>{let e=r;for(;e.parentElement;)e=e.parentElement;return e},HR=({durationInFrames:r,onSeekEnd:e,onSeekStart:t,inFrame:n,outFrame:s})=>{const i=v.useRef(null),a=Qf(i,!1),c=ep(i,{triggerOnWindowResize:!0,shouldApplyCssTransforms:!0}),{seek:u,play:h,pause:d,playing:p}=Xl(),g=be.Timeline.useTimelinePosition(),[y,b]=v.useState({dragging:!1}),_=c?.width??0,S=v.useCallback(F=>{if(F.button!==0)return;const z=i.current?.getBoundingClientRect().left,L=c0(F.clientX-z,r,_);d(),u(L),b({dragging:!0,wasPlaying:p}),t()},[r,_,d,u,p,t]),T=v.useCallback(F=>{if(!c)throw new Error("Player has no size");if(!y.dragging)return;const z=i.current?.getBoundingClientRect().left,L=c0(F.clientX-z,r,c.width);u(L)},[y.dragging,r,u,c]),k=v.useCallback(()=>{b({dragging:!1}),y.dragging&&(y.wasPlaying?h():d(),e())},[y,e,d,h]);v.useEffect(()=>{if(!y.dragging)return;const F=WR(i.current);return F.addEventListener("pointermove",T),F.addEventListener("pointerup",k),()=>{F.removeEventListener("pointermove",T),F.removeEventListener("pointerup",k)}},[y.dragging,T,k]);const I=v.useMemo(()=>({height:Do,width:Do,borderRadius:Do/2,position:"absolute",top:Dd-Do/2+5/2,backgroundColor:"white",left:Math.max(0,g/Math.max(1,r-1)*_-Do/2),boxShadow:"0 0 2px black",opacity:Number(a)}),[a,r,g,_]),A=v.useMemo(()=>({height:Oi,backgroundColor:"rgba(255, 255, 255, 1)",width:(g-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:Oi/2}),[r,g,n]),D=v.useMemo(()=>({height:Oi,backgroundColor:"rgba(255, 255, 255, 0.25)",width:((s??r-1)-(n??0))/(r-1)*100+"%",marginLeft:(n??0)/(r-1)*100+"%",borderRadius:Oi/2,position:"absolute"}),[r,n,s]);return w.jsxs("div",{ref:i,onPointerDown:S,style:VR,children:[w.jsxs("div",{style:zR,children:[w.jsx("div",{style:D}),w.jsx("div",{style:A})]}),w.jsx("div",{style:I})]})},l0=r=>{const e=Math.floor(r/60),t=Math.floor(r-e*60);return`${String(e)}:${String(t).padStart(2,"0")}`},UR=10,Rd=12,$R=({allowFullscreen:r,playerWidth:e})=>v.useMemo(()=>{const n=Nt,s=Nt,i=r?Md:0,a=s+n+i+Rd*2+UR*2,c=e-a,u=Math.max(c,0),h=u-Vs,p=(h<Vs?u:h)+a+Vs,g=e<p;return{maxTimeLabelWidth:u===0?null:u,displayVerticalVolumeSlider:g}},[r,e]),YR=[0,.013,.049,.104,.175,.259,.352,.45,.55,.648,.741,.825,.896,.951,.987],XR=[0,8.1,15.5,22.5,29,35.3,41.2,47.1,52.9,58.8,64.7,71,77.5,84.5,91.9],GR=1/.7,qR={boxSizing:"border-box",position:"absolute",bottom:0,width:"100%",paddingTop:40,paddingBottom:10,backgroundImage:`linear-gradient(to bottom,${YR.map((r,e)=>`hsla(0, 0%, 0%, ${r}) ${XR[e]*GR}%`).join(", ")}, hsl(0, 0%, 0%) 100%)`,backgroundSize:"auto 145px",display:"flex",paddingRight:Rd,paddingLeft:Rd,flexDirection:"column",transition:"opacity 0.3s"},KR={display:"flex",flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none"},ZR={display:"flex",flexDirection:"row",userSelect:"none",WebkitUserSelect:"none",alignItems:"center"},Sc={width:12},JR={height:8},QR={flex:1},e3={},t3=({durationInFrames:r,isFullscreen:e,fps:t,player:n,showVolumeControls:s,onFullscreenButtonClick:i,allowFullscreen:a,onExitFullscreenButtonClick:c,spaceKeyToPlayOrPause:u,onSeekEnd:h,onSeekStart:d,inFrame:p,outFrame:g,initiallyShowControls:y,canvasSize:b,renderPlayPauseButton:_,renderFullscreenButton:S,alwaysShowControls:T,showPlaybackRateControl:k,containerRef:I,buffering:A,hideControlsWhenPointerDoesntMove:D,onPointerDown:F,onDoubleClick:z,renderMuteButton:L,renderVolumeSlider:Y})=>{const W=v.useRef(null),q=be.Timeline.useTimelinePosition(),[U,X]=v.useState(!1),te=Qf(I,D),{maxTimeLabelWidth:de,displayVerticalVolumeSlider:J}=$R({allowFullscreen:a,playerWidth:b?.width??0}),[le,ie]=v.useState(()=>{if(typeof y=="boolean")return y;if(typeof y=="number"){if(y%1!==0)throw new Error("initiallyShowControls must be an integer or a boolean");if(Number.isNaN(y))throw new Error("initiallyShowControls must not be NaN");if(!Number.isFinite(y))throw new Error("initiallyShowControls must be finite");if(y<=0)throw new Error("initiallyShowControls must be a positive integer");return y}throw new TypeError("initiallyShowControls must be a number or a boolean")}),se=v.useMemo(()=>{const Se=te||!n.playing||le||T;return{...qR,opacity:Number(Se)}},[te,le,n.playing,T]);v.useEffect(()=>{W.current&&u&&W.current.focus({preventScroll:!0})},[n.playing,u]),v.useEffect(()=>{X((typeof document<"u"&&(document.fullscreenEnabled||document.webkitFullscreenEnabled))??!1)},[]),v.useEffect(()=>{if(le===!1)return;const ot=setTimeout(()=>{ie(!1)},le===!0?2e3:le);return()=>{clearInterval(ot)}},[le]);const he=v.useMemo(()=>({color:"white",fontFamily:"sans-serif",fontSize:14,maxWidth:de===null?void 0:de,overflow:"hidden",textOverflow:"ellipsis"}),[de]),re=v.useMemo(()=>{if(k===!0)return[.5,.8,1,1.2,1.5,1.8,2,2.5,3];if(Array.isArray(k)){for(const Se of k){if(typeof Se!="number")throw new Error("Every item in showPlaybackRateControl must be a number");if(Se<=0)throw new Error("Every item in showPlaybackRateControl must be positive")}return k}return null},[k]),De=v.useRef(null),$e=v.useRef(null),je=v.useCallback(Se=>{(Se.target===De.current||Se.target===$e.current)&&F?.(Se)},[F]),we=v.useCallback(Se=>{(Se.target===De.current||Se.target===$e.current)&&z?.(Se)},[z]);return w.jsxs("div",{ref:De,style:se,onPointerDown:je,onDoubleClick:we,children:[w.jsxs("div",{ref:$e,style:KR,children:[w.jsxs("div",{style:ZR,children:[w.jsx("button",{ref:W,type:"button",style:Pd,onClick:n.playing?n.pause:n.play,"aria-label":n.playing?"Pause video":"Play video",title:n.playing?"Pause video":"Play video",children:_===null?w.jsx(o0,{buffering:A,playing:n.playing}):_({playing:n.playing,isBuffering:A})??w.jsx(o0,{buffering:A,playing:n.playing})}),s?w.jsxs(w.Fragment,{children:[w.jsx("div",{style:Sc}),w.jsx(kR,{renderMuteButton:L,renderVolumeSlider:Y,displayVerticalVolumeSlider:J})]}):null,w.jsx("div",{style:Sc}),w.jsxs("div",{style:he,children:[l0(q/t)," / ",l0(r/t)]}),w.jsx("div",{style:Sc})]}),w.jsx("div",{style:QR}),re&&b&&w.jsx(BR,{canvasSize:b,playbackRates:re}),re&&U&&a?w.jsx("div",{style:Sc}):null,w.jsx("div",{style:e3,children:U&&a?w.jsx("button",{type:"button","aria-label":e?"Exit fullscreen":"Enter Fullscreen",title:e?"Exit fullscreen":"Enter Fullscreen",style:Pd,onClick:e?c:i,children:S===null?w.jsx(hR,{isFullscreen:e}):S({isFullscreen:e})}):null})]}),w.jsx("div",{style:JR}),w.jsx(HR,{onSeekEnd:h,onSeekStart:d,durationInFrames:r,inFrame:p,outFrame:g})]})},r3={display:"flex",justifyContent:"center",alignItems:"center",flex:1,height:"100%",width:"100%"};class tw extends v.Component{state={hasError:null};static getDerivedStateFromError(e){return{hasError:e}}componentDidCatch(e){this.props.onError(e)}render(){return this.state.hasError?w.jsx("div",{style:r3,children:this.props.errorFallback({error:this.state.hasError})}):this.props.children}}var tp="__remotion-player",rw=typeof document>"u",n3=r=>{let e=!1;return{promise:new Promise((n,s)=>{r.then(i=>{if(e){s({isCanceled:e,value:i});return}n(i)}).catch(i=>{s({isCanceled:e,error:i})})}),cancel:()=>{e=!0}}},s3=r=>new Promise(e=>setTimeout(e,r)),i3=()=>{const r=v.useRef([]),e=v.useCallback(i=>{r.current=[...r.current,i]},[]),t=v.useCallback(i=>{r.current=r.current.filter(a=>a!==i)},[]),n=v.useCallback(()=>r.current.map(i=>i.cancel()),[]);return v.useMemo(()=>({appendPendingPromise:e,removePendingPromise:t,clearPendingPromises:n}),[e,n,t])},o3=(r,e,t)=>{const n=i3(),s=v.useCallback(async u=>{if(u instanceof PointerEvent?u.pointerType==="touch":u.nativeEvent.pointerType==="touch"){r(u);return}n.clearPendingPromises();const h=n3(s3(200));n.appendPendingPromise(h);try{await h.promise,n.removePendingPromise(h),r(u)}catch(d){const p=d;if(n.removePendingPromise(h),!p.isCanceled)throw p.error}},[n,r]),i=v.useCallback(()=>{document.addEventListener("pointerup",u=>{s(u)},{once:!0})},[s]),a=v.useCallback(()=>{n.clearPendingPromises(),e()},[n,e]);return v.useMemo(()=>t?{handlePointerDown:i,handleDoubleClick:a}:{handlePointerDown:r,handleDoubleClick:()=>{}},[t,a,i,r])},jd=v.version.split(".")[0];if(jd==="0")throw new Error(`Version ${jd} of "react" is not supported by Remotion`);var a3=parseInt(jd,10)>=18,c3=({controls:r,style:e,loop:t,autoPlay:n,allowFullscreen:s,inputProps:i,clickToPlay:a,showVolumeControls:c,doubleClickToFullscreen:u,spaceKeyToPlayOrPause:h,errorFallback:d,playbackRate:p,renderLoading:g,renderPoster:y,className:b,moveToBeginningWhenEnded:_,showPosterWhenUnplayed:S,showPosterWhenEnded:T,showPosterWhenPaused:k,showPosterWhenBuffering:I,inFrame:A,outFrame:D,initiallyShowControls:F,renderFullscreen:z,renderPlayPauseButton:L,renderMuteButton:Y,renderVolumeSlider:W,alwaysShowControls:q,showPlaybackRateControl:U,posterFillMode:X,bufferStateDelayInMilliseconds:te,hideControlsWhenPointerDoesntMove:de,overflowVisible:J,browserMediaControlsBehavior:le},ie)=>{const se=be.useUnsafeVideoConfig(),he=be.useVideo(),re=v.useRef(null),De=ep(re,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),[$e,je]=v.useState(!1),[we,Se]=v.useState(n),[ot,tr]=v.useState(()=>!1),[Rt,Ct]=v.useState(!1),rr=v.useMemo(()=>typeof document>"u"?!1:!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),[]),pe=Xl();CR({loop:t,playbackRate:p,moveToBeginningWhenEnded:_,inFrame:A,outFrame:D,frameRef:pe.remotionInternal_currentFrameRef,browserMediaControlsBehavior:le}),v.useEffect(()=>{$e&&!pe.playing&&(je(!1),pe.play())},[$e,pe]),v.useEffect(()=>{const{current:Be}=re;if(!Be)return;const Le=()=>{const gr=document.fullscreenElement===Be||document.webkitFullscreenElement===Be;tr(gr)};return document.addEventListener("fullscreenchange",Le),document.addEventListener("webkitfullscreenchange",Le),()=>{document.removeEventListener("fullscreenchange",Le),document.removeEventListener("webkitfullscreenchange",Le)}},[]);const dr=v.useCallback(Be=>{pe.isPlaying()?pe.pause():pe.play(Be)},[pe]),Qe=v.useCallback(()=>{if(!s)throw new Error("allowFullscreen is false");if(!rr)throw new Error("Browser doesnt support fullscreen");if(!re.current)throw new Error("No player ref found");re.current.webkitRequestFullScreen?re.current.webkitRequestFullScreen():re.current.requestFullscreen()},[s,rr]),Pt=v.useCallback(()=>{document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen()},[]);v.useEffect(()=>{const{current:Be}=re;if(!Be)return;const Le=()=>{const gr=document.webkitFullscreenElement??document.fullscreenElement;gr&&gr===re.current?pe.emitter.dispatchFullscreenChange({isFullscreen:!0}):pe.emitter.dispatchFullscreenChange({isFullscreen:!1})};return Be.addEventListener("webkitfullscreenchange",Le),Be.addEventListener("fullscreenchange",Le),()=>{Be.removeEventListener("webkitfullscreenchange",Le),Be.removeEventListener("fullscreenchange",Le)}},[pe.emitter]);const Un=se?.durationInFrames??1,Ze=v.useMemo(()=>!se||!De?null:Gb({canvasSize:De,compositionHeight:se.height,compositionWidth:se.width,previewSize:"auto"}),[De,se]),Tt=Ze?.scale??1,wn=v.useRef(!1);v.useEffect(()=>{if(!wn.current){wn.current=!0;return}pe.emitter.dispatchScaleChange(Tt)},[pe.emitter,Tt]);const{setMediaVolume:fr,setMediaMuted:M}=v.useContext(be.SetMediaVolumeContext),{mediaMuted:ce,mediaVolume:ae}=v.useContext(be.MediaVolumeContext);v.useEffect(()=>{pe.emitter.dispatchVolumeChange(ae)},[pe.emitter,ae]);const Ae=ce||ae===0;v.useEffect(()=>{pe.emitter.dispatchMuteChange({isMuted:Ae})},[pe.emitter,Ae]);const[Ge,We]=v.useState(!1);v.useEffect(()=>{let Be=null,Le=!1;const gr=()=>{Le=!1,requestAnimationFrame(()=>{te===0?We(!0):Be=setTimeout(()=>{Le||We(!0)},te)})},an=()=>{requestAnimationFrame(()=>{Le=!0,We(!1),Be&&clearTimeout(Be)})};return pe.emitter.addEventListener("waiting",gr),pe.emitter.addEventListener("resume",an),()=>{pe.emitter.removeEventListener("waiting",gr),pe.emitter.removeEventListener("resume",an),We(!1),Be&&clearTimeout(Be),Le=!0}},[te,pe.emitter]),v.useImperativeHandle(ie,()=>{const Be={play:pe.play,pause:()=>{je(!1),pe.pause()},toggle:dr,getContainerNode:()=>re.current,getCurrentFrame:pe.getCurrentFrame,isPlaying:pe.isPlaying,seekTo:Le=>{const gr=Un-1,an=Math.max(0,Math.min(gr,Le));pe.isPlaying()&&(je(an!==gr||t),pe.pause()),an===gr&&!t&&pe.emitter.dispatchEnded(),pe.seek(an)},isFullscreen:()=>{const{current:Le}=re;return Le?document.fullscreenElement===Le||document.webkitFullscreenElement===Le:!1},requestFullscreen:Qe,exitFullscreen:Pt,getVolume:()=>ce?0:ae,setVolume:Le=>{if(typeof Le!="number")throw new TypeError(`setVolume() takes a number, got value of type ${typeof Le}`);if(isNaN(Le))throw new TypeError("setVolume() got a number that is NaN. Volume must be between 0 and 1.");if(Le<0||Le>1)throw new TypeError(`setVolume() got a number that is out of range. Must be between 0 and 1, got ${typeof Le}`);fr(Le)},isMuted:()=>Ae,mute:()=>{M(!0)},unmute:()=>{M(!1)},getScale:()=>Tt,pauseAndReturnToPlayStart:()=>{pe.pauseAndReturnToPlayStart()}};return Object.assign(pe.emitter,Be)},[Un,Pt,t,ce,Ae,ae,pe,Qe,M,fr,dr,Tt]);const ye=he?he.component:null,et=v.useMemo(()=>qb({canvasSize:De,config:se,style:e,overflowVisible:J,layout:Ze}),[De,se,Ze,J,e]),nr=v.useMemo(()=>Zb({config:se,layout:Ze,scale:Tt,overflowVisible:J}),[se,Ze,J,Tt]),mt=v.useMemo(()=>Kb({canvasSize:De,config:se,layout:Ze,scale:Tt,overflowVisible:J}),[De,se,Ze,J,Tt]),pr=v.useCallback(Be=>{pe.pause(),pe.emitter.dispatchError(Be)},[pe]),Hr=v.useCallback(Be=>{Be.stopPropagation(),Qe()},[Qe]),sr=v.useCallback(Be=>{Be.stopPropagation(),Pt()},[Pt]),on=v.useCallback(Be=>{(Be instanceof MouseEvent?Be.button===2:Be.nativeEvent.button)||dr(Be)},[dr]),$t=v.useCallback(()=>{Ct(!0)},[]),uo=v.useCallback(()=>{Ct(!1)},[]),ho=v.useCallback(()=>{ot?Pt():Qe()},[Pt,ot,Qe]),{handlePointerDown:ui,handleDoubleClick:hi}=o3(on,ho,u&&s&&rr);v.useEffect(()=>{we&&(pe.play(),Se(!1))},[we,pe]);const vu=v.useMemo(()=>g?g({height:et.height,width:et.width,isBuffering:Ge}):null,[et.height,et.width,g,Ge]),Aa=v.useMemo(()=>({type:"scale",scale:Tt}),[Tt]);if(!se)return null;const xs=y?y({height:X==="player-size"?et.height:se.height,width:X==="player-size"?et.width:se.width,isBuffering:Ge}):null;if(xs===void 0)throw new TypeError("renderPoster() must return a React element, but undefined was returned");const Oa=xs&&[k&&!pe.isPlaying()&&!Rt,T&&pe.isLastFrame&&!pe.isPlaying(),S&&!pe.hasPlayed&&!pe.isPlaying(),I&&Ge&&pe.isPlaying()].some(Boolean),{left:Wp,top:Hp,width:Up,height:yu,...bu}=nr,Ma=w.jsxs(w.Fragment,{children:[w.jsx("div",{style:nr,onPointerDown:a?ui:void 0,onDoubleClick:u?hi:void 0,children:w.jsxs("div",{style:mt,className:tp,children:[ye?w.jsx(tw,{onError:pr,errorFallback:d,children:w.jsx(be.CurrentScaleContext.Provider,{value:Aa,children:w.jsx(ye,{...he?.props??{},...i??{}})})}):null,Oa&&X==="composition-size"?w.jsx("div",{style:{...bu,width:se.width,height:se.height},onPointerDown:a?ui:void 0,onDoubleClick:u?hi:void 0,children:xs}):null]})}),Oa&&X==="player-size"?w.jsx("div",{style:nr,onPointerDown:a?ui:void 0,onDoubleClick:u?hi:void 0,children:xs}):null,r?w.jsx(t3,{fps:se.fps,durationInFrames:se.durationInFrames,player:pe,containerRef:re,onFullscreenButtonClick:Hr,isFullscreen:ot,allowFullscreen:s,showVolumeControls:c,onExitFullscreenButtonClick:sr,spaceKeyToPlayOrPause:h,onSeekEnd:uo,onSeekStart:$t,inFrame:A,outFrame:D,initiallyShowControls:F,canvasSize:De,renderFullscreenButton:z,renderPlayPauseButton:L,alwaysShowControls:q,showPlaybackRateControl:U,buffering:Ge,hideControlsWhenPointerDoesntMove:de,onDoubleClick:u?hi:void 0,onPointerDown:a?ui:void 0,renderMuteButton:Y,renderVolumeSlider:W}):null]});return rw&&!a3?w.jsx("div",{ref:re,style:et,className:b,children:Ma}):w.jsx("div",{ref:re,style:et,className:b,children:w.jsx(v.Suspense,{fallback:vu,children:Ma})})},l3=v.forwardRef(c3),nw="remotion.volumePreference",u3=r=>{if(!(typeof window>"u"))try{window.localStorage.setItem(nw,String(r))}catch(e){console.log("Could not persist volume",e)}},h3=()=>{if(typeof window>"u")return 1;try{const r=window.localStorage.getItem(nw);return r?Number(r):1}catch{return 1}},rp="player-comp",sw=({children:r,timelineContext:e,fps:t,compositionHeight:n,compositionWidth:s,durationInFrames:i,component:a,numberOfSharedAudioTags:c,initiallyMuted:u})=>{const h=v.useMemo(()=>({compositions:[{component:a,durationInFrames:i,height:n,width:s,fps:t,id:rp,nonce:777,folderName:null,parentFolderName:null,schema:null,calculateMetadata:null}],folders:[],registerFolder:()=>{},unregisterFolder:()=>{},registerComposition:()=>{},unregisterComposition:()=>{},currentCompositionMetadata:null,setCurrentCompositionMetadata:()=>{},canvasContent:{type:"composition",compositionId:"player-comp"},setCanvasContent:()=>{},updateCompositionDefaultProps:()=>{}}),[a,i,n,s,t]),[d,p]=v.useState(()=>u),[g,y]=v.useState(()=>h3()),b=v.useMemo(()=>({mediaMuted:d,mediaVolume:g}),[d,g]),_=v.useCallback(T=>{y(T),u3(T)},[]),S=v.useMemo(()=>({setMediaMuted:p,setMediaVolume:_}),[_]);return w.jsx(be.CanUseRemotionHooksProvider,{children:w.jsx(be.Timeline.TimelineContext.Provider,{value:e,children:w.jsx(be.CompositionManager.Provider,{value:h,children:w.jsx(be.ResolveCompositionConfig,{children:w.jsx(be.PrefetchProvider,{children:w.jsx(be.DurationsContextProvider,{children:w.jsx(be.MediaVolumeContext.Provider,{value:b,children:w.jsx(be.SetMediaVolumeContext.Provider,{value:S,children:w.jsx(be.SharedAudioContextProvider,{numberOfAudioTags:c,component:a,children:w.jsx(be.BufferingProvider,{children:r})})})})})})})})})})},u0=(r,e)=>{if(typeof r>"u"||r===null)return r??null;if(typeof r!="number")throw new TypeError(`"${e}" must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new TypeError(`"${e}" must not be NaN, but is ${JSON.stringify(r)}`);if(!Number.isFinite(r))throw new TypeError(`"${e}" must be finite, but is ${JSON.stringify(r)}`);if(r%1!==0)throw new TypeError(`"${e}" must be an integer, but is ${JSON.stringify(r)}`);return r},d3=({inFrame:r,durationInFrames:e,outFrame:t})=>{const n=u0(r,"inFrame"),s=u0(t,"outFrame");if(!(n===null&&s===null)){if(n!==null&&n>e-1)throw new Error("inFrame must be less than (durationInFrames - 1), but is "+n);if(s!==null&&s>e-1)throw new Error("outFrame must be less than (durationInFrames - 1), but is "+s);if(n!==null&&n<0)throw new Error("inFrame must be greater than 0, but is "+n);if(s!==null&&s<=0)throw new Error(`outFrame must be greater than 0, but is ${s}. If you want to render a single frame, use <Thumbnail /> instead.`);if(s!==null&&n!==null&&s<=n)throw new Error("outFrame must be greater than inFrame, but is "+s+" <= "+n)}},f3=({initialFrame:r,durationInFrames:e})=>{if(typeof e!="number")throw new Error(`\`durationInFrames\` must be a number, but is ${JSON.stringify(e)}`);if(!(typeof r>"u")){if(typeof r!="number")throw new Error(`\`initialFrame\` must be a number, but is ${JSON.stringify(r)}`);if(Number.isNaN(r))throw new Error("`initialFrame` must be a number, but is NaN");if(!Number.isFinite(r))throw new Error("`initialFrame` must be a number, but is Infinity");if(r%1!==0)throw new Error(`\`initialFrame\` must be an integer, but is ${JSON.stringify(r)}`);if(r>e-1)throw new Error(`\`initialFrame\` must be less or equal than \`durationInFrames - 1\`, but is ${JSON.stringify(r)}`)}},p3=r=>{if(r!==void 0){if(r>4)throw new Error(`The highest possible playback rate is 4. You passed: ${r}`);if(r<-4)throw new Error(`The lowest possible playback rate is -4. You passed: ${r}`);if(r===0)throw new Error("A playback rate of 0 is not supported.")}},g3=Yl.validateFps,h0=Yl.validateDimension,m3=Yl.validateDurationInFrames,v3=Yl.validateDefaultAndInputProps,y3=r=>"component"in r?r.component:null,b3=({durationInFrames:r,compositionHeight:e,compositionWidth:t,fps:n,inputProps:s,style:i,controls:a=!1,loop:c=!1,autoPlay:u=!1,showVolumeControls:h=!0,allowFullscreen:d=!0,clickToPlay:p,doubleClickToFullscreen:g=!1,spaceKeyToPlayOrPause:y=!0,moveToBeginningWhenEnded:b=!0,numberOfSharedAudioTags:_=5,errorFallback:S=()=>"",playbackRate:T=1,renderLoading:k,className:I,showPosterWhenUnplayed:A,showPosterWhenEnded:D,showPosterWhenPaused:F,showPosterWhenBuffering:z,initialFrame:L,renderPoster:Y,inFrame:W,outFrame:q,initiallyShowControls:U,renderFullscreenButton:X,renderPlayPauseButton:te,renderVolumeSlider:de,alwaysShowControls:J=!1,initiallyMuted:le=!1,showPlaybackRateControl:ie=!1,posterFillMode:se="player-size",bufferStateDelayInMilliseconds:he,hideControlsWhenPointerDoesntMove:re=!0,overflowVisible:De=!1,renderMuteButton:$e,browserMediaControlsBehavior:je,...we},Se)=>{if(typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]),we.defaultProps!==void 0)throw new Error("The <Player /> component does not accept `defaultProps`, but some were passed. Use `inputProps` instead.");const ot=y3(we);if(ot?.type===e0)throw new TypeError("'component' should not be an instance of <Composition/>. Pass the React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");if(ot===e0)throw new TypeError("'component' must not be the 'Composition' component. Pass your own React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");const tr=be.useLazyComponent(we);f3({initialFrame:L,durationInFrames:r});const[Rt,Ct]=v.useState(()=>({[rp]:L??0})),[rr,pe]=v.useState(!1),[dr]=v.useState("player-comp"),Qe=v.useRef(null),Pt=v.useRef([]),Un=v.useRef(!1),[Ze,Tt]=v.useState(T);if(typeof e!="number")throw new TypeError(`'compositionHeight' must be a number but got '${typeof e}' instead`);if(typeof t!="number")throw new TypeError(`'compositionWidth' must be a number but got '${typeof t}' instead`);if(h0(e,"compositionHeight","of the <Player /> component"),h0(t,"compositionWidth","of the <Player /> component"),m3(r,{component:"of the <Player/> component",allowFloats:!1}),g3(n,"as a prop of the <Player/> component",!1),v3(s,"inputProps",null),d3({durationInFrames:r,inFrame:W,outFrame:q}),typeof a!="boolean"&&typeof a<"u")throw new TypeError(`'controls' must be a boolean or undefined but got '${typeof a}' instead`);if(typeof u!="boolean"&&typeof u<"u")throw new TypeError(`'autoPlay' must be a boolean or undefined but got '${typeof u}' instead`);if(typeof c!="boolean"&&typeof c<"u")throw new TypeError(`'loop' must be a boolean or undefined but got '${typeof c}' instead`);if(typeof g!="boolean"&&typeof g<"u")throw new TypeError(`'doubleClickToFullscreen' must be a boolean or undefined but got '${typeof g}' instead`);if(typeof h!="boolean"&&typeof h<"u")throw new TypeError(`'showVolumeControls' must be a boolean or undefined but got '${typeof h}' instead`);if(typeof d!="boolean"&&typeof d<"u")throw new TypeError(`'allowFullscreen' must be a boolean or undefined but got '${typeof d}' instead`);if(typeof p!="boolean"&&typeof p<"u")throw new TypeError(`'clickToPlay' must be a boolean or undefined but got '${typeof p}' instead`);if(typeof y!="boolean"&&typeof y<"u")throw new TypeError(`'spaceKeyToPlayOrPause' must be a boolean or undefined but got '${typeof y}' instead`);if(typeof _!="number"||_%1!==0||!Number.isFinite(_)||Number.isNaN(_)||_<0)throw new TypeError(`'numberOfSharedAudioTags' must be an integer but got '${_}' instead`);p3(Ze),v.useEffect(()=>{Tt(T)},[T]),v.useImperativeHandle(Se,()=>Qe.current,[]);const wn=v.useMemo(()=>({frame:Rt,playing:rr,rootId:dr,playbackRate:Ze,imperativePlaying:Un,setPlaybackRate:ae=>{Tt(ae)},audioAndVideoTags:Pt}),[Rt,Ze,rr,dr]),fr=v.useMemo(()=>({setFrame:Ct,setPlaying:pe}),[Ct]);typeof window<"u"&&v.useLayoutEffect(()=>{be.CSSUtils.injectCSS(be.CSSUtils.makeDefaultPreviewCSS(`.${tp}`,"#fff"))},[]);const M=v.useMemo(()=>s??{},[s]),ce=v.useMemo(()=>je??{mode:"prevent-media-session"},[je]);return w.jsx(be.IsPlayerContextProvider,{children:w.jsx(sw,{timelineContext:wn,component:tr,compositionHeight:e,compositionWidth:t,durationInFrames:r,fps:n,numberOfSharedAudioTags:_,initiallyMuted:le,children:w.jsx(be.Timeline.SetTimelineContext.Provider,{value:fr,children:w.jsx(wR,{currentPlaybackRate:Ze,children:w.jsx(l3,{ref:Qe,posterFillMode:se,renderLoading:k,autoPlay:!!u,loop:!!c,controls:!!a,errorFallback:S,style:i,inputProps:M,allowFullscreen:!!d,moveToBeginningWhenEnded:!!b,clickToPlay:typeof p=="boolean"?p:!!a,showVolumeControls:!!h,doubleClickToFullscreen:!!g,spaceKeyToPlayOrPause:!!y,playbackRate:Ze,className:I??void 0,showPosterWhenUnplayed:!!A,showPosterWhenEnded:!!D,showPosterWhenPaused:!!F,showPosterWhenBuffering:!!z,renderPoster:Y,inFrame:W??null,outFrame:q??null,initiallyShowControls:U??!0,renderFullscreen:X??null,renderPlayPauseButton:te??null,renderMuteButton:$e??null,renderVolumeSlider:de??null,alwaysShowControls:J,showPlaybackRateControl:ie,bufferStateDelayInMilliseconds:he??300,hideControlsWhenPointerDoesntMove:re,overflowVisible:De,browserMediaControlsBehavior:ce})})})})})},w3=v.forwardRef,x3=w3(b3),_3=()=>{const r=v.useContext(Qb);if(!r)throw new TypeError("Expected Player event emitter context");return v.useMemo(()=>({emitter:r}),[r])},Fd=v.version.split(".")[0];if(Fd==="0")throw new Error(`Version ${Fd} of "react" is not supported by Remotion`);var S3=parseInt(Fd,10)>=18,C3=({style:r,inputProps:e,errorFallback:t,renderLoading:n,className:s,overflowVisible:i},a)=>{const c=be.useUnsafeVideoConfig(),u=be.useVideo(),h=v.useRef(null),d=ep(h,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),p=v.useMemo(()=>!c||!d?null:Gb({canvasSize:d,compositionHeight:c.height,compositionWidth:c.width,previewSize:"auto"}),[d,c]),g=p?.scale??1,y=_3();ew(y.emitter),v.useImperativeHandle(a,()=>{const F={getContainerNode:()=>h.current,getScale:()=>g};return Object.assign(y.emitter,F)},[g,y.emitter]);const b=u?u.component:null,_=v.useMemo(()=>qb({config:c,style:r,canvasSize:d,overflowVisible:i,layout:p}),[d,c,p,i,r]),S=v.useMemo(()=>Zb({config:c,layout:p,scale:g,overflowVisible:i}),[c,p,i,g]),T=v.useMemo(()=>Kb({canvasSize:d,config:c,layout:p,scale:g,overflowVisible:i}),[d,c,p,i,g]),k=v.useCallback(F=>{y.emitter.dispatchError(F)},[y.emitter]),I=v.useMemo(()=>n?n({height:_.height,width:_.width,isBuffering:!1}):null,[_.height,_.width,n]),A=v.useMemo(()=>({type:"scale",scale:g}),[g]);if(!c)return null;const D=w.jsx("div",{style:S,children:w.jsx("div",{style:T,className:tp,children:b?w.jsx(tw,{onError:k,errorFallback:t,children:w.jsx(be.CurrentScaleContext.Provider,{value:A,children:w.jsx(b,{...u?.props??{},...e??{}})})}):null})});return rw&&!S3?w.jsx("div",{ref:h,style:_,className:s,children:D}):w.jsx("div",{ref:h,style:_,className:s,children:w.jsx(v.Suspense,{fallback:I,children:D})})},T3=v.forwardRef(C3),E3=({frameToDisplay:r,style:e,inputProps:t,compositionHeight:n,compositionWidth:s,durationInFrames:i,fps:a,className:c,errorFallback:u=()=>"",renderLoading:h,overflowVisible:d=!1,...p},g)=>{typeof window<"u"&&v.useLayoutEffect(()=>{window.remotion_isPlayer=!0},[]);const[y]=v.useState(()=>String(si(null))),b=v.useRef(null),_=v.useMemo(()=>({playing:!1,frame:{[rp]:r},rootId:y,imperativePlaying:{current:!1},playbackRate:1,setPlaybackRate:()=>{throw new Error("thumbnail")},audioAndVideoTags:{current:[]}}),[r,y]);v.useImperativeHandle(g,()=>b.current,[]);const S=be.useLazyComponent(p),[T]=v.useState(()=>new bR),k=v.useMemo(()=>t??{},[t]);return w.jsx(be.IsPlayerContextProvider,{children:w.jsx(sw,{timelineContext:_,component:S,compositionHeight:n,compositionWidth:s,durationInFrames:i,fps:a,numberOfSharedAudioTags:0,initiallyMuted:!0,children:w.jsx(Qb.Provider,{value:T,children:w.jsx(T3,{ref:b,className:c,errorFallback:u,inputProps:k,renderLoading:h,style:e,overflowVisible:d})})})})},k3=v.forwardRef;k3(E3);const Cc=(r,e)=>{const t=r.from/1e3*e,n=r.to/1e3*e-t;return{from:t,durationInFrames:n}},iw={text:(r,e)=>{const{fps:t,height:n,width:s}=e,{from:i,durationInFrames:a}=Cc(r.display,t);return w.jsx(fn,{from:i,durationInFrames:a,"data-track-item":"transition-element",style:{position:"absolute",width:r.details.width??300,height:r.details.height??400,transform:r.details.transform??"none",fontSize:r.details.fontSize||"16px",textAlign:r.details.textAlign||"left",top:r.details.top??300,left:r.details.left??600,color:r.details.color||"#000000",backgroundColor:r.details.backgroundColor||"transparent",border:r.details.border??"none",opacity:r.details.opacity??100/100,fontFamily:r.details.fontFamily||"Arial",textDecoration:r.details.textDecoration||"none",fontWeight:r.details.fontWeight||"normal",lineHeight:r.details.lineHeight||"normal",letterSpacing:r.details.letterSpacing||"normal",wordSpacing:r.details.wordSpacing||"normal",wordWrap:r.details.wordWrap||"normal",wordBreak:r.details.wordBreak||"normal",pointerEvents:"auto"},children:w.jsx("div",{children:r.details.text})},r.id)},image:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Cc(r.display,t);return w.jsx(fn,{from:n,durationInFrames:s,style:{width:r.details.width??"100%",height:r.details.height??"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",filter:r.details.filter||"none",top:r.details.top??0,left:r.details.left??0},children:w.jsx(Vo,{style:{pointerEvents:"none"},children:w.jsx(Wb,{style:{pointerEvents:"none"},"data-id":r.id,src:r.details.src})})},r.id)},video:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Cc(r.display,t),i=r.trim,a=r.details.crop||{x:0,y:0,width:r.details.width,height:r.details.height};return i?w.jsx(fn,{premountFor:30*5,from:n,durationInFrames:s,style:{width:a.width||"100%",height:a.height||"auto",transform:r.details.transform??"none",opacity:(r.details.opacity??100)/100||1,border:r.details.border??"none",borderRadius:r.details.borderRadius??"0",boxShadow:r.details.boxShadow??"none",top:r.details.top??0,left:r.details.left??0,overflow:"hidden"},children:w.jsx(Vo,{style:{pointerEvents:"none",width:r.details.width,height:r.details.height,top:-a.y,left:-a.x},children:w.jsx(Xb,{startFrom:i.from/1e3*t,endAt:i.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100,style:{pointerEvents:"none",width:r.details.width,height:r.details.height}})})},r.id):w.jsx(w.Fragment,{})},audio:(r,e)=>{const{fps:t}=e,{from:n,durationInFrames:s}=Cc(r.display,t),i=r.trim;return i?w.jsx(fn,{className:`moonshine-scene-item id-${r.id} moonshine-scene-item-type-${r.type}`,from:n,durationInFrames:s,style:{userSelect:"none",pointerEvents:"none"},children:w.jsx(Vo,{children:w.jsx(zo,{startFrom:i.from/1e3*t,endAt:i.to/1e3*t,src:r.details.src,volume:(r.details.volume??100)/100})})},r.id):w.jsx(w.Fragment,{})}};var ll={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */ll.exports;(function(r,e){(function(){var t,n="4.17.21",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",c="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",p=1,g=2,y=4,b=1,_=2,S=1,T=2,k=4,I=8,A=16,D=32,F=64,z=128,L=256,Y=512,W=30,q="...",U=800,X=16,te=1,de=2,J=3,le=1/0,ie=9007199254740991,se=17976931348623157e292,he=NaN,re=4294967295,De=re-1,$e=re>>>1,je=[["ary",z],["bind",S],["bindKey",T],["curry",I],["curryRight",A],["flip",Y],["partial",D],["partialRight",F],["rearg",L]],we="[object Arguments]",Se="[object Array]",ot="[object AsyncFunction]",tr="[object Boolean]",Rt="[object Date]",Ct="[object DOMException]",rr="[object Error]",pe="[object Function]",dr="[object GeneratorFunction]",Qe="[object Map]",Pt="[object Number]",Un="[object Null]",Ze="[object Object]",Tt="[object Promise]",wn="[object Proxy]",fr="[object RegExp]",M="[object Set]",ce="[object String]",ae="[object Symbol]",Ae="[object Undefined]",Ge="[object WeakMap]",We="[object WeakSet]",ye="[object ArrayBuffer]",et="[object DataView]",nr="[object Float32Array]",mt="[object Float64Array]",pr="[object Int8Array]",Hr="[object Int16Array]",sr="[object Int32Array]",on="[object Uint8Array]",$t="[object Uint8ClampedArray]",uo="[object Uint16Array]",ho="[object Uint32Array]",ui=/\b__p \+= '';/g,hi=/\b(__p \+=) '' \+/g,vu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Aa=/&(?:amp|lt|gt|quot|#39);/g,xs=/[&<>"']/g,Oa=RegExp(Aa.source),Wp=RegExp(xs.source),Hp=/<%-([\s\S]+?)%>/g,Up=/<%([\s\S]+?)%>/g,yu=/<%=([\s\S]+?)%>/g,bu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ma=/^\w*$/,Be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Le=/[\\^$.*+?()[\]{}|]/g,gr=RegExp(Le.source),an=/^\s+/,$p=/\s/,iS=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,oS=/\{\n\/\* \[wrapped with (.+)\] \*/,aS=/,? & /,cS=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,lS=/[()=,{}\[\]\/\s]/,uS=/\\(\\)?/g,hS=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Yp=/\w*$/,dS=/^[-+]0x[0-9a-f]+$/i,fS=/^0b[01]+$/i,pS=/^\[object .+?Constructor\]$/,gS=/^0o[0-7]+$/i,mS=/^(?:0|[1-9]\d*)$/,vS=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Pa=/($^)/,yS=/['\n\r\u2028\u2029\\]/g,Da="\\ud800-\\udfff",bS="\\u0300-\\u036f",wS="\\ufe20-\\ufe2f",xS="\\u20d0-\\u20ff",Xp=bS+wS+xS,Gp="\\u2700-\\u27bf",qp="a-z\\xdf-\\xf6\\xf8-\\xff",_S="\\xac\\xb1\\xd7\\xf7",SS="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",CS="\\u2000-\\u206f",TS=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Kp="A-Z\\xc0-\\xd6\\xd8-\\xde",Zp="\\ufe0e\\ufe0f",Jp=_S+SS+CS+TS,wu="[']",ES="["+Da+"]",Qp="["+Jp+"]",Ra="["+Xp+"]",eg="\\d+",kS="["+Gp+"]",tg="["+qp+"]",rg="[^"+Da+Jp+eg+Gp+qp+Kp+"]",xu="\\ud83c[\\udffb-\\udfff]",IS="(?:"+Ra+"|"+xu+")",ng="[^"+Da+"]",_u="(?:\\ud83c[\\udde6-\\uddff]){2}",Su="[\\ud800-\\udbff][\\udc00-\\udfff]",di="["+Kp+"]",sg="\\u200d",ig="(?:"+tg+"|"+rg+")",AS="(?:"+di+"|"+rg+")",og="(?:"+wu+"(?:d|ll|m|re|s|t|ve))?",ag="(?:"+wu+"(?:D|LL|M|RE|S|T|VE))?",cg=IS+"?",lg="["+Zp+"]?",OS="(?:"+sg+"(?:"+[ng,_u,Su].join("|")+")"+lg+cg+")*",MS="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",PS="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ug=lg+cg+OS,DS="(?:"+[kS,_u,Su].join("|")+")"+ug,RS="(?:"+[ng+Ra+"?",Ra,_u,Su,ES].join("|")+")",jS=RegExp(wu,"g"),FS=RegExp(Ra,"g"),Cu=RegExp(xu+"(?="+xu+")|"+RS+ug,"g"),LS=RegExp([di+"?"+tg+"+"+og+"(?="+[Qp,di,"$"].join("|")+")",AS+"+"+ag+"(?="+[Qp,di+ig,"$"].join("|")+")",di+"?"+ig+"+"+og,di+"+"+ag,PS,MS,eg,DS].join("|"),"g"),NS=RegExp("["+sg+Da+Xp+Zp+"]"),BS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,VS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zS=-1,tt={};tt[nr]=tt[mt]=tt[pr]=tt[Hr]=tt[sr]=tt[on]=tt[$t]=tt[uo]=tt[ho]=!0,tt[we]=tt[Se]=tt[ye]=tt[tr]=tt[et]=tt[Rt]=tt[rr]=tt[pe]=tt[Qe]=tt[Pt]=tt[Ze]=tt[fr]=tt[M]=tt[ce]=tt[Ge]=!1;var Je={};Je[we]=Je[Se]=Je[ye]=Je[et]=Je[tr]=Je[Rt]=Je[nr]=Je[mt]=Je[pr]=Je[Hr]=Je[sr]=Je[Qe]=Je[Pt]=Je[Ze]=Je[fr]=Je[M]=Je[ce]=Je[ae]=Je[on]=Je[$t]=Je[uo]=Je[ho]=!0,Je[rr]=Je[pe]=Je[Ge]=!1;var WS={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},HS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},US={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},$S={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},YS=parseFloat,XS=parseInt,hg=typeof Io=="object"&&Io&&Io.Object===Object&&Io,GS=typeof self=="object"&&self&&self.Object===Object&&self,jt=hg||GS||Function("return this")(),Tu=e&&!e.nodeType&&e,_s=Tu&&!0&&r&&!r.nodeType&&r,dg=_s&&_s.exports===Tu,Eu=dg&&hg.process,Ir=function(){try{var N=_s&&_s.require&&_s.require("util").types;return N||Eu&&Eu.binding&&Eu.binding("util")}catch{}}(),fg=Ir&&Ir.isArrayBuffer,pg=Ir&&Ir.isDate,gg=Ir&&Ir.isMap,mg=Ir&&Ir.isRegExp,vg=Ir&&Ir.isSet,yg=Ir&&Ir.isTypedArray;function mr(N,G,$){switch($.length){case 0:return N.call(G);case 1:return N.call(G,$[0]);case 2:return N.call(G,$[0],$[1]);case 3:return N.call(G,$[0],$[1],$[2])}return N.apply(G,$)}function qS(N,G,$,ue){for(var xe=-1,Ve=N==null?0:N.length;++xe<Ve;){var Et=N[xe];G(ue,Et,$(Et),N)}return ue}function Ar(N,G){for(var $=-1,ue=N==null?0:N.length;++$<ue&&G(N[$],$,N)!==!1;);return N}function KS(N,G){for(var $=N==null?0:N.length;$--&&G(N[$],$,N)!==!1;);return N}function bg(N,G){for(var $=-1,ue=N==null?0:N.length;++$<ue;)if(!G(N[$],$,N))return!1;return!0}function $n(N,G){for(var $=-1,ue=N==null?0:N.length,xe=0,Ve=[];++$<ue;){var Et=N[$];G(Et,$,N)&&(Ve[xe++]=Et)}return Ve}function ja(N,G){var $=N==null?0:N.length;return!!$&&fi(N,G,0)>-1}function ku(N,G,$){for(var ue=-1,xe=N==null?0:N.length;++ue<xe;)if($(G,N[ue]))return!0;return!1}function nt(N,G){for(var $=-1,ue=N==null?0:N.length,xe=Array(ue);++$<ue;)xe[$]=G(N[$],$,N);return xe}function Yn(N,G){for(var $=-1,ue=G.length,xe=N.length;++$<ue;)N[xe+$]=G[$];return N}function Iu(N,G,$,ue){var xe=-1,Ve=N==null?0:N.length;for(ue&&Ve&&($=N[++xe]);++xe<Ve;)$=G($,N[xe],xe,N);return $}function ZS(N,G,$,ue){var xe=N==null?0:N.length;for(ue&&xe&&($=N[--xe]);xe--;)$=G($,N[xe],xe,N);return $}function Au(N,G){for(var $=-1,ue=N==null?0:N.length;++$<ue;)if(G(N[$],$,N))return!0;return!1}var JS=Ou("length");function QS(N){return N.split("")}function eC(N){return N.match(cS)||[]}function wg(N,G,$){var ue;return $(N,function(xe,Ve,Et){if(G(xe,Ve,Et))return ue=Ve,!1}),ue}function Fa(N,G,$,ue){for(var xe=N.length,Ve=$+(ue?1:-1);ue?Ve--:++Ve<xe;)if(G(N[Ve],Ve,N))return Ve;return-1}function fi(N,G,$){return G===G?dC(N,G,$):Fa(N,xg,$)}function tC(N,G,$,ue){for(var xe=$-1,Ve=N.length;++xe<Ve;)if(ue(N[xe],G))return xe;return-1}function xg(N){return N!==N}function _g(N,G){var $=N==null?0:N.length;return $?Pu(N,G)/$:he}function Ou(N){return function(G){return G==null?t:G[N]}}function Mu(N){return function(G){return N==null?t:N[G]}}function Sg(N,G,$,ue,xe){return xe(N,function(Ve,Et,qe){$=ue?(ue=!1,Ve):G($,Ve,Et,qe)}),$}function rC(N,G){var $=N.length;for(N.sort(G);$--;)N[$]=N[$].value;return N}function Pu(N,G){for(var $,ue=-1,xe=N.length;++ue<xe;){var Ve=G(N[ue]);Ve!==t&&($=$===t?Ve:$+Ve)}return $}function Du(N,G){for(var $=-1,ue=Array(N);++$<N;)ue[$]=G($);return ue}function nC(N,G){return nt(G,function($){return[$,N[$]]})}function Cg(N){return N&&N.slice(0,Ig(N)+1).replace(an,"")}function vr(N){return function(G){return N(G)}}function Ru(N,G){return nt(G,function($){return N[$]})}function fo(N,G){return N.has(G)}function Tg(N,G){for(var $=-1,ue=N.length;++$<ue&&fi(G,N[$],0)>-1;);return $}function Eg(N,G){for(var $=N.length;$--&&fi(G,N[$],0)>-1;);return $}function sC(N,G){for(var $=N.length,ue=0;$--;)N[$]===G&&++ue;return ue}var iC=Mu(WS),oC=Mu(HS);function aC(N){return"\\"+$S[N]}function cC(N,G){return N==null?t:N[G]}function pi(N){return NS.test(N)}function lC(N){return BS.test(N)}function uC(N){for(var G,$=[];!(G=N.next()).done;)$.push(G.value);return $}function ju(N){var G=-1,$=Array(N.size);return N.forEach(function(ue,xe){$[++G]=[xe,ue]}),$}function kg(N,G){return function($){return N(G($))}}function Xn(N,G){for(var $=-1,ue=N.length,xe=0,Ve=[];++$<ue;){var Et=N[$];(Et===G||Et===d)&&(N[$]=d,Ve[xe++]=$)}return Ve}function La(N){var G=-1,$=Array(N.size);return N.forEach(function(ue){$[++G]=ue}),$}function hC(N){var G=-1,$=Array(N.size);return N.forEach(function(ue){$[++G]=[ue,ue]}),$}function dC(N,G,$){for(var ue=$-1,xe=N.length;++ue<xe;)if(N[ue]===G)return ue;return-1}function fC(N,G,$){for(var ue=$+1;ue--;)if(N[ue]===G)return ue;return ue}function gi(N){return pi(N)?gC(N):JS(N)}function Ur(N){return pi(N)?mC(N):QS(N)}function Ig(N){for(var G=N.length;G--&&$p.test(N.charAt(G)););return G}var pC=Mu(US);function gC(N){for(var G=Cu.lastIndex=0;Cu.test(N);)++G;return G}function mC(N){return N.match(Cu)||[]}function vC(N){return N.match(LS)||[]}var yC=function N(G){G=G==null?jt:mi.defaults(jt.Object(),G,mi.pick(jt,VS));var $=G.Array,ue=G.Date,xe=G.Error,Ve=G.Function,Et=G.Math,qe=G.Object,Fu=G.RegExp,bC=G.String,Or=G.TypeError,Na=$.prototype,wC=Ve.prototype,vi=qe.prototype,Ba=G["__core-js_shared__"],Va=wC.toString,Ye=vi.hasOwnProperty,xC=0,Ag=function(){var o=/[^.]+$/.exec(Ba&&Ba.keys&&Ba.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),za=vi.toString,_C=Va.call(qe),SC=jt._,CC=Fu("^"+Va.call(Ye).replace(Le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wa=dg?G.Buffer:t,Gn=G.Symbol,Ha=G.Uint8Array,Og=Wa?Wa.allocUnsafe:t,Ua=kg(qe.getPrototypeOf,qe),Mg=qe.create,Pg=vi.propertyIsEnumerable,$a=Na.splice,Dg=Gn?Gn.isConcatSpreadable:t,po=Gn?Gn.iterator:t,Ss=Gn?Gn.toStringTag:t,Ya=function(){try{var o=Is(qe,"defineProperty");return o({},"",{}),o}catch{}}(),TC=G.clearTimeout!==jt.clearTimeout&&G.clearTimeout,EC=ue&&ue.now!==jt.Date.now&&ue.now,kC=G.setTimeout!==jt.setTimeout&&G.setTimeout,Xa=Et.ceil,Ga=Et.floor,Lu=qe.getOwnPropertySymbols,IC=Wa?Wa.isBuffer:t,Rg=G.isFinite,AC=Na.join,OC=kg(qe.keys,qe),kt=Et.max,Bt=Et.min,MC=ue.now,PC=G.parseInt,jg=Et.random,DC=Na.reverse,Nu=Is(G,"DataView"),go=Is(G,"Map"),Bu=Is(G,"Promise"),yi=Is(G,"Set"),mo=Is(G,"WeakMap"),vo=Is(qe,"create"),qa=mo&&new mo,bi={},RC=As(Nu),jC=As(go),FC=As(Bu),LC=As(yi),NC=As(mo),Ka=Gn?Gn.prototype:t,yo=Ka?Ka.valueOf:t,Fg=Ka?Ka.toString:t;function C(o){if(ut(o)&&!_e(o)&&!(o instanceof Pe)){if(o instanceof Mr)return o;if(Ye.call(o,"__wrapped__"))return Lm(o)}return new Mr(o)}var wi=function(){function o(){}return function(l){if(!at(l))return{};if(Mg)return Mg(l);o.prototype=l;var f=new o;return o.prototype=t,f}}();function Za(){}function Mr(o,l){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=t}C.templateSettings={escape:Hp,evaluate:Up,interpolate:yu,variable:"",imports:{_:C}},C.prototype=Za.prototype,C.prototype.constructor=C,Mr.prototype=wi(Za.prototype),Mr.prototype.constructor=Mr;function Pe(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function BC(){var o=new Pe(this.__wrapped__);return o.__actions__=ir(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=ir(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=ir(this.__views__),o}function VC(){if(this.__filtered__){var o=new Pe(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function zC(){var o=this.__wrapped__.value(),l=this.__dir__,f=_e(o),m=l<0,x=f?o.length:0,E=QT(0,x,this.__views__),O=E.start,P=E.end,B=P-O,K=m?P:O-1,Z=this.__iteratees__,Q=Z.length,oe=0,fe=Bt(B,this.__takeCount__);if(!f||!m&&x==B&&fe==B)return om(o,this.__actions__);var me=[];e:for(;B--&&oe<fe;){K+=l;for(var ke=-1,ve=o[K];++ke<Q;){var Oe=Z[ke],Re=Oe.iteratee,wr=Oe.type,Gt=Re(ve);if(wr==de)ve=Gt;else if(!Gt){if(wr==te)continue e;break e}}me[oe++]=ve}return me}Pe.prototype=wi(Za.prototype),Pe.prototype.constructor=Pe;function Cs(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function WC(){this.__data__=vo?vo(null):{},this.size=0}function HC(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}function UC(o){var l=this.__data__;if(vo){var f=l[o];return f===u?t:f}return Ye.call(l,o)?l[o]:t}function $C(o){var l=this.__data__;return vo?l[o]!==t:Ye.call(l,o)}function YC(o,l){var f=this.__data__;return this.size+=this.has(o)?0:1,f[o]=vo&&l===t?u:l,this}Cs.prototype.clear=WC,Cs.prototype.delete=HC,Cs.prototype.get=UC,Cs.prototype.has=$C,Cs.prototype.set=YC;function xn(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function XC(){this.__data__=[],this.size=0}function GC(o){var l=this.__data__,f=Ja(l,o);if(f<0)return!1;var m=l.length-1;return f==m?l.pop():$a.call(l,f,1),--this.size,!0}function qC(o){var l=this.__data__,f=Ja(l,o);return f<0?t:l[f][1]}function KC(o){return Ja(this.__data__,o)>-1}function ZC(o,l){var f=this.__data__,m=Ja(f,o);return m<0?(++this.size,f.push([o,l])):f[m][1]=l,this}xn.prototype.clear=XC,xn.prototype.delete=GC,xn.prototype.get=qC,xn.prototype.has=KC,xn.prototype.set=ZC;function _n(o){var l=-1,f=o==null?0:o.length;for(this.clear();++l<f;){var m=o[l];this.set(m[0],m[1])}}function JC(){this.size=0,this.__data__={hash:new Cs,map:new(go||xn),string:new Cs}}function QC(o){var l=uc(this,o).delete(o);return this.size-=l?1:0,l}function eT(o){return uc(this,o).get(o)}function tT(o){return uc(this,o).has(o)}function rT(o,l){var f=uc(this,o),m=f.size;return f.set(o,l),this.size+=f.size==m?0:1,this}_n.prototype.clear=JC,_n.prototype.delete=QC,_n.prototype.get=eT,_n.prototype.has=tT,_n.prototype.set=rT;function Ts(o){var l=-1,f=o==null?0:o.length;for(this.__data__=new _n;++l<f;)this.add(o[l])}function nT(o){return this.__data__.set(o,u),this}function sT(o){return this.__data__.has(o)}Ts.prototype.add=Ts.prototype.push=nT,Ts.prototype.has=sT;function $r(o){var l=this.__data__=new xn(o);this.size=l.size}function iT(){this.__data__=new xn,this.size=0}function oT(o){var l=this.__data__,f=l.delete(o);return this.size=l.size,f}function aT(o){return this.__data__.get(o)}function cT(o){return this.__data__.has(o)}function lT(o,l){var f=this.__data__;if(f instanceof xn){var m=f.__data__;if(!go||m.length<s-1)return m.push([o,l]),this.size=++f.size,this;f=this.__data__=new _n(m)}return f.set(o,l),this.size=f.size,this}$r.prototype.clear=iT,$r.prototype.delete=oT,$r.prototype.get=aT,$r.prototype.has=cT,$r.prototype.set=lT;function Lg(o,l){var f=_e(o),m=!f&&Os(o),x=!f&&!m&&Qn(o),E=!f&&!m&&!x&&Ci(o),O=f||m||x||E,P=O?Du(o.length,bC):[],B=P.length;for(var K in o)(l||Ye.call(o,K))&&!(O&&(K=="length"||x&&(K=="offset"||K=="parent")||E&&(K=="buffer"||K=="byteLength"||K=="byteOffset")||En(K,B)))&&P.push(K);return P}function Ng(o){var l=o.length;return l?o[Ku(0,l-1)]:t}function uT(o,l){return hc(ir(o),Es(l,0,o.length))}function hT(o){return hc(ir(o))}function Vu(o,l,f){(f!==t&&!Yr(o[l],f)||f===t&&!(l in o))&&Sn(o,l,f)}function bo(o,l,f){var m=o[l];(!(Ye.call(o,l)&&Yr(m,f))||f===t&&!(l in o))&&Sn(o,l,f)}function Ja(o,l){for(var f=o.length;f--;)if(Yr(o[f][0],l))return f;return-1}function dT(o,l,f,m){return qn(o,function(x,E,O){l(m,x,f(x),O)}),m}function Bg(o,l){return o&&ln(l,Dt(l),o)}function fT(o,l){return o&&ln(l,ar(l),o)}function Sn(o,l,f){l=="__proto__"&&Ya?Ya(o,l,{configurable:!0,enumerable:!0,value:f,writable:!0}):o[l]=f}function zu(o,l){for(var f=-1,m=l.length,x=$(m),E=o==null;++f<m;)x[f]=E?t:xh(o,l[f]);return x}function Es(o,l,f){return o===o&&(f!==t&&(o=o<=f?o:f),l!==t&&(o=o>=l?o:l)),o}function Pr(o,l,f,m,x,E){var O,P=l&p,B=l&g,K=l&y;if(f&&(O=x?f(o,m,x,E):f(o)),O!==t)return O;if(!at(o))return o;var Z=_e(o);if(Z){if(O=t2(o),!P)return ir(o,O)}else{var Q=Vt(o),oe=Q==pe||Q==dr;if(Qn(o))return lm(o,P);if(Q==Ze||Q==we||oe&&!x){if(O=B||oe?{}:Im(o),!P)return B?UT(o,fT(O,o)):HT(o,Bg(O,o))}else{if(!Je[Q])return x?o:{};O=r2(o,Q,P)}}E||(E=new $r);var fe=E.get(o);if(fe)return fe;E.set(o,O),nv(o)?o.forEach(function(ve){O.add(Pr(ve,l,f,ve,o,E))}):tv(o)&&o.forEach(function(ve,Oe){O.set(Oe,Pr(ve,l,f,Oe,o,E))});var me=K?B?ah:oh:B?ar:Dt,ke=Z?t:me(o);return Ar(ke||o,function(ve,Oe){ke&&(Oe=ve,ve=o[Oe]),bo(O,Oe,Pr(ve,l,f,Oe,o,E))}),O}function pT(o){var l=Dt(o);return function(f){return Vg(f,o,l)}}function Vg(o,l,f){var m=f.length;if(o==null)return!m;for(o=qe(o);m--;){var x=f[m],E=l[x],O=o[x];if(O===t&&!(x in o)||!E(O))return!1}return!0}function zg(o,l,f){if(typeof o!="function")throw new Or(a);return Eo(function(){o.apply(t,f)},l)}function wo(o,l,f,m){var x=-1,E=ja,O=!0,P=o.length,B=[],K=l.length;if(!P)return B;f&&(l=nt(l,vr(f))),m?(E=ku,O=!1):l.length>=s&&(E=fo,O=!1,l=new Ts(l));e:for(;++x<P;){var Z=o[x],Q=f==null?Z:f(Z);if(Z=m||Z!==0?Z:0,O&&Q===Q){for(var oe=K;oe--;)if(l[oe]===Q)continue e;B.push(Z)}else E(l,Q,m)||B.push(Z)}return B}var qn=pm(cn),Wg=pm(Hu,!0);function gT(o,l){var f=!0;return qn(o,function(m,x,E){return f=!!l(m,x,E),f}),f}function Qa(o,l,f){for(var m=-1,x=o.length;++m<x;){var E=o[m],O=l(E);if(O!=null&&(P===t?O===O&&!br(O):f(O,P)))var P=O,B=E}return B}function mT(o,l,f,m){var x=o.length;for(f=Ce(f),f<0&&(f=-f>x?0:x+f),m=m===t||m>x?x:Ce(m),m<0&&(m+=x),m=f>m?0:iv(m);f<m;)o[f++]=l;return o}function Hg(o,l){var f=[];return qn(o,function(m,x,E){l(m,x,E)&&f.push(m)}),f}function Ft(o,l,f,m,x){var E=-1,O=o.length;for(f||(f=s2),x||(x=[]);++E<O;){var P=o[E];l>0&&f(P)?l>1?Ft(P,l-1,f,m,x):Yn(x,P):m||(x[x.length]=P)}return x}var Wu=gm(),Ug=gm(!0);function cn(o,l){return o&&Wu(o,l,Dt)}function Hu(o,l){return o&&Ug(o,l,Dt)}function ec(o,l){return $n(l,function(f){return kn(o[f])})}function ks(o,l){l=Zn(l,o);for(var f=0,m=l.length;o!=null&&f<m;)o=o[un(l[f++])];return f&&f==m?o:t}function $g(o,l,f){var m=l(o);return _e(o)?m:Yn(m,f(o))}function Yt(o){return o==null?o===t?Ae:Un:Ss&&Ss in qe(o)?JT(o):h2(o)}function Uu(o,l){return o>l}function vT(o,l){return o!=null&&Ye.call(o,l)}function yT(o,l){return o!=null&&l in qe(o)}function bT(o,l,f){return o>=Bt(l,f)&&o<kt(l,f)}function $u(o,l,f){for(var m=f?ku:ja,x=o[0].length,E=o.length,O=E,P=$(E),B=1/0,K=[];O--;){var Z=o[O];O&&l&&(Z=nt(Z,vr(l))),B=Bt(Z.length,B),P[O]=!f&&(l||x>=120&&Z.length>=120)?new Ts(O&&Z):t}Z=o[0];var Q=-1,oe=P[0];e:for(;++Q<x&&K.length<B;){var fe=Z[Q],me=l?l(fe):fe;if(fe=f||fe!==0?fe:0,!(oe?fo(oe,me):m(K,me,f))){for(O=E;--O;){var ke=P[O];if(!(ke?fo(ke,me):m(o[O],me,f)))continue e}oe&&oe.push(me),K.push(fe)}}return K}function wT(o,l,f,m){return cn(o,function(x,E,O){l(m,f(x),E,O)}),m}function xo(o,l,f){l=Zn(l,o),o=Pm(o,l);var m=o==null?o:o[un(Rr(l))];return m==null?t:mr(m,o,f)}function Yg(o){return ut(o)&&Yt(o)==we}function xT(o){return ut(o)&&Yt(o)==ye}function _T(o){return ut(o)&&Yt(o)==Rt}function _o(o,l,f,m,x){return o===l?!0:o==null||l==null||!ut(o)&&!ut(l)?o!==o&&l!==l:ST(o,l,f,m,_o,x)}function ST(o,l,f,m,x,E){var O=_e(o),P=_e(l),B=O?Se:Vt(o),K=P?Se:Vt(l);B=B==we?Ze:B,K=K==we?Ze:K;var Z=B==Ze,Q=K==Ze,oe=B==K;if(oe&&Qn(o)){if(!Qn(l))return!1;O=!0,Z=!1}if(oe&&!Z)return E||(E=new $r),O||Ci(o)?Tm(o,l,f,m,x,E):KT(o,l,B,f,m,x,E);if(!(f&b)){var fe=Z&&Ye.call(o,"__wrapped__"),me=Q&&Ye.call(l,"__wrapped__");if(fe||me){var ke=fe?o.value():o,ve=me?l.value():l;return E||(E=new $r),x(ke,ve,f,m,E)}}return oe?(E||(E=new $r),ZT(o,l,f,m,x,E)):!1}function CT(o){return ut(o)&&Vt(o)==Qe}function Yu(o,l,f,m){var x=f.length,E=x,O=!m;if(o==null)return!E;for(o=qe(o);x--;){var P=f[x];if(O&&P[2]?P[1]!==o[P[0]]:!(P[0]in o))return!1}for(;++x<E;){P=f[x];var B=P[0],K=o[B],Z=P[1];if(O&&P[2]){if(K===t&&!(B in o))return!1}else{var Q=new $r;if(m)var oe=m(K,Z,B,o,l,Q);if(!(oe===t?_o(Z,K,b|_,m,Q):oe))return!1}}return!0}function Xg(o){if(!at(o)||o2(o))return!1;var l=kn(o)?CC:pS;return l.test(As(o))}function TT(o){return ut(o)&&Yt(o)==fr}function ET(o){return ut(o)&&Vt(o)==M}function kT(o){return ut(o)&&vc(o.length)&&!!tt[Yt(o)]}function Gg(o){return typeof o=="function"?o:o==null?cr:typeof o=="object"?_e(o)?Zg(o[0],o[1]):Kg(o):mv(o)}function Xu(o){if(!To(o))return OC(o);var l=[];for(var f in qe(o))Ye.call(o,f)&&f!="constructor"&&l.push(f);return l}function IT(o){if(!at(o))return u2(o);var l=To(o),f=[];for(var m in o)m=="constructor"&&(l||!Ye.call(o,m))||f.push(m);return f}function Gu(o,l){return o<l}function qg(o,l){var f=-1,m=or(o)?$(o.length):[];return qn(o,function(x,E,O){m[++f]=l(x,E,O)}),m}function Kg(o){var l=lh(o);return l.length==1&&l[0][2]?Om(l[0][0],l[0][1]):function(f){return f===o||Yu(f,o,l)}}function Zg(o,l){return hh(o)&&Am(l)?Om(un(o),l):function(f){var m=xh(f,o);return m===t&&m===l?_h(f,o):_o(l,m,b|_)}}function tc(o,l,f,m,x){o!==l&&Wu(l,function(E,O){if(x||(x=new $r),at(E))AT(o,l,O,f,tc,m,x);else{var P=m?m(fh(o,O),E,O+"",o,l,x):t;P===t&&(P=E),Vu(o,O,P)}},ar)}function AT(o,l,f,m,x,E,O){var P=fh(o,f),B=fh(l,f),K=O.get(B);if(K){Vu(o,f,K);return}var Z=E?E(P,B,f+"",o,l,O):t,Q=Z===t;if(Q){var oe=_e(B),fe=!oe&&Qn(B),me=!oe&&!fe&&Ci(B);Z=B,oe||fe||me?_e(P)?Z=P:vt(P)?Z=ir(P):fe?(Q=!1,Z=lm(B,!0)):me?(Q=!1,Z=um(B,!0)):Z=[]:ko(B)||Os(B)?(Z=P,Os(P)?Z=ov(P):(!at(P)||kn(P))&&(Z=Im(B))):Q=!1}Q&&(O.set(B,Z),x(Z,B,m,E,O),O.delete(B)),Vu(o,f,Z)}function Jg(o,l){var f=o.length;if(f)return l+=l<0?f:0,En(l,f)?o[l]:t}function Qg(o,l,f){l.length?l=nt(l,function(E){return _e(E)?function(O){return ks(O,E.length===1?E[0]:E)}:E}):l=[cr];var m=-1;l=nt(l,vr(ge()));var x=qg(o,function(E,O,P){var B=nt(l,function(K){return K(E)});return{criteria:B,index:++m,value:E}});return rC(x,function(E,O){return WT(E,O,f)})}function OT(o,l){return em(o,l,function(f,m){return _h(o,m)})}function em(o,l,f){for(var m=-1,x=l.length,E={};++m<x;){var O=l[m],P=ks(o,O);f(P,O)&&So(E,Zn(O,o),P)}return E}function MT(o){return function(l){return ks(l,o)}}function qu(o,l,f,m){var x=m?tC:fi,E=-1,O=l.length,P=o;for(o===l&&(l=ir(l)),f&&(P=nt(o,vr(f)));++E<O;)for(var B=0,K=l[E],Z=f?f(K):K;(B=x(P,Z,B,m))>-1;)P!==o&&$a.call(P,B,1),$a.call(o,B,1);return o}function tm(o,l){for(var f=o?l.length:0,m=f-1;f--;){var x=l[f];if(f==m||x!==E){var E=x;En(x)?$a.call(o,x,1):Qu(o,x)}}return o}function Ku(o,l){return o+Ga(jg()*(l-o+1))}function PT(o,l,f,m){for(var x=-1,E=kt(Xa((l-o)/(f||1)),0),O=$(E);E--;)O[m?E:++x]=o,o+=f;return O}function Zu(o,l){var f="";if(!o||l<1||l>ie)return f;do l%2&&(f+=o),l=Ga(l/2),l&&(o+=o);while(l);return f}function Ie(o,l){return ph(Mm(o,l,cr),o+"")}function DT(o){return Ng(Ti(o))}function RT(o,l){var f=Ti(o);return hc(f,Es(l,0,f.length))}function So(o,l,f,m){if(!at(o))return o;l=Zn(l,o);for(var x=-1,E=l.length,O=E-1,P=o;P!=null&&++x<E;){var B=un(l[x]),K=f;if(B==="__proto__"||B==="constructor"||B==="prototype")return o;if(x!=O){var Z=P[B];K=m?m(Z,B,P):t,K===t&&(K=at(Z)?Z:En(l[x+1])?[]:{})}bo(P,B,K),P=P[B]}return o}var rm=qa?function(o,l){return qa.set(o,l),o}:cr,jT=Ya?function(o,l){return Ya(o,"toString",{configurable:!0,enumerable:!1,value:Ch(l),writable:!0})}:cr;function FT(o){return hc(Ti(o))}function Dr(o,l,f){var m=-1,x=o.length;l<0&&(l=-l>x?0:x+l),f=f>x?x:f,f<0&&(f+=x),x=l>f?0:f-l>>>0,l>>>=0;for(var E=$(x);++m<x;)E[m]=o[m+l];return E}function LT(o,l){var f;return qn(o,function(m,x,E){return f=l(m,x,E),!f}),!!f}function rc(o,l,f){var m=0,x=o==null?m:o.length;if(typeof l=="number"&&l===l&&x<=$e){for(;m<x;){var E=m+x>>>1,O=o[E];O!==null&&!br(O)&&(f?O<=l:O<l)?m=E+1:x=E}return x}return Ju(o,l,cr,f)}function Ju(o,l,f,m){var x=0,E=o==null?0:o.length;if(E===0)return 0;l=f(l);for(var O=l!==l,P=l===null,B=br(l),K=l===t;x<E;){var Z=Ga((x+E)/2),Q=f(o[Z]),oe=Q!==t,fe=Q===null,me=Q===Q,ke=br(Q);if(O)var ve=m||me;else K?ve=me&&(m||oe):P?ve=me&&oe&&(m||!fe):B?ve=me&&oe&&!fe&&(m||!ke):fe||ke?ve=!1:ve=m?Q<=l:Q<l;ve?x=Z+1:E=Z}return Bt(E,De)}function nm(o,l){for(var f=-1,m=o.length,x=0,E=[];++f<m;){var O=o[f],P=l?l(O):O;if(!f||!Yr(P,B)){var B=P;E[x++]=O===0?0:O}}return E}function sm(o){return typeof o=="number"?o:br(o)?he:+o}function yr(o){if(typeof o=="string")return o;if(_e(o))return nt(o,yr)+"";if(br(o))return Fg?Fg.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function Kn(o,l,f){var m=-1,x=ja,E=o.length,O=!0,P=[],B=P;if(f)O=!1,x=ku;else if(E>=s){var K=l?null:GT(o);if(K)return La(K);O=!1,x=fo,B=new Ts}else B=l?[]:P;e:for(;++m<E;){var Z=o[m],Q=l?l(Z):Z;if(Z=f||Z!==0?Z:0,O&&Q===Q){for(var oe=B.length;oe--;)if(B[oe]===Q)continue e;l&&B.push(Q),P.push(Z)}else x(B,Q,f)||(B!==P&&B.push(Q),P.push(Z))}return P}function Qu(o,l){return l=Zn(l,o),o=Pm(o,l),o==null||delete o[un(Rr(l))]}function im(o,l,f,m){return So(o,l,f(ks(o,l)),m)}function nc(o,l,f,m){for(var x=o.length,E=m?x:-1;(m?E--:++E<x)&&l(o[E],E,o););return f?Dr(o,m?0:E,m?E+1:x):Dr(o,m?E+1:0,m?x:E)}function om(o,l){var f=o;return f instanceof Pe&&(f=f.value()),Iu(l,function(m,x){return x.func.apply(x.thisArg,Yn([m],x.args))},f)}function eh(o,l,f){var m=o.length;if(m<2)return m?Kn(o[0]):[];for(var x=-1,E=$(m);++x<m;)for(var O=o[x],P=-1;++P<m;)P!=x&&(E[x]=wo(E[x]||O,o[P],l,f));return Kn(Ft(E,1),l,f)}function am(o,l,f){for(var m=-1,x=o.length,E=l.length,O={};++m<x;){var P=m<E?l[m]:t;f(O,o[m],P)}return O}function th(o){return vt(o)?o:[]}function rh(o){return typeof o=="function"?o:cr}function Zn(o,l){return _e(o)?o:hh(o,l)?[o]:Fm(He(o))}var NT=Ie;function Jn(o,l,f){var m=o.length;return f=f===t?m:f,!l&&f>=m?o:Dr(o,l,f)}var cm=TC||function(o){return jt.clearTimeout(o)};function lm(o,l){if(l)return o.slice();var f=o.length,m=Og?Og(f):new o.constructor(f);return o.copy(m),m}function nh(o){var l=new o.constructor(o.byteLength);return new Ha(l).set(new Ha(o)),l}function BT(o,l){var f=l?nh(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.byteLength)}function VT(o){var l=new o.constructor(o.source,Yp.exec(o));return l.lastIndex=o.lastIndex,l}function zT(o){return yo?qe(yo.call(o)):{}}function um(o,l){var f=l?nh(o.buffer):o.buffer;return new o.constructor(f,o.byteOffset,o.length)}function hm(o,l){if(o!==l){var f=o!==t,m=o===null,x=o===o,E=br(o),O=l!==t,P=l===null,B=l===l,K=br(l);if(!P&&!K&&!E&&o>l||E&&O&&B&&!P&&!K||m&&O&&B||!f&&B||!x)return 1;if(!m&&!E&&!K&&o<l||K&&f&&x&&!m&&!E||P&&f&&x||!O&&x||!B)return-1}return 0}function WT(o,l,f){for(var m=-1,x=o.criteria,E=l.criteria,O=x.length,P=f.length;++m<O;){var B=hm(x[m],E[m]);if(B){if(m>=P)return B;var K=f[m];return B*(K=="desc"?-1:1)}}return o.index-l.index}function dm(o,l,f,m){for(var x=-1,E=o.length,O=f.length,P=-1,B=l.length,K=kt(E-O,0),Z=$(B+K),Q=!m;++P<B;)Z[P]=l[P];for(;++x<O;)(Q||x<E)&&(Z[f[x]]=o[x]);for(;K--;)Z[P++]=o[x++];return Z}function fm(o,l,f,m){for(var x=-1,E=o.length,O=-1,P=f.length,B=-1,K=l.length,Z=kt(E-P,0),Q=$(Z+K),oe=!m;++x<Z;)Q[x]=o[x];for(var fe=x;++B<K;)Q[fe+B]=l[B];for(;++O<P;)(oe||x<E)&&(Q[fe+f[O]]=o[x++]);return Q}function ir(o,l){var f=-1,m=o.length;for(l||(l=$(m));++f<m;)l[f]=o[f];return l}function ln(o,l,f,m){var x=!f;f||(f={});for(var E=-1,O=l.length;++E<O;){var P=l[E],B=m?m(f[P],o[P],P,f,o):t;B===t&&(B=o[P]),x?Sn(f,P,B):bo(f,P,B)}return f}function HT(o,l){return ln(o,uh(o),l)}function UT(o,l){return ln(o,Em(o),l)}function sc(o,l){return function(f,m){var x=_e(f)?qS:dT,E=l?l():{};return x(f,o,ge(m,2),E)}}function xi(o){return Ie(function(l,f){var m=-1,x=f.length,E=x>1?f[x-1]:t,O=x>2?f[2]:t;for(E=o.length>3&&typeof E=="function"?(x--,E):t,O&&Xt(f[0],f[1],O)&&(E=x<3?t:E,x=1),l=qe(l);++m<x;){var P=f[m];P&&o(l,P,m,E)}return l})}function pm(o,l){return function(f,m){if(f==null)return f;if(!or(f))return o(f,m);for(var x=f.length,E=l?x:-1,O=qe(f);(l?E--:++E<x)&&m(O[E],E,O)!==!1;);return f}}function gm(o){return function(l,f,m){for(var x=-1,E=qe(l),O=m(l),P=O.length;P--;){var B=O[o?P:++x];if(f(E[B],B,E)===!1)break}return l}}function $T(o,l,f){var m=l&S,x=Co(o);function E(){var O=this&&this!==jt&&this instanceof E?x:o;return O.apply(m?f:this,arguments)}return E}function mm(o){return function(l){l=He(l);var f=pi(l)?Ur(l):t,m=f?f[0]:l.charAt(0),x=f?Jn(f,1).join(""):l.slice(1);return m[o]()+x}}function _i(o){return function(l){return Iu(pv(fv(l).replace(jS,"")),o,"")}}function Co(o){return function(){var l=arguments;switch(l.length){case 0:return new o;case 1:return new o(l[0]);case 2:return new o(l[0],l[1]);case 3:return new o(l[0],l[1],l[2]);case 4:return new o(l[0],l[1],l[2],l[3]);case 5:return new o(l[0],l[1],l[2],l[3],l[4]);case 6:return new o(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new o(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var f=wi(o.prototype),m=o.apply(f,l);return at(m)?m:f}}function YT(o,l,f){var m=Co(o);function x(){for(var E=arguments.length,O=$(E),P=E,B=Si(x);P--;)O[P]=arguments[P];var K=E<3&&O[0]!==B&&O[E-1]!==B?[]:Xn(O,B);if(E-=K.length,E<f)return xm(o,l,ic,x.placeholder,t,O,K,t,t,f-E);var Z=this&&this!==jt&&this instanceof x?m:o;return mr(Z,this,O)}return x}function vm(o){return function(l,f,m){var x=qe(l);if(!or(l)){var E=ge(f,3);l=Dt(l),f=function(P){return E(x[P],P,x)}}var O=o(l,f,m);return O>-1?x[E?l[O]:O]:t}}function ym(o){return Tn(function(l){var f=l.length,m=f,x=Mr.prototype.thru;for(o&&l.reverse();m--;){var E=l[m];if(typeof E!="function")throw new Or(a);if(x&&!O&&lc(E)=="wrapper")var O=new Mr([],!0)}for(m=O?m:f;++m<f;){E=l[m];var P=lc(E),B=P=="wrapper"?ch(E):t;B&&dh(B[0])&&B[1]==(z|I|D|L)&&!B[4].length&&B[9]==1?O=O[lc(B[0])].apply(O,B[3]):O=E.length==1&&dh(E)?O[P]():O.thru(E)}return function(){var K=arguments,Z=K[0];if(O&&K.length==1&&_e(Z))return O.plant(Z).value();for(var Q=0,oe=f?l[Q].apply(this,K):Z;++Q<f;)oe=l[Q].call(this,oe);return oe}})}function ic(o,l,f,m,x,E,O,P,B,K){var Z=l&z,Q=l&S,oe=l&T,fe=l&(I|A),me=l&Y,ke=oe?t:Co(o);function ve(){for(var Oe=arguments.length,Re=$(Oe),wr=Oe;wr--;)Re[wr]=arguments[wr];if(fe)var Gt=Si(ve),xr=sC(Re,Gt);if(m&&(Re=dm(Re,m,x,fe)),E&&(Re=fm(Re,E,O,fe)),Oe-=xr,fe&&Oe<K){var yt=Xn(Re,Gt);return xm(o,l,ic,ve.placeholder,f,Re,yt,P,B,K-Oe)}var Xr=Q?f:this,An=oe?Xr[o]:o;return Oe=Re.length,P?Re=d2(Re,P):me&&Oe>1&&Re.reverse(),Z&&B<Oe&&(Re.length=B),this&&this!==jt&&this instanceof ve&&(An=ke||Co(An)),An.apply(Xr,Re)}return ve}function bm(o,l){return function(f,m){return wT(f,o,l(m),{})}}function oc(o,l){return function(f,m){var x;if(f===t&&m===t)return l;if(f!==t&&(x=f),m!==t){if(x===t)return m;typeof f=="string"||typeof m=="string"?(f=yr(f),m=yr(m)):(f=sm(f),m=sm(m)),x=o(f,m)}return x}}function sh(o){return Tn(function(l){return l=nt(l,vr(ge())),Ie(function(f){var m=this;return o(l,function(x){return mr(x,m,f)})})})}function ac(o,l){l=l===t?" ":yr(l);var f=l.length;if(f<2)return f?Zu(l,o):l;var m=Zu(l,Xa(o/gi(l)));return pi(l)?Jn(Ur(m),0,o).join(""):m.slice(0,o)}function XT(o,l,f,m){var x=l&S,E=Co(o);function O(){for(var P=-1,B=arguments.length,K=-1,Z=m.length,Q=$(Z+B),oe=this&&this!==jt&&this instanceof O?E:o;++K<Z;)Q[K]=m[K];for(;B--;)Q[K++]=arguments[++P];return mr(oe,x?f:this,Q)}return O}function wm(o){return function(l,f,m){return m&&typeof m!="number"&&Xt(l,f,m)&&(f=m=t),l=In(l),f===t?(f=l,l=0):f=In(f),m=m===t?l<f?1:-1:In(m),PT(l,f,m,o)}}function cc(o){return function(l,f){return typeof l=="string"&&typeof f=="string"||(l=jr(l),f=jr(f)),o(l,f)}}function xm(o,l,f,m,x,E,O,P,B,K){var Z=l&I,Q=Z?O:t,oe=Z?t:O,fe=Z?E:t,me=Z?t:E;l|=Z?D:F,l&=~(Z?F:D),l&k||(l&=-4);var ke=[o,l,x,fe,Q,me,oe,P,B,K],ve=f.apply(t,ke);return dh(o)&&Dm(ve,ke),ve.placeholder=m,Rm(ve,o,l)}function ih(o){var l=Et[o];return function(f,m){if(f=jr(f),m=m==null?0:Bt(Ce(m),292),m&&Rg(f)){var x=(He(f)+"e").split("e"),E=l(x[0]+"e"+(+x[1]+m));return x=(He(E)+"e").split("e"),+(x[0]+"e"+(+x[1]-m))}return l(f)}}var GT=yi&&1/La(new yi([,-0]))[1]==le?function(o){return new yi(o)}:kh;function _m(o){return function(l){var f=Vt(l);return f==Qe?ju(l):f==M?hC(l):nC(l,o(l))}}function Cn(o,l,f,m,x,E,O,P){var B=l&T;if(!B&&typeof o!="function")throw new Or(a);var K=m?m.length:0;if(K||(l&=-97,m=x=t),O=O===t?O:kt(Ce(O),0),P=P===t?P:Ce(P),K-=x?x.length:0,l&F){var Z=m,Q=x;m=x=t}var oe=B?t:ch(o),fe=[o,l,f,m,x,Z,Q,E,O,P];if(oe&&l2(fe,oe),o=fe[0],l=fe[1],f=fe[2],m=fe[3],x=fe[4],P=fe[9]=fe[9]===t?B?0:o.length:kt(fe[9]-K,0),!P&&l&(I|A)&&(l&=-25),!l||l==S)var me=$T(o,l,f);else l==I||l==A?me=YT(o,l,P):(l==D||l==(S|D))&&!x.length?me=XT(o,l,f,m):me=ic.apply(t,fe);var ke=oe?rm:Dm;return Rm(ke(me,fe),o,l)}function Sm(o,l,f,m){return o===t||Yr(o,vi[f])&&!Ye.call(m,f)?l:o}function Cm(o,l,f,m,x,E){return at(o)&&at(l)&&(E.set(l,o),tc(o,l,t,Cm,E),E.delete(l)),o}function qT(o){return ko(o)?t:o}function Tm(o,l,f,m,x,E){var O=f&b,P=o.length,B=l.length;if(P!=B&&!(O&&B>P))return!1;var K=E.get(o),Z=E.get(l);if(K&&Z)return K==l&&Z==o;var Q=-1,oe=!0,fe=f&_?new Ts:t;for(E.set(o,l),E.set(l,o);++Q<P;){var me=o[Q],ke=l[Q];if(m)var ve=O?m(ke,me,Q,l,o,E):m(me,ke,Q,o,l,E);if(ve!==t){if(ve)continue;oe=!1;break}if(fe){if(!Au(l,function(Oe,Re){if(!fo(fe,Re)&&(me===Oe||x(me,Oe,f,m,E)))return fe.push(Re)})){oe=!1;break}}else if(!(me===ke||x(me,ke,f,m,E))){oe=!1;break}}return E.delete(o),E.delete(l),oe}function KT(o,l,f,m,x,E,O){switch(f){case et:if(o.byteLength!=l.byteLength||o.byteOffset!=l.byteOffset)return!1;o=o.buffer,l=l.buffer;case ye:return!(o.byteLength!=l.byteLength||!E(new Ha(o),new Ha(l)));case tr:case Rt:case Pt:return Yr(+o,+l);case rr:return o.name==l.name&&o.message==l.message;case fr:case ce:return o==l+"";case Qe:var P=ju;case M:var B=m&b;if(P||(P=La),o.size!=l.size&&!B)return!1;var K=O.get(o);if(K)return K==l;m|=_,O.set(o,l);var Z=Tm(P(o),P(l),m,x,E,O);return O.delete(o),Z;case ae:if(yo)return yo.call(o)==yo.call(l)}return!1}function ZT(o,l,f,m,x,E){var O=f&b,P=oh(o),B=P.length,K=oh(l),Z=K.length;if(B!=Z&&!O)return!1;for(var Q=B;Q--;){var oe=P[Q];if(!(O?oe in l:Ye.call(l,oe)))return!1}var fe=E.get(o),me=E.get(l);if(fe&&me)return fe==l&&me==o;var ke=!0;E.set(o,l),E.set(l,o);for(var ve=O;++Q<B;){oe=P[Q];var Oe=o[oe],Re=l[oe];if(m)var wr=O?m(Re,Oe,oe,l,o,E):m(Oe,Re,oe,o,l,E);if(!(wr===t?Oe===Re||x(Oe,Re,f,m,E):wr)){ke=!1;break}ve||(ve=oe=="constructor")}if(ke&&!ve){var Gt=o.constructor,xr=l.constructor;Gt!=xr&&"constructor"in o&&"constructor"in l&&!(typeof Gt=="function"&&Gt instanceof Gt&&typeof xr=="function"&&xr instanceof xr)&&(ke=!1)}return E.delete(o),E.delete(l),ke}function Tn(o){return ph(Mm(o,t,Vm),o+"")}function oh(o){return $g(o,Dt,uh)}function ah(o){return $g(o,ar,Em)}var ch=qa?function(o){return qa.get(o)}:kh;function lc(o){for(var l=o.name+"",f=bi[l],m=Ye.call(bi,l)?f.length:0;m--;){var x=f[m],E=x.func;if(E==null||E==o)return x.name}return l}function Si(o){var l=Ye.call(C,"placeholder")?C:o;return l.placeholder}function ge(){var o=C.iteratee||Th;return o=o===Th?Gg:o,arguments.length?o(arguments[0],arguments[1]):o}function uc(o,l){var f=o.__data__;return i2(l)?f[typeof l=="string"?"string":"hash"]:f.map}function lh(o){for(var l=Dt(o),f=l.length;f--;){var m=l[f],x=o[m];l[f]=[m,x,Am(x)]}return l}function Is(o,l){var f=cC(o,l);return Xg(f)?f:t}function JT(o){var l=Ye.call(o,Ss),f=o[Ss];try{o[Ss]=t;var m=!0}catch{}var x=za.call(o);return m&&(l?o[Ss]=f:delete o[Ss]),x}var uh=Lu?function(o){return o==null?[]:(o=qe(o),$n(Lu(o),function(l){return Pg.call(o,l)}))}:Ih,Em=Lu?function(o){for(var l=[];o;)Yn(l,uh(o)),o=Ua(o);return l}:Ih,Vt=Yt;(Nu&&Vt(new Nu(new ArrayBuffer(1)))!=et||go&&Vt(new go)!=Qe||Bu&&Vt(Bu.resolve())!=Tt||yi&&Vt(new yi)!=M||mo&&Vt(new mo)!=Ge)&&(Vt=function(o){var l=Yt(o),f=l==Ze?o.constructor:t,m=f?As(f):"";if(m)switch(m){case RC:return et;case jC:return Qe;case FC:return Tt;case LC:return M;case NC:return Ge}return l});function QT(o,l,f){for(var m=-1,x=f.length;++m<x;){var E=f[m],O=E.size;switch(E.type){case"drop":o+=O;break;case"dropRight":l-=O;break;case"take":l=Bt(l,o+O);break;case"takeRight":o=kt(o,l-O);break}}return{start:o,end:l}}function e2(o){var l=o.match(oS);return l?l[1].split(aS):[]}function km(o,l,f){l=Zn(l,o);for(var m=-1,x=l.length,E=!1;++m<x;){var O=un(l[m]);if(!(E=o!=null&&f(o,O)))break;o=o[O]}return E||++m!=x?E:(x=o==null?0:o.length,!!x&&vc(x)&&En(O,x)&&(_e(o)||Os(o)))}function t2(o){var l=o.length,f=new o.constructor(l);return l&&typeof o[0]=="string"&&Ye.call(o,"index")&&(f.index=o.index,f.input=o.input),f}function Im(o){return typeof o.constructor=="function"&&!To(o)?wi(Ua(o)):{}}function r2(o,l,f){var m=o.constructor;switch(l){case ye:return nh(o);case tr:case Rt:return new m(+o);case et:return BT(o,f);case nr:case mt:case pr:case Hr:case sr:case on:case $t:case uo:case ho:return um(o,f);case Qe:return new m;case Pt:case ce:return new m(o);case fr:return VT(o);case M:return new m;case ae:return zT(o)}}function n2(o,l){var f=l.length;if(!f)return o;var m=f-1;return l[m]=(f>1?"& ":"")+l[m],l=l.join(f>2?", ":" "),o.replace(iS,`{
/* [wrapped with `+l+`] */
`)}function s2(o){return _e(o)||Os(o)||!!(Dg&&o&&o[Dg])}function En(o,l){var f=typeof o;return l=l??ie,!!l&&(f=="number"||f!="symbol"&&mS.test(o))&&o>-1&&o%1==0&&o<l}function Xt(o,l,f){if(!at(f))return!1;var m=typeof l;return(m=="number"?or(f)&&En(l,f.length):m=="string"&&l in f)?Yr(f[l],o):!1}function hh(o,l){if(_e(o))return!1;var f=typeof o;return f=="number"||f=="symbol"||f=="boolean"||o==null||br(o)?!0:Ma.test(o)||!bu.test(o)||l!=null&&o in qe(l)}function i2(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}function dh(o){var l=lc(o),f=C[l];if(typeof f!="function"||!(l in Pe.prototype))return!1;if(o===f)return!0;var m=ch(f);return!!m&&o===m[0]}function o2(o){return!!Ag&&Ag in o}var a2=Ba?kn:Ah;function To(o){var l=o&&o.constructor,f=typeof l=="function"&&l.prototype||vi;return o===f}function Am(o){return o===o&&!at(o)}function Om(o,l){return function(f){return f==null?!1:f[o]===l&&(l!==t||o in qe(f))}}function c2(o){var l=gc(o,function(m){return f.size===h&&f.clear(),m}),f=l.cache;return l}function l2(o,l){var f=o[1],m=l[1],x=f|m,E=x<(S|T|z),O=m==z&&f==I||m==z&&f==L&&o[7].length<=l[8]||m==(z|L)&&l[7].length<=l[8]&&f==I;if(!(E||O))return o;m&S&&(o[2]=l[2],x|=f&S?0:k);var P=l[3];if(P){var B=o[3];o[3]=B?dm(B,P,l[4]):P,o[4]=B?Xn(o[3],d):l[4]}return P=l[5],P&&(B=o[5],o[5]=B?fm(B,P,l[6]):P,o[6]=B?Xn(o[5],d):l[6]),P=l[7],P&&(o[7]=P),m&z&&(o[8]=o[8]==null?l[8]:Bt(o[8],l[8])),o[9]==null&&(o[9]=l[9]),o[0]=l[0],o[1]=x,o}function u2(o){var l=[];if(o!=null)for(var f in qe(o))l.push(f);return l}function h2(o){return za.call(o)}function Mm(o,l,f){return l=kt(l===t?o.length-1:l,0),function(){for(var m=arguments,x=-1,E=kt(m.length-l,0),O=$(E);++x<E;)O[x]=m[l+x];x=-1;for(var P=$(l+1);++x<l;)P[x]=m[x];return P[l]=f(O),mr(o,this,P)}}function Pm(o,l){return l.length<2?o:ks(o,Dr(l,0,-1))}function d2(o,l){for(var f=o.length,m=Bt(l.length,f),x=ir(o);m--;){var E=l[m];o[m]=En(E,f)?x[E]:t}return o}function fh(o,l){if(!(l==="constructor"&&typeof o[l]=="function")&&l!="__proto__")return o[l]}var Dm=jm(rm),Eo=kC||function(o,l){return jt.setTimeout(o,l)},ph=jm(jT);function Rm(o,l,f){var m=l+"";return ph(o,n2(m,f2(e2(m),f)))}function jm(o){var l=0,f=0;return function(){var m=MC(),x=X-(m-f);if(f=m,x>0){if(++l>=U)return arguments[0]}else l=0;return o.apply(t,arguments)}}function hc(o,l){var f=-1,m=o.length,x=m-1;for(l=l===t?m:l;++f<l;){var E=Ku(f,x),O=o[E];o[E]=o[f],o[f]=O}return o.length=l,o}var Fm=c2(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(Be,function(f,m,x,E){l.push(x?E.replace(uS,"$1"):m||f)}),l});function un(o){if(typeof o=="string"||br(o))return o;var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}function As(o){if(o!=null){try{return Va.call(o)}catch{}try{return o+""}catch{}}return""}function f2(o,l){return Ar(je,function(f){var m="_."+f[0];l&f[1]&&!ja(o,m)&&o.push(m)}),o.sort()}function Lm(o){if(o instanceof Pe)return o.clone();var l=new Mr(o.__wrapped__,o.__chain__);return l.__actions__=ir(o.__actions__),l.__index__=o.__index__,l.__values__=o.__values__,l}function p2(o,l,f){(f?Xt(o,l,f):l===t)?l=1:l=kt(Ce(l),0);var m=o==null?0:o.length;if(!m||l<1)return[];for(var x=0,E=0,O=$(Xa(m/l));x<m;)O[E++]=Dr(o,x,x+=l);return O}function g2(o){for(var l=-1,f=o==null?0:o.length,m=0,x=[];++l<f;){var E=o[l];E&&(x[m++]=E)}return x}function m2(){var o=arguments.length;if(!o)return[];for(var l=$(o-1),f=arguments[0],m=o;m--;)l[m-1]=arguments[m];return Yn(_e(f)?ir(f):[f],Ft(l,1))}var v2=Ie(function(o,l){return vt(o)?wo(o,Ft(l,1,vt,!0)):[]}),y2=Ie(function(o,l){var f=Rr(l);return vt(f)&&(f=t),vt(o)?wo(o,Ft(l,1,vt,!0),ge(f,2)):[]}),b2=Ie(function(o,l){var f=Rr(l);return vt(f)&&(f=t),vt(o)?wo(o,Ft(l,1,vt,!0),t,f):[]});function w2(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ce(l),Dr(o,l<0?0:l,m)):[]}function x2(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ce(l),l=m-l,Dr(o,0,l<0?0:l)):[]}function _2(o,l){return o&&o.length?nc(o,ge(l,3),!0,!0):[]}function S2(o,l){return o&&o.length?nc(o,ge(l,3),!0):[]}function C2(o,l,f,m){var x=o==null?0:o.length;return x?(f&&typeof f!="number"&&Xt(o,l,f)&&(f=0,m=x),mT(o,l,f,m)):[]}function Nm(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=f==null?0:Ce(f);return x<0&&(x=kt(m+x,0)),Fa(o,ge(l,3),x)}function Bm(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=m-1;return f!==t&&(x=Ce(f),x=f<0?kt(m+x,0):Bt(x,m-1)),Fa(o,ge(l,3),x,!0)}function Vm(o){var l=o==null?0:o.length;return l?Ft(o,1):[]}function T2(o){var l=o==null?0:o.length;return l?Ft(o,le):[]}function E2(o,l){var f=o==null?0:o.length;return f?(l=l===t?1:Ce(l),Ft(o,l)):[]}function k2(o){for(var l=-1,f=o==null?0:o.length,m={};++l<f;){var x=o[l];m[x[0]]=x[1]}return m}function zm(o){return o&&o.length?o[0]:t}function I2(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=f==null?0:Ce(f);return x<0&&(x=kt(m+x,0)),fi(o,l,x)}function A2(o){var l=o==null?0:o.length;return l?Dr(o,0,-1):[]}var O2=Ie(function(o){var l=nt(o,th);return l.length&&l[0]===o[0]?$u(l):[]}),M2=Ie(function(o){var l=Rr(o),f=nt(o,th);return l===Rr(f)?l=t:f.pop(),f.length&&f[0]===o[0]?$u(f,ge(l,2)):[]}),P2=Ie(function(o){var l=Rr(o),f=nt(o,th);return l=typeof l=="function"?l:t,l&&f.pop(),f.length&&f[0]===o[0]?$u(f,t,l):[]});function D2(o,l){return o==null?"":AC.call(o,l)}function Rr(o){var l=o==null?0:o.length;return l?o[l-1]:t}function R2(o,l,f){var m=o==null?0:o.length;if(!m)return-1;var x=m;return f!==t&&(x=Ce(f),x=x<0?kt(m+x,0):Bt(x,m-1)),l===l?fC(o,l,x):Fa(o,xg,x,!0)}function j2(o,l){return o&&o.length?Jg(o,Ce(l)):t}var F2=Ie(Wm);function Wm(o,l){return o&&o.length&&l&&l.length?qu(o,l):o}function L2(o,l,f){return o&&o.length&&l&&l.length?qu(o,l,ge(f,2)):o}function N2(o,l,f){return o&&o.length&&l&&l.length?qu(o,l,t,f):o}var B2=Tn(function(o,l){var f=o==null?0:o.length,m=zu(o,l);return tm(o,nt(l,function(x){return En(x,f)?+x:x}).sort(hm)),m});function V2(o,l){var f=[];if(!(o&&o.length))return f;var m=-1,x=[],E=o.length;for(l=ge(l,3);++m<E;){var O=o[m];l(O,m,o)&&(f.push(O),x.push(m))}return tm(o,x),f}function gh(o){return o==null?o:DC.call(o)}function z2(o,l,f){var m=o==null?0:o.length;return m?(f&&typeof f!="number"&&Xt(o,l,f)?(l=0,f=m):(l=l==null?0:Ce(l),f=f===t?m:Ce(f)),Dr(o,l,f)):[]}function W2(o,l){return rc(o,l)}function H2(o,l,f){return Ju(o,l,ge(f,2))}function U2(o,l){var f=o==null?0:o.length;if(f){var m=rc(o,l);if(m<f&&Yr(o[m],l))return m}return-1}function $2(o,l){return rc(o,l,!0)}function Y2(o,l,f){return Ju(o,l,ge(f,2),!0)}function X2(o,l){var f=o==null?0:o.length;if(f){var m=rc(o,l,!0)-1;if(Yr(o[m],l))return m}return-1}function G2(o){return o&&o.length?nm(o):[]}function q2(o,l){return o&&o.length?nm(o,ge(l,2)):[]}function K2(o){var l=o==null?0:o.length;return l?Dr(o,1,l):[]}function Z2(o,l,f){return o&&o.length?(l=f||l===t?1:Ce(l),Dr(o,0,l<0?0:l)):[]}function J2(o,l,f){var m=o==null?0:o.length;return m?(l=f||l===t?1:Ce(l),l=m-l,Dr(o,l<0?0:l,m)):[]}function Q2(o,l){return o&&o.length?nc(o,ge(l,3),!1,!0):[]}function eE(o,l){return o&&o.length?nc(o,ge(l,3)):[]}var tE=Ie(function(o){return Kn(Ft(o,1,vt,!0))}),rE=Ie(function(o){var l=Rr(o);return vt(l)&&(l=t),Kn(Ft(o,1,vt,!0),ge(l,2))}),nE=Ie(function(o){var l=Rr(o);return l=typeof l=="function"?l:t,Kn(Ft(o,1,vt,!0),t,l)});function sE(o){return o&&o.length?Kn(o):[]}function iE(o,l){return o&&o.length?Kn(o,ge(l,2)):[]}function oE(o,l){return l=typeof l=="function"?l:t,o&&o.length?Kn(o,t,l):[]}function mh(o){if(!(o&&o.length))return[];var l=0;return o=$n(o,function(f){if(vt(f))return l=kt(f.length,l),!0}),Du(l,function(f){return nt(o,Ou(f))})}function Hm(o,l){if(!(o&&o.length))return[];var f=mh(o);return l==null?f:nt(f,function(m){return mr(l,t,m)})}var aE=Ie(function(o,l){return vt(o)?wo(o,l):[]}),cE=Ie(function(o){return eh($n(o,vt))}),lE=Ie(function(o){var l=Rr(o);return vt(l)&&(l=t),eh($n(o,vt),ge(l,2))}),uE=Ie(function(o){var l=Rr(o);return l=typeof l=="function"?l:t,eh($n(o,vt),t,l)}),hE=Ie(mh);function dE(o,l){return am(o||[],l||[],bo)}function fE(o,l){return am(o||[],l||[],So)}var pE=Ie(function(o){var l=o.length,f=l>1?o[l-1]:t;return f=typeof f=="function"?(o.pop(),f):t,Hm(o,f)});function Um(o){var l=C(o);return l.__chain__=!0,l}function gE(o,l){return l(o),o}function dc(o,l){return l(o)}var mE=Tn(function(o){var l=o.length,f=l?o[0]:0,m=this.__wrapped__,x=function(E){return zu(E,o)};return l>1||this.__actions__.length||!(m instanceof Pe)||!En(f)?this.thru(x):(m=m.slice(f,+f+(l?1:0)),m.__actions__.push({func:dc,args:[x],thisArg:t}),new Mr(m,this.__chain__).thru(function(E){return l&&!E.length&&E.push(t),E}))});function vE(){return Um(this)}function yE(){return new Mr(this.value(),this.__chain__)}function bE(){this.__values__===t&&(this.__values__=sv(this.value()));var o=this.__index__>=this.__values__.length,l=o?t:this.__values__[this.__index__++];return{done:o,value:l}}function wE(){return this}function xE(o){for(var l,f=this;f instanceof Za;){var m=Lm(f);m.__index__=0,m.__values__=t,l?x.__wrapped__=m:l=m;var x=m;f=f.__wrapped__}return x.__wrapped__=o,l}function _E(){var o=this.__wrapped__;if(o instanceof Pe){var l=o;return this.__actions__.length&&(l=new Pe(this)),l=l.reverse(),l.__actions__.push({func:dc,args:[gh],thisArg:t}),new Mr(l,this.__chain__)}return this.thru(gh)}function SE(){return om(this.__wrapped__,this.__actions__)}var CE=sc(function(o,l,f){Ye.call(o,f)?++o[f]:Sn(o,f,1)});function TE(o,l,f){var m=_e(o)?bg:gT;return f&&Xt(o,l,f)&&(l=t),m(o,ge(l,3))}function EE(o,l){var f=_e(o)?$n:Hg;return f(o,ge(l,3))}var kE=vm(Nm),IE=vm(Bm);function AE(o,l){return Ft(fc(o,l),1)}function OE(o,l){return Ft(fc(o,l),le)}function ME(o,l,f){return f=f===t?1:Ce(f),Ft(fc(o,l),f)}function $m(o,l){var f=_e(o)?Ar:qn;return f(o,ge(l,3))}function Ym(o,l){var f=_e(o)?KS:Wg;return f(o,ge(l,3))}var PE=sc(function(o,l,f){Ye.call(o,f)?o[f].push(l):Sn(o,f,[l])});function DE(o,l,f,m){o=or(o)?o:Ti(o),f=f&&!m?Ce(f):0;var x=o.length;return f<0&&(f=kt(x+f,0)),yc(o)?f<=x&&o.indexOf(l,f)>-1:!!x&&fi(o,l,f)>-1}var RE=Ie(function(o,l,f){var m=-1,x=typeof l=="function",E=or(o)?$(o.length):[];return qn(o,function(O){E[++m]=x?mr(l,O,f):xo(O,l,f)}),E}),jE=sc(function(o,l,f){Sn(o,f,l)});function fc(o,l){var f=_e(o)?nt:qg;return f(o,ge(l,3))}function FE(o,l,f,m){return o==null?[]:(_e(l)||(l=l==null?[]:[l]),f=m?t:f,_e(f)||(f=f==null?[]:[f]),Qg(o,l,f))}var LE=sc(function(o,l,f){o[f?0:1].push(l)},function(){return[[],[]]});function NE(o,l,f){var m=_e(o)?Iu:Sg,x=arguments.length<3;return m(o,ge(l,4),f,x,qn)}function BE(o,l,f){var m=_e(o)?ZS:Sg,x=arguments.length<3;return m(o,ge(l,4),f,x,Wg)}function VE(o,l){var f=_e(o)?$n:Hg;return f(o,mc(ge(l,3)))}function zE(o){var l=_e(o)?Ng:DT;return l(o)}function WE(o,l,f){(f?Xt(o,l,f):l===t)?l=1:l=Ce(l);var m=_e(o)?uT:RT;return m(o,l)}function HE(o){var l=_e(o)?hT:FT;return l(o)}function UE(o){if(o==null)return 0;if(or(o))return yc(o)?gi(o):o.length;var l=Vt(o);return l==Qe||l==M?o.size:Xu(o).length}function $E(o,l,f){var m=_e(o)?Au:LT;return f&&Xt(o,l,f)&&(l=t),m(o,ge(l,3))}var YE=Ie(function(o,l){if(o==null)return[];var f=l.length;return f>1&&Xt(o,l[0],l[1])?l=[]:f>2&&Xt(l[0],l[1],l[2])&&(l=[l[0]]),Qg(o,Ft(l,1),[])}),pc=EC||function(){return jt.Date.now()};function XE(o,l){if(typeof l!="function")throw new Or(a);return o=Ce(o),function(){if(--o<1)return l.apply(this,arguments)}}function Xm(o,l,f){return l=f?t:l,l=o&&l==null?o.length:l,Cn(o,z,t,t,t,t,l)}function Gm(o,l){var f;if(typeof l!="function")throw new Or(a);return o=Ce(o),function(){return--o>0&&(f=l.apply(this,arguments)),o<=1&&(l=t),f}}var vh=Ie(function(o,l,f){var m=S;if(f.length){var x=Xn(f,Si(vh));m|=D}return Cn(o,m,l,f,x)}),qm=Ie(function(o,l,f){var m=S|T;if(f.length){var x=Xn(f,Si(qm));m|=D}return Cn(l,m,o,f,x)});function Km(o,l,f){l=f?t:l;var m=Cn(o,I,t,t,t,t,t,l);return m.placeholder=Km.placeholder,m}function Zm(o,l,f){l=f?t:l;var m=Cn(o,A,t,t,t,t,t,l);return m.placeholder=Zm.placeholder,m}function Jm(o,l,f){var m,x,E,O,P,B,K=0,Z=!1,Q=!1,oe=!0;if(typeof o!="function")throw new Or(a);l=jr(l)||0,at(f)&&(Z=!!f.leading,Q="maxWait"in f,E=Q?kt(jr(f.maxWait)||0,l):E,oe="trailing"in f?!!f.trailing:oe);function fe(yt){var Xr=m,An=x;return m=x=t,K=yt,O=o.apply(An,Xr),O}function me(yt){return K=yt,P=Eo(Oe,l),Z?fe(yt):O}function ke(yt){var Xr=yt-B,An=yt-K,vv=l-Xr;return Q?Bt(vv,E-An):vv}function ve(yt){var Xr=yt-B,An=yt-K;return B===t||Xr>=l||Xr<0||Q&&An>=E}function Oe(){var yt=pc();if(ve(yt))return Re(yt);P=Eo(Oe,ke(yt))}function Re(yt){return P=t,oe&&m?fe(yt):(m=x=t,O)}function wr(){P!==t&&cm(P),K=0,m=B=x=P=t}function Gt(){return P===t?O:Re(pc())}function xr(){var yt=pc(),Xr=ve(yt);if(m=arguments,x=this,B=yt,Xr){if(P===t)return me(B);if(Q)return cm(P),P=Eo(Oe,l),fe(B)}return P===t&&(P=Eo(Oe,l)),O}return xr.cancel=wr,xr.flush=Gt,xr}var GE=Ie(function(o,l){return zg(o,1,l)}),qE=Ie(function(o,l,f){return zg(o,jr(l)||0,f)});function KE(o){return Cn(o,Y)}function gc(o,l){if(typeof o!="function"||l!=null&&typeof l!="function")throw new Or(a);var f=function(){var m=arguments,x=l?l.apply(this,m):m[0],E=f.cache;if(E.has(x))return E.get(x);var O=o.apply(this,m);return f.cache=E.set(x,O)||E,O};return f.cache=new(gc.Cache||_n),f}gc.Cache=_n;function mc(o){if(typeof o!="function")throw new Or(a);return function(){var l=arguments;switch(l.length){case 0:return!o.call(this);case 1:return!o.call(this,l[0]);case 2:return!o.call(this,l[0],l[1]);case 3:return!o.call(this,l[0],l[1],l[2])}return!o.apply(this,l)}}function ZE(o){return Gm(2,o)}var JE=NT(function(o,l){l=l.length==1&&_e(l[0])?nt(l[0],vr(ge())):nt(Ft(l,1),vr(ge()));var f=l.length;return Ie(function(m){for(var x=-1,E=Bt(m.length,f);++x<E;)m[x]=l[x].call(this,m[x]);return mr(o,this,m)})}),yh=Ie(function(o,l){var f=Xn(l,Si(yh));return Cn(o,D,t,l,f)}),Qm=Ie(function(o,l){var f=Xn(l,Si(Qm));return Cn(o,F,t,l,f)}),QE=Tn(function(o,l){return Cn(o,L,t,t,t,l)});function ek(o,l){if(typeof o!="function")throw new Or(a);return l=l===t?l:Ce(l),Ie(o,l)}function tk(o,l){if(typeof o!="function")throw new Or(a);return l=l==null?0:kt(Ce(l),0),Ie(function(f){var m=f[l],x=Jn(f,0,l);return m&&Yn(x,m),mr(o,this,x)})}function rk(o,l,f){var m=!0,x=!0;if(typeof o!="function")throw new Or(a);return at(f)&&(m="leading"in f?!!f.leading:m,x="trailing"in f?!!f.trailing:x),Jm(o,l,{leading:m,maxWait:l,trailing:x})}function nk(o){return Xm(o,1)}function sk(o,l){return yh(rh(l),o)}function ik(){if(!arguments.length)return[];var o=arguments[0];return _e(o)?o:[o]}function ok(o){return Pr(o,y)}function ak(o,l){return l=typeof l=="function"?l:t,Pr(o,y,l)}function ck(o){return Pr(o,p|y)}function lk(o,l){return l=typeof l=="function"?l:t,Pr(o,p|y,l)}function uk(o,l){return l==null||Vg(o,l,Dt(l))}function Yr(o,l){return o===l||o!==o&&l!==l}var hk=cc(Uu),dk=cc(function(o,l){return o>=l}),Os=Yg(function(){return arguments}())?Yg:function(o){return ut(o)&&Ye.call(o,"callee")&&!Pg.call(o,"callee")},_e=$.isArray,fk=fg?vr(fg):xT;function or(o){return o!=null&&vc(o.length)&&!kn(o)}function vt(o){return ut(o)&&or(o)}function pk(o){return o===!0||o===!1||ut(o)&&Yt(o)==tr}var Qn=IC||Ah,gk=pg?vr(pg):_T;function mk(o){return ut(o)&&o.nodeType===1&&!ko(o)}function vk(o){if(o==null)return!0;if(or(o)&&(_e(o)||typeof o=="string"||typeof o.splice=="function"||Qn(o)||Ci(o)||Os(o)))return!o.length;var l=Vt(o);if(l==Qe||l==M)return!o.size;if(To(o))return!Xu(o).length;for(var f in o)if(Ye.call(o,f))return!1;return!0}function yk(o,l){return _o(o,l)}function bk(o,l,f){f=typeof f=="function"?f:t;var m=f?f(o,l):t;return m===t?_o(o,l,t,f):!!m}function bh(o){if(!ut(o))return!1;var l=Yt(o);return l==rr||l==Ct||typeof o.message=="string"&&typeof o.name=="string"&&!ko(o)}function wk(o){return typeof o=="number"&&Rg(o)}function kn(o){if(!at(o))return!1;var l=Yt(o);return l==pe||l==dr||l==ot||l==wn}function ev(o){return typeof o=="number"&&o==Ce(o)}function vc(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=ie}function at(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}function ut(o){return o!=null&&typeof o=="object"}var tv=gg?vr(gg):CT;function xk(o,l){return o===l||Yu(o,l,lh(l))}function _k(o,l,f){return f=typeof f=="function"?f:t,Yu(o,l,lh(l),f)}function Sk(o){return rv(o)&&o!=+o}function Ck(o){if(a2(o))throw new xe(i);return Xg(o)}function Tk(o){return o===null}function Ek(o){return o==null}function rv(o){return typeof o=="number"||ut(o)&&Yt(o)==Pt}function ko(o){if(!ut(o)||Yt(o)!=Ze)return!1;var l=Ua(o);if(l===null)return!0;var f=Ye.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&Va.call(f)==_C}var wh=mg?vr(mg):TT;function kk(o){return ev(o)&&o>=-9007199254740991&&o<=ie}var nv=vg?vr(vg):ET;function yc(o){return typeof o=="string"||!_e(o)&&ut(o)&&Yt(o)==ce}function br(o){return typeof o=="symbol"||ut(o)&&Yt(o)==ae}var Ci=yg?vr(yg):kT;function Ik(o){return o===t}function Ak(o){return ut(o)&&Vt(o)==Ge}function Ok(o){return ut(o)&&Yt(o)==We}var Mk=cc(Gu),Pk=cc(function(o,l){return o<=l});function sv(o){if(!o)return[];if(or(o))return yc(o)?Ur(o):ir(o);if(po&&o[po])return uC(o[po]());var l=Vt(o),f=l==Qe?ju:l==M?La:Ti;return f(o)}function In(o){if(!o)return o===0?o:0;if(o=jr(o),o===le||o===-1/0){var l=o<0?-1:1;return l*se}return o===o?o:0}function Ce(o){var l=In(o),f=l%1;return l===l?f?l-f:l:0}function iv(o){return o?Es(Ce(o),0,re):0}function jr(o){if(typeof o=="number")return o;if(br(o))return he;if(at(o)){var l=typeof o.valueOf=="function"?o.valueOf():o;o=at(l)?l+"":l}if(typeof o!="string")return o===0?o:+o;o=Cg(o);var f=fS.test(o);return f||gS.test(o)?XS(o.slice(2),f?2:8):dS.test(o)?he:+o}function ov(o){return ln(o,ar(o))}function Dk(o){return o?Es(Ce(o),-9007199254740991,ie):o===0?o:0}function He(o){return o==null?"":yr(o)}var Rk=xi(function(o,l){if(To(l)||or(l)){ln(l,Dt(l),o);return}for(var f in l)Ye.call(l,f)&&bo(o,f,l[f])}),av=xi(function(o,l){ln(l,ar(l),o)}),bc=xi(function(o,l,f,m){ln(l,ar(l),o,m)}),jk=xi(function(o,l,f,m){ln(l,Dt(l),o,m)}),Fk=Tn(zu);function Lk(o,l){var f=wi(o);return l==null?f:Bg(f,l)}var Nk=Ie(function(o,l){o=qe(o);var f=-1,m=l.length,x=m>2?l[2]:t;for(x&&Xt(l[0],l[1],x)&&(m=1);++f<m;)for(var E=l[f],O=ar(E),P=-1,B=O.length;++P<B;){var K=O[P],Z=o[K];(Z===t||Yr(Z,vi[K])&&!Ye.call(o,K))&&(o[K]=E[K])}return o}),Bk=Ie(function(o){return o.push(t,Cm),mr(cv,t,o)});function Vk(o,l){return wg(o,ge(l,3),cn)}function zk(o,l){return wg(o,ge(l,3),Hu)}function Wk(o,l){return o==null?o:Wu(o,ge(l,3),ar)}function Hk(o,l){return o==null?o:Ug(o,ge(l,3),ar)}function Uk(o,l){return o&&cn(o,ge(l,3))}function $k(o,l){return o&&Hu(o,ge(l,3))}function Yk(o){return o==null?[]:ec(o,Dt(o))}function Xk(o){return o==null?[]:ec(o,ar(o))}function xh(o,l,f){var m=o==null?t:ks(o,l);return m===t?f:m}function Gk(o,l){return o!=null&&km(o,l,vT)}function _h(o,l){return o!=null&&km(o,l,yT)}var qk=bm(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=za.call(l)),o[l]=f},Ch(cr)),Kk=bm(function(o,l,f){l!=null&&typeof l.toString!="function"&&(l=za.call(l)),Ye.call(o,l)?o[l].push(f):o[l]=[f]},ge),Zk=Ie(xo);function Dt(o){return or(o)?Lg(o):Xu(o)}function ar(o){return or(o)?Lg(o,!0):IT(o)}function Jk(o,l){var f={};return l=ge(l,3),cn(o,function(m,x,E){Sn(f,l(m,x,E),m)}),f}function Qk(o,l){var f={};return l=ge(l,3),cn(o,function(m,x,E){Sn(f,x,l(m,x,E))}),f}var eI=xi(function(o,l,f){tc(o,l,f)}),cv=xi(function(o,l,f,m){tc(o,l,f,m)}),tI=Tn(function(o,l){var f={};if(o==null)return f;var m=!1;l=nt(l,function(E){return E=Zn(E,o),m||(m=E.length>1),E}),ln(o,ah(o),f),m&&(f=Pr(f,p|g|y,qT));for(var x=l.length;x--;)Qu(f,l[x]);return f});function rI(o,l){return lv(o,mc(ge(l)))}var nI=Tn(function(o,l){return o==null?{}:OT(o,l)});function lv(o,l){if(o==null)return{};var f=nt(ah(o),function(m){return[m]});return l=ge(l),em(o,f,function(m,x){return l(m,x[0])})}function sI(o,l,f){l=Zn(l,o);var m=-1,x=l.length;for(x||(x=1,o=t);++m<x;){var E=o==null?t:o[un(l[m])];E===t&&(m=x,E=f),o=kn(E)?E.call(o):E}return o}function iI(o,l,f){return o==null?o:So(o,l,f)}function oI(o,l,f,m){return m=typeof m=="function"?m:t,o==null?o:So(o,l,f,m)}var uv=_m(Dt),hv=_m(ar);function aI(o,l,f){var m=_e(o),x=m||Qn(o)||Ci(o);if(l=ge(l,4),f==null){var E=o&&o.constructor;x?f=m?new E:[]:at(o)?f=kn(E)?wi(Ua(o)):{}:f={}}return(x?Ar:cn)(o,function(O,P,B){return l(f,O,P,B)}),f}function cI(o,l){return o==null?!0:Qu(o,l)}function lI(o,l,f){return o==null?o:im(o,l,rh(f))}function uI(o,l,f,m){return m=typeof m=="function"?m:t,o==null?o:im(o,l,rh(f),m)}function Ti(o){return o==null?[]:Ru(o,Dt(o))}function hI(o){return o==null?[]:Ru(o,ar(o))}function dI(o,l,f){return f===t&&(f=l,l=t),f!==t&&(f=jr(f),f=f===f?f:0),l!==t&&(l=jr(l),l=l===l?l:0),Es(jr(o),l,f)}function fI(o,l,f){return l=In(l),f===t?(f=l,l=0):f=In(f),o=jr(o),bT(o,l,f)}function pI(o,l,f){if(f&&typeof f!="boolean"&&Xt(o,l,f)&&(l=f=t),f===t&&(typeof l=="boolean"?(f=l,l=t):typeof o=="boolean"&&(f=o,o=t)),o===t&&l===t?(o=0,l=1):(o=In(o),l===t?(l=o,o=0):l=In(l)),o>l){var m=o;o=l,l=m}if(f||o%1||l%1){var x=jg();return Bt(o+x*(l-o+YS("1e-"+((x+"").length-1))),l)}return Ku(o,l)}var gI=_i(function(o,l,f){return l=l.toLowerCase(),o+(f?dv(l):l)});function dv(o){return Sh(He(o).toLowerCase())}function fv(o){return o=He(o),o&&o.replace(vS,iC).replace(FS,"")}function mI(o,l,f){o=He(o),l=yr(l);var m=o.length;f=f===t?m:Es(Ce(f),0,m);var x=f;return f-=l.length,f>=0&&o.slice(f,x)==l}function vI(o){return o=He(o),o&&Wp.test(o)?o.replace(xs,oC):o}function yI(o){return o=He(o),o&&gr.test(o)?o.replace(Le,"\\$&"):o}var bI=_i(function(o,l,f){return o+(f?"-":"")+l.toLowerCase()}),wI=_i(function(o,l,f){return o+(f?" ":"")+l.toLowerCase()}),xI=mm("toLowerCase");function _I(o,l,f){o=He(o),l=Ce(l);var m=l?gi(o):0;if(!l||m>=l)return o;var x=(l-m)/2;return ac(Ga(x),f)+o+ac(Xa(x),f)}function SI(o,l,f){o=He(o),l=Ce(l);var m=l?gi(o):0;return l&&m<l?o+ac(l-m,f):o}function CI(o,l,f){o=He(o),l=Ce(l);var m=l?gi(o):0;return l&&m<l?ac(l-m,f)+o:o}function TI(o,l,f){return f||l==null?l=0:l&&(l=+l),PC(He(o).replace(an,""),l||0)}function EI(o,l,f){return(f?Xt(o,l,f):l===t)?l=1:l=Ce(l),Zu(He(o),l)}function kI(){var o=arguments,l=He(o[0]);return o.length<3?l:l.replace(o[1],o[2])}var II=_i(function(o,l,f){return o+(f?"_":"")+l.toLowerCase()});function AI(o,l,f){return f&&typeof f!="number"&&Xt(o,l,f)&&(l=f=t),f=f===t?re:f>>>0,f?(o=He(o),o&&(typeof l=="string"||l!=null&&!wh(l))&&(l=yr(l),!l&&pi(o))?Jn(Ur(o),0,f):o.split(l,f)):[]}var OI=_i(function(o,l,f){return o+(f?" ":"")+Sh(l)});function MI(o,l,f){return o=He(o),f=f==null?0:Es(Ce(f),0,o.length),l=yr(l),o.slice(f,f+l.length)==l}function PI(o,l,f){var m=C.templateSettings;f&&Xt(o,l,f)&&(l=t),o=He(o),l=bc({},l,m,Sm);var x=bc({},l.imports,m.imports,Sm),E=Dt(x),O=Ru(x,E),P,B,K=0,Z=l.interpolate||Pa,Q="__p += '",oe=Fu((l.escape||Pa).source+"|"+Z.source+"|"+(Z===yu?hS:Pa).source+"|"+(l.evaluate||Pa).source+"|$","g"),fe="//# sourceURL="+(Ye.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zS+"]")+`
`;o.replace(oe,function(ve,Oe,Re,wr,Gt,xr){return Re||(Re=wr),Q+=o.slice(K,xr).replace(yS,aC),Oe&&(P=!0,Q+=`' +
__e(`+Oe+`) +
'`),Gt&&(B=!0,Q+=`';
`+Gt+`;
__p += '`),Re&&(Q+=`' +
((__t = (`+Re+`)) == null ? '' : __t) +
'`),K=xr+ve.length,ve}),Q+=`';
`;var me=Ye.call(l,"variable")&&l.variable;if(!me)Q=`with (obj) {
`+Q+`
}
`;else if(lS.test(me))throw new xe(c);Q=(B?Q.replace(ui,""):Q).replace(hi,"$1").replace(vu,"$1;"),Q="function("+(me||"obj")+`) {
`+(me?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(P?", __e = _.escape":"")+(B?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var ke=gv(function(){return Ve(E,fe+"return "+Q).apply(t,O)});if(ke.source=Q,bh(ke))throw ke;return ke}function DI(o){return He(o).toLowerCase()}function RI(o){return He(o).toUpperCase()}function jI(o,l,f){if(o=He(o),o&&(f||l===t))return Cg(o);if(!o||!(l=yr(l)))return o;var m=Ur(o),x=Ur(l),E=Tg(m,x),O=Eg(m,x)+1;return Jn(m,E,O).join("")}function FI(o,l,f){if(o=He(o),o&&(f||l===t))return o.slice(0,Ig(o)+1);if(!o||!(l=yr(l)))return o;var m=Ur(o),x=Eg(m,Ur(l))+1;return Jn(m,0,x).join("")}function LI(o,l,f){if(o=He(o),o&&(f||l===t))return o.replace(an,"");if(!o||!(l=yr(l)))return o;var m=Ur(o),x=Tg(m,Ur(l));return Jn(m,x).join("")}function NI(o,l){var f=W,m=q;if(at(l)){var x="separator"in l?l.separator:x;f="length"in l?Ce(l.length):f,m="omission"in l?yr(l.omission):m}o=He(o);var E=o.length;if(pi(o)){var O=Ur(o);E=O.length}if(f>=E)return o;var P=f-gi(m);if(P<1)return m;var B=O?Jn(O,0,P).join(""):o.slice(0,P);if(x===t)return B+m;if(O&&(P+=B.length-P),wh(x)){if(o.slice(P).search(x)){var K,Z=B;for(x.global||(x=Fu(x.source,He(Yp.exec(x))+"g")),x.lastIndex=0;K=x.exec(Z);)var Q=K.index;B=B.slice(0,Q===t?P:Q)}}else if(o.indexOf(yr(x),P)!=P){var oe=B.lastIndexOf(x);oe>-1&&(B=B.slice(0,oe))}return B+m}function BI(o){return o=He(o),o&&Oa.test(o)?o.replace(Aa,pC):o}var VI=_i(function(o,l,f){return o+(f?" ":"")+l.toUpperCase()}),Sh=mm("toUpperCase");function pv(o,l,f){return o=He(o),l=f?t:l,l===t?lC(o)?vC(o):eC(o):o.match(l)||[]}var gv=Ie(function(o,l){try{return mr(o,t,l)}catch(f){return bh(f)?f:new xe(f)}}),zI=Tn(function(o,l){return Ar(l,function(f){f=un(f),Sn(o,f,vh(o[f],o))}),o});function WI(o){var l=o==null?0:o.length,f=ge();return o=l?nt(o,function(m){if(typeof m[1]!="function")throw new Or(a);return[f(m[0]),m[1]]}):[],Ie(function(m){for(var x=-1;++x<l;){var E=o[x];if(mr(E[0],this,m))return mr(E[1],this,m)}})}function HI(o){return pT(Pr(o,p))}function Ch(o){return function(){return o}}function UI(o,l){return o==null||o!==o?l:o}var $I=ym(),YI=ym(!0);function cr(o){return o}function Th(o){return Gg(typeof o=="function"?o:Pr(o,p))}function XI(o){return Kg(Pr(o,p))}function GI(o,l){return Zg(o,Pr(l,p))}var qI=Ie(function(o,l){return function(f){return xo(f,o,l)}}),KI=Ie(function(o,l){return function(f){return xo(o,f,l)}});function Eh(o,l,f){var m=Dt(l),x=ec(l,m);f==null&&!(at(l)&&(x.length||!m.length))&&(f=l,l=o,o=this,x=ec(l,Dt(l)));var E=!(at(f)&&"chain"in f)||!!f.chain,O=kn(o);return Ar(x,function(P){var B=l[P];o[P]=B,O&&(o.prototype[P]=function(){var K=this.__chain__;if(E||K){var Z=o(this.__wrapped__),Q=Z.__actions__=ir(this.__actions__);return Q.push({func:B,args:arguments,thisArg:o}),Z.__chain__=K,Z}return B.apply(o,Yn([this.value()],arguments))})}),o}function ZI(){return jt._===this&&(jt._=SC),this}function kh(){}function JI(o){return o=Ce(o),Ie(function(l){return Jg(l,o)})}var QI=sh(nt),eA=sh(bg),tA=sh(Au);function mv(o){return hh(o)?Ou(un(o)):MT(o)}function rA(o){return function(l){return o==null?t:ks(o,l)}}var nA=wm(),sA=wm(!0);function Ih(){return[]}function Ah(){return!1}function iA(){return{}}function oA(){return""}function aA(){return!0}function cA(o,l){if(o=Ce(o),o<1||o>ie)return[];var f=re,m=Bt(o,re);l=ge(l),o-=re;for(var x=Du(m,l);++f<o;)l(f);return x}function lA(o){return _e(o)?nt(o,un):br(o)?[o]:ir(Fm(He(o)))}function uA(o){var l=++xC;return He(o)+l}var hA=oc(function(o,l){return o+l},0),dA=ih("ceil"),fA=oc(function(o,l){return o/l},1),pA=ih("floor");function gA(o){return o&&o.length?Qa(o,cr,Uu):t}function mA(o,l){return o&&o.length?Qa(o,ge(l,2),Uu):t}function vA(o){return _g(o,cr)}function yA(o,l){return _g(o,ge(l,2))}function bA(o){return o&&o.length?Qa(o,cr,Gu):t}function wA(o,l){return o&&o.length?Qa(o,ge(l,2),Gu):t}var xA=oc(function(o,l){return o*l},1),_A=ih("round"),SA=oc(function(o,l){return o-l},0);function CA(o){return o&&o.length?Pu(o,cr):0}function TA(o,l){return o&&o.length?Pu(o,ge(l,2)):0}return C.after=XE,C.ary=Xm,C.assign=Rk,C.assignIn=av,C.assignInWith=bc,C.assignWith=jk,C.at=Fk,C.before=Gm,C.bind=vh,C.bindAll=zI,C.bindKey=qm,C.castArray=ik,C.chain=Um,C.chunk=p2,C.compact=g2,C.concat=m2,C.cond=WI,C.conforms=HI,C.constant=Ch,C.countBy=CE,C.create=Lk,C.curry=Km,C.curryRight=Zm,C.debounce=Jm,C.defaults=Nk,C.defaultsDeep=Bk,C.defer=GE,C.delay=qE,C.difference=v2,C.differenceBy=y2,C.differenceWith=b2,C.drop=w2,C.dropRight=x2,C.dropRightWhile=_2,C.dropWhile=S2,C.fill=C2,C.filter=EE,C.flatMap=AE,C.flatMapDeep=OE,C.flatMapDepth=ME,C.flatten=Vm,C.flattenDeep=T2,C.flattenDepth=E2,C.flip=KE,C.flow=$I,C.flowRight=YI,C.fromPairs=k2,C.functions=Yk,C.functionsIn=Xk,C.groupBy=PE,C.initial=A2,C.intersection=O2,C.intersectionBy=M2,C.intersectionWith=P2,C.invert=qk,C.invertBy=Kk,C.invokeMap=RE,C.iteratee=Th,C.keyBy=jE,C.keys=Dt,C.keysIn=ar,C.map=fc,C.mapKeys=Jk,C.mapValues=Qk,C.matches=XI,C.matchesProperty=GI,C.memoize=gc,C.merge=eI,C.mergeWith=cv,C.method=qI,C.methodOf=KI,C.mixin=Eh,C.negate=mc,C.nthArg=JI,C.omit=tI,C.omitBy=rI,C.once=ZE,C.orderBy=FE,C.over=QI,C.overArgs=JE,C.overEvery=eA,C.overSome=tA,C.partial=yh,C.partialRight=Qm,C.partition=LE,C.pick=nI,C.pickBy=lv,C.property=mv,C.propertyOf=rA,C.pull=F2,C.pullAll=Wm,C.pullAllBy=L2,C.pullAllWith=N2,C.pullAt=B2,C.range=nA,C.rangeRight=sA,C.rearg=QE,C.reject=VE,C.remove=V2,C.rest=ek,C.reverse=gh,C.sampleSize=WE,C.set=iI,C.setWith=oI,C.shuffle=HE,C.slice=z2,C.sortBy=YE,C.sortedUniq=G2,C.sortedUniqBy=q2,C.split=AI,C.spread=tk,C.tail=K2,C.take=Z2,C.takeRight=J2,C.takeRightWhile=Q2,C.takeWhile=eE,C.tap=gE,C.throttle=rk,C.thru=dc,C.toArray=sv,C.toPairs=uv,C.toPairsIn=hv,C.toPath=lA,C.toPlainObject=ov,C.transform=aI,C.unary=nk,C.union=tE,C.unionBy=rE,C.unionWith=nE,C.uniq=sE,C.uniqBy=iE,C.uniqWith=oE,C.unset=cI,C.unzip=mh,C.unzipWith=Hm,C.update=lI,C.updateWith=uI,C.values=Ti,C.valuesIn=hI,C.without=aE,C.words=pv,C.wrap=sk,C.xor=cE,C.xorBy=lE,C.xorWith=uE,C.zip=hE,C.zipObject=dE,C.zipObjectDeep=fE,C.zipWith=pE,C.entries=uv,C.entriesIn=hv,C.extend=av,C.extendWith=bc,Eh(C,C),C.add=hA,C.attempt=gv,C.camelCase=gI,C.capitalize=dv,C.ceil=dA,C.clamp=dI,C.clone=ok,C.cloneDeep=ck,C.cloneDeepWith=lk,C.cloneWith=ak,C.conformsTo=uk,C.deburr=fv,C.defaultTo=UI,C.divide=fA,C.endsWith=mI,C.eq=Yr,C.escape=vI,C.escapeRegExp=yI,C.every=TE,C.find=kE,C.findIndex=Nm,C.findKey=Vk,C.findLast=IE,C.findLastIndex=Bm,C.findLastKey=zk,C.floor=pA,C.forEach=$m,C.forEachRight=Ym,C.forIn=Wk,C.forInRight=Hk,C.forOwn=Uk,C.forOwnRight=$k,C.get=xh,C.gt=hk,C.gte=dk,C.has=Gk,C.hasIn=_h,C.head=zm,C.identity=cr,C.includes=DE,C.indexOf=I2,C.inRange=fI,C.invoke=Zk,C.isArguments=Os,C.isArray=_e,C.isArrayBuffer=fk,C.isArrayLike=or,C.isArrayLikeObject=vt,C.isBoolean=pk,C.isBuffer=Qn,C.isDate=gk,C.isElement=mk,C.isEmpty=vk,C.isEqual=yk,C.isEqualWith=bk,C.isError=bh,C.isFinite=wk,C.isFunction=kn,C.isInteger=ev,C.isLength=vc,C.isMap=tv,C.isMatch=xk,C.isMatchWith=_k,C.isNaN=Sk,C.isNative=Ck,C.isNil=Ek,C.isNull=Tk,C.isNumber=rv,C.isObject=at,C.isObjectLike=ut,C.isPlainObject=ko,C.isRegExp=wh,C.isSafeInteger=kk,C.isSet=nv,C.isString=yc,C.isSymbol=br,C.isTypedArray=Ci,C.isUndefined=Ik,C.isWeakMap=Ak,C.isWeakSet=Ok,C.join=D2,C.kebabCase=bI,C.last=Rr,C.lastIndexOf=R2,C.lowerCase=wI,C.lowerFirst=xI,C.lt=Mk,C.lte=Pk,C.max=gA,C.maxBy=mA,C.mean=vA,C.meanBy=yA,C.min=bA,C.minBy=wA,C.stubArray=Ih,C.stubFalse=Ah,C.stubObject=iA,C.stubString=oA,C.stubTrue=aA,C.multiply=xA,C.nth=j2,C.noConflict=ZI,C.noop=kh,C.now=pc,C.pad=_I,C.padEnd=SI,C.padStart=CI,C.parseInt=TI,C.random=pI,C.reduce=NE,C.reduceRight=BE,C.repeat=EI,C.replace=kI,C.result=sI,C.round=_A,C.runInContext=N,C.sample=zE,C.size=UE,C.snakeCase=II,C.some=$E,C.sortedIndex=W2,C.sortedIndexBy=H2,C.sortedIndexOf=U2,C.sortedLastIndex=$2,C.sortedLastIndexBy=Y2,C.sortedLastIndexOf=X2,C.startCase=OI,C.startsWith=MI,C.subtract=SA,C.sum=CA,C.sumBy=TA,C.template=PI,C.times=cA,C.toFinite=In,C.toInteger=Ce,C.toLength=iv,C.toLower=DI,C.toNumber=jr,C.toSafeInteger=Dk,C.toString=He,C.toUpper=RI,C.trim=jI,C.trimEnd=FI,C.trimStart=LI,C.truncate=NI,C.unescape=BI,C.uniqueId=uA,C.upperCase=VI,C.upperFirst=Sh,C.each=$m,C.eachRight=Ym,C.first=zm,Eh(C,function(){var o={};return cn(C,function(l,f){Ye.call(C.prototype,f)||(o[f]=l)}),o}(),{chain:!1}),C.VERSION=n,Ar(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){C[o].placeholder=C}),Ar(["drop","take"],function(o,l){Pe.prototype[o]=function(f){f=f===t?1:kt(Ce(f),0);var m=this.__filtered__&&!l?new Pe(this):this.clone();return m.__filtered__?m.__takeCount__=Bt(f,m.__takeCount__):m.__views__.push({size:Bt(f,re),type:o+(m.__dir__<0?"Right":"")}),m},Pe.prototype[o+"Right"]=function(f){return this.reverse()[o](f).reverse()}}),Ar(["filter","map","takeWhile"],function(o,l){var f=l+1,m=f==te||f==J;Pe.prototype[o]=function(x){var E=this.clone();return E.__iteratees__.push({iteratee:ge(x,3),type:f}),E.__filtered__=E.__filtered__||m,E}}),Ar(["head","last"],function(o,l){var f="take"+(l?"Right":"");Pe.prototype[o]=function(){return this[f](1).value()[0]}}),Ar(["initial","tail"],function(o,l){var f="drop"+(l?"":"Right");Pe.prototype[o]=function(){return this.__filtered__?new Pe(this):this[f](1)}}),Pe.prototype.compact=function(){return this.filter(cr)},Pe.prototype.find=function(o){return this.filter(o).head()},Pe.prototype.findLast=function(o){return this.reverse().find(o)},Pe.prototype.invokeMap=Ie(function(o,l){return typeof o=="function"?new Pe(this):this.map(function(f){return xo(f,o,l)})}),Pe.prototype.reject=function(o){return this.filter(mc(ge(o)))},Pe.prototype.slice=function(o,l){o=Ce(o);var f=this;return f.__filtered__&&(o>0||l<0)?new Pe(f):(o<0?f=f.takeRight(-o):o&&(f=f.drop(o)),l!==t&&(l=Ce(l),f=l<0?f.dropRight(-l):f.take(l-o)),f)},Pe.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},Pe.prototype.toArray=function(){return this.take(re)},cn(Pe.prototype,function(o,l){var f=/^(?:filter|find|map|reject)|While$/.test(l),m=/^(?:head|last)$/.test(l),x=C[m?"take"+(l=="last"?"Right":""):l],E=m||/^find/.test(l);x&&(C.prototype[l]=function(){var O=this.__wrapped__,P=m?[1]:arguments,B=O instanceof Pe,K=P[0],Z=B||_e(O),Q=function(Oe){var Re=x.apply(C,Yn([Oe],P));return m&&oe?Re[0]:Re};Z&&f&&typeof K=="function"&&K.length!=1&&(B=Z=!1);var oe=this.__chain__,fe=!!this.__actions__.length,me=E&&!oe,ke=B&&!fe;if(!E&&Z){O=ke?O:new Pe(this);var ve=o.apply(O,P);return ve.__actions__.push({func:dc,args:[Q],thisArg:t}),new Mr(ve,oe)}return me&&ke?o.apply(this,P):(ve=this.thru(Q),me?m?ve.value()[0]:ve.value():ve)})}),Ar(["pop","push","shift","sort","splice","unshift"],function(o){var l=Na[o],f=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",m=/^(?:pop|shift)$/.test(o);C.prototype[o]=function(){var x=arguments;if(m&&!this.__chain__){var E=this.value();return l.apply(_e(E)?E:[],x)}return this[f](function(O){return l.apply(_e(O)?O:[],x)})}}),cn(Pe.prototype,function(o,l){var f=C[l];if(f){var m=f.name+"";Ye.call(bi,m)||(bi[m]=[]),bi[m].push({name:l,func:f})}}),bi[ic(t,T).name]=[{name:"wrapper",func:t}],Pe.prototype.clone=BC,Pe.prototype.reverse=VC,Pe.prototype.value=zC,C.prototype.at=mE,C.prototype.chain=vE,C.prototype.commit=yE,C.prototype.next=bE,C.prototype.plant=xE,C.prototype.reverse=_E,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=SE,C.prototype.first=C.prototype.head,po&&(C.prototype[po]=wE),C},mi=yC();_s?((_s.exports=mi)._=mi,Tu._=mi):jt._=mi}).call(Io)})(ll,ll.exports);var ze=ll.exports;const I3=()=>{const{trackItemIds:r,trackItemsMap:e,fps:t,trackItemDetailsMap:n}=is(),s=ze.merge(e,n);return w.jsx(w.Fragment,{children:r.map(i=>{const a=s[i];return iw[a.type](a,{fps:t})})})};var ow={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var i="",a=0;a<arguments.length;a++){var c=arguments[a];c&&(i=s(i,n(c)))}return i}function n(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var c in i)e.call(i,c)&&i[c]&&(a=s(a,c));return a}function s(i,a){return a?i?i+" "+a:i+a:i}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(ow);var A3=ow.exports;const Lo=kA(A3),O3={asChild:{type:"boolean"}},M3={width:{type:"string",className:"rt-r-w",customProperties:["--width"],responsive:!0},minWidth:{type:"string",className:"rt-r-min-w",customProperties:["--min-width"],responsive:!0},maxWidth:{type:"string",className:"rt-r-max-w",customProperties:["--max-width"],responsive:!0}},P3={height:{type:"string",className:"rt-r-h",customProperties:["--height"],responsive:!0},minHeight:{type:"string",className:"rt-r-min-h",customProperties:["--min-height"],responsive:!0},maxHeight:{type:"string",className:"rt-r-max-h",customProperties:["--max-height"],responsive:!0}},np=["initial","xs","sm","md","lg","xl"];function aw(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Wo(r){return typeof r=="object"&&Object.keys(r).some(e=>np.includes(e))}function D3({className:r,customProperties:e,...t}){const n=cw({allowArbitraryValues:!0,className:r,...t}),s=R3({customProperties:e,...t});return[n,s]}function cw({allowArbitraryValues:r,value:e,className:t,propValues:n,parseValue:s=i=>i}){const i=[];if(e){if(typeof e=="string"&&n.includes(e))return d0(t,e,s);if(Wo(e)){const a=e;for(const c in a){if(!aw(a,c)||!np.includes(c))continue;const u=a[c];if(u!==void 0){if(n.includes(u)){const h=d0(t,u,s),d=c==="initial"?h:`${c}:${h}`;i.push(d)}else if(r){const h=c==="initial"?t:`${c}:${t}`;i.push(h)}}}return i.join(" ")}if(r)return t}}function d0(r,e,t){const n=r?"-":"",s=t(e),i=s?.startsWith("-"),a=i?"-":"",c=i?s?.substring(1):s;return`${a}${r}${n}${c}`}function R3({customProperties:r,value:e,propValues:t,parseValue:n=s=>s}){let s={};if(!(!e||typeof e=="string"&&t.includes(e))){if(typeof e=="string"&&(s=Object.fromEntries(r.map(i=>[i,e]))),Wo(e)){const i=e;for(const a in i){if(!aw(i,a)||!np.includes(a))continue;const c=i[a];if(!t.includes(c))for(const u of r)s={[a==="initial"?u:`${u}-${a}`]:c,...s}}}for(const i in s){const a=s[i];a!==void 0&&(s[i]=n(a))}return s}}function f0(...r){let e={};for(const t of r)t&&(e={...e,...t});return Object.keys(e).length?e:void 0}function j3(...r){return Object.assign({},...r)}function F3(r,...e){let t,n;const s={...r},i=j3(...e);for(const a in i){let c=s[a];const u=i[a];if(u.default!==void 0&&c===void 0&&(c=u.default),u.type==="enum"&&![u.default,...u.values].includes(c)&&!Wo(c)&&(c=u.default),s[a]=c,"className"in u&&u.className){delete s[a];const h="responsive"in u;if(!c||Wo(c)&&!h)continue;if(Wo(c)&&(u.default!==void 0&&c.initial===void 0&&(c.initial=u.default),u.type==="enum"&&([u.default,...u.values].includes(c.initial)||(c.initial=u.default))),u.type==="enum"){const d=cw({allowArbitraryValues:!1,value:c,className:u.className,propValues:u.values,parseValue:u.parseValue});t=Lo(t,d);continue}if(u.type==="string"||u.type==="enum | string"){const d=u.type==="string"?[]:u.values,[p,g]=D3({className:u.className,customProperties:u.customProperties,propValues:d,parseValue:u.parseValue,value:c});n=f0(n,g),t=Lo(t,p);continue}if(u.type==="boolean"&&c){t=Lo(t,u.className);continue}}}return s.className=Lo(t,r.className),s.style=f0(n,r.style),s}const Ms=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],L3={m:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-m",customProperties:["--m"]},mx:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-mx",customProperties:["--ml","--mr"]},my:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-my",customProperties:["--mt","--mb"]},mt:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-mt",customProperties:["--mt"]},mr:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-mr",customProperties:["--mr"]},mb:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-mb",customProperties:["--mb"]},ml:{type:"enum | string",values:Ms,responsive:!0,className:"rt-r-ml",customProperties:["--ml"]}},N3=RA,Ps=["0","1","2","3","4","5","6","7","8","9"],B3={p:{type:"enum | string",className:"rt-r-p",customProperties:["--p"],values:Ps,responsive:!0},px:{type:"enum | string",className:"rt-r-px",customProperties:["--pl","--pr"],values:Ps,responsive:!0},py:{type:"enum | string",className:"rt-r-py",customProperties:["--pt","--pb"],values:Ps,responsive:!0},pt:{type:"enum | string",className:"rt-r-pt",customProperties:["--pt"],values:Ps,responsive:!0},pr:{type:"enum | string",className:"rt-r-pr",customProperties:["--pr"],values:Ps,responsive:!0},pb:{type:"enum | string",className:"rt-r-pb",customProperties:["--pb"],values:Ps,responsive:!0},pl:{type:"enum | string",className:"rt-r-pl",customProperties:["--pl"],values:Ps,responsive:!0}},Bh=["visible","hidden","clip","scroll","auto"],V3=["static","relative","absolute","fixed","sticky"],Ro=["0","1","2","3","4","5","6","7","8","9","-1","-2","-3","-4","-5","-6","-7","-8","-9"],z3=["0","1"],W3=["0","1"],H3={...B3,...M3,...P3,position:{type:"enum",className:"rt-r-position",values:V3,responsive:!0},inset:{type:"enum | string",className:"rt-r-inset",customProperties:["--inset"],values:Ro,responsive:!0},top:{type:"enum | string",className:"rt-r-top",customProperties:["--top"],values:Ro,responsive:!0},right:{type:"enum | string",className:"rt-r-right",customProperties:["--right"],values:Ro,responsive:!0},bottom:{type:"enum | string",className:"rt-r-bottom",customProperties:["--bottom"],values:Ro,responsive:!0},left:{type:"enum | string",className:"rt-r-left",customProperties:["--left"],values:Ro,responsive:!0},overflow:{type:"enum",className:"rt-r-overflow",values:Bh,responsive:!0},overflowX:{type:"enum",className:"rt-r-ox",values:Bh,responsive:!0},overflowY:{type:"enum",className:"rt-r-oy",values:Bh,responsive:!0},flexBasis:{type:"string",className:"rt-r-fb",customProperties:["--flex-basis"],responsive:!0},flexShrink:{type:"enum | string",className:"rt-r-fs",customProperties:["--flex-shrink"],values:z3,responsive:!0},flexGrow:{type:"enum | string",className:"rt-r-fg",customProperties:["--flex-grow"],values:W3,responsive:!0},gridArea:{type:"string",className:"rt-r-ga",customProperties:["--grid-area"],responsive:!0},gridColumn:{type:"string",className:"rt-r-gc",customProperties:["--grid-column"],responsive:!0},gridColumnStart:{type:"string",className:"rt-r-gcs",customProperties:["--grid-column-start"],responsive:!0},gridColumnEnd:{type:"string",className:"rt-r-gce",customProperties:["--grid-column-end"],responsive:!0},gridRow:{type:"string",className:"rt-r-gr",customProperties:["--grid-row"],responsive:!0},gridRowStart:{type:"string",className:"rt-r-grs",customProperties:["--grid-row-start"],responsive:!0},gridRowEnd:{type:"string",className:"rt-r-gre",customProperties:["--grid-row-end"],responsive:!0}},Vh=["0","1","2","3","4","5","6","7","8","9"],U3={gap:{type:"enum | string",className:"rt-r-gap",customProperties:["--gap"],values:Vh,responsive:!0},gapX:{type:"enum | string",className:"rt-r-cg",customProperties:["--column-gap"],values:Vh,responsive:!0},gapY:{type:"enum | string",className:"rt-r-rg",customProperties:["--row-gap"],values:Vh,responsive:!0}},$3=["div","span"],Y3=["none","inline-flex","flex"],X3=["row","column","row-reverse","column-reverse"],G3=["start","center","end","baseline","stretch"],q3=["start","center","end","between"],K3=["nowrap","wrap","wrap-reverse"],Z3={as:{type:"enum",values:$3,default:"div"},...O3,display:{type:"enum",className:"rt-r-display",values:Y3,responsive:!0},direction:{type:"enum",className:"rt-r-fd",values:X3,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:G3,responsive:!0},justify:{type:"enum",className:"rt-r-jc",values:q3,parseValue:J3,responsive:!0},wrap:{type:"enum",className:"rt-r-fw",values:K3,responsive:!0},...U3};function J3(r){return r==="between"?"space-between":r}const sp=H.forwardRef((r,e)=>{const{className:t,asChild:n,as:s="div",...i}=F3(r,Z3,H3,L3);return H.createElement(n?N3:s,{...i,ref:e,className:Lo("rt-Flex",t)})});sp.displayName="Flex";const lw=()=>{const r=v.useRef(null),{setPlayerRef:e,duration:t,fps:n,size:s}=is();return v.useEffect(()=>{e(r)},[]),w.jsx(sp,{className:"size-full",children:w.jsx(x3,{ref:r,component:I3,durationInFrames:Math.round(t/1e3*n)||5*30,compositionWidth:1920,compositionHeight:1080,style:{width:"100%",height:"100%"},inputProps:{},fps:n,controls:!0})})},uw=({scrollLeft:r})=>{const e=v.useRef(null),{playerRef:t,fps:n,scale:s}=is(),i=Fl(t??void 0),a=wt(i/n*1e3,s.zoom)-r,[c,u]=v.useState(!1),[h,d]=v.useState(0),[p,g]=v.useState(a),y=()=>{u(!1)},b=S=>{u(!0);const T="touches"in S?S.touches[0].clientX:S.clientX;d(T),g(a)},_=S=>{if(c){const k=("touches"in S?S.touches[0].clientX:S.clientX)-h,I=p+k,A=ss(I,s.zoom);t?.current?.seekTo(A*n/1e3)}};return v.useEffect(()=>{const S=T=>{T.preventDefault()};return c?(document.addEventListener("mousemove",_),document.addEventListener("mouseup",y),document.addEventListener("touchmove",_),document.addEventListener("touchend",y),document.addEventListener("dragstart",S)):(document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",y)),()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",y),document.removeEventListener("dragstart",S)}},[c,_,y]),w.jsx("div",{ref:e,role:"button",tabIndex:0,onMouseDown:S=>{b(S)},onTouchStart:S=>{b(S)},onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&b(S)},style:{position:"absolute",left:40+jl+a,top:80,width:1,height:"calc(100% - 80px)",background:"#d4d4d8",zIndex:10,cursor:"pointer"},children:w.jsxs("div",{className:"relative h-full",children:[w.jsx("div",{className:"absolute top-0  h-full w-3 -translate-x-1/2"}),w.jsx("div",{className:"absolute top-0  h-full w-0.5 -translate-x-1/2 bg-white/50"}),w.jsx("div",{style:{borderRadius:"0 0 20px 20px"},className:"absolute h-3 -translate-x-1/2 px-1.5",children:w.jsx("svg",{height:"12",viewBox:"0 0 12 12",fill:"none",children:w.jsx("path",{fill:"currentColor",d:"M11.6585 7.04881L6.6585 11.4238C6.28148 11.7537 5.71852 11.7537 5.3415 11.4238L0.341495 7.04881C0.12448 6.85892 0 6.58459 0 6.29623V1C0 0.447715 0.447715 0 1 0H11C11.5523 0 12 0.447715 12 1V6.29623C12 6.58459 11.8755 6.85892 11.6585 7.04881Z"})})})]})})},hw=r=>{const{height:e=40,longLineSize:t=8,shortLineSize:n=6,offsetX:s=il+jl,textOffsetY:i=12,textFormat:a=z1,scrollLeft:c=0,onClick:u}=r,{scale:h}=is(),d=v.useRef(null),[p,g]=v.useState(null),[y,b]=v.useState({width:0,height:e});v.useEffect(()=>{const k=d.current;if(k){const I=k.getContext("2d");g(I),_(k,I,c)}},[]),v.useEffect(()=>{p&&_(d.current,p,c)},[p,c,h]);const _=(k,I,A)=>{if(!k||!I)return;const F=k.offsetParent.offsetWidth??k.offsetWidth,z=y.height;k.width=F,k.height=z,S(I,A,F,z),b({width:F,height:z})},S=(k,I,A,D)=>{const F=h.zoom,z=h.unit,L=h.segments;k.clearRect(0,0,A,D),k.save(),k.strokeStyle="#71717a",k.fillStyle="#71717a",k.lineWidth=1,k.font=`${j1}px ${F1}`,k.textBaseline="top",k.translate(.5,0),k.beginPath();const Y=z*F*ma,W=Math.floor(I/Y),U=Math.ceil((I+A)/Y)-W;for(let X=0;X<=U;++X){const te=X+W;if(te<0)continue;const de=te*Y/F,J=(de-I/F)*F;if(J<-Y||J>=A+Y)continue;const le=a(de),se=-k.measureText(le).width/2;k.fillText(le,J+se+s,i)}for(let X=0;X<=U;++X){const te=X+W;if(te<0)continue;const J=te*Y-I+s;for(let le=0;le<L;++le){const ie=J+le/L*Y;if(ie<0||ie>=A)continue;const se=le%L?n:t;se===n?k.strokeStyle="#a1a1aa":k.strokeStyle="#d4d4d8";const he=32,[re,De]=[ie,he],[$e,je]=[re,De+se];k.beginPath(),k.moveTo(re,De),k.lineTo($e,je),k.stroke()}}k.restore()},T=k=>{const I=d.current;if(!I)return;const A=I.getBoundingClientRect(),F=k.clientX-A.left+c-il;u?.(F)};return w.jsx("div",{className:"border-border border-t",style:{position:"relative",width:"100%",height:`${y.height}px`,backgroundColor:"transparent"},children:w.jsx("canvas",{onClick:T,ref:d,height:y.height})})},Q3=()=>w.jsx(sp,{flexGrow:"1",justify:"center",width:"100%",height:"100%",className:"bg-scene py-3",children:w.jsx("div",{className:"max-w-3xl flex-1  w-full h-full flex relative",children:w.jsx(lw,{})})});function j(r,e,t){return(e=function(n){var s=function(i,a){if(typeof i!="object"||!i)return i;var c=i[Symbol.toPrimitive];if(c!==void 0){var u=c.call(i,a);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}(n,"string");return typeof s=="symbol"?s:s+""}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function p0(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function R(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?p0(Object(t),!0).forEach(function(n){j(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):p0(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function it(r,e){if(r==null)return{};var t,n,s=function(a,c){if(a==null)return{};var u={};for(var h in a)if({}.hasOwnProperty.call(a,h)){if(c.indexOf(h)>=0)continue;u[h]=a[h]}return u}(r,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)t=i[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(r,t)&&(s[t]=r[t])}return s}function ys(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}class g0{constructor(){j(this,"browserShadowBlurConstant",1),j(this,"DPI",96),j(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),j(this,"perfLimitSizeTotal",2097152),j(this,"maxCacheSideLimit",4096),j(this,"minCacheSideLimit",256),j(this,"disableStyleCopyPaste",!1),j(this,"enableGLFiltering",!0),j(this,"textureSize",4096),j(this,"forceGLPutImageData",!1),j(this,"cachesBoundsOfCurve",!1),j(this,"fontPaths",{}),j(this,"NUM_FRACTION_DIGITS",4)}}const Ne=new class extends g0{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=R(R({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){const e=new g0,t=r?.reduce((n,s)=>(n[s]=e[s],n),{})||e;this.configure(t)}},as=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[r]("fabric",...t)};class pn extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class dw extends pn{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class ej{}class tj extends ej{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),as("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const rj={};let m0;const yn=()=>m0||(m0={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new tj,dispose(){},copyPasteData:rj}),no=()=>yn().document,Gl=()=>yn().window,fw=()=>{var r;return Math.max((r=Ne.devicePixelRatio)!==null&&r!==void 0?r:Gl().devicePixelRatio,1)},Ho=new class{constructor(){j(this,"charWidthsCache",{}),j(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:e,fontStyle:t,fontWeight:n}=r;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){const{perfLimitSizeTotal:e}=Ne,t=Math.sqrt(e*r);return[Math.floor(t),Math.floor(e/t)]}},Ld="6.5.4";function Us(){}const cs=Math.PI/2,Vn=2*Math.PI,ip=Math.PI/180,Jt=Object.freeze([1,0,0,1,0,0]),op=16,rs=.4477152502,Ee="center",Ue="left",lr="top",Nd="bottom",bt="right",ur="none",ap=/\r?\n/,pw="moving",ql="scaling",gw="rotating",cp="rotate",mw="skewing",ta="resizing",vw="modifyPoly",nj="modifyPath",ul="changed",Kl="scale",Qt="scaleX",Tr="scaleY",so="skewX",io="skewY",Ot="fill",hr="stroke",hl="modified",ki="json",zh="svg",ne=new class{constructor(){this[ki]=new Map,this[zh]=new Map}has(r){return this[ki].has(r)}getClass(r){const e=this[ki].get(r);if(!e)throw new pn("No class registered for ".concat(r));return e}setClass(r,e){e?this[ki].set(e,r):(this[ki].set(r.type,r),this[ki].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[zh].get(r)}setSVGClass(r,e){this[zh].set(e??r.type.toLowerCase(),r)}},dl=new class extends Array{remove(r){const e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){const r=this.splice(0);return r.forEach(e=>e.abort()),r}cancelByCanvas(r){if(!r)return[];const e=this.filter(t=>{var n;return t.target===r||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===r});return e.forEach(t=>t.abort()),e}cancelByTarget(r){if(!r)return[];const e=this.filter(t=>t.target===r);return e.forEach(t=>t.abort()),e}};class sj{constructor(){j(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[s,i]=n;this.on(s,i)}),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(s=>{let[i,a]=s;n.push(this.once(i,a))}),()=>n.forEach(s=>s())}if(t){const n=this.on(e,function(){for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];t.call(this,...i),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],s=n.indexOf(t);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[s,i]=n;this._removeEventListener(s,i)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,t||{})}}const js=(r,e)=>{const t=r.indexOf(e);return t!==-1&&r.splice(t,1),r},en=r=>{if(r===0)return 1;switch(Math.abs(r)/cs){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},tn=r=>{if(r===0)return 0;const e=r/cs,t=Math.sign(r);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(r)};class V{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new V(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new V(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new V(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new V(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new V(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new V(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new V(this.x/e.x,this.y/e.y)}scalarDivide(e){return new V(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new V(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new V(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new V(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new V(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lp;const n=tn(e),s=en(e),i=this.subtract(t);return new V(i.x*s-i.y*n,i.x*n+i.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new V(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const lp=new V(0,0),Jc=r=>!!r&&Array.isArray(r._objects);function yw(r){class e extends r{constructor(){super(...arguments),j(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];const a=this._objects.push(...s);return s.forEach(c=>this._onObjectAdded(c)),a}insertAt(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];return this._objects.splice(n,0,...i),i.forEach(c=>this._onObjectAdded(c)),this._objects.length}remove(){const n=this._objects,s=[];for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return a.forEach(u=>{const h=n.indexOf(u);h!==-1&&(n.splice(h,1),s.push(u),this._onObjectRemoved(u))}),s}forEachObject(n){this.getObjects().forEach((s,i,a)=>n(s,i,a))}getObjects(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(a=>a.isType(...s))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(n,!0))}complexity(){return this._objects.reduce((n,s)=>n+=s.complexity?s.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(js(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(js(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==0){const a=this.findNewLowerIndex(n,i,s);return js(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==this._objects.length-1){const a=this.findNewUpperIndex(n,i,s);return js(this._objects,n),this._objects.splice(a,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(js(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,i){let a;if(i){a=s;for(let c=s-1;c>=0;--c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=s-1;return a}findNewUpperIndex(n,s,i){let a;if(i){a=s;for(let c=s+1;c<this._objects.length;++c)if(n.isOverlapping(this._objects[c])){a=c;break}}else a=s+1;return a}collectObjects(n){let{left:s,top:i,width:a,height:c}=n,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],d=new V(s,i),p=d.add(new V(a,c));for(let g=this._objects.length-1;g>=0;g--){const y=this._objects[g];y.selectable&&y.visible&&(u&&y.intersectsWithRect(d,p)||y.isContainedWithinRect(d,p)||u&&y.containsPoint(d)||u&&y.containsPoint(p))&&h.push(y)}return h}}return e}class bw extends sj{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function Uo(r){return Gl().requestAnimationFrame(r)}function ww(r){return Gl().cancelAnimationFrame(r)}let ij=0;const ls=()=>ij++,Vr=()=>{const r=no().createElement("canvas");if(!r||r.getContext===void 0)throw new pn("Failed to create `canvas` element");return r},xw=()=>no().createElement("img"),rn=r=>{const e=Vr();return e.width=r.width,e.height=r.height,e},up=(r,e,t)=>r.toDataURL("image/".concat(e),t),pt=r=>r*ip,us=r=>r/ip,_w=r=>r.every((e,t)=>e===Jt[t]),zt=(r,e,t)=>new V(r).transform(e,t),Cr=r=>{const e=1/(r[0]*r[3]-r[1]*r[2]),t=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:n,y:s}=new V(r[4],r[5]).transform(t,!0);return t[4]=-n,t[5]=-s,t},gt=(r,e,t)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],t?0:r[0]*e[4]+r[2]*e[5]+r[4],t?0:r[1]*e[4]+r[3]*e[5]+r[5]],Zl=(r,e)=>r.reduceRight((t,n)=>n&&t?gt(n,t,e):n||t,void 0)||Jt.concat(),Sw=r=>{let[e,t]=r;return Math.atan2(t,e)},Bi=r=>{const e=Sw(r),t=Math.pow(r[0],2)+Math.pow(r[1],2),n=Math.sqrt(t),s=(r[0]*r[3]-r[2]*r[1])/n,i=Math.atan2(r[0]*r[2]+r[1]*r[3],t);return{angle:us(e),scaleX:n,scaleY:s,skewX:us(i),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},oo=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function ao(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=pt(r),s=en(n),i=tn(n);return[s,i,-i,s,e?e-(s*e-i*t):0,t?t-(i*e+s*t):0]}const Jl=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},Cw=r=>Math.tan(pt(r)),hp=r=>[1,0,Cw(r),1,0,0],dp=r=>[1,Cw(r),0,1,0,0],xa=r=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:a=0}=r,c=Jl(n?-e:e,s?-t:t);return i&&(c=gt(c,hp(i),!0)),a&&(c=gt(c,dp(a),!0)),c},Tw=r=>{const{translateX:e=0,translateY:t=0,angle:n=0}=r;let s=oo(e,t);n&&(s=gt(s,ao({angle:n})));const i=xa(r);return _w(i)||(s=gt(s,i)),s},$o=function(r){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,s){if(e&&e.aborted)return s(new dw("loadImage"));const i=xw();let a;e&&(a=function(u){i.src="",s(u)},e.addEventListener("abort",a,{once:!0}));const c=function(){i.onload=i.onerror=null,a&&e?.removeEventListener("abort",a),n(i)};r?(i.onload=c,i.onerror=function(){a&&e?.removeEventListener("abort",a),s(new pn("Error loading ".concat(i.src)))},t&&(i.crossOrigin=t),i.src=r):c()})},Vi=function(r){let{signal:e,reviver:t=Us}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(r.map(a=>ne.getClass(a.type).fromObject(a,{signal:e}).then(c=>(t(a,c),i.push(c),c)))).then(n).catch(a=>{i.forEach(c=>{c.dispose&&c.dispose()}),s(a)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},_a=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const i=Object.values(r).map(c=>c&&c.type&&ne.has(c.type)?Vi([c],{signal:e}).then(u=>{let[h]=u;return s.push(h),h}):c),a=Object.keys(r);Promise.all(i).then(c=>c.reduce((u,h,d)=>(u[a[d]]=h,u),{})).then(t).catch(c=>{s.forEach(u=>{u.dispose&&u.dispose()}),n(c)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},ii=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in r&&(e[t]=r[t]),e),{})},fp=(r,e)=>Object.keys(r).reduce((t,n)=>(e(r[n],n,r)&&(t[n]=r[n]),t),{}),v0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Wh=(r,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+(e-r)*(2/3-t)*6:r),y0=(r,e,t,n)=>{r/=255,e/=255,t/=255;const s=Math.max(r,e,t),i=Math.min(r,e,t);let a,c;const u=(s+i)/2;if(s===i)a=c=0;else{const h=s-i;switch(c=u>.5?h/(2-s-i):h/(s+i),s){case r:a=(e-t)/h+(e<t?6:0);break;case e:a=(t-r)/h+2;break;case t:a=(r-e)/h+4}a/=6}return[Math.round(360*a),Math.round(100*c),Math.round(100*u),n]},b0=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Tc=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),w0=r=>{let[e,t,n,s=1]=r;const i=Math.round(.3*e+.59*t+.11*n);return[i,i,i,s]};class Xe{constructor(e){if(j(this,"isUnrecognised",!1),e)if(e instanceof Xe)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,s,i=1]=e;this.setSource([t,n,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in v0&&(e=v0[e]),e==="transparent"?[255,255,255,0]:Xe.sourceFromHex(e)||Xe.sourceFromRgb(e)||Xe.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=y0(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,s]=y0(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,s]=this.getSource();return"".concat(Tc(e)).concat(Tc(t)).concat(Tc(n)).concat(Tc(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(w0(this.getSource())),this}toBlackWhite(e){const[t,,,n]=w0(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof Xe||(e=new Xe(e));const t=this.getSource(),n=e.getSource(),[s,i,a]=t.map((c,u)=>Math.round(.5*c+.5*n[u]));return this.setSource([s,i,a,t[3]]),this}static fromRgb(e){return Xe.fromRgba(e)}static fromRgba(e){return new Xe(Xe.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[n,s,i]=t.slice(1,4).map(a=>{const c=parseFloat(a);return a.endsWith("%")?Math.round(2.55*c):c});return[n,s,i,b0(t[4])]}}static fromHsl(e){return Xe.fromHsla(e)}static fromHsla(e){return new Xe(Xe.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const n=(Xe.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,i=parseFloat(t[3])/100;let a,c,u;if(s===0)a=c=u=i;else{const h=i<=.5?i*(s+1):i+s-i*s,d=2*i-h;a=Wh(d,h,n+1/3),c=Wh(d,h,n),u=Wh(d,h,n-1/3)}return[Math.round(255*a),Math.round(255*c),Math.round(255*u),b0(t[4])]}static fromHex(e){return new Xe(Xe.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map(u=>u+u):t.match(/.{2}/g);const[s,i,a,c=255]=n.map(u=>parseInt(u,16));return[s,i,a,c/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?us(n):t.includes("turn")?360*n:n}}const st=(r,e)=>parseFloat(Number(r).toFixed(e)),$s=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:op;const t=/\D{0,2}$/.exec(r),n=parseFloat(r),s=Ne.DPI;switch(t?.[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},Ew=r=>{const[e,t]=r.trim().split(" "),[n,s]=(i=e)&&i!==ur?[i.slice(1,4),i.slice(5,8)]:i===ur?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:t||"meet",alignX:n,alignY:s}},ra=r=>"matrix("+r.map(e=>st(e,Ne.NUM_FRACTION_DIGITS)).join(" ")+")",na=function(r,e){let t,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const i=new Xe(e),a=i.getAlpha();t=i.toRgb(),a!==1&&(n=a.toString())}else t="none";return s?"".concat(r,": ").concat(t,"; ").concat(n?"".concat(r,"-opacity: ").concat(n,"; "):""):"".concat(r,'="').concat(t,'" ').concat(n?"".concat(r,'-opacity="').concat(n,'" '):"")},Nr=r=>!!r&&r.toLive!==void 0,x0=r=>!!r&&typeof r.toObject=="function",_0=r=>!!r&&r.offsetX!==void 0&&"source"in r,Fs=r=>!!r&&"multiSelectionStacking"in r;function kw(r){const e=r&&Kr(r);let t=0,n=0;if(!r||!e)return{left:t,top:n};let s=r;const i=e.documentElement,a=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=a.scrollLeft||i.scrollLeft||0,n=a.scrollTop||i.scrollTop||0):(t+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:n}}const Kr=r=>r.ownerDocument||null,Iw=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},Aw=function(r,e,t){let{width:n,height:s}=t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=n,r.height=s,i>1&&(r.setAttribute("width",(n*i).toString()),r.setAttribute("height",(s*i).toString()),e.scale(i,i))},Bd=(r,e)=>{let{width:t,height:n}=e;t&&(r.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(r.style.height=typeof n=="number"?"".concat(n,"px"):n)};function S0(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=ur,r}class Ow{constructor(e){j(this,"_originalCanvasStyle",void 0),j(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&no().getElementById(e)||Vr();var n;if(t.hasAttribute("data-fabric"))throw new pn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:s}=this.lower;Aw(n,s,e,t)}setCSSDimensions(e){Bd(this.lower.el,e)}calcOffset(){return function(e){var t;const n=e&&Kr(e),s={left:0,top:0};if(!n)return s;const i=((t=Iw(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let a={left:0,top:0};const c=n.documentElement;e.getBoundingClientRect!==void 0&&(a=e.getBoundingClientRect());const u=kw(e);return{left:a.left+u.left-(c.clientLeft||0)+s.left,top:a.top+u.top-(c.clientTop||0)+s.top}}(this.lower.el)}dispose(){yn().dispose(this.lower.el),delete this.lower}}const oj={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Jt]};class Sa extends yw(bw){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Sa.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new Ow(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(as("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?fw():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=R({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,s=[...this.viewportTransform],i=zt(e,Cr(s));s[0]=t,s[3]=t;const a=zt(i,s);s[4]+=n.x-a.x,s[5]+=n.y-a.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new V(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new V(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Uo(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,n=Cr(this.viewportTransform),s=zt({x:0,y:0},n),i=zt({x:e,y:t},n),a=s.min(i),c=s.max(i);return this.vptCoords={tl:a,tr:new V(c.x,a.y),bl:new V(a.x,c.y),br:c}}cancelRequestedRender(){this.nextRenderHandle&&(ww(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,s=t.length;n<s;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],s=this["".concat(t,"Image")],i=this.viewportTransform,a=this["".concat(t,"Vpt")];if(!n&&!s)return;const c=Nr(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=c?n.toLive(e):n,a&&e.transform(...i),c){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const u=n.gradientTransform||n.patternTransform;u&&e.transform(...u)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:u}=this;this.skipOffscreen=a,a&&e.transform(...i),s.render(e),this.skipOffscreen=u,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new V(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new V(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new V(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new V(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new V(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return zt(this.getCenterPoint(),Cr(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Ee,Ee),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return R(R(R({version:Ld},ii(this,t)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,t))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,t){const n={},s=this.backgroundImage,i=this.overlayImage,a=this.backgroundColor,c=this.overlayColor;return Nr(a)?a.excludeFromExport||(n.background=a.toObject(t)):a&&(n.background=a),Nr(c)?c.excludeFromExport||(n.overlay=c.toObject(t)):c&&(n.overlay=c),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,t)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),s=t.height||"".concat(this.height),i=Ne.NUM_FRACTION_DIGITS,a=t.viewBox;let c;if(a)c='viewBox="'.concat(a.x," ").concat(a.y," ").concat(a.width," ").concat(a.height,'" ');else if(this.svgViewportTransformation){const u=this.viewportTransform;c='viewBox="'.concat(st(-u[4]/u[0],i)," ").concat(st(-u[5]/u[3],i)," ").concat(st(this.width/u[0],i)," ").concat(st(this.height/u[3],i),'" ')}else c='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',c,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Ld,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(ls()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Nr(t)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return t.toSVG(i,{additionalTransform:n?ra(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=Ne.fontPaths;this._objects.forEach(function i(a){e.push(a),Jc(a)&&a._objects.forEach(i)}),e.forEach(i=>{if(!(a=i)||typeof a._renderText!="function")return;var a;const{styles:c,fontFamily:u}=i;!t[u]&&n[u]&&(t[u]=!0,c&&Object.values(c).forEach(h=>{Object.values(h).forEach(d=>{let{fontFamily:p=""}=d;!t[p]&&n[p]&&(t[p]=!0)})}))});const s=Object.keys(t).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(n[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(Nr(n)){const s=n.repeat||"",i=this.width,a=this.height,c=this["".concat(t,"Vpt")]?ra(Cr(this.viewportTransform)):"";e.push('<rect transform="'.concat(c," translate(").concat(i/2,",").concat(a/2,')" x="').concat(n.offsetX-i/2,'" y="').concat(n.offsetY-a/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!_0(n)?i:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!_0(n)?a:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new pn("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:a,background:c,overlayImage:u,overlay:h,clipPath:d}=s,p=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Vi(i,{reviver:t,signal:n}),_a({backgroundImage:a,backgroundColor:c,overlayImage:u,overlayColor:h,clipPath:d},{signal:n})]).then(g=>{let[y,b]=g;return this.clear(),this.add(...y),this.set(s),this.set(b),this.renderOnAddRemove=p,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=rn(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,a=s*(i?this.getRetinaScaling():1);return up(this.toCanvasElement(a,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:s,top:i,filter:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=(t||this.width)*e,u=(n||this.height)*e,h=this.getZoom(),d=this.width,p=this.height,g=this.skipControlsDrawing,y=h*e,b=this.viewportTransform,_=[y,0,0,y,(b[4]-(s||0))*e,(b[5]-(i||0))*e],S=this.enableRetinaScaling,T=rn({width:c,height:u}),k=a?this._objects.filter(I=>a(I)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=_,this.width=c,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(T.getContext("2d"),k),this.viewportTransform=b,this.width=d,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=S,this.skipControlsDrawing=g,T}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),dl.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}j(Sa,"ownDefaults",oj);const aj=["touchstart","touchmove","touchend"],Mw=r=>{const e=kw(r.target),t=function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n}(r);return new V(t.clientX+e.left,t.clientY+e.top)},fl=r=>aj.includes(r.type)||r.pointerType==="touch",Vd=r=>{r.preventDefault(),r.stopPropagation()},vn=r=>{let e=0,t=0,n=0,s=0;for(let i=0,a=r.length;i<a;i++){const{x:c,y:u}=r[i];(c>n||!i)&&(n=c),(c<e||!i)&&(e=c),(u>s||!i)&&(s=u),(u<t||!i)&&(t=u)}return{left:e,top:t,width:n-e,height:s-t}},cj=["translateX","translateY","scaleX","scaleY"],Pw=(r,e)=>zi(r,gt(e,r.calcOwnMatrix())),zi=(r,e)=>{const t=Bi(e),{translateX:n,translateY:s,scaleX:i,scaleY:a}=t,c=it(t,cj),u=new V(n,s);r.flipX=!1,r.flipY=!1,Object.assign(r,c),r.set({scaleX:i,scaleY:a}),r.setPositionByOrigin(u,Ee,Ee)},Dw=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},pp=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),Ql=(r,e,t)=>{const n=r/2,s=e/2,i=[new V(-n,-s),new V(n,-s),new V(-n,s),new V(n,s)].map(c=>c.transform(t)),a=vn(i);return new V(a.width,a.height)},Ca=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jt;return gt(Cr(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jt),r)},Fn=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jt,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jt;return r.transform(Ca(e,t))},Rw=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jt,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jt;return r.transform(Ca(e,t),!0)},zd=(r,e,t)=>{const n=Ca(e,t);return zi(r,gt(n,r.calcOwnMatrix())),n},gp=(r,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(r),R(R({},e),{},{target:n})),n.fire(r,e)},lj={left:-.5,top:-.5,center:0,bottom:.5,right:.5},xt=r=>typeof r=="string"?lj[r]:r-.5,pl="not-allowed";function jw(r){return xt(r.originX)===xt(Ee)&&xt(r.originY)===xt(Ee)}function C0(r){return .5-xt(r)}const Zr=(r,e)=>r[e],mp=(r,e,t,n)=>({e:r,transform:e,pointer:new V(t,n)});function Fw(r,e){const t=r.getTotalAngle()+us(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function eu(r,e,t,n,s){var i;let{target:a,corner:c}=r;const u=a.controls[c],h=((i=a.canvas)===null||i===void 0?void 0:i.getZoom())||1,d=a.padding/h,p=function(g,y,b,_){const S=g.getRelativeCenterPoint(),T=b!==void 0&&_!==void 0?g.translateToGivenOrigin(S,Ee,Ee,b,_):new V(g.left,g.top);return(g.angle?y.rotate(-pt(g.angle),S):y).subtract(T)}(a,new V(n,s),e,t);return p.x>=d&&(p.x-=d),p.x<=-d&&(p.x+=d),p.y>=d&&(p.y-=d),p.y<=d&&(p.y+=d),p.x-=u.offsetX,p.y-=u.offsetY,p}const Lw=(r,e,t,n)=>{const{target:s,offsetX:i,offsetY:a}=e,c=t-i,u=n-a,h=!Zr(s,"lockMovementX")&&s.left!==c,d=!Zr(s,"lockMovementY")&&s.top!==u;return h&&s.set(Ue,c),d&&s.set(lr,u),(h||d)&&gp(pw,mp(r,e,t,n)),h||d};class Nw{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):ur,i=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",p=e?"":this.getSvgFilter(),g=na(Ot,this.fill);return[na(hr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",t,"; ","opacity: ",h,";",p,d].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(ra(n));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=t?"":'style="'.concat(this.getSvgStyles(),'" '),c=s?'style="'.concat(this.getSvgFilter(),'" '):"",u=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,p=this.stroke,g=this.fill,y=this.shadow,b=[],_=e.indexOf("COMMON_PARTS");let S;u&&(u.clipPathId="CLIPPATH_".concat(ls()),S='<clipPath id="'.concat(u.clipPathId,`" >
`).concat(u.toClipPathSVG(n),`</clipPath>
`)),d&&b.push("<g ",c,this.getSvgCommons(),` >
`),b.push("<g ",this.getSvgTransform(!1),d?"":c+this.getSvgCommons(),` >
`);const T=[a,h,t?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[_]=T,Nr(g)&&b.push(g.toSVG(this)),Nr(p)&&b.push(p.toSVG(this)),y&&b.push(y.toSVG(this)),u&&b.push(S),b.push(e.join("")),b.push(`</g>
`),d&&b.push(`</g>
`),n?n(b.join("")):b.join("")}addPaintOrder(){return this.paintFirst!==Ot?' paint-order="'.concat(this.paintFirst,'" '):""}}function tu(r){return new RegExp("^("+r.join("|")+")\\b","i")}var T0;const Ys=String.raw(T0||(T0=ys(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),uj=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Ys+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Ys+"))?\\s+(.*)"),hj={cx:Ue,x:Ue,r:"radius",cy:lr,y:lr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Hh="font-size",Uh="clip-path";tu(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);tu(["symbol","image","marker","pattern","view","svg"]);const E0=tu(["symbol","g","a","svg","clipPath","defs"]),dj=new V(1,0),Bw=new V,vp=(r,e)=>r.rotate(e),gl=(r,e)=>new V(e).subtract(r),ml=r=>r.distanceFrom(Bw),vl=(r,e)=>Math.atan2(ji(r,e),zw(r,e)),Vw=r=>vl(dj,r),ru=r=>r.eq(Bw)?r:r.scalarDivide(ml(r)),yp=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return ru(new V(-r.y,r.x).scalarMultiply(e?1:-1))},ji=(r,e)=>r.x*e.y-r.y*e.x,zw=(r,e)=>r.x*e.x+r.y*e.y,Wd=(r,e,t)=>{if(r.eq(e)||r.eq(t))return!0;const n=ji(e,t),s=ji(e,r),i=ji(t,r);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},k0="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",I0=new RegExp("(?:\\s|^)"+k0+k0+"("+Ys+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Ln{constructor(e){const t=typeof e=="string"?Ln.parseShadow(e):e;Object.assign(this,Ln.ownDefaults,t),this.id=ls()}static parseShadow(e){const t=e.trim(),[,n=0,s=0,i=0]=(I0.exec(t)||[]).map(a=>parseFloat(a)||0);return{color:(t.replace(I0,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=vp(new V(this.offsetX,this.offsetY),pt(-e.angle)),n=new Xe(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*st((Math.abs(t.x)+this.blur)/e.width,Ne.NUM_FRACTION_DIGITS)+20,i=100*st((Math.abs(t.y)+this.blur)/e.height,Ne.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(st(this.blur?this.blur/2:0,Ne.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(st(t.x,Ne.NUM_FRACTION_DIGITS),'" dy="').concat(st(t.y,Ne.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=Ln.ownDefaults;return this.includeDefaultValues?e:fp(e,(n,s)=>n!==t[s])}static async fromObject(e){return new this(e)}}j(Ln,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),j(Ln,"type","shadow"),ne.setClass(Ln,"shadow");const Xs=(r,e,t)=>Math.max(r,Math.min(e,t)),fj=[lr,Ue,Qt,Tr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",so,io],Wn=[Ot,hr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],pj={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Ue,originY:lr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Ot,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},$h=(r,e,t,n)=>(r<Math.abs(e)?(r=e,n=t/4):n=e===0&&r===0?t/Vn*Math.asin(1):t/Vn*Math.asin(e/r),{a:r,c:e,p:t,s:n}),A0=(r,e,t,n,s)=>r*Math.pow(2,10*(n-=1))*Math.sin((n*s-e)*Vn/t),Ww=(r,e,t,n)=>-t*Math.cos(r/n*cs)+t+e,Hd=(r,e,t,n)=>(r/=n)<1/2.75?t*(7.5625*r*r)+e:r<2/2.75?t*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?t*(7.5625*(r-=2.25/2.75)*r+.9375)+e:t*(7.5625*(r-=2.625/2.75)*r+.984375)+e,O0=(r,e,t,n)=>t-Hd(n-r,0,t,n)+e;var gj=Object.freeze({__proto__:null,defaultEasing:Ww,easeInBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(r/=n)*r*((s+1)*r-s)+e},easeInBounce:O0,easeInCirc:(r,e,t,n)=>-t*(Math.sqrt(1-(r/=n)*r)-1)+e,easeInCubic:(r,e,t,n)=>t*(r/n)**3+e,easeInElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n)===1)return e+t;i||(i=.3*n);const{a,s:c,p:u}=$h(s,t,i,1.70158);return-A0(a,c,u,r,n)+e},easeInExpo:(r,e,t,n)=>r===0?e:t*2**(10*(r/n-1))+e,easeInOutBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(r/=n/2)<1?t/2*(r*r*((1+(s*=1.525))*r-s))+e:t/2*((r-=2)*r*((1+(s*=1.525))*r+s)+2)+e},easeInOutBounce:(r,e,t,n)=>r<n/2?.5*O0(2*r,0,t,n)+e:.5*Hd(2*r-n,0,t,n)+.5*t+e,easeInOutCirc:(r,e,t,n)=>(r/=n/2)<1?-t/2*(Math.sqrt(1-r**2)-1)+e:t/2*(Math.sqrt(1-(r-=2)*r)+1)+e,easeInOutCubic:(r,e,t,n)=>(r/=n/2)<1?t/2*r**3+e:t/2*((r-2)**3+2)+e,easeInOutElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n/2)===2)return e+t;i||(i=n*(.3*1.5));const{a,s:c,p:u,c:h}=$h(s,t,i,1.70158);return r<1?-.5*A0(a,c,u,r,n)+e:a*Math.pow(2,-10*(r-=1))*Math.sin((r*n-c)*Vn/u)*.5+h+e},easeInOutExpo:(r,e,t,n)=>r===0?e:r===n?e+t:(r/=n/2)<1?t/2*2**(10*(r-1))+e:t/2*-(2**(-10*--r)+2)+e,easeInOutQuad:(r,e,t,n)=>(r/=n/2)<1?t/2*r**2+e:-t/2*(--r*(r-2)-1)+e,easeInOutQuart:(r,e,t,n)=>(r/=n/2)<1?t/2*r**4+e:-t/2*((r-=2)*r**3-2)+e,easeInOutQuint:(r,e,t,n)=>(r/=n/2)<1?t/2*r**5+e:t/2*((r-2)**5+2)+e,easeInOutSine:(r,e,t,n)=>-t/2*(Math.cos(Math.PI*r/n)-1)+e,easeInQuad:(r,e,t,n)=>t*(r/=n)*r+e,easeInQuart:(r,e,t,n)=>t*(r/=n)*r**3+e,easeInQuint:(r,e,t,n)=>t*(r/n)**5+e,easeInSine:(r,e,t,n)=>-t*Math.cos(r/n*cs)+t+e,easeOutBack:function(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((r=r/n-1)*r*((s+1)*r+s)+1)+e},easeOutBounce:Hd,easeOutCirc:(r,e,t,n)=>t*Math.sqrt(1-(r=r/n-1)*r)+e,easeOutCubic:(r,e,t,n)=>t*((r/n-1)**3+1)+e,easeOutElastic:(r,e,t,n)=>{const s=t;let i=0;if(r===0)return e;if((r/=n)===1)return e+t;i||(i=.3*n);const{a,s:c,p:u,c:h}=$h(s,t,i,1.70158);return a*2**(-10*r)*Math.sin((r*n-c)*Vn/u)+h+e},easeOutExpo:(r,e,t,n)=>r===n?e+t:t*-(2**(-10*r/n)+1)+e,easeOutQuad:(r,e,t,n)=>-t*(r/=n)*(r-2)+e,easeOutQuart:(r,e,t,n)=>-t*((r=r/n-1)*r**3-1)+e,easeOutQuint:(r,e,t,n)=>t*((r/n-1)**5+1)+e,easeOutSine:(r,e,t,n)=>t*Math.sin(r/n*cs)+e});const mj=()=>!1;class bp{constructor(e){let{startValue:t,byValue:n,duration:s=500,delay:i=0,easing:a=Ww,onStart:c=Us,onChange:u=Us,onComplete:h=Us,abort:d=mj,target:p}=e;j(this,"_state","pending"),j(this,"durationProgress",0),j(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=a,this._onStart=c,this._onChange=u,this._onComplete=h,this._abort=d,this.target=p,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Uo(e),this.delay):Uo(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:i}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Uo(this.tick)))}register(){dl.push(this)}unregister(){dl.remove(this)}abort(){this._state="aborted",this.unregister()}}const vj=["startValue","endValue"];class yj extends bp{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(R(R({},it(e,vj)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const bj=["startValue","endValue"];class wj extends bp{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(R(R({},it(e,bj)),{},{startValue:t,byValue:n.map((s,i)=>s-t[i])}))}calculate(e){const t=this.startValue.map((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const xj=["startValue","endValue","easing","onChange","onComplete","abort"],_j=(r,e,t,n)=>e+t*(1-Math.cos(r/n*cs)),Yh=r=>r&&((e,t,n)=>r(new Xe(e).toRgba(),t,n));class Sj extends bp{constructor(e){let{startValue:t,endValue:n,easing:s=_j,onChange:i,onComplete:a,abort:c}=e,u=it(e,xj);const h=new Xe(t).getSource(),d=new Xe(n).getSource();super(R(R({},u),{},{startValue:h,byValue:d.map((p,g)=>p-h[g]),easing:s,onChange:Yh(i),onComplete:Yh(a),abort:Yh(c)}))}calculate(e){const[t,n,s,i]=this.startValue.map((c,u)=>this.easing(e,c,this.byValue[u],this.duration,u)),a=[...[t,n,s].map(Math.round),Xs(0,i,1)];return{value:a,valueProgress:a.map((c,u)=>this.byValue[u]!==0?Math.abs((c-this.startValue[u])/this.byValue[u]):0).find(c=>c!==0)||0}}}function wp(r){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(r)?new wj(r):new yj(r);return e.start(),e}function Hw(r){const e=new Sj(r);return e.start(),e}class ct{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(s=>!this.includes(s))),this}static isPointContained(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const i=gl(t,n),a=gl(t,e).divide(i);return s?Math.abs(a.x)===Math.abs(a.y):a.x===a.y&&a.x>=0&&a.x<=1}}static isPointInPolygon(e,t){const n=new V(e).setX(Math.min(e.x-1,...t.map(i=>i.x)));let s=0;for(let i=0;i<t.length;i++){const a=this.intersectSegmentSegment(t[i],t[(i+1)%t.length],e,n);if(a.includes(e))return!0;s+=+(a.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,n,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],a=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const c=t.x-e.x,u=t.y-e.y,h=s.x-n.x,d=s.y-n.y,p=e.x-n.x,g=e.y-n.y,y=h*g-d*p,b=c*g-u*p,_=d*c-h*u;if(_!==0){const S=y/_,T=b/_;return(i||0<=S&&S<=1)&&(a||0<=T&&T<=1)?new ct("Intersection").append(new V(e.x+S*c,e.y+S*u)):new ct}if(y===0||b===0){const S=i||a||ct.isPointContained(e,n,s)||ct.isPointContained(t,n,s)||ct.isPointContained(n,e,t)||ct.isPointContained(s,e,t);return new ct(S?"Coincident":void 0)}return new ct("Parallel")}static intersectSegmentLine(e,t,n,s){return ct.intersectLineLine(e,t,n,s,!1,!0)}static intersectSegmentSegment(e,t,n,s){return ct.intersectLineLine(e,t,n,s,!1,!1)}static intersectLinePolygon(e,t,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new ct,a=n.length;for(let c,u,h,d=0;d<a;d++){if(c=n[d],u=n[(d+1)%a],h=ct.intersectLineLine(e,t,c,u,s,!1),h.status==="Coincident")return h;i.append(...h.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,t,n){return ct.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new ct,s=e.length,i=[];for(let a=0;a<s;a++){const c=e[a],u=e[(a+1)%s],h=ct.intersectSegmentPolygon(c,u,t);h.status==="Coincident"?(i.push(h),n.append(c,u)):n.append(...h.points)}return i.length>0&&i.length===e.length?new ct("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const s=t.min(n),i=t.max(n),a=new V(i.x,s.y),c=new V(s.x,i.y);return ct.intersectPolygonPolygon(e,[s,a,i,c])}}class Cj extends bw{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?zt(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=zt(e,Cr(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new V(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,t,n,s];if(this.group){const a=this.group.calcTransformMatrix();return i.map(c=>zt(c,a))}return i}intersectsWithRect(e,t){return ct.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=ct.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:n,top:s,width:i,height:a}=this.getBoundingRect();return n>=e.x&&n+i<=t.x&&s>=e.y&&s+a<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return ct.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return vn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Qt,e),this._set(Tr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?us(Sw(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Jt.concat()}calcACoords(){const e=ao({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),s=oo(t,n),i=gt(s,e),a=this._getTransformedDimensions(),c=a.x/2,u=a.y/2;return{tl:zt({x:-c,y:-u},i),tr:zt({x:c,y:-u},i),bl:zt({x:-c,y:u},i),br:zt({x:c,y:u},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,xt(this.originX),xt(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,a)=>i===n[a])?s.value:(this.group&&(t=gt(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=Tw(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new V(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=R({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let s=n,i=0;this.strokeUniform&&(s=0,i=n);const a=t.width+s,c=t.height+s;let u;return u=t.skewX===0&&t.skewY===0?new V(a*t.scaleX,c*t.scaleY):Ql(a,c,xa(t)),u.scalarAdd(i)}translateToGivenOrigin(e,t,n,s,i){let a=e.x,c=e.y;const u=xt(s)-xt(t),h=xt(i)-xt(n);if(u||h){const d=this._getTransformedDimensions();a+=u*d.x,c+=h*d.y}return new V(a,c)}translateToCenterPoint(e,t,n){if(t===Ee&&n===Ee)return e;const s=this.translateToGivenOrigin(e,t,n,Ee,Ee);return this.angle?s.rotate(pt(this.angle),e):s}translateToOriginPoint(e,t,n){const s=this.translateToGivenOrigin(e,Ee,Ee,t,n);return this.angle?s.rotate(pt(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?zt(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new V(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const s=this.translateToCenterPoint(e,t,n),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Ue,lr)}}const Tj=["type"],Ej=["extraParam"];let Mn=class Qc extends Cj{static getDefaults(){return Qc.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){as("warn","Setting type has no effect",e)}constructor(e){super(),j(this,"_cacheContext",null),Object.assign(this,Qc.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Vr(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,s=Ne.maxCacheSideLimit,i=Ne.minCacheSideLimit;if(t<=s&&n<=s&&t*n<=Ne.perfLimitSizeTotal)return t<i&&(e.width=i),n<i&&(e.height=i),e;const a=t/n,[c,u]=Ho.limitDimsByArea(a),h=Xs(i,c,s),d=Xs(i,u,s);return t>h&&(e.zoomX/=t/h,e.width=h,e.capped=!0),n>d&&(e.zoomY/=n/d,e.height=d,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:s,zoomX:i,zoomY:a,x:c,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=n!==e.width||s!==e.height,d=this.zoomX!==i||this.zoomY!==a;if(!e||!t)return!1;if(h||d){n!==e.width||s!==e.height?(e.width=n,e.height=s):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const p=c/2,g=u/2;return this.cacheTranslationX=Math.round(e.width/2-p)+p,this.cacheTranslationY=Math.round(e.height/2-g)+g,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(i,a),this.zoomX=i,this.zoomY=a,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new V(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Bi(this.calcTransformMatrix());return new V(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Qt&&e!==Tr||(t=this._constrainScale(t)),e===Qt&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof Ln||(t=new Ln(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i}=this,{width:a,height:c}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i,width:a,height:c,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===hr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const s=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=i}createClipPathLayer(e,t){const n=rn(t),s=n.getContext("2d");if(s.translate(t.cacheTranslationX,t.cacheTranslationY),s.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach(i=>{i.transform(s)}),t.parentClipPaths.push(e),e.absolutePositioned){const i=Cr(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const s=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Nr(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(Nr(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,a]=n?.viewportTransform||Jt,c=i*s,u=a*s,h=t.nonScaling?new V(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Ne.browserShadowBlurConstant*(c+u)*(h.x+h.y)/4,e.shadowOffsetX=t.offsetX*c*h.x,e.shadowOffsetY=t.offsetY*u*h.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Nr(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,i=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===hr?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),a=s.x/this.scaleX/i,c=s.y/this.scaleY/i,u=rn({width:Math.ceil(a),height:Math.ceil(c)}),h=u.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(a,0),h.lineTo(a,c),h.lineTo(0,c),h.closePath(),h.translate(a/2,c/2),h.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(h,t),h.fillStyle=t.toLive(e),h.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(n=h.createPattern(u,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new V(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(ne.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=pp(this),n=this.group,s=this.shadow,i=Math.abs,a=e.enableRetinaScaling?fw():1,c=(e.multiplier||1)*a,u=e.canvasProvider||(k=>new Sa(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&Dw(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&zd(this,this.getViewportTransform()),this.setCoords();const h=Vr(),d=this.getBoundingRect(),p=this.shadow,g=new V;if(p){const k=p.blur,I=p.nonScaling?new V(1,1):this.getObjectScaling();g.x=2*Math.round(i(p.offsetX)+k)*i(I.x),g.y=2*Math.round(i(p.offsetY)+k)*i(I.y)}const y=d.width+g.x,b=d.height+g.y;h.width=Math.ceil(y),h.height=Math.ceil(b);const _=u(h);e.format==="jpeg"&&(_.backgroundColor="#fff"),this.setPositionByOrigin(new V(_.width/2,_.height/2),Ee,Ee);const S=this.canvas;_._objects=[this],this.set("canvas",_),this.setCoords();const T=_.toCanvasElement(c||1,e);return this.set("canvas",S),this.shadow=s,n&&(this.group=n),this.set(t),this.setCoords(),_._objects=[],_.destroy(),T}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return up(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:s}=this;if(t){const{x:i,y:a}=this.getRelativeCenterPoint();this.originX=Ee,this.originY=Ee,this.left=i,this.top=a}if(this.set("angle",e),t){const{x:i,y:a}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=i,this.top=a,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){dl.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&yn().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((n,s)=>{let[i,a]=s;return n[i]=this._animate(i,a,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:a,startValue:c,onChange:u,onComplete:h}=n,d=R(R({},n),{},{target:this,startValue:c??s.reduce((p,g)=>p[g],this),endValue:t,abort:a?.bind(this),onChange:(p,g,y)=>{s.reduce((b,_,S)=>(S===s.length-1&&(b[_]=p),b[_]),this),u&&u(p,g,y)},onComplete:(p,g,y)=>{this.setCoords(),h&&h(p,g,y)}});return i?Hw(d):wp(d)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,i=0;i<t.length;i++){if(s=t[i],s===e)return{fork:[this,...t.slice(0,i)],otherFork:[],common:t.slice(i)};for(let a=0;a<n.length;a++){if(this===n[a])return{fork:[],otherFork:[e,...n.slice(0,a)],common:[this,...t]};if(s===n[a])return{fork:[this,...t.slice(0,i)],otherFork:[e,...n.slice(0,a)],common:t.slice(i)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const s=t.fork.pop(),i=t.otherFork.pop(),a=n._objects.indexOf(s),c=n._objects.indexOf(i);return a>-1&&a>c}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Qc.customProperties,this.constructor.customProperties||[]);let t;const n=Ne.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:a,shadow:c,strokeDashArray:u,left:h,top:d,originX:p,originY:g,width:y,height:b,strokeWidth:_,strokeLineCap:S,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:A,scaleX:D,scaleY:F,angle:z,flipX:L,flipY:Y,opacity:W,visible:q,backgroundColor:U,fillRule:X,paintFirst:te,globalCompositeOperation:de,skewX:J,skewY:le}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const ie=he=>st(he,n),se=R(R({},ii(this,e)),{},{type:this.constructor.type,version:Ld,originX:p,originY:g,left:ie(h),top:ie(d),width:ie(y),height:ie(b),fill:x0(i)?i.toObject():i,stroke:x0(a)?a.toObject():a,strokeWidth:ie(_),strokeDashArray:u&&u.concat(),strokeLineCap:S,strokeDashOffset:T,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:ie(A),scaleX:ie(D),scaleY:ie(F),angle:ie(z),flipX:L,flipY:Y,opacity:ie(W),shadow:c&&c.toObject(),visible:q,backgroundColor:U,fillRule:X,paintFirst:te,globalCompositeOperation:de,skewX:ie(J),skewY:ie(le)},t?{clipPath:t}:null);return this.includeDefaultValues?se:this._removeDefaultValues(se)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return fp(e,(s,i)=>{if(i===Ue||i===lr||i==="type")return!0;const a=n[i];return s!==a&&!(Array.isArray(s)&&Array.isArray(a)&&s.length===0&&a.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=it(e,Tj),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,i=it(n,Ej);return _a(t,i).then(a=>s?(delete a[s],new this(t[s],a)):new this(a))}static fromObject(e,t){return this._fromObject(e,t)}};j(Mn,"stateProperties",fj),j(Mn,"cacheProperties",Wn),j(Mn,"ownDefaults",pj),j(Mn,"type","FabricObject"),j(Mn,"colorProperties",[Ot,hr,"backgroundColor"]),j(Mn,"customProperties",[]),ne.setClass(Mn),ne.setClass(Mn,"object");const bs=(r,e,t)=>(n,s,i,a)=>{const c=e(n,s,i,a);return c&&gp(r,R(R({},mp(n,s,i,a)),t)),c};function oi(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,t.originX,t.originY),d}}const Ud=bs(ta,oi((r,e,t,n)=>{const s=eu(e,e.originX,e.originY,t,n);if(xt(e.originX)===xt(Ee)||xt(e.originX)===xt(bt)&&s.x<0||xt(e.originX)===xt(Ue)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=jw(e)?2:1,u=i.width,h=Math.abs(s.x*c/i.scaleX)-a;return i.set("width",Math.max(h,1)),u!==i.width}return!1}));function Uw(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,u=c?hr:Ot,h=!c&&(n.cornerStrokeColor||s.cornerStrokeColor);let d,p=e,g=t;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i>a?(d=i,r.scale(1,a/i),g=t*i/a):a>i?(d=a,r.scale(i/a,1),p=e*a/i):d=i,r.beginPath(),r.arc(p,g,d/2,0,Vn,!1),r[u](),h&&r.stroke(),r.restore()}function $w(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,a=this.sizeY||n.cornerSize||s.cornerSize,c=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,u=c?hr:Ot,h=!c&&(n.cornerStrokeColor||s.cornerStrokeColor),d=i/2,p=a/2;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",r.translate(e,t);const g=s.getTotalAngle();r.rotate(pt(g)),r["".concat(u,"Rect")](-d,-p,i,a),h&&r.strokeRect(-d,-p,i,a),r.restore()}class lt{constructor(e){j(this,"visible",!0),j(this,"actionName",Kl),j(this,"angle",0),j(this,"x",0),j(this,"y",0),j(this,"offsetX",0),j(this,"offsetY",0),j(this,"sizeX",0),j(this,"sizeY",0),j(this,"touchSizeX",0),j(this,"touchSizeY",0),j(this,"cursorStyle","crosshair"),j(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,s){var i;let{tl:a,tr:c,br:u,bl:h}=s;return((i=t.canvas)===null||i===void 0?void 0:i.getActiveObject())===t&&t.isControlVisible(e)&&ct.isPointInPolygon(n,[a,c,u,h])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,s){return new V(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,s,i,a){const c=Zl([oo(n,s),ao({angle:e}),Jl((i?this.touchSizeX:this.sizeX)||t,(i?this.touchSizeY:this.sizeY)||t)]);return{tl:new V(-.5,-.5).transform(c),tr:new V(.5,-.5).transform(c),br:new V(.5,.5).transform(c),bl:new V(-.5,.5).transform(c)}}render(e,t,n,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?Uw.call(this,e,t,n,s,i):$w.call(this,e,t,n,s,i)}}const Yw=(r,e,t)=>t.lockRotation?pl:e.cursorStyle,Xw=bs(gw,oi((r,e,t,n)=>{let{target:s,ex:i,ey:a,theta:c,originX:u,originY:h}=e;const d=s.translateToOriginPoint(s.getRelativeCenterPoint(),u,h);if(Zr(s,"lockRotation"))return!1;const p=Math.atan2(a-d.y,i-d.x),g=Math.atan2(n-d.y,t-d.x);let y=us(g-p+c);if(s.snapAngle&&s.snapAngle>0){const _=s.snapAngle,S=s.snapThreshold||_,T=Math.ceil(y/_)*_,k=Math.floor(y/_)*_;Math.abs(y-k)<S?y=k:Math.abs(y-T)<S&&(y=T)}y<0&&(y=360+y),y%=360;const b=s.angle!==y;return s.angle=y,b}));function Gw(r,e){const t=e.canvas,n=r[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function qw(r,e,t){const n=Zr(r,"lockScalingX"),s=Zr(r,"lockScalingY");if(n&&s||!e&&(n||s)&&t||n&&e==="x"||s&&e==="y")return!0;const{width:i,height:a,strokeWidth:c}=r;return i===0&&c===0&&e!=="y"||a===0&&c===0&&e!=="x"}const kj=["e","se","s","sw","w","nw","n","ne","e"],Mi=(r,e,t)=>{const n=Gw(r,t);if(qw(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return pl;const s=Fw(t,e);return"".concat(kj[s],"-resize")};function xp(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,a=s.by,c=Gw(r,i);let u,h,d,p,g,y;if(qw(i,a,c))return!1;if(e.gestureScale)h=e.scaleX*e.gestureScale,d=e.scaleY*e.gestureScale;else{if(u=eu(e,e.originX,e.originY,t,n),g=a!=="y"?Math.sign(u.x||e.signX||1):1,y=a!=="x"?Math.sign(u.y||e.signY||1):1,e.signX||(e.signX=g),e.signY||(e.signY=y),Zr(i,"lockScalingFlip")&&(e.signX!==g||e.signY!==y))return!1;if(p=i._getTransformedDimensions(),c&&!a){const S=Math.abs(u.x)+Math.abs(u.y),{original:T}=e,k=S/(Math.abs(p.x*T.scaleX/i.scaleX)+Math.abs(p.y*T.scaleY/i.scaleY));h=T.scaleX*k,d=T.scaleY*k}else h=Math.abs(u.x*i.scaleX/p.x),d=Math.abs(u.y*i.scaleY/p.y);jw(e)&&(h*=2,d*=2),e.signX!==g&&a!=="y"&&(e.originX=C0(e.originX),h*=-1,e.signX=g),e.signY!==y&&a!=="x"&&(e.originY=C0(e.originY),d*=-1,e.signY=y)}const b=i.scaleX,_=i.scaleY;return a?(a==="x"&&i.set(Qt,h),a==="y"&&i.set(Tr,d)):(!Zr(i,"lockScalingX")&&i.set(Qt,h),!Zr(i,"lockScalingY")&&i.set(Tr,d)),b!==i.scaleX||_!==i.scaleY}const No=bs(ql,oi((r,e,t,n)=>xp(r,e,t,n))),Kw=bs(ql,oi((r,e,t,n)=>xp(r,e,t,n,{by:"x"}))),Zw=bs(ql,oi((r,e,t,n)=>xp(r,e,t,n,{by:"y"}))),Ij=["target","ex","ey","skewingSide"],Xh={x:{counterAxis:"y",scale:Qt,skew:so,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Tr,skew:io,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},Aj=["ns","nesw","ew","nwse"],Jw=(r,e,t)=>{if(e.x!==0&&Zr(t,"lockSkewingY")||e.y!==0&&Zr(t,"lockSkewingX"))return pl;const n=Fw(t,e)%4;return"".concat(Aj[n],"-resize")};function Qw(r,e,t,n,s){const{target:i}=t,{counterAxis:a,origin:c,lockSkewing:u,skew:h,flip:d}=Xh[r];if(Zr(i,u))return!1;const{origin:p,flip:g}=Xh[a],y=xt(t[p])*(i[g]?-1:1),b=-Math.sign(y)*(i[d]?-1:1),_=.5*-((i[h]===0&&eu(t,Ee,Ee,n,s)[r]>0||i[h]>0?1:-1)*b)+.5;return bs(mw,oi((T,k,I,A)=>function(D,F,z){let{target:L,ex:Y,ey:W,skewingSide:q}=F,U=it(F,Ij);const{skew:X}=Xh[D],te=z.subtract(new V(Y,W)).divide(new V(L.scaleX,L.scaleY))[D],de=L[X],J=U[X],le=Math.tan(pt(J)),ie=D==="y"?L._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:L._getTransformedDimensions({scaleX:1,scaleY:1}).y,se=2*te*q/Math.max(ie,1)+le,he=us(Math.atan(se));L.set(X,he);const re=de!==L[X];if(re&&D==="y"){const{skewX:De,scaleX:$e}=L,je=L._getTransformedDimensions({skewY:de}),we=L._getTransformedDimensions(),Se=De!==0?je.x/we.x:1;Se!==1&&L.set(Qt,Se*$e)}return re}(r,k,new V(I,A))))(e,R(R({},t),{},{[c]:_,skewingSide:b}),n,s)}const ex=(r,e,t,n)=>Qw("x",r,e,t,n),tx=(r,e,t,n)=>Qw("y",r,e,t,n);function nu(r,e){return r[e.canvas.altActionKey]}const Bo=(r,e,t)=>{const n=nu(r,t);return e.x===0?n?so:Tr:e.y===0?n?io:Qt:""},zs=(r,e,t)=>nu(r,t)?Jw(0,e,t):Mi(r,e,t),$d=(r,e,t,n)=>nu(r,e.target)?tx(r,e,t,n):Kw(r,e,t,n),Yd=(r,e,t,n)=>nu(r,e.target)?ex(r,e,t,n):Zw(r,e,t,n),_p=()=>({ml:new lt({x:-.5,y:0,cursorStyleHandler:zs,actionHandler:$d,getActionName:Bo}),mr:new lt({x:.5,y:0,cursorStyleHandler:zs,actionHandler:$d,getActionName:Bo}),mb:new lt({x:0,y:.5,cursorStyleHandler:zs,actionHandler:Yd,getActionName:Bo}),mt:new lt({x:0,y:-.5,cursorStyleHandler:zs,actionHandler:Yd,getActionName:Bo}),tl:new lt({x:-.5,y:-.5,cursorStyleHandler:Mi,actionHandler:No}),tr:new lt({x:.5,y:-.5,cursorStyleHandler:Mi,actionHandler:No}),bl:new lt({x:-.5,y:.5,cursorStyleHandler:Mi,actionHandler:No}),br:new lt({x:.5,y:.5,cursorStyleHandler:Mi,actionHandler:No}),mtr:new lt({x:0,y:-.5,actionHandler:Xw,cursorStyleHandler:Yw,offsetY:-40,withConnection:!0,actionName:cp})}),rx=()=>({mr:new lt({x:.5,y:0,actionHandler:Ud,cursorStyleHandler:zs,actionName:ta}),ml:new lt({x:-.5,y:0,actionHandler:Ud,cursorStyleHandler:zs,actionName:ta})}),nx=()=>R(R({},_p()),rx());class sa extends Mn{static getDefaults(){return R(R({},super.getDefaults()),sa.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),sa.ownDefaults),this.setOptions(e)}static createControls(){return{controls:_p()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,s=t.action;if(this===n&&s&&s.startsWith(Kl))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[i,a]=n[s],c=this.controls[i];if(c.shouldActivate(i,this,e,t?a.touchCorner:a.corner))return this.__corner=i,{key:i,control:c,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=oo(t.x,t.y),s=ao({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=gt(n,s),a=gt(e,i),c=gt(a,[1/e[0],0,0,1/e[3],0,0]),u=this.group?Bi(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const h=this._calculateCurrentDimensions(u),d={};return this.forEachControl((p,g)=>{const y=p.positionHandler(h,c,this,p);d[g]=Object.assign(y,this._calcCornerCoords(p,y))}),d}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(pt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=R({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,i=R({hasBorders:n,hasControls:s},t),a=this.getViewportTransform(),c=i.hasBorders,u=i.hasControls,h=gt(a,this.calcTransformMatrix()),d=Bi(h);e.save(),e.translate(d.translateX,d.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),e.rotate(pt(this.group?d.angle:this.angle)),c&&this.drawBorders(e,d,t),u&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let s;if(n&&n.forActiveSelection||this.group){const i=Ql(this.width,this.height,xa(t)),a=this.isStrokeAccountedForInDimensions()?lp:(this.strokeUniform?new V().scalarAdd(this.canvas?this.canvas.getZoom():1):new V(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(a).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(n=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:a}=this,c=R({cornerStrokeColor:s,cornerDashArray:i,cornerColor:a},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=c.cornerColor,this.transparentCorners||(e.strokeStyle=c.cornerStrokeColor),this._setLineDash(e,c.cornerDashArray),this.forEachControl((u,h)=>{if(u.getVisibility(this,h)){const d=this.oCoords[h];u.render(e,d.x,d.y,c,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,s]=t;return this.setControlVisible(n,s)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const s=this.width+4,i=this.height+4;return t.clearRect(-s/2,-i/2,s,i),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function sx(r,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),r}j(sa,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Ke extends sa{}sx(Ke,[Nw]),ne.setClass(Ke),ne.setClass(Ke,"object");const ix=(r,e,t,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=r.getImageData(e-n,t-n,s,s);for(let a=3;a<i.length;a+=4)if(i[a]>0)return!1;return!0};class ox{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new V(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new V(1/this.options.scaleX,1/this.options.scaleY):new V(1,1)}createSideVector(e,t){const n=gl(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new V(e);return t.y+=t.x*Math.tan(pt(this.options.skewY)),t.x+=t.y*Math.tan(pt(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const Oj=new V;class Fi extends ox{static getOrthogonalRotationFactor(e,t){const n=t?vl(e,t):Vw(e);return Math.abs(n)<cs?-1:1}constructor(e,t,n,s){super(s),j(this,"AB",void 0),j(this,"AC",void 0),j(this,"alpha",void 0),j(this,"bisector",void 0),this.A=new V(e),this.B=new V(t),this.C=new V(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=vl(this.AB,this.AC),this.bisector=ru(vp(this.AB.eq(Oj)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),i=yp(s),a=Fi.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,n*a)}projectBevel(){const e=[];return(this.alpha%Vn==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),i=this.options.strokeUniform?ml(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return ml(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],s=new V(Fi.getOrthogonalRotationFactor(this.bisector),Fi.getOrthogonalRotationFactor(new V(this.bisector.y,this.bisector.x)));return[new V(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new V(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{Wd(i,e,t)&&n.push(this.A.add(i))}),n}projectRoundWithSkew(e,t){const n=[],{skewX:s,skewY:i,scaleX:a,scaleY:c,strokeUniform:u}=this.options,h=new V(Math.tan(pt(s)),Math.tan(pt(i))),d=this.strokeProjectionMagnitude,p=u?d/c/Math.sqrt(1/c**2+1/a**2*h.y**2):d/Math.sqrt(1+h.y**2),g=new V(Math.sqrt(Math.max(d**2-p**2,0)),p),y=u?d/Math.sqrt(1+h.x**2*(1/c)**2/(1/a+1/a*h.x*h.y)**2):d/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),b=new V(y,Math.sqrt(Math.max(d**2-y**2,0)));return[b,b.scalarMultiply(-1),g,g.scalarMultiply(-1)].map(_=>this.applySkew(u?_.multiply(this.strokeUniformScalar):_)).forEach(_=>{Wd(_,e,t)&&n.push(this.applySkew(this.A).add(_))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Vn==0,n=this.applySkew(this.A),s=e[t?0:2].subtract(n),i=e[t?1:0].subtract(n),a=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),c=ji(s,a)>0,u=c?s:i,h=c?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(u,h)):e.push(...this.projectRoundNoSkew(u,h)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class M0 extends ox{constructor(e,t,n){super(n),this.A=new V(e),this.T=new V(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(yp(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new V(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Fi(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new V(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(ru(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(t),s.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const ax=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(r.length===0)return n;const s=r.reduce((i,a)=>(i[i.length-1].eq(a)||i.push(new V(a)),i),[new V(r[0])]);if(s.length===1)t=!0;else if(!t){const i=s[0],a=((c,u)=>{for(let h=c.length-1;h>=0;h--)if(u(c[h],h,c))return h;return-1})(s,c=>!c.eq(i));s.splice(a+1)}return s.forEach((i,a,c)=>{let u,h;a===0?(h=c[1],u=t?i:c[c.length-1]):a===c.length-1?(u=c[a-1],h=t?i:c[0]):(u=c[a-1],h=c[a+1]),t&&c.length===1?n.push(...new M0(i,i,e).project()):!t||a!==0&&a!==c.length-1?n.push(...new Fi(i,u,h,e).project()):n.push(...new M0(i,a===0?h:u,e).project())}),n},Sp=r=>{const e={};return Object.keys(r).forEach(t=>{e[t]={},Object.keys(r[t]).forEach(n=>{e[t][n]=R({},r[t][n])})}),e},cx=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),su=r=>{const e=[];for(let t,n=0;n<r.length;n++)(t=Mj(r,n))!==!1&&e.push(t);return e},Mj=(r,e)=>{const t=r.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return r.charAt(e);if(55296<=t&&t<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";const s=r.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=r.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var Pj=Object.freeze({__proto__:null,capitalize:function(r){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(r.charAt(0).toUpperCase()).concat(e?r.slice(1):r.slice(1).toLowerCase())},escapeXml:cx,graphemeSplit:su});const iu=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||t&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},lx=(r,e)=>{const t=e.split(`
`),n=[];let s=-1,i={};r=Sp(r);for(let a=0;a<t.length;a++){const c=su(t[a]);if(r[a])for(let u=0;u<c.length;u++){s++;const h=r[a][u];h&&Object.keys(h).length>0&&(iu(i,h,!0)?n.push({start:s,end:s+1,style:h}):n[n.length-1].end++),i=h||{}}else s+=c.length,i={}}return n},ux=(r,e)=>{if(!Array.isArray(r))return Sp(r);const t=e.split(ap),n={};let s=-1,i=0;for(let a=0;a<t.length;a++){const c=su(t[a]);for(let u=0;u<c.length;u++)s++,r[i]&&r[i].start<=s&&s<r[i].end&&(n[a]=n[a]||{},n[a][u]=R({},r[i].style),s===r[i].end-1&&i++)}return n},ws=["display","transform",Ot,"fill-opacity","fill-rule","opacity",hr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function P0(r,e){const t=r.nodeName,n=r.getAttribute("class"),s=r.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let a;if(a=new RegExp("^"+t,"i"),e=e.replace(a,""),s&&e.length&&(a=new RegExp("#"+s+i,"i"),e=e.replace(a,"")),n&&e.length){const c=n.split(" ");for(let u=c.length;u--;)a=new RegExp("\\."+c[u]+i,"i"),e=e.replace(a,"")}return e.length===0}function Dj(r,e){let t=!0;const n=P0(r,e.pop());return n&&e.length&&(t=function(s,i){let a,c=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)c&&(a=i.pop()),c=P0(s=s.parentElement,a);return i.length===0}(r,e)),n&&t&&e.length===0}const Rj=r=>{var e;return(e=hj[r])!==null&&e!==void 0?e:r},jj=new RegExp("(".concat(Ys,")"),"gi"),Fj=r=>r.replace(jj," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var D0,R0,j0,F0,L0,N0,B0;const Kt="(".concat(Ys,")"),Lj=String.raw(D0||(D0=ys(["(skewX)(",")"],["(skewX)\\(","\\)"])),Kt),Nj=String.raw(R0||(R0=ys(["(skewY)(",")"],["(skewY)\\(","\\)"])),Kt),Bj=String.raw(j0||(j0=ys(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Kt,Kt,Kt),Vj=String.raw(F0||(F0=ys(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Kt,Kt),zj=String.raw(L0||(L0=ys(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Kt,Kt),Wj=String.raw(N0||(N0=ys(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Kt,Kt,Kt,Kt,Kt,Kt),Cp="(?:".concat(Wj,"|").concat(zj,"|").concat(Bj,"|").concat(Vj,"|").concat(Lj,"|").concat(Nj,")"),Hj="(?:".concat(Cp,"*)"),Uj=String.raw(B0||(B0=ys(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),Hj),$j=new RegExp(Uj),Yj=new RegExp(Cp),Xj=new RegExp(Cp,"g");function Xd(r){const e=[];if(!(r=Fj(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!$j.test(r))return[...Jt];for(const t of r.matchAll(Xj)){const n=Yj.exec(t[0]);if(!n)continue;let s=Jt;const i=n.filter(b=>!!b),[,a,...c]=i,[u,h,d,p,g,y]=c.map(b=>parseFloat(b));switch(a){case"translate":s=oo(u,h);break;case cp:s=ao({angle:u},{x:h,y:d});break;case Kl:s=Jl(u,h);break;case so:s=hp(u);break;case io:s=dp(u);break;case"matrix":s=[u,h,d,p,g,y]}e.push(s)}return Zl(e)}function Gj(r,e,t,n){const s=Array.isArray(e);let i,a=e;if(r!==Ot&&r!==hr||e!==ur){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")a=e===ur?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")a=t&&t.transformMatrix?gt(t.transformMatrix,Xd(e)):Xd(e);else if(r==="visible")a=e!==ur&&e!=="hidden",t&&t.visible===!1&&(a=!1);else if(r==="opacity")a=parseFloat(e),t&&t.opacity!==void 0&&(a*=t.opacity);else if(r==="textAnchor")a=e==="start"?Ue:e==="end"?bt:Ee;else if(r==="charSpacing")i=$s(e,n)/n*1e3;else if(r==="paintFirst"){const c=e.indexOf(Ot),u=e.indexOf(hr);a=Ot,(c>-1&&u>-1&&u<c||c===-1&&u>-1)&&(a=hr)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";i=s?e.map($s):$s(e,n)}}else a="";return!s&&isNaN(i)?a:i}function qj(r,e){const t=r.match(uj);if(!t)return;const n=t[1],s=t[3],i=t[4],a=t[5],c=t[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=$s(i)),c&&(e.fontFamily=c),a&&(e.lineHeight=a==="normal"?1:a)}function Kj(r,e){r.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[n,s]=t.split(":");e[n.trim().toLowerCase()]=s.trim()})}function Zj(r){const e={},t=r.getAttribute("style");return t&&(typeof t=="string"?Kj(t,e):function(n,s){Object.entries(n).forEach(i=>{let[a,c]=i;c!==void 0&&(s[a.toLowerCase()]=c)})}(t,e)),e}const Jj={stroke:"strokeOpacity",fill:"fillOpacity"};function Hn(r,e,t){if(!r)return{};let n,s={},i=op;r.parentNode&&E0.test(r.parentNode.nodeName)&&(s=Hn(r.parentElement,e,t),s.fontSize&&(n=i=$s(s.fontSize)));const a=R(R(R({},e.reduce((h,d)=>{const p=r.getAttribute(d);return p&&(h[d]=p),h},{})),function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={};for(const g in d)Dj(h,g.split(" "))&&(p=R(R({},p),d[g]));return p}(r,t)),Zj(r));a[Uh]&&r.setAttribute(Uh,a[Uh]),a[Hh]&&(n=$s(a[Hh],i),a[Hh]="".concat(n));const c={};for(const h in a){const d=Rj(h),p=Gj(d,a[h],s,n);c[d]=p}c&&c.font&&qj(c.font,c);const u=R(R({},s),c);return E0.test(r.nodeName)?u:function(h){const d=Ke.getDefaults();return Object.entries(Jj).forEach(p=>{let[g,y]=p;if(h[y]===void 0||h[g]==="")return;if(h[g]===void 0){if(!d[g])return;h[g]=d[g]}if(h[g].indexOf("url(")===0)return;const b=new Xe(h[g]);h[g]=b.setAlpha(st(b.getAlpha()*h[y],2)).toRgba()}),h}(u)}const Qj=["left","top","width","height","visible"],hx=["rx","ry"];class _t extends Ke{static getDefaults(){return R(R({},super.getDefaults()),_t.ownDefaults)}constructor(e){super(),Object.assign(this,_t.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,s=-t/2,i=-n/2,a=this.rx?Math.min(this.rx,t/2):0,c=this.ry?Math.min(this.ry,n/2):0,u=a!==0||c!==0;e.beginPath(),e.moveTo(s+a,i),e.lineTo(s+t-a,i),u&&e.bezierCurveTo(s+t-rs*a,i,s+t,i+rs*c,s+t,i+c),e.lineTo(s+t,i+n-c),u&&e.bezierCurveTo(s+t,i+n-rs*c,s+t-rs*a,i+n,s+t-a,i+n),e.lineTo(s+a,i+n),u&&e.bezierCurveTo(s+rs*a,i+n,s,i+n-rs*c,s,i+n-c),e.lineTo(s,i+c),u&&e.bezierCurveTo(s,i+rs*c,s+rs*a,i,s+a,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...hx,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const s=Hn(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,width:c=0,height:u=0,visible:h=!0}=s,d=it(s,Qj);return new this(R(R(R({},t),d),{},{left:i,top:a,width:c,height:u,visible:!!(h&&c&&u)}))}}j(_t,"type","Rect"),j(_t,"cacheProperties",[...Wn,...hx]),j(_t,"ownDefaults",{rx:0,ry:0}),j(_t,"ATTRIBUTE_NAMES",[...ws,"x","y","rx","ry","width","height"]),ne.setClass(_t),ne.setSVGClass(_t);const Rn="initialization",yl="added",Tp="removed",bl="imperative",dx=(r,e)=>{const{strokeUniform:t,strokeWidth:n,width:s,height:i,group:a}=e,c=a&&a!==r?Ca(a.calcTransformMatrix(),r.calcTransformMatrix()):null,u=c?e.getRelativeCenterPoint().transform(c):e.getRelativeCenterPoint(),h=!e.isStrokeAccountedForInDimensions(),d=t&&h?Rw(new V(n,n),void 0,r.calcTransformMatrix()):lp,p=!t&&h?n:0,g=Ql(s+p,i+p,Zl([c,e.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[u.subtract(g),u.add(g)]};class ou{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:s}=e;return t===Rn||t===bl||!!n&&s!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==Rn&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:s}=t;if(n===bl&&t.overrides)return t.overrides;if(e.length===0)return;const{left:i,top:a,width:c,height:u}=vn(e.map(p=>dx(s,p)).reduce((p,g)=>p.concat(g),[])),h=new V(c,u),d=new V(i,a).add(h.scalarDivide(2));if(n===Rn){const p=this.getInitialSize(t,{size:h,center:d});return{center:d,relativeCorrection:new V(0,0),size:p}}return{center:d.transform(s.calcOwnMatrix()),size:h}}}j(ou,"type","strategy");class Gd extends ou{shouldPerformLayout(e){return!0}}j(Gd,"type","fit-content"),ne.setClass(Gd);const e6=["strategy"],t6=["target","strategy","bubbles","prevStrategy"],fx="layoutManager";class ia{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Gd;j(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=R(R({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[hl,pw,ta,gw,ql,mw,ul,vw,nj].map(s=>e.on(s,i=>this.performLayout(s===hl?{type:"object_modified",trigger:s,e:i,target:n}:{type:"object_modifying",trigger:s,e:i,target:n})))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:s}=t;if(n===Rn||n===yl?this.subscribeTargets(e):n===Tp&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),n===bl&&e.deep){const i=it(e,e6);t.forEachObject(a=>a.layoutManager&&a.layoutManager.performLayout(R(R({},i),{},{bubbles:!1,target:a})))}}getLayoutResult(e){const{target:t,strategy:n,type:s}=e,i=n.calcLayoutResult(e,t.getObjects());if(!i)return;const a=s===Rn?new V:t.getRelativeCenterPoint(),{center:c,correction:u=new V,relativeCorrection:h=new V}=i,d=a.subtract(c).add(u).transform(s===Rn?Jt:Cr(t.calcOwnMatrix()),!0).add(h);return{result:i,prevCenter:a,nextCenter:c,offset:d}}commitLayout(e,t){const{target:n}=e,{result:{size:s},nextCenter:i}=t;var a,c;n.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===Rn?n.set({left:(a=e.x)!==null&&a!==void 0?a:i.x+s.x*xt(n.originX),top:(c=e.y)!==null&&c!==void 0?c:i.y+s.y*xt(n.originY)}):(n.setPositionByOrigin(i,Ee,Ee),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject(s=>{s.group===n&&this.layoutObject(e,t,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:s}=t;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,t){const{target:n,strategy:s,bubbles:i,prevStrategy:a}=e,c=it(e,t6),{canvas:u}=n;n.fire("layout:after",{context:e,result:t}),u&&u.fire("object:layout:after",{context:e,result:t,target:n});const h=n.parent;i&&h!=null&&h.layoutManager&&((c.path||(c.path=[])).push(n),h.layoutManager.performLayout(R(R({},c),{},{target:h}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(n=>n())),e.clear()}toObject(){return{type:fx,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ne.setClass(ia,fx);const r6=["type","objects","layoutManager"];class n6 extends ia{performLayout(){}}class Br extends yw(Ke){static getDefaults(){return R(R({},super.getDefaults()),Br.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),j(this,"_activeObjects",[]),j(this,"__objectSelectionTracker",void 0),j(this,"__objectSelectionDisposer",void 0),Object.assign(this,Br.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new ia,this.layoutManager.performLayout({type:Rn,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(as("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(as("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,s)=>this.canEnterGroup(t)&&s.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(t),i=super.add(...s);return this._onAfterObjectsChange(yl,s),i}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(n),a=super.insertAt(e,...i);return this._onAfterObjectsChange(yl,i),a}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(Tp,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(s=>{s._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(n);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&zi(e,gt(Cr(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(zi(e,gt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Ke.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const a=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&a.group!==this?(e.save(),e.transform(...Cr(this.calcTransformMatrix())),a.render(e),e.restore()):a.group===this&&a.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(R({target:this,type:bl},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=n;const a=s[e||"toObject"](t);return s.includeDefaultValues=i,a})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return R(R(R({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=_t.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:s=[],layoutManager:i}=e,a=it(e,r6);return Promise.all([Vi(s,t),_a(a,t)]).then(c=>{let[u,h]=c;const d=new this(u,R(R(R({},a),h),{},{layoutManager:new n6}));if(i){const p=ne.getClass(i.type),g=ne.getClass(i.strategy);d.layoutManager=new p(new g)}else d.layoutManager=new ia;return d.layoutManager.subscribeTargets({type:Rn,target:d,targets:d.getObjects()}),d.setCoords(),d})}}j(Br,"type","Group"),j(Br,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ne.setClass(Br);const px=(r,e)=>Math.min(e.width/r.width,e.height/r.height),gx=(r,e)=>Math.max(e.width/r.width,e.height/r.height),qd="\\s*,?\\s*",jo="".concat(qd,"(").concat(Ys,")"),s6="".concat(jo).concat(jo).concat(jo).concat(qd,"([01])").concat(qd,"([01])").concat(jo).concat(jo),i6={m:"l",M:"L"},o6=(r,e,t,n,s,i,a,c,u,h,d)=>{const p=en(r),g=tn(r),y=en(e),b=tn(e),_=t*s*y-n*i*b+a,S=n*s*y+t*i*b+c;return["C",h+u*(-t*s*g-n*i*p),d+u*(-n*s*g+t*i*p),_+u*(t*s*b+n*i*y),S+u*(n*s*b-t*i*y),_,S]},V0=(r,e,t,n)=>{const s=Math.atan2(e,r),i=Math.atan2(n,t);return i>=s?i-s:2*Math.PI-(s-i)};function Kd(r,e,t,n,s,i,a,c){let u;if(Ne.cachesBoundsOfCurve&&(u=[...arguments].join(),Ho.boundsOfCurveCache[u]))return Ho.boundsOfCurveCache[u];const h=Math.sqrt,d=Math.abs,p=[],g=[[0,0],[0,0]];let y=6*r-12*t+6*s,b=-3*r+9*t-9*s+3*a,_=3*t-3*r;for(let A=0;A<2;++A){if(A>0&&(y=6*e-12*n+6*i,b=-3*e+9*n-9*i+3*c,_=3*n-3*e),d(b)<1e-12){if(d(y)<1e-12)continue;const Y=-_/y;0<Y&&Y<1&&p.push(Y);continue}const D=y*y-4*_*b;if(D<0)continue;const F=h(D),z=(-y+F)/(2*b);0<z&&z<1&&p.push(z);const L=(-y-F)/(2*b);0<L&&L<1&&p.push(L)}let S=p.length;const T=S,k=vx(r,e,t,n,s,i,a,c);for(;S--;){const{x:A,y:D}=k(p[S]);g[0][S]=A,g[1][S]=D}g[0][T]=r,g[1][T]=e,g[0][T+1]=a,g[1][T+1]=c;const I=[new V(Math.min(...g[0]),Math.min(...g[1])),new V(Math.max(...g[0]),Math.max(...g[1]))];return Ne.cachesBoundsOfCurve&&(Ho.boundsOfCurveCache[u]=I),I}const a6=(r,e,t)=>{let[n,s,i,a,c,u,h,d]=t;const p=((g,y,b,_,S,T,k)=>{if(b===0||_===0)return[];let I=0,A=0,D=0;const F=Math.PI,z=k*ip,L=tn(z),Y=en(z),W=.5*(-Y*g-L*y),q=.5*(-Y*y+L*g),U=b**2,X=_**2,te=q**2,de=W**2,J=U*X-U*te-X*de;let le=Math.abs(b),ie=Math.abs(_);if(J<0){const Ct=Math.sqrt(1-J/(U*X));le*=Ct,ie*=Ct}else D=(S===T?-1:1)*Math.sqrt(J/(U*te+X*de));const se=D*le*q/ie,he=-D*ie*W/le,re=Y*se-L*he+.5*g,De=L*se+Y*he+.5*y;let $e=V0(1,0,(W-se)/le,(q-he)/ie),je=V0((W-se)/le,(q-he)/ie,(-W-se)/le,(-q-he)/ie);T===0&&je>0?je-=2*F:T===1&&je<0&&(je+=2*F);const we=Math.ceil(Math.abs(je/F*2)),Se=[],ot=je/we,tr=8/3*Math.sin(ot/4)*Math.sin(ot/4)/Math.sin(ot/2);let Rt=$e+ot;for(let Ct=0;Ct<we;Ct++)Se[Ct]=o6($e,Rt,Y,L,le,ie,re,De,tr,I,A),I=Se[Ct][5],A=Se[Ct][6],$e=Rt,Rt+=ot;return Se})(h-r,d-e,s,i,c,u,a);for(let g=0,y=p.length;g<y;g++)p[g][1]+=r,p[g][2]+=e,p[g][3]+=r,p[g][4]+=e,p[g][5]+=r,p[g][6]+=e;return p},mx=r=>{let e=0,t=0,n=0,s=0;const i=[];let a,c=0,u=0;for(const h of r){const d=[...h];let p;switch(d[0]){case"l":d[1]+=e,d[2]+=t;case"L":e=d[1],t=d[2],p=["L",e,t];break;case"h":d[1]+=e;case"H":e=d[1],p=["L",e,t];break;case"v":d[1]+=t;case"V":t=d[1],p=["L",e,t];break;case"m":d[1]+=e,d[2]+=t;case"M":e=d[1],t=d[2],n=d[1],s=d[2],p=["M",e,t];break;case"c":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t,d[5]+=e,d[6]+=t;case"C":c=d[3],u=d[4],e=d[5],t=d[6],p=["C",d[1],d[2],c,u,e,t];break;case"s":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"S":a==="C"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[3],t=d[4],p=["C",c,u,d[1],d[2],e,t],c=p[3],u=p[4];break;case"q":d[1]+=e,d[2]+=t,d[3]+=e,d[4]+=t;case"Q":c=d[1],u=d[2],e=d[3],t=d[4],p=["Q",c,u,e,t];break;case"t":d[1]+=e,d[2]+=t;case"T":a==="Q"?(c=2*e-c,u=2*t-u):(c=e,u=t),e=d[1],t=d[2],p=["Q",c,u,e,t];break;case"a":d[6]+=e,d[7]+=t;case"A":a6(e,t,d).forEach(g=>i.push(g)),e=d[6],t=d[7];break;case"z":case"Z":e=n,t=s,p=["Z"]}p?(i.push(p),a=p[0]):a=""}return i},wl=(r,e,t,n)=>Math.sqrt((t-r)**2+(n-e)**2),vx=(r,e,t,n,s,i,a,c)=>u=>{const h=u**3,d=(y=>3*y**2*(1-y))(u),p=(y=>3*y*(1-y)**2)(u),g=(y=>(1-y)**3)(u);return new V(a*h+s*d+t*p+r*g,c*h+i*d+n*p+e*g)},yx=r=>r**2,bx=r=>2*r*(1-r),wx=r=>(1-r)**2,c6=(r,e,t,n,s,i,a,c)=>u=>{const h=yx(u),d=bx(u),p=wx(u),g=3*(p*(t-r)+d*(s-t)+h*(a-s)),y=3*(p*(n-e)+d*(i-n)+h*(c-i));return Math.atan2(y,g)},l6=(r,e,t,n,s,i)=>a=>{const c=yx(a),u=bx(a),h=wx(a);return new V(s*c+t*u+r*h,i*c+n*u+e*h)},u6=(r,e,t,n,s,i)=>a=>{const c=1-a,u=2*(c*(t-r)+a*(s-t)),h=2*(c*(n-e)+a*(i-n));return Math.atan2(h,u)},z0=(r,e,t)=>{let n=new V(e,t),s=0;for(let i=1;i<=100;i+=1){const a=r(i/100);s+=wl(n.x,n.y,a.x,a.y),n=a}return s},h6=(r,e)=>{let t,n=0,s=0,i={x:r.x,y:r.y},a=R({},i),c=.01,u=0;const h=r.iterator,d=r.angleFinder;for(;s<e&&c>1e-4;)a=h(n),u=n,t=wl(i.x,i.y,a.x,a.y),t+s>e?(n-=c,c/=2):(i=a,n+=c,s+=t);return R(R({},a),{},{angle:d(u)})},Ep=r=>{let e,t,n=0,s=0,i=0,a=0,c=0;const u=[];for(const h of r){const d={x:s,y:i,command:h[0],length:0};switch(h[0]){case"M":t=d,t.x=a=s=h[1],t.y=c=i=h[2];break;case"L":t=d,t.length=wl(s,i,h[1],h[2]),s=h[1],i=h[2];break;case"C":e=vx(s,i,h[1],h[2],h[3],h[4],h[5],h[6]),t=d,t.iterator=e,t.angleFinder=c6(s,i,h[1],h[2],h[3],h[4],h[5],h[6]),t.length=z0(e,s,i),s=h[5],i=h[6];break;case"Q":e=l6(s,i,h[1],h[2],h[3],h[4]),t=d,t.iterator=e,t.angleFinder=u6(s,i,h[1],h[2],h[3],h[4]),t.length=z0(e,s,i),s=h[3],i=h[4];break;case"Z":t=d,t.destX=a,t.destY=c,t.length=wl(s,i,a,c),s=a,i=c}n+=t.length,u.push(t)}return u.push({length:n,x:s,y:i}),u},xx=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ep(r),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const s=t[n],i=e/s.length,a=r[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return R(R({},new V(s.x,s.y).lerp(new V(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return R(R({},new V(s.x,s.y).lerp(new V(a[1],a[2]),i)),{},{angle:Math.atan2(a[2]-s.y,a[1]-s.x)});case"C":case"Q":return h6(s,e)}},d6=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),W0=new RegExp(s6,"g"),f6=new RegExp(Ys,"gi"),p6={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},_x=r=>{var e;const t=[],n=(e=r.match(d6))!==null&&e!==void 0?e:[];for(const s of n){const i=s[0];if(i==="z"||i==="Z"){t.push([i]);continue}const a=p6[i.toLowerCase()];let c=[];if(i==="a"||i==="A"){W0.lastIndex=0;for(let u=null;u=W0.exec(s);)c.push(...u.slice(1))}else c=s.match(f6)||[];for(let u=0;u<c.length;u+=a){const h=new Array(a),d=i6[i];h[0]=u>0&&d?d:i;for(let p=0;p<a;p++)h[p+1]=parseFloat(c[u+p]);t.push(h)}}return t},g6=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new V(r[0]),n=new V(r[1]),s=1,i=0;const a=[],c=r.length,u=c>2;let h;for(u&&(s=r[2].x<n.x?-1:r[2].x===n.x?0:1,i=r[2].y<n.y?-1:r[2].y===n.y?0:1),a.push(["M",t.x-s*e,t.y-i*e]),h=1;h<c;h++){if(!t.eq(n)){const d=t.midPointFrom(n);a.push(["Q",t.x,t.y,d.x,d.y])}t=r[h],h+1<r.length&&(n=r[h+1])}return u&&(s=t.x>r[h-2].x?1:t.x===r[h-2].x?0:-1,i=t.y>r[h-2].y?1:t.y===r[h-2].y?0:-1),a.push(["L",t.x+s*e,t.y+i*e]),a},Sx=(r,e)=>r.map(t=>t.map((n,s)=>s===0||e===void 0?n:st(n,e)).join(" ")).join(" ");function xl(r,e){const t=r.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(n=>{let[s,i]=n;return t.setProperty(s,i)}))}const m6=(r,e)=>Math.floor(Math.random()*(e-r+1))+r;function v6(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||Us,n=new(Gl()).XMLHttpRequest,s=e.signal,i=function(){n.abort()},a=function(){s&&s.removeEventListener("abort",i),n.onerror=n.ontimeout=Us};if(s&&s.aborted)throw new dw("request");return s&&s.addEventListener("abort",i,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(a(),t(n),n.onreadystatechange=Us)},n.onerror=n.ontimeout=a,n.open("get",r,!0),n.send(),n}const y6=(r,e)=>{let t=r._findCenterFromElement();r.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:s,scaleY:i,angle:a,skewX:c}=Bi(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(Qt,s),n.set(Tr,i),n.angle=a,n.skewX=c,n.skewY=0}})(r),t=t.transform(r.transformMatrix)),delete r.transformMatrix,e&&(r.scaleX*=e.scaleX,r.scaleY*=e.scaleY,r.cropX=e.cropX,r.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,r.width=e.width,r.height=e.height),r.setPositionByOrigin(t,Ee,Ee)};var Cx=Object.freeze({__proto__:null,addTransformToObject:Pw,animate:wp,animateColor:Hw,applyTransformToObject:zi,calcAngleBetweenVectors:vl,calcDimensionsMatrix:xa,calcPlaneChangeMatrix:Ca,calcVectorRotation:Vw,cancelAnimFrame:ww,capValue:Xs,composeMatrix:Tw,copyCanvasElement:r=>{var e;const t=rn(r);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(r,0,0),t},cos:en,createCanvasElement:Vr,createImage:xw,createRotateMatrix:ao,createScaleMatrix:Jl,createSkewXMatrix:hp,createSkewYMatrix:dp,createTranslateMatrix:oo,createVector:gl,crossProduct:ji,degreesToRadians:pt,dotProduct:zw,ease:gj,enlivenObjectEnlivables:_a,enlivenObjects:Vi,findScaleToCover:gx,findScaleToFit:px,getBoundsOfCurve:Kd,getOrthonormalVector:yp,getPathSegmentsInfo:Ep,getPointOnPath:xx,getPointer:Mw,getRandomInt:m6,getRegularPolygonPath:(r,e)=>{const t=2*Math.PI/r;let n=-cs;r%2==0&&(n+=t/2);const s=new Array(r+1);for(let i=0;i<r;i++){const a=i*t+n,{x:c,y:u}=new V(en(a),tn(a)).scalarMultiply(e);s[i]=[i===0?"M":"L",c,u]}return s[r]=["Z"],s},getSmoothPathFromPoints:g6,getSvgAttributes:r=>{const e=["instantiated_by_use","style","id","class"];switch(r){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:ru,groupSVGElements:(r,e)=>r&&r.length===1?r[0]:new Br(r,e),hasStyleChanged:iu,invertTransform:Cr,isBetweenVectors:Wd,isIdentityMatrix:_w,isTouchEvent:fl,isTransparent:ix,joinPath:Sx,loadImage:$o,magnitude:ml,makeBoundingBoxFromPoints:vn,makePathSimpler:mx,matrixToSVG:ra,mergeClipPaths:(r,e)=>{var t;let n=r,s=e;n.inverted&&!s.inverted&&(n=e,s=r),zd(s,(t=s.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());const i=n.inverted&&s.inverted;return i&&(n.inverted=s.inverted=!1),new Br([n],{clipPath:s,inverted:i})},multiplyTransformMatrices:gt,multiplyTransformMatrixArray:Zl,parsePath:_x,parsePreserveAspectRatioAttribute:Ew,parseUnit:$s,pick:ii,projectStrokeOnPoints:ax,qrDecompose:Bi,radiansToDegrees:us,removeFromArray:js,removeTransformFromObject:(r,e)=>{const t=Cr(e),n=gt(t,r.calcOwnMatrix());zi(r,n)},removeTransformMatrixForSvgParsing:y6,request:v6,requestAnimFrame:Uo,resetObjectTransform:Dw,rotatePoint:(r,e,t)=>r.rotate(t,e),rotateVector:vp,saveObjectTransform:pp,sendObjectToPlane:zd,sendPointToPlane:Fn,sendVectorToPlane:Rw,setStyle:xl,sin:tn,sizeAfterTransform:Ql,string:Pj,stylesFromArray:ux,stylesToArray:lx,toDataURL:up,toFixed:st,transformPath:(r,e,t)=>(t&&(e=gt(e,[1,0,0,1,-t.x,-t.y])),r.map(n=>{const s=[...n];for(let i=1;i<n.length-1;i+=2){const{x:a,y:c}=zt({x:n[i],y:n[i+1]},e);s[i]=a,s[i+1]=c}return s})),transformPoint:zt});class b6 extends Ow{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),j(this,"upper",void 0),j(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(i,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const a=this.createContainerElement();a.classList.add(n),s.parentNode&&s.parentNode.replaceChild(a,s),a.append(s,i),this.container=a}createUpperCanvas(){const{el:e}=this.lower,t=Vr();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=no().createElement("div");return e.setAttribute("data-fabric","wrapper"),xl(e,{position:"relative"}),S0(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:s}=t;xl(e,R(R({},n),{},{"touch-action":s?"manipulation":ur})),S0(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:s}=this.upper;Aw(n,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),Bd(this.upper.el,e),Bd(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),yn().dispose(this.upper.el),delete this.upper,delete this.container}}class au extends Sa{constructor(){super(...arguments),j(this,"targets",[]),j(this,"_hoveredTargets",[]),j(this,"_objectsToRender",void 0),j(this,"_currentTransform",null),j(this,"_groupSelector",null),j(this,"contextTopDirty",!1)}static getDefaults(){return R(R({},super.getDefaults()),au.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new b6(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-t+s,-n+s),i.transform(...this.viewportTransform);const a=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=a,i.restore();const c=Math.round(s*this.getRetinaScaling());return ix(i,c,c,c)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&n.length>1&&n.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let s;return t===Kl||t===Qt||t===Tr||t===ta?s=this.centeredScaling||e.centeredScaling:t===cp&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=bt:["mr","tr","br"].includes(t)&&(n.x=Ue),["tl","mt","tr"].includes(t)?n.y=Nd:["bl","mb","br"].includes(t)&&(n.y=lr)),n}_setupCurrentTransform(e,t,n){var s;const i=t.group?Fn(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:a="",control:c}=t.getActiveControl()||{},u=n&&c?(s=c.getActionHandler(e,t,c))===null||s===void 0?void 0:s.bind(c):Lw,h=((y,b,_,S)=>{if(!b||!y)return"drag";const T=S.controls[b];return T.getActionName(_,T,S)})(n,a,e,t),d=e[this.centeredKey],p=this._shouldCenterTransform(t,h,d)?{x:Ee,y:Ee}:this._getOriginFromCorner(t,a),g={target:t,action:h,actionHandler:u,actionPerformed:!1,corner:a,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:i.x-t.left,offsetY:i.y-t.top,originX:p.x,originY:p.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:pt(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:d,original:R(R({},pp(t)),{},{originX:p.x,originY:p.y})};this._currentTransform=g,this.fire("before:transform",{e,transform:g})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new V(t,n).transform(this.viewportTransform),c=new V(t+s,n+i).transform(this.viewportTransform),u=this.selectionLineWidth/2;let h=Math.min(a.x,c.x),d=Math.min(a.y,c.y),p=Math.max(a.x,c.x),g=Math.max(a.y,c.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(h,d,p-h,g-d)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,h+=u,d+=u,p-=u,g-=u,Ke.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(h,d,p-h,g-d))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(t,fl(e))||s.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const a=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&a&&a!==n?(this.targets=i,n):a}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[a,c,u,h]=n,d=Math.atan2(c.y-a.y,c.x-a.x),p=en(d)*i,g=tn(d)*i,y=p+g,b=p-g;n=[new V(a.x-b,a.y-y),new V(c.x+y,c.y-b),new V(u.x+b,u.y+y),new V(h.x-y,h.y+b)]}return ct.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,Fn(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,t)){if(Jc(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,t);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&Jc(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const a=s[i];if(!Jc(a)||!a.interactive)return a}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let i=Mw(e),a=s.width||0,c=s.height||0;a&&c||(lr in s&&Nd in s&&(c=Math.abs(s.top-s.bottom)),bt in s&&Ue in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,t||(i=Fn(i,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(i.x/=u,i.y/=u);const h=a===0||c===0?new V(1,1):new V(n.width/a,n.height/c);return i.multiply(h)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Vr(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Fs(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,s=!1;const i=this.getActiveObjects(),a=[],c=[];e.forEach(u=>{i.includes(u)||(n=!0,u.fire("deselected",{e:t,target:u}),c.push(u))}),i.forEach(u=>{e.includes(u)||(n=!0,u.fire("selected",{e:t,target:u}),a.push(u))}),e.length>0&&i.length>0?(s=!0,n&&this.fire("selection:updated",{e:t,selected:a,deselected:c})):i.length>0?(s=!0,this.fire("selection:created",{e:t,selected:a})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:c})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),s}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Fs(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),Fs(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,s={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),n.fire(hl,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Fs(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,t,n);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Fs(t)&&this._activeObject===t){const n=ii(e,["angle","flipX","flipY",Ue,Qt,Tr,so,io,lr]);return Pw(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(s)}}j(au,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class w6{constructor(e){j(this,"targets",[]),j(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),js(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const x6=["target","oldTarget","fireCanvas","e"],Sr={passive:!1},Ii=(r,e)=>{const t=r.getViewportPoint(e),n=r.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},ns=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.addEventListener(...t)},Fr=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.removeEventListener(...t)},_6={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class Zd extends au{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),j(this,"_isClick",void 0),j(this,"textEditingManager",new w6(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(ns,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,s=this._getEventPrefix();e(Iw(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,Sr),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Sr)}removeListeners(){this.addOrRemove(Fr,"remove");const e=this._getEventPrefix(),t=Kr(this.upperCanvasEl);Fr(t,"".concat(e,"up"),this._onMouseUp),Fr(t,"touchend",this._onTouchEnd,Sr),Fr(t,"".concat(e,"move"),this._onMouseMove,Sr),Fr(t,"touchmove",this._onMouseMove,Sr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=R({e},Ii(this,e));this.fire("mouse:out",R(R({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",R({},n)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",R(R({},n),{},{target:s})),s&&s.fire("mouseout",R({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",R({e},Ii(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void ns(this.upperCanvasEl,"drag",this._onDragProgress)}Vd(e)}_renderDragEffects(e,t,n){let s=!1;const i=this._dropTarget;i&&i!==t&&i!==n&&(i.clearContextTop(),s=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();const a=this.contextTop;a.save(),a.transform(...this.viewportTransform),t&&(a.save(),t.transform(a),t.renderDragSourceEffect(e),a.restore(),s=!0),n&&(a.save(),n.transform(a),n.renderDropTargetEffect(e),a.restore(),s=!0),a.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==ur,n=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};Fr(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:s}=this.findDragTargets(e),i=this._dragSource,a={e,target:n,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let c;this.fire(t,a),this._fireEnterLeaveEvents(n,a),n&&(n.canDrop(e)&&(c=n),n.fire(t,a));for(let u=0;u<s.length;u++){const h=s[u];h.canDrop(e)&&(c=h),h.fire(t,a)}this._renderDragEffects(e,i,c),this._dropTarget=c}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),s={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",R({e,target:t,subTargets:n,dragSource:this._dragSource},Ii(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&Vd(e),this._basicEventHandler("contextmenu",s),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),a=Kr(s);ns(a,"touchend",this._onTouchEnd,Sr),t&&ns(a,"touchmove",this._onMouseMove,Sr),Fr(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();Fr(t,"".concat(n,"move"),this._onMouseMove,Sr);const s=Kr(t);ns(s,"".concat(n,"up"),this._onMouseUp),ns(s,"".concat(n,"move"),this._onMouseMove,Sr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=Kr(this.upperCanvasEl);Fr(n,"touchend",this._onTouchEnd,Sr),Fr(n,"touchmove",this._onMouseMove,Sr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{ns(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=Kr(this.upperCanvasEl);Fr(s,"".concat(n,"up"),this._onMouseUp),Fr(s,"".concat(n,"move"),this._onMouseMove,Sr),ns(t,"".concat(n,"move"),this._onMouseMove,Sr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,i=this._target,{button:a}=e;if(a)return(this.fireMiddleClick&&a===1||this.fireRightClick&&a===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let c,u,h=!1;if(n&&(this._finalizeCurrentTransform(e),h=n.actionPerformed),!s){const d=i===this._activeObject;this.handleSelection(e),h||(h=this._shouldRender(i)||!d&&i===this._activeObject)}if(i){const d=i.findControl(this.getViewportPoint(e),fl(e)),{key:p,control:g}=d||{};if(u=p,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),h=!0;else if(g){const y=g.getMouseUpHandler(e,i,g);y&&(c=this.getScenePoint(e),y.call(g,e,n,c.x,c.y))}i.isMoving=!1}if(n&&(n.target!==i||n.corner!==u)){const d=n.target&&n.target.controls[n.corner],p=d&&d.getMouseUpHandler(e,n.target,d);c=c||this.getScenePoint(e),p&&p.call(d,e,n,c.x,c.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),h?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:s=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let i=0;i<s.length;i++)s[i]!==n&&s[i].fire(e,t);return t}_handleEvent(e,t){const n=this._target,s=this.targets||[],i=R(R({e,target:n,subTargets:s},Ii(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),i),n&&n.fire("mouse".concat(t),i);for(let a=0;a<s.length;a++)s[a]!==n&&s[a].fire("mouse".concat(t),i)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:n}=e;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),i=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,i=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(t){const a=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const c=t.findControl(this.getViewportPoint(e),fl(e));if(t===this._activeObject&&(c||!i)){this._setupCurrentTransform(e,t,a);const u=c?c.control:void 0,h=this.getScenePoint(e),d=u&&u.getMouseDownHandler(e,t,u);d&&d.call(u,e,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=Fn(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("mouse",{e,target:i[c],oldTarget:s[c]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,a=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",R(R({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let c=0;c<a;c++)this.fireSyntheticInOutEvents("drag",R(R({},t),{},{target:i[c],oldTarget:s[c]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:s,fireCanvas:i,e:a}=t,c=it(t,x6);const{targetIn:u,targetOut:h,canvasIn:d,canvasOut:p}=_6[e],g=s!==n;if(s&&g){const y=R(R({},c),{},{e:a,target:s,nextTarget:n},Ii(this,a));i&&this.fire(p,y),s.fire(h,y)}if(n&&g){const y=R(R({},c),{},{e:a,target:n,previousTarget:s},Ii(this,a));i&&this.fire(d,y),n.fire(u,y)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,s=n.target,i=s.group?Fn(t,void 0,s.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,i),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:s,actionHandler:i,target:a}=t,c=!!i&&i(e,t,n.x,n.y);c&&a.setCoords(),s==="drag"&&c&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||c}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const s=Fs(this._activeObject)?this._activeObject:null,i=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(i){const a=i.control;this.setCursor(a.cursorStyleHandler(e,a,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(a=>{n=a.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,s=Fs(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||s)&&(s||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(s){const i=n.getObjects();if(t===n){const a=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(i,a)||this.searchPossibleTargets(this._objects,a))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{n.isEditing&&n.exitEditing();const i=new(ne.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(n,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,a=new V(t,n),c=a.add(new V(s,i)),u=a.min(c),h=a.max(c).subtract(u),d=this.collectObjects({left:u.x,top:u.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),p=a.eq(c)?d[0]?[d[0]]:[]:d.length>1?d.filter(g=>!g.onSelect({e})).reverse():d;if(p.length===1)this.setActiveObject(p[0],e);else if(p.length>1){const g=ne.getClass("ActiveSelection");this.setActiveObject(new g(p,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Tx={x1:0,y1:0,x2:0,y2:0},S6=R(R({},Tx),{},{r1:0,r2:0}),Pi=(r,e)=>isNaN(r)&&typeof e=="number"?e:r,C6=/^(\d+\.\d+)%|(\d+)%$/;function Ex(r){return r&&C6.test(r)}function kx(r,e){const t=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(Ex(r)?100:1):NaN;return Xs(0,Pi(t,e),1)}const T6=/\s*;\s*/,E6=/\s*:\s*/;function k6(r,e){let t,n;const s=r.getAttribute("style");if(s){const a=s.split(T6);a[a.length-1]===""&&a.pop();for(let c=a.length;c--;){const[u,h]=a[c].split(E6).map(d=>d.trim());u==="stop-color"?t=h:u==="stop-opacity"&&(n=h)}}const i=new Xe(t||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:kx(r.getAttribute("offset"),0),color:i.toRgb(),opacity:Pi(parseFloat(n||r.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function I6(r,e){const t=[],n=r.getElementsByTagName("stop"),s=kx(e,1);for(let i=n.length;i--;)t.push(k6(n[i],s));return t}function Ix(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function Ax(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Gr(r,e){return r.getAttribute(e)}function A6(r,e){return function(t,n){let s,{width:i,height:a,gradientUnits:c}=n;return Object.keys(t).reduce((u,h)=>{const d=t[h];return d==="Infinity"?s=1:d==="-Infinity"?s=0:(s=typeof d=="string"?parseFloat(d):d,typeof d=="string"&&Ex(d)&&(s*=.01,c==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(s*=i),h!=="y1"&&h!=="y2"||(s*=a)))),u[h]=s,u},{})}(Ix(r)==="linear"?function(t){return{x1:Gr(t,"x1")||0,y1:Gr(t,"y1")||0,x2:Gr(t,"x2")||"100%",y2:Gr(t,"y2")||0}}(r):function(t){return{x1:Gr(t,"fx")||Gr(t,"cx")||"50%",y1:Gr(t,"fy")||Gr(t,"cy")||"50%",r1:0,x2:Gr(t,"cx")||"50%",y2:Gr(t,"cy")||"50%",r2:Gr(t,"r")||"50%"}}(r),R(R({},e),{},{gradientUnits:Ax(r)}))}class Ec{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:s={},colorStops:i=[],offsetX:a=0,offsetY:c=0,gradientTransform:u,id:h}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:R(R({},t==="radial"?S6:Tx),s),colorStops:i,offsetX:a,offsetY:c,gradientTransform:u,id:h?"".concat(h,"_").concat(ls()):ls()})}addColorStop(e){for(const t in e){const n=new Xe(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return R(R({},ii(this,e)),{},{type:this.type,coords:R({},this.coords),colorStops:this.colorStops.map(t=>R({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():Jt.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",a=this.colorStops.map(p=>R({},p)).sort((p,g)=>p.offset-g.offset);let c=-this.offsetX,u=-this.offsetY;var h;i==="objectBoundingBox"?(c/=e.width,u/=e.height):(c+=e.width/2,u+=e.height/2),(h=e)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(c-=e.pathOffset.x,u-=e.pathOffset.y),s[4]-=c,s[5]-=u;const d=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(ra(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:p,y1:g,x2:y,y2:b}=this.coords;n.push("<linearGradient ",d,' x1="',p,'" y1="',g,'" x2="',y,'" y2="',b,`">
`)}else if(this.type==="radial"){const{x1:p,y1:g,x2:y,y2:b,r1:_,r2:S}=this.coords,T=_>S;n.push("<radialGradient ",d,' cx="',T?p:y,'" cy="',T?g:b,'" r="',T?_:S,'" fx="',T?y:p,'" fy="',T?b:g,`">
`),T&&(a.reverse(),a.forEach(I=>{I.offset=1-I.offset}));const k=Math.min(_,S);if(k>0){const I=k/Math.max(_,S);a.forEach(A=>{A.offset+=I*(1-A.offset)})}}return a.forEach(p=>{let{color:g,offset:y,opacity:b}=p;n.push("<stop ",'offset="',100*y+"%",'" style="stop-color:',g,b!==void 0?";stop-opacity: "+b:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:s,y2:i,r1:a,r2:c}=this.coords,u=this.type==="linear"?e.createLinearGradient(t,n,s,i):e.createRadialGradient(t,n,a,s,i,c);return this.colorStops.forEach(h=>{let{color:d,opacity:p,offset:g}=h;u.addColorStop(g,p!==void 0?new Xe(d).setAlpha(p).toRgba():d)}),u}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(R(R({},e),{},{colorStops:t?t.map(s=>R({},s)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const s=Ax(e),i=t._findCenterFromElement();return new this(R({id:e.getAttribute("id")||void 0,type:Ix(e),coords:A6(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:I6(e,n.opacity),gradientUnits:s,gradientTransform:Xd(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-i.x,offsetY:t.height/2-i.y}:{offsetX:0,offsetY:0}))}}j(Ec,"type","Gradient"),ne.setClass(Ec,"gradient"),ne.setClass(Ec,"linear"),ne.setClass(Ec,"radial");const O6=["type","source","patternTransform"];class Gh{get type(){return"pattern"}set type(e){as("warn","Setting type has no effect",e)}constructor(e){j(this,"repeat","repeat"),j(this,"offsetX",0),j(this,"offsetY",0),j(this,"crossOrigin",""),this.id=ls(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return R(R({},ii(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:st(this.offsetX,Ne.NUM_FRACTION_DIGITS),offsetY:st(this.offsetY,Ne.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:s,repeat:i,id:a}=this,c=Pi(this.offsetX/t,0),u=Pi(this.offsetY/n,0),h=i==="repeat-y"||i==="no-repeat"?1+Math.abs(c||0):Pi(s.width/t,0),d=i==="repeat-x"||i==="no-repeat"?1+Math.abs(u||0):Pi(s.height/n,0);return['<pattern id="SVGID_'.concat(a,'" x="').concat(c,'" y="').concat(u,'" width="').concat(h,'" height="').concat(d,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:s,patternTransform:i}=e,a=it(e,O6);const c=await $o(s,R(R({},t),{},{crossOrigin:a.crossOrigin}));return new this(R(R({},a),{},{patternTransform:i&&i.slice(0),source:c}))}}j(Gh,"type","Pattern"),ne.setClass(Gh),ne.setClass(Gh,"pattern");const M6=["path","left","top"],P6=["d"];class Ls extends Ke{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:i}=t,a=it(t,M6);super(),Object.assign(this,Ls.ownDefaults),this.setOptions(a),this._setPath(e||[],!0),typeof s=="number"&&this.set(Ue,s),typeof i=="number"&&this.set(lr,i)}_setPath(e,t){this.path=mx(Array.isArray(e)?e:_x(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new V(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+n);break;case"M":e.moveTo(s[1]+t,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n,s[5]+t,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=Sx(this.path,Ne.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Ne.NUM_FRACTION_DIGITS;return" translate(".concat(st(-this.pathOffset.x,e),", ").concat(st(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:s}=this._calcDimensions();this.set({width:t,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,Ee,Ee)}_calcBoundsFromPath(){const e=[];let t=0,n=0,s=0,i=0;for(const a of this.path)switch(a[0]){case"L":s=a[1],i=a[2],e.push({x:t,y:n},{x:s,y:i});break;case"M":s=a[1],i=a[2],t=s,n=i;break;case"C":e.push(...Kd(s,i,a[1],a[2],a[3],a[4],a[5],a[6])),s=a[5],i=a[6];break;case"Q":e.push(...Kd(s,i,a[1],a[2],a[1],a[2],a[3],a[4])),s=a[3],i=a[4];break;case"Z":s=t,i=n}return vn(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return R(R({},e),{},{pathOffset:new V(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const s=Hn(e,this.ATTRIBUTE_NAMES,n),{d:i}=s;return new this(i,R(R(R({},it(s,P6)),t),{},{left:void 0,top:void 0}))}}j(Ls,"type","Path"),j(Ls,"cacheProperties",[...Wn,"path","fillRule"]),j(Ls,"ATTRIBUTE_NAMES",[...ws,"d"]),ne.setClass(Ls),ne.setSVGClass(Ls);const D6=["left","top","radius"],Ox=["radius","startAngle","endAngle","counterClockwise"];class Pn extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Pn.ownDefaults)}constructor(e){super(),Object.assign(this,Pn.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,pt(this.startAngle),pt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Qt)}getRadiusY(){return this.get("radius")*this.get(Tr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Ox,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=pt(this.startAngle),s=pt(this.endAngle),i=en(n)*t,a=tn(n)*t,c=en(s)*t,u=tn(s)*t,h=e>180?1:0,d=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(a," A ").concat(t," ").concat(t," 0 ").concat(h," ").concat(d," ").concat(c," ").concat(u,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const s=Hn(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:a=0,radius:c=0}=s;return new this(R(R({},it(s,D6)),{},{radius:c,left:i-c,top:a-c}))}static fromObject(e){return super._fromObject(e)}}j(Pn,"type","Circle"),j(Pn,"cacheProperties",[...Wn,...Ox]),j(Pn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),j(Pn,"ATTRIBUTE_NAMES",["cx","cy","r",...ws]),ne.setClass(Pn),ne.setSVGClass(Pn);const R6=["x1","y1","x2","y2"],j6=["x1","y1","x2","y2"],Jd=["x1","x2","y1","y2"];class Ns extends Ke{constructor(){let[e,t,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Ns.ownDefaults),this.setOptions(i),this.x1=e,this.x2=n,this.y1=t,this.y2=s,this._setWidthHeight();const{left:a,top:c}=i;typeof a=="number"&&this.set(Ue,a),typeof c=="number"&&this.set(lr,c)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-t);const{left:i,top:a,width:c,height:u}=vn([{x:e,y:t},{x:n,y:s}]),h=new V(i+c/2,a+u/2);this.setPositionByOrigin(h,Ee,Ee)}_set(e,t){return super._set(e,t),Jd.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;Nr(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new V((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:s,width:i,height:a}=this,c=e<=t?-1:1,u=n<=s?-1:1;return{x1:c*i/2,x2:c*-i/2,y1:u*a/2,y2:u*-a/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,n){const s=Hn(e,this.ATTRIBUTE_NAMES,n),{x1:i=0,y1:a=0,x2:c=0,y2:u=0}=s;return new this([i,a,c,u],it(s,R6))}static fromObject(e){let{x1:t,y1:n,x2:s,y2:i}=e,a=it(e,j6);return this._fromObject(R(R({},a),{},{points:[t,n,s,i]}),{extraParam:"points"})}}j(Ns,"type","Line"),j(Ns,"cacheProperties",[...Wn,...Jd]),j(Ns,"ATTRIBUTE_NAMES",ws.concat(Jd)),ne.setClass(Ns),ne.setSVGClass(Ns);class Ws extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Ws.ownDefaults)}constructor(e){super(),Object.assign(this,Ws.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}j(Ws,"type","Triangle"),j(Ws,"ownDefaults",{width:100,height:100}),ne.setClass(Ws),ne.setSVGClass(Ws);const Mx=["rx","ry"];class Dn extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Dn.ownDefaults)}constructor(e){super(),Object.assign(this,Dn.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Qt)}getRy(){return this.get("ry")*this.get(Tr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Mx,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Vn,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const s=Hn(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function F6(r){if(!r)return[];const e=r.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}j(Dn,"type","Ellipse"),j(Dn,"cacheProperties",[...Wn,...Mx]),j(Dn,"ownDefaults",{rx:0,ry:0}),j(Dn,"ATTRIBUTE_NAMES",[...ws,"cx","cy","rx","ry"]),ne.setClass(Dn),ne.setSVGClass(Dn);const L6=["left","top"],Px={exactBoundingBox:!1};class qr extends Ke{static getDefaults(){return R(R({},super.getDefaults()),qr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),j(this,"strokeDiff",void 0),Object.assign(this,qr.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(Ue,n),typeof s=="number"&&this.set(lr,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return ax(this.points,e,this.isOpen())}_calcDimensions(e){e=R({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(h=>h.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new V,strokeOffset:new V,strokeDiff:new V};const n=vn(t),s=xa(R(R({},e),{},{scaleX:1,scaleY:1})),i=vn(this.points.map(h=>zt(h,s,!0))),a=new V(this.scaleX,this.scaleY);let c=n.left+n.width/2,u=n.top+n.height/2;return this.exactBoundingBox&&(c-=u*Math.tan(pt(this.skewX)),u-=c*Math.tan(pt(this.skewY))),R(R({},n),{},{pathOffset:new V(c,u),strokeOffset:new V(i.left,i.top).subtract(new V(n.left,n.top)).multiply(a),strokeDiff:new V(n.width,n.height).subtract(new V(i.width,i.height)).multiply(a)})}_findCenterFromElement(){const e=vn(this.points);return new V(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:s,height:i,pathOffset:a,strokeOffset:c,strokeDiff:u}=this._calcDimensions();this.set({width:s,height:i,pathOffset:a,strokeOffset:c,strokeDiff:u}),e&&this.setPositionByOrigin(new V(t+s/2,n+i/2),Ee,Ee)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new V(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let a;if(Object.keys(e).some(c=>this.strokeUniform||this.constructor.layoutProperties.includes(c))){var t,n;const{width:c,height:u}=this._calcDimensions(e);a=new V((t=e.width)!==null&&t!==void 0?t:c,(n=e.height)!==null&&n!==void 0?n:u)}else{var s,i;a=new V((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return a.multiply(new V(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&n&&((e===Qt||e===Tr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:n,y:s}=t;return{x:n,y:s}})})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,s=Ne.NUM_FRACTION_DIGITS;for(let i=0,a=this.points.length;i<a;i++)e.push(st(this.points[i].x-t,s),",",st(this.points[i].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let i=0;i<t;i++){const a=this.points[i];e.lineTo(a.x-n,a.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(F6(e.getAttribute("points")),R(R({},it(Hn(e,this.ATTRIBUTE_NAMES,n),L6)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}j(qr,"ownDefaults",Px),j(qr,"type","Polyline"),j(qr,"layoutProperties",[so,io,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),j(qr,"cacheProperties",[...Wn,"points"]),j(qr,"ATTRIBUTE_NAMES",[...ws]),ne.setClass(qr),ne.setSVGClass(qr);class kc extends qr{isOpen(){return!1}}j(kc,"ownDefaults",Px),j(kc,"type","Polygon"),ne.setClass(kc),ne.setSVGClass(kc);const Dx=["fontSize","fontWeight","fontFamily","fontStyle"],Rx=["underline","overline","linethrough"],jx=[...Dx,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Fx=[...jx,...Rx,"textBackgroundColor","direction"],N6=[...Dx,...Rx,hr,"strokeWidth",Ot,"deltaY","textBackgroundColor"],B6={_reNewline:ap,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Ue,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Ue,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},dn="justify",_l="justify-left",Yo="justify-right",Xo="justify-center";class Lx extends Ke{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const s in t[n])for(const i in t[n][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const s in n)for(const i in n[s])if(n[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,s,i=0,a=!0,c=0;for(const u in t){n=0;for(const h in t[u]){const d=t[u][h]||{};i++,d[e]!==void 0?(s?d[e]!==s&&(a=!1):s=d[e],d[e]===this[e]&&delete d[e]):a=!1,Object.keys(d).length!==0?n++:delete t[u][h]}n===0&&delete t[u]}for(let u=0;u<this._textLines.length;u++)c+=this._textLines[u].length;a&&i===c&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,s,i;for(s in t){for(i in n=t[s],n)delete n[i][e],Object.keys(n[i]).length===0&&delete n[i];Object.keys(n).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const i=fp(R(R({},this._getStyleDeclaration(n,s)),t),a=>a!==void 0);this._setStyleDeclaration(n,s,i)}getSelectionStyles(e,t,n){const s=[];for(let i=e;i<(t||e);i++)s.push(this.getStyleAtPosition(i,n));return s}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,t,n){for(let s=t;s<(n||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const s=this.styles&&this.styles[e];return s&&(n=s[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return R(R({},ii(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}j(Lx,"_styleProperties",N6);const V6=/  +/g,z6=/"/g;function qh(r,e,t,n,s){return"		".concat(function(i,a){let{left:c,top:u,width:h,height:d}=a,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ne.NUM_FRACTION_DIGITS;const g=na(Ot,i,!1),[y,b,_,S]=[c,u,h,d].map(T=>st(T,p));return"<rect ".concat(g,' x="').concat(y,'" y="').concat(b,'" width="').concat(_,'" height="').concat(S,'"></rect>')}(r,{left:e,top:t,width:n,height:s}),`
`)}const W6=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Kh;class qt extends Lx{static getDefaults(){return R(R({},super.getDefaults()),qt.ownDefaults)}constructor(e,t){super(),j(this,"__charBounds",[]),Object.assign(this,qt.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Ep(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(dn)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,s,i,a,c;for(let u=0,h=this._textLines.length;u<h;u++)if((this.textAlign===dn||u!==h-1&&!this.isEndOfWrapping(u))&&(s=0,i=this._textLines[u],t=this.getLineWidth(u),t<this.width&&(c=this.textLines[u].match(this._reSpacesAndTabs)))){n=c.length,e=(this.width-t)/n;for(let d=0;d<=i.length;d++)a=this.__charBounds[u][d],this._reSpaceAndTab.test(i[d])?(a.width+=e,a.kernedWidth+=e,a.left+=s,s+=e):a.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===hr?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Ee:e.textBaseline="middle";break;case"ascender":e.textBaseline=lr;break;case"descender":e.textBaseline=Nd}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,n,s,i,a){this._renderChars(e,t,n,s,i,a)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,a=this._textLines.length;i<a;i++){const c=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=c;continue}const u=this._textLines[i].length,h=this._getLineLeftOffset(i);let d,p,g=0,y=0,b=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let _=0;_<u;_++){const S=this.__charBounds[i][_];p=this.getValueOfPropertyAt(i,_,"textBackgroundColor"),this.path?(e.save(),e.translate(S.renderLeft,S.renderTop),e.rotate(S.angle),e.fillStyle=p,p&&e.fillRect(-S.width/2,-c/this.lineHeight*(1-this._fontSizeFraction),S.width,c/this.lineHeight),e.restore()):p!==b?(d=n+h+y,this.direction==="rtl"&&(d=this.width-d-g),e.fillStyle=b,b&&e.fillRect(d,s,g,c/this.lineHeight),y=S.left,g=S.width,b=p):g+=S.kernedWidth}p&&!this.path&&(d=n+h+y,this.direction==="rtl"&&(d=this.width-d-g),e.fillStyle=p,e.fillRect(d,s,g,c/this.lineHeight)),s+=c}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,s){const i=Ho.getFontCache(t),a=this._getFontDeclaration(t),c=n+e,u=n&&a===this._getFontDeclaration(s),h=t.fontSize/this.CACHE_FONT_SIZE;let d,p,g,y;if(n&&i[n]!==void 0&&(g=i[n]),i[e]!==void 0&&(y=d=i[e]),u&&i[c]!==void 0&&(p=i[c],y=p-g),d===void 0||g===void 0||p===void 0){const b=function(){return Kh||(Kh=rn({width:0,height:0}).getContext("2d")),Kh}();this._setTextStyles(b,t,!0),d===void 0&&(y=d=b.measureText(e).width,i[e]=d),g===void 0&&u&&n&&(g=b.measureText(n).width,i[n]=g),u&&p===void 0&&(p=b.measureText(c).width,i[c]=p,y=p-g)}return{width:d*h,kernedWidth:y*h}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,s=0;const i=this.pathSide===bt,a=this.path,c=this._textLines[e],u=c.length,h=new Array(u);this.__charBounds[e]=h;for(let d=0;d<u;d++){const p=c[d];n=this._getGraphemeBox(p,e,d,t),h[d]=n,s+=n.kernedWidth,t=p}if(h[u]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},a&&a.segmentsInfo){let d=0;const p=a.segmentsInfo[a.segmentsInfo.length-1].length;switch(this.textAlign){case Ue:d=i?p-s:0;break;case Ee:d=(p-s)/2;break;case bt:d=i?0:p-s}d+=this.pathStartOffset*(i?-1:1);for(let g=i?u-1:0;i?g>=0:g<u;i?g--:g++)n=h[g],d>p?d%=p:d<0&&(d+=p),this._setGraphemeOnPath(d,n),d+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,s=this.path,i=xx(s.path,n,s.segmentsInfo);t.renderLeft=i.x-s.pathOffset.x,t.renderTop=i.y-s.pathOffset.y,t.angle=i.angle+(this.pathSide===bt?Math.PI:0)}_getGraphemeBox(e,t,n,s,i){const a=this.getCompleteStyleDeclaration(t,n),c=s?this.getCompleteStyleDeclaration(t,n-1):{},u=this._measureChar(e,a,s,c);let h,d=u.kernedWidth,p=u.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),p+=h,d+=h);const g={width:p,left:0,height:a.fontSize,kernedWidth:d,deltaY:a.deltaY};if(n>0&&!i){const y=this.__charBounds[t][n-1];g.left=y.left+y.width+u.kernedWidth-u.width}return g}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,s=this._textLines.length;n<s;n++)e=this.getHeightOfLine(n),t+=n===s-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let a=0,c=this._textLines.length;a<c;a++){const u=this.getHeightOfLine(a),h=u/this.lineHeight,d=this._getLineLeftOffset(a);this._renderTextLine(t,e,this._textLines[a],s+d,i+n+h,a),n+=u}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Ot))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,s,i,a){const c=this.getHeightOfLine(a),u=this.textAlign.includes(dn),h=this.path,d=!u&&this.charSpacing===0&&this.isEmptyStyles(a)&&!h,p=this.direction==="ltr",g=this.direction==="ltr"?1:-1,y=t.direction;let b,_,S,T,k,I="",A=0;if(t.save(),y!==this.direction&&(t.canvas.setAttribute("dir",p?"ltr":"rtl"),t.direction=p?"ltr":"rtl",t.textAlign=p?Ue:bt),i-=c*this._fontSizeFraction/this.lineHeight,d)return this._renderChar(e,t,a,0,n.join(""),s,i),void t.restore();for(let D=0,F=n.length-1;D<=F;D++)T=D===F||this.charSpacing||h,I+=n[D],S=this.__charBounds[a][D],A===0?(s+=g*(S.kernedWidth-S.width),A+=S.width):A+=S.kernedWidth,u&&!T&&this._reSpaceAndTab.test(n[D])&&(T=!0),T||(b=b||this.getCompleteStyleDeclaration(a,D),_=this.getCompleteStyleDeclaration(a,D+1),T=iu(b,_,!1)),T&&(h?(t.save(),t.translate(S.renderLeft,S.renderTop),t.rotate(S.angle),this._renderChar(e,t,a,D,I,-A/2,0),t.restore()):(k=s,this._renderChar(e,t,a,D,I,k,i)),I="",b=_,s+=g*A,A=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=rn({width:t,height:n}),i=s.getContext("2d");return s.width=t,s.height=n,i.beginPath(),i.moveTo(0,0),i.lineTo(t,0),i.lineTo(t,n),i.lineTo(0,n),i.closePath(),i.translate(t/2,n/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,t,n){let s,i;return Nr(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[t]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:i}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,s,i,a,c){const u=this._getStyleDeclaration(n,s),h=this.getCompleteStyleDeclaration(n,s),d=e==="fillText"&&h.fill,p=e==="strokeText"&&h.stroke&&h.strokeWidth;if(p||d){if(t.save(),t.font=this._getFontDeclaration(h),u.textBackgroundColor&&this._removeShadow(t),u.deltaY&&(c+=u.deltaY),d){const g=this._setFillStyles(t,h);t.fillText(i,a-g.offsetX,c-g.offsetY)}if(p){const g=this._setStrokeStyles(t,h);t.strokeText(i,a-g.offsetX,c-g.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),a=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),c={fontSize:i*n.size,deltaY:a+i*n.baseline};this.setSelectionStyles(c,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,s=this.textAlign,i=this.direction,a=this.isEndOfWrapping(e);let c=0;return s===dn||s===Xo&&!a||s===Yo&&!a||s===_l&&!a?0:(s===Ee&&(c=n/2),s===bt&&(c=n),s===Xo&&(c=n/2),s===Yo&&(c=n),i==="rtl"&&(s===bt||s===dn||s===Yo?c=0:s===Ue||s===_l?c=-n:s!==Ee&&s!==Xo||(c=-n/2)),c)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var s;return(s=this._getStyleDeclaration(e,t)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,a=this._getWidthOfCharSpacing(),c=this.offsets[t];for(let u=0,h=this._textLines.length;u<h;u++){const d=this.getHeightOfLine(u);if(!this[t]&&!this.styleHas(t,u)){n+=d;continue}const p=this._textLines[u],g=d/this.lineHeight,y=this._getLineLeftOffset(u);let b,_,S=0,T=0,k=this.getValueOfPropertyAt(u,0,t),I=this.getValueOfPropertyAt(u,0,Ot);const A=n+g*(1-this._fontSizeFraction);let D=this.getHeightOfChar(u,0),F=this.getValueOfPropertyAt(u,0,"deltaY");for(let L=0,Y=p.length;L<Y;L++){const W=this.__charBounds[u][L];b=this.getValueOfPropertyAt(u,L,t),_=this.getValueOfPropertyAt(u,L,Ot);const q=this.getHeightOfChar(u,L),U=this.getValueOfPropertyAt(u,L,"deltaY");if(i&&b&&_)e.save(),e.fillStyle=I,e.translate(W.renderLeft,W.renderTop),e.rotate(W.angle),e.fillRect(-W.kernedWidth/2,c*q+U,W.kernedWidth,this.fontSize/15),e.restore();else if((b!==k||_!==I||q!==D||U!==F)&&T>0){let X=s+y+S;this.direction==="rtl"&&(X=this.width-X-T),k&&I&&(e.fillStyle=I,e.fillRect(X,A+c*D+F,T,this.fontSize/15)),S=W.left,T=W.width,k=b,I=_,D=q,F=U}else T+=W.kernedWidth}let z=s+y+S;this.direction==="rtl"&&(z=this.width-z-T),e.fillStyle=_,b&&_&&e.fillRect(z,A+c*D+F,T-a,this.fontSize/15),n+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const a=e.includes("'")||e.includes('"')||e.includes(",")||qt.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),a].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return su(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),s=[`
`];let i=[];for(let a=0;a<t.length;a++)n[a]=this.graphemeSplit(t[a]),i=i.concat(n[a],s);return i.pop(),{_unwrappedLines:n,lines:t,graphemeText:i,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R(R({},super.toObject([...Fx,...e])),{},{styles:lx(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let s=!1,i=!1;if(typeof e=="object")for(const a in e)a==="path"&&this.setPathInfo(),s=s||n.includes(a),i=i||a==="path";else s=n.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const s=Hn(e,qt.ATTRIBUTE_NAMES,n),i=R(R({},t),s),{textAnchor:a=Ue,textDecoration:c="",dx:u=0,dy:h=0,top:d=0,left:p=0,fontSize:g=op,strokeWidth:y=1}=i,b=it(i,W6),_=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),R({left:p+u,top:d+h,underline:c.includes("underline"),overline:c.includes("overline"),linethrough:c.includes("line-through"),strokeWidth:0,fontSize:g},b)),S=_.getScaledHeight()/_.height,T=((_.height+_.strokeWidth)*_.lineHeight-_.height)*S,k=_.getScaledHeight()+T;let I=0;return a===Ee&&(I=_.getScaledWidth()/2),a===bt&&(I=_.getScaledWidth()),_.set({left:_.left-I,top:_.top-(k-_.fontSize*(.07+_._fontSizeFraction))/_.lineHeight,strokeWidth:y}),_}static fromObject(e){return this._fromObject(R(R({},e),{},{styles:ux(e.styles||{},e.text)}),{extraParam:"text"})}}j(qt,"textLayoutProperties",jx),j(qt,"cacheProperties",[...Wn,...Fx]),j(qt,"ownDefaults",B6),j(qt,"type","Text"),j(qt,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),j(qt,"ATTRIBUTE_NAMES",ws.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),sx(qt,[class extends Nw{_toSVG(){const r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){return this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:t}=r;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(z6,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(r,e){const t=[],n=[];let s,i=r;this.backgroundColor&&n.push(...qh(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let a=0,c=this._textLines.length;a<c;a++)s=this._getLineLeftOffset(a),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(n,a,e+s,i),this._setSVGTextLineText(t,a,e+s,i),i+=this.getHeightOfLine(a);return{textSpans:t,textBgRects:n}}_createTextCharSpan(r,e,t,n){const s=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(V6)),i=s?'style="'.concat(s,'"'):"",a=e.deltaY,c=a?' dy="'.concat(st(a,Ne.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(st(t,Ne.NUM_FRACTION_DIGITS),'" y="').concat(st(n,Ne.NUM_FRACTION_DIGITS),'" ').concat(c).concat(i,">").concat(cx(r),"</tspan>")}_setSVGTextLineText(r,e,t,n){const s=this.getHeightOfLine(e),i=this.textAlign.includes(dn),a=this._textLines[e];let c,u,h,d,p,g="",y=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let b=0,_=a.length-1;b<=_;b++)p=b===_||this.charSpacing,g+=a[b],h=this.__charBounds[e][b],y===0?(t+=h.kernedWidth-h.width,y+=h.width):y+=h.kernedWidth,i&&!p&&this._reSpaceAndTab.test(a[b])&&(p=!0),p||(c=c||this.getCompleteStyleDeclaration(e,b),u=this.getCompleteStyleDeclaration(e,b+1),p=iu(c,u,!0)),p&&(d=this._getStyleDeclaration(e,b),r.push(this._createTextCharSpan(g,d,t,n)),g="",c=u,this.direction==="rtl"?t-=y:t+=y,y=0)}_setSVGTextLineBg(r,e,t,n){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let a,c=0,u=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let d=0;d<s.length;d++){const{left:p,width:g,kernedWidth:y}=this.__charBounds[e][d];a=this.getValueOfPropertyAt(e,d,"textBackgroundColor"),a!==h?(h&&r.push(...qh(h,t+u,n,c,i)),u=p,c=g,h=a):c+=y}a&&r.push(...qh(h,t+u,n,c,i))}_getSVGLineTopOffset(r){let e,t=0;for(e=0;e<r;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," white-space: pre;")}getSvgSpanStyles(r,e){const{fontFamily:t,strokeWidth:n,stroke:s,fill:i,fontSize:a,fontStyle:c,fontWeight:u,deltaY:h}=r,d=this.getSvgTextDecoration(r);return[s?na(hr,s):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",a?"font-size: ".concat(a,"px; "):"",c?"font-style: ".concat(c,"; "):"",u?"font-weight: ".concat(u,"; "):"",d&&"text-decoration: ".concat(d,"; "),i?na(Ot,i):"",h?"baseline-shift: ".concat(-h,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(e=>r[e.replace("-","")]).join(" ")}}]),ne.setClass(qt),ne.setSVGClass(qt);class H6{constructor(e){j(this,"target",void 0),j(this,"__mouseDownInPlace",!1),j(this,"__dragStartFired",!1),j(this,"__isDraggingOver",!1),j(this,"__dragStartSelection",void 0),j(this,"__dragImageDisposer",void 0),j(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:s,selectionEnd:i}=t;const a=this.target,c=a.canvas,u=new V(a.flipX?-1:1,a.flipY?-1:1),h=a._getCursorBoundaries(s),d=new V(h.left+h.leftOffset,h.top+h.topOffset).multiply(u).transform(a.calcTransformMatrix()),p=c.getScenePoint(e).subtract(d),g=a.getCanvasRetinaScaling(),y=a.getBoundingRect(),b=d.subtract(new V(y.left,y.top)),_=c.viewportTransform,S=b.add(p).transform(_,!0),T=a.backgroundColor,k=Sp(a.styles);a.backgroundColor="";const I={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};a.setSelectionStyles(I,0,s),a.setSelectionStyles(I,i,a.text.length),a.dirty=!0;const A=a.toCanvasElement({enableRetinaScaling:c.enableRetinaScaling,viewportTransform:!0});a.backgroundColor=T,a.styles=k,a.dirty=!0,xl(A,{position:"fixed",left:"".concat(-A.width,"px"),border:ur,width:"".concat(A.width/g,"px"),height:"".concat(A.height/g,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{A.remove()},Kr(e.target||this.target.hiddenTextarea).body.appendChild(A),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(A,S.x,S.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(s.selectionStart,s.selectionEnd).join(""),a=R({text:t.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,a)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let i=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(i&&!s){const a=this.target,c=a.canvas;let u=a.getSelectionStartFromPointer(n);const{styles:h}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},d=i[Math.max(0,i.length-1)],p=0;if(this.__dragStartSelection){const g=this.__dragStartSelection.selectionStart,y=this.__dragStartSelection.selectionEnd;u>g&&u<=y?u=g:u>y&&(u-=y-g),a.removeChars(g,y),delete this.__dragStartSelection}a._reNewline.test(d)&&(a._reNewline.test(a._text[u])||u===a._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=a,a.insertChars(i,h,u),c.setActiveObject(a),a.enterEditing(n),a.selectionStart=Math.min(u+p,a._text.length),a.selectionEnd=Math.min(a.selectionStart+i.length,a._text.length),a.hiddenTextarea.value=a.text,a._updateTextarea(),a.hiddenTextarea.focus(),a.fire(ul,{index:u+p,action:"drop"}),c.fire("text:changed",{target:a}),c.contextTopDirty=!0,c.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,i=this.target.canvas,{selectionStart:a,selectionEnd:c}=this.__dragStartSelection,u=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||ur;u===ur?(s.selectionStart=a,s.selectionEnd=c,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),u==="move"&&(s.removeChars(a,c),s.selectionStart=s.selectionEnd=a,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(ul,{index:a,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const H0=/[ \n\.,;!\?\-]/;class U6 extends qt{constructor(){super(...arguments),j(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:s,onComplete:i}=e;return wp({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:a=>{this._currentCursorOpacity=a,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(t===-1||!ap.test(n[e-1]))?e-1:e,i=n[s];for(;s>0&&s<n.length&&!H0.test(i);)s+=t,i=n[s];return t===-1&&H0.test(i)&&s++,s}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Kr(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==i||s!==n&&i!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const s=n.slice(0,e),i=this.graphemeSplit(s).length;if(e===t)return{selectionStart:i,selectionEnd:i};const a=n.slice(e,t);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(a).length}}fromGraphemeToStringSelection(e,t,n){const s=n.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex,a=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,c=t.leftOffset,u=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,p=h.height/u,g=d-a,y=p-a,b=new V(t.left+c,t.top+t.topOffset+a).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new V(h.clientWidth/d,h.clientHeight/p));return b.x<0&&(b.x=0),b.x>g&&(b.x=g),b.y<0&&(b.y=0),b.y>y&&(b.y=y),b.x+=this.canvas._offset.left,b.y+=this.canvas._offset.top,{left:"".concat(b.x,"px"),top:"".concat(b.y,"px"),fontSize:"".concat(a,"px"),charHeight:a}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(hl),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:a}=this.get2DCursorLocation(t,!0);if(n!==i){if(this.styles[n])for(let c=s;c<this._unwrappedTextLines[n].length;c++)delete this.styles[n][c];if(this.styles[i])for(let c=a;c<this._unwrappedTextLines[i].length;c++){const u=this.styles[i][c];u&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+c-a]=u)}for(let c=n+1;c<=i;c++)delete this.styles[c];this.shiftLineStyles(i,n-i)}else if(this.styles[n]){const c=this.styles[n],u=a-s;for(let h=s;h<a;h++)delete c[h];for(const h in this.styles[n]){const d=parseInt(h,10);d>=a&&(c[d-u]=c[h],delete c[h])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+t]=n[i],n[i-t]||delete this.styles[i])}}insertNewlineStyleObject(e,t,n,s){const i={},a=this._unwrappedTextLines[e].length,c=a===t;let u=!1;n||(n=1),this.shiftLineStyles(e,n);const h=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const p in this.styles[e]){const g=parseInt(p,10);g>=t&&(u=!0,i[g-t]=this.styles[e][p],c&&t===0||delete this.styles[e][p])}let d=!1;for(u&&!c&&(this.styles[e+n]=i,d=!0),(d||a>t)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:R({},s[n-1])}:h?this.styles[e+n]={0:R({},h)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,s){this.styles||(this.styles={});const i=this.styles[e],a=i?R({},i):{};n||(n=1);for(const u in a){const h=parseInt(u,10);h>=t&&(i[h+n]=a[h],a[h-n]||delete i[h])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=R({},s[n]));return}if(!i)return;const c=i[t?t-1:1];for(;c&&n--;)this.styles[e][t+n]=R({},c)}insertNewStyleBlock(e,t,n){const s=this.get2DCursorLocation(t,!0),i=[0];let a,c=0;for(let u=0;u<e.length;u++)e[u]===`
`?(c++,i[c]=0):i[c]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),c&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],c),a=1;a<c;a++)i[a]>0?this.insertCharStyleObject(s.lineIndex+a,0,i[a],n):n&&this.styles[s.lineIndex+a]&&n[0]&&(this.styles[s.lineIndex+a][0]=n[0]),n=n&&n.slice(i[a]+1);i[a]>0&&this.insertCharStyleObject(s.lineIndex+a,0,i[a],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,n,t),this._text=[...this._text.slice(0,n),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Ue:this._selectionDirection===bt&&(this._selectionDirection=Ue,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===bt?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=bt:this._selectionDirection===Ue&&(this._selectionDirection=bt,this.selectionStart=t),this.selectionEnd=n)}}class $6 extends U6{initHiddenTextarea(){const e=this.canvas&&Kr(this.canvas.getElement())||no(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(a=>{let[c,u]=a;return t.setAttribute(c,u)});const{top:n,left:s,fontSize:i}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(a=>{let[c,u]=a;return t.addEventListener(c,this[u].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const n=()=>{this.updateFromTextArea(),this.fire(ul),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void n();const s=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,i=this._text.length,a=s.length,c=this.selectionStart,u=this.selectionEnd,h=c!==u;let d,p,g,y,b=a-i;const _=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),S=c>_.selectionStart;h?(p=this._text.slice(c,u),b+=u-c):a<i&&(p=S?this._text.slice(u+b,u):this._text.slice(c,c-b));const T=s.slice(_.selectionEnd-b,_.selectionEnd);if(p&&p.length&&(T.length&&(d=this.getSelectionStyles(c,c+1,!1),d=T.map(()=>d[0])),h?(g=c,y=u):S?(g=u-p.length,y=u):(g=u,y=u+p.length),this.removeStyleFromTo(g,y)),T.length){const{copyPasteData:k}=yn();t&&T.join("")===k.copiedText&&!Ne.disableStyleCopyPaste&&(d=k.copiedTextStyle),this.insertNewStyleBlock(T,c,d)}n()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:s}=t;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=yn();e.copiedText=this.getSelectedText(),Ne.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,s=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],s+=n.left+n.width),s}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const a=s.charIndex,c=this._getWidthBeforeCursor(i,a),u=this._getIndexOnLine(i+1,c);return this._textLines[i].slice(a).length+u+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-n;const a=s.charIndex,c=this._getWidthBeforeCursor(i,a),u=this._getIndexOnLine(i-1,c),h=this._textLines[i].slice(0,a),d=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+u-h.length+(1-d)}_getIndexOnLine(e,t){const n=this._textLines[e];let s,i,a=this._getLineLeftOffset(e),c=0;for(let u=0,h=n.length;u<h;u++)if(s=this.__charBounds[e][u].width,a+=s,a>t){i=!0;const d=a-s,p=a,g=Math.abs(d-t);c=Math.abs(p-t)<g?u:u-1;break}return i||(c=n.length-1),c}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===bt);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=Xs(0,this.selectionStart,s),this.selectionEnd=Xs(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Ue?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Ue,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===bt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Ue,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Ue&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=bt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=bt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Zh=r=>!!r.button;class Y6 extends $6{constructor(){super(...arguments),j(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new H6(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),Vd(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!Zh(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!Zh(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:n}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Zh(t)||s||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Cr(this.calcTransformMatrix())).add(new V(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,i=0;for(let h=0;h<this._textLines.length&&n<=t.y;h++)n+=this.getHeightOfLine(h),i=h,h>0&&(s+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let a=Math.abs(this._getLineLeftOffset(i));const c=this._textLines[i].length,u=this.__charBounds[i];for(let h=0;h<c;h++){const d=a+u[h].kernedWidth;if(t.x<=d){Math.abs(t.x-d)<=Math.abs(t.x-a)&&s++;break}a=d,s++}return Math.min(this.flipX?c-s:s,this._text.length)}}const Ic="moveCursorUp",Ac="moveCursorDown",Oc="moveCursorLeft",Mc="moveCursorRight",Pc="exitEditing",X6=R({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Pc,27:Pc,33:Ic,34:Ac,35:Mc,36:Oc,37:Oc,38:Ic,39:Mc,40:Ac},keysMapRtl:{9:Pc,27:Pc,33:Ic,34:Ac,35:Oc,36:Mc,37:Mc,38:Ic,39:Oc,40:Ac},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class jn extends Y6{static getDefaults(){return R(R({},super.getDefaults()),jn.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,R(R({},jn.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Zd&&this.canvas.textEditingManager.remove(this),t instanceof Zd&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,t);return{left:n,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let h=0;h<i;h++)t+=this.getHeightOfLine(h);const a=this._getLineLeftOffset(i),c=this.__charBounds[i][s];c&&(n=c.left),this.charSpacing!==0&&s===this._textLines[i].length&&(n-=this._getWidthOfCharSpacing());const u={top:t,left:a+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===bt||this.textAlign===dn||this.textAlign===Yo?u.left*=-1:this.textAlign===Ue||this.textAlign===_l?u.left=a-(n>0?n:0):this.textAlign!==Ee&&this.textAlign!==Xo||(u.left=a-(n>0?n:0))),u}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,a=this.getValueOfPropertyAt(s,i,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/c,h=this.getValueOfPropertyAt(s,i,"deltaY"),d=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-a*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-u/2,top:d+t.top+h,width:u,height:a}}_renderCursor(e,t,n){const{color:s,opacity:i,left:a,top:c,width:u,height:h}=this.getCursorRenderingData(n,t);e.fillStyle=s,e.globalAlpha=i,e.fillRect(a,c,u,h)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const s=t.selectionStart,i=t.selectionEnd,a=this.textAlign.includes(dn),c=this.get2DCursorLocation(s),u=this.get2DCursorLocation(i),h=c.lineIndex,d=u.lineIndex,p=c.charIndex<0?0:c.charIndex,g=u.charIndex<0?0:u.charIndex;for(let y=h;y<=d;y++){const b=this._getLineLeftOffset(y)||0;let _=this.getHeightOfLine(y),S=0,T=0,k=0;if(y===h&&(T=this.__charBounds[h][p].left),y>=h&&y<d)k=a&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===d)if(g===0)k=this.__charBounds[d][g].left;else{const z=this._getWidthOfCharSpacing();k=this.__charBounds[d][g-1].left+this.__charBounds[d][g-1].width-z}S=_,(this.lineHeight<1||y===d&&this.lineHeight>1)&&(_/=this.lineHeight);let I=n.left+b+T,A=_,D=0;const F=k-T;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",A=1,D=_):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===bt||this.textAlign===dn||this.textAlign===Yo?I=this.width-I-F:this.textAlign===Ue||this.textAlign===_l?I=n.left+b-k:this.textAlign!==Ee&&this.textAlign!==Xo||(I=n.left+b-k)),e.fillRect(I,n.top+n.topOffset+D,F,A),n.topOffset+=S}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Ot)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}j(jn,"ownDefaults",X6),j(jn,"type","IText"),ne.setClass(jn),ne.setClass(jn,"i-text");class Hs extends jn{static getDefaults(){return R(R({},super.getDefaults()),Hs.ownDefaults)}constructor(e,t){super(e,R(R({},Hs.ownDefaults),t))}static createControls(){return{controls:nx()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(dn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,s=0;const i={};for(let a=0;a<e.graphemeLines.length;a++)e.graphemeText[s]===`
`&&a>0?(n=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&a>0&&(n++,s++),i[a]={line:t,offset:n},s+=e.graphemeLines[a].length,n+=e.graphemeLines[a].length;return i}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,s=e+1,i=!1;const a=this._styleMap[e],c=this._styleMap[e+1];a&&(e=a.line,n=a.offset),c&&(s=c.line,i=s===e,t=c.offset);const u=e===void 0?this.styles:{line:this.styles[e]};for(const h in u)for(const d in u[h]){const p=parseInt(d,10);if(p>=n&&(!i||p<t))for(const g in u[h][d])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<n.wordsData.length;i++)s.push(...this._wrapLine(i,t,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let s=0;return{wordsData:e.map((i,a)=>{let c=0;const u=t?this.graphemeSplit(i):this.wordSplit(i);return u.length===0?[{word:[],width:0}]:u.map(h=>{const d=t?[h]:this.graphemeSplit(h),p=this._measureWord(d,a,c);return s=Math.max(p,s),c+=d.length+n.length,{word:d,width:p}})}),largestWordWidth:s}}_measureWord(e,t){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let a=0,c=e.length;a<c;a++)i+=this._getGraphemeBox(e[a],t,a+s,n,!0).kernedWidth,n=e[a];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:s,wordsData:i}=n,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const c=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,h=[],d=u?"":" ";let p=0,g=[],y=0,b=0,_=!0;t-=a;const S=Math.max(t,s,this.dynamicMinWidth),T=i[e];let k;for(y=0,k=0;k<T.length;k++){const{word:I,width:A}=T[k];y+=I.length,p+=b+A-c,p>S&&!_?(h.push(g),g=[],p=A,_=!0):p+=c,_||u||g.push(d),g=g.concat(I),b=u?0:this._measureWord([d],e,y),y++,_=!1}return k&&h.push(g),s+a>this.dynamicMinWidth&&(this.dynamicMinWidth=s-c+a),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),s=new Array(n.length);for(let i=0;i<n.length;i++)s[i]=n[i].join("");return t.lines=s,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}j(Hs,"type","Textbox"),j(Hs,"textLayoutProperties",[...jn.textLayoutProperties,"width"]),j(Hs,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ne.setClass(Hs);class U0 extends ou{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:s,group:i}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:a,height:c}=vn(dx(n,s)),u=new V(a,c);if(s.absolutePositioned)return{center:Fn(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:u};{const h=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:d=new V,correction:p=new V}=this.calcBoundingBox(t,e)||{};return{center:d.add(h),correction:p.subtract(h),size:u}}return{center:n.getRelativeCenterPoint().add(h),size:u}}}}j(U0,"type","clip-path"),ne.setClass(U0);class $0 extends ou{getInitialSize(e,t){let{target:n}=e,{size:s}=t;return new V(n.width||s.x,n.height||s.y)}}j($0,"type","fixed"),ne.setClass($0);class G6 extends ia{subscribeTargets(e){const t=e.target;e.targets.reduce((n,s)=>(s.parent&&n.add(s.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!n.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})})}}class gn extends Br{static getDefaults(){return R(R({},super.getDefaults()),gn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,gn.ownDefaults),this.setOptions(t);const{left:n,top:s,layoutManager:i}=t;this.groupInit(e,{left:n,top:s,layoutManager:i??new G6})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(s=>{const i=this._objects.findIndex(c=>c.isInFrontOf(s)),a=i===-1?this.size():i;this.insertAt(a,s)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(as("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach(s=>{const{parent:i}=s;i&&n.add(i)}),e===Tp?n.forEach(s=>{s._onAfterObjectsChange(yl,t)}):n.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=R(R({hasControls:!1},n),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,t),e.restore()}}j(gn,"type","ActiveSelection"),j(gn,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ne.setClass(gn),ne.setClass(gn,"activeSelection");class q6{constructor(){j(this,"resources",{})}applyFilters(e,t,n,s,i){const a=i.getContext("2d");if(!a)return;a.drawImage(t,0,0,n,s);const c={sourceWidth:n,sourceHeight:s,imageData:a.getImageData(0,0,n,s),originalEl:t,originalImageData:a.getImageData(0,0,n,s),canvasEl:i,ctx:a,filterBackend:this};e.forEach(h=>{h.applyTo(c)});const{imageData:u}=c;return u.width===n&&u.height===s||(i.width=u.width,i.height=u.height),a.putImageData(u,0,0),c}}class Nx{constructor(){let{tileSize:e=Ne.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),j(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=rn({width:e,height:t}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,t,n,s,i,a){const c=this.gl,u=i.getContext("2d");if(!c||!u)return;let h;a&&(h=this.getCachedTexture(a,t));const d={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:c,sourceTexture:this.createTexture(c,n,s,h?void 0:t),targetTexture:this.createTexture(c,n,s),originalTexture:h||this.createTexture(c,n,s,h?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},p=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,p),e.forEach(g=>{g&&g.applyTo(d)}),function(g){const y=g.targetCanvas,b=y.width,_=y.height,S=g.destinationWidth,T=g.destinationHeight;b===S&&_===T||(y.width=S,y.height=T)}(d),this.copyGLTo2D(c,d),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(d.sourceTexture),c.deleteTexture(d.targetTexture),c.deleteFramebuffer(p),u.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,s,i){const{NEAREST:a,TEXTURE_2D:c,RGBA:u,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:g,TEXTURE_WRAP_S:y,TEXTURE_WRAP_T:b}=e,_=e.createTexture();return e.bindTexture(c,_),e.texParameteri(c,p,i||a),e.texParameteri(c,g,i||a),e.texParameteri(c,y,d),e.texParameteri(c,b,d),s?e.texImage2D(c,0,u,u,h,s):e.texImage2D(c,0,u,t,n,0,u,h,null),_}getCachedTexture(e,t,n){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,t.width,t.height,t,n);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,s=t.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const a=n.height-s.height;i.drawImage(n,0,a,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),s=t.destinationWidth,i=t.destinationHeight,a=s*i*4;if(!n)return;const c=new Uint8Array(this.imageBuffer,0,a),u=new Uint8ClampedArray(this.imageBuffer,0,a);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,c);const h=new ImageData(u,s,i);n.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),i=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),i&&(t.vendor=i.toLowerCase())}return this.gpuInfo=t,t}}let Jh;function K6(){const{WebGLProbe:r}=yn();return r.queryWebGL(Vr()),Ne.enableGLFiltering&&r.isSupported(Ne.textureSize)?new Nx({tileSize:Ne.textureSize}):new q6}function Qh(){return!Jh&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Jh=K6()),Jh}const Z6=["filters","resizeFilter","src","crossOrigin","type"],Bx=["cropX","cropY"];class Lr extends Ke{static getDefaults(){return R(R({},super.getDefaults()),Lr.ownDefaults)}constructor(e,t){super(),j(this,"_lastScaleX",1),j(this,"_lastScaleY",1),j(this,"_filterScalingX",1),j(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Lr.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(ls()),this.setElement(typeof e=="string"?(this.canvas&&Kr(this.canvas.getElement())||no()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(Lr.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=Qh(!1);t instanceof Nx&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&yn().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),R(R({},super.toObject([...Bx,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,s=-this.height/2;let i=[],a=[],c="",u="";if(!t)return[];if(this.hasCrop()){const h=ls();i.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(u).concat(c,`></image>
`)),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,a=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=h}return i=this.paintFirst!==Ot?i.concat(a,e):i.concat(e,a),i}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $o(e,{crossOrigin:t,signal:n}).then(s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,i=n.y,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&i>t)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const c=rn(a),{width:u,height:h}=a;this._element=c,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,Qh().applyFilters([e],a,u,h,this._element),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const i=rn({width:n,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);Qh().applyFilters(e,this._originalElement,n,s,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,s=this._filterScalingY,i=this.width,a=this.height,c=Math.max(this.cropX,0),u=Math.max(this.cropY,0),h=t.naturalWidth||t.width,d=t.naturalHeight||t.height,p=c*n,g=u*s,y=Math.min(i*n,h-p),b=Math.min(a*s,d-g),_=-i/2,S=-a/2,T=Math.min(i,h/n-c),k=Math.min(a,d/s-u);t&&e.drawImage(t,p,g,y,b,_,S,T,k)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=Ew(this.preserveAspectRatio||""),t=this.width,n=this.height,s={width:t,height:n};let i,a=this._element.width,c=this._element.height,u=1,h=1,d=0,p=0,g=0,y=0;return!e||e.alignX===ur&&e.alignY===ur?(u=t/a,h=n/c):(e.meetOrSlice==="meet"&&(u=h=px(this._element,s),i=(t-a*u)/2,e.alignX==="Min"&&(d=-i),e.alignX==="Max"&&(d=i),i=(n-c*h)/2,e.alignY==="Min"&&(p=-i),e.alignY==="Max"&&(p=i)),e.meetOrSlice==="slice"&&(u=h=gx(this._element,s),i=a-t/u,e.alignX==="Mid"&&(g=i/2),e.alignX==="Max"&&(g=i),i=c-n/h,e.alignY==="Mid"&&(y=i/2),e.alignY==="Max"&&(y=i),a=t/u,c=n/h)),{width:a,height:c,scaleX:u,scaleY:h,offsetLeft:d,offsetTop:p,cropX:g,cropY:y}}static fromObject(e,t){let{filters:n,resizeFilter:s,src:i,crossOrigin:a,type:c}=e,u=it(e,Z6);return Promise.all([$o(i,R(R({},t),{},{crossOrigin:a})),n&&Vi(n,t),s&&Vi([s],t),_a(u,t)]).then(h=>{let[d,p=[],[g]=[],y={}]=h;return new this(d,R(R({},u),{},{src:i,filters:p,resizeFilter:g},y))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return $o(e,{crossOrigin:t,signal:n}).then(i=>new this(i,s))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=Hn(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"],t,s).catch(i=>(as("log","Unable to parse Image",i),null))}}j(Lr,"type","Image"),j(Lr,"cacheProperties",[...Wn,...Bx]),j(Lr,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),j(Lr,"CSS_CANVAS","canvas-img"),j(Lr,"ATTRIBUTE_NAMES",[...ws,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),ne.setClass(Lr),ne.setSVGClass(Lr);tu(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Vx=vw,Y0=r=>function(e,t,n){const{points:s,pathOffset:i}=n;return new V(s[r]).subtract(i).transform(gt(n.getViewportTransform(),n.calcTransformMatrix()))},zx=(r,e,t,n)=>{const{target:s,pointIndex:i}=e,a=s,c=Fn(new V(t,n),void 0,a.calcOwnMatrix());return a.points[i]=c.add(a.pathOffset),a.setDimensions(),!0},Wx=(r,e)=>function(t,n,s,i){const a=n.target,c=new V(a.points[(r>0?r:a.points.length)-1]),u=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()),h=e(t,R(R({},n),{},{pointIndex:r}),s,i),d=c.subtract(a.pathOffset).transform(a.calcOwnMatrix()).subtract(u);return a.left-=d.x,a.top-=d.y,h},X0=r=>bs(Vx,Wx(r,zx)),Qd=(r,e,t)=>{const{path:n,pathOffset:s}=r,i=n[e];return new V(i[t]-s.x,i[t+1]-s.y).transform(gt(r.getViewportTransform(),r.calcTransformMatrix()))};function J6(r,e,t){const{commandIndex:n,pointIndex:s}=this;return Qd(t,n,s)}function Q6(r,e,t,n){const{target:s}=e,{commandIndex:i,pointIndex:a}=this,c=((u,h,d,p,g)=>{const{path:y,pathOffset:b}=u,_=y[(p>0?p:y.length)-1],S=new V(_[g],_[g+1]),T=S.subtract(b).transform(u.calcOwnMatrix()),k=Fn(new V(h,d),void 0,u.calcOwnMatrix());y[p][g]=k.x+b.x,y[p][g+1]=k.y+b.y,u.setDimensions();const I=S.subtract(u.pathOffset).transform(u.calcOwnMatrix()).subtract(T);return u.left-=I.x,u.top-=I.y,u.set("dirty",!0),!0})(s,t,n,i,a);return gp(this.actionName,R(R({},mp(r,e,t,n)),{},{commandIndex:i,pointIndex:a})),c}class Hx extends lt{constructor(e){super(e)}render(e,t,n,s,i){const a=R(R({},s),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,a,i)}}class eF extends Hx{constructor(e){super(e)}render(e,t,n,s,i){const{path:a}=i,{commandIndex:c,pointIndex:u,connectToCommandIndex:h,connectToPointIndex:d}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);const[p]=a[c],g=Qd(i,h,d);if(p==="Q"){const y=Qd(i,c,u+2);e.moveTo(y.x,y.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(g.x,g.y),e.stroke(),e.restore(),super.render(e,t,n,s,i)}}const Dc=(r,e,t,n,s,i)=>new(t?eF:Hx)(R(R({commandIndex:r,pointIndex:e,actionName:"modifyPath",positionHandler:J6,actionHandler:Q6,connectToCommandIndex:s,connectToPointIndex:i},n),t?n.controlPointStyle:n.pointStyle));var Ht=Object.freeze({__proto__:null,changeWidth:Ud,createObjectDefaultControls:_p,createPathControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};let n="M";return r.path.forEach((s,i)=>{const a=s[0];switch(a!=="Z"&&(t["c_".concat(i,"_").concat(a)]=Dc(i,s.length-2,!1,e)),a){case"C":t["c_".concat(i,"_C_CP_1")]=Dc(i,1,!0,e,i-1,(c=>c==="C"?5:c==="Q"?3:1)(n)),t["c_".concat(i,"_C_CP_2")]=Dc(i,3,!0,e,i,5);break;case"Q":t["c_".concat(i,"_Q_CP_1")]=Dc(i,1,!0,e,i,3)}n=a}),t},createPolyActionHandler:X0,createPolyControls:function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};for(let n=0;n<(typeof r=="number"?r:r.points.length);n++)t["p".concat(n)]=new lt(R({actionName:Vx,positionHandler:Y0(n),actionHandler:X0(n)},e));return t},createPolyPositionHandler:Y0,createResizeControls:rx,createTextboxDefaultControls:nx,dragHandler:Lw,factoryPolyActionHandler:Wx,getLocalPoint:eu,polyActionHandler:zx,renderCircleControl:Uw,renderSquareControl:$w,rotationStyleHandler:Yw,rotationWithSnapping:Xw,scaleCursorStyleHandler:Mi,scaleOrSkewActionName:Bo,scaleSkewCursorStyleHandler:zs,scalingEqually:No,scalingX:Kw,scalingXOrSkewingY:$d,scalingY:Zw,scalingYOrSkewingX:Yd,skewCursorStyleHandler:Jw,skewHandlerX:ex,skewHandlerY:tx,wrapWithFireEvent:bs,wrapWithFixedAnchor:oi});const cu=r=>r.webgl!==void 0,kp="precision highp float",tF=`
    `.concat(kp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),rF=["type"],nF=["type"],sF=new RegExp(kp,"g");class Mt{get type(){return this.constructor.type}constructor(){let e=it(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},rF);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return tF}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=yn();s!=="highp"&&(t=t.replace(sF,kp.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER),c=e.createProgram();if(!i||!a||!c)throw new pn("Vertex, fragment shader or program creation error");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new pn("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new pn("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.attachShader(c,i),e.attachShader(c,a),e.linkProgram(c),!e.getProgramParameter(c,e.LINK_STATUS))throw new pn('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(c)));const u=this.getUniformLocations(e,c)||{};return u.uStepW=e.getUniformLocation(c,"uStepW"),u.uStepH=e.getUniformLocation(c,"uStepH"),{program:c,attributeLocations:this.getAttributeLocations(e,c),uniformLocations:u}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,s={};for(let i=0;i<n.length;i++)s[n[i]]=e.getUniformLocation(t,n[i]);return s}sendAttributeData(e,t,n){const s=t.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){cu(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,s=rn({width:t,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return R({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(it(e,nF))}}j(Mt,"type","BaseFilter"),j(Mt,"uniformLocations",[]);const iF={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Rc extends Mt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(iF[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new Xe(this.color).getSource(),s=this.alpha,i=n[0]*s,a=n[1]*s,c=n[2]*s,u=1-s;for(let h=0;h<t.length;h+=4){const d=t[h],p=t[h+1],g=t[h+2];let y,b,_;switch(this.mode){case"multiply":y=d*i/255,b=p*a/255,_=g*c/255;break;case"screen":y=255-(255-d)*(255-i)/255,b=255-(255-p)*(255-a)/255,_=255-(255-g)*(255-c)/255;break;case"add":y=d+i,b=p+a,_=g+c;break;case"difference":y=Math.abs(d-i),b=Math.abs(p-a),_=Math.abs(g-c);break;case"subtract":y=d-i,b=p-a,_=g-c;break;case"darken":y=Math.min(d,i),b=Math.min(p,a),_=Math.min(g,c);break;case"lighten":y=Math.max(d,i),b=Math.max(p,a),_=Math.max(g,c);break;case"overlay":y=i<128?2*d*i/255:255-2*(255-d)*(255-i)/255,b=a<128?2*p*a/255:255-2*(255-p)*(255-a)/255,_=c<128?2*g*c/255:255-2*(255-g)*(255-c)/255;break;case"exclusion":y=i+d-2*i*d/255,b=a+p-2*a*p/255,_=c+g-2*c*g/255;break;case"tint":y=i+d*u,b=a+p*u,_=c+g*u}t[h]=y,t[h+1]=b,t[h+2]=_}}sendUniformData(e,t){const n=new Xe(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}j(Rc,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),j(Rc,"type","BlendColor"),j(Rc,"uniformLocations",["uColor"]),ne.setClass(Rc);const oF={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},aF=["type","image"];class jc extends Mt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return oF[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:s},filterBackend:{resources:i}}=e;const a=this.image;i.blendImage||(i.blendImage=Vr());const c=i.blendImage,u=c.getContext("2d");c.width!==n||c.height!==s?(c.width=n,c.height=s):u.clearRect(0,0,n,s),u.setTransform(a.scaleX,0,0,a.scaleY,a.left,a.top),u.drawImage(a.getElement(),0,0,n,s);const h=u.getImageData(0,0,n,s).data;for(let d=0;d<t.length;d+=4){const p=t[d],g=t[d+1],y=t[d+2],b=t[d+3],_=h[d],S=h[d+1],T=h[d+2],k=h[d+3];switch(this.mode){case"multiply":t[d]=p*_/255,t[d+1]=g*S/255,t[d+2]=y*T/255,t[d+3]=b*k/255;break;case"mask":t[d+3]=k}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return R(R({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:s}=e,i=it(e,aF);return Lr.fromObject(s,t).then(a=>new this(R(R({},i),{},{image:a})))}}j(jc,"type","BlendImage"),j(jc,"defaults",{mode:"multiply",alpha:1}),j(jc,"uniformLocations",["uTransformMatrix","uImage"]),ne.setClass(jc);class Fc extends Mt{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){cu(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:n,filterBackend:{resources:s}}=e;const{width:i,height:a}=n;s.blurLayer1||(s.blurLayer1=Vr(),s.blurLayer2=Vr());const c=s.blurLayer1,u=s.blurLayer2;c.width===i&&c.height===a||(u.width=c.width=i,u.height=c.height=a);const h=c.getContext("2d"),d=u.getContext("2d"),p=15,g=.06*this.blur*.5;let y,b,_,S;for(h.putImageData(n,0,0),d.clearRect(0,0,i,a),S=-15;S<=p;S++)y=(Math.random()-.5)/4,b=S/p,_=g*b*i+y,d.globalAlpha=1-Math.abs(b),d.drawImage(c,_,y),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);for(S=-15;S<=p;S++)y=(Math.random()-.5)/4,b=S/p,_=g*b*a+y,d.globalAlpha=1-Math.abs(b),d.drawImage(c,y,_),h.drawImage(u,0,0),d.globalAlpha=1,d.clearRect(0,0,u.width,u.height);t.drawImage(c,0,0);const T=t.getImageData(0,0,c.width,c.height);return h.globalAlpha=1,h.clearRect(0,0,c.width,c.height),T}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const n=e*this.blur*.12;return this.horizontal?t[0]=n:t[1]=n,t}}j(Fc,"type","Blur"),j(Fc,"defaults",{blur:0}),j(Fc,"uniformLocations",["uDelta"]),ne.setClass(Fc);class Lc extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]+=n,t[s+1]+=n,t[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}j(Lc,"type","Brightness"),j(Lc,"defaults",{brightness:0}),j(Lc,"uniformLocations",["uBrightness"]),ne.setClass(Lc);const Ux={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Di extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let i=0;i<t.length;i+=4){const a=t[i],c=t[i+1],u=t[i+2];if(t[i]=a*n[0]+c*n[1]+u*n[2]+255*n[4],t[i+1]=a*n[5]+c*n[6]+u*n[7]+255*n[9],t[i+2]=a*n[10]+c*n[11]+u*n[12]+255*n[14],!s){const h=t[i+3];t[i]+=h*n[3],t[i+1]+=h*n[8],t[i+2]+=h*n[13],t[i+3]=a*n[15]+c*n[16]+u*n[17]+h*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,i)}toObject(){return R(R({},super.toObject()),{},{matrix:[...this.matrix]})}}function ai(r,e){var t;const n=(j(t=class extends Di{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),j(t,"defaults",{colorsOnly:!1,matrix:e}),t);return ne.setClass(n,r),n}j(Di,"type","ColorMatrix"),j(Di,"defaults",Ux),j(Di,"uniformLocations",["uColorMatrix","uConstants"]),ne.setClass(Di);ai("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);ai("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);ai("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);ai("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);ai("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);ai("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);ai("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class G0 extends Mt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){cu(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>ne.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}}j(G0,"type","Composed"),ne.setClass(G0);class Nc extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let i=0;i<t.length;i+=4)t[i]=s*(t[i]-128)+128,t[i+1]=s*(t[i+1]-128)+128,t[i+2]=s*(t[i+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}j(Nc,"type","Contrast"),j(Nc,"defaults",{contrast:0}),j(Nc,"uniformLocations",["uContrast"]),ne.setClass(Nc);const cF={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Bc extends Mt{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return cF[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),a=Math.floor(i/2),c=t.width,u=t.height,h=e.ctx.createImageData(c,u),d=h.data,p=this.opaque?1:0;let g,y,b,_,S,T,k,I,A,D,F,z,L;for(F=0;F<u;F++)for(D=0;D<c;D++){for(S=4*(F*c+D),g=0,y=0,b=0,_=0,L=0;L<i;L++)for(z=0;z<i;z++)k=F+L-a,T=D+z-a,k<0||k>=u||T<0||T>=c||(I=4*(k*c+T),A=s[L*i+z],g+=n[I]*A,y+=n[I+1]*A,b+=n[I+2]*A,p||(_+=n[I+3]*A));d[S]=g,d[S+1]=y,d[S+2]=b,d[S+3]=p?n[S+3]:_}e.imageData=h}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return R(R({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}j(Bc,"type","Convolute"),j(Bc,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),j(Bc,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ne.setClass(Bc);const $x="Gamma";class Vc extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,s=1/n[0],i=1/n[1],a=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const c=this.rgbValues;for(let u=0;u<256;u++)c.r[u]=255*Math.pow(u/255,s),c.g[u]=255*Math.pow(u/255,i),c.b[u]=255*Math.pow(u/255,a);for(let u=0;u<t.length;u+=4)t[u]=c.r[t[u]],t[u+1]=c.g[t[u+1]],t[u+2]=c.b[t[u+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:$x,gamma:this.gamma.concat()}}}j(Vc,"type",$x),j(Vc,"defaults",{gamma:[1,1,1]}),j(Vc,"uniformLocations",["uGamma"]),ne.setClass(Vc);const lF={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class zc extends Mt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2];switch(this.mode){case"average":n=(i+a+c)/3;break;case"lightness":n=(Math.min(i,a,c)+Math.max(i,a,c))/2;break;case"luminosity":n=.21*i+.72*a+.07*c}t[s+2]=t[s+1]=t[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return lF[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}j(zc,"type","Grayscale"),j(zc,"defaults",{mode:"average"}),j(zc,"uniformLocations",["uMode"]),ne.setClass(zc);const uF=R(R({},Ux),{},{rotation:0});class ed extends Di{calculateMatrix(){const e=this.rotation*Math.PI,t=en(e),n=tn(e),s=1/3,i=Math.sqrt(s)*n,a=1-t;this.matrix=[t+a/3,s*a-i,s*a+i,0,0,s*a+i,t+s*a,s*a-i,0,0,s*a-i,s*a+i,t+s*a,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}j(ed,"type","HueRotation"),j(ed,"defaults",uF),ne.setClass(ed);class Wc extends Mt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}j(Wc,"type","Invert"),j(Wc,"defaults",{alpha:!1,invert:!0}),j(Wc,"uniformLocations",["uInvert","uAlpha"]),ne.setClass(Wc);class Hc extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let s=0;s<t.length;s+=4){const i=(.5-Math.random())*n;t[s]+=i,t[s+1]+=i,t[s+2]+=i}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}j(Hc,"type","Noise"),j(Hc,"defaults",{noise:0}),j(Hc,"uniformLocations",["uNoise","uSeed"]),ne.setClass(Hc);class Uc extends Mt{applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let a=0;a<n;a+=this.blocksize){const c=4*i*n+4*a,u=t[c],h=t[c+1],d=t[c+2],p=t[c+3];for(let g=i;g<Math.min(i+this.blocksize,s);g++)for(let y=a;y<Math.min(a+this.blocksize,n);y++){const b=4*g*n+4*y;t[b]=u,t[b+1]=h,t[b+2]=d,t[b+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}j(Uc,"type","Pixelate"),j(Uc,"defaults",{blocksize:4}),j(Uc,"uniformLocations",["uBlocksize"]),ne.setClass(Uc);class $c extends Mt{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,s=new Xe(this.color).getSource(),i=[s[0]-n,s[1]-n,s[2]-n],a=[s[0]+n,s[1]+n,s[2]+n];for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],d=t[c+2];u>i[0]&&h>i[1]&&d>i[2]&&u<a[0]&&h<a[1]&&d<a[2]&&(t[c+3]=0)}}sendUniformData(e,t){const n=new Xe(this.color).getSource(),s=this.distance,i=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],a=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(t.uLow,i),e.uniform4fv(t.uHigh,a)}}j($c,"type","RemoveColor"),j($c,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),j($c,"uniformLocations",["uLow","uHigh"]),ne.setClass($c);class Yc extends Mt{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let i=1;i<=n;i++)s[i-1]=e(i*t);return s}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){cu(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const i=t.width,a=t.height,c=Math.round(i*n),u=Math.round(a*s);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,a,c,u):this.resizeType==="hermite"?this.hermiteFastResize(e,i,a,c,u):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,a,c,u):this.resizeType==="lanczos"?this.lanczosResize(e,i,a,c,u):new ImageData(c,u),e.imageData=h}sliceByTwo(e,t,n,s,i){const a=e.imageData,c=.5;let u=!1,h=!1,d=t*c,p=n*c;const g=e.filterBackend.resources;let y=0,b=0;const _=t;let S=0;g.sliceByTwo||(g.sliceByTwo=Vr());const T=g.sliceByTwo;(T.width<1.5*t||T.height<n)&&(T.width=1.5*t,T.height=n);const k=T.getContext("2d");for(k.clearRect(0,0,1.5*t,n),k.putImageData(a,0,0),s=Math.floor(s),i=Math.floor(i);!u||!h;)t=d,n=p,s<Math.floor(d*c)?d=Math.floor(d*c):(d=s,u=!0),i<Math.floor(p*c)?p=Math.floor(p*c):(p=i,h=!0),k.drawImage(T,y,b,t,n,_,S,d,p),y=_,b=S,S+=p;return k.getImageData(y,b,s,i)}lanczosResize(e,t,n,s,i){const a=e.imageData.data,c=e.ctx.createImageData(s,i),u=c.data,h=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,p=this.rcpScaleY,g=2/this.rcpScaleX,y=2/this.rcpScaleY,b=Math.ceil(d*this.lanczosLobes/2),_=Math.ceil(p*this.lanczosLobes/2),S={},T={x:0,y:0},k={x:0,y:0};return function I(A){let D,F,z,L,Y,W,q,U,X,te,de;for(T.x=(A+.5)*d,k.x=Math.floor(T.x),D=0;D<i;D++){for(T.y=(D+.5)*p,k.y=Math.floor(T.y),Y=0,W=0,q=0,U=0,X=0,F=k.x-b;F<=k.x+b;F++)if(!(F<0||F>=t)){te=Math.floor(1e3*Math.abs(F-T.x)),S[te]||(S[te]={});for(let J=k.y-_;J<=k.y+_;J++)J<0||J>=n||(de=Math.floor(1e3*Math.abs(J-T.y)),S[te][de]||(S[te][de]=h(Math.sqrt(Math.pow(te*g,2)+Math.pow(de*y,2))/1e3)),z=S[te][de],z>0&&(L=4*(J*t+F),Y+=z,W+=z*a[L],q+=z*a[L+1],U+=z*a[L+2],X+=z*a[L+3]))}L=4*(D*s+A),u[L]=W/Y,u[L+1]=q/Y,u[L+2]=U/Y,u[L+3]=X/Y}return++A<s?I(A):c}(0)}bilinearFiltering(e,t,n,s,i){let a,c,u,h,d,p,g,y,b,_,S,T,k,I=0;const A=this.rcpScaleX,D=this.rcpScaleY,F=4*(t-1),z=e.imageData.data,L=e.ctx.createImageData(s,i),Y=L.data;for(g=0;g<i;g++)for(y=0;y<s;y++)for(d=Math.floor(A*y),p=Math.floor(D*g),b=A*y-d,_=D*g-p,k=4*(p*t+d),S=0;S<4;S++)a=z[k+S],c=z[k+4+S],u=z[k+F+S],h=z[k+F+4+S],T=a*(1-b)*(1-_)+c*b*(1-_)+u*_*(1-b)+h*b*_,Y[I++]=T;return L}hermiteFastResize(e,t,n,s,i){const a=this.rcpScaleX,c=this.rcpScaleY,u=Math.ceil(a/2),h=Math.ceil(c/2),d=e.imageData.data,p=e.ctx.createImageData(s,i),g=p.data;for(let y=0;y<i;y++)for(let b=0;b<s;b++){const _=4*(b+y*s);let S=0,T=0,k=0,I=0,A=0,D=0,F=0;const z=(y+.5)*c;for(let L=Math.floor(y*c);L<(y+1)*c;L++){const Y=Math.abs(z-(L+.5))/h,W=(b+.5)*a,q=Y*Y;for(let U=Math.floor(b*a);U<(b+1)*a;U++){let X=Math.abs(W-(U+.5))/u;const te=Math.sqrt(q+X*X);te>1&&te<-1||(S=2*te*te*te-3*te*te+1,S>0&&(X=4*(U+L*t),F+=S*d[X+3],k+=S,d[X+3]<255&&(S=S*d[X+3]/250),I+=S*d[X],A+=S*d[X+1],D+=S*d[X+2],T+=S))}}g[_]=I/T,g[_+1]=A/T,g[_+2]=D/T,g[_+3]=F/k}return p}}j(Yc,"type","Resize"),j(Yc,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),j(Yc,"uniformLocations",["uDelta","uTaps"]),ne.setClass(Yc);class Xc extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2],u=Math.max(i,a,c);t[s]+=u!==i?(u-i)*n:0,t[s+1]+=u!==a?(u-a)*n:0,t[s+2]+=u!==c?(u-c)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}j(Xc,"type","Saturation"),j(Xc,"defaults",{saturation:0}),j(Xc,"uniformLocations",["uSaturation"]),ne.setClass(Xc);class Gc extends Mt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],c=t[s+2],u=Math.max(i,a,c),h=(i+a+c)/3,d=2*Math.abs(u-h)/255*n;t[s]+=u!==i?(u-i)*d:0,t[s+1]+=u!==a?(u-a)*d:0,t[s+2]+=u!==c?(u-c)*d:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}j(Gc,"type","Vibrance"),j(Gc,"defaults",{vibrance:0}),j(Gc,"uniformLocations",["uVibrance"]),ne.setClass(Gc);class Yx{___eventListeners;___activeObjects;constructor(){this.___activeObjects=[],this.___eventListeners={}}pauseEventListeners(){this.___eventListeners=this.__eventListeners,this.__eventListeners={};const e=this.getActiveObjects();this.discardActiveObject(),this.___activeObjects=e}resumeEventListeners(){this.__eventListeners=this.___eventListeners,this.___eventListeners={};const e=this.___activeObjects;if(!e.length)return this.requestRenderAll(),!1;if(e.length===1)this.setActiveObject(e[0]);else{const t=new gn(e);this.setActiveObject(t)}this.requestRenderAll()}}class Gs extends _t{isSelected=!1;text;tScale;display;id;backgroundColor;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default",fontSize:16,fontFamily:"Arial",fontColor:"#ffffff",textAlign:"center"};static type="Text";constructor(e){super(e),Object.assign(this,Gs.ownDefaults),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.text=e.text||"",this.backgroundColor=e.backgroundColor||"transparent"}static createControls(){return{controls:Ip()}}static getDefaults(){return{...super.getDefaults(),...Gs.ownDefaults}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,6),e.lineWidth=2,e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore())}}function zn(r,e,t,n,s){r.save(),r.translate(e,t),r.rotate(Cx.degreesToRadians(90+s.angle)),r.beginPath(),r.lineWidth=4,r.lineCap="round",r.strokeStyle="#dfe2e8",r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}function Ip(){return{mr:new lt({x:.5,y:0,actionHandler:oa,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing",render:zn}),ml:new lt({x:-.5,y:0,actionHandler:oa,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing",render:zn})}}const oa=Ht.wrapWithFireEvent("resizing",Ht.wrapWithFixedAnchor((r,e,t,n)=>{const s=Ht.getLocalPoint(e,e.originX,e.originY,t,n);if(hF(e.originX)||fF(e.originX)&&s.x<0||dF(e.originX)&&s.x>0){const i=e.target,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=pF(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a);if(e.corner==="ml"){const p=u-h;if(i.left+p<0)return i.set("width",i.width+i.left),!0}return i.set("width",Math.max(h,0)),u!==i.width}return!1})),Xx={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Me=r=>typeof r=="string"?Xx[r]:r-.5,hF=r=>Me(r)===Me("center"),dF=r=>Me(r)===Me("left"),fF=r=>Me(r)===Me("right");function pF(r){return Me(r.originX)===Me("center")&&Me(r.originY)===Me("center")}ne.setClass(Gs,"Text");class zr extends _t{static type="Transition";id;duration;fromId;toId;static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0, 0, 0, 0.5)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};isSelected=!1;constructor(e){super(e),this.id=e.id,this.fromId=e.fromId,this.toId=e.toId,Object.assign(this,{duration:e.duration,fromId:e.fromId,toId:e.toId,kind:e.kind,tScale:e.tScale,strokeDashArray:e.strokeDashArray||[],isSelected:!1,centeredScaling:!0,strokeWidth:0}),Object.assign(this,zr.ownDefaults)}static createControls(){return{controls:gF()}}static getDefaults(){return{...super.getDefaults(),...zr.ownDefaults}}updateCoords(){}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle=this.isSelected?"rgba(255, 255, 255,1.0)":"rgba(255, 255, 255,0.15)",e.stroke(),e.restore()}}ne.setClass(zr,"Transition");const gF=()=>({mr:new lt({x:.5,y:0,actionHandler:q0,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing",render:zn}),ml:new lt({x:-.5,y:0,actionHandler:q0,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing",render:zn})});ne.setClass(zr,"Transition");const{wrapWithFireEvent:mF,getLocalPoint:vF}=Ht,ef="center",yF="left",bF="right";function wF(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,a,c),d}}const xF=(r,e,t,n)=>{const s=vF(e,e.originX,e.originY,t,n);if(Me(e.originX)===Me(ef)||Me(e.originX)===Me(bF)&&s.x<0||Me(e.originX)===Me(yF)&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=_F(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a),d=ss(h,i.tScale);return d>=1500||d<500?!1:(i.set("width",Math.max(h,0)),i.set("duration",d),i.setCoords(),i.canvas&&i.canvas.renderAll(),u!==i.width)}return!1};function _F(r){return Me(r.originX)===Me(ef)&&Me(r.originY)===Me(ef)}const q0=mF("resizing",wF(xF));class Wi extends _t{static type="Placeholder";guideItemId;distXToActCenter;trackItemType;defaultPos;draggedObject=null;for;id;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",strokeWidth:0,fill:"rgba(255, 211, 42, 0.1)",stroke:"rgba(255, 211, 42, 1.0)",selectable:!1,borderOpacityWhenMoving:1,hoverCursor:"default",strokeDashArray:[5,1],evented:!1};constructor(e){super(e),this.id=e.id,this.for=e.for,Object.assign(this,Wi.ownDefaults)}static getDefaults(){return{...super.getDefaults(),...Wi.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,this.strokeDashArray&&e.setLineDash(this.strokeDashArray),e.strokeStyle="rgba(0, 216, 214,1.0)",e.stroke(),e.restore()}}ne.setClass(Wi,"Placeholder");const SF={top:{top:35,guideHeight:2,bottom:3},center:{top:3,guideHeight:2,bottom:3},bottom:{top:3,guideHeight:2,bottom:35}},Ta="rgba(0, 216, 214, 1.0)",td=(r,e,t)=>new _t({top:r,left:0,strokeWidth:0,fill:"transparent",selectable:!0,height:t,width:e});class Go extends Br{static type="Helper";static defaultSettings={selectable:!1,evented:!1};static ownDefaults={...Go.defaultSettings};guide;topGuide;bottomGuide;id;metadata={};tScale;kind;constructor(e){const t=SF[e.kind],n=td(0,e.width,t.top),s=td(t.top,e.width,t.guideHeight),i=td(t.top+t.guideHeight,e.width,t.bottom);super([n,s,i],{...Go.defaultSettings,...e}),this.topGuide=n,this.guide=s,this.bottomGuide=i,this.id=e.id,this.metadata=e.metadata??{},this.tScale=e.tScale,this.kind=e.kind}static getDefaults(){return{...super.getDefaults(),...Go.defaultSettings}}updateCoords(e){this.scaleToWidth(e),this.set("scaleY",1)}setSelected(e){this.guide.set("fill",e?Ta:"transparent")}}const co=Go;ne.setClass(co,"Helper");class hs extends _t{static ownDefaults={selectable:!1,evented:!1,strokeWidth:0,stroke:"transparent"};static type="Track";id;accepts;metadata;items;borderColor="transparent";stroke="transparent";strokeWidth=0;constructor(e){super(e),Object.assign(this,hs.ownDefaults),this.id=e.id,this.accepts=e.accepts||["audio","video","image","text"],this.items=e.items||[],this.metadata=e.metadata}static getDefaults(){return{...super.getDefaults(),...hs.ownDefaults}}updateCoords(e){this.width=e}}ne.setClass(hs,"Track");class Sl extends _t{isSelected;tScale;display;id;src;itemType;static ownDefaults={rx:8,ry:8,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",fill:"#27272a"};static type="Image";constructor(e){super(e),this.itemType="image",this.isSelected=!1,Object.assign(this,Sl.ownDefaults),this.id=e.id,this.src=e.src,this.display=e.display,this.tScale=e.tScale}static createControls(){return{controls:Ip()}}static getDefaults(){return{...super.getDefaults(),...Sl.ownDefaults}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=Ta,e.stroke(),e.restore())}}const lu=Sl;ne.setClass(lu,"Image");class ci extends _t{id;tScale;isSelected=!1;display;trim;static type="Video";static defaultProps={objectCaching:!1,rx:8,ry:8,fill:"#27272a"};constructor(e){super(Object.assign({},ci.defaultProps,e)),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim}static createControls(){return{controls:Gx()}}_render(e){super._render(e),this.updateSelected(e)}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=2,e.strokeStyle=Ta,e.stroke(),e.restore())}}ne.setClass(ci,"Video");const Gx=()=>({mr:new lt({x:.5,y:0,render:zn,actionHandler:K0,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new lt({x:-.5,y:0,render:zn,actionHandler:K0,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:CF,getLocalPoint:TF}=Ht,EF=(r,e,t,n)=>{const s=TF(e,e.originX,e.originY,t,n);if(Me(e.originX)===Me("center")||Me(e.originX)===Me("right")&&s.x<0||Me(e.originX)===Me("left")&&s.x>0){const{target:i}=e;return i.width!==i.width}return!1};function Ap(r){return(e,t,n,s)=>{const{target:i,originX:a,originY:c}=t,u=i.getRelativeCenterPoint(),h=i.translateToOriginPoint(u,a,c),d=r(e,t,n,s);return i.setPositionByOrigin(h,a,c),d}}const K0=CF("resizing",Ap(EF));class Nn extends _t{id;itemType="audio";isSelected=!1;trim;src;tScale;display;static ownDefaults={rx:6,ry:6,objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,fill:"#27272a",borderOpacityWhenMoving:1,hoverCursor:"default"};static type="Audio";constructor(e){super({...Nn.getDefaults(),...e}),this.id=e.id,this.tScale=e.tScale,this.display=e.display,this.trim=e.trim,this.src=e.src}static getDefaults(){return{...super.getDefaults(),...Nn.ownDefaults}}static createControls(){return{controls:qx()}}setSelected(e){this.isSelected=e,this.set({dirty:!0})}_render(e){super._render(e),this.updateSelected(e)}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,Nn.ownDefaults.rx),e.lineWidth=2,e.strokeStyle=Ta,e.stroke(),e.restore())}}ne.setClass(Nn,"Audio");const qx=()=>({mr:new lt({x:.5,y:0,render:zn,actionHandler:Z0,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing"}),ml:new lt({x:-.5,y:0,render:zn,actionHandler:Z0,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing"})}),{wrapWithFireEvent:kF,getLocalPoint:IF}=Ht,AF=(r,e,t,n)=>{const s=IF(e,e.originX,e.originY,t,n);if(Me(e.originX)===Me("center")||Me(e.originX)===Me("right")&&s.x<0||Me(e.originX)===Me("left")&&s.x>0){const{target:i}=e,a=i.strokeWidth/(i.strokeUniform?i.scaleX:1),c=OF(e)?2:1,u=i.width,h=Math.ceil(Math.abs(s.x*c/i.scaleX)-a);if(e.corner==="mr"){const d=i.trim.to,p=h-u,g=ss(p,i.tScale),y=d+g;if(y>i.duration)return!1;i.set("width",Math.max(h,0)),i.trim.to=y}else{if(i.left<0)return!1;const d=u-h;if(i.left+d<0)return i.set("width",i.width+i.left),!0;const p=h-u,g=i.trim.from,y=ss(p,i.tScale),b=g-y;if(b<0)return!1;i.set("width",Math.max(h,0)),i.trim.from=b}return u!==i.width}return!1};function OF(r){return Me(r.originX)===Me("center")&&Me(r.originY)===Me("center")}const Z0=kF("resizing",Ap(AF));class aa extends _t{static type="TransitionGuide";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:1.5,fill:"rgba(0,0,0,0.85)",borderOpacityWhenMoving:1,hoverCursor:"default",lockMovementX:!0,lockMovementY:!0,duration:1500,rx:8,ry:8};tScale;duration=0;fromId;toId;itemType="none";isSelected=!1;id;constructor(e){super(e),Object.assign(this,aa.ownDefaults),this.id=e.id}static createControls(){return{controls:Kx()}}static getDefaults(){return{...super.getDefaults(),...aa.ownDefaults}}updateCoords(){const e=this.canvas;if(!e)return;const t=e.getObjects().find(i=>i.id===this.fromId);if(!t)return;const n=wt(this.duration,this.tScale),s=t.left+t.width-n/2;this.set({width:n,left:s})}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M3 5.30359C3 3.93159 4.659 3.24359 5.629 4.21359L11.997 10.5826L10.583 11.9966L5 6.41359V17.5856L10.586 11.9996L10.583 11.9966L11.997 10.5826L12 10.5856L18.371 4.21459C19.341 3.24459 21 3.93159 21 5.30359V18.6956C21 20.0676 19.341 20.7556 18.371 19.7856L12 13.5L13.414 11.9996L19 17.5866V6.41359L13.414 11.9996L13.421 12.0056L12.006 13.4206L12 13.4136L5.629 19.7846C4.659 20.7546 3 20.0676 3 18.6956V5.30359Z");e.save(),e.translate(-12,-12),e.fillStyle="#ffffff",e.fill(t),e.restore()}setSelected(e){this.isSelected=e,this.set({dirty:!0})}updateSelected(e){this.isSelected&&(e.save(),e.beginPath(),e.roundRect(-this.width/2,-this.height/2,this.width,this.height,this.rx),e.lineWidth=1,e.strokeStyle="rgba(255, 255, 255,1.0)",e.stroke(),e.restore())}}function Kx(){return{mr:new lt({x:.5,y:0,actionHandler:oa,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing",render:J0}),ml:new lt({x:-.5,y:0,actionHandler:oa,cursorStyleHandler:Ht.scaleSkewCursorStyleHandler,actionName:"resizing",render:J0})}}function J0(r,e,t,n,s){r.save(),r.translate(e,t),r.rotate(Cx.degreesToRadians(90+s.angle)),r.lineWidth=6,r.lineCap="round",r.strokeStyle="white",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.lineWidth=4,r.strokeStyle="black",r.beginPath(),r.moveTo(-6,0),r.lineTo(6,0),r.stroke(),r.restore()}class ca extends _t{static type="PreviewTrackItem";static ownDefaults={objectCaching:!1,borderColor:"transparent",stroke:"transparent",strokeWidth:0,borderOpacityWhenMoving:1,hoverCursor:"default",rx:4,ry:4};duration=0;fromId="";toId="";isSelected=!1;name;durationString;id;constructor(e){super(e),Object.assign(this,ca.ownDefaults),this.id=e.id,this.name=e.name||"item",this.durationString="00:05",this.fill="#27272a"}static getDefaults(){return{...super.getDefaults(),...ca.ownDefaults}}_render(e){e.save(),super._render(e),e.beginPath(),e.rect(-this.width/2,-this.height/2,this.width,this.height),e.clip(),this.drawTextIdentity(e),e.restore()}drawTextIdentity(e){e.font="600 12px 'Geist variable'",e.textAlign="left";const u=e.measureText(this.name).width,h=e.measureText(this.durationString).width,d=-this.height/2+4,p=-this.width/2,g=p+u+8*2+4,y=u+8*2;this.drawRoundedRect(e,p,d,y,20,4),e.fillStyle="#f4f4f5",e.fillText(this.name,p+8,d+12+2);const b=h+8*2;this.drawRoundedRect(e,g,d,b,20,4),e.fillStyle="#f4f4f5",e.fillText(this.durationString,g+8,d+12+2)}drawRoundedRect(e,t,n,s,i,a){e.fillStyle="rgba(0, 0, 0, 0.5)",e.roundRect?(e.beginPath(),e.roundRect(t,n,s,i,a),e.fill()):e.fillRect(t,n,s,i)}}function Zx(r,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{if(n!=="constructor"){const s=Object.getOwnPropertyDescriptor(t.prototype,n);s&&Object.defineProperty(r.prototype,n,s)}})})}const uu=(r,e)=>{const t={x:r.size.width/2,y:r.size.height/2},n={x:e.width/2,y:e.height/2},s=t.x-n.x,i=t.y-n.y,a=Math.min(r.size.width/e.width,r.size.height/e.height);return{top:`${i}px`,left:`${s}px`,transform:`scale(${a})`}},Jx=r=>new Promise((e,t)=>{const n=new Audio;n.preload="auto",n.addEventListener("loadedmetadata",()=>{const s=n.duration*1e3;e({duration:s})}),n.addEventListener("error",s=>{t(s)}),n.src=r,n.crossOrigin="anonymous",n.load()}),Qx=r=>new Promise((e,t)=>{const n=new Image;console.warn("Consider updating CDN config for CORS issues?"),n.onload=()=>{const s=n.width,i=n.height;e({width:s,height:i})},n.onerror=s=>{t(s)},n.crossOrigin="anonymous",n.src=r}),e_=r=>new Promise((e,t)=>{const n=document.createElement("video");n.preload="auto",n.addEventListener("loadedmetadata",()=>{const s=n.duration*1e3,i=n.videoWidth,a=n.videoHeight;e({duration:s,width:i,height:a})}),n.addEventListener("error",s=>{t(s)}),n.src=r,n.load()}),qo=(r,e)=>{const t=document.createElement("div");Object.keys(e).forEach(s=>{s!=="height"&&(t.style[s]=e[s])}),document.body.appendChild(t),t.textContent=r,t.style.width=`${e.width}px`,t.style.fontSize=`${e.fontSize}px`;const n=getComputedStyle(t).height;return document.body.removeChild(t),parseFloat(n)},nn=r=>Object.keys(r).reduce((e,t)=>{const{display:{to:n}}=r[t];return Math.max(e,n)},0),t_=(r,e)=>{if(!r)return{from:0,to:e.duration};const{from:t,to:n}=r;return{from:t??0,to:n??e.duration}},r_=(r,e)=>{const{duration:t,trim:n}=e,s=n?n.to-n.from:t||5e3,i={from:0,to:s};if(!r)return i;if(r.from!==void 0&&r.from<0)return console.error("'from' must be a non-negative number. Returning default display."),i;if(r.from!==void 0&&r.to===void 0)return{from:r.from,to:r.from+s};if(r.to!==void 0){if(r.to<0)return console.error("'to' must be a non-negative number. Returning default display."),i;if(r.to<r.from)return console.error("'to' must be greater than or equal to 'from'. Returning default display."),i}return r};function n_(r,e){return r.map(t=>{const n=t.items.filter(s=>!e.includes(s));return{...t,items:n}}).filter(t=>t.items.length>0)}const s_=async(r,e)=>{const t=r.details,n=await Qx(t.src),s=uu(e,n);return{id:r.id,type:"image",name:"",display:{from:e.origin||0,to:(e.origin||5e3)+5e3},details:{src:t.src||"",width:t.width||n.width||100,height:t.height||n.height||100,opacity:t.opacity??100,transform:s.transform,border:t.border||"none",borderRadius:t.borderRadius||"0",boxShadow:t.boxShadow||"none",top:s.top||"0px",left:s.left||"0px"},metadata:r.metadata||{}}},i_=async(r,e)=>{const t=r.details.src,n=await e_(t),s=uu(e,{...n}),i=t_(r.trim,{duration:n.duration}),a={width:n.width,height:n.height,duration:n.duration,src:t,volume:r.details.volume??100,top:r.details.top||s.top||"0px",left:r.details.left||s.left||"0px",text:r.details.text};return{...r,trim:i,type:"video",details:a,display:r_(r?.display,{duration:n.duration,trim:i})}},o_=async r=>{const e=r.details,t=(await Jx(e.src)).duration,n=r?.display?.from??0;return{id:r.id,name:"",type:"audio",display:{from:n,to:n+t},trim:{from:0,to:t},details:{src:e.src,duration:t,volume:e.volume??100,text:e.text},metadata:{...r.metadata}}},MF=5e3,Op=async(r,e)=>{const t=r.id;await Z1([{fontFamily:r.details.fontFamily??"",fontUrl:r.details.fontUrl??""}]);const n={fontFamily:r.details.fontFamily??"Arial",fontSize:r.details.fontSize??"16px",fontWeight:r.details.fontWeight??"normal",fontStyle:r.details.fontStyle??"normal",textDecoration:r.details.textDecoration??"none",textAlign:r.details.textAlign??"left",lineHeight:r.details.lineHeight??"normal",letterSpacing:r.details.letterSpacing??"normal",wordSpacing:r.details.wordSpacing??"normal",color:r.details.color??"#ffffff",backgroundColor:r.details.backgroundColor??"transparent",border:r.details.border??"none",textShadow:r.details.textShadow??"none",text:r.details.text??"",opacity:r.details.opacity??100,width:r.details.width??300,wordWrap:r.details.wordWrap??"normal",wordBreak:r.details.wordBreak??"normal",WebkitTextStrokeColor:r.details.WebkitTextStrokeColor??"#ffffff",WebkitTextStrokeWidth:r.details.WebkitTextStrokeWidth??"0px",top:r.details.top??"0px",left:r.details.left??"0px"},s=qo(r.details.text??"",n),i=uu(e,{width:n.width??0,height:s});return{id:t,name:"",type:"text",display:{from:0,to:MF},details:{...n,height:s,top:i.top,left:i.left,fontUrl:r.details.fontUrl,text:r.details.text??""},metadata:{}}},a_=(r,e)=>{const t=r.display,n=wt(t.from,e.tScale),s=wt(t.to-t.from,e.tScale),i=ne.getClass("Audio")||Nn;return new i({width:s,height:42,top:10,left:n,id:r.id,display:t,text:r.details.text,trim:r.trim||{from:0,to:r.details.duration},duration:r.details.duration,src:r.details.src,tScale:e.tScale})},c_=(r,e)=>{const t=wt(r.display.from,e.tScale),n=wt(r.details.duration||5e3,e.tScale),s=ne.getClass("Image")||lu;return new s({width:n,height:42,id:r.id,src:r.details.src,tScale:e.tScale,top:10,left:t,display:r.display})},l_=(r,e)=>{const t=wt(r.trim.from,e.tScale),n=wt(r.trim.to-r.trim.from,e.tScale),s=ne.getClass("Video")||ci;return new s({width:n,height:42,id:r.id,tScale:e.tScale,fill:"#333333",top:10,left:t,display:r.trim,trim:r.trim,text:r.details.text})},u_=(r,e)=>{const t=r.display,n=wt(t.from,e.tScale),s=wt(t.to-t.from,e.tScale),i=ne.getClass("Text")||Gs;return new i({width:s,height:42,id:r.id,display:t,top:10,left:n,text:r.details.text,tScale:e.tScale})},h_={video:42,image:42,audio:42,text:42,caption:42,template:42},d_=(r={})=>{const e={...h_,...r};return Object.fromEntries(Object.entries(e).filter(([,t])=>typeof t=="number"))};let f_=class extends Nn{static type="Audio";text;constructor(e){super(e),this.text=e.text??"Audio"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M8.24092 0C8.24092 2.51565 10.2795 4.55419 12.7951 4.55419C12.9677 4.55419 13.1331 4.62274 13.2552 4.74475C13.3772 4.86676 13.4457 5.03224 13.4457 5.20479C13.4457 5.37734 13.3772 5.54282 13.2552 5.66483C13.1331 5.78685 12.9677 5.85539 12.7951 5.85539C11.9218 5.85605 11.0594 5.66105 10.2713 5.28471C9.48319 4.90838 8.78942 4.36027 8.24092 3.68066V13.8794C8.24094 14.8271 7.91431 15.7458 7.31606 16.4808C6.71781 17.2157 5.88451 17.722 4.95657 17.9143C4.02863 18.1066 3.06276 17.9731 2.22172 17.5364C1.38067 17.0997 0.715856 16.3865 0.339286 15.5169C-0.0372842 14.6473 -0.10259 13.6744 0.154372 12.7622C0.411334 11.8501 0.974857 11.0544 1.74999 10.5092C2.52512 9.96403 3.46449 9.7027 4.40981 9.76924C5.35512 9.83579 6.24861 10.2261 6.93972 10.8745V0H8.24092ZM6.93972 13.8794C6.93972 13.1317 6.6427 12.4146 6.11398 11.8859C5.58527 11.3572 4.86818 11.0602 4.12046 11.0602C3.37275 11.0602 2.65566 11.3572 2.12694 11.8859C1.59823 12.4146 1.3012 13.1317 1.3012 13.8794C1.3012 14.6272 1.59823 15.3443 2.12694 15.873C2.65566 16.4017 3.37275 16.6987 4.12046 16.6987C4.86818 16.6987 5.58527 16.4017 6.11398 15.873C6.6427 15.3443 6.93972 14.6272 6.93972 13.8794Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,10),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,14),e.translate(10,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class p_ extends ci{static type="Video";text;constructor(e){super(e),this.text=e.text??"Video"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M16.5625 0.925L12.5 3.275V0.625L11.875 0H0.625L0 0.625V9.375L0.625 10H11.875L12.5 9.375V6.875L16.5625 9.2125L17.5 8.625V1.475L16.5625 0.925ZM11.25 8.75H1.25V1.25H11.25V8.75ZM16.25 7.5L12.5 5.375V4.725L16.25 2.5V7.5Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,14),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,10),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}class Mp extends Gs{static type="Text";constructor(e){super(e),this.fill="#303030"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M6.23982 0.361968C6.18894 0.253743 6.10832 0.162234 6.00736 0.0981357C5.9064 0.034038 5.78929 0 5.6697 0C5.55012 0 5.433 0.034038 5.33204 0.0981357C5.23109 0.162234 5.15046 0.253743 5.09959 0.361968L0.0599035 11.0713C0.0246926 11.1462 0.00457285 11.2272 0.000693114 11.3099C-0.00318662 11.3925 0.00924959 11.4751 0.0372917 11.553C0.0939253 11.7102 0.210687 11.8384 0.361891 11.9095C0.513095 11.9806 0.686354 11.9888 0.843555 11.9322C1.00076 11.8755 1.12902 11.7588 1.20013 11.6075L2.51202 8.81998H8.82738L10.1393 11.6075C10.1745 11.6824 10.2241 11.7496 10.2853 11.8053C10.3465 11.861 10.418 11.9041 10.4958 11.9322C10.5737 11.9602 10.6563 11.9726 10.7389 11.9687C10.8216 11.9649 10.9026 11.9447 10.9775 11.9095C11.0524 11.8743 11.1196 11.8247 11.1753 11.7635C11.231 11.7023 11.2741 11.6308 11.3021 11.553C11.3302 11.4751 11.3426 11.3925 11.3387 11.3099C11.3348 11.2272 11.3147 11.1462 11.2795 11.0713L6.23982 0.361968ZM3.10498 7.56005L5.6697 2.11011L8.23443 7.56005H3.10498ZM15.1191 3.78029C14.1143 3.78029 13.3292 4.05354 12.7859 4.59294C12.6721 4.71153 12.6092 4.86987 12.6106 5.03419C12.6119 5.19851 12.6774 5.3558 12.7931 5.4725C12.9088 5.58921 13.0655 5.6561 13.2298 5.6589C13.3941 5.6617 13.553 5.60018 13.6726 5.48748C13.9718 5.19062 14.46 5.04021 15.1191 5.04021C16.1609 5.04021 17.009 5.74892 17.009 6.61511V6.86867C16.45 6.49465 15.7917 6.29663 15.1191 6.30013C13.382 6.30013 11.9693 7.57187 11.9693 9.13495C11.9693 10.698 13.382 11.9698 15.1191 11.9698C15.792 11.9727 16.4503 11.7739 17.009 11.3989C17.0168 11.566 17.0907 11.7231 17.2144 11.8357C17.3381 11.9483 17.5014 12.0071 17.6685 11.9993C17.8356 11.9915 17.9927 11.9176 18.1053 11.7939C18.2179 11.6702 18.2767 11.5069 18.2689 11.3398V6.61511C18.2689 5.05202 16.8562 3.78029 15.1191 3.78029ZM15.1191 10.7099C14.0773 10.7099 13.2292 10.0012 13.2292 9.13495C13.2292 8.26876 14.0773 7.56005 15.1191 7.56005C16.1609 7.56005 17.009 8.26876 17.009 9.13495C17.009 10.0012 16.1609 10.7099 15.1191 10.7099Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}}let g_=class extends lu{static type="Image";text;constructor(e){super(e),this.text=e.text??"Image"}_render(e){super._render(e),this.drawTextIdentity(e),this.updateSelected(e)}drawTextIdentity(e){const t=new Path2D("M1.55556 0H14.4444C15.3031 0 16 0.696889 16 1.55556V14.4444C16 14.857 15.8361 15.2527 15.5444 15.5444C15.2527 15.8361 14.857 16 14.4444 16H1.55556C1.143 16 0.747335 15.8361 0.455612 15.5444C0.163889 15.2527 0 14.857 0 14.4444V1.55556C0 0.696889 0.696889 0 1.55556 0ZM14.4444 1.33333H1.55556C1.49662 1.33333 1.4401 1.35675 1.39842 1.39842C1.35675 1.4401 1.33333 1.49662 1.33333 1.55556V14.4444C1.33333 14.5671 1.43289 14.6667 1.55556 14.6667H1.72444L10.456 5.93511C10.6004 5.79065 10.7719 5.67605 10.9607 5.59787C11.1494 5.51968 11.3517 5.47944 11.556 5.47944C11.7603 5.47944 11.9626 5.51968 12.1513 5.59787C12.3401 5.67605 12.5116 5.79065 12.656 5.93511L14.6667 7.94578V1.55556C14.6667 1.49662 14.6433 1.4401 14.6016 1.39842C14.5599 1.35675 14.5034 1.33333 14.4444 1.33333ZM14.6667 9.83111L11.7129 6.87733C11.6922 6.85664 11.6677 6.84022 11.6407 6.82902C11.6137 6.81781 11.5848 6.81205 11.5556 6.81205C11.5263 6.81205 11.4974 6.81781 11.4704 6.82902C11.4434 6.84022 11.4189 6.85664 11.3982 6.87733L3.60978 14.6667H14.4444C14.5034 14.6667 14.5599 14.6433 14.6016 14.6016C14.6433 14.5599 14.6667 14.5034 14.6667 14.4444V9.83111ZM4.88889 7.11111C4.29952 7.11111 3.73429 6.87699 3.31754 6.46024C2.90079 6.04349 2.66667 5.47826 2.66667 4.88889C2.66667 4.29952 2.90079 3.73429 3.31754 3.31754C3.73429 2.90079 4.29952 2.66667 4.88889 2.66667C5.47826 2.66667 6.04349 2.90079 6.46024 3.31754C6.87699 3.73429 7.11111 4.29952 7.11111 4.88889C7.11111 5.47826 6.87699 6.04349 6.46024 6.46024C6.04349 6.87699 5.47826 7.11111 4.88889 7.11111ZM4.88889 5.77778C5.12464 5.77778 5.35073 5.68413 5.51743 5.51743C5.68413 5.35073 5.77778 5.12464 5.77778 4.88889C5.77778 4.65314 5.68413 4.42705 5.51743 4.26035C5.35073 4.09365 5.12464 4 4.88889 4C4.65314 4 4.42705 4.09365 4.26035 4.26035C4.09365 4.42705 4 4.65314 4 4.88889C4 5.12464 4.09365 5.35073 4.26035 5.51743C4.42705 5.68413 4.65314 5.77778 4.88889 5.77778Z");e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#f4f4f5",e.textAlign="left",e.clip(),e.fillText(this.text,36,12),e.translate(8,1),e.fillStyle="#f4f4f5",e.fill(t),e.restore()}};class m_ extends hs{static type="Track";constructor(e){super(e),this.fill="#18181b"}_render(e){super._render(e);const t=new Path2D("M14.4444 13.3263H11.0667C12.5384 12.3991 13.6259 10.9716 14.1289 9.30644C14.632 7.64131 14.5169 5.85051 13.8048 4.26348C13.0927 2.67645 11.8314 1.39993 10.2531 0.668736C8.67478 -0.0624548 6.8855 -0.199136 5.21442 0.283835C3.54334 0.766806 2.10285 1.83695 1.15794 3.2974C0.213035 4.75785 -0.172743 6.51038 0.0715766 8.23261C0.315896 9.95484 1.17388 11.5309 2.4877 12.671C3.80151 13.811 5.4828 14.4383 7.22227 14.4374H14.4444C14.5918 14.4374 14.7331 14.3789 14.8373 14.2747C14.9415 14.1705 15 14.0292 15 13.8819C15 13.7345 14.9415 13.5932 14.8373 13.489C14.7331 13.3848 14.5918 13.3263 14.4444 13.3263ZM1.1112 7.21523C1.1112 6.00658 1.46961 4.82506 2.14111 3.8201C2.8126 2.81514 3.76702 2.03187 4.88367 1.56934C6.00032 1.10681 7.22905 0.985789 8.41449 1.22159C9.59992 1.45738 10.6888 2.03941 11.5435 2.89405C12.3981 3.7487 12.9801 4.83759 13.2159 6.02302C13.4517 7.20845 13.3307 8.43719 12.8682 9.55384C12.4056 10.6705 11.6224 11.6249 10.6174 12.2964C9.61244 12.9679 8.43093 13.3263 7.22227 13.3263C5.60208 13.3245 4.04878 12.68 2.90313 11.5344C1.75748 10.3887 1.11304 8.83542 1.1112 7.21523ZM7.22227 5.54858C7.55191 5.54858 7.87414 5.45083 8.14822 5.2677C8.4223 5.08456 8.63592 4.82426 8.76206 4.51972C8.88821 4.21518 8.92121 3.88007 8.85691 3.55677C8.7926 3.23347 8.63386 2.9365 8.40078 2.70342C8.16769 2.47033 7.87072 2.3116 7.54742 2.24729C7.22412 2.18298 6.88901 2.21599 6.58447 2.34213C6.27993 2.46828 6.01964 2.6819 5.8365 2.95598C5.65337 3.23006 5.55562 3.55229 5.55562 3.88192C5.55562 4.32395 5.73121 4.74787 6.04377 5.06043C6.35633 5.37298 6.78025 5.54858 7.22227 5.54858ZM7.22227 3.32637C7.33215 3.32637 7.43956 3.35895 7.53092 3.42C7.62228 3.48104 7.69349 3.56781 7.73554 3.66932C7.77759 3.77084 7.78859 3.88254 7.76715 3.9903C7.74572 4.09807 7.6928 4.19706 7.61511 4.27476C7.53741 4.35245 7.43842 4.40536 7.33066 4.4268C7.22289 4.44824 7.11119 4.43723 7.00967 4.39519C6.90816 4.35314 6.82139 4.28193 6.76035 4.19057C6.69931 4.09921 6.66672 3.9918 6.66672 3.88192C6.66672 3.73458 6.72525 3.59327 6.82944 3.48909C6.93363 3.3849 7.07493 3.32637 7.22227 3.32637ZM8.88893 10.5485C8.88893 10.2189 8.79118 9.89668 8.60805 9.6226C8.42491 9.34852 8.16462 9.1349 7.86008 9.00875C7.55553 8.88261 7.22043 8.8496 6.89713 8.91391C6.57383 8.97822 6.27686 9.13695 6.04377 9.37004C5.81069 9.60313 5.65195 9.9001 5.58764 10.2234C5.52334 10.5467 5.55634 10.8818 5.68249 11.1863C5.80863 11.4909 6.02225 11.7512 6.29633 11.9343C6.57041 12.1175 6.89264 12.2152 7.22227 12.2152C7.6643 12.2152 8.08822 12.0396 8.40078 11.727C8.71334 11.4145 8.88893 10.9906 8.88893 10.5485ZM6.66672 10.5485C6.66672 10.4387 6.69931 10.3313 6.76035 10.2399C6.82139 10.1485 6.90816 10.0773 7.00967 10.0353C7.11119 9.99323 7.22289 9.98223 7.33066 10.0037C7.43842 10.0251 7.53741 10.078 7.61511 10.1557C7.6928 10.2334 7.74572 10.3324 7.76715 10.4402C7.78859 10.5479 7.77759 10.6596 7.73554 10.7611C7.69349 10.8627 7.62228 10.9494 7.53092 11.0105C7.43956 11.0715 7.33215 11.1041 7.22227 11.1041C7.07493 11.1041 6.93363 11.0456 6.82944 10.9414C6.72525 10.8372 6.66672 10.6959 6.66672 10.5485ZM10.5556 8.88189C10.8852 8.88189 11.2074 8.78414 11.4815 8.60101C11.7556 8.41787 11.9692 8.15758 12.0954 7.85303C12.2215 7.54849 12.2545 7.21338 12.1902 6.89008C12.1259 6.56678 11.9672 6.26982 11.7341 6.03673C11.501 5.80364 11.204 5.64491 10.8807 5.5806C10.5574 5.51629 10.2223 5.5493 9.91778 5.67544C9.61324 5.80159 9.35295 6.01521 9.16981 6.28929C8.98668 6.56337 8.88893 6.8856 8.88893 7.21523C8.88893 7.65726 9.06452 8.08118 9.37708 8.39374C9.68964 8.70629 10.1136 8.88189 10.5556 8.88189ZM10.5556 6.65968C10.6655 6.65968 10.7729 6.69226 10.8642 6.75331C10.9556 6.81435 11.0268 6.90112 11.0688 7.00263C11.1109 7.10415 11.1219 7.21585 11.1005 7.32362C11.079 7.43138 11.0261 7.53037 10.9484 7.60807C10.8707 7.68576 10.7717 7.73867 10.664 7.76011C10.5562 7.78155 10.4445 7.77054 10.343 7.7285C10.2415 7.68645 10.1547 7.61524 10.0937 7.52388C10.0326 7.43252 10 7.32511 10 7.21523C10 7.06789 10.0586 6.92658 10.1628 6.8224C10.2669 6.71821 10.4082 6.65968 10.5556 6.65968ZM3.88896 5.54858C3.55933 5.54858 3.2371 5.64633 2.96302 5.82946C2.68894 6.01259 2.47532 6.27289 2.34918 6.57743C2.22303 6.88197 2.19002 7.21708 2.25433 7.54038C2.31864 7.86368 2.47737 8.16065 2.71046 8.39374C2.94355 8.62682 3.24052 8.78556 3.56382 8.84986C3.88711 8.91417 4.22222 8.88117 4.52677 8.75502C4.83131 8.62888 5.0916 8.41526 5.27474 8.14118C5.45787 7.8671 5.55562 7.54487 5.55562 7.21523C5.55562 6.77321 5.38003 6.34929 5.06747 6.03673C4.75491 5.72417 4.33099 5.54858 3.88896 5.54858ZM3.88896 7.77078C3.77909 7.77078 3.67168 7.7382 3.58032 7.67716C3.48896 7.61611 3.41775 7.52935 3.3757 7.42783C3.33365 7.32632 3.32265 7.21462 3.34409 7.10685C3.36552 6.99908 3.41843 6.90009 3.49613 6.8224C3.57382 6.7447 3.67281 6.69179 3.78058 6.67036C3.88835 6.64892 4.00005 6.65992 4.10156 6.70197C4.20308 6.74402 4.28984 6.81522 4.35089 6.90658C4.41193 6.99794 4.44452 7.10535 4.44452 7.21523C4.44452 7.36257 4.38598 7.50388 4.2818 7.60807C4.17761 7.71225 4.03631 7.77078 3.88896 7.77078Z");this.items.length||(e.save(),e.translate(-this.width/2,-this.height/2),e.translate(0,12),e.font="600 12px 'Geist variable'",e.fillStyle="#A0A4A2",e.textAlign="left",e.clip(),e.fillText("Drag and drop media here",32,12),e.translate(8,1),e.fillStyle="#A0A4A2",e.fill(t),e.restore())}}class v_ extends co{static type="Helper";constructor(e){e.activeGuideFill="#ffffff",super(e)}}class y_{addTrackItem(e){const t=e.id,n=rd(e,{tScale:this.tScale,sizesMap:this.sizesMap});this.add(n),this.trackItemIds.push(t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=nn(this.trackItemsMap)}alignItemsToTrack(){this.pauseEventListeners();const e=new Map(this.getObjects("Track").map(n=>[n.id,n])),t=this.getObjects("Image","Video","Text","Audio");this.trackItemIds.forEach(n=>{const s=this.tracks.find(c=>c.items.includes(n));if(!s)return;const i=e.get(s.id);this.duration;const a=this.getObjects().find(c=>c.id===n);a&&i&&(a.isMain=!1,this.trackItemsMap[n].isMain=!1,a.set({top:i.top}),a.setCoords())}),e.forEach(n=>{n.items=t.filter(s=>s.top===n.top).map(s=>s.id)}),this.resumeEventListeners()}updateTrackItemsPosition(){const e=this.getObjects("Image","Text","Video","Audio");e.sort((t,n)=>t.top-n.top),this.trackItemIds=e.map(t=>t.id).reverse()}restoreTrackItemPositions(){}updateTrackItemsState(){this.pauseEventListeners();const e=this.getObjects("Image","Video","Text","Audio"),t={};e.forEach(n=>{const{id:s,left:i,width:a}=n,c=this.trackItemsMap[s],u=ss(i,this.tScale),h=u+ss(a,this.tScale),d={from:u,to:h},p={...c,display:d,trim:n instanceof ci||n instanceof Nn?n.trim:void 0};n.display=d,t[s]=p}),this.trackItemsMap=t,this.resumeEventListeners()}deleteActiveTrackItem(){const e=this.getActiveObjects();if(!e.length)return!1;const t=e.map(s=>s.id),n=Qo(this.tracks,t);this.trackItemsMap=Object.keys(this.trackItemsMap).reduce((s,i)=>(t.includes(i)||(s[i]=this.trackItemsMap[i]),s),{}),this.trackItemIds=this.trackItemIds.filter(s=>!t.includes(s)),this.tracks=n,this.discardActiveObject(),this.remove(...e),this.setActiveIds([]),this.renderTracks(),this.alignItemsToTrack(),this.updateState({updateHistory:!0,kind:"remove"})}updateTrackItemsToHistory(){this.pauseEventListeners();const e=this.getObjects();this.trackItemIds.forEach(t=>{const n=this.tracks.find(h=>h.items.includes(t)),s=e.find(h=>h.id===n?.id)?.top;if(!s){console.warn(`Track top not found for trackItemId: ${t}`);return}const i=this.trackItemsMap[t],a=e.find(h=>h.id===t);if(!a){console.warn(`Object not found for trackItemId: ${t}`);return}const c=wt(i.display.from,this.tScale),u=wt(i.display.to-i.display.from,this.tScale);a.set({left:c,width:u,top:s}),a.setCoords()}),this.requestRenderAll(),this.resumeEventListeners()}cloneActiveTrackItem(e){const t=e?.trackItemId||this.activeIds[0];if(!t)return!1;const s={...this.trackItemsMap[t],id:At()},i=this.tracks.find(d=>d.items.includes(t)),a=this.tracks.findIndex(d=>d.id===i?.id)+1;this.findOrCreateTrack(s,{trackIndex:a});const c=rd(s,{tScale:this.tScale});c&&this.add(c);const{audioData:u,...h}=s.metadata||{};s.metadata=h,this.trackItemsMap[s.id]=s,this.trackItemIds.push(s.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}splitActiveTrackItem(e){const t=e.trackItemId??this.activeIds[0];if(!t||this.activeIds.length>1)return!1;const n=this.trackItemsMap[t],s=e.time;if(n.display.from>=s||n.display.to<=s)return!1;const i={...n,display:{from:n.display.from,to:s}},a={...n,display:{from:s,to:n.display.to},id:At()};if(n.type==="video"||n.type==="audio"){const d=s-i.display.from;i.trim={from:n.trim.from,to:n.trim.from+d},a.trim={from:i.trim.to,to:n.trim.to}}const c=this.getObjects().find(d=>d.id===t);c.display=i.display,this.tracks.find(d=>d.items.includes(t))?.items.push(a.id);const h=rd(a,{tScale:this.tScale});h&&this.add(h),this.trackItemsMap[a.id]=a,this.trackItemsMap[t]=i,this.trackItemIds.push(a.id),this.updateTrackItemCoords(i.id),this.alignItemsToTrack(),this.updateTransitions(),this.updateState()}updateTrackItemCoords(e){const t=this.getObjects().find(a=>a.id===e),n=this.trackItemsMap[e],s=wt(n.display.from,this.tScale),i=wt(n.display.to-n.display.from,this.tScale);t?.set({left:s,width:i}),t?.setCoords()}updateTrackItemDetails(e,t){const n=t?.trackItemId;if(!n)return!1;const s=this.trackItemsMap[n],i={...s.details,...e.details};("fontSize"in i||"lineHeight"in i)&&(i.height=qo(i.text,i)),this.trackItemsMap[n]={...s,...e,details:i},this.updateState()}updateTrackItem(e,t){const n=t.trackItemId;if(!n)return!1;const s=this.trackItemsMap[n],i={...s.details,...e.details};if(s.type==="text"&&e.details.text){const a=this.getObjects("Text").find(c=>c.id===n);a instanceof Mp&&(a.text=e.details.text,this.requestRenderAll())}("fontSize"in i||"lineHeight"in i)&&(i.height=qo(i.text,i)),this.trackItemsMap[n]={...s,...e,details:i},this.updateState()}updateTrackItemsDetails(e,t){t?.trackItemIds?.forEach((n,s)=>{const i=this.trackItemsMap[n],a={...i.details,...e[s].details};("fontSize"in a||"lineHeight"in a)&&(a.height=qo(a.text,a)),this.trackItemsMap[n]={...i,...e[s],details:a}}),this.updateState()}getTrackItems(){return this.getObjects(...PF)}setActiveTrackItemCoords(){this.getActiveObjects().forEach(e=>e.setCoords())}deleteTrackItemById(e){const t=this.getObjects().filter(n=>e.includes(n.id));this.tracks=Qo(this.tracks,e),this.trackItemsMap=Object.keys(this.trackItemsMap).filter(n=>!e.includes(n)).reduce((n,s)=>(n[s]=this.trackItemsMap[s],n),{}),this.trackItemIds=this.trackItemIds.filter(n=>!e.includes(n)),this.discardActiveObject(),this.remove(...t),this.renderTracks(),this.alignItemsToTrack(),this.calcBounding(),this.duration=nn(this.trackItemsMap)}selectTrackItemByIds(e){const t=this.getActiveObjects().map(s=>s.id);if(ze.isEqual(t,e))return;const n=this.getTrackItems().filter(s=>e.includes(s.id));if(n.length===0)this.discardActiveObject();else if(n.length===1)this.setActiveObject(n[0]);else{const s=new gn(n);this.setActiveObject(s)}this.requestRenderAll()}}const PF=["Image","Text","Video","Audio","Caption","Template"],rd=(r,e)=>{const n={text:u_,video:l_,image:c_,audio:a_}[r.type];return n(r,e)},Ai={text:32,image:40,video:40,audio:32,main:40},Q0=r=>{switch(r){case"text":return Ai.text;case"image":return Ai.image;case"video":return Ai.video;case"audio":return Ai.audio;case"helperTop":return 40;case"helperBottom":return 40;case"helperCenter":return 8;case"main":return Ai.main;default:return Ai.text}};class b_{findOrCreateTrack(e,{trackId:t,trackIndex:n}){const s=t;if(s){const a=this.tracks.find(c=>c.id===s);if(a)return a.items.push(e.id),s}const i={id:At(),items:[e.id],type:e.type,accepts:this.acceptsMap?.[e.type]};return n!==void 0?this.tracks.splice(n,0,i):this.tracks.push(i),this.renderTracks(),i.id}removeTracks(){this.getObjects("Track","Helper")?.forEach(e=>this.remove(e))}renderTracks(){this.updateTracksState(),this.removeTracks();const e=this.width,t=this.tracks.flatMap(c=>[c,{id:`after-${c.id}`,type:"helper",items:[],accepts:[]}]).slice(0,-1);let n=0;const s=ne.getClass("Helper")||co,i=new s({id:"helperLineTop",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"top",metadata:{}});n+=Q0("helperTop"),this.insertAt(0,i),t.forEach((c,u)=>{if(c.type==="helper"){const h=Q0("helperCenter"),d=new s({id:c.id,top:n,tScale:this.tScale,width:e,height:h,metadata:{order:(u+1)/2},kind:"center"});n+=h,this.insertAt(0,d)}else{const h=ne.getClass("Track")||hs,d=new h({id:c.id,top:n,left:0,fill:"#18181b",height:42,width:e,tScale:this.tScale,accepts:this.acceptsMap?.[c.type]||[],items:c.items});n+=42,this.insertAt(0,d)}});const a=new s({id:"helperLineBottom",top:n,selectable:!1,evented:!1,tScale:this.tScale,width:e,kind:"bottom",metadata:{}});this.insertAt(0,a)}updateTracksState(){const e=this.tracks.filter(n=>n.items.length||n.type==="main"),t=new Map;e.forEach(n=>t.set(n.id,n)),this.tracks=Array.from(t.values())}updateTrackCoords(){const e=this.bounding.width+this.spacing.right;this.getObjects("Track","Helper").forEach(t=>{t.updateCoords(e),t.setCoords()})}}const DF=60,RF=188;function ey(r,e=1,t=1){const n=RF*e;return r*(DF/1e3)*n/t}class w_{removeTransitions(){const e=this.getObjects("Transition");this.remove(...e)}renderTransitions(){this.removeTransitions(),this.transitionIds.forEach(e=>{const t=this.transitionsMap[e],n=t.fromId,s=t.toId,i=this.getObjects(),a=i.find(g=>g.id===n),c=i.find(g=>g.id===s);if(!a||!c)return;const u=ey(t.duration,this.tScale),h=a.left+a.width-u/2,d=a.height,p=new zr({id:t.id,left:h,top:a.top,height:d,width:u,tScale:this.tScale,duration:t.duration,fromId:a.id,toId:c.id,kind:t.kind});t.kind==="none"&&(p.visible=!1),this.add(p)})}updateTransitionCoordinates(){this.pauseEventListeners(),this.getObjects("Transition").forEach(e=>{e.tScale=this.tScale,e.updateCoords(),e.setCoords()}),this.resumeEventListeners()}alignTransitionsToTrack(){this.pauseEventListeners(),this.transitionIds.forEach(e=>{const t=this.getObjects("Transition").find(n=>n.id===e);if(t instanceof zr){const n=this.getObjects().find(a=>a.id===t.fromId);if(!n)return;const s=ey(t.duration,this.tScale),i=n.left+n.width-s/2;t.set({left:i,top:n.top}),t.setCoords()}}),this.resumeEventListeners()}updateTransitions(e=!0){e&&this.pauseEventListeners();const t=this.getObjects("Track"),n=this.getObjects("Video","Image");this.removeTransitions();const s={},i=[];t.forEach(a=>{const c=n.filter(u=>a.items.includes(u.id)).sort((u,h)=>u.left-h.left);for(let u=0;u<c.length-1;u++){const h=c[u],d=c[u+1];if(Math.abs(h.left+h.width-d.left)<=1){const p=`${h.id}-${d.id}`;if(this.transitionIds.includes(p))s[p]=this.transitionsMap[p];else{const g={id:p,duration:1500,fromId:h.id,toId:d.id,kind:"none",trackId:a.id,type:"transition"};s[p]=g}i.push(p)}}}),this.transitionIds=i,this.transitionsMap=s,this.renderTransitions(),e&&this.resumeEventListeners()}}const ee={canvas:null,enableGuideRedraw:!0,isPointerOverHelperTrack:!1,draggingOverTrack:null,primaryMovingObjects:[],secondaryMovingObjects:[],placeholderMovingObjects:[],objectInitialPositions:{},originTrack:{},trackToItemsMap:{},activeTrackToItemsMap:{},trackTopToIdMap:{},trackTops:[],activeObjects:[],primaryTracks:{},secondaryTracks:{}},dt={guide:null,object:null,objects:[]},jF=()=>ee,FF=r=>{Object.assign(ee,r)},LF=r=>{r.on("before:transform",x_.bind(r))},NF=r=>{r.off("before:transform",x_.bind(r))};function x_(r){ee.canvas=this,ee.activeTrackToItemsMap={},ee.primaryTracks={},ee.secondaryTracks={},ee.trackTops=[],ee.trackToItemsMap={},ee.activeObjects=[],ee.trackTopToIdMap={},ee.canvas.trackIdAfterTransform="",ee.canvas.positionAfterTransform={};const e=ee.canvas.getActiveObject();if(!e)return;ee.activeObjects=e instanceof gn?e.getObjects():[e];const t=ee.canvas.getScenePoint(r.e),n=ee.canvas.getObjects("Track");ee.originTrack=n.find(a=>{const c=a.getBoundingRect();return t.x>=c.left&&t.x<=c.left+c.width&&t.y>=c.top&&t.y<=c.top+c.height})??{};const s=ee.canvas.getObjects("Video","Image","Audio","Text","Element");n.forEach(a=>{const c=s.filter(u=>a.items.includes(u.id));ee.trackToItemsMap[a.id]=c,ee.trackTopToIdMap[a.top]=a.id,ee.trackTops.push(a.top)}),ee.trackTops.sort((a,c)=>a-c),ee.activeObjects.forEach(a=>{const c=n?.find(h=>h.items.includes(a.id));if(!c)return;const u=c.id;ee.activeTrackToItemsMap[u]?ee.activeTrackToItemsMap[u].push(a):ee.activeTrackToItemsMap[u]=[a]}),ee.primaryMovingObjects=ee.activeObjects.filter(a=>{const c=a.getBoundingRect();return t.y>=c.top&&t.y<=c.top+c.height&&!(a instanceof zr)}),ee.primaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=ee.trackTopToIdMap[c];if(ee.primaryTracks[u])ee.primaryTracks[u].objects.push(a);else{const h=tf(ee.trackTops,ee.originTrack.top,c);if(typeof h!="number")return;ee.primaryTracks[u]={objects:[a],index:h}}}),ee.primaryMovingObjects=ee.primaryMovingObjects.sort((a,c)=>a.left-c.left),ee.secondaryMovingObjects=ee.activeObjects.filter(a=>!ee.primaryMovingObjects.includes(a)&&!(a instanceof zr)),ee.secondaryMovingObjects.forEach(a=>{const c=a.getBoundingRect().top,u=ee.trackTopToIdMap[a.getBoundingRect().top];if(ee.secondaryTracks[u])ee.secondaryTracks[u].objects.push(a);else{const h=tf(ee.trackTops,ee.originTrack.top,c);if(typeof h!="number")return;ee.secondaryTracks[u]={objects:[a],index:h}}}),ee.originTrack&&(ee.canvas.trackOriginBeforeTransform=ee.originTrack.id),e&&(ee.canvas.positionBeforeTransform={top:e.top,left:e.left}),("transform"in r?r.transform:{}).action==="drag"&&(ee.placeholderMovingObjects=ee.primaryMovingObjects.map(a=>{const c=a.getBoundingRect();ee.objectInitialPositions[a.id]={top:c.top,left:c.left};const u=new Wi({id:`${a.id}-placeholder`,left:c.left,top:c.top,width:c.width,height:c.height,for:BF[a.type]});return u.draggedObject=a,u}),ee.canvas.add(...ee.placeholderMovingObjects))}function tf(r,e,t){const n=r.indexOf(e),s=r.indexOf(t);return n===-1||s===-1?null:s-n}const BF={trackitemvideo:"video",trackitemimage:"image",trackitemaudio:"audio",trackitemtext:"text"};function __(r){if(!dt.guide)return!1;r.e.preventDefault();const e=this,t=e.getViewportPoint(r.e);dt.guide.set({left:t.x-16,top:t.y-dt.guide.height/2});const n=VF(t,dt.objects);n&&(dt.object=n,n.strokeDashArray=[5,1],n.setSelected(!0)),dt.objects.forEach(s=>{s!==n&&s.setSelected(!1)}),e.requestRenderAll()}function VF(r,e){let t=1/0,n=null;const s=new V(r.x,r.y);return e.forEach(i=>{const a=zF(i,s);a<t&&(t=a,n=i)}),n}function zF(r,e){return Math.sqrt(Math.pow(r.left-e.x,2)+Math.pow(r.top-e.y,2))}const WF=["transition","image","video","audio","caption","text"];function S_(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(e),{type:n,duration:s=5e3}=t;if(!WF.includes(n))return;const i=this;i.discardActiveObject();const a=wt(s,i.tScale);dt.guide=HF({width:a,height:48,id:"TransitionGuide",left:0,top:0,type:n}),i.add(dt.guide),n==="transition"&&(dt.objects=i.getObjects("Transition"),dt.objects.forEach(c=>{c.visible=!0})),Fe.dispatch(If)}function HF({width:r,height:e,id:t,left:n,top:s,type:i}){return i==="transition"?new aa({top:0,left:0,height:48,width:48,id:"TransitionGuide"}):new ca({top:s,left:n,height:e,width:r,id:t,name:"Rivers in the mountains"})}function C_(){if(!dt.guide)return;Fe.dispatch(Jo);const r=this;UF(dt.objects),r.remove(dt.guide)}function UF(r){r.forEach(e=>{e.strokeDashArray=[],e.setSelected(!1),e.kind==="none"&&(e.visible=!1)})}var $F=typeof global=="object"&&global&&global.Object===Object&&global,YF=typeof self=="object"&&self&&self.Object===Object&&self,Pp=$F||YF||Function("return this")(),ds=Pp.Symbol,T_=Object.prototype,XF=T_.hasOwnProperty,GF=T_.toString,Fo=ds?ds.toStringTag:void 0;function qF(r){var e=XF.call(r,Fo),t=r[Fo];try{r[Fo]=void 0;var n=!0}catch{}var s=GF.call(r);return n&&(e?r[Fo]=t:delete r[Fo]),s}var KF=Object.prototype,ZF=KF.toString;function JF(r){return ZF.call(r)}var QF="[object Null]",eL="[object Undefined]",ty=ds?ds.toStringTag:void 0;function Dp(r){return r==null?r===void 0?eL:QF:ty&&ty in Object(r)?qF(r):JF(r)}function Rp(r){return r!=null&&typeof r=="object"}var tL="[object Symbol]";function jp(r){return typeof r=="symbol"||Rp(r)&&Dp(r)==tL}function rL(r,e){for(var t=-1,n=r==null?0:r.length,s=Array(n);++t<n;)s[t]=e(r[t],t,r);return s}var Ea=Array.isArray,ry=ds?ds.prototype:void 0,ny=ry?ry.toString:void 0;function E_(r){if(typeof r=="string")return r;if(Ea(r))return rL(r,E_)+"";if(jp(r))return ny?ny.call(r):"";var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function Cl(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function nL(r){return r}var sL="[object AsyncFunction]",iL="[object Function]",oL="[object GeneratorFunction]",aL="[object Proxy]";function cL(r){if(!Cl(r))return!1;var e=Dp(r);return e==iL||e==oL||e==sL||e==aL}var nd=Pp["__core-js_shared__"],sy=function(){var r=/[^.]+$/.exec(nd&&nd.keys&&nd.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function lL(r){return!!sy&&sy in r}var uL=Function.prototype,hL=uL.toString;function dL(r){if(r!=null){try{return hL.call(r)}catch{}try{return r+""}catch{}}return""}var fL=/[\\^$.*+?()[\]{}|]/g,pL=/^\[object .+?Constructor\]$/,gL=Function.prototype,mL=Object.prototype,vL=gL.toString,yL=mL.hasOwnProperty,bL=RegExp("^"+vL.call(yL).replace(fL,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wL(r){if(!Cl(r)||lL(r))return!1;var e=cL(r)?bL:pL;return e.test(dL(r))}function xL(r,e){return r?.[e]}function Fp(r,e){var t=xL(r,e);return wL(t)?t:void 0}function _L(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var SL=800,CL=16,TL=Date.now;function EL(r){var e=0,t=0;return function(){var n=TL(),s=CL-(n-t);if(t=n,s>0){if(++e>=SL)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function kL(r){return function(){return r}}var Tl=function(){try{var r=Fp(Object,"defineProperty");return r({},"",{}),r}catch{}}(),IL=Tl?function(r,e){return Tl(r,"toString",{configurable:!0,enumerable:!1,value:kL(e),writable:!0})}:nL,AL=EL(IL),OL=9007199254740991,ML=/^(?:0|[1-9]\d*)$/;function k_(r,e){var t=typeof r;return e=e??OL,!!e&&(t=="number"||t!="symbol"&&ML.test(r))&&r>-1&&r%1==0&&r<e}function PL(r,e,t){e=="__proto__"&&Tl?Tl(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}function I_(r,e){return r===e||r!==r&&e!==e}var DL=Object.prototype,RL=DL.hasOwnProperty;function jL(r,e,t){var n=r[e];(!(RL.call(r,e)&&I_(n,t))||t===void 0&&!(e in r))&&PL(r,e,t)}var iy=Math.max;function FL(r,e,t){return e=iy(e===void 0?r.length-1:e,0),function(){for(var n=arguments,s=-1,i=iy(n.length-e,0),a=Array(i);++s<i;)a[s]=n[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=n[s];return c[e]=t(a),_L(r,this,c)}}var LL=9007199254740991;function NL(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=LL}var BL="[object Arguments]";function oy(r){return Rp(r)&&Dp(r)==BL}var A_=Object.prototype,VL=A_.hasOwnProperty,zL=A_.propertyIsEnumerable,O_=oy(function(){return arguments}())?oy:function(r){return Rp(r)&&VL.call(r,"callee")&&!zL.call(r,"callee")},WL=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,HL=/^\w*$/;function UL(r,e){if(Ea(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||jp(r)?!0:HL.test(r)||!WL.test(r)||e!=null&&r in Object(e)}var la=Fp(Object,"create");function $L(){this.__data__=la?la(null):{},this.size=0}function YL(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var XL="__lodash_hash_undefined__",GL=Object.prototype,qL=GL.hasOwnProperty;function KL(r){var e=this.__data__;if(la){var t=e[r];return t===XL?void 0:t}return qL.call(e,r)?e[r]:void 0}var ZL=Object.prototype,JL=ZL.hasOwnProperty;function QL(r){var e=this.__data__;return la?e[r]!==void 0:JL.call(e,r)}var e8="__lodash_hash_undefined__";function t8(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=la&&e===void 0?e8:e,this}function qs(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}qs.prototype.clear=$L;qs.prototype.delete=YL;qs.prototype.get=KL;qs.prototype.has=QL;qs.prototype.set=t8;function r8(){this.__data__=[],this.size=0}function hu(r,e){for(var t=r.length;t--;)if(I_(r[t][0],e))return t;return-1}var n8=Array.prototype,s8=n8.splice;function i8(r){var e=this.__data__,t=hu(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():s8.call(e,t,1),--this.size,!0}function o8(r){var e=this.__data__,t=hu(e,r);return t<0?void 0:e[t][1]}function a8(r){return hu(this.__data__,r)>-1}function c8(r,e){var t=this.__data__,n=hu(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}function lo(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}lo.prototype.clear=r8;lo.prototype.delete=i8;lo.prototype.get=o8;lo.prototype.has=a8;lo.prototype.set=c8;var l8=Fp(Pp,"Map");function u8(){this.size=0,this.__data__={hash:new qs,map:new(l8||lo),string:new qs}}function h8(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function du(r,e){var t=r.__data__;return h8(e)?t[typeof e=="string"?"string":"hash"]:t.map}function d8(r){var e=du(this,r).delete(r);return this.size-=e?1:0,e}function f8(r){return du(this,r).get(r)}function p8(r){return du(this,r).has(r)}function g8(r,e){var t=du(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}function li(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}li.prototype.clear=u8;li.prototype.delete=d8;li.prototype.get=f8;li.prototype.has=p8;li.prototype.set=g8;var m8="Expected a function";function Lp(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(m8);var t=function(){var n=arguments,s=e?e.apply(this,n):n[0],i=t.cache;if(i.has(s))return i.get(s);var a=r.apply(this,n);return t.cache=i.set(s,a)||i,a};return t.cache=new(Lp.Cache||li),t}Lp.Cache=li;var v8=500;function y8(r){var e=Lp(r,function(n){return t.size===v8&&t.clear(),n}),t=e.cache;return e}var b8=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,w8=/\\(\\)?/g,x8=y8(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(b8,function(t,n,s,i){e.push(s?i.replace(w8,"$1"):n||t)}),e});function _8(r){return r==null?"":E_(r)}function fu(r,e){return Ea(r)?r:UL(r,e)?[r]:x8(_8(r))}function Np(r){if(typeof r=="string"||jp(r))return r;var e=r+"";return e=="0"&&1/r==-1/0?"-0":e}function S8(r,e){e=fu(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Np(e[t++])];return t&&t==n?r:void 0}function C8(r,e){for(var t=-1,n=e.length,s=r.length;++t<n;)r[s+t]=e[t];return r}var ay=ds?ds.isConcatSpreadable:void 0;function T8(r){return Ea(r)||O_(r)||!!(ay&&r&&r[ay])}function E8(r,e,t,n,s){var i=-1,a=r.length;for(t||(t=T8),s||(s=[]);++i<a;){var c=r[i];t(c)?C8(s,c):s[s.length]=c}return s}function k8(r){var e=r==null?0:r.length;return e?E8(r):[]}function I8(r){return AL(FL(r,void 0,k8),r+"")}function A8(r,e){return r!=null&&e in Object(r)}function O8(r,e,t){e=fu(e,r);for(var n=-1,s=e.length,i=!1;++n<s;){var a=Np(e[n]);if(!(i=r!=null&&t(r,a)))break;r=r[a]}return i||++n!=s?i:(s=r==null?0:r.length,!!s&&NL(s)&&k_(a,s)&&(Ea(r)||O_(r)))}function M8(r,e){return r!=null&&O8(r,e,A8)}function P8(r,e,t,n){if(!Cl(r))return r;e=fu(e,r);for(var s=-1,i=e.length,a=i-1,c=r;c!=null&&++s<i;){var u=Np(e[s]),h=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(s!=a){var d=c[u];h=void 0,h===void 0&&(h=Cl(d)?d:k_(e[s+1])?[]:{})}jL(c,u,h),c=c[u]}return r}function D8(r,e,t){for(var n=-1,s=e.length,i={};++n<s;){var a=e[n],c=S8(r,a);t(c,a)&&P8(i,fu(a,r),c)}return i}function R8(r,e){return D8(r,e,function(t,n){return M8(r,n)})}var j8=I8(function(r,e){return r==null?{}:R8(r,e)});function M_(r){const e=r.e.dataTransfer?.types[0];if(!e)return;const t=JSON.parse(r.e.dataTransfer.getData(e)),n=this;if(t.type!=="transition"){F8(t),n.remove(dt.guide),n.requestRenderAll(),Fe.dispatch(Jo);return}dt.guide&&(dt.object&&L8(t,n),dt.objects.forEach(s=>{s.strokeDashArray=[],s.setSelected(!1),s.kind==="none"&&(s.visible=!1)}),n.remove(dt.guide),n.requestRenderAll(),Fe.dispatch(Jo))}function F8(r){const e={...r,id:At()};switch(r.type){case"image":Fe.dispatch(Gi,{payload:e});break;case"video":Fe.dispatch(Yi,{payload:e});break;case"audio":Fe.dispatch(Xi,{payload:e});break}}function L8(r,e){const t=dt.object?.id,n=j8(r,["kind","direction"]);Object.entries(n).forEach(([s,i])=>{s==="kind"?dt.object.kind=i:dt.object[s]=i}),e.transitionsMap[t]={...e.transitionsMap[t],...n},e.updateState()}const N8=r=>{r.on("dragover",__),r.on("dragenter",S_),r.on("dragleave",C_),r.on("drop",M_)},B8=r=>{r.off("dragover",__),r.off("dragenter",S_),r.off("dragleave",C_),r.off("drop",M_)},P_=r=>{const e=r.target.canvas,t=r.target;if(r.action==="resizing"&&t instanceof zr&&e){const n=t.id,s=e.getObjects("Transition").find(i=>i.id===n);if(s&&s instanceof zr){const i=ze.cloneDeep(e.transitionsMap),a={...i,[n]:{...i[n],width:s.width,duration:s.duration}};e.transitionsMap=a,e.updateState()}}e&&(V8(e,e.getObjects()),z8(e.getObjects("Helper")),ee.isPointerOverHelperTrack=!1,ee.draggingOverTrack=null)},V8=(r,e)=>{e.forEach(t=>{t.isAlignmentAuxiliary&&r.remove(t)})},z8=r=>{r.forEach(e=>e.setSelected(!1))};function D_(r){const e=r.target.canvas;if(!e)return;const t=e.getActiveObject();if(!t||!e.positionBeforeTransform)return;const n=e.getScenePoint(r.e),s=e.getObjects("Track","Helper").find(i=>{const a=i.getBoundingRect();return n.x>=a.left&&n.x<=a.left+a.width&&n.y>=a.top&&n.y<=a.top+a.height});if(r.action==="resizing"){const i=(ee.trackToItemsMap[ee.originTrack.id]||[]).filter(c=>c!==t);t.setCoords();const a=pu(i,t.getBoundingRect());return e.fire("track-items:resized",{trackId:ee.originTrack.id,trackItemIds:[t.id],isOverlapped:!!a}),!1}if(!s)return t&&(t?.set(e.positionBeforeTransform),t?.setCoords()),!1;if(s instanceof co){let i;switch(s.kind){case"top":i=0;break;case"center":i=s.metadata.order||0;break;case"bottom":i=-1;break;default:return}const a={isSecondaryOverlapped:!1,secondaryTracks:ee.secondaryTracks,primaryTracks:ee.primaryTracks,primaryPositions:{trackIndex:i,trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};$8(a)}else if(s instanceof hs){const i={isSecondaryOverlapped:H8(),secondaryTracks:ee.secondaryTracks,primaryTracks:ee.primaryTracks,primaryPositions:{trackId:e.trackIdAfterTransform,positions:e.positionAfterTransform}};W8(i)}}const W8=r=>{ee.canvas&&ee.canvas.fire("track-items:moved",r)};function H8(){const r=U8();return Object.keys(r).some(e=>{const t=ee.trackToItemsMap[e],n=r[e].objects;return t?.length?t.filter(s=>!n.includes(s)).some(s=>pu(n,s.getBoundingRect())):!0})}function U8(){const[r]=ee.primaryMovingObjects,e=r.id,n=ee.canvas.positionAfterTransform[e].top-r.getBoundingRect().top,s={};return ee.secondaryMovingObjects.forEach(i=>{const a=i.getBoundingRect().top+n,c=ee.trackTopToIdMap[a],u=tf(ee.trackTops,ee.originTrack.top,a);s[c]?s[c].objects.push(i):s[c]={objects:[i],index:u}}),s}const $8=r=>{ee.canvas&&ee.canvas.fire("track:create",r)};function pu(r,e){return r.find(t=>{const n=t.getBoundingRect();return e.left<n.left+n.width&&e.left+e.width>n.left&&e.top<n.top+n.height&&e.top+e.height>n.top})}const Y8=r=>{r.on("object:modified",P_),r.on("object:modified",D_)},X8=r=>{r.off("object:modified",P_),r.off("object:modified",D_)};function G8(r,e){r.remove(...e),e.length=0}function R_(){G8(this,ee.placeholderMovingObjects)}function j_(r){const e=this.height<this.bounding.height,t=this.width<this.bounding.width;if(!e&&!t)return;const n=this.viewportTransform;let s=n[4],i=n[5];const a=2;r.e.shiftKey?s=n[4]-r.e.deltaY*a:(e&&(i=n[5]-r.e.deltaY*a),s=n[4]-r.e.deltaX*a),this.setViewportPos(s,i)}const q8=r=>{r.on("mouse:wheel",j_),r.on("mouse:up",R_.bind(r))},K8=r=>{r.off("mouse:wheel",j_),r.off("mouse:up",R_.bind(r))};function F_(r){const e=this;if(!e)return;const t=e.getScenePoint(r.e),n=e.getObjects("Helper","Track");ee.draggingOverTrack=n.find(h=>{const d=h.getBoundingRect();return t.x>=d.left&&t.x<=d.left+d.width&&t.y>=d.top&&t.y<=d.top+d.height})??null,n.forEach(h=>{if(ly(h)){const d=ee.draggingOverTrack;h.setSelected(h===d)}}),ee.isPointerOverHelperTrack=ly(ee.draggingOverTrack),e.getObjects();const s=r.target;s.getBoundingRect(),s.setCoords();const i=[s,...e.getActiveObjects(),...e.getObjects("Track","Helper","Transition","Placeholder")],a=Z8(i,e),c=Q8(s);J8(a,c).forEach(h=>{h.orientation==="V"?s.left=h.lineGuide+h.offset:s.top=h.lineGuide+h.offset})}const Z8=(r,e)=>{const t=[],n=[];return e.getObjects().filter(s=>s.visible).forEach(s=>{if(r.some(c=>c.id===s.id)||s.isAlignmentAuxiliary)return;const a=s.getBoundingRect();t.push(cy(a.left,a.width,a.top,a.height)),n.push(cy(a.top,a.height,a.left,a.width))}),{vertical:t.flat(),horizontal:[]}},cy=(r,e,t,n)=>[r,r+e].map(s=>({val:s,start:t,end:t+n})),J8=(r,e)=>{const t=[],n=[];r.vertical.forEach(u=>{e.vertical.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&t.push({lineGuide:u.val,diff:d,orientation:"V",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})}),r.horizontal.forEach(u=>{e.horizontal.forEach(h=>{const d=Math.abs(u.val-h.guide);d<10&&n.push({lineGuide:u.val,diff:d,orientation:"H",snap:h.snap,offset:h.offset,targetDim:{start:u.start,end:u.end}})})});const i=[],a=t.sort((u,h)=>u.diff-h.diff)[0],c=n.sort((u,h)=>u.diff-h.diff)[0];return a&&i.push({lineGuide:a.lineGuide,offset:a.offset,orientation:"V",snap:a.snap,targetDim:a.targetDim}),c&&i.push({lineGuide:c.lineGuide,offset:c.offset,orientation:"H",snap:c.snap,targetDim:c.targetDim}),i},Q8=r=>{const e=r.getBoundingRect();return{vertical:[{guide:Math.round(e.left),offset:Math.round(r.left-e.left),snap:"start"},{guide:Math.round(e.left+e.width),offset:Math.round(r.left-e.left-e.width),snap:"end"}],horizontal:[{guide:Math.round(e.top),offset:Math.round(r.top-e.top),snap:"start"},{guide:Math.round(e.top+e.height),offset:Math.round(r.top-e.top-e.height),snap:"end"}]}},ly=r=>r instanceof co;function e7(r){r.opacity=ee.isPointerOverHelperTrack?0:1}const L_=a7(r=>{const e=r.target.canvas;if(c7(r),!ee.draggingOverTrack)return;const t=ee.placeholderMovingObjects.map(i=>i.draggedObject),n=(ee.trackToItemsMap[ee.draggingOverTrack.id]||[]).filter(i=>!t.includes(i)),s=n.find(i=>pu(t,i.getBoundingRect()));ee.placeholderMovingObjects.forEach(i=>{const a=i.draggedObject;a?.setCoords(),e7(i);const c=t7(a,n,s,ee.placeholderMovingObjects.length>1);e.trackIdAfterTransform=ee.trackTopToIdMap[c.top],e.positionAfterTransform[a?.id]={top:c.top,left:c.left},i.left=c.left,i.top=c.top})},5),t7=(r,e,t,n)=>!r7(r)||n&&t?N_(r):t?n7(r,t,e):o7(r),r7=r=>ee.draggingOverTrack?ee.draggingOverTrack.accepts?.includes(r.type)??!1:!1,N_=r=>({top:ee.objectInitialPositions[r.id].top,left:ee.objectInitialPositions[r.id].left}),n7=(r,e,t)=>{const n=s7(r,e);return!i7(t,r,n)||ee.activeObjects.length!==1?N_(r):{left:n,top:e.top}},s7=(r,e)=>{const t=r.left+r.width/2,n=e.left+e.width/2;return t<n?e.left-r.width:e.left+e.width},i7=(r,e,t)=>!(t<0||pu(r,{...e.getBoundingRect(),left:t})),o7=r=>({left:r.getBoundingRect().left,top:ee.draggingOverTrack?.top??0});function a7(r,e){let t=null;return function(...n){const s=Date.now();(t===null||s-t>=e)&&(t=s,r(...n))}}function c7(r){const e=r.target,t=e.canvas,n=e.top,s=-e.height*.75,i=t.height+e.height*.75;e.top=Math.min(Math.max(n,s),i-e.height);const a=e.left;e.left=Math.max(a,0)}const l7=r=>{r.on("object:moving",F_.bind(r)),r.on("object:moving",L_)},u7=r=>{r.off("object:moving",F_.bind(r)),r.off("object:moving",L_)};function B_(){const r=this,e=r.getActiveObject(),t=r.getActiveObjects().map(n=>n.id);e instanceof Br?(e.borderColor="rgba(0, 216, 214, 0.75)",e.hasControls=!1,e.hoverCursor="default",e.borderScaleFactor=1,e.padding=0,e.getObjects().forEach(n=>{n.setSelected(!0)})):e?.setSelected(!0),this.setActiveIds(t)}function V_(r){const e=this,t=e.getActiveObject();t instanceof Br&&(t.borderColor="transparent",t.hasControls=!1,t.hoverCursor="default"),r.selected.forEach(s=>{s.setSelected(!0)}),r.deselected.forEach(s=>{s.setSelected(!1)});const n=e.getActiveObjects().map(s=>s.id);this.setActiveIds(n)}function z_(r){this.getObjects().forEach(t=>{t.isSelected&&(t.isSelected=!1)}),r.deselected.forEach(t=>{t.setSelected(!1)});const e=this.getActiveObjects().map(t=>t.id);this.setActiveIds(e)}const h7=r=>{r.on("selection:created",B_),r.on("selection:updated",V_),r.on("selection:cleared",z_)},d7=r=>{r.off("selection:created",B_),r.off("selection:updated",V_),r.off("selection:cleared",z_)};let W_,H_,U_;const f7=r=>{const{state:e}=r;W_=e.subscribeToActiveIds(({activeIds:t})=>{if(t.length===1){const n=t[0],{trackItemIds:s,trackItemsMap:i}=e.getState();s.forEach(a=>{i[a].type}),r.selectTrackItemByIds([n])}else r.selectTrackItemByIds(t)}),H_=e.subscribeToHistory(t=>{const{tracks:n,trackItemsMap:s,trackItemIds:i,trackItemDetailsMap:a}=t;r.tracks=n,r.trackItemsMap=s,r.trackItemIds=i,r.trackItemDetailsMap=a,r.renderTracks(),r.updateTrackItemsToHistory(),r.alignItemsToTrack(),r.calcBounding(),r.updateTransitions(),r.duration=nn(r.trackItemsMap)}),U_=e.subscribeToAddOrRemoveItems(()=>{const t=r.getTrackItems().map(c=>c.id),{trackItemIds:n,trackItemsMap:s,trackItemDetailsMap:i}=e.getState(),a=[];t.forEach(c=>{n.includes(c)||a.push(c)}),r.deleteTrackItemById(a),r.tracks=e.getState().tracks,r.trackItemsMap=s,r.trackItemDetailsMap=i,n.forEach(c=>{if(!t.includes(c)){const u={...s[c],details:{...i[c].details}};r.addTrackItem(u)}}),r.renderTracks(),r.alignItemsToTrack(),n.forEach(c=>{r.updateTrackItemCoords(c)}),r.updateTransitions(),r.updateTrackCoords()})},p7=r=>{W_.unsubscribe(),H_.unsubscribe(),U_.unsubscribe()};function $_(r){const{isSecondaryOverlapped:e,secondaryTracks:t,primaryTracks:n,primaryPositions:s}=r,{trackId:i,positions:a}=s,c=this.tracks.findIndex(y=>y.id===i),u=Rf(Object.keys(t).map(y=>t[y].objects.map(b=>b.id))),h=Qo(this.tracks,[...Object.keys(a),...u]);Object.keys(n).forEach(y=>{this.pauseEventListeners();const{objects:b}=n[y];b.forEach(S=>{const T=a[S.id];S.left=T.left}),this.resumeEventListeners();const _=h.find(S=>S.id===i);_&&_.items.push(...Object.keys(a)),this.tracks=h});const d=this.tracks[c],p=[];Object.keys(t).forEach(y=>{const{objects:b,index:_}=t[y],S=b.map(I=>I.id),[T]=S,k=this.trackItemsMap[T];if(e){const I={id:At(),items:S,type:k.type,accepts:this.acceptsMap?.[k.type],tempIndex:_};p.push(I)}else{const I=h[c+_];I&&I.items.push(...S),this.tracks=h}});const g=jf(d,p);g.length&&h.splice(c,1,...g),this.tracks=h,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}function Y_({trackItemIds:r,isOverlapped:e}){const[t]=r;if(t){if(!this.getObjects("Transition").find(n=>n.id===t)){const n=this.tracks.find(s=>s.items.includes(t));if(e){const s=g7(this.tracks,r),i={id:At(),items:[t],type:n?.type,accepts:n?.accepts},a=this.tracks.findIndex(c=>c.id===n?.id);s.splice(a,0,i),this.tracks=s}}this.renderTracks(),this.alignItemsToTrack(),this.alignTransitionsToTrack(),this.updateTransitions(),this.updateTrackItemsPosition(),this.updateState({updateHistory:!0,kind:"update"})}}function g7(r,e){return r.map(t=>({...t,items:t.items.filter(n=>!e.includes(n))}))}function X_(r){const{secondaryTracks:e,primaryTracks:t,primaryPositions:n}=r,{positions:s,trackIndex:i}=n,a=i===-1?this.tracks.length:i,[c]=Object.keys(t),u=this.tracks.find(_=>_.id==c),h=t[c],d={id:At(),items:h.objects.map(_=>_.id),type:u?.type,accepts:u?.accepts},p=Rf(Object.keys(e).map(_=>e[_].objects.map(S=>S.id))),g=Qo(this.tracks,[...Object.keys(s),...p]),y=[];Object.keys(e).forEach(_=>{const{objects:S,index:T}=e[_],k=this.tracks.find(D=>D.id==_),I=S.map(D=>D.id),A={id:At(),items:I,type:k?.type,accepts:k?.accepts,tempIndex:T};y.push(A)});const b=jf(d,y);b.length&&g.splice(a,0,...b),this.tracks=g,this.renderTracks(),this.alignItemsToTrack(),this.updateTrackItemsPosition(),this.updateTransitions(),this.updateState({updateHistory:!0,kind:"update"})}const m7=r=>{r.on("track:create",X_.bind(r)),r.on("track-items:resized",Y_.bind(r)),r.on("track-items:moved",$_.bind(r))},v7=r=>{r.off("track:create",X_.bind(r)),r.off("track-items:resized",Y_.bind(r)),r.off("track-items:moved",$_.bind(r))},G_=r=>{N8(r),Y8(r),q8(r),l7(r),m7(r),h7(r),LF(r),f7(r)},q_=r=>{B8(r),X8(r),K8(r),u7(r),v7(r),d7(r),NF(r),p7()},y7={video:["*"],image:["*"],audio:["*"],text:["*"]},b7=["video","image","audio","text"];let gu=class extends Zd{acceptsMap;tracks=[];trackItemsMap={};trackItemIds=[];transitionIds=[];transitionsMap={};trackItemDetailsMap={};bounding;onScroll;tScale;store;state;activeIds=[];spacing;scale;sizesMap;duration;setupFabricDefaults(){Ke.ownDefaults.borderColor="transparent",Ke.ownDefaults.cornerColor="white",Ke.ownDefaults.cornerStrokeColor="transparent",Ke.ownDefaults.strokeWidth=0,Ke.ownDefaults.borderOpacityWhenMoving=1,Ke.ownDefaults.borderScaleFactor=1,Ke.ownDefaults.cornerSize=8,Ke.ownDefaults.cornerStyle="rect",Ke.ownDefaults.centeredScaling=!1,Ke.ownDefaults.centeredRotation=!0,Ke.ownDefaults.transparentCorners=!1}constructor(e,t){super(e,t),this.bounding=t.bounding||{width:t.width||0,height:t.height||0},this.spacing={left:16,right:80,...t.spacing};const n=this.viewportTransform;n[4]=this.spacing.left,this.tScale=t.tScale||1/300,this.store=t.store,this.state=t.state,this.scale=t.scale,this.onScroll=t.onScroll,this.acceptsMap=this.createAcceptsItemMap(t.acceptsMap),this.sizesMap=d_(t.sizesMap),this.setupFabricDefaults(),this.initEventListeners()}createAcceptsItemMap(e=y7){const t={};return Object.keys(e).forEach(n=>{const s=e[n];t[n]=s.includes("*")?b7:s}),t}setActiveIds(e){this.activeIds=e,this.getObjects("Transition").some(n=>e.includes(n.id))||(this.state?.updateState({activeIds:ze.cloneDeep(this.activeIds)}),Fe.dispatch(C1,{payload:{activeIds:this.activeIds}}))}purge(){q_(this),this.dispose()}static registerItems(e){Object.keys(e).forEach(t=>{ne.setClass(e[t],t)})}initEventListeners(){G_(this)}getUpdatedState(){const e=nn(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,scale:this.scale,duration:e}}getState(){const e=nn(this.trackItemsMap);return{tracks:this.tracks,trackItemIds:this.trackItemIds,trackItemsMap:this.trackItemsMap,transitionIds:this.transitionIds,transitionsMap:this.transitionsMap,trackItemDetailsMap:this.trackItemDetailsMap,scale:this.scale,duration:e}}notify(e={updateHistory:!1}){const t=this.getUpdatedState();this.state.updateState(t,e)}updateState(e){this.updateTracksState(),this.updateTrackItemsState(),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords();const t=this.getUpdatedState();this.state.updateState(t,e)}scrollTo({scrollLeft:e,scrollTop:t}){const n=[...this.viewportTransform];let s=!1;if(typeof e=="number"&&(n[4]=-e+this.spacing.left,s=!0),typeof t=="number"&&(n[5]=-t,s=!0),s){this.viewportTransform=n;const i=this.getActiveObject();i&&i.setCoords(),this.requestRenderAll()}}setBoundingBox(e){this.bounding=e}calcBounding(){const e=this.getTrackItems().reduce((t,n)=>{const{left:s,top:i,width:a,height:c}=n.getBoundingRect();return{left:Math.min(t.left,s),top:Math.min(t.top,i),width:Math.max(t.width,s+a),height:Math.max(t.height,i+c)}},{left:1/0,top:1/0,width:this.width,height:0});this.bounding=e,Fe.dispatch(Af,{payload:{bounding:e}})}setScale(e){this.pauseEventListeners(),this.tScale=e.zoom,this.scale=e;const t=this.getState();this.getObjects("Video","Image","Text","Audio").forEach(n=>{const s=t.trackItemsMap[n.id],{from:i,to:a}=s.display,c=wt(i,this.tScale),u=wt(a-i,this.tScale,n.playbackRate);n.set({left:c,width:u,tScale:e.zoom}),n.setCoords()}),this.requestRenderAll(),this.calcBounding(),this.updateTrackCoords(),this.updateTransitions(!1),this.resumeEventListeners(),this.notify()}setViewportPos(e,t){const n=this.getViewportPos(e,t),s=this.viewportTransform;s[4]=n.x,s[5]=n.y,this.requestRenderAll(),this.setActiveTrackItemCoords();const i=this.onScroll;i&&i.call(this,{scrollTop:n.y,scrollLeft:n.x-this.spacing.left})}getViewportPos(e,t){const n=this.bounding.width-100>=this.width?this.spacing.right:0,s=this.width-this.bounding.width-n,i=this.spacing.left,a=Math.max(s,Math.min(e,i));if(this.bounding.height<this.height)return{x:a,y:0};const c=this.height-this.bounding.height-40,u=Math.max(c,Math.min(t,0));return{x:a,y:u}}};Zx(gu,[Yx,y_,b_,w_]);function K_(r){const e=Fe.subject.pipe(Bs(({key:t})=>t.startsWith(E1))).subscribe(t=>{if(t.key===kf){const n=t.value;r.setScale(n?.payload.scale??void 0)}});return{unsubscribe:()=>{e.unsubscribe()}}}gu.registerItems({Text:Mp,Image:g_,Video:p_,Audio:f_,Track:m_,Helper:v_});const w7=({stateManager:r})=>{const e=v.useRef(!1),[t,n]=v.useState(0),s=v.useRef(null),i=v.useRef(null),a=v.useRef(null),c=v.useRef(null),u=v.useRef(null),[h,d]=v.useState({width:0,height:0}),[p,g]=v.useState({width:0,height:0}),{scale:y,playerRef:b,fps:_,setState:S,timeline:T}=is(),{setTimeline:k}=is(),I=Fl(b??void 0),A=L=>{u.current&&c.current&&(c.current.scrollTop=-L.scrollTop,u.current.scrollLeft=-L.scrollLeft,n(-L.scrollLeft))};v.useEffect(()=>{const L=wt(I/_*1e3,y.zoom),Y=i.current?.getBoundingClientRect().x+i.current?.clientWidth;if(L-t+40>=Y){const q=u.current?.clientWidth,U=u.current?.scrollWidth,X=u.current?.scrollLeft,de=(U-(q+X))/q;de>=0&&(de>1?u.current?.scrollTo({left:X+q}):u.current?.scrollTo({left:U-q}))}},[I]),v.useEffect(()=>{const L=i.current,Y=s.current;if(!L||!Y)return;const W=Y.clientWidth,q=Y.clientHeight,U=new gu(L,{width:W,height:q,bounding:{width:W,height:0},selectionColor:"rgba(0, 216, 214,0.1)",selectionBorderColor:"rgba(0, 216, 214,1.0)",onScroll:A,state:r,scale:y,spacing:{left:jl,right:_d}}),X=K_(U);a.current=U,d({width:W,height:q}),g({width:W,height:0}),k(U);const te=r.subscribeToSize(re=>{S(re)}),de=r.subscribeToScale(re=>{S(re)}),J=r.subscribeToTracks(re=>{S(re)}),le=r.subscribeToDuration(re=>{S(re)}),ie=r.subscribeToUpdateTrackItem(()=>{const re=r.getState();S({duration:re.duration,trackItemsMap:re.trackItemsMap})}),se=r.subscribeToAddOrRemoveItems(()=>{const re=r.getState();S({trackItemDetailsMap:re.trackItemDetailsMap,trackItemsMap:re.trackItemsMap,trackItemIds:re.trackItemIds,tracks:re.tracks})}),he=r.subscribeToUpdateItemDetails(()=>{const re=r.getState();S({trackItemDetailsMap:re.trackItemDetailsMap})});return()=>{X.unsubscribe(),U.purge(),de.unsubscribe(),J.unsubscribe(),le.unsubscribe(),se.unsubscribe(),ie.unsubscribe(),he.unsubscribe(),te.unsubscribe()}},[]),v.useEffect(()=>{const Y=Fe.subject.pipe(Bs(({key:W})=>W.startsWith(I1))).subscribe(W=>{if(W.key===Af){const q=W.value?.payload?.bounding;q&&g({width:q.width,height:q.height})}});return()=>{Y.unsubscribe()}},[]);const D=L=>{const Y=L.currentTarget.scrollLeft;e.current&&a.current.scrollTo({scrollLeft:Y}),n(Y)},F=L=>{const Y=L.currentTarget.scrollTop;e.current&&a.current.scrollTo({scrollTop:Y})};v.useEffect(()=>{const L=u.current?.scrollWidth;if(!L||!T)return;const Y=T.width;L<Y+t&&T.scrollTo({scrollLeft:L-Y})},[y]);const z=L=>{if(!a.current)return;const W=ss(L,y.zoom);b?.current?.seekTo(W*_/1e3)};return w.jsxs("div",{className:"relative overflow-hidden h-80 w-full",children:[w.jsx(eb,{}),w.jsx(hw,{onClick:z,scrollLeft:t}),w.jsx(uw,{scrollLeft:t}),w.jsxs("div",{className:"flex",children:[w.jsx("div",{className:"relative w-10 flex-none"}),w.jsxs("div",{className:"relative h-[230px] flex-1",children:[w.jsx("div",{ref:s,className:"absolute top-0 h-[230px] w-full text-sm text-white ",children:w.jsx("canvas",{ref:i,id:"designcombo-timeline-canvas"})}),w.jsxs(rl,{type:"always",style:{position:"absolute",width:"calc(100vw - 40px)",height:"10px"},className:"ScrollAreaRootH",children:[w.jsx(pd,{onScroll:D,className:"ScrollAreaViewport",id:"viewportH",ref:u,children:w.jsx("div",{style:{width:p.width>h.width?p.width+_d:p.width},className:"pointer-events-none h-[10px]"})}),w.jsx(Ev,{className:"ScrollAreaScrollbar",orientation:"horizontal",children:w.jsx(kv,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]}),w.jsxs(rl,{type:"always",style:{position:"absolute",height:"230px",width:"10px"},className:"ScrollAreaRootV",children:[w.jsx(pd,{onScroll:F,className:"ScrollAreaViewport",ref:c,children:w.jsx("div",{style:{height:p.height>h.height?p.height+40:h.height},className:"pointer-events-none w-[10px]"})}),w.jsx(Ev,{className:"ScrollAreaScrollbar",orientation:"vertical",children:w.jsx(kv,{className:"ScrollAreaThumb",onMouseDown:()=>{e.current=!0},onMouseUp:()=>{e.current=!1}})})]})]})]})]})},x7={Date:!0,RegExp:!0,String:!0,Number:!0};function Z_(r,e,t={cyclesFix:!0},n=[]){let s=[];const i=Array.isArray(r);for(const c in r){const u=r[c],h=i?+c:c;if(!(c in e)){s.push({type:"REMOVE",path:[h],oldValue:r[c]});continue}const d=e[c],p=typeof u=="object"&&typeof d=="object"&&Array.isArray(u)===Array.isArray(d);u&&d&&p&&!x7[Object.getPrototypeOf(u)?.constructor?.name]&&(!t.cyclesFix||!n.includes(u))?s.push.apply(s,Z_(u,d,t,t.cyclesFix?n.concat([u]):[]).map(g=>(g.path.unshift(h),g))):u!==d&&!(Number.isNaN(u)&&Number.isNaN(d))&&!(p&&(isNaN(u)?u+""==d+"":+u==+d))&&s.push({path:[h],type:"CHANGE",value:d,oldValue:u})}const a=Array.isArray(e);for(const c in e)c in r||s.push({type:"CREATE",path:[a?+c:c],value:e[c]});return s}var Bp=Symbol.for("immer-nothing"),Ko=Symbol.for("immer-draftable"),Er=Symbol.for("immer-state"),J_=process.env.NODE_ENV!=="production"?[function(r){return`The plugin for '${r}' has not been loaded into Immer. To enable the plugin, import and call \`enable${r}()\` when initializing your application.`},function(r){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${r}'`},"This object has been frozen and should not be mutated",function(r){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+r},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(r){return`'current' expects a draft, got: ${r}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(r){return`'original' expects a draft, got: ${r}`}]:[];function It(r,...e){if(process.env.NODE_ENV!=="production"){const t=J_[r],n=typeof t=="function"?t.apply(null,e):t;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var Ks=Object.getPrototypeOf;function Zs(r){return!!r&&!!r[Er]}function fs(r){return r?Q_(r)||Array.isArray(r)||!!r[Ko]||!!r.constructor?.[Ko]||ka(r)||Ia(r):!1}var _7=Object.prototype.constructor.toString();function Q_(r){if(!r||typeof r!="object")return!1;const e=Ks(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===_7}function ua(r,e){Js(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,n)=>e(n,t,r))}function Js(r){const e=r[Er];return e?e.type_:Array.isArray(r)?1:ka(r)?2:Ia(r)?3:0}function ha(r,e){return Js(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function sd(r,e){return Js(r)===2?r.get(e):r[e]}function eS(r,e,t){const n=Js(r);n===2?r.set(e,t):n===3?r.add(t):r[e]=t}function S7(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function ka(r){return r instanceof Map}function Ia(r){return r instanceof Set}function Rs(r){return r.copy_||r.base_}function rf(r,e){if(ka(r))return new Map(r);if(Ia(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=Q_(r);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(r);delete n[Er];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const a=s[i],c=n[a];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[a]={configurable:!0,writable:!0,enumerable:c.enumerable,value:r[a]})}return Object.create(Ks(r),n)}else{const n=Ks(r);if(n!==null&&t)return{...r};const s=Object.create(n);return Object.assign(s,r)}}function Vp(r,e=!1){return mu(r)||Zs(r)||!fs(r)||(Js(r)>1&&(r.set=r.add=r.clear=r.delete=C7),Object.freeze(r),e&&Object.entries(r).forEach(([t,n])=>Vp(n,!0))),r}function C7(){It(2)}function mu(r){return Object.isFrozen(r)}var nf={};function Qs(r){const e=nf[r];return e||It(0,r),e}function T7(r,e){nf[r]||(nf[r]=e)}var da;function tS(){return da}function E7(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function uy(r,e){e&&(Qs("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function sf(r){of(r),r.drafts_.forEach(k7),r.drafts_=null}function of(r){r===da&&(da=r.parent_)}function hy(r){return da=E7(da,r)}function k7(r){const e=r[Er];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function dy(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[Er].modified_&&(sf(e),It(4)),fs(r)&&(r=El(e,r),e.parent_||kl(e,r)),e.patches_&&Qs("Patches").generateReplacementPatches_(t[Er].base_,r,e.patches_,e.inversePatches_)):r=El(e,t,[]),sf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==Bp?r:void 0}function El(r,e,t){if(mu(e))return e;const n=e[Er];if(!n)return ua(e,(s,i)=>fy(r,n,e,s,i,t)),e;if(n.scope_!==r)return e;if(!n.modified_)return kl(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,a=!1;n.type_===3&&(i=new Set(s),s.clear(),a=!0),ua(i,(c,u)=>fy(r,n,s,c,u,t,a)),kl(r,s,!1),t&&r.patches_&&Qs("Patches").generatePatches_(n,t,r.patches_,r.inversePatches_)}return n.copy_}function fy(r,e,t,n,s,i,a){if(process.env.NODE_ENV!=="production"&&s===t&&It(5),Zs(s)){const c=i&&e&&e.type_!==3&&!ha(e.assigned_,n)?i.concat(n):void 0,u=El(r,s,c);if(eS(t,n,u),Zs(u))r.canAutoFreeze_=!1;else return}else a&&t.add(s);if(fs(s)&&!mu(s)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;El(r,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&kl(r,s)}}function kl(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&Vp(e,t)}function I7(r,e){const t=Array.isArray(r),n={type_:t?1:0,scope_:e?e.scope_:tS(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=zp;t&&(s=[n],i=fa);const{revoke:a,proxy:c}=Proxy.revocable(s,i);return n.draft_=c,n.revoke_=a,c}var zp={get(r,e){if(e===Er)return r;const t=Rs(r);if(!ha(t,e))return A7(r,t,e);const n=t[e];return r.finalized_||!fs(n)?n:n===id(r.base_,e)?(od(r),r.copy_[e]=cf(n,r)):n},has(r,e){return e in Rs(r)},ownKeys(r){return Reflect.ownKeys(Rs(r))},set(r,e,t){const n=rS(Rs(r),e);if(n?.set)return n.set.call(r.draft_,t),!0;if(!r.modified_){const s=id(Rs(r),e),i=s?.[Er];if(i&&i.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(S7(t,s)&&(t!==void 0||ha(r.base_,e)))return!0;od(r),af(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return id(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,od(r),af(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=Rs(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){It(11)},getPrototypeOf(r){return Ks(r.base_)},setPrototypeOf(){It(12)}},fa={};ua(zp,(r,e)=>{fa[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});fa.deleteProperty=function(r,e){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(e))&&It(13),fa.set.call(this,r,e,void 0)};fa.set=function(r,e,t){return process.env.NODE_ENV!=="production"&&e!=="length"&&isNaN(parseInt(e))&&It(14),zp.set.call(this,r[0],e,t,r[0])};function id(r,e){const t=r[Er];return(t?Rs(t):r)[e]}function A7(r,e,t){const n=rS(e,t);return n?"value"in n?n.value:n.get?.call(r.draft_):void 0}function rS(r,e){if(!(e in r))return;let t=Ks(r);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=Ks(t)}}function af(r){r.modified_||(r.modified_=!0,r.parent_&&af(r.parent_))}function od(r){r.copy_||(r.copy_=rf(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var O7=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const a=this;return function(u=i,...h){return a.produce(u,d=>t.call(this,d,...h))}}typeof t!="function"&&It(6),n!==void 0&&typeof n!="function"&&It(7);let s;if(fs(e)){const i=hy(this),a=cf(e,void 0);let c=!0;try{s=t(a),c=!1}finally{c?sf(i):of(i)}return uy(i,n),dy(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===Bp&&(s=void 0),this.autoFreeze_&&Vp(s,!0),n){const i=[],a=[];Qs("Patches").generateReplacementPatches_(e,s,i,a),n(i,a)}return s}else It(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...c)=>this.produceWithPatches(a,u=>e(u,...c));let n,s;return[this.produce(e,t,(a,c)=>{n=a,s=c}),n,s]},typeof r?.autoFreeze=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof r?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){fs(r)||It(8),Zs(r)&&(r=M7(r));const e=hy(this),t=cf(r,void 0);return t[Er].isManual_=!0,of(e),t}finishDraft(r,e){const t=r&&r[Er];(!t||!t.isManual_)&&It(9);const{scope_:n}=t;return uy(n,e),dy(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){r=s.value;break}}t>-1&&(e=e.slice(t+1));const n=Qs("Patches").applyPatches_;return Zs(r)?n(r,e):this.produce(r,s=>n(s,e))}};function cf(r,e){const t=ka(r)?Qs("MapSet").proxyMap_(r,e):Ia(r)?Qs("MapSet").proxySet_(r,e):I7(r,e);return(e?e.scope_:tS()).drafts_.push(t),t}function M7(r){return Zs(r)||It(10,r),nS(r)}function nS(r){if(!fs(r)||mu(r))return r;const e=r[Er];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=rf(r,e.scope_.immer_.useStrictShallowCopy_)}else t=rf(r,!0);return ua(t,(n,s)=>{eS(t,n,nS(s))}),e&&(e.finalized_=!1),t}function py(){process.env.NODE_ENV!=="production"&&J_.push('Sets cannot have "replace" patches.',function(g){return"Unsupported patch operation: "+g},function(g){return"Cannot apply patch, path doesn't resolve: "+g},"Patching reserved attributes like __proto__, prototype and constructor is not allowed");const e="replace",t="add",n="remove";function s(g,y,b,_){switch(g.type_){case 0:case 2:return a(g,y,b,_);case 1:return i(g,y,b,_);case 3:return c(g,y,b,_)}}function i(g,y,b,_){let{base_:S,assigned_:T}=g,k=g.copy_;k.length<S.length&&([S,k]=[k,S],[b,_]=[_,b]);for(let I=0;I<S.length;I++)if(T[I]&&k[I]!==S[I]){const A=y.concat([I]);b.push({op:e,path:A,value:p(k[I])}),_.push({op:e,path:A,value:p(S[I])})}for(let I=S.length;I<k.length;I++){const A=y.concat([I]);b.push({op:t,path:A,value:p(k[I])})}for(let I=k.length-1;S.length<=I;--I){const A=y.concat([I]);_.push({op:n,path:A})}}function a(g,y,b,_){const{base_:S,copy_:T}=g;ua(g.assigned_,(k,I)=>{const A=sd(S,k),D=sd(T,k),F=I?ha(S,k)?e:t:n;if(A===D&&F===e)return;const z=y.concat(k);b.push(F===n?{op:F,path:z}:{op:F,path:z,value:D}),_.push(F===t?{op:n,path:z}:F===n?{op:t,path:z,value:p(A)}:{op:e,path:z,value:p(A)})})}function c(g,y,b,_){let{base_:S,copy_:T}=g,k=0;S.forEach(I=>{if(!T.has(I)){const A=y.concat([k]);b.push({op:n,path:A,value:I}),_.unshift({op:t,path:A,value:I})}k++}),k=0,T.forEach(I=>{if(!S.has(I)){const A=y.concat([k]);b.push({op:t,path:A,value:I}),_.unshift({op:n,path:A,value:I})}k++})}function u(g,y,b,_){b.push({op:e,path:[],value:y===Bp?void 0:y}),_.push({op:e,path:[],value:g})}function h(g,y){return y.forEach(b=>{const{path:_,op:S}=b;let T=g;for(let D=0;D<_.length-1;D++){const F=Js(T);let z=_[D];typeof z!="string"&&typeof z!="number"&&(z=""+z),(F===0||F===1)&&(z==="__proto__"||z==="constructor")&&It(19),typeof T=="function"&&z==="prototype"&&It(19),T=sd(T,z),typeof T!="object"&&It(18,_.join("/"))}const k=Js(T),I=d(b.value),A=_[_.length-1];switch(S){case e:switch(k){case 2:return T.set(A,I);case 3:It(16);default:return T[A]=I}case t:switch(k){case 1:return A==="-"?T.push(I):T.splice(A,0,I);case 2:return T.set(A,I);case 3:return T.add(I);default:return T[A]=I}case n:switch(k){case 1:return T.splice(A,1);case 2:return T.delete(A);case 3:return T.delete(b.value);default:return delete T[A]}default:It(17,S)}}),g}function d(g){if(!fs(g))return g;if(Array.isArray(g))return g.map(d);if(ka(g))return new Map(Array.from(g.entries()).map(([b,_])=>[b,d(_)]));if(Ia(g))return new Set(Array.from(g).map(d));const y=Object.create(Ks(g));for(const b in g)y[b]=d(g[b]);return ha(g,Ko)&&(y[Ko]=g[Ko]),y}function p(g){return Zs(g)?d(g):g}T7("Patches",{applyPatches_:h,generatePatches_:s,generateReplacementPatches_:u})}var kr=new O7,P7=kr.produce;kr.produceWithPatches.bind(kr);kr.setAutoFreeze.bind(kr);kr.setUseStrictShallowCopy.bind(kr);var D7=kr.applyPatches.bind(kr);kr.createDraft.bind(kr);kr.finishDraft.bind(kr);function R7(r){const e=r.value,t=[];if(e?.payload?.trackItemIds){const n=e.payload.trackItemIds;t.push(n),this.updateState({activeIds:t})}if(r.key===_f){const n=r.value?.payload.trackItemIds,s=ze.cloneDeep(this.getState()),i=n?.length?n:s.activeIds,a=s.trackItemIds.filter(p=>!i.includes(p)),c=Object.fromEntries(Object.entries(s.trackItemDetailsMap).filter(([p])=>!i.includes(p))),u=n_(s.tracks,i),h=Object.fromEntries(Object.entries(s.trackItemsMap).filter(([p])=>!i.includes(p))),d=nn(h);this.updateState({trackItemIds:a,trackItemDetailsMap:c,activeIds:[],trackItemsMap:h,tracks:u,duration:d},{updateHistory:!0,kind:"remove"})}if(r.key===Sf){const n=ze.cloneDeep(this.getState()),s=[],i=r.value?.payload.trackItemIds||n.activeIds;if(i.length===0)return;i.forEach(c=>{const u=n.trackItemsMap[c],h=n.trackItemDetailsMap[c],d=At();s.push(d),n.trackItemsMap={...n.trackItemsMap,[d]:{...ze.cloneDeep(u),id:d}},n.trackItemDetailsMap={...n.trackItemDetailsMap,[d]:{...ze.cloneDeep(h)}},n.trackItemIds.push(d)});const a=n.tracks.map(c=>{const u={...c,id:At(),items:c.items.filter(h=>i.includes(h)).map(h=>{const d=i.indexOf(h);return s[d]})};return u.items.length?u:null}).filter(Boolean);n.tracks.unshift(...a),this.updateState({trackItemDetailsMap:n.trackItemDetailsMap,tracks:n.tracks,trackItemIds:n.trackItemIds,trackItemsMap:n.trackItemsMap},{updateHistory:!0,kind:"update"})}if(r.key===Cf){const n=ze.cloneDeep(this.getState()),s=r.value?.options.time;if(n.activeIds.length!==1)return;const i=n.activeIds[0],a=n.trackItemsMap[i];if(s<=a.display.from||s>=a.display.to)return;const c=At(),u={...a,id:c,display:{from:s,to:a.display.to},trim:{from:s,to:a.display.to}};n.trackItemsMap[i].display.to=s,n.trackItemsMap[c]=u,n.trackItemDetailsMap[c]=n.trackItemDetailsMap[i],n.trackItemIds.push(c),n.tracks.forEach(h=>{h.items.includes(i)&&h.items.push(c)}),this.updateState({trackItemsMap:n.trackItemsMap,trackItemDetailsMap:n.trackItemDetailsMap,trackItemIds:n.trackItemIds,tracks:n.tracks},{updateHistory:!0,kind:"update"})}}async function j7(r){if(r.key==="scene:load"){const e=r.value?.payload,t=e.size,n=e.trackItemIds,s=e.trackItemsMap,i=e.trackItemDetailsMap;if(!n)return;const a=n?.map(async u=>{try{const h=i[u],d=s[u];if(h.type==="text"){const p=await Op({id:u,details:h.details,...d},{size:t}),{details:g,...y}=p;i[u]={type:"text",details:g},s[u]=y}return!0}catch{return!1}});await Promise.all(a);const c=nn(s);this.updateState({...e,trackItemsMap:s,duration:c})}}async function F7(r){const e=ze.cloneDeep(this.getState()),t=r.value?.options?.trackId,n=r.value?.options?.trackIndex;let s=[],i;if(r.key===Yi){i="video";const c=await i_(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===Gi){i="image";const c=await s_(r.value?.payload,{size:e.size}),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===Xi){i="audio";const c=await o_(r.value?.payload),{details:u,...h}=c;e.trackItemDetailsMap[h.id]={type:i,details:u},e.trackItemsMap[h.id]=h,e.trackItemIds.push(h.id),s=[h.id]}if(r.key===xf){i="text";const{details:c,...u}=await Op(r.value?.payload??void 0,{size:e.size});e.trackItemDetailsMap[u.id]={type:i,details:c},e.trackItemsMap[u.id]=u,e.trackItemIds.push(u.id),s.push(u.id)}const a=L7(s,e.tracks,e.trackItemsMap,t,n);if(a.trackId)e.tracks.find(u=>u.id===a.trackId)?.items.push(...s);else if(a.trackIndex!==void 0){const c=gy(i,s);e.tracks.splice(a.trackIndex,0,c)}else{const c=gy(i,s);e.tracks.unshift(c)}e.duration=nn(e.trackItemsMap),this.updateState({trackItemIds:e.trackItemIds,trackItemDetailsMap:e.trackItemDetailsMap,trackItemsMap:e.trackItemsMap,tracks:e.tracks,duration:e.duration,structure:e.structure},{updateHistory:!0,kind:"add"})}function gy(r,e){return{id:At(),accepts:["text","audio","helper","video","image"],type:r,items:e,magnetic:!1,static:!1}}const L7=(r,e,t,n,s)=>{if(n===void 0&&s===void 0)return{trackId:void 0,trackIndex:void 0};const i=s!==void 0?e[Math.max(0,Math.min(s,e.length-1))]:e.find(u=>u.id===n);if(!i)return{trackId:void 0,trackIndex:s!==void 0?Math.max(0,Math.min(s,e.length-1)):void 0};const a=i.items.map(u=>t[u]),c=r.map(u=>t[u]);for(const u of a){const h=u.display.from,d=u.display.to;for(const p of c){const g=p.display.from;if(!(p.display.to<=h||g>=d))return{trackId:void 0,trackIndex:e.indexOf(i)}}}return{trackId:i.id,trackIndex:e.indexOf(i)}},my=["tracks","trackItemsMap","trackItemDetailsMap","transitionIds","transitionsMap","trackItemIds"],N7={size:{width:1080,height:1920},tracks:[],trackItemIds:[],trackItemsMap:{},transitionIds:[],transitionsMap:{},scale:{unit:1,zoom:1,segments:1,index:1},duration:0,activeIds:[],trackItemDetailsMap:{},structure:[]};class B7{stateSubject;stateHistorySubject;prevState;undos;redos;listener;constructor(e){this.stateSubject=null,this.stateHistorySubject=null,this.prevState=null,this.undos=[],this.redos=[],this.listener=null;const t=e||N7;this.stateSubject=new Dv(t),this.stateHistorySubject=new Dv({handleRedo:!1,handleUndo:!1}),this.prevState=t,this.initListeners()}initListeners(){sS(this)}destroyListeners(){this.listener&&this.listener.unsubscribe()}purge(){this.destroyListeners()}updateHistory(e,t){const n=ze.pick(e,my),s=ze.pick(this.getState(),my),i=Z_(s,n);i.length&&(this.undos.push({undos:i,type:t}),this.redos=[])}getStateHistory(){return this.stateHistorySubject.getValue()}subscribeHistory(e){return this.stateHistorySubject.subscribe(e)}getState(){return this.stateSubject.getValue()}subscribe(e){return this.stateSubject.subscribe(e)}updateState(e,t={updateHistory:!1,kind:void 0}){const n=this.getState(),s={...n,...e};if(!ze.isEqual(n,s)){t.updateHistory&&this.updateHistory(s,t.kind);const{duration:i,trackItemsMap:a,...c}=n;this.prevState={...c,duration:this.prevState.duration,trackItemsMap:this.prevState.trackItemsMap},this.stateSubject.next(s)}}subscribeToSize(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.size,this.prevState.size)||e({size:t.size})})}subscribeToScale(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.scale,this.prevState.scale)||e({scale:t.scale})})}subscribeToUpdateTrackItem(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||e({trackItemsMap:t.trackItemsMap})})}subscribeToUpdateItemDetails(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap)||e({trackItemDetailsMap:t.trackItemDetailsMap})})}subscribeToDuration(e){return this.stateSubject.asObservable().subscribe(t=>{t.duration!==this.prevState.duration&&e({duration:t.duration})})}subscribeToHistory(e){return this.stateHistorySubject.asObservable().subscribe(t=>{if(t.handleRedo){const n=this.undos[this.undos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}if(t.handleUndo){const n=this.redos[this.redos.length-1]?.type;n==="update"&&e({...this.getState(),type:n}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!1})}})}subscribeToAddOrRemoveItems(e){return this.stateSubject.asObservable().subscribe(t=>{(!t.trackItemIds?.every(n=>this.prevState.trackItemIds?.includes(n))||!ze.isEqual(t.tracks,this.prevState.tracks))&&e({trackItemIds:t.trackItemIds})})}subscribeToActiveIds(e){return this.stateSubject.asObservable().subscribe(t=>{ze.isEqual(t.activeIds,this.prevState.activeIds)||e({activeIds:t.activeIds})})}subscribeToTracks(e){return this.stateSubject.asObservable().subscribe(t=>{(!ze.isEqual(t.tracks,this.prevState.tracks)||!ze.isEqual(t.trackItemIds,this.prevState.trackItemIds)||!ze.isEqual(t.trackItemsMap,this.prevState.trackItemsMap)||!ze.isEqual(t.transitionIds,this.prevState.transitionIds)||!ze.isEqual(t.transitionsMap,this.prevState.transitionsMap)||!ze.isEqual(t.trackItemDetailsMap,this.prevState.trackItemDetailsMap))&&e({tracks:t.tracks,trackItemIds:t.trackItemIds,trackItemsMap:t.trackItemsMap,transitionIds:t.transitionIds,transitionsMap:t.transitionsMap,trackItemDetailsMap:t.trackItemDetailsMap})})}undo(){const e=this.undos.pop(),t=e?.undos,n=e?.type;if(!t||!n)return;py();const{trackItemDetailsMap:s,trackItemIds:i,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}=this.getState(),d=ze.cloneDeep({trackItemDetailsMap:s,trackItemIds:i,tracks:a,transitionIds:c,transitionsMap:u,trackItemsMap:h}),p=[],g=[],y=[],b=[],_=[],S=[];t.forEach(U=>{let X;const te=U.path.slice(1);U.type==="CREATE"?X={path:te,op:"remove",value:U.value}:U.type==="CHANGE"?X={path:te,op:"replace",value:U.oldValue}:X={path:te,op:"add",value:U.oldValue},U.path.includes("trackItemIds")?y.push(X):U.path.includes("transitionIds")?g.push(X):U.path.includes("trackItemsMap")?_.push(X):U.path.includes("transitionsMap")?b.push(X):U.path.includes("tracks")?p.push(X):U.path.includes("trackItemDetailsMap")&&S.push(X)});const T=this.applyPatch(d.tracks,p),k=this.applyPatch(d.transitionIds,g),I=this.applyPatch(d.trackItemIds,y),A=this.applyPatch(d.transitionsMap,b),D=this.applyPatch(d.trackItemsMap,_),F=this.applyPatch(d.trackItemDetailsMap,S),z=ze.cloneDeep({tracks:T,transitionIds:k,trackItemIds:I,transitionsMap:A,trackItemsMap:D,trackItemDetailsMap:F}),L=ze.cloneDeep(this.getState()),Y={...L,...z};this.prevState=L;const W={redos:t,type:n};this.redos.push(W);const q=nn(Y.trackItemsMap);this.stateSubject.next({...Y,duration:q}),this.stateHistorySubject.next({handleRedo:!1,handleUndo:!0})}redo(){const e=this.redos.pop();if(!e?.redos||!e?.type)return;py();const t=this.getState(),{trackItemDetailsMap:n,trackItemIds:s,tracks:i,transitionIds:a,transitionsMap:c,trackItemsMap:u}=t,h=ze.cloneDeep({trackItemDetailsMap:n,trackItemIds:s,tracks:i,transitionIds:a,transitionsMap:c,trackItemsMap:u}),d=[],p=[],g=[],y=[],b=[],_=[];e.redos.forEach(A=>{const D=A.path.slice(1);let F={};switch(A.type){case"CREATE":F={path:D,op:"add",value:A.value};break;case"CHANGE":F={path:D,op:"replace",value:A.value};break;case"REMOVE":F={path:D,op:"remove",value:A.oldValue};break;default:return null}A.path.includes("trackItemIds")?g.push(F):A.path.includes("transitionIds")?p.push(F):A.path.includes("trackItemsMap")?b.push(F):A.path.includes("transitionsMap")?y.push(F):A.path.includes("trackItemDetailsMap")?_.push(F):d.push(F)});const S={tracks:this.applyPatch(h.tracks,d),transitionIds:this.applyPatch(h.transitionIds,p),trackItemIds:this.applyPatch(h.trackItemIds,g),transitionsMap:this.applyPatch(h.transitionsMap,y),trackItemsMap:this.applyPatch(h.trackItemsMap,b),trackItemDetailsMap:this.applyPatch(h.trackItemDetailsMap,_)},T=ze.cloneDeep(S),k={...ze.cloneDeep(t),...T};this.prevState=t,this.undos.push({undos:e.redos,type:e.type});const I=nn(k.trackItemsMap);this.stateSubject.next({...k,duration:I}),this.stateHistorySubject.next({handleRedo:!0,handleUndo:!1})}applyPatch(e,t){return t.reverse().reduce((n,s)=>P7(n,i=>{D7(i,[s])}),e)}}function sS(r){const e=Fe.subject.pipe(Bs(({key:i})=>i.startsWith(T1))).subscribe(i=>{i.key===Tf&&r.undo(),i.key===Ef&&r.redo()}),t=Fe.subject.pipe(Bs(({key:i,value:a})=>i.startsWith(w1))).subscribe(i=>{F7.bind(r)(i)}),n=Fe.subject.pipe(Bs(({key:i,value:a})=>i.startsWith("scene"))).subscribe(async i=>{await j7.bind(r)(i)}),s=Fe.subject.pipe(Bs(({key:i})=>i.startsWith(S1))).subscribe(async i=>{R7.bind(r)(i)});return()=>{e.unsubscribe(),t.unsubscribe(),s.unsubscribe(),n.unsubscribe()}}exports.ACTIVE_CLONE=Sf;exports.ACTIVE_DELETE=_f;exports.ACTIVE_PASTE=B5;exports.ACTIVE_PREFIX=S1;exports.ACTIVE_SET=N5;exports.ACTIVE_SPLIT=Cf;exports.ADD_ANIMATION=k5;exports.ADD_AUDIO=Xi;exports.ADD_IMAGE=Gi;exports.ADD_MASK=T5;exports.ADD_PLACEHOLDER=C5;exports.ADD_PREFIX=w1;exports.ADD_SUFFIX=v5;exports.ADD_TEXT=xf;exports.ADD_TRANSITION=E5;exports.ADD_VIDEO=Yi;exports.AUDIOS=tb;exports.Audio=f_;exports.AudioObject=Nn;exports.BASE_TIMELINE_ELEMENT_DURATION_MS=PM;exports.Button=Wt;exports.CanvasMixin=Yx;exports.DEFAULT_AUDIO_BITRATE=FM;exports.DEFAULT_AUDIO_SAMPLE_RATE=jM;exports.DEFAULT_BLUR=SP;exports.DEFAULT_BLUR_STEP=_P;exports.DEFAULT_BRIGHTNESS=nP;exports.DEFAULT_BRIGHTNESS_STEP=rP;exports.DEFAULT_CONTRAST=gP;exports.DEFAULT_CONTRAST_STEP=pP;exports.DEFAULT_FADE_IN=YM;exports.DEFAULT_FADE_OUT=XM;exports.DEFAULT_FADE_STEP=$M;exports.DEFAULT_FLIP_X=JM;exports.DEFAULT_FLIP_Y=QM;exports.DEFAULT_FONT=Sd;exports.DEFAULT_FRAMERATE=B1;exports.DEFAULT_MAX_BLUR=xP;exports.DEFAULT_MAX_BRIGHTNESS=tP;exports.DEFAULT_MAX_CONTRAST=fP;exports.DEFAULT_MAX_FADE=UM;exports.DEFAULT_MAX_OPACITY=vP;exports.DEFAULT_MAX_ROTATION=qM;exports.DEFAULT_MAX_SATURATION=iP;exports.DEFAULT_MAX_SPEED=TP;exports.DEFAULT_MAX_TEMPERATURE=lP;exports.DEFAULT_MAX_VOLUME=AP;exports.DEFAULT_MEDIA_PANEL_WIDTH=VM;exports.DEFAULT_MIN_BLUR=wP;exports.DEFAULT_MIN_BRIGHTNESS=eP;exports.DEFAULT_MIN_CONTRAST=dP;exports.DEFAULT_MIN_FADE=HM;exports.DEFAULT_MIN_OPACITY=mP;exports.DEFAULT_MIN_ROTATION=GM;exports.DEFAULT_MIN_SATURATION=sP;exports.DEFAULT_MIN_SPEED=CP;exports.DEFAULT_MIN_TEMPERATURE=cP;exports.DEFAULT_MIN_VOLUME=IP;exports.DEFAULT_OPACITY=bP;exports.DEFAULT_OPACITY_STEP=yP;exports.DEFAULT_PREVIEW_HEIGHT=NM;exports.DEFAULT_PREVIEW_SCALE=Pf;exports.DEFAULT_PREVIEW_WIDTH=LM;exports.DEFAULT_ROTATION=ZM;exports.DEFAULT_ROTATION_STEP=KM;exports.DEFAULT_SATURATION=aP;exports.DEFAULT_SATURATION_STEP=oP;exports.DEFAULT_SETTINGS_PANEL_WIDTH=WM;exports.DEFAULT_SPEED=kP;exports.DEFAULT_SPEED_STEP=EP;exports.DEFAULT_TEMPERATURE=hP;exports.DEFAULT_TEMPERATURE_STEP=uP;exports.DEFAULT_VIDEO_HEIGHT=N1;exports.DEFAULT_VIDEO_MAX_BITRATE=RM;exports.DEFAULT_VIDEO_MIN_BITRATE=DM;exports.DEFAULT_VIDEO_WIDTH=L1;exports.DEFAULT_VOLUME=MP;exports.DEFAULT_VOLUME_STEP=OP;exports.DEFAULT_WEIGHT=MM;exports.DRAG_END=Jo;exports.DRAG_PREFIX=k1;exports.DRAG_START=If;exports.Draggable=ga;exports.DroppableArea=R1;exports.EDIT_OBJECT=A5;exports.EDIT_PREFIX=I5;exports.EDIT_SHAPE=M5;exports.EDIT_TEXT=O5;exports.ENTER_EDIT_MODE=P5;exports.FRAME_INTERVAL=V1;exports.GIANT_ICON_SIZE=CM;exports.HISTORY_PREFIX=T1;exports.HISTORY_REDO=Ef;exports.HISTORY_RESET=eM;exports.HISTORY_UNDO=Tf;exports.Header=eb;exports.Helper=v_;exports.HelperObject=co;exports.IMAGES=rb;exports.Image=g_;exports.ImageObject=lu;exports.LARGER_FONT_SIZE=IM;exports.LARGE_FONT_SIZE=AM;exports.LARGE_ICON_SIZE=TM;exports.LAYER_CLONE=K5;exports.LAYER_COPY=G5;exports.LAYER_CUT=J5;exports.LAYER_DELETE=Q5;exports.LAYER_EDITING_NAME=X5;exports.LAYER_HIDDEN=W5;exports.LAYER_LOCKED=z5;exports.LAYER_MOVE=H5;exports.LAYER_PASTE=q5;exports.LAYER_PREFIX=V5;exports.LAYER_RENAME=Y5;exports.LAYER_SELECT=U5;exports.LAYER_SELECTION=C1;exports.LAYER_SEND_TO=$5;exports.LAYER_SPLIT=Z5;exports.MAX_MEDIA_PANEL_WIDTH=zM;exports.MIN_MEDIA_PANEL_WIDTH=BM;exports.MenuItem=dD;exports.NORMAL_FONT_SIZE=OM;exports.NORMAL_ICON_SIZE=EM;exports.NavbarComponent=fD;exports.PLAYER_PAUSE=_1;exports.PLAYER_PLAY=x1;exports.PLAYER_PREFIX=D5;exports.PLAYER_SEEK=R5;exports.PLAYER_SEEK_BY=F5;exports.PLAYER_SEEK_TO=j5;exports.PLAYER_TOGGLE_PLAY=L5;exports.PREVIEW_FRAME_WIDTH=ma;exports.Placeholder=Wi;exports.Player=lw;exports.PlayheadComponent=uw;exports.PreviewTrackItem=ca;exports.RulerComponent=hw;exports.SECONDARY_FONT=F1;exports.SMALL_FONT_SIZE=j1;exports.SMALL_ICON_SIZE=kM;exports.STATE_CHANGED=S5;exports.STATE_PREFIX=_5;exports.Scene=Q3;exports.SceneBoard=SM;exports.ScrollArea=ei;exports.ScrollBar=vf;exports.SequenceItem=iw;exports.Slider=zy;exports.StateManager=B7;exports.TIMELINE_BOUNDING_CHANGED=Af;exports.TIMELINE_OFFSET_CANVAS_LEFT=jl;exports.TIMELINE_OFFSET_CANVAS_RIGHT=_d;exports.TIMELINE_OFFSET_X=il;exports.TIMELINE_PREFIX=I1;exports.TIMELINE_SCALE_CHANGED=kf;exports.TIMELINE_SCALE_PREFIX=E1;exports.TIMELINE_ZOOM_LEVELS=Jr;exports.TRACKS_CHANGED=w5;exports.TRACK_ITEMS_CHANGED=x5;exports.TRACK_ITEMS_PREFIX=b5;exports.TRACK_PREFIX=y5;exports.TRANSITIONS=sb;exports.Tabs=b1;exports.TabsContent=sl;exports.TabsList=wf;exports.TabsTrigger=nl;exports.Text=Mp;exports.TextObject=Gs;exports.Timeline=gu;exports.TimelineComponent=w7;exports.Track=m_;exports.TrackItemsMixin=y_;exports.TrackObject=hs;exports.TracksMixin=b_;exports.Transition=zr;exports.TransitionGuide=aa;exports.TransitionsMixin=w_;exports.UPLOADS=QP;exports.VIDEOS=nb;exports.Video=p_;exports.VideoObject=ci;exports.addEventListeners=G_;exports.applyMixins=Zx;exports.buttonVariants=Ty;exports.calculateDisplayRange=r_;exports.calculateDuration=nn;exports.calculatePosition=uu;exports.calculateTimelineWidth=K1;exports.calculateTrim=t_;exports.cn=ps;exports.createAudioControls=qx;exports.createControls=Kx;exports.createMediaControls=Gx;exports.createResizeControls=Ip;exports.defaultColor=Ta;exports.defaultSizes=h_;exports.filterAndCleanTracks=n_;exports.findIndex=Df;exports.formatBytes=pO;exports.formatTimeToHumanReadable=PP;exports.formatTimelineUnit=z1;exports.frameToTimeString=W1;exports.getCurrentTime=U1;exports.getFitZoomLevel=DP;exports.getMovingState=jF;exports.getNextZoom=X1;exports.getNextZoomIndex=q1;exports.getNextZoomLevel=G1;exports.getOffset=Me;exports.getPreviousZoom=Y1;exports.getPreviousZoomIndex=jP;exports.getPreviousZoomLevel=$1;exports.getTextHeight=qo;exports.getZoomByIndex=RP;exports.handleEvents=K_;exports.handleResize=oa;exports.loadAudio=Jx;exports.loadAudioItem=o_;exports.loadAudioObject=a_;exports.loadFonts=Z1;exports.loadImage=Qx;exports.loadImageItem=s_;exports.loadImageObject=c_;exports.loadTextItem=Op;exports.loadTextObject=u_;exports.loadVideo=e_;exports.loadVideoItem=i_;exports.loadVideoObject=l_;exports.mergeSizes=d_;exports.mergeTrackObjects=Rf;exports.movingState=ee;exports.positionOffsets=Xx;exports.randomInt=FP;exports.removeEventListeners=q_;exports.removeItemsFromTrack=Qo;exports.renderControl=zn;exports.reorderTracksByIndex=jf;exports.setupHistoryListeners=sS;exports.timeMsToUnits=wt;exports.timeToString=H1;exports.transitionStore=dt;exports.unitsToTimeMs=ss;exports.updateMovingState=FF;exports.useCurrentPlayerFrame=Fl;exports.useIsDraggingOverTimeline=va;exports.useLayoutStore=Ff;exports.useStore=is;exports.wrapResizeWithAnchorPosition=Ap;
